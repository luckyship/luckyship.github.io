<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <script src="/js/av-min.js"></script>

  <script>
    AV.init({
      appId: '3d3mgdb7guWJsXLE6mWY3Cyn-gzGzoHsz',
      appKey: 'fstd3ABXC89jc5VDSe6ANGV6',
      serverURLs: {
        push: "https://leancloud.cn",
        stats: "https://leancloud.cn",
        engine: "https://leancloud.cn",
        api: "https://leancloud.cn",
      },
    });
  </script>
  <script async src="/main/js/slider.66b399.js"></script><script async src="/main/js/main.a76a5f.js"></script><script async src="/main/js/mobile.57dfe3.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-GWM1JLMFWH"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-GWM1JLMFWH")</script>

  <link rel="dns-prefetch" href="https://luckyship.github.io">
  <title>nodejs操作excel文件 | luckyship</title>
  <meta name="generator" content="hexo-theme-luckyship">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="description" content="ExcelJS读取，操作并写入电子表格数据和样式到 XLSX 和 JSON 文件。 一个 Excel 电子表格文件逆向工程项目。">
<meta property="og:type" content="article">
<meta property="og:title" content="nodejs操作excel文件">
<meta property="og:url" content="https://luckyship.github.io/2023/07/02/2023-07-02-node-excel/index.html">
<meta property="og:site_name" content="luckyship">
<meta property="og:description" content="ExcelJS读取，操作并写入电子表格数据和样式到 XLSX 和 JSON 文件。 一个 Excel 电子表格文件逆向工程项目。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-07-02T02:08:48.000Z">
<meta property="article:modified_time" content="2025-08-02T05:46:04.181Z">
<meta property="article:author" content="luckyship">
<meta property="article:tag" content="javascript">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="luckyship" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link rel="apple-touch-icon" href="/apple-touch-icon-180x180.png">
  
  <link rel="stylesheet" type="text/css" href="/main/css/index.a76a5f.css">
  <style type="text/css">
    
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

  
    
 	  <script async src="/lib/clickLove.js"></script>
  
  

<script>
  (function () {
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    } else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();

</script>



  

</head>


<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      


<div class="overlay" style="background: #4d4d4d;"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/head.jpg" class="js-avatar">
		</a>
		<hgroup>
			<h1 class="header-author"><a href="/">luckyship</a></h1>
		</hgroup>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/" >主页</a></li>
			
				<li><a href="/archives" >归档</a></li>
			
				<li><a href="/comment/" >留言板</a></li>
			
				<li><a href="/website/" >知识库</a></li>
			
			</ul>
		</nav>
		<nav class="header-smart-menu">
			
				
					<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">搜索</a>
				
			
				
					<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
				
			
            </nav>

		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" rel="noopener" href="https://github.com/luckyship" title="GitHub" ><i class="icon-github"></i></a>
				
					<a class="gitee" target="_blank" rel="noopener" href="https://gitee.com/luckyship" title="gitee" ><i class="icon-gitee"></i></a>
				
					<a class="blog" target="_blank" rel="noopener" href="https://juejin.cn/user/730534951787662/posts" title="blog" ><i class="icon-blog"></i></a>
				
					<a class="csdn" target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_38319625" title="CSDN" ><i class="icon-csdn"></i></a>
				
			</div>
		
		</nav>

		
		  <nav>
			
  <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ExcelJS"><span class="toc-number">1.</span> <span class="toc-text">ExcelJS</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">2.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E2%AC%86"><span class="toc-number">3.</span> <span class="toc-text">导入</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ES5-%E5%AF%BC%E5%85%A5%E2%AC%86"><span class="toc-number">3.1.</span> <span class="toc-text">ES5 导入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%AB%AF%E2%AC%86"><span class="toc-number">3.2.</span> <span class="toc-text">浏览器端</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E2%AC%86"><span class="toc-number">4.</span> <span class="toc-text">接口</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E7%B0%BF%E2%AC%86"><span class="toc-number">4.1.</span> <span class="toc-text">创建工作簿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%B7%A5%E4%BD%9C%E7%B0%BF%E5%B1%9E%E6%80%A7%E2%AC%86"><span class="toc-number">4.2.</span> <span class="toc-text">设置工作簿属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7%E2%AC%86"><span class="toc-number">4.3.</span> <span class="toc-text">设置计算属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E7%B0%BF%E8%A7%86%E5%9B%BE%E2%AC%86"><span class="toc-number">4.4.</span> <span class="toc-text">工作簿视图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%B7%A5%E4%BD%9C%E8%A1%A8%E2%AC%86"><span class="toc-number">4.5.</span> <span class="toc-text">添加工作表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%B7%A5%E4%BD%9C%E8%A1%A8%E2%AC%86"><span class="toc-number">4.6.</span> <span class="toc-text">删除工作表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E5%B7%A5%E4%BD%9C%E8%A1%A8%E2%AC%86"><span class="toc-number">4.7.</span> <span class="toc-text">访问工作表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E8%A1%A8%E7%8A%B6%E6%80%81%E2%AC%86"><span class="toc-number">4.8.</span> <span class="toc-text">工作表状态</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%B1%9E%E6%80%A7%E2%AC%86"><span class="toc-number">4.9.</span> <span class="toc-text">工作表属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%B0%BA%E5%AF%B8%E2%AC%86"><span class="toc-number">4.9.1.</span> <span class="toc-text">工作表尺寸</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E8%AE%BE%E7%BD%AE%E2%AC%86"><span class="toc-number">4.10.</span> <span class="toc-text">页面设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B5%E7%9C%89%E5%92%8C%E9%A1%B5%E8%84%9A%E2%AC%86"><span class="toc-number">4.11.</span> <span class="toc-text">页眉和页脚</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E8%A1%A8%E8%A7%86%E5%9B%BE%E2%AC%86"><span class="toc-number">4.12.</span> <span class="toc-text">工作表视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%BB%E7%BB%93%E8%A7%86%E5%9B%BE%E2%AC%86"><span class="toc-number">4.12.1.</span> <span class="toc-text">冻结视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%86%E5%88%86%E8%A7%86%E5%9B%BE%E2%AC%86"><span class="toc-number">4.12.2.</span> <span class="toc-text">拆分视图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E7%AD%9B%E9%80%89%E5%99%A8%E2%AC%86"><span class="toc-number">4.13.</span> <span class="toc-text">自动筛选器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%97%E2%AC%86"><span class="toc-number">4.14.</span> <span class="toc-text">列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%8C%E2%AC%86"><span class="toc-number">4.15.</span> <span class="toc-text">行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Add-Rows%E2%AC%86"><span class="toc-number">4.16.</span> <span class="toc-text">Add Rows</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E5%8D%95%E4%B8%AA%E5%8D%95%E5%85%83%E6%A0%BC%E2%AC%86"><span class="toc-number">4.17.</span> <span class="toc-text">处理单个单元格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC%E2%AC%86"><span class="toc-number">4.18.</span> <span class="toc-text">合并单元格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Insert-Rows%E2%AC%86"><span class="toc-number">4.19.</span> <span class="toc-text">Insert Rows</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Splice%E2%AC%86"><span class="toc-number">4.20.</span> <span class="toc-text">Splice</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E5%A4%8D%E8%A1%8C%E2%AC%86"><span class="toc-number">4.21.</span> <span class="toc-text">重复行</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%90%8D%E7%A7%B0%E2%AC%86"><span class="toc-number">4.22.</span> <span class="toc-text">定义名称</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%AA%8C%E8%AF%81%E2%AC%86"><span class="toc-number">4.23.</span> <span class="toc-text">数据验证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%A0%BC%E6%B3%A8%E9%87%8A%E2%AC%86"><span class="toc-number">4.24.</span> <span class="toc-text">单元格注释</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%B9%E6%B3%A8%E5%B1%9E%E6%80%A7%E2%AC%86"><span class="toc-number">4.24.1.</span> <span class="toc-text">单元格批注属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%B9%E6%B3%A8%E9%A1%B5%E8%BE%B9%E8%B7%9D%E2%AC%86"><span class="toc-number">4.24.2.</span> <span class="toc-text">单元格批注页边距</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%B2%E6%94%AF%E6%8C%81%E7%9A%84%E9%A1%B5%E8%BE%B9%E8%B7%9D%E5%B1%9E%E6%80%A7%E2%AC%86"><span class="toc-number">4.24.3.</span> <span class="toc-text">已支持的页边距属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%B9%E6%B3%A8%E4%BF%9D%E6%8A%A4%E2%AC%86"><span class="toc-number">4.24.4.</span> <span class="toc-text">单元格批注保护</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%B2%E6%94%AF%E6%8C%81%E7%9A%84%E4%BF%9D%E6%8A%A4%E5%B1%9E%E6%80%A7%E2%AC%86"><span class="toc-number">4.24.5.</span> <span class="toc-text">已支持的保护属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%A0%BC%E6%89%B9%E6%B3%A8%E5%AF%B9%E8%B1%A1%E4%BD%8D%E7%BD%AE%E5%B1%9E%E6%80%A7%E2%AC%86"><span class="toc-number">4.24.6.</span> <span class="toc-text">单元格批注对象位置属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A8%E6%A0%BC%E2%AC%86"><span class="toc-number">4.25.</span> <span class="toc-text">表格</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E6%A0%BC%E5%B1%9E%E6%80%A7%E2%AC%86"><span class="toc-number">4.25.1.</span> <span class="toc-text">表格属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E6%A0%BC%E6%A0%B7%E5%BC%8F%E5%B1%9E%E6%80%A7%E2%AC%86"><span class="toc-number">4.25.2.</span> <span class="toc-text">表格样式属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E6%A0%BC%E5%88%97%E5%B1%9E%E6%80%A7%E2%AC%86"><span class="toc-number">4.25.3.</span> <span class="toc-text">表格列属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E5%87%BD%E6%95%B0%E2%AC%86"><span class="toc-number">4.25.4.</span> <span class="toc-text">统计函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E6%A0%BC%E6%A0%B7%E5%BC%8F%E4%B8%BB%E9%A2%98%E2%AC%86"><span class="toc-number">4.25.5.</span> <span class="toc-text">表格样式主题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8%E6%A0%BC%E2%AC%86"><span class="toc-number">4.25.6.</span> <span class="toc-text">修改表格</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B7%E5%BC%8F%E2%AC%86"><span class="toc-number">4.26.</span> <span class="toc-text">样式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E6%A0%BC%E5%BC%8F%E2%AC%86"><span class="toc-number">4.26.1.</span> <span class="toc-text">数字格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E4%BD%93"><span class="toc-number">4.26.2.</span> <span class="toc-text">字体</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E9%BD%90%E2%AC%86"><span class="toc-number">4.26.3.</span> <span class="toc-text">对齐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BE%B9%E6%A1%86%E2%AC%86"><span class="toc-number">4.26.4.</span> <span class="toc-text">边框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A1%AB%E5%85%85%E2%AC%86"><span class="toc-number">4.26.5.</span> <span class="toc-text">填充</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A1%AB%E5%85%85%E6%A8%A1%E5%BC%8F%E2%AC%86"><span class="toc-number">4.26.5.1.</span> <span class="toc-text">填充模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B8%90%E5%8F%98%E5%A1%AB%E5%85%85%E2%AC%86"><span class="toc-number">4.26.5.2.</span> <span class="toc-text">渐变填充</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%8C%E6%96%87%E6%9C%AC%E2%AC%86"><span class="toc-number">4.26.6.</span> <span class="toc-text">富文本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%A0%BC%E4%BF%9D%E6%8A%A4%E2%AC%86"><span class="toc-number">4.26.7.</span> <span class="toc-text">单元格保护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%A0%BC%E5%BC%8F%E5%8C%96%E2%AC%86"><span class="toc-number">4.27.</span> <span class="toc-text">条件格式化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E2%AC%86"><span class="toc-number">4.27.1.</span> <span class="toc-text">表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cell-Is%E2%AC%86"><span class="toc-number">4.27.2.</span> <span class="toc-text">Cell Is</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Top-10%E2%AC%86"><span class="toc-number">4.27.3.</span> <span class="toc-text">Top 10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E4%BA%8E%E5%B9%B3%E5%9D%87%E5%80%BC%E2%AC%86"><span class="toc-number">4.27.4.</span> <span class="toc-text">高于平均值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%89%B2%E9%98%B6%E2%AC%86"><span class="toc-number">4.27.5.</span> <span class="toc-text">色阶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E6%A0%87%E9%9B%86%E2%AC%86"><span class="toc-number">4.27.6.</span> <span class="toc-text">图标集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9D%A1%E2%AC%86"><span class="toc-number">4.27.7.</span> <span class="toc-text">数据条</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E6%96%87%E5%AD%97%E2%AC%86"><span class="toc-number">4.27.8.</span> <span class="toc-text">包含文字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E6%AE%B5%E2%AC%86"><span class="toc-number">4.27.9.</span> <span class="toc-text">时间段</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A7%E7%BA%B2%E7%BA%A7%E5%88%AB%E2%AC%86"><span class="toc-number">4.28.</span> <span class="toc-text">大纲级别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E2%AC%86"><span class="toc-number">4.29.</span> <span class="toc-text">图片</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9B%BE%E7%89%87%E6%B7%BB%E5%8A%A0%E5%88%B0%E5%B7%A5%E4%BD%9C%E7%B0%BF%E2%AC%86"><span class="toc-number">4.29.1.</span> <span class="toc-text">将图片添加到工作簿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9B%BE%E7%89%87%E6%B7%BB%E5%8A%A0%E5%88%B0%E5%B7%A5%E4%BD%9C%E8%A1%A8%E8%83%8C%E6%99%AF%E2%AC%86"><span class="toc-number">4.29.2.</span> <span class="toc-text">将图片添加到工作表背景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E4%B8%80%E5%AE%9A%E8%8C%83%E5%9B%B4%E5%86%85%E6%B7%BB%E5%8A%A0%E5%9B%BE%E7%89%87%E2%AC%86"><span class="toc-number">4.29.3.</span> <span class="toc-text">在一定范围内添加图片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E5%9B%BE%E7%89%87%E6%B7%BB%E5%8A%A0%E5%88%B0%E5%8D%95%E5%85%83%E6%A0%BC%E2%AC%86"><span class="toc-number">4.29.4.</span> <span class="toc-text">将图片添加到单元格</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E5%B8%A6%E6%9C%89%E8%B6%85%E9%93%BE%E6%8E%A5%E7%9A%84%E5%9B%BE%E7%89%87%E2%AC%86"><span class="toc-number">4.29.5.</span> <span class="toc-text">添加带有超链接的图片</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E8%A1%A8%E4%BF%9D%E6%8A%A4%E2%AC%86"><span class="toc-number">4.30.</span> <span class="toc-text">工作表保护</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E8%A1%A8%E4%BF%9D%E6%8A%A4%E9%80%89%E9%A1%B9%E2%AC%86"><span class="toc-number">4.30.1.</span> <span class="toc-text">工作表保护选项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6-I-O%E2%AC%86"><span class="toc-number">4.31.</span> <span class="toc-text">文件 I&#x2F;O</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#XLSX%E2%AC%86"><span class="toc-number">4.31.1.</span> <span class="toc-text">XLSX</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB-XLSX%E2%AC%86"><span class="toc-number">4.31.1.1.</span> <span class="toc-text">读 XLSX</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%99-XLSX"><span class="toc-number">4.31.1.2.</span> <span class="toc-text">写 XLSX</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CSV%E2%AC%86"><span class="toc-number">4.31.2.</span> <span class="toc-text">CSV</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB-CSV%E2%AC%86"><span class="toc-number">4.31.2.1.</span> <span class="toc-text">读 CSV</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%99-CSV%E2%AC%86"><span class="toc-number">4.31.2.2.</span> <span class="toc-text">写 CSV</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E5%BC%8F-I-O%E2%AC%86"><span class="toc-number">4.31.3.</span> <span class="toc-text">流式 I&#x2F;O</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E5%BC%8F-XLSX%E2%AC%86"><span class="toc-number">4.31.3.1.</span> <span class="toc-text">流式 XLSX</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B5%81%E5%BC%8F-XLSX-%E5%86%99%E5%85%A5%E5%99%A8%E2%AC%86"><span class="toc-number">4.31.3.1.1.</span> <span class="toc-text">流式 XLSX 写入器</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B5%81%E5%BC%8F-XLSX-%E9%98%85%E8%AF%BB%E5%99%A8%E2%AC%86"><span class="toc-number">4.31.3.1.2.</span> <span class="toc-text">流式 XLSX 阅读器</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%AD%E4%BB%A3%E9%81%8D%E5%8E%86%E6%89%80%E6%9C%89%E4%BA%8B%E4%BB%B6%E2%AC%86"><span class="toc-number">4.31.3.1.2.1.</span> <span class="toc-text">迭代遍历所有事件</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8F%AF%E8%AF%BB%E6%B5%81%E2%AC%86"><span class="toc-number">4.31.3.1.2.2.</span> <span class="toc-text">可读流</span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E2%AC%86"><span class="toc-number">5.</span> <span class="toc-text">浏览器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%84%E6%8D%86%E7%BB%91%E2%AC%86"><span class="toc-number">5.1.</span> <span class="toc-text">预捆绑</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%80%BC%E7%B1%BB%E5%9E%8B%E2%AC%86"><span class="toc-number">6.</span> <span class="toc-text">值类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Null-%E5%80%BC%E2%AC%86"><span class="toc-number">6.1.</span> <span class="toc-text">Null 值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC%E2%AC%86-1"><span class="toc-number">6.2.</span> <span class="toc-text">合并单元格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E5%80%BC%E2%AC%86"><span class="toc-number">6.3.</span> <span class="toc-text">数字值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%80%BC%E2%AC%86"><span class="toc-number">6.4.</span> <span class="toc-text">字符串值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E5%80%BC%E2%AC%86"><span class="toc-number">6.5.</span> <span class="toc-text">日期值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B6%85%E9%93%BE%E6%8E%A5%E5%80%BC%E2%AC%86"><span class="toc-number">6.6.</span> <span class="toc-text">超链接值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AC%E5%BC%8F%E5%80%BC%E2%AC%86"><span class="toc-number">6.7.</span> <span class="toc-text">公式值</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B1%E4%BA%AB%E5%85%AC%E5%BC%8F%E2%AC%86"><span class="toc-number">6.7.1.</span> <span class="toc-text">共享公式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AC%E5%BC%8F%E7%B1%BB%E5%9E%8B%E2%AC%86"><span class="toc-number">6.7.2.</span> <span class="toc-text">公式类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E5%85%AC%E5%BC%8F%E2%AC%86"><span class="toc-number">6.7.3.</span> <span class="toc-text">数组公式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%8C%E6%96%87%E6%9C%AC%E5%80%BC%E2%AC%86"><span class="toc-number">6.8.</span> <span class="toc-text">富文本值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%83%E5%B0%94%E5%80%BC%E2%AC%86"><span class="toc-number">6.9.</span> <span class="toc-text">布尔值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E5%80%BC%E2%AC%86"><span class="toc-number">6.10.</span> <span class="toc-text">错误值</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8E%A5%E5%8F%A3%E5%8F%98%E5%8C%96%E2%AC%86"><span class="toc-number">7.</span> <span class="toc-text">接口变化</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0-1-0%E2%AC%86"><span class="toc-number">7.1.</span> <span class="toc-text">0.1.0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Worksheet-eachRow%E2%AC%86"><span class="toc-number">7.1.1.</span> <span class="toc-text">Worksheet.eachRow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Worksheet-getRow%E2%AC%86"><span class="toc-number">7.1.2.</span> <span class="toc-text">Worksheet.getRow</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-1-1%E2%AC%86"><span class="toc-number">7.2.</span> <span class="toc-text">0.1.1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cell-model%E2%AC%86"><span class="toc-number">7.2.1.</span> <span class="toc-text">cell.model</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0-2-44%E2%AC%86"><span class="toc-number">7.3.</span> <span class="toc-text">0.2.44</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E2%AC%86"><span class="toc-number">8.</span> <span class="toc-text">配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E2%AC%86"><span class="toc-number">9.</span> <span class="toc-text">注意事项</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Dist-%E6%96%87%E4%BB%B6%E5%A4%B9%E2%AC%86"><span class="toc-number">9.1.</span> <span class="toc-text">Dist 文件夹</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%B7%B2%E7%9F%A5%E7%9A%84%E9%97%AE%E9%A2%98%E2%AC%86"><span class="toc-number">10.</span> <span class="toc-text">已知的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Puppeteer-%E8%BF%9B%E8%A1%8C%E6%B5%8B%E8%AF%95%E2%AC%86"><span class="toc-number">10.1.</span> <span class="toc-text">使用 Puppeteer 进行测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%BC%E6%8E%A5%E4%B8%8E%E5%90%88%E5%B9%B6%E2%AC%86"><span class="toc-number">10.2.</span> <span class="toc-text">拼接与合并</span></a></li></ol></li></ol>
  </div>


		  </nav>
		
	</header>
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
      
      <a class="forkMe" style="position:absolute;z-index:999;top:0;right:0.5em;"
        href="https://github.com/luckyship/myblog" target="_blank">
        <img src="/img/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
      
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<a href="/">
					<img src="/img/head.jpg" class="js-avatar">
				</a>
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author">luckyship</h1>
			</hgroup>
			
			
			
				
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/luckyship" title="GitHub"><i class="icon-github"></i></a>
			        
						<a class="gitee" target="_blank" href="https://gitee.com/luckyship" title="gitee"><i class="icon-gitee"></i></a>
			        
						<a class="blog" target="_blank" href="https://juejin.cn/user/730534951787662/posts" title="blog"><i class="icon-blog"></i></a>
			        
						<a class="csdn" target="_blank" href="https://blog.csdn.net/sinat_38319625" title="CSDN"><i class="icon-csdn"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 25%"><a href="/">主页</a></li>
		        
					<li style="width: 25%"><a href="/archives">归档</a></li>
		        
					<li style="width: 25%"><a href="/comment/">留言板</a></li>
		        
					<li style="width: 25%"><a href="/website/">知识库</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1"
              class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-2023-07-02-node-excel" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
  
  
    <h1 class="article-title" itemprop="name">
      nodejs操作excel文件
    </h1>
  


  
   
<span id="busuanzi_container_page_pv" style="display: none" class="archive-article-date">
  <i class="icon-smile icon"></i> 阅读数：<span id="busuanzi_value_page_pv"></span>次
</span>


<a href="/2023/07/02/2023-07-02-node-excel/" class="archive-article-date">
  <!-- <time datetime="2023-07-02T02:08:48.000Z" title="发布时间" itemprop="datePublished"><i class="icon-calendar icon"></i>2023-07-02</time>
        <time datetime="2025-08-02T05:46:04.181Z" title="最后更新" itemprop="datePublished">
                <svg t="1614416122145" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="535" width="16" height="16"><path d="M887.786 1021.4h-757.804c-69.761 0-126.276-56.637-126.276-126.397v-758.23c0-69.822 57.419-132.402 127.121-132.402h508.511v63.547h-508.511c-34.85 0-63.968 33.886-63.968 68.854v758.262c0 34.91 28.273 63.212 63.094 63.212h757.835c34.82 0 69.341-29.058 69.341-63.968v-508.512h63.605v508.486c0 69.853-63.242 127.153-132.946 127.153z" p-id="536" fill="#999999"></path><path d="M969.708 166.041l-111.61-111.673c-24.682-24.68-64.635-24.68-89.315 0l-491.163 491.497c-9.234 9.23-13.849 20.849-16.143 32.768l-136.716 276.63c-11.434 31.109 13.516 59.050 44.597 44.659l276.51-136.776c11.919-2.355 23.505-6.942 32.676-16.172l491.163-491.558c24.653-24.68 24.653-64.691 0-89.374zM207.56 839.423c-15.541 7.148-29.57-7.755-22.297-22.33l103.345-170.842 89.676 89.706-170.722 103.465zM433.89 702.284c-41.852-41.88-99.755-99.843-111.612-111.73l356.441-356.649 112.426 110.946-357.254 357.434zM902.756 233.086l-66.984 67.046-110.013-113.303 65.388-65.445c12.279-12.312 32.347-12.312 44.626 0l66.986 67.015c12.311 12.402 12.311 32.375 0 44.687z" p-id="537" fill="#999999"></path></svg>
                2025-08-02</time> -->

  
  <time datetime="2025-08-02T05:46:04.181Z" title="最后更新" itemprop="datePublished">
    <svg
      t="1614416122145"
      viewBox="0 0 1024 1024"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      p-id="535"
      width="16"
      height="16"
    >
      <path
        d="M887.786 1021.4h-757.804c-69.761 0-126.276-56.637-126.276-126.397v-758.23c0-69.822 57.419-132.402 127.121-132.402h508.511v63.547h-508.511c-34.85 0-63.968 33.886-63.968 68.854v758.262c0 34.91 28.273 63.212 63.094 63.212h757.835c34.82 0 69.341-29.058 69.341-63.968v-508.512h63.605v508.486c0 69.853-63.242 127.153-132.946 127.153z"
        p-id="536"
        fill="#999999"
      ></path>
      <path
        d="M969.708 166.041l-111.61-111.673c-24.682-24.68-64.635-24.68-89.315 0l-491.163 491.497c-9.234 9.23-13.849 20.849-16.143 32.768l-136.716 276.63c-11.434 31.109 13.516 59.050 44.597 44.659l276.51-136.776c11.919-2.355 23.505-6.942 32.676-16.172l491.163-491.558c24.653-24.68 24.653-64.691 0-89.374zM207.56 839.423c-15.541 7.148-29.57-7.755-22.297-22.33l103.345-170.842 89.676 89.706-170.722 103.465zM433.89 702.284c-41.852-41.88-99.755-99.843-111.612-111.73l356.441-356.649 112.426 110.946-357.254 357.434zM902.756 233.086l-66.984 67.046-110.013-113.303 65.388-65.445c12.279-12.312 32.347-12.312 44.626 0l66.986 67.015c12.311 12.402 12.311 32.375 0 44.687z"
        p-id="537"
        fill="#999999"
      ></path>
    </svg>
    <span >
      2023-07-02
      <span style="font-size: 10px"> (更新于2025-08-02)
    </span>
  </time>
  
</a>

  
  
    
<div style="margin-top:10px;">
  <span class="post-time">
    <span class="post-meta-item-icon">
      <!-- fonts.scss -->
      <!-- 百度字体平台:http://fontstore.baidu.com/static/editor/index.html -->
      <i class="icon-statistics"></i>
      <span class="post-meta-item-text"> 字数统计:</span>
      <span class="post-count">18k字</span>
    </span>
  </span>

  <span class="post-time">
    &nbsp; | &nbsp;
    <span class="post-meta-item-icon">
      <i class="icon-book icon"></i>
      <span class="post-meta-item-text"> 阅读时长≈</span>
      <span class="post-count">79分</span>
    </span>
  </span>
</div>


  
  </header>
  
  <div class="article-entry" itemprop="articleBody">
    
    <h1 id="ExcelJS"><a href="#ExcelJS" class="headerlink" title="ExcelJS"></a>ExcelJS</h1><p>读取，操作并写入电子表格数据和样式到 XLSX 和 JSON 文件。</p>
<p>一个 Excel 电子表格文件逆向工程项目。</p>
<span id="more"></span>

<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><figure class="highlight shell"><table><tr><td class="code"><pre><code class="hljs shell">npm install exceljs<br></code></pre></td></tr></table></figure>

<h1 id="导入⬆"><a href="#导入⬆" class="headerlink" title="导入⬆"></a>导入<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h1><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ExcelJS</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;exceljs&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h2 id="ES5-导入⬆"><a href="#ES5-导入⬆" class="headerlink" title="ES5 导入⬆"></a>ES5 导入<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>要使用 ES5 编译代码，请使用 <em>dist/es5</em> 路径。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ExcelJS</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;exceljs/dist/es5&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p><strong>注意：</strong>ES5 版本对许多 polyfill 都具有隐式依赖，而 exceljs 不再明确添加。<br>您需要在依赖项中添加 <code>core-js</code> 和 <code>regenerator-runtime</code>，并在导入 <code>exceljs</code> 之前在代码中包含以下引用：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// exceljs 所需的 polyfills</span><br><span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;core-js/modules/es.promise&#x27;</span>);<br><span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;core-js/modules/es.string.includes&#x27;</span>);<br><span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;core-js/modules/es.object.assign&#x27;</span>);<br><span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;core-js/modules/es.object.keys&#x27;</span>);<br><span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;core-js/modules/es.symbol&#x27;</span>);<br><span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;core-js/modules/es.symbol.async-iterator&#x27;</span>);<br><span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;regenerator-runtime/runtime&#x27;</span>);<br><br><span class="hljs-keyword">const</span> <span class="hljs-title class_">ExcelJS</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;exceljs/dist/es5&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>对于 IE 11，您还需要一个 polyfill 以支持 unicode regex 模式。 例如，</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> rewritePattern = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;regexpu-core&#x27;</span>);<br><span class="hljs-keyword">const</span> &#123;<br>  generateRegexpuOptions,<br>&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@babel/helper-create-regexp-features-plugin/lib/util&#x27;</span>);<br><br><span class="hljs-keyword">const</span> &#123; <span class="hljs-title class_">RegExp</span> &#125; = <span class="hljs-variable language_">global</span>;<br><span class="hljs-keyword">try</span> &#123;<br>  <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;u&#x27;</span>);<br>&#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>  <span class="hljs-variable language_">global</span>.<span class="hljs-property">RegExp</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">pattern, flags</span>) &#123;<br>    <span class="hljs-keyword">if</span> (flags &amp;&amp; flags.<span class="hljs-title function_">includes</span>(<span class="hljs-string">&#x27;u&#x27;</span>)) &#123;<br>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<br>        <span class="hljs-title function_">rewritePattern</span>(<br>          pattern,<br>          flags,<br>          <span class="hljs-title function_">generateRegexpuOptions</span>(&#123; flags, pattern &#125;)<br>        )<br>      );<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(pattern, flags);<br>  &#125;;<br>  <span class="hljs-variable language_">global</span>.<span class="hljs-property">RegExp</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span> = <span class="hljs-title class_">RegExp</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="浏览器端⬆"><a href="#浏览器端⬆" class="headerlink" title="浏览器端⬆"></a>浏览器端<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>ExcelJS 在 <em>dist/</em> 文件夹内发布了两个支持浏览器的包：</p>
<p>一个是隐式依赖 <code>core-js</code> polyfills 的…</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;exceljs.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>另一个则没有…</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;--your-project&#x27;s-pollyfills-here--&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;exceljs.bare.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h1 id="接口⬆"><a href="#接口⬆" class="headerlink" title="接口⬆"></a>接口<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h1><h2 id="创建工作簿⬆"><a href="#创建工作簿⬆" class="headerlink" title="创建工作簿⬆"></a>创建工作簿<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExcelJS</span>.<span class="hljs-title class_">Workbook</span>();<br></code></pre></td></tr></table></figure>

<h2 id="设置工作簿属性⬆"><a href="#设置工作簿属性⬆" class="headerlink" title="设置工作簿属性⬆"></a>设置工作簿属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">workbook.<span class="hljs-property">creator</span> = <span class="hljs-string">&#x27;Me&#x27;</span>;<br>workbook.<span class="hljs-property">lastModifiedBy</span> = <span class="hljs-string">&#x27;Her&#x27;</span>;<br>workbook.<span class="hljs-property">created</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">1985</span>, <span class="hljs-number">8</span>, <span class="hljs-number">30</span>);<br>workbook.<span class="hljs-property">modified</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();<br>workbook.<span class="hljs-property">lastPrinted</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2016</span>, <span class="hljs-number">9</span>, <span class="hljs-number">27</span>);<br></code></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 将工作簿日期设置为 1904 年日期系统</span><br>workbook.<span class="hljs-property">properties</span>.<span class="hljs-property">date1904</span> = <span class="hljs-literal">true</span>;<br></code></pre></td></tr></table></figure>

<h2 id="设置计算属性⬆"><a href="#设置计算属性⬆" class="headerlink" title="设置计算属性⬆"></a>设置计算属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 在加载时强制工作簿计算属性</span><br>workbook.<span class="hljs-property">calcProperties</span>.<span class="hljs-property">fullCalcOnLoad</span> = <span class="hljs-literal">true</span>;<br></code></pre></td></tr></table></figure>

<h2 id="工作簿视图⬆"><a href="#工作簿视图⬆" class="headerlink" title="工作簿视图⬆"></a>工作簿视图<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>工作簿视图控制在查看工作簿时 Excel 将打开多少个单独的窗口。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">workbook.<span class="hljs-property">views</span> = [<br>  &#123;<br>    <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">width</span>: <span class="hljs-number">10000</span>,<br>    <span class="hljs-attr">height</span>: <span class="hljs-number">20000</span>,<br>    <span class="hljs-attr">firstSheet</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">activeTab</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">visibility</span>: <span class="hljs-string">&#x27;visible&#x27;</span>,<br>  &#125;,<br>];<br></code></pre></td></tr></table></figure>

<h2 id="添加工作表⬆"><a href="#添加工作表⬆" class="headerlink" title="添加工作表⬆"></a>添加工作表<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> sheet = workbook.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;My Sheet&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>使用 <code>addWorksheet</code> 函数的第二个参数来指定工作表的选项。</p>
<p>示例：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 创建带有红色标签颜色的工作表</span><br><span class="hljs-keyword">const</span> sheet = workbook.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;My Sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">properties</span>: &#123; <span class="hljs-attr">tabColor</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FFC0000&#x27;</span> &#125; &#125;,<br>&#125;);<br><br><span class="hljs-comment">// 创建一个隐藏了网格线的工作表</span><br><span class="hljs-keyword">const</span> sheet = workbook.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;My Sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">views</span>: [&#123; <span class="hljs-attr">showGridLines</span>: <span class="hljs-literal">false</span> &#125;],<br>&#125;);<br><br><span class="hljs-comment">// 创建一个第一行和列冻结的工作表</span><br><span class="hljs-keyword">const</span> sheet = workbook.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;My Sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">views</span>: [&#123; <span class="hljs-attr">xSplit</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">ySplit</span>: <span class="hljs-number">1</span> &#125;],<br>&#125;);<br><br><span class="hljs-comment">// 使用A4设置的页面设置设置创建新工作表 - 横向</span><br><span class="hljs-keyword">const</span> worksheet = workbook.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;My Sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">pageSetup</span>: &#123; <span class="hljs-attr">paperSize</span>: <span class="hljs-number">9</span>, <span class="hljs-attr">orientation</span>: <span class="hljs-string">&#x27;landscape&#x27;</span> &#125;,<br>&#125;);<br><br><span class="hljs-comment">// 创建一个具有页眉页脚的工作表</span><br><span class="hljs-keyword">const</span> sheet = workbook.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;My Sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">headerFooter</span>: &#123; <span class="hljs-attr">firstHeader</span>: <span class="hljs-string">&#x27;Hello Exceljs&#x27;</span>, <span class="hljs-attr">firstFooter</span>: <span class="hljs-string">&#x27;Hello World&#x27;</span> &#125;,<br>&#125;);<br><br><span class="hljs-comment">// 创建一个冻结了第一行和第一列的工作表</span><br><span class="hljs-keyword">const</span> sheet = workbook.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;My Sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">views</span>: [&#123; <span class="hljs-attr">state</span>: <span class="hljs-string">&#x27;frozen&#x27;</span>, <span class="hljs-attr">xSplit</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">ySplit</span>: <span class="hljs-number">1</span> &#125;],<br>&#125;);<br></code></pre></td></tr></table></figure>

<h2 id="删除工作表⬆"><a href="#删除工作表⬆" class="headerlink" title="删除工作表⬆"></a>删除工作表<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>使用工作表的 <code>id</code> 从工作簿中删除工作表。</p>
<p>示例：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 创建工作表</span><br><span class="hljs-keyword">const</span> sheet = workbook.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;My Sheet&#x27;</span>);<br><br><span class="hljs-comment">// 使用工作表 id 删除工作表</span><br>workbook.<span class="hljs-title function_">removeWorksheet</span>(sheet.<span class="hljs-property">id</span>);<br></code></pre></td></tr></table></figure>

<h2 id="访问工作表⬆"><a href="#访问工作表⬆" class="headerlink" title="访问工作表⬆"></a>访问工作表<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 遍历所有工作表</span><br><span class="hljs-comment">// 注意： workbook.worksheets.forEach 仍然是可以正常运行的， 但是以下的方式更好</span><br>workbook.<span class="hljs-title function_">eachSheet</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">worksheet, sheetId</span>) &#123;<br>  <span class="hljs-comment">// ...</span><br>&#125;);<br><br><span class="hljs-comment">// 按 name 提取工作表</span><br><span class="hljs-keyword">const</span> worksheet = workbook.<span class="hljs-title function_">getWorksheet</span>(<span class="hljs-string">&#x27;My Sheet&#x27;</span>);<br><br><span class="hljs-comment">// 按 id 提取工作表</span><br><span class="hljs-keyword">const</span> worksheet = workbook.<span class="hljs-title function_">getWorksheet</span>(<span class="hljs-number">1</span>);<br></code></pre></td></tr></table></figure>

<h2 id="工作表状态⬆"><a href="#工作表状态⬆" class="headerlink" title="工作表状态⬆"></a>工作表状态<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 使工作表可见</span><br>worksheet.<span class="hljs-property">state</span> = <span class="hljs-string">&#x27;visible&#x27;</span>;<br><br><span class="hljs-comment">// 隐藏工作表</span><br>worksheet.<span class="hljs-property">state</span> = <span class="hljs-string">&#x27;hidden&#x27;</span>;<br><br><span class="hljs-comment">// 从“隐藏/取消隐藏”对话框中隐藏工作表</span><br>worksheet.<span class="hljs-property">state</span> = <span class="hljs-string">&#x27;veryHidden&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h2 id="工作表属性⬆"><a href="#工作表属性⬆" class="headerlink" title="工作表属性⬆"></a>工作表属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>工作表支持属性存储，以允许控制工作表的某些功能。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 创建具有属性的新工作表</span><br><span class="hljs-keyword">const</span> worksheet = workbook.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">properties</span>: &#123; <span class="hljs-attr">tabColor</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FF00FF00&#x27;</span> &#125; &#125;,<br>&#125;);<br><br><span class="hljs-comment">// 创建一个具有属性的可写的新工作表</span><br><span class="hljs-keyword">const</span> worksheetWriter = workbookWriter.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">properties</span>: &#123; <span class="hljs-attr">outlineLevelCol</span>: <span class="hljs-number">1</span> &#125;,<br>&#125;);<br><br><span class="hljs-comment">// 之后调整属性（工作表读写器不支持该操作）</span><br>worksheet.<span class="hljs-property">properties</span>.<span class="hljs-property">outlineLevelCol</span> = <span class="hljs-number">2</span>;<br>worksheet.<span class="hljs-property">properties</span>.<span class="hljs-property">defaultRowHeight</span> = <span class="hljs-number">15</span>;<br></code></pre></td></tr></table></figure>

<p><strong>支持的属性</strong></p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>tabColor</td>
<td><code>undefined</code></td>
<td>标签的颜色</td>
</tr>
<tr>
<td>outlineLevelCol</td>
<td>0</td>
<td>工作表列大纲级别</td>
</tr>
<tr>
<td>outlineLevelRow</td>
<td>0</td>
<td>工作表行大纲级别</td>
</tr>
<tr>
<td>defaultRowHeight</td>
<td>15</td>
<td>默认行高</td>
</tr>
<tr>
<td>defaultColWidth</td>
<td>(optional)</td>
<td>默认列宽</td>
</tr>
<tr>
<td>dyDescent</td>
<td>55</td>
<td>TBD</td>
</tr>
</tbody></table>
<h3 id="工作表尺寸⬆"><a href="#工作表尺寸⬆" class="headerlink" title="工作表尺寸⬆"></a>工作表尺寸<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>一些新的尺寸属性已添加到工作表中…</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>rowCount</td>
<td>文档的总行数。 等于具有值的最后一行的行号。</td>
</tr>
<tr>
<td>actualRowCount</td>
<td>具有值的行数的计数。 如果中间文档行为空，则该行将不包括在计数中。</td>
</tr>
<tr>
<td>columnCount</td>
<td>文档的总列数。 等于所有行的最大单元数。</td>
</tr>
<tr>
<td>actualColumnCount</td>
<td>具有值的列数的计数。</td>
</tr>
</tbody></table>
<h2 id="页面设置⬆"><a href="#页面设置⬆" class="headerlink" title="页面设置⬆"></a>页面设置<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>所有可能影响工作表打印的属性都保存在工作表上的 <code>pageSetup</code> 对象中。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 使用 A4 横向的页面设置创建新工作表</span><br><span class="hljs-keyword">const</span> worksheet = workbook.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">pageSetup</span>: &#123; <span class="hljs-attr">paperSize</span>: <span class="hljs-number">9</span>, <span class="hljs-attr">orientation</span>: <span class="hljs-string">&#x27;landscape&#x27;</span> &#125;,<br>&#125;);<br><br><span class="hljs-comment">// 使用适合页面的pageSetup设置创建一个新的工作表编写器</span><br><span class="hljs-keyword">const</span> worksheetWriter = workbookWriter.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">pageSetup</span>: &#123; <span class="hljs-attr">fitToPage</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">fitToHeight</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">fitToWidth</span>: <span class="hljs-number">7</span> &#125;,<br>&#125;);<br><br><span class="hljs-comment">// 之后调整页面设置配置</span><br>worksheet.<span class="hljs-property">pageSetup</span>.<span class="hljs-property">margins</span> = &#123;<br>  <span class="hljs-attr">left</span>: <span class="hljs-number">0.7</span>,<br>  <span class="hljs-attr">right</span>: <span class="hljs-number">0.7</span>,<br>  <span class="hljs-attr">top</span>: <span class="hljs-number">0.75</span>,<br>  <span class="hljs-attr">bottom</span>: <span class="hljs-number">0.75</span>,<br>  <span class="hljs-attr">header</span>: <span class="hljs-number">0.3</span>,<br>  <span class="hljs-attr">footer</span>: <span class="hljs-number">0.3</span>,<br>&#125;;<br><br><span class="hljs-comment">// 设置工作表的打印区域</span><br>worksheet.<span class="hljs-property">pageSetup</span>.<span class="hljs-property">printArea</span> = <span class="hljs-string">&#x27;A1:G20&#x27;</span>;<br><br><span class="hljs-comment">// 通过使用 `&amp;&amp;` 分隔打印区域来设置多个打印区域</span><br>worksheet.<span class="hljs-property">pageSetup</span>.<span class="hljs-property">printArea</span> = <span class="hljs-string">&#x27;A1:G10&amp;&amp;A11:G20&#x27;</span>;<br><br><span class="hljs-comment">// 在每个打印页面上重复特定的行</span><br>worksheet.<span class="hljs-property">pageSetup</span>.<span class="hljs-property">printTitlesRow</span> = <span class="hljs-string">&#x27;1:3&#x27;</span>;<br><br><span class="hljs-comment">// 在每个打印页面上重复特定列</span><br>worksheet.<span class="hljs-property">pageSetup</span>.<span class="hljs-property">printTitlesColumn</span> = <span class="hljs-string">&#x27;A:C&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p><strong>支持的页面设置配置项</strong></p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>margins</td>
<td></td>
<td>页面上的空白边距。 单位为英寸。</td>
</tr>
<tr>
<td>orientation</td>
<td><code>&#39;portrait&#39;</code></td>
<td>页面方向 - 即较高 (<code>&#39;portrait&#39;</code>) 或者较宽 (<code>&#39;landscape&#39;</code>)</td>
</tr>
<tr>
<td>horizontalDpi</td>
<td>4294967295</td>
<td>水平方向上的 DPI。默认值为 <code>-1</code></td>
</tr>
<tr>
<td>verticalDpi</td>
<td>4294967295</td>
<td>垂直方向上的 DPI。默认值为 <code>-1</code></td>
</tr>
<tr>
<td>fitToPage</td>
<td></td>
<td>是否使用 <code>fitToWidth</code> 和 <code>fitToHeight</code> 或 <code>scale</code> 设置。默认基于存在于 <code>pageSetup</code> 对象中的设置-如果两者都存在，则 <code>scale</code> 优先级高（默认值为 <code>false</code>）。</td>
</tr>
<tr>
<td>pageOrder</td>
<td><code>&#39;downThenOver&#39;</code></td>
<td>打印页面的顺序-<code>[&#39;downThenOver&#39;, &#39;overThenDown&#39;]</code> 之一</td>
</tr>
<tr>
<td>blackAndWhite</td>
<td><code>false</code></td>
<td>无色打印</td>
</tr>
<tr>
<td>draft</td>
<td><code>false</code></td>
<td>打印质量较低（墨水）</td>
</tr>
<tr>
<td>cellComments</td>
<td><code>&#39;None&#39;</code></td>
<td>在何处放置批注-<code>[&#39;atEnd&#39;，&#39;asDisplayed&#39;，&#39;None&#39;]</code>中的一个</td>
</tr>
<tr>
<td>errors</td>
<td><code>&#39;displayed&#39;</code></td>
<td>哪里显示错误 -<code>[&#39;dash&#39;, &#39;blank&#39;, &#39;NA&#39;, &#39;displayed&#39;]</code> 之一</td>
</tr>
<tr>
<td>scale</td>
<td>100</td>
<td>增加或减小打印尺寸的百分比值。 当 <code>fitToPage</code> 为 <code>false</code> 时激活</td>
</tr>
<tr>
<td>fitToWidth</td>
<td>1</td>
<td>纸张应打印多少页宽。 当 <code>fitToPage</code> 为 <code>true</code> 时激活</td>
</tr>
<tr>
<td>fitToHeight</td>
<td>1</td>
<td>纸张应打印多少页高。 当 <code>fitToPage</code> 为 <code>true</code> 时激活</td>
</tr>
<tr>
<td>paperSize</td>
<td></td>
<td>使用哪种纸张尺寸（见下文）</td>
</tr>
<tr>
<td>showRowColHeaders</td>
<td>false</td>
<td>是否显示行号和列字母</td>
</tr>
<tr>
<td>showGridLines</td>
<td>false</td>
<td>是否显示网格线</td>
</tr>
<tr>
<td>firstPageNumber</td>
<td></td>
<td>第一页使用哪个页码</td>
</tr>
<tr>
<td>horizontalCentered</td>
<td>false</td>
<td>是否将工作表数据水平居中</td>
</tr>
<tr>
<td>verticalCentered</td>
<td>false</td>
<td>是否将工作表数据垂直居中</td>
</tr>
</tbody></table>
<p><strong>示例纸张尺寸</strong></p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>值</th>
</tr>
</thead>
<tbody><tr>
<td>Letter</td>
<td><code>undefined</code></td>
</tr>
<tr>
<td>Legal</td>
<td>5</td>
</tr>
<tr>
<td>Executive</td>
<td>7</td>
</tr>
<tr>
<td>A3</td>
<td>8</td>
</tr>
<tr>
<td>A4</td>
<td>9</td>
</tr>
<tr>
<td>A5</td>
<td>11</td>
</tr>
<tr>
<td>B5 (JIS)</td>
<td>13</td>
</tr>
<tr>
<td>Envelope #10</td>
<td>20</td>
</tr>
<tr>
<td>Envelope DL</td>
<td>27</td>
</tr>
<tr>
<td>Envelope C5</td>
<td>28</td>
</tr>
<tr>
<td>Envelope B5</td>
<td>34</td>
</tr>
<tr>
<td>Envelope Monarch</td>
<td>37</td>
</tr>
<tr>
<td>Double Japan Postcard Rotated</td>
<td>82</td>
</tr>
<tr>
<td>16K 197x273 mm</td>
<td>119</td>
</tr>
</tbody></table>
<h2 id="页眉和页脚⬆"><a href="#页眉和页脚⬆" class="headerlink" title="页眉和页脚⬆"></a>页眉和页脚<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>这是添加页眉和页脚的方法。<br>添加的内容主要是文本，例如时间，简介，文件信息等，您可以设置文本的样式。<br>此外，您可以为首页和偶数页设置不同的文本。</p>
<p>注意：目前不支持图片。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 创建一个带有页眉和页脚的工作表</span><br><span class="hljs-keyword">var</span> sheet = workbook.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;My Sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">headerFooter</span>: &#123; <span class="hljs-attr">firstHeader</span>: <span class="hljs-string">&#x27;Hello Exceljs&#x27;</span>, <span class="hljs-attr">firstFooter</span>: <span class="hljs-string">&#x27;Hello World&#x27;</span> &#125;,<br>&#125;);<br><br><span class="hljs-comment">// 创建一个带有页眉和页脚可写的工作表</span><br><span class="hljs-keyword">var</span> worksheetWriter = workbookWriter.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;sheet&#x27;</span>, &#123;<br>  <span class="hljs-attr">headerFooter</span>: &#123; <span class="hljs-attr">firstHeader</span>: <span class="hljs-string">&#x27;Hello Exceljs&#x27;</span>, <span class="hljs-attr">firstFooter</span>: <span class="hljs-string">&#x27;Hello World&#x27;</span> &#125;,<br>&#125;);<br><span class="hljs-comment">// 代码中出现的&amp;开头字符对应变量，相关信息可查阅下文的变量表</span><br><span class="hljs-comment">// 设置页脚(默认居中),结果：“第 2 页，共 16 页”</span><br>worksheet.<span class="hljs-property">headerFooter</span>.<span class="hljs-property">oddFooter</span> = <span class="hljs-string">&#x27;第 &amp;P 页，共 &amp;N 页&#x27;</span>;<br><br><span class="hljs-comment">// 将页脚（默认居中）设置为粗体，结果是：“第2页，共16页”</span><br>worksheet.<span class="hljs-property">headerFooter</span>.<span class="hljs-property">oddFooter</span> = <span class="hljs-string">&#x27;Page &amp;P of &amp;N&#x27;</span>;<br><br><span class="hljs-comment">// 将左页脚设置为 18px 并以斜体显示。 结果：“第2页，共16页”</span><br>worksheet.<span class="hljs-property">headerFooter</span>.<span class="hljs-property">oddFooter</span> = <span class="hljs-string">&#x27;&amp;LPage &amp;P of &amp;N&#x27;</span>;<br><br><span class="hljs-comment">// 将中间标题设置为灰色Aril，结果为：“ 52 exceljs”</span><br>worksheet.<span class="hljs-property">headerFooter</span>.<span class="hljs-property">oddHeader</span> = <span class="hljs-string">&#x27;&amp;C&amp;KCCCCCC&amp;&quot;Aril&quot;52 exceljs&#x27;</span>;<br><br><span class="hljs-comment">// 设置页脚的左，中和右文本。 结果：页脚左侧为“ Exceljs”。 页脚中心的“ demo.xlsx”。 页脚右侧的“第2页”</span><br>worksheet.<span class="hljs-property">headerFooter</span>.<span class="hljs-property">oddFooter</span> = <span class="hljs-string">&#x27;&amp;Lexceljs&amp;C&amp;F&amp;RPage &amp;P&#x27;</span>;<br><br><span class="hljs-comment">// 在首页添加不同的页眉和页脚</span><br>worksheet.<span class="hljs-property">headerFooter</span>.<span class="hljs-property">differentFirst</span> = <span class="hljs-literal">true</span>;<br>worksheet.<span class="hljs-property">headerFooter</span>.<span class="hljs-property">firstHeader</span> = <span class="hljs-string">&#x27;Hello Exceljs&#x27;</span>;<br>worksheet.<span class="hljs-property">headerFooter</span>.<span class="hljs-property">firstFooter</span> = <span class="hljs-string">&#x27;Hello World&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p><strong>支持的 headerFooter 设置</strong></p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>differentFirst</td>
<td><code>false</code></td>
<td>将 <code>differentFirst</code> 的值设置为 <code>true</code>，这表示第一页的页眉/页脚与其他页不同</td>
</tr>
<tr>
<td>differentOddEven</td>
<td><code>false</code></td>
<td>将 <code>differentOddEven</code> 的值设置为 <code>true</code>，表示奇数页和偶数页的页眉/页脚不同</td>
</tr>
<tr>
<td>oddHeader</td>
<td><code>null</code></td>
<td>设置奇数（默认）页面的标题字符串，可以设置格式化字符串</td>
</tr>
<tr>
<td>oddFooter</td>
<td><code>null</code></td>
<td>设置奇数（默认）页面的页脚字符串，可以设置格式化字符串</td>
</tr>
<tr>
<td>evenHeader</td>
<td><code>null</code></td>
<td>设置偶数页的标题字符串，可以设置格式化字符串</td>
</tr>
<tr>
<td>evenFooter</td>
<td><code>null</code></td>
<td>为偶数页设置页脚字符串，可以设置格式化字符串</td>
</tr>
<tr>
<td>firstHeader</td>
<td><code>null</code></td>
<td>设置首页的标题字符串，可以设置格式化字符串</td>
</tr>
<tr>
<td>firstFooter</td>
<td><code>null</code></td>
<td>设置首页的页脚字符串，可以设置格式化字符串</td>
</tr>
</tbody></table>
<p><strong>脚本命令</strong></p>
<table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>&amp;L</td>
<td>将位置设定在左侧</td>
</tr>
<tr>
<td>&amp;C</td>
<td>将位置设置在中心</td>
</tr>
<tr>
<td>&amp;R</td>
<td>将位置设定在右边</td>
</tr>
<tr>
<td>&amp;P</td>
<td>当前页码</td>
</tr>
<tr>
<td>&amp;N</td>
<td>总页数</td>
</tr>
<tr>
<td>&amp;D</td>
<td>当前日期</td>
</tr>
<tr>
<td>&amp;T</td>
<td>当前时间</td>
</tr>
<tr>
<td>&amp;G</td>
<td>照片</td>
</tr>
<tr>
<td>&amp;A</td>
<td>工作表名称</td>
</tr>
<tr>
<td>&amp;F</td>
<td>文件名称</td>
</tr>
<tr>
<td>&amp;B</td>
<td>加粗文本</td>
</tr>
<tr>
<td>&amp;I</td>
<td>斜体文本</td>
</tr>
<tr>
<td>&amp;U</td>
<td>文本下划线</td>
</tr>
<tr>
<td>&amp;”font name”</td>
<td>字体名称，例如＆“ Aril”</td>
</tr>
<tr>
<td>&amp;font size</td>
<td>字体大小，例如 12</td>
</tr>
<tr>
<td>&amp;KHEXCode</td>
<td>字体颜色，例如 &amp;KCCCCCC</td>
</tr>
</tbody></table>
<h2 id="工作表视图⬆"><a href="#工作表视图⬆" class="headerlink" title="工作表视图⬆"></a>工作表视图<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>现在，工作表支持视图列表，这些视图控制 Excel 如何显示工作表：</p>
<ul>
<li><code>frozen</code> - 顶部和左侧的许多行和列被冻结在适当的位置。 仅右下部分会滚动</li>
<li><code>split</code> - 该视图分为 4 个部分，每个部分可半独立滚动。</li>
</ul>
<p>每个视图还支持各种属性：</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>state</td>
<td><code>&#39;normal&#39;</code></td>
<td>控制视图状态 - <code>&#39;normal&#39;</code>, <code>&#39;frozen&#39;</code> 或者 <code>&#39;split&#39;</code> 之一</td>
</tr>
<tr>
<td>rightToLeft</td>
<td><code>false</code></td>
<td>将工作表视图的方向设置为从右到左</td>
</tr>
<tr>
<td>activeCell</td>
<td><code>undefined</code></td>
<td>当前选择的单元格</td>
</tr>
<tr>
<td>showRuler</td>
<td><code>true</code></td>
<td>在页面布局中显示或隐藏标尺</td>
</tr>
<tr>
<td>showRowColHeaders</td>
<td><code>true</code></td>
<td>显示或隐藏行标题和列标题（例如，顶部的 A1，B1 和左侧的 1,2,3）</td>
</tr>
<tr>
<td>showGridLines</td>
<td><code>true</code></td>
<td>显示或隐藏网格线（针对未定义边框的单元格显示）</td>
</tr>
<tr>
<td>zoomScale</td>
<td>100</td>
<td>用于视图的缩放比例</td>
</tr>
<tr>
<td>zoomScaleNormal</td>
<td>100</td>
<td>正常缩放视图</td>
</tr>
<tr>
<td>style</td>
<td><code>undefined</code></td>
<td>演示样式- <code>pageBreakPreview</code> 或 <code>pageLayout</code> 之一。 注意：页面布局与 <code>frozen</code> 视图不兼容</td>
</tr>
</tbody></table>
<h3 id="冻结视图⬆"><a href="#冻结视图⬆" class="headerlink" title="冻结视图⬆"></a>冻结视图<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>冻结视图支持以下额外属性：</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>xSplit</td>
<td>0</td>
<td>冻结多少列。要仅冻结行，请将其设置为 <code>0</code> 或 <code>undefined</code></td>
</tr>
<tr>
<td>ySplit</td>
<td>0</td>
<td>冻结多少行。要仅冻结列，请将其设置为 <code>0</code> 或 <code>undefined</code></td>
</tr>
<tr>
<td>topLeftCell</td>
<td>special</td>
<td>哪个单元格将在右下窗格中的左上角。注意：不能是冻结单元格。默认为第一个未冻结的单元格</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-property">views</span> = [<br>  &#123;<br>    <span class="hljs-attr">state</span>: <span class="hljs-string">&#x27;frozen&#x27;</span>,<br>    <span class="hljs-attr">xSplit</span>: <span class="hljs-number">2</span>,<br>    <span class="hljs-attr">ySplit</span>: <span class="hljs-number">3</span>,<br>    <span class="hljs-attr">topLeftCell</span>: <span class="hljs-string">&#x27;G10&#x27;</span>,<br>    <span class="hljs-attr">activeCell</span>: <span class="hljs-string">&#x27;A1&#x27;</span>,<br>  &#125;,<br>];<br></code></pre></td></tr></table></figure>

<h3 id="拆分视图⬆"><a href="#拆分视图⬆" class="headerlink" title="拆分视图⬆"></a>拆分视图<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>拆分视图支持以下额外属性：</p>
<table>
<thead>
<tr>
<th>属性名</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>xSplit</td>
<td>0</td>
<td>从左侧多少个点起，以放置拆分器。要垂直拆分，请将其设置为 <code>0</code> 或 <code>undefined</code></td>
</tr>
<tr>
<td>ySplit</td>
<td>0</td>
<td>从顶部多少个点起，放置拆分器。要水平拆分，请将其设置为 <code>0</code> 或 <code>undefined</code></td>
</tr>
<tr>
<td>topLeftCell</td>
<td><code>undefined</code></td>
<td>哪个单元格将在右下窗格中的左上角。</td>
</tr>
<tr>
<td>activePane</td>
<td><code>undefined</code></td>
<td>哪个窗格将处于活动状态-<code>topLeft</code>，<code>topRight</code>，<code>bottomLeft</code> 和 <code>bottomRight</code> 中的一个</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-property">views</span> = [<br>  &#123;<br>    <span class="hljs-attr">state</span>: <span class="hljs-string">&#x27;split&#x27;</span>,<br>    <span class="hljs-attr">xSplit</span>: <span class="hljs-number">2000</span>,<br>    <span class="hljs-attr">ySplit</span>: <span class="hljs-number">3000</span>,<br>    <span class="hljs-attr">topLeftCell</span>: <span class="hljs-string">&#x27;G10&#x27;</span>,<br>    <span class="hljs-attr">activeCell</span>: <span class="hljs-string">&#x27;A1&#x27;</span>,<br>  &#125;,<br>];<br></code></pre></td></tr></table></figure>

<h2 id="自动筛选器⬆"><a href="#自动筛选器⬆" class="headerlink" title="自动筛选器⬆"></a>自动筛选器<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>可以对工作表应用自动筛选器。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-property">autoFilter</span> = <span class="hljs-string">&#x27;A1:C1&#x27;</span>;<br></code></pre></td></tr></table></figure>

<p>尽管范围字符串是 <code>autoFilter</code> 的标准形式，但工作表还将支持以下值：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 将自动筛选器设置为从 A1 到 C1</span><br>worksheet.<span class="hljs-property">autoFilter</span> = &#123;<br>  <span class="hljs-attr">from</span>: <span class="hljs-string">&#x27;A1&#x27;</span>,<br>  <span class="hljs-attr">to</span>: <span class="hljs-string">&#x27;C1&#x27;</span>,<br>&#125;;<br><br><span class="hljs-comment">// 将自动筛选器设置为从第3行第1列的单元格到第5行第12列的单元格</span><br>worksheet.<span class="hljs-property">autoFilter</span> = &#123;<br>  <span class="hljs-attr">from</span>: &#123;<br>    <span class="hljs-attr">row</span>: <span class="hljs-number">3</span>,<br>    <span class="hljs-attr">column</span>: <span class="hljs-number">1</span>,<br>  &#125;,<br>  <span class="hljs-attr">to</span>: &#123;<br>    <span class="hljs-attr">row</span>: <span class="hljs-number">5</span>,<br>    <span class="hljs-attr">column</span>: <span class="hljs-number">12</span>,<br>  &#125;,<br>&#125;;<br><br><span class="hljs-comment">// 将自动筛选器设置为从D3到第7行第5列中的单元格</span><br>worksheet.<span class="hljs-property">autoFilter</span> = &#123;<br>  <span class="hljs-attr">from</span>: <span class="hljs-string">&#x27;D3&#x27;</span>,<br>  <span class="hljs-attr">to</span>: &#123;<br>    <span class="hljs-attr">row</span>: <span class="hljs-number">7</span>,<br>    <span class="hljs-attr">column</span>: <span class="hljs-number">5</span>,<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="列⬆"><a href="#列⬆" class="headerlink" title="列⬆"></a>列<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 添加列标题并定义列键和宽度</span><br><span class="hljs-comment">// 注意：这些列结构仅是构建工作簿的方便之处，除了列宽之外，它们不会完全保留。</span><br>worksheet.<span class="hljs-property">columns</span> = [<br>  &#123; <span class="hljs-attr">header</span>: <span class="hljs-string">&#x27;Id&#x27;</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">10</span> &#125;,<br>  &#123; <span class="hljs-attr">header</span>: <span class="hljs-string">&#x27;Name&#x27;</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">32</span> &#125;,<br>  &#123; <span class="hljs-attr">header</span>: <span class="hljs-string">&#x27;D.O.B.&#x27;</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;DOB&#x27;</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">outlineLevel</span>: <span class="hljs-number">1</span> &#125;,<br>];<br><br><span class="hljs-comment">// 通过键，字母和基于1的列号访问单个列</span><br><span class="hljs-keyword">const</span> idCol = worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-string">&#x27;id&#x27;</span>);<br><span class="hljs-keyword">const</span> nameCol = worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-string">&#x27;B&#x27;</span>);<br><span class="hljs-keyword">const</span> dobCol = worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">3</span>);<br><br><span class="hljs-comment">// 设置列属性</span><br><br><span class="hljs-comment">// 注意：将覆盖 C1 单元格值</span><br>dobCol.<span class="hljs-property">header</span> = <span class="hljs-string">&#x27;Date of Birth&#x27;</span>;<br><br><span class="hljs-comment">// 注意：这将覆盖 C1:C2 单元格值</span><br>dobCol.<span class="hljs-property">header</span> = [<span class="hljs-string">&#x27;Date of Birth&#x27;</span>, <span class="hljs-string">&#x27;A.K.A. D.O.B.&#x27;</span>];<br><br><span class="hljs-comment">// 从现在开始，此列将以 “dob” 而不是 “DOB” 建立索引</span><br>dobCol.<span class="hljs-property">key</span> = <span class="hljs-string">&#x27;dob&#x27;</span>;<br><br>dobCol.<span class="hljs-property">width</span> = <span class="hljs-number">15</span>;<br><br><span class="hljs-comment">// 如果需要，隐藏列</span><br>dobCol.<span class="hljs-property">hidden</span> = <span class="hljs-literal">true</span>;<br><br><span class="hljs-comment">// 为列设置大纲级别</span><br>worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">4</span>).<span class="hljs-property">outlineLevel</span> = <span class="hljs-number">0</span>;<br>worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">5</span>).<span class="hljs-property">outlineLevel</span> = <span class="hljs-number">1</span>;<br><br><span class="hljs-comment">// 列支持一个只读字段，以指示基于 `OutlineLevel` 的折叠状态</span><br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">4</span>).<span class="hljs-property">collapsed</span>).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-literal">false</span>);<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">5</span>).<span class="hljs-property">collapsed</span>).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-literal">true</span>);<br><br><span class="hljs-comment">// 遍历此列中的所有当前单元格</span><br>dobCol.<span class="hljs-title function_">eachCell</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">cell, rowNumber</span>) &#123;<br>  <span class="hljs-comment">// ...</span><br>&#125;);<br><br><span class="hljs-comment">// 遍历此列中的所有当前单元格，包括空单元格</span><br>dobCol.<span class="hljs-title function_">eachCell</span>(&#123; <span class="hljs-attr">includeEmpty</span>: <span class="hljs-literal">true</span> &#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params">cell, rowNumber</span>) &#123;<br>  <span class="hljs-comment">// ...</span><br>&#125;);<br><br><span class="hljs-comment">// 添加一列新值</span><br>worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">6</span>).<span class="hljs-property">values</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br><br><span class="hljs-comment">// 添加稀疏列值</span><br>worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">7</span>).<span class="hljs-property">values</span> = [, , <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, , <span class="hljs-number">5</span>, , <span class="hljs-number">7</span>, , , , <span class="hljs-number">11</span>];<br><br><span class="hljs-comment">// 剪切一列或多列（右边的列向左移动）</span><br><span class="hljs-comment">// 如果定义了列属性，则会相应地对其进行切割或移动</span><br><span class="hljs-comment">// 已知问题：如果拼接导致任何合并的单元格移动，结果可能是不可预测的</span><br>worksheet.<span class="hljs-title function_">spliceColumns</span>(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>);<br><br><span class="hljs-comment">// 删除一列，再插入两列。</span><br><span class="hljs-comment">// 注意：第4列及以上的列将右移1列。</span><br><span class="hljs-comment">// 另外：如果工作表中的行数多于列插入项中的值，则行将仍然被插入，就好像值存在一样。</span><br><span class="hljs-keyword">const</span> newCol3Values = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br><span class="hljs-keyword">const</span> newCol4Values = [<span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;three&#x27;</span>, <span class="hljs-string">&#x27;four&#x27;</span>, <span class="hljs-string">&#x27;five&#x27;</span>];<br>worksheet.<span class="hljs-title function_">spliceColumns</span>(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, newCol3Values, newCol4Values);<br></code></pre></td></tr></table></figure>

<h2 id="行⬆"><a href="#行⬆" class="headerlink" title="行⬆"></a>行<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 获取一个行对象。如果尚不存在，则将返回一个新的空对象</span><br><span class="hljs-keyword">const</span> row = worksheet.<span class="hljs-title function_">getRow</span>(<span class="hljs-number">5</span>);<br><br><span class="hljs-comment">// Get multiple row objects. If it doesn&#x27;t already exist, new empty ones will be returned</span><br><span class="hljs-keyword">const</span> rows = worksheet.<span class="hljs-title function_">getRows</span>(<span class="hljs-number">5</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">// start, length (&gt;0, else undefined is returned)</span><br><br><span class="hljs-comment">// 获取工作表中的最后一个可编辑行（如果没有，则为 `undefined`）</span><br><span class="hljs-keyword">const</span> row = worksheet.<span class="hljs-property">lastRow</span>;<br><br><span class="hljs-comment">// 设置特定的行高</span><br>row.<span class="hljs-property">height</span> = <span class="hljs-number">42.5</span>;<br><br><span class="hljs-comment">// 隐藏行</span><br>row.<span class="hljs-property">hidden</span> = <span class="hljs-literal">true</span>;<br><br><span class="hljs-comment">// 为行设置大纲级别</span><br>worksheet.<span class="hljs-title function_">getRow</span>(<span class="hljs-number">4</span>).<span class="hljs-property">outlineLevel</span> = <span class="hljs-number">0</span>;<br>worksheet.<span class="hljs-title function_">getRow</span>(<span class="hljs-number">5</span>).<span class="hljs-property">outlineLevel</span> = <span class="hljs-number">1</span>;<br><br><span class="hljs-comment">// 行支持一个只读字段，以指示基于 `OutlineLevel` 的折叠状态</span><br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getRow</span>(<span class="hljs-number">4</span>).<span class="hljs-property">collapsed</span>).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-literal">false</span>);<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getRow</span>(<span class="hljs-number">5</span>).<span class="hljs-property">collapsed</span>).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-literal">true</span>);<br><br>row.<span class="hljs-title function_">getCell</span>(<span class="hljs-number">1</span>).<span class="hljs-property">value</span> = <span class="hljs-number">5</span>; <span class="hljs-comment">// A5 的值设置为5</span><br>row.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;name&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;Zeb&#x27;</span>; <span class="hljs-comment">// B5 的值设置为 “Zeb” - 假设第2列仍按名称键入</span><br>row.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;C&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(); <span class="hljs-comment">// C5 的值设置为当前时间</span><br><br><span class="hljs-comment">// 获取行并作为稀疏数组返回</span><br><span class="hljs-comment">// 注意：接口更改：worksheet.getRow(4) ==&gt; worksheet.getRow(4).values</span><br>row = worksheet.<span class="hljs-title function_">getRow</span>(<span class="hljs-number">4</span>).<span class="hljs-property">values</span>;<br><span class="hljs-title function_">expect</span>(row[<span class="hljs-number">5</span>]).<span class="hljs-title function_">toEqual</span>(<span class="hljs-string">&#x27;Kyle&#x27;</span>);<br><br><span class="hljs-comment">// 通过连续数组分配行值（其中数组元素 0 具有值）</span><br>row.<span class="hljs-property">values</span> = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];<br><span class="hljs-title function_">expect</span>(row.<span class="hljs-title function_">getCell</span>(<span class="hljs-number">1</span>).<span class="hljs-property">value</span>).<span class="hljs-title function_">toEqual</span>(<span class="hljs-number">1</span>);<br><span class="hljs-title function_">expect</span>(row.<span class="hljs-title function_">getCell</span>(<span class="hljs-number">2</span>).<span class="hljs-property">value</span>).<span class="hljs-title function_">toEqual</span>(<span class="hljs-number">2</span>);<br><span class="hljs-title function_">expect</span>(row.<span class="hljs-title function_">getCell</span>(<span class="hljs-number">3</span>).<span class="hljs-property">value</span>).<span class="hljs-title function_">toEqual</span>(<span class="hljs-number">3</span>);<br><br><span class="hljs-comment">// 通过稀疏数组分配行值（其中数组元素 0 为 `undefined`）</span><br><span class="hljs-keyword">const</span> values = [];<br>values[<span class="hljs-number">5</span>] = <span class="hljs-number">7</span>;<br>values[<span class="hljs-number">10</span>] = <span class="hljs-string">&#x27;Hello, World!&#x27;</span>;<br>row.<span class="hljs-property">values</span> = values;<br><span class="hljs-title function_">expect</span>(row.<span class="hljs-title function_">getCell</span>(<span class="hljs-number">1</span>).<span class="hljs-property">value</span>).<span class="hljs-title function_">toBeNull</span>();<br><span class="hljs-title function_">expect</span>(row.<span class="hljs-title function_">getCell</span>(<span class="hljs-number">5</span>).<span class="hljs-property">value</span>).<span class="hljs-title function_">toEqual</span>(<span class="hljs-number">7</span>);<br><span class="hljs-title function_">expect</span>(row.<span class="hljs-title function_">getCell</span>(<span class="hljs-number">10</span>).<span class="hljs-property">value</span>).<span class="hljs-title function_">toEqual</span>(<span class="hljs-string">&#x27;Hello, World!&#x27;</span>);<br><br><span class="hljs-comment">// 使用列键按对象分配行值</span><br>row.<span class="hljs-property">values</span> = &#123;<br>  <span class="hljs-attr">id</span>: <span class="hljs-number">13</span>,<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Thing 1&#x27;</span>,<br>  <span class="hljs-attr">dob</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(),<br>&#125;;<br><br><span class="hljs-comment">// 在该行下方插入一个分页符</span><br>row.<span class="hljs-title function_">addPageBreak</span>();<br><br><span class="hljs-comment">// 遍历工作表中具有值的所有行</span><br>worksheet.<span class="hljs-title function_">eachRow</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">row, rowNumber</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Row &#x27;</span> + rowNumber + <span class="hljs-string">&#x27; = &#x27;</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(row.<span class="hljs-property">values</span>));<br>&#125;);<br><br><span class="hljs-comment">// 遍历工作表中的所有行（包括空行）</span><br>worksheet.<span class="hljs-title function_">eachRow</span>(&#123; <span class="hljs-attr">includeEmpty</span>: <span class="hljs-literal">true</span> &#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params">row, rowNumber</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Row &#x27;</span> + rowNumber + <span class="hljs-string">&#x27; = &#x27;</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(row.<span class="hljs-property">values</span>));<br>&#125;);<br><br><span class="hljs-comment">// 连续遍历所有非空单元格</span><br>row.<span class="hljs-title function_">eachCell</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">cell, colNumber</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Cell &#x27;</span> + colNumber + <span class="hljs-string">&#x27; = &#x27;</span> + cell.<span class="hljs-property">value</span>);<br>&#125;);<br><br><span class="hljs-comment">// 遍历一行中的所有单元格（包括空单元格）</span><br>row.<span class="hljs-title function_">eachCell</span>(&#123; <span class="hljs-attr">includeEmpty</span>: <span class="hljs-literal">true</span> &#125;, <span class="hljs-keyword">function</span> (<span class="hljs-params">cell, colNumber</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Cell &#x27;</span> + colNumber + <span class="hljs-string">&#x27; = &#x27;</span> + cell.<span class="hljs-property">value</span>);<br>&#125;);<br><br><span class="hljs-comment">// 提交给流一个完成的行</span><br>row.<span class="hljs-title function_">commit</span>();<br><br><span class="hljs-comment">// 行尺寸</span><br><span class="hljs-keyword">const</span> rowSize = row.<span class="hljs-property">cellCount</span>;<br><span class="hljs-keyword">const</span> numValues = row.<span class="hljs-property">actualCellCount</span>;<br></code></pre></td></tr></table></figure>

<h2 id="Add-Rows⬆"><a href="#Add-Rows⬆" class="headerlink" title="Add Rows⬆"></a>Add Rows<a href="#contents">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// Add a couple of Rows by key-value, after the last current row, using the column keys</span><br>worksheet.<span class="hljs-title function_">addRow</span>(&#123; <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;John Doe&#x27;</span>, <span class="hljs-attr">dob</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">1970</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) &#125;);<br>worksheet.<span class="hljs-title function_">addRow</span>(&#123; <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Jane Doe&#x27;</span>, <span class="hljs-attr">dob</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">1965</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>) &#125;);<br><br><span class="hljs-comment">// Add a row by contiguous Array (assign to columns A, B &amp; C)</span><br>worksheet.<span class="hljs-title function_">addRow</span>([<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;Sam&#x27;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()]);<br><br><span class="hljs-comment">// Add a row by sparse Array (assign to columns A, E &amp; I)</span><br><span class="hljs-keyword">const</span> rowValues = [];<br>rowValues[<span class="hljs-number">1</span>] = <span class="hljs-number">4</span>;<br>rowValues[<span class="hljs-number">5</span>] = <span class="hljs-string">&#x27;Kyle&#x27;</span>;<br>rowValues[<span class="hljs-number">9</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();<br>worksheet.<span class="hljs-title function_">addRow</span>(rowValues);<br><br><span class="hljs-comment">// Add a row with inherited style</span><br><span class="hljs-comment">// This new row will have same style as last row</span><br><span class="hljs-comment">// And return as row object</span><br><span class="hljs-keyword">const</span> newRow = worksheet.<span class="hljs-title function_">addRow</span>(rowValues, <span class="hljs-string">&#x27;i&#x27;</span>);<br><br><span class="hljs-comment">// Add an array of rows</span><br><span class="hljs-keyword">const</span> rows = [<br>  [<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()], <span class="hljs-comment">// row by array</span><br>  &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">6</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Barbara&#x27;</span>, <span class="hljs-attr">dob</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>() &#125;,<br>];<br><span class="hljs-comment">// add new rows and return them as array of row objects</span><br><span class="hljs-keyword">const</span> newRows = worksheet.<span class="hljs-title function_">addRows</span>(rows);<br><br><span class="hljs-comment">// Add an array of rows with inherited style</span><br><span class="hljs-comment">// These new rows will have same styles as last row</span><br><span class="hljs-comment">// and return them as array of row objects</span><br><span class="hljs-keyword">const</span> newRowsStyled = worksheet.<span class="hljs-title function_">addRows</span>(rows, <span class="hljs-string">&#x27;i&#x27;</span>);<br></code></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody><tr>
<td>value/s</td>
<td>The new row/s values</td>
<td></td>
</tr>
<tr>
<td>style</td>
<td>‘i’ for inherit from row above, ‘i+’ to include empty cells, ‘n’ for none</td>
<td><em>‘n’</em></td>
</tr>
</tbody></table>
<h2 id="处理单个单元格⬆"><a href="#处理单个单元格⬆" class="headerlink" title="处理单个单元格⬆"></a>处理单个单元格<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> cell = worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;C3&#x27;</span>);<br><br><span class="hljs-comment">// 修改/添加单个单元格</span><br>cell.<span class="hljs-property">value</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">1968</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>);<br><br><span class="hljs-comment">// 查询单元格的类型</span><br><span class="hljs-title function_">expect</span>(cell.<span class="hljs-property">type</span>).<span class="hljs-title function_">toEqual</span>(<span class="hljs-title class_">Excel</span>.<span class="hljs-property">ValueType</span>.<span class="hljs-property">Date</span>);<br><br><span class="hljs-comment">// 使用单元格的字符串值</span><br>myInput.<span class="hljs-property">value</span> = cell.<span class="hljs-property">text</span>;<br><br><span class="hljs-comment">// 使用 html 安全的字符串进行渲染...</span><br><span class="hljs-keyword">const</span> html = <span class="hljs-string">&#x27;&lt;div&gt;&#x27;</span> + cell.<span class="hljs-property">html</span> + <span class="hljs-string">&#x27;&lt;/div&gt;&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h2 id="合并单元格⬆"><a href="#合并单元格⬆" class="headerlink" title="合并单元格⬆"></a>合并单元格<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 合并一系列单元格</span><br>worksheet.<span class="hljs-title function_">mergeCells</span>(<span class="hljs-string">&#x27;A4:B5&#x27;</span>);<br><br><span class="hljs-comment">// ...合并的单元格被链接起来了</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B5&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;Hello, World!&#x27;</span>;<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B5&#x27;</span>).<span class="hljs-property">value</span>).<span class="hljs-title function_">toBe</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A4&#x27;</span>).<span class="hljs-property">value</span>);<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B5&#x27;</span>).<span class="hljs-property">master</span>).<span class="hljs-title function_">toBe</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A4&#x27;</span>));<br><br><span class="hljs-comment">// ...合并的单元格共享相同的样式对象</span><br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B5&#x27;</span>).<span class="hljs-property">style</span>).<span class="hljs-title function_">toBe</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A4&#x27;</span>).<span class="hljs-property">style</span>);<br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B5&#x27;</span>).<span class="hljs-property">style</span>.<span class="hljs-property">font</span> = myFonts.<span class="hljs-property">arial</span>;<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A4&#x27;</span>).<span class="hljs-property">style</span>.<span class="hljs-property">font</span>).<span class="hljs-title function_">toBe</span>(myFonts.<span class="hljs-property">arial</span>);<br><br><span class="hljs-comment">// 取消单元格合并将打破链接的样式</span><br>worksheet.<span class="hljs-title function_">unMergeCells</span>(<span class="hljs-string">&#x27;A4&#x27;</span>);<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B5&#x27;</span>).<span class="hljs-property">style</span>).<span class="hljs-property">not</span>.<span class="hljs-title function_">toBe</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A4&#x27;</span>).<span class="hljs-property">style</span>);<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B5&#x27;</span>).<span class="hljs-property">style</span>.<span class="hljs-property">font</span>).<span class="hljs-property">not</span>.<span class="hljs-title function_">toBe</span>(myFonts.<span class="hljs-property">arial</span>);<br><br><span class="hljs-comment">// 按左上，右下合并</span><br>worksheet.<span class="hljs-title function_">mergeCells</span>(<span class="hljs-string">&#x27;K10&#x27;</span>, <span class="hljs-string">&#x27;M12&#x27;</span>);<br><br><span class="hljs-comment">// 按开始行，开始列，结束行，结束列合并（相当于 K10:M12）</span><br>worksheet.<span class="hljs-title function_">mergeCells</span>(<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>, <span class="hljs-number">13</span>);<br></code></pre></td></tr></table></figure>

<h2 id="Insert-Rows⬆"><a href="#Insert-Rows⬆" class="headerlink" title="Insert Rows⬆"></a>Insert Rows<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">insertRow</span>(pos, value, (style = <span class="hljs-string">&#x27;n&#x27;</span>));<br><span class="hljs-title function_">insertRows</span>(pos, values, (style = <span class="hljs-string">&#x27;n&#x27;</span>));<br><br><span class="hljs-comment">// Insert a couple of Rows by key-value, shifting down rows every time</span><br>worksheet.<span class="hljs-title function_">insertRow</span>(<span class="hljs-number">1</span>, &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;John Doe&#x27;</span>, <span class="hljs-attr">dob</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">1970</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>) &#125;);<br>worksheet.<span class="hljs-title function_">insertRow</span>(<span class="hljs-number">1</span>, &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Jane Doe&#x27;</span>, <span class="hljs-attr">dob</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">1965</span>, <span class="hljs-number">1</span>, <span class="hljs-number">7</span>) &#125;);<br><br><span class="hljs-comment">// Insert a row by contiguous Array (assign to columns A, B &amp; C)</span><br>worksheet.<span class="hljs-title function_">insertRow</span>(<span class="hljs-number">1</span>, [<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;Sam&#x27;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()]);<br><br><span class="hljs-comment">// Insert a row by sparse Array (assign to columns A, E &amp; I)</span><br><span class="hljs-keyword">var</span> rowValues = [];<br>rowValues[<span class="hljs-number">1</span>] = <span class="hljs-number">4</span>;<br>rowValues[<span class="hljs-number">5</span>] = <span class="hljs-string">&#x27;Kyle&#x27;</span>;<br>rowValues[<span class="hljs-number">9</span>] = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>();<br><span class="hljs-comment">// insert new row and return as row object</span><br><span class="hljs-keyword">const</span> insertedRow = worksheet.<span class="hljs-title function_">insertRow</span>(<span class="hljs-number">1</span>, rowValues);<br><br><span class="hljs-comment">// Insert a row, with inherited style</span><br><span class="hljs-comment">// This new row will have same style as row on top of it</span><br><span class="hljs-comment">// And return as row object</span><br><span class="hljs-keyword">const</span> insertedRowInherited = worksheet.<span class="hljs-title function_">insertRow</span>(<span class="hljs-number">1</span>, rowValues, <span class="hljs-string">&#x27;i&#x27;</span>);<br><br><span class="hljs-comment">// Insert a row, keeping original style</span><br><span class="hljs-comment">// This new row will have same style as it was previously</span><br><span class="hljs-comment">// And return as row object</span><br><span class="hljs-keyword">const</span> insertedRowOriginal = worksheet.<span class="hljs-title function_">insertRow</span>(<span class="hljs-number">1</span>, rowValues, <span class="hljs-string">&#x27;o&#x27;</span>);<br><br><span class="hljs-comment">// Insert an array of rows, in position 1, shifting down current position 1 and later rows by 2 rows</span><br><span class="hljs-keyword">var</span> rows = [<br>  [<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;Bob&#x27;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>()], <span class="hljs-comment">// row by array</span><br>  &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">6</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Barbara&#x27;</span>, <span class="hljs-attr">dob</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>() &#125;,<br>];<br><span class="hljs-comment">// insert new rows and return them as array of row objects</span><br><span class="hljs-keyword">const</span> insertedRows = worksheet.<span class="hljs-title function_">insertRows</span>(<span class="hljs-number">1</span>, rows);<br><br><span class="hljs-comment">// Insert an array of rows, with inherited style</span><br><span class="hljs-comment">// These new rows will have same style as row on top of it</span><br><span class="hljs-comment">// And return them as array of row objects</span><br><span class="hljs-keyword">const</span> insertedRowsInherited = worksheet.<span class="hljs-title function_">insertRows</span>(<span class="hljs-number">1</span>, rows, <span class="hljs-string">&#x27;i&#x27;</span>);<br><br><span class="hljs-comment">// Insert an array of rows, keeping original style</span><br><span class="hljs-comment">// These new rows will have same style as it was previously in &#x27;pos&#x27; position</span><br><span class="hljs-keyword">const</span> insertedRowsOriginal = worksheet.<span class="hljs-title function_">insertRows</span>(<span class="hljs-number">1</span>, rows, <span class="hljs-string">&#x27;o&#x27;</span>);<br></code></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody><tr>
<td>pos</td>
<td>Row number where you want to insert, pushing down all rows from there</td>
<td></td>
</tr>
<tr>
<td>value/s</td>
<td>The new row/s values</td>
<td></td>
</tr>
<tr>
<td>style</td>
<td>‘i’ for inherit from row above, , ‘i+’ to include empty cells, ‘o’ for original style, ‘o+’ to include empty cells, ‘n’ for none</td>
<td><em>‘n’</em></td>
</tr>
</tbody></table>
<h2 id="Splice⬆"><a href="#Splice⬆" class="headerlink" title="Splice⬆"></a>Splice<a href="#contents">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// Cut one or more rows (rows below are shifted up)</span><br><span class="hljs-comment">// Known Issue: If a splice causes any merged cells to move, the results may be unpredictable</span><br>worksheet.<span class="hljs-title function_">spliceRows</span>(<span class="hljs-number">4</span>, <span class="hljs-number">3</span>);<br><br><span class="hljs-comment">// remove one row and insert two more.</span><br><span class="hljs-comment">// Note: rows 4 and below will be shifted down by 1 row.</span><br><span class="hljs-keyword">const</span> newRow3Values = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];<br><span class="hljs-keyword">const</span> newRow4Values = [<span class="hljs-string">&#x27;one&#x27;</span>, <span class="hljs-string">&#x27;two&#x27;</span>, <span class="hljs-string">&#x27;three&#x27;</span>, <span class="hljs-string">&#x27;four&#x27;</span>, <span class="hljs-string">&#x27;five&#x27;</span>];<br>worksheet.<span class="hljs-title function_">spliceRows</span>(<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, newRow3Values, newRow4Values);<br><br><span class="hljs-comment">// Cut one or more cells (cells to the right are shifted left)</span><br><span class="hljs-comment">// Note: this operation will not affect other rows</span><br>row.<span class="hljs-title function_">splice</span>(<span class="hljs-number">3</span>, <span class="hljs-number">2</span>);<br><br><span class="hljs-comment">// remove one cell and insert two more (cells to the right of the cut cell will be shifted right)</span><br>row.<span class="hljs-title function_">splice</span>(<span class="hljs-number">4</span>, <span class="hljs-number">1</span>, <span class="hljs-string">&#x27;new value 1&#x27;</span>, <span class="hljs-string">&#x27;new value 2&#x27;</span>);<br></code></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
<th>Default Value</th>
</tr>
</thead>
<tbody><tr>
<td>start</td>
<td>Starting point to splice from</td>
<td></td>
</tr>
<tr>
<td>count</td>
<td>Number of rows/cells to remove</td>
<td></td>
</tr>
<tr>
<td>…inserts</td>
<td>New row/cell values to insert</td>
<td></td>
</tr>
</tbody></table>
<h2 id="重复行⬆"><a href="#重复行⬆" class="headerlink" title="重复行⬆"></a>重复行<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">duplicateRow</span>(start, (amount = <span class="hljs-number">1</span>), (insert = <span class="hljs-literal">true</span>));<br><br><span class="hljs-keyword">const</span> wb = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExcelJS</span>.<span class="hljs-title class_">Workbook</span>();<br><span class="hljs-keyword">const</span> ws = wb.<span class="hljs-title function_">addWorksheet</span>(<span class="hljs-string">&#x27;duplicateTest&#x27;</span>);<br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;One&#x27;</span>;<br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A2&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;Two&#x27;</span>;<br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A3&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;Three&#x27;</span>;<br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A4&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;Four&#x27;</span>;<br><br><span class="hljs-comment">// 该行将重复复制第一行两次，但将替换第二行和第三行</span><br><span class="hljs-comment">// 如果第三个参数为 true，则它将插入2个新行，其中包含行 “One” 的值和样式</span><br>ws.<span class="hljs-title function_">duplicateRow</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-literal">false</span>);<br></code></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>参数</th>
<th>描述</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>start</td>
<td>要复制的行号（Excel 中的第一个是 1）</td>
<td></td>
</tr>
<tr>
<td>amount</td>
<td>您要复制行的次数</td>
<td>1</td>
</tr>
<tr>
<td>insert</td>
<td>如果要为重复项插入新行，则为 <code>true</code>，否则为 <code>false</code> 将替换已有行</td>
<td><code>true</code></td>
</tr>
</tbody></table>
<h2 id="定义名称⬆"><a href="#定义名称⬆" class="headerlink" title="定义名称⬆"></a>定义名称<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>单个单元格（或多个单元格组）可以为它们分配名称。名称可用于公式和数据验证（可能还有更多）。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 为单元格分配（或获取）名称（将覆盖该单元具有的其他任何名称）</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;PI&#x27;</span>;<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">name</span>).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-string">&#x27;PI&#x27;</span>);<br><br><span class="hljs-comment">// 为单元格分配（或获取）一组名称（单元可以具有多个名称）</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">names</span> = [<span class="hljs-string">&#x27;thing1&#x27;</span>, <span class="hljs-string">&#x27;thing2&#x27;</span>];<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">names</span>).<span class="hljs-property">to</span>.<span class="hljs-property">have</span>.<span class="hljs-title function_">members</span>([<span class="hljs-string">&#x27;thing1&#x27;</span>, <span class="hljs-string">&#x27;thing2&#x27;</span>]);<br><br><span class="hljs-comment">// 从单元格中删除名称</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-title function_">removeName</span>(<span class="hljs-string">&#x27;thing1&#x27;</span>);<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">names</span>).<span class="hljs-property">to</span>.<span class="hljs-property">have</span>.<span class="hljs-title function_">members</span>([<span class="hljs-string">&#x27;thing2&#x27;</span>]);<br></code></pre></td></tr></table></figure>

<h2 id="数据验证⬆"><a href="#数据验证⬆" class="headerlink" title="数据验证⬆"></a>数据验证<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>单元格可以定义哪些值有效或无效，并提示用户以帮助指导它们。</p>
<p>验证类型可以是以下之一：</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>list</td>
<td>定义一组离散的有效值。Excel 将在下拉菜单中提供这些内容，以便于输入</td>
</tr>
<tr>
<td>whole</td>
<td>该值必须是整数</td>
</tr>
<tr>
<td>decimal</td>
<td>该值必须是十进制数</td>
</tr>
<tr>
<td>textLength</td>
<td>该值可以是文本，但长度是受控的</td>
</tr>
<tr>
<td>custom</td>
<td>自定义公式控制有效值</td>
</tr>
</tbody></table>
<p>对于 <code>list</code> 或 <code>custom</code> 以外的其他类型，以下运算符会影响验证：</p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>between</td>
<td>值必须介于公式结果之间</td>
</tr>
<tr>
<td>notBetween</td>
<td>值不能介于公式结果之间</td>
</tr>
<tr>
<td>equal</td>
<td>值必须等于公式结果</td>
</tr>
<tr>
<td>notEqual</td>
<td>值不能等于公式结果</td>
</tr>
<tr>
<td>greaterThan</td>
<td>值必须大于公式结果</td>
</tr>
<tr>
<td>lessThan</td>
<td>值必须小于公式结果</td>
</tr>
<tr>
<td>greaterThanOrEqual</td>
<td>值必须大于或等于公式结果</td>
</tr>
<tr>
<td>lessThanOrEqual</td>
<td>值必须小于或等于公式结果</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 指定有效值的列表（One，Two，Three，Four）。</span><br><span class="hljs-comment">// Excel 将提供一个包含这些值的下拉列表。</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">dataValidation</span> = &#123;<br>  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;list&#x27;</span>,<br>  <span class="hljs-attr">allowBlank</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">formulae</span>: [<span class="hljs-string">&#x27;&quot;One,Two,Three,Four&quot;&#x27;</span>],<br>&#125;;<br><br><span class="hljs-comment">// 指定范围内的有效值列表。</span><br><span class="hljs-comment">// Excel 将提供一个包含这些值的下拉列表。</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">dataValidation</span> = &#123;<br>  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;list&#x27;</span>,<br>  <span class="hljs-attr">allowBlank</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">formulae</span>: [<span class="hljs-string">&#x27;$D$5:$F$5&#x27;</span>],<br>&#125;;<br><br><span class="hljs-comment">// 指定单元格必须为非5的整数。</span><br><span class="hljs-comment">// 向用户显示适当的错误消息（如果他们弄错了）</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">dataValidation</span> = &#123;<br>  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;whole&#x27;</span>,<br>  <span class="hljs-attr">operator</span>: <span class="hljs-string">&#x27;notEqual&#x27;</span>,<br>  <span class="hljs-attr">showErrorMessage</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">formulae</span>: [<span class="hljs-number">5</span>],<br>  <span class="hljs-attr">errorStyle</span>: <span class="hljs-string">&#x27;error&#x27;</span>,<br>  <span class="hljs-attr">errorTitle</span>: <span class="hljs-string">&#x27;Five&#x27;</span>,<br>  <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;The value must not be Five&#x27;</span>,<br>&#125;;<br><br><span class="hljs-comment">// 指定单元格必须为1.5到7之间的十进制数字。</span><br><span class="hljs-comment">// 添加“工具提示”以帮助指导用户</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">dataValidation</span> = &#123;<br>  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;decimal&#x27;</span>,<br>  <span class="hljs-attr">operator</span>: <span class="hljs-string">&#x27;between&#x27;</span>,<br>  <span class="hljs-attr">allowBlank</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">showInputMessage</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">formulae</span>: [<span class="hljs-number">1.5</span>, <span class="hljs-number">7</span>],<br>  <span class="hljs-attr">promptTitle</span>: <span class="hljs-string">&#x27;Decimal&#x27;</span>,<br>  <span class="hljs-attr">prompt</span>: <span class="hljs-string">&#x27;The value must between 1.5 and 7&#x27;</span>,<br>&#125;;<br><br><span class="hljs-comment">// 指定单元格的文本长度必须小于15</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">dataValidation</span> = &#123;<br>  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;textLength&#x27;</span>,<br>  <span class="hljs-attr">operator</span>: <span class="hljs-string">&#x27;lessThan&#x27;</span>,<br>  <span class="hljs-attr">showErrorMessage</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">allowBlank</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">formulae</span>: [<span class="hljs-number">15</span>],<br>&#125;;<br><br><span class="hljs-comment">// 指定单元格必须是2016年1月1日之前的日期</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">dataValidation</span> = &#123;<br>  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;date&#x27;</span>,<br>  <span class="hljs-attr">operator</span>: <span class="hljs-string">&#x27;lessThan&#x27;</span>,<br>  <span class="hljs-attr">showErrorMessage</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">allowBlank</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">formulae</span>: [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2016</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)],<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="单元格注释⬆"><a href="#单元格注释⬆" class="headerlink" title="单元格注释⬆"></a>单元格注释<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>将旧样式的注释添加到单元格</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 纯文字笔记</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">note</span> = <span class="hljs-string">&#x27;Hello, ExcelJS!&#x27;</span>;<br><br><span class="hljs-comment">// 彩色格式化的笔记</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B1&#x27;</span>).<span class="hljs-property">note</span> = &#123;<br>  <span class="hljs-attr">texts</span>: [<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">0</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">family</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;This is &#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">italic</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">0</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;a&#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">1</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">family</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27; &#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FFFF6600&#x27;</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;colorful&#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">1</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">family</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27; text &#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FFCCFFCC&#x27;</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;with&#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">1</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">family</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27; in-cell &#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">bold</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">1</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">family</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;format&#x27;</span>,<br>    &#125;,<br>  ],<br>  <span class="hljs-attr">margins</span>: &#123;<br>    <span class="hljs-attr">insetmode</span>: <span class="hljs-string">&#x27;custom&#x27;</span>,<br>    <span class="hljs-attr">inset</span>: [<span class="hljs-number">0.25</span>, <span class="hljs-number">0.25</span>, <span class="hljs-number">0.35</span>, <span class="hljs-number">0.35</span>],<br>  &#125;,<br>  <span class="hljs-attr">protection</span>: &#123;<br>    <span class="hljs-attr">locked</span>: <span class="hljs-title class_">True</span>,<br>    <span class="hljs-attr">lockText</span>: <span class="hljs-title class_">False</span>,<br>  &#125;,<br>  <span class="hljs-attr">editAs</span>: <span class="hljs-string">&#x27;twoCells&#x27;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure>

<h3 id="单元格批注属性⬆"><a href="#单元格批注属性⬆" class="headerlink" title="单元格批注属性⬆"></a>单元格批注属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>下表定义了单元格注释已支持的属性。</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Required</th>
<th>Default Value</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>texts</td>
<td>Y</td>
<td></td>
<td>评论文字</td>
</tr>
<tr>
<td>margins</td>
<td>N</td>
<td>{}</td>
<td>确定自动或自定义设置单元格注释的边距值</td>
</tr>
<tr>
<td>protection</td>
<td>N</td>
<td>{}</td>
<td>可以使用保护属性来指定对象和对象文本的锁定状态</td>
</tr>
<tr>
<td>editAs</td>
<td>N</td>
<td>‘absolute’</td>
<td>可以使用’editAs’属性来指定注释如何锚定到单元格</td>
</tr>
</tbody></table>
<h3 id="单元格批注页边距⬆"><a href="#单元格批注页边距⬆" class="headerlink" title="单元格批注页边距⬆"></a>单元格批注页边距<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>确定单元格批注的页面距设置模式，自动或者自定义模式。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B1&#x27;</span>).<span class="hljs-property">note</span>.<span class="hljs-property">margins</span> = &#123;<br>  <span class="hljs-attr">insetmode</span>: <span class="hljs-string">&#x27;custom&#x27;</span>,<br>  <span class="hljs-attr">inset</span>: [<span class="hljs-number">0.25</span>, <span class="hljs-number">0.25</span>, <span class="hljs-number">0.35</span>, <span class="hljs-number">0.35</span>],<br>&#125;;<br></code></pre></td></tr></table></figure>

<h3 id="已支持的页边距属性⬆"><a href="#已支持的页边距属性⬆" class="headerlink" title="已支持的页边距属性⬆"></a>已支持的页边距属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>Property</th>
<th>Required</th>
<th>Default Value</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>insetmode</td>
<td>N</td>
<td>‘auto’</td>
<td>确定是否自动设置注释边距，并且值是’auto’ 或者 ‘custom’</td>
</tr>
<tr>
<td>inset</td>
<td>N</td>
<td>[0.13, 0.13, 0.25, 0.25]</td>
<td>批注页边距的值，单位是厘米, 方向是左-上-右-下</td>
</tr>
</tbody></table>
<p>注意：只有当 <code>insetmode</code>的值设置为’custom’时，<code>inset</code>的设置才生效。</p>
<h3 id="单元格批注保护⬆"><a href="#单元格批注保护⬆" class="headerlink" title="单元格批注保护⬆"></a>单元格批注保护<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>可以使用保护属性来修改单元级别保护。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B1&#x27;</span>).<span class="hljs-property">note</span>.<span class="hljs-property">protection</span> = &#123;<br>  <span class="hljs-attr">locked</span>: <span class="hljs-string">&#x27;False&#x27;</span>,<br>  <span class="hljs-attr">lockText</span>: <span class="hljs-string">&#x27;False&#x27;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure>

<h3 id="已支持的保护属性⬆"><a href="#已支持的保护属性⬆" class="headerlink" title="已支持的保护属性⬆"></a>已支持的保护属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>Property</th>
<th>Required</th>
<th>Default Value</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>locked</td>
<td>N</td>
<td>‘True’</td>
<td>此元素指定在保护工作表时对象已锁定</td>
</tr>
<tr>
<td>lockText</td>
<td>N</td>
<td>‘True’</td>
<td>该元素指定对象的文本已锁定</td>
</tr>
</tbody></table>
<h3 id="单元格批注对象位置属性⬆"><a href="#单元格批注对象位置属性⬆" class="headerlink" title="单元格批注对象位置属性⬆"></a>单元格批注对象位置属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>单元格注释还可以具有属性 ‘editAs’，该属性将控制注释如何锚定到单元格。<br>它可以具有以下值之一：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B1&#x27;</span>).<span class="hljs-property">note</span>.<span class="hljs-property">editAs</span> = <span class="hljs-string">&#x27;twoCells&#x27;</span>;<br></code></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>twoCells</td>
<td>它指定注释的大小、位置随单元格而变</td>
</tr>
<tr>
<td>oneCells</td>
<td>它指定注释的大小固定，位置随单元格而变</td>
</tr>
<tr>
<td>absolute</td>
<td>这是默认值，它指定注释的大小、位置均固定</td>
</tr>
</tbody></table>
<h2 id="表格⬆"><a href="#表格⬆" class="headerlink" title="表格⬆"></a>表格<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>表允许表格内数据的表内操作。</p>
<p>要将表添加到工作表，请定义表模型并调用 <code>addTable</code>：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 将表格添加到工作表</span><br>ws.<span class="hljs-title function_">addTable</span>(&#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;MyTable&#x27;</span>,<br>  <span class="hljs-attr">ref</span>: <span class="hljs-string">&#x27;A1&#x27;</span>,<br>  <span class="hljs-attr">headerRow</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">totalsRow</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">style</span>: &#123;<br>    <span class="hljs-attr">theme</span>: <span class="hljs-string">&#x27;TableStyleDark3&#x27;</span>,<br>    <span class="hljs-attr">showRowStripes</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  <span class="hljs-attr">columns</span>: [<br>    &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Date&#x27;</span>, <span class="hljs-attr">totalsRowLabel</span>: <span class="hljs-string">&#x27;Totals:&#x27;</span>, <span class="hljs-attr">filterButton</span>: <span class="hljs-literal">true</span> &#125;,<br>    &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Amount&#x27;</span>, <span class="hljs-attr">totalsRowFunction</span>: <span class="hljs-string">&#x27;sum&#x27;</span>, <span class="hljs-attr">filterButton</span>: <span class="hljs-literal">false</span> &#125;,<br>  ],<br>  <span class="hljs-attr">rows</span>: [<br>    [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">&#x27;2019-07-20&#x27;</span>), <span class="hljs-number">70.1</span>],<br>    [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">&#x27;2019-07-21&#x27;</span>), <span class="hljs-number">70.6</span>],<br>    [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">&#x27;2019-07-22&#x27;</span>), <span class="hljs-number">70.1</span>],<br>  ],<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>注意：将表格添加到工作表将通过放置表格的标题和行数据来修改工作表。<br>结果就是表格覆盖的工作表上的所有数据（包括标题和所有的）都将被覆盖。</p>
<h3 id="表格属性⬆"><a href="#表格属性⬆" class="headerlink" title="表格属性⬆"></a>表格属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>下表定义了表格支持的属性。</p>
<table>
<thead>
<tr>
<th>表属性</th>
<th>描述</th>
<th>是否需要</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>表格名称</td>
<td>Y</td>
<td></td>
</tr>
<tr>
<td>displayName</td>
<td>表格的显示名称</td>
<td>N</td>
<td><code>name</code></td>
</tr>
<tr>
<td>ref</td>
<td>表格的左上方单元格</td>
<td>Y</td>
<td></td>
</tr>
<tr>
<td>headerRow</td>
<td>在表格顶部显示标题</td>
<td>N</td>
<td>true</td>
</tr>
<tr>
<td>totalsRow</td>
<td>在表格底部显示总计</td>
<td>N</td>
<td><code>false</code></td>
</tr>
<tr>
<td>style</td>
<td>额外的样式属性</td>
<td>N</td>
<td>{}</td>
</tr>
<tr>
<td>columns</td>
<td>列定义</td>
<td>Y</td>
<td></td>
</tr>
<tr>
<td>rows</td>
<td>数据行</td>
<td>Y</td>
<td></td>
</tr>
</tbody></table>
<h3 id="表格样式属性⬆"><a href="#表格样式属性⬆" class="headerlink" title="表格样式属性⬆"></a>表格样式属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>下表定义了表格中支持的属性样式属性。</p>
<table>
<thead>
<tr>
<th>样式属性</th>
<th>描述</th>
<th>是否需要</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>theme</td>
<td>桌子的颜色主题</td>
<td>N</td>
<td><code>&#39;TableStyleMedium2&#39;</code></td>
</tr>
<tr>
<td>showFirstColumn</td>
<td>突出显示第一列（粗体）</td>
<td>N</td>
<td><code>false</code></td>
</tr>
<tr>
<td>showLastColumn</td>
<td>突出显示最后一列（粗体）</td>
<td>N</td>
<td><code>false</code></td>
</tr>
<tr>
<td>showRowStripes</td>
<td>用交替的背景色显示行</td>
<td>N</td>
<td><code>false</code></td>
</tr>
<tr>
<td>showColumnStripes</td>
<td>用交替的背景色显示列</td>
<td>N</td>
<td><code>false</code></td>
</tr>
</tbody></table>
<h3 id="表格列属性⬆"><a href="#表格列属性⬆" class="headerlink" title="表格列属性⬆"></a>表格列属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>下表定义了每个表格列中支持的属性。</p>
<table>
<thead>
<tr>
<th>列属性</th>
<th>描述</th>
<th>是否需要</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>列名，也用在标题中</td>
<td>Y</td>
<td></td>
</tr>
<tr>
<td>filterButton</td>
<td>切换标题中的过滤器控件</td>
<td>N</td>
<td>false</td>
</tr>
<tr>
<td>totalsRowLabel</td>
<td>用于描述统计行的标签（第一列）</td>
<td>N</td>
<td><code>&#39;Total&#39;</code></td>
</tr>
<tr>
<td>totalsRowFunction</td>
<td>统计函数名称</td>
<td>N</td>
<td><code>&#39;none&#39;</code></td>
</tr>
<tr>
<td>totalsRowFormula</td>
<td>自定义函数的可选公式</td>
<td>N</td>
<td></td>
</tr>
</tbody></table>
<h3 id="统计函数⬆"><a href="#统计函数⬆" class="headerlink" title="统计函数⬆"></a>统计函数<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>下表列出了由列定义的 <code>totalsRowFunction</code> 属性的有效值。如果使用 <code>&#39;custom&#39;</code> 以外的任何值，则无需包括关联的公式，因为该公式将被表格插入。</p>
<table>
<thead>
<tr>
<th>统计函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>none</td>
<td>此列没有统计函数</td>
</tr>
<tr>
<td>average</td>
<td>计算列的平均值</td>
</tr>
<tr>
<td>countNums</td>
<td>统计数字条目数</td>
</tr>
<tr>
<td>count</td>
<td>条目数</td>
</tr>
<tr>
<td>max</td>
<td>此列中的最大值</td>
</tr>
<tr>
<td>min</td>
<td>此列中的最小值</td>
</tr>
<tr>
<td>stdDev</td>
<td>该列的标准偏差</td>
</tr>
<tr>
<td>var</td>
<td>此列的方差</td>
</tr>
<tr>
<td>sum</td>
<td>此列的条目总数</td>
</tr>
<tr>
<td>custom</td>
<td>自定义公式。 需要关联的 <code>totalsRowFormula</code> 值。</td>
</tr>
</tbody></table>
<h3 id="表格样式主题⬆"><a href="#表格样式主题⬆" class="headerlink" title="表格样式主题⬆"></a>表格样式主题<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>有效的主题名称遵循以下模式：</p>
<ul>
<li>“TableStyle[Shade][Number]”</li>
</ul>
<p>Shades（阴影），Number（数字）可以是以下之一：</p>
<ul>
<li>Light, 1-21</li>
<li>Medium, 1-28</li>
<li>Dark, 1-11</li>
</ul>
<p>对于无主题，请使用值 <code>null</code>。</p>
<p>注意：exceljs 尚不支持自定义表格主题。</p>
<h3 id="修改表格⬆"><a href="#修改表格⬆" class="headerlink" title="修改表格⬆"></a>修改表格<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>表格支持一组操作函数，这些操作函数允许添加或删除数据以及更改某些属性。由于这些操作中的许多操作可能会对工作表产生副作用，因此更改必须在完成后立即提交。</p>
<p>表中的所有索引值均基于零，因此第一行号和第一列号为 <code>0</code>。</p>
<p><strong>添加或删除标题和统计</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> table = ws.<span class="hljs-title function_">getTable</span>(<span class="hljs-string">&#x27;MyTable&#x27;</span>);<br><br><span class="hljs-comment">// 打开标题行</span><br>table.<span class="hljs-property">headerRow</span> = <span class="hljs-literal">true</span>;<br><br><span class="hljs-comment">// 关闭统计行</span><br>table.<span class="hljs-property">totalsRow</span> = <span class="hljs-literal">false</span>;<br><br><span class="hljs-comment">// 将表更改提交到工作表中</span><br>table.<span class="hljs-title function_">commit</span>();<br></code></pre></td></tr></table></figure>

<p><strong>重定位表</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> table = ws.<span class="hljs-title function_">getTable</span>(<span class="hljs-string">&#x27;MyTable&#x27;</span>);<br><br><span class="hljs-comment">// 表格左上移至 D4</span><br>table.<span class="hljs-property">ref</span> = <span class="hljs-string">&#x27;D4&#x27;</span>;<br><br><span class="hljs-comment">// 将表更改提交到工作表中</span><br>table.<span class="hljs-title function_">commit</span>();<br></code></pre></td></tr></table></figure>

<p><strong>添加和删除行</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> table = ws.<span class="hljs-title function_">getTable</span>(<span class="hljs-string">&#x27;MyTable&#x27;</span>);<br><br><span class="hljs-comment">// 删除前两行</span><br>table.<span class="hljs-title function_">removeRows</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>);<br><br><span class="hljs-comment">// 在索引 5 处插入新行</span><br>table.<span class="hljs-title function_">addRow</span>([<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">&#x27;2019-08-05&#x27;</span>), <span class="hljs-number">5</span>, <span class="hljs-string">&#x27;Mid&#x27;</span>], <span class="hljs-number">5</span>);<br><br><span class="hljs-comment">// 在表格底部追加新行</span><br>table.<span class="hljs-title function_">addRow</span>([<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-string">&#x27;2019-08-10&#x27;</span>), <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;End&#x27;</span>]);<br><br><span class="hljs-comment">// 将表更改提交到工作表中</span><br>table.<span class="hljs-title function_">commit</span>();<br></code></pre></td></tr></table></figure>

<p><strong>添加和删除列</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> table = ws.<span class="hljs-title function_">getTable</span>(<span class="hljs-string">&#x27;MyTable&#x27;</span>);<br><br><span class="hljs-comment">// 删除第二列</span><br>table.<span class="hljs-title function_">removeColumns</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);<br><br><span class="hljs-comment">// 在索引 1 处插入新列（包含数据）</span><br>table.<span class="hljs-title function_">addColumn</span>(<br>  &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Letter&#x27;</span>,<br>    <span class="hljs-attr">totalsRowFunction</span>: <span class="hljs-string">&#x27;custom&#x27;</span>,<br>    <span class="hljs-attr">totalsRowFormula</span>: <span class="hljs-string">&#x27;ROW()&#x27;</span>,<br>    <span class="hljs-attr">totalsRowResult</span>: <span class="hljs-number">6</span>,<br>    <span class="hljs-attr">filterButton</span>: <span class="hljs-literal">true</span>,<br>  &#125;,<br>  [<span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;b&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-string">&#x27;d&#x27;</span>],<br>  <span class="hljs-number">2</span><br>);<br><br><span class="hljs-comment">// 将表更改提交到工作表中</span><br>table.<span class="hljs-title function_">commit</span>();<br></code></pre></td></tr></table></figure>

<p><strong>更改列属性</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> table = ws.<span class="hljs-title function_">getTable</span>(<span class="hljs-string">&#x27;MyTable&#x27;</span>);<br><br><span class="hljs-comment">// 获取第二列的列包装器</span><br><span class="hljs-keyword">const</span> column = table.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">1</span>);<br><br><span class="hljs-comment">// 设置一些属性</span><br>column.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;Code&#x27;</span>;<br>column.<span class="hljs-property">filterButton</span> = <span class="hljs-literal">true</span>;<br>column.<span class="hljs-property">style</span> = &#123; <span class="hljs-attr">font</span>: &#123; <span class="hljs-attr">bold</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Comic Sans MS&#x27;</span> &#125; &#125;;<br>column.<span class="hljs-property">totalsRowLabel</span> = <span class="hljs-string">&#x27;Totals&#x27;</span>;<br>column.<span class="hljs-property">totalsRowFunction</span> = <span class="hljs-string">&#x27;custom&#x27;</span>;<br>column.<span class="hljs-property">totalsRowFormula</span> = <span class="hljs-string">&#x27;ROW()&#x27;</span>;<br>column.<span class="hljs-property">totalsRowResult</span> = <span class="hljs-number">10</span>;<br><br><span class="hljs-comment">// 将表更改提交到工作表中</span><br>table.<span class="hljs-title function_">commit</span>();<br></code></pre></td></tr></table></figure>

<h2 id="样式⬆"><a href="#样式⬆" class="headerlink" title="样式⬆"></a>样式<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>单元格，行和列均支持一组丰富的样式和格式，这些样式和格式会影响单元格的显示方式。</p>
<p>通过分配以下属性来设置样式：</p>
<ul>
<li><a href="#数字格式">numFmt</a></li>
<li><a href="#字体">font</a></li>
<li><a href="#对齐">alignment</a></li>
<li><a href="#边框">border</a></li>
<li><a href="#填充">fill</a></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 为单元格分配样式</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">numFmt</span> = <span class="hljs-string">&#x27;0.00%&#x27;</span>;<br><br><span class="hljs-comment">// 将样式应用于工作表列</span><br>ws.<span class="hljs-property">columns</span> = [<br>  &#123; <span class="hljs-attr">header</span>: <span class="hljs-string">&#x27;Id&#x27;</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">10</span> &#125;,<br>  &#123;<br>    <span class="hljs-attr">header</span>: <span class="hljs-string">&#x27;Name&#x27;</span>,<br>    <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;name&#x27;</span>,<br>    <span class="hljs-attr">width</span>: <span class="hljs-number">32</span>,<br>    <span class="hljs-attr">style</span>: &#123; <span class="hljs-attr">font</span>: &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Arial Black&#x27;</span> &#125; &#125;,<br>  &#125;,<br>  &#123; <span class="hljs-attr">header</span>: <span class="hljs-string">&#x27;D.O.B.&#x27;</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;DOB&#x27;</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">style</span>: &#123; <span class="hljs-attr">numFmt</span>: <span class="hljs-string">&#x27;dd/mm/yyyy&#x27;</span> &#125; &#125;,<br>];<br><br><span class="hljs-comment">// 将第3列设置为“货币格式”</span><br>ws.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">3</span>).<span class="hljs-property">numFmt</span> = <span class="hljs-string">&#x27;&quot;£&quot;#,##0.00;[Red]-&quot;£&quot;#,##0.00&#x27;</span>;<br><br><span class="hljs-comment">// 将第2行设置为 Comic Sans。</span><br>ws.<span class="hljs-title function_">getRow</span>(<span class="hljs-number">2</span>).<span class="hljs-property">font</span> = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Comic Sans MS&#x27;</span>,<br>  <span class="hljs-attr">family</span>: <span class="hljs-number">4</span>,<br>  <span class="hljs-attr">size</span>: <span class="hljs-number">16</span>,<br>  <span class="hljs-attr">underline</span>: <span class="hljs-string">&#x27;double&#x27;</span>,<br>  <span class="hljs-attr">bold</span>: <span class="hljs-literal">true</span>,<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>将样式应用于行或列时，它将应用于该行或列中所有当前存在的单元格。另外，创建的任何新单元格都将从其所属的行和列继承其初始样式。</p>
<p>如果单元格的行和列都定义了特定的样式（例如，字体），则该单元格所在行样式比列样式具有更高优先级。但是，如果行和列定义了不同的样式（例如 <code>column.numFmt</code> 和 <code>row.font</code>），则单元格将继承行的字体和列的 <code>numFmt</code>。</p>
<p>注意：以上所有属性（<code>numFmt</code>（字符串）除外）都是 JS 对象结构。如果将同一样式对象分配给多个电子表格实体，则每个实体将共享同一样式对象。如果样式对象后来在电子表格序列化之前被修改，则所有引用该样式对象的实体也将被修改。此行为旨在通过减少创建的 JS 对象的数量来优先考虑性能。如果希望样式对象是独立的，则需要先对其进行克隆，然后再分配它们。同样，默认情况下，如果电子表格实体共享相似的样式，则从文件（或流）中读取文档时，它们也将引用相同的样式对象。</p>
<h3 id="数字格式⬆"><a href="#数字格式⬆" class="headerlink" title="数字格式⬆"></a>数字格式<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 将值显示为“ 1 3/5”</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-number">1.6</span>;<br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">numFmt</span> = <span class="hljs-string">&#x27;# ?/?&#x27;</span>;<br><br><span class="hljs-comment">// 显示为“ 1.60％”</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B1&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-number">0.016</span>;<br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B1&#x27;</span>).<span class="hljs-property">numFmt</span> = <span class="hljs-string">&#x27;0.00%&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h3 id="字体"><a href="#字体" class="headerlink" title="字体"></a>字体</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// for the wannabe graphic designers out there</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">font</span> = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Comic Sans MS&#x27;</span>,<br>  <span class="hljs-attr">family</span>: <span class="hljs-number">4</span>,<br>  <span class="hljs-attr">size</span>: <span class="hljs-number">16</span>,<br>  <span class="hljs-attr">underline</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">bold</span>: <span class="hljs-literal">true</span>,<br>&#125;;<br><br><span class="hljs-comment">// for the graduate graphic designers...</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A2&#x27;</span>).<span class="hljs-property">font</span> = &#123;<br>  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Arial Black&#x27;</span>,<br>  <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FF00FF00&#x27;</span> &#125;,<br>  <span class="hljs-attr">family</span>: <span class="hljs-number">2</span>,<br>  <span class="hljs-attr">size</span>: <span class="hljs-number">14</span>,<br>  <span class="hljs-attr">italic</span>: <span class="hljs-literal">true</span>,<br>&#125;;<br><br><span class="hljs-comment">// 垂直对齐</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A3&#x27;</span>).<span class="hljs-property">font</span> = &#123;<br>  <span class="hljs-attr">vertAlign</span>: <span class="hljs-string">&#x27;superscript&#x27;</span>,<br>&#125;;<br><br><span class="hljs-comment">// 注意：该单元格将存储对分配的字体对象的引用。</span><br><span class="hljs-comment">// 如果之后更改了字体对象，则单元字体也将更改。</span><br><span class="hljs-keyword">const</span> font = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Arial&#x27;</span>, <span class="hljs-attr">size</span>: <span class="hljs-number">12</span> &#125;;<br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A3&#x27;</span>).<span class="hljs-property">font</span> = font;<br>font.<span class="hljs-property">size</span> = <span class="hljs-number">20</span>; <span class="hljs-comment">// 单元格 A3 现在具有20号字体！</span><br><br><span class="hljs-comment">// 从文件或流中读取工作簿后，共享相似字体的单元格可能引用相同的字体对象</span><br></code></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>字体属性</th>
<th>描述</th>
<th>示例值</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>字体名称。</td>
<td>‘Arial’, ‘Calibri’, etc.</td>
</tr>
<tr>
<td>family</td>
<td>备用字体家族。整数值。</td>
<td>1 - Serif, 2 - Sans Serif, 3 - Mono, Others - unknown</td>
</tr>
<tr>
<td>scheme</td>
<td>字体方案。</td>
<td>‘minor’, ‘major’, ‘none’</td>
</tr>
<tr>
<td>charset</td>
<td>字体字符集。整数值。</td>
<td>1, 2, etc.</td>
</tr>
<tr>
<td>size</td>
<td>字体大小。整数值。</td>
<td>9, 10, 12, 16, etc.</td>
</tr>
<tr>
<td>color</td>
<td>颜色描述，一个包含 ARGB 值的对象。</td>
<td>{ argb: ‘FFFF0000’}</td>
</tr>
<tr>
<td>bold</td>
<td>字体 <strong>粗细</strong></td>
<td>true, false</td>
</tr>
<tr>
<td>italic</td>
<td>字体 <em>倾斜</em></td>
<td>true, false</td>
</tr>
<tr>
<td>underline</td>
<td>字体 <u>下划线</u> 样式</td>
<td>true, false, ‘none’, ‘single’, ‘double’, ‘singleAccounting’, ‘doubleAccounting’</td>
</tr>
<tr>
<td>strike</td>
<td>字体 <strike>删除线</strike></td>
<td>true, false</td>
</tr>
<tr>
<td>outline</td>
<td>字体轮廓</td>
<td>true, false</td>
</tr>
<tr>
<td>vertAlign</td>
<td>垂直对齐</td>
<td>‘superscript’, ‘subscript’</td>
</tr>
</tbody></table>
<h3 id="对齐⬆"><a href="#对齐⬆" class="headerlink" title="对齐⬆"></a>对齐<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 将单元格对齐方式设置为左上，中间居中，右下</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">alignment</span> = &#123; <span class="hljs-attr">vertical</span>: <span class="hljs-string">&#x27;top&#x27;</span>, <span class="hljs-attr">horizontal</span>: <span class="hljs-string">&#x27;left&#x27;</span> &#125;;<br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B1&#x27;</span>).<span class="hljs-property">alignment</span> = &#123; <span class="hljs-attr">vertical</span>: <span class="hljs-string">&#x27;middle&#x27;</span>, <span class="hljs-attr">horizontal</span>: <span class="hljs-string">&#x27;center&#x27;</span> &#125;;<br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;C1&#x27;</span>).<span class="hljs-property">alignment</span> = &#123; <span class="hljs-attr">vertical</span>: <span class="hljs-string">&#x27;bottom&#x27;</span>, <span class="hljs-attr">horizontal</span>: <span class="hljs-string">&#x27;right&#x27;</span> &#125;;<br><br><span class="hljs-comment">// 将单元格设置为自动换行</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;D1&#x27;</span>).<span class="hljs-property">alignment</span> = &#123; <span class="hljs-attr">wrapText</span>: <span class="hljs-literal">true</span> &#125;;<br><br><span class="hljs-comment">// 将单元格缩进设置为1</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;E1&#x27;</span>).<span class="hljs-property">alignment</span> = &#123; <span class="hljs-attr">indent</span>: <span class="hljs-number">1</span> &#125;;<br><br><span class="hljs-comment">// 将单元格文本旋转设置为向上30deg，向下45deg和垂直文本</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;F1&#x27;</span>).<span class="hljs-property">alignment</span> = &#123; <span class="hljs-attr">textRotation</span>: <span class="hljs-number">30</span> &#125;;<br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;G1&#x27;</span>).<span class="hljs-property">alignment</span> = &#123; <span class="hljs-attr">textRotation</span>: -<span class="hljs-number">45</span> &#125;;<br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;H1&#x27;</span>).<span class="hljs-property">alignment</span> = &#123; <span class="hljs-attr">textRotation</span>: <span class="hljs-string">&#x27;vertical&#x27;</span> &#125;;<br></code></pre></td></tr></table></figure>

<p><strong>有效的对齐属性值</strong></p>
<table>
<thead>
<tr>
<th>水平的</th>
<th>垂直</th>
<th>文本换行</th>
<th>自适应</th>
<th>缩进</th>
<th>阅读顺序</th>
<th>文本旋转</th>
</tr>
</thead>
<tbody><tr>
<td>left</td>
<td>top</td>
<td>true</td>
<td>true</td>
<td>integer</td>
<td>rtl</td>
<td>0 to 90</td>
</tr>
<tr>
<td>center</td>
<td>middle</td>
<td>false</td>
<td>false</td>
<td></td>
<td>ltr</td>
<td>-1 to -90</td>
</tr>
<tr>
<td>right</td>
<td>bottom</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>vertical</td>
</tr>
<tr>
<td>fill</td>
<td>distributed</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>justify</td>
<td>justify</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>centerContinuous</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>distributed</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="边框⬆"><a href="#边框⬆" class="headerlink" title="边框⬆"></a>边框<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 在A1周围设置单个细边框</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">border</span> = &#123;<br>  <span class="hljs-attr">top</span>: &#123; <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;thin&#x27;</span> &#125;,<br>  <span class="hljs-attr">left</span>: &#123; <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;thin&#x27;</span> &#125;,<br>  <span class="hljs-attr">bottom</span>: &#123; <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;thin&#x27;</span> &#125;,<br>  <span class="hljs-attr">right</span>: &#123; <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;thin&#x27;</span> &#125;,<br>&#125;;<br><br><span class="hljs-comment">// 在A3周围设置双细绿色边框</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A3&#x27;</span>).<span class="hljs-property">border</span> = &#123;<br>  <span class="hljs-attr">top</span>: &#123; <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;double&#x27;</span>, <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FF00FF00&#x27;</span> &#125; &#125;,<br>  <span class="hljs-attr">left</span>: &#123; <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;double&#x27;</span>, <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FF00FF00&#x27;</span> &#125; &#125;,<br>  <span class="hljs-attr">bottom</span>: &#123; <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;double&#x27;</span>, <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FF00FF00&#x27;</span> &#125; &#125;,<br>  <span class="hljs-attr">right</span>: &#123; <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;double&#x27;</span>, <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FF00FF00&#x27;</span> &#125; &#125;,<br>&#125;;<br><br><span class="hljs-comment">// 在A5中设置厚红十字边框</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A5&#x27;</span>).<span class="hljs-property">border</span> = &#123;<br>  <span class="hljs-attr">diagonal</span>: &#123;<br>    <span class="hljs-attr">up</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">down</span>: <span class="hljs-literal">true</span>,<br>    <span class="hljs-attr">style</span>: <span class="hljs-string">&#x27;thick&#x27;</span>,<br>    <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FFFF0000&#x27;</span> &#125;,<br>  &#125;,<br>&#125;;<br></code></pre></td></tr></table></figure>

<p><strong>有效边框样式</strong></p>
<ul>
<li>thin</li>
<li>dotted</li>
<li>dashDot</li>
<li>hair</li>
<li>dashDotDot</li>
<li>slantDashDot</li>
<li>mediumDashed</li>
<li>mediumDashDotDot</li>
<li>mediumDashDot</li>
<li>medium</li>
<li>double</li>
<li>thick</li>
</ul>
<h3 id="填充⬆"><a href="#填充⬆" class="headerlink" title="填充⬆"></a>填充<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 用红色深色垂直条纹填充A1</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">fill</span> = &#123;<br>  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;pattern&#x27;</span>,<br>  <span class="hljs-attr">pattern</span>: <span class="hljs-string">&#x27;darkVertical&#x27;</span>,<br>  <span class="hljs-attr">fgColor</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FFFF0000&#x27;</span> &#125;,<br>&#125;;<br><br><span class="hljs-comment">// 在A2中填充深黄色格子和蓝色背景</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A2&#x27;</span>).<span class="hljs-property">fill</span> = &#123;<br>  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;pattern&#x27;</span>,<br>  <span class="hljs-attr">pattern</span>: <span class="hljs-string">&#x27;darkTrellis&#x27;</span>,<br>  <span class="hljs-attr">fgColor</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FFFFFF00&#x27;</span> &#125;,<br>  <span class="hljs-attr">bgColor</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FF0000FF&#x27;</span> &#125;,<br>&#125;;<br><br><span class="hljs-comment">// 从左到右用蓝白蓝渐变填充A3</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A3&#x27;</span>).<span class="hljs-property">fill</span> = &#123;<br>  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;gradient&#x27;</span>,<br>  <span class="hljs-attr">gradient</span>: <span class="hljs-string">&#x27;angle&#x27;</span>,<br>  <span class="hljs-attr">degree</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">stops</span>: [<br>    &#123; <span class="hljs-attr">position</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FF0000FF&#x27;</span> &#125; &#125;,<br>    &#123; <span class="hljs-attr">position</span>: <span class="hljs-number">0.5</span>, <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FFFFFFFF&#x27;</span> &#125; &#125;,<br>    &#123; <span class="hljs-attr">position</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FF0000FF&#x27;</span> &#125; &#125;,<br>  ],<br>&#125;;<br><br><span class="hljs-comment">// 从中心开始用红绿色渐变填充A4</span><br>ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A4&#x27;</span>).<span class="hljs-property">fill</span> = &#123;<br>  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;gradient&#x27;</span>,<br>  <span class="hljs-attr">gradient</span>: <span class="hljs-string">&#x27;path&#x27;</span>,<br>  <span class="hljs-attr">center</span>: &#123; <span class="hljs-attr">left</span>: <span class="hljs-number">0.5</span>, <span class="hljs-attr">top</span>: <span class="hljs-number">0.5</span> &#125;,<br>  <span class="hljs-attr">stops</span>: [<br>    &#123; <span class="hljs-attr">position</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FFFF0000&#x27;</span> &#125; &#125;,<br>    &#123; <span class="hljs-attr">position</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FF00FF00&#x27;</span> &#125; &#125;,<br>  ],<br>&#125;;<br></code></pre></td></tr></table></figure>

<h4 id="填充模式⬆"><a href="#填充模式⬆" class="headerlink" title="填充模式⬆"></a>填充模式<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h4><table>
<thead>
<tr>
<th>属性</th>
<th>是否需要</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td>Y</td>
<td>值: <code>&#39;pattern&#39;</code><br/>指定此填充使用模式</td>
</tr>
<tr>
<td>pattern</td>
<td>Y</td>
<td>指定模式类型 (查看下面 <a href="#有效模式类型">有效模式类型</a> )</td>
</tr>
<tr>
<td>fgColor</td>
<td>N</td>
<td>指定图案前景色。默认为黑色。</td>
</tr>
<tr>
<td>bgColor</td>
<td>N</td>
<td>指定图案背景色。默认为白色。</td>
</tr>
</tbody></table>
<p><strong>有效模式类型</strong></p>
<ul>
<li>none</li>
<li>solid</li>
<li>darkGray</li>
<li>mediumGray</li>
<li>lightGray</li>
<li>gray125</li>
<li>gray0625</li>
<li>darkHorizontal</li>
<li>darkVertical</li>
<li>darkDown</li>
<li>darkUp</li>
<li>darkGrid</li>
<li>darkTrellis</li>
<li>lightHorizontal</li>
<li>lightVertical</li>
<li>lightDown</li>
<li>lightUp</li>
<li>lightGrid</li>
<li>lightTrellis</li>
</ul>
<h4 id="渐变填充⬆"><a href="#渐变填充⬆" class="headerlink" title="渐变填充⬆"></a>渐变填充<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h4><table>
<thead>
<tr>
<th>属性</th>
<th>是否需要</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td>Y</td>
<td>值: <code>&#39;gradient&#39;</code><br/>指定此填充使用渐变</td>
</tr>
<tr>
<td>gradient</td>
<td>Y</td>
<td>指定渐变类型。<code>[&#39;angle&#39;，&#39;path&#39;]</code> 之一</td>
</tr>
<tr>
<td>degree</td>
<td>angle</td>
<td>对于“角度”渐变，指定渐变的方向。<code>0</code> 是从左到右。值从 1-359 顺时针旋转方向</td>
</tr>
<tr>
<td>center</td>
<td>path</td>
<td>对于“路径”渐变。指定路径起点的相对坐标。“左”和“顶”值的范围是 0 到 1</td>
</tr>
<tr>
<td>stops</td>
<td>Y</td>
<td>指定渐变颜色序列。是包含位置和颜色（从位置 0 开始到位置 1 结束）的对象的数组。中间位置可用于指定路径上的其他颜色。</td>
</tr>
</tbody></table>
<p><strong>注意事项</strong></p>
<p>使用上面的接口，可能会创建使用 XLSX 编辑器程序无法实现的渐变填充效果。例如，Excel 仅支持 0、45、90 和 135 的角度梯度。类似地，stops 的顺序也可能受到 UI 的限制，其中位置 [0,1] 或[0,0.5,1] 是唯一的选择。请谨慎处理此填充，以确保目标 XLSX 查看器支持该填充。</p>
<h3 id="富文本⬆"><a href="#富文本⬆" class="headerlink" title="富文本⬆"></a>富文本<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>现在，单个单元格支持 RTF 文本或单元格格式化。富文本值可以控制文本值内任意数量的子字符串的字体属性。有关支持哪些字体属性的详细信息，请参见<a href="font">字体</a>。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = &#123;<br>  <span class="hljs-attr">richText</span>: [<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">0</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">family</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;This is &#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">italic</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">0</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;a&#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">1</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">family</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27; &#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FFFF6600&#x27;</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;colorful&#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">1</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">family</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27; text &#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FFCCFFCC&#x27;</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;with&#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">1</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">family</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27; in-cell &#x27;</span>,<br>    &#125;,<br>    &#123;<br>      <span class="hljs-attr">font</span>: &#123;<br>        <span class="hljs-attr">bold</span>: <span class="hljs-literal">true</span>,<br>        <span class="hljs-attr">size</span>: <span class="hljs-number">12</span>,<br>        <span class="hljs-attr">color</span>: &#123; <span class="hljs-attr">theme</span>: <span class="hljs-number">1</span> &#125;,<br>        <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Calibri&#x27;</span>,<br>        <span class="hljs-attr">family</span>: <span class="hljs-number">2</span>,<br>        <span class="hljs-attr">scheme</span>: <span class="hljs-string">&#x27;minor&#x27;</span>,<br>      &#125;,<br>      <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;format&#x27;</span>,<br>    &#125;,<br>  ],<br>&#125;;<br><br><span class="hljs-title function_">expect</span>(ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">text</span>).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<br>  <span class="hljs-string">&#x27;This is a colorful text with in-cell format&#x27;</span><br>);<br><span class="hljs-title function_">expect</span>(ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">type</span>).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-title class_">Excel</span>.<span class="hljs-property">ValueType</span>.<span class="hljs-property">RichText</span>);<br></code></pre></td></tr></table></figure>

<h3 id="单元格保护⬆"><a href="#单元格保护⬆" class="headerlink" title="单元格保护⬆"></a>单元格保护<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>可以使用保护属性来修改单元级别保护。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">ws.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">protection</span> = &#123;<br>  <span class="hljs-attr">locked</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">hidden</span>: <span class="hljs-literal">true</span>,<br>&#125;;<br></code></pre></td></tr></table></figure>

<p><strong>支持的保护属性</strong></p>
<table>
<thead>
<tr>
<th>属性</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>locked</td>
<td><code>true</code></td>
<td>指定在工作表受保护的情况下是否将单元格锁定。</td>
</tr>
<tr>
<td>hidden</td>
<td><code>false</code></td>
<td>指定如果工作表受保护，则单元格的公式是否可见。</td>
</tr>
</tbody></table>
<h2 id="条件格式化⬆"><a href="#条件格式化⬆" class="headerlink" title="条件格式化⬆"></a>条件格式化<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>条件格式化允许工作表根据单元格值或任意公式显示特定的样式，图标等。</p>
<p>条件格式设置规则是在工作表级别添加的，通常会覆盖一系列单元格。</p>
<p>可以将多个规则应用于给定的单元格范围，并且每个规则都将应用自己的样式。</p>
<p>如果多个规则影响给定的单元格，则规则优先级值将确定如果竞争样式冲突，则哪个规则胜出。优先级值较低的规则获胜。如果没有为给定规则指定优先级值，ExcelJS 将按升序分配它们。</p>
<p>注意：目前，仅支持条件格式设置规则的子集。具体来说，只有格式规则不需要 &lt;extLst&amp;gt 元素内的 XML 呈现。这意味着不支持数据集和三个特定的图标集（3Triangles，3Stars，5Boxes）。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 根据行和列为偶数或奇数向 A1:E7 添加一个棋盘图案</span><br>worksheet.<span class="hljs-title function_">addConditionalFormatting</span>(&#123;<br>  <span class="hljs-attr">ref</span>: <span class="hljs-string">&#x27;A1:E7&#x27;</span>,<br>  <span class="hljs-attr">rules</span>: [<br>    &#123;<br>      <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;expression&#x27;</span>,<br>      <span class="hljs-attr">formulae</span>: [<span class="hljs-string">&#x27;MOD(ROW()+COLUMN(),2)=0&#x27;</span>],<br>      <span class="hljs-attr">style</span>: &#123;<br>        <span class="hljs-attr">fill</span>: &#123;<br>          <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;pattern&#x27;</span>,<br>          <span class="hljs-attr">pattern</span>: <span class="hljs-string">&#x27;solid&#x27;</span>,<br>          <span class="hljs-attr">bgColor</span>: &#123; <span class="hljs-attr">argb</span>: <span class="hljs-string">&#x27;FF00FF00&#x27;</span> &#125;,<br>        &#125;,<br>      &#125;,<br>    &#125;,<br>  ],<br>&#125;);<br></code></pre></td></tr></table></figure>

<p><strong>支持的条件格式设置规则类型</strong></p>
<table>
<thead>
<tr>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>expression</td>
<td>任何自定义功能均可用于激活规则。</td>
</tr>
<tr>
<td>cellIs</td>
<td>使用指定的运算符将单元格值与提供的公式进行比较</td>
</tr>
<tr>
<td>top10</td>
<td>将格式化应用于值在顶部（或底部）范围内的单元格</td>
</tr>
<tr>
<td>aboveAverage</td>
<td>将格式化应用于值高于（或低于）平均值的单元格</td>
</tr>
<tr>
<td>colorScale</td>
<td>根据其值在范围内的位置将彩色背景应用于单元格</td>
</tr>
<tr>
<td>iconSet</td>
<td>根据值将一系列图标之一添加到单元格</td>
</tr>
<tr>
<td>containsText</td>
<td>根据单元格是否为特定文本来应用格式</td>
</tr>
<tr>
<td>timePeriod</td>
<td>根据单元格日期时间值是否在指定范围内应用格式</td>
</tr>
</tbody></table>
<h3 id="表达式⬆"><a href="#表达式⬆" class="headerlink" title="表达式⬆"></a>表达式<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>属性</th>
<th>可选</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td></td>
<td></td>
<td><code>&#39;expression&#39;</code></td>
</tr>
<tr>
<td>priority</td>
<td>Y</td>
<td>&lt;auto&gt;</td>
<td>确定样式的优先顺序</td>
</tr>
<tr>
<td>formulae</td>
<td></td>
<td></td>
<td>1 个包含真/假值的公式字符串数组。要引用单元格值，请使用左上角的单元格地址</td>
</tr>
<tr>
<td>style</td>
<td></td>
<td></td>
<td>公式返回 <code>true</code> 时要应用的样式结构</td>
</tr>
</tbody></table>
<h3 id="Cell-Is⬆"><a href="#Cell-Is⬆" class="headerlink" title="Cell Is⬆"></a>Cell Is<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>属性</th>
<th>可选</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td></td>
<td></td>
<td><code>&#39;cellIs&#39;</code></td>
</tr>
<tr>
<td>priority</td>
<td>Y</td>
<td>&lt;auto&gt;</td>
<td>确定样式的优先顺序</td>
</tr>
<tr>
<td>operator</td>
<td></td>
<td></td>
<td>如何将单元格值与公式结果进行比较</td>
</tr>
<tr>
<td>formulae</td>
<td></td>
<td></td>
<td>1 个公式字符串数组，返回要与每个单元格进行比较的值</td>
</tr>
<tr>
<td>style</td>
<td></td>
<td></td>
<td>如果比较返回 <code>true</code>，则应用样式结构</td>
</tr>
</tbody></table>
<p><strong>Cell Is 运算符</strong></p>
<table>
<thead>
<tr>
<th>运算</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>equal</td>
<td>如果单元格值等于公式值，则应用格式</td>
</tr>
<tr>
<td>greaterThan</td>
<td>如果单元格值大于公式值，则应用格式</td>
</tr>
<tr>
<td>lessThan</td>
<td>如果单元格值小于公式值，则应用格式</td>
</tr>
<tr>
<td>between</td>
<td>如果单元格值在两个公式值之间（包括两个值），则应用格式</td>
</tr>
</tbody></table>
<h3 id="Top-10⬆"><a href="#Top-10⬆" class="headerlink" title="Top 10⬆"></a>Top 10<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>属性</th>
<th>可选</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td></td>
<td></td>
<td><code>&#39;top10&#39;</code></td>
</tr>
<tr>
<td>priority</td>
<td>Y</td>
<td>&lt;auto&gt;</td>
<td>确定样式的优先顺序</td>
</tr>
<tr>
<td>rank</td>
<td>Y</td>
<td>10</td>
<td>指定格式中包含多少个顶部（或底部）值</td>
</tr>
<tr>
<td>percent</td>
<td>Y</td>
<td><code>false</code></td>
<td>如果为 true，则等级字段为百分比，而不是绝对值</td>
</tr>
<tr>
<td>bottom</td>
<td>Y</td>
<td><code>false</code></td>
<td>如果为 true，则包含最低值而不是最高值</td>
</tr>
<tr>
<td>style</td>
<td></td>
<td></td>
<td>如果比较返回 true，则应用样式结构</td>
</tr>
</tbody></table>
<h3 id="高于平均值⬆"><a href="#高于平均值⬆" class="headerlink" title="高于平均值⬆"></a>高于平均值<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>属性</th>
<th>可选</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td></td>
<td></td>
<td><code>&#39;aboveAverage&#39;</code></td>
</tr>
<tr>
<td>priority</td>
<td>Y</td>
<td>&lt;auto&gt;</td>
<td>确定样式的优先顺序</td>
</tr>
<tr>
<td>aboveAverage</td>
<td>Y</td>
<td><code>false</code></td>
<td>如果为 true，则等级字段为百分比，而不是绝对值</td>
</tr>
<tr>
<td>style</td>
<td></td>
<td></td>
<td>如果比较返回 true，则应用样式结构</td>
</tr>
</tbody></table>
<h3 id="色阶⬆"><a href="#色阶⬆" class="headerlink" title="色阶⬆"></a>色阶<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>属性</th>
<th>可选</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td></td>
<td></td>
<td><code>&#39;colorScale&#39;</code></td>
</tr>
<tr>
<td>priority</td>
<td>Y</td>
<td>&lt;auto&gt;</td>
<td>确定样式的优先顺序</td>
</tr>
<tr>
<td>cfvo</td>
<td></td>
<td></td>
<td>2 到 5 个条件格式化值对象的数组，指定值范围内的航路点</td>
</tr>
<tr>
<td>color</td>
<td></td>
<td></td>
<td>在给定的航路点使用的相应颜色数组</td>
</tr>
<tr>
<td>style</td>
<td></td>
<td></td>
<td>如果比较返回 true，则应用样式结构</td>
</tr>
</tbody></table>
<h3 id="图标集⬆"><a href="#图标集⬆" class="headerlink" title="图标集⬆"></a>图标集<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>属性</th>
<th>可选</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td></td>
<td></td>
<td><code>&#39;iconSet&#39;</code></td>
</tr>
<tr>
<td>priority</td>
<td>Y</td>
<td>&lt;auto&gt;</td>
<td>确定样式的优先顺序</td>
</tr>
<tr>
<td>iconSet</td>
<td>Y</td>
<td>3TrafficLights</td>
<td>设置使用的图标名称</td>
</tr>
<tr>
<td>showValue</td>
<td></td>
<td>true</td>
<td>指定应用范围内的单元格是显示图标和单元格值，还是仅显示图标</td>
</tr>
<tr>
<td>reverse</td>
<td></td>
<td>false</td>
<td>指定是否以保留顺序显示 <code>iconSet</code> 中指定的图标集中的图标。 如果 <code>custom</code> 等于 <code>true</code>，则必须忽略此值</td>
</tr>
<tr>
<td>custom</td>
<td></td>
<td>false</td>
<td>指定是否使用自定义图标集</td>
</tr>
<tr>
<td>cfvo</td>
<td></td>
<td></td>
<td>2 到 5 个条件格式化值对象的数组，指定值范围内的航路点</td>
</tr>
<tr>
<td>style</td>
<td></td>
<td></td>
<td>如果比较返回 true，则应用样式结构</td>
</tr>
</tbody></table>
<h3 id="数据条⬆"><a href="#数据条⬆" class="headerlink" title="数据条⬆"></a>数据条<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>字段</th>
<th>可选</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td></td>
<td></td>
<td><code>&#39;dataBar&#39;</code></td>
</tr>
<tr>
<td>priority</td>
<td>Y</td>
<td>&lt;auto&gt;</td>
<td>确定样式的优先顺序</td>
</tr>
<tr>
<td>minLength</td>
<td></td>
<td>0</td>
<td>指定此条件格式范围内最短数据条的长度</td>
</tr>
<tr>
<td>maxLength</td>
<td></td>
<td>100</td>
<td>指定此条件格式范围内最长数据条的长度</td>
</tr>
<tr>
<td>showValue</td>
<td></td>
<td>true</td>
<td>指定条件格式范围内的单元格是否同时显示数据条和数值或数据条</td>
</tr>
<tr>
<td>gradient</td>
<td></td>
<td>true</td>
<td>指定数据条是否具有渐变填充</td>
</tr>
<tr>
<td>border</td>
<td></td>
<td>true</td>
<td>指定数据条是否有边框</td>
</tr>
<tr>
<td>negativeBarColorSameAsPositive</td>
<td></td>
<td>true</td>
<td>指定数据条是否具有与正条颜色不同的负条颜色</td>
</tr>
<tr>
<td>negativeBarBorderColorSameAsPositive</td>
<td></td>
<td>true</td>
<td>指定数据条的负边框颜色是否不同于正边框颜色</td>
</tr>
<tr>
<td>axisPosition</td>
<td></td>
<td>‘auto’</td>
<td>指定数据条的轴位置</td>
</tr>
<tr>
<td>direction</td>
<td></td>
<td>‘leftToRight’</td>
<td>指定数据条的方向</td>
</tr>
<tr>
<td>cfvo</td>
<td></td>
<td></td>
<td>2 到 5 个条件格式化值对象的数组，指定值范围内的航路点</td>
</tr>
<tr>
<td>style</td>
<td></td>
<td></td>
<td>如果比较返回 true，则应用样式结构</td>
</tr>
</tbody></table>
<h3 id="包含文字⬆"><a href="#包含文字⬆" class="headerlink" title="包含文字⬆"></a>包含文字<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>属性</th>
<th>可选</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td></td>
<td></td>
<td><code>&#39;containsText&#39;</code></td>
</tr>
<tr>
<td>priority</td>
<td>Y</td>
<td>&lt;auto&gt;</td>
<td>确定样式的优先顺序</td>
</tr>
<tr>
<td>operator</td>
<td></td>
<td></td>
<td>文本比较类型</td>
</tr>
<tr>
<td>text</td>
<td></td>
<td></td>
<td>要搜索的文本</td>
</tr>
<tr>
<td>style</td>
<td></td>
<td></td>
<td>如果比较返回 true，则应用样式结构</td>
</tr>
</tbody></table>
<p><strong>包含文本运算符</strong></p>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>containsText</td>
<td>如果单元格值包含在 <code>text</code> 字段中指定的值，则应用格式</td>
</tr>
<tr>
<td>containsBlanks</td>
<td>如果单元格值包含空格，则应用格式</td>
</tr>
<tr>
<td>notContainsBlanks</td>
<td>如果单元格值不包含空格，则应用格式</td>
</tr>
<tr>
<td>containsErrors</td>
<td>如果单元格值包含错误，则应用格式</td>
</tr>
<tr>
<td>notContainsErrors</td>
<td>如果单元格值不包含错误，则应用格式</td>
</tr>
</tbody></table>
<h3 id="时间段⬆"><a href="#时间段⬆" class="headerlink" title="时间段⬆"></a>时间段<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>属性</th>
<th>可选</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>type</td>
<td></td>
<td></td>
<td><code>&#39;timePeriod&#39;</code></td>
</tr>
<tr>
<td>priority</td>
<td>Y</td>
<td>&lt;auto&gt;</td>
<td>确定样式的优先顺序</td>
</tr>
<tr>
<td>timePeriod</td>
<td></td>
<td></td>
<td>比较单元格值的时间段</td>
</tr>
<tr>
<td>style</td>
<td></td>
<td></td>
<td>如果比较返回 true，则应用样式结构</td>
</tr>
</tbody></table>
<p><strong>时间段</strong></p>
<table>
<thead>
<tr>
<th>时间段</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>lastWeek</td>
<td>如果单元格值落在最后一周内，则应用格式</td>
</tr>
<tr>
<td>thisWeek</td>
<td>如果单元格值在本周下降，则应用格式</td>
</tr>
<tr>
<td>nextWeek</td>
<td>如果单元格值在下一周下降，则应用格式</td>
</tr>
<tr>
<td>yesterday</td>
<td>如果单元格值等于昨天，则应用格式</td>
</tr>
<tr>
<td>today</td>
<td>如果单元格值等于今天，则应用格式</td>
</tr>
<tr>
<td>tomorrow</td>
<td>如果单元格值等于明天，则应用格式</td>
</tr>
<tr>
<td>last7Days</td>
<td>如果单元格值在过去 7 天之内，则应用格式</td>
</tr>
<tr>
<td>lastMonth</td>
<td>如果单元格值属于上个月，则应用格式</td>
</tr>
<tr>
<td>thisMonth</td>
<td>如果单元格值在本月下降，则应用格式</td>
</tr>
<tr>
<td>nextMonth</td>
<td>如果单元格值在下个月下降，则应用格式</td>
</tr>
</tbody></table>
<h2 id="大纲级别⬆"><a href="#大纲级别⬆" class="headerlink" title="大纲级别⬆"></a>大纲级别<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>Excel 支持大纲；行或列可以根据用户希望查看的详细程度展开或折叠。</p>
<p>大纲级别可以在列设置中定义：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-property">columns</span> = [<br>  &#123; <span class="hljs-attr">header</span>: <span class="hljs-string">&#x27;Id&#x27;</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;id&#x27;</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">10</span> &#125;,<br>  &#123; <span class="hljs-attr">header</span>: <span class="hljs-string">&#x27;Name&#x27;</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">32</span> &#125;,<br>  &#123; <span class="hljs-attr">header</span>: <span class="hljs-string">&#x27;D.O.B.&#x27;</span>, <span class="hljs-attr">key</span>: <span class="hljs-string">&#x27;DOB&#x27;</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">outlineLevel</span>: <span class="hljs-number">1</span> &#125;,<br>];<br></code></pre></td></tr></table></figure>

<p>或直接在行或列上</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">3</span>).<span class="hljs-property">outlineLevel</span> = <span class="hljs-number">1</span>;<br>worksheet.<span class="hljs-title function_">getRow</span>(<span class="hljs-number">3</span>).<span class="hljs-property">outlineLevel</span> = <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure>

<p>工作表大纲级别可以在工作表上设置</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 设置列大纲级别</span><br>worksheet.<span class="hljs-property">properties</span>.<span class="hljs-property">outlineLevelCol</span> = <span class="hljs-number">1</span>;<br><br><span class="hljs-comment">// 设置行大纲级别</span><br>worksheet.<span class="hljs-property">properties</span>.<span class="hljs-property">outlineLevelRow</span> = <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure>

<p>注意：调整行或列上的大纲级别或工作表上的大纲级别将产生副作用，即还修改受属性更改影响的所有行或列的折叠属性。 例如。：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-property">properties</span>.<span class="hljs-property">outlineLevelCol</span> = <span class="hljs-number">1</span>;<br><br>worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">3</span>).<span class="hljs-property">outlineLevel</span> = <span class="hljs-number">1</span>;<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">3</span>).<span class="hljs-property">collapsed</span>).<span class="hljs-property">to</span>.<span class="hljs-property">be</span>.<span class="hljs-property">true</span>;<br><br>worksheet.<span class="hljs-property">properties</span>.<span class="hljs-property">outlineLevelCol</span> = <span class="hljs-number">2</span>;<br><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getColumn</span>(<span class="hljs-number">3</span>).<span class="hljs-property">collapsed</span>).<span class="hljs-property">to</span>.<span class="hljs-property">be</span>.<span class="hljs-property">false</span>;<br></code></pre></td></tr></table></figure>

<p>大纲属性可以在工作表上设置</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-property">properties</span>.<span class="hljs-property">outlineProperties</span> = &#123;<br>  <span class="hljs-attr">summaryBelow</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-attr">summaryRight</span>: <span class="hljs-literal">false</span>,<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="图片⬆"><a href="#图片⬆" class="headerlink" title="图片⬆"></a>图片<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>将图像添加到工作表是一个分为两个步骤的过程。首先，通过 <code>addImage()</code> 函数将图像添加到工作簿中，该函数还将返回 <code>imageId</code> 值。然后，使用 <code>imageId</code>，可以将图像作为平铺背景或覆盖单元格区域添加到工作表中。</p>
<p>注意：从此版本开始，不支持调整或变换图像。</p>
<h3 id="将图片添加到工作簿⬆"><a href="#将图片添加到工作簿⬆" class="headerlink" title="将图片添加到工作簿⬆"></a>将图片添加到工作簿<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p><code>Workbook.addImage</code> 函数支持按文件名或按 <code>Buffer</code> 添加图像。请注意，在两种情况下，都必须指定扩展名。有效的扩展名包括 “jpeg”，“png”，“gif”。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 通过文件名将图像添加到工作簿</span><br><span class="hljs-keyword">const</span> imageId1 = workbook.<span class="hljs-title function_">addImage</span>(&#123;<br>  <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;path/to/image.jpg&#x27;</span>,<br>  <span class="hljs-attr">extension</span>: <span class="hljs-string">&#x27;jpeg&#x27;</span>,<br>&#125;);<br><br><span class="hljs-comment">// 通过 buffer 将图像添加到工作簿</span><br><span class="hljs-keyword">const</span> imageId2 = workbook.<span class="hljs-title function_">addImage</span>(&#123;<br>  <span class="hljs-attr">buffer</span>: fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&#x27;path/to.image.png&#x27;</span>),<br>  <span class="hljs-attr">extension</span>: <span class="hljs-string">&#x27;png&#x27;</span>,<br>&#125;);<br><br><span class="hljs-comment">// 通过 base64  将图像添加到工作簿</span><br><span class="hljs-keyword">const</span> myBase64Image = <span class="hljs-string">&#x27;data:image/png;base64,iVBORw0KG...&#x27;</span>;<br><span class="hljs-keyword">const</span> imageId2 = workbook.<span class="hljs-title function_">addImage</span>(&#123;<br>  <span class="hljs-attr">base64</span>: myBase64Image,<br>  <span class="hljs-attr">extension</span>: <span class="hljs-string">&#x27;png&#x27;</span>,<br>&#125;);<br></code></pre></td></tr></table></figure>

<h3 id="将图片添加到工作表背景⬆"><a href="#将图片添加到工作表背景⬆" class="headerlink" title="将图片添加到工作表背景⬆"></a>将图片添加到工作表背景<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>使用 <code>Workbook.addImage</code> 中的图像 <code>ID</code>，可以使用 <code>addBackgroundImage</code> 函数设置工作表的背景</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 设置背景</span><br>worksheet.<span class="hljs-title function_">addBackgroundImage</span>(imageId1);<br></code></pre></td></tr></table></figure>

<h3 id="在一定范围内添加图片⬆"><a href="#在一定范围内添加图片⬆" class="headerlink" title="在一定范围内添加图片⬆"></a>在一定范围内添加图片<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>使用 <code>Workbook.addImage</code> 中的图像 <code>ID</code>，可以将图像嵌入工作表中以覆盖一定范围。从该范围计算出的坐标将覆盖从第一个单元格的左上角到第二个单元格的右下角。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 在 B2:D6 上插入图片</span><br>worksheet.<span class="hljs-title function_">addImage</span>(imageId2, <span class="hljs-string">&#x27;B2:D6&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>使用结构而不是范围字符串，可以部分覆盖单元格。</p>
<p>请注意，为此使用的坐标系基于零，因此 A1 的左上角将为 <code>&#123;col：0，row：0&#125;</code>。单元格的分数可以通过使用浮点数来指定，例如 A1 的中点是 <code>&#123;col：0.5，row：0.5&#125;</code>。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 在 B2:D6 的一部分上插入图像</span><br>worksheet.<span class="hljs-title function_">addImage</span>(imageId2, &#123;<br>  <span class="hljs-attr">tl</span>: &#123; <span class="hljs-attr">col</span>: <span class="hljs-number">1.5</span>, <span class="hljs-attr">row</span>: <span class="hljs-number">1.5</span> &#125;,<br>  <span class="hljs-attr">br</span>: &#123; <span class="hljs-attr">col</span>: <span class="hljs-number">3.5</span>, <span class="hljs-attr">row</span>: <span class="hljs-number">5.5</span> &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure>

<p>单元格区域还可以具有属性 <code>&quot;editAs&quot;</code>，该属性将控制将图像锚定到单元格的方式。它可以具有以下值之一：</p>
<table>
<thead>
<tr>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>undefined</code></td>
<td>它指定使图像将根据单元格移动和调整其大小</td>
</tr>
<tr>
<td><code>oneCell</code></td>
<td>这是默认值。图像将与单元格一起移动，但大小不变动</td>
</tr>
<tr>
<td><code>absolute</code></td>
<td>图像将不会随着单元格移动或调整大小</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">ws.<span class="hljs-title function_">addImage</span>(imageId, &#123;<br>  <span class="hljs-attr">tl</span>: &#123; <span class="hljs-attr">col</span>: <span class="hljs-number">0.1125</span>, <span class="hljs-attr">row</span>: <span class="hljs-number">0.4</span> &#125;,<br>  <span class="hljs-attr">br</span>: &#123; <span class="hljs-attr">col</span>: <span class="hljs-number">2.101046875</span>, <span class="hljs-attr">row</span>: <span class="hljs-number">3.4</span> &#125;,<br>  <span class="hljs-attr">editAs</span>: <span class="hljs-string">&#x27;oneCell&#x27;</span>,<br>&#125;);<br></code></pre></td></tr></table></figure>

<h3 id="将图片添加到单元格⬆"><a href="#将图片添加到单元格⬆" class="headerlink" title="将图片添加到单元格⬆"></a>将图片添加到单元格<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>您可以将图像添加到单元格，然后以 96dpi 定义其宽度和高度（以像素为单位）。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">addImage</span>(imageId2, &#123;<br>  <span class="hljs-attr">tl</span>: &#123; <span class="hljs-attr">col</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">row</span>: <span class="hljs-number">0</span> &#125;,<br>  <span class="hljs-attr">ext</span>: &#123; <span class="hljs-attr">width</span>: <span class="hljs-number">500</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">200</span> &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure>

<h3 id="添加带有超链接的图片⬆"><a href="#添加带有超链接的图片⬆" class="headerlink" title="添加带有超链接的图片⬆"></a>添加带有超链接的图片<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>您可以将带有超链接的图像添加到单元格，并在图像范围内定义超链接。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">addImage</span>(imageId2, &#123;<br>  <span class="hljs-attr">tl</span>: &#123; <span class="hljs-attr">col</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">row</span>: <span class="hljs-number">0</span> &#125;,<br>  <span class="hljs-attr">ext</span>: &#123; <span class="hljs-attr">width</span>: <span class="hljs-number">500</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">200</span> &#125;,<br>  <span class="hljs-attr">hyperlinks</span>: &#123;<br>    <span class="hljs-attr">hyperlink</span>: <span class="hljs-string">&#x27;http://www.somewhere.com&#x27;</span>,<br>    <span class="hljs-attr">tooltip</span>: <span class="hljs-string">&#x27;http://www.somewhere.com&#x27;</span>,<br>  &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure>

<h2 id="工作表保护⬆"><a href="#工作表保护⬆" class="headerlink" title="工作表保护⬆"></a>工作表保护<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>可以通过添加密码来保护工作表免受修改。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">await</span> worksheet.<span class="hljs-title function_">protect</span>(<span class="hljs-string">&#x27;the-password&#x27;</span>, options);<br></code></pre></td></tr></table></figure>

<p>工作表保护也可以删除：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">unprotect</span>();<br></code></pre></td></tr></table></figure>

<p>有关如何修改单个单元格保护的详细信息请查看 <a href="#单元格保护">单元格保护</a>。</p>
<p><strong>注意：</strong> 当 <code>protect()</code> 函数返回一个 Promise 代表它是异步的，当前的实现在主线程上运行，并且在 CPU 上将使用平均大约 600 毫秒。可以通过设置 <code>spinCount</code> 进行调整，该值可用于使过程更快或更有弹性。</p>
<h3 id="工作表保护选项⬆"><a href="#工作表保护选项⬆" class="headerlink" title="工作表保护选项⬆"></a>工作表保护选项<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><table>
<thead>
<tr>
<th>属性</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>selectLockedCells</td>
<td><code>true</code></td>
<td>允许用户选择锁定的单元格</td>
</tr>
<tr>
<td>selectUnlockedCells</td>
<td><code>true</code></td>
<td>允许用户选择未锁定的单元格</td>
</tr>
<tr>
<td>formatCells</td>
<td><code>false</code></td>
<td>允许用户格式化单元格</td>
</tr>
<tr>
<td>formatColumns</td>
<td><code>false</code></td>
<td>允许用户格式化列</td>
</tr>
<tr>
<td>formatRows</td>
<td><code>false</code></td>
<td>允许用户格式化行</td>
</tr>
<tr>
<td>insertRows</td>
<td><code>false</code></td>
<td>允许用户插入行</td>
</tr>
<tr>
<td>insertColumns</td>
<td><code>false</code></td>
<td>允许用户插入列</td>
</tr>
<tr>
<td>insertHyperlinks</td>
<td><code>false</code></td>
<td>允许用户插入超链接</td>
</tr>
<tr>
<td>deleteRows</td>
<td><code>false</code></td>
<td>允许用户删除行</td>
</tr>
<tr>
<td>deleteColumns</td>
<td><code>false</code></td>
<td>允许用户删除列</td>
</tr>
<tr>
<td>sort</td>
<td><code>false</code></td>
<td>允许用户对数据进行排序</td>
</tr>
<tr>
<td>autoFilter</td>
<td><code>false</code></td>
<td>允许用户过滤表中的数据</td>
</tr>
<tr>
<td>pivotTables</td>
<td><code>false</code></td>
<td>允许用户使用数据透视表</td>
</tr>
<tr>
<td>spinCount</td>
<td>100000</td>
<td>保护或取消保护时执行的哈希迭代次数</td>
</tr>
</tbody></table>
<h2 id="文件-I-O⬆"><a href="#文件-I-O⬆" class="headerlink" title="文件 I/O⬆"></a>文件 I/O<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><h3 id="XLSX⬆"><a href="#XLSX⬆" class="headerlink" title="XLSX⬆"></a>XLSX<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><h4 id="读-XLSX⬆"><a href="#读-XLSX⬆" class="headerlink" title="读 XLSX⬆"></a>读 XLSX<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h4><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 从文件读取</span><br><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Excel</span>.<span class="hljs-title class_">Workbook</span>();<br><span class="hljs-keyword">await</span> workbook.<span class="hljs-property">xlsx</span>.<span class="hljs-title function_">readFile</span>(filename);<br><span class="hljs-comment">// ... 使用 workbook</span><br><br><span class="hljs-comment">// 从流读取</span><br><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Excel</span>.<span class="hljs-title class_">Workbook</span>();<br><span class="hljs-keyword">await</span> workbook.<span class="hljs-property">xlsx</span>.<span class="hljs-title function_">read</span>(stream);<br><span class="hljs-comment">// ... 使用 workbook</span><br><br><span class="hljs-comment">// 从 buffer 加载</span><br><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Excel</span>.<span class="hljs-title class_">Workbook</span>();<br><span class="hljs-keyword">await</span> workbook.<span class="hljs-property">xlsx</span>.<span class="hljs-title function_">load</span>(data);<br><span class="hljs-comment">// ... 使用 workbook</span><br></code></pre></td></tr></table></figure>

<h4 id="写-XLSX"><a href="#写-XLSX" class="headerlink" title="写 XLSX"></a>写 XLSX</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 写入文件</span><br><span class="hljs-keyword">const</span> workbook = <span class="hljs-title function_">createAndFillWorkbook</span>();<br><span class="hljs-keyword">await</span> workbook.<span class="hljs-property">xlsx</span>.<span class="hljs-title function_">writeFile</span>(filename);<br><br><span class="hljs-comment">// 写入流</span><br><span class="hljs-keyword">await</span> workbook.<span class="hljs-property">xlsx</span>.<span class="hljs-title function_">write</span>(stream);<br><br><span class="hljs-comment">// 写入 buffer</span><br><span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">await</span> workbook.<span class="hljs-property">xlsx</span>.<span class="hljs-title function_">writeBuffer</span>();<br></code></pre></td></tr></table></figure>

<h3 id="CSV⬆"><a href="#CSV⬆" class="headerlink" title="CSV⬆"></a>CSV<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><h4 id="读-CSV⬆"><a href="#读-CSV⬆" class="headerlink" title="读 CSV⬆"></a>读 CSV<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h4><p>读取 CSV 文件时支持的选项。</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>是否需要</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>dateFormats</td>
<td>N</td>
<td>Array</td>
<td>指定 dayjs 的日期编码格式。</td>
</tr>
<tr>
<td>map</td>
<td>N</td>
<td>Function</td>
<td>自定义<code>Array.prototype.map()</code> 回调函数，用于处理数据。</td>
</tr>
<tr>
<td>sheetName</td>
<td>N</td>
<td>String</td>
<td>指定工作表名称。</td>
</tr>
<tr>
<td>parserOptions</td>
<td>N</td>
<td>Object</td>
<td><a target="_blank" rel="noopener" href="https://c2fo.io/fast-csv/docs/parsing/options">parseOptions 选项</a> @fast-csv/format 模块以写入 csv 数据。</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 从文件读取</span><br><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Excel</span>.<span class="hljs-title class_">Workbook</span>();<br><span class="hljs-keyword">const</span> worksheet = <span class="hljs-keyword">await</span> workbook.<span class="hljs-property">csv</span>.<span class="hljs-title function_">readFile</span>(filename);<br><span class="hljs-comment">// ... 使用 workbook 或 worksheet</span><br><br><span class="hljs-comment">// 从流中读取</span><br><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Excel</span>.<span class="hljs-title class_">Workbook</span>();<br><span class="hljs-keyword">const</span> worksheet = <span class="hljs-keyword">await</span> workbook.<span class="hljs-property">csv</span>.<span class="hljs-title function_">read</span>(stream);<br><span class="hljs-comment">// ... 使用 workbook 或 worksheet</span><br><br><span class="hljs-comment">// 从带有欧洲日期的文件中读取</span><br><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Excel</span>.<span class="hljs-title class_">Workbook</span>();<br><span class="hljs-keyword">const</span> options = &#123;<br>  <span class="hljs-attr">dateFormats</span>: [<span class="hljs-string">&#x27;DD/MM/YYYY&#x27;</span>],<br>&#125;;<br><span class="hljs-keyword">const</span> worksheet = <span class="hljs-keyword">await</span> workbook.<span class="hljs-property">csv</span>.<span class="hljs-title function_">readFile</span>(filename, options);<br><span class="hljs-comment">// ... 使用 workbook 或 worksheet</span><br><br><span class="hljs-comment">// 从具有自定义值解析的文件中读取</span><br><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Excel</span>.<span class="hljs-title class_">Workbook</span>();<br><span class="hljs-keyword">const</span> options = &#123;<br>  <span class="hljs-title function_">map</span>(<span class="hljs-params">value, index</span>) &#123;<br>    <span class="hljs-keyword">switch</span> (index) &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>        <span class="hljs-comment">// 第1列是字符串</span><br>        <span class="hljs-keyword">return</span> value;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-comment">// 第2列是日期</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(value);<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        <span class="hljs-comment">// 第3列是公式值的JSON</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(value);<br>      <span class="hljs-attr">default</span>:<br>        <span class="hljs-comment">// 其余的是数字</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(value);<br>    &#125;<br>  &#125;,<br>  <span class="hljs-comment">// https://c2fo.io/fast-csv/docs/parsing/options</span><br>  <span class="hljs-attr">parserOptions</span>: &#123;<br>    <span class="hljs-attr">delimiter</span>: <span class="hljs-string">&#x27;\t&#x27;</span>,<br>    <span class="hljs-attr">quote</span>: <span class="hljs-literal">false</span>,<br>  &#125;,<br>&#125;;<br><span class="hljs-keyword">const</span> worksheet = <span class="hljs-keyword">await</span> workbook.<span class="hljs-property">csv</span>.<span class="hljs-title function_">readFile</span>(filename, options);<br><span class="hljs-comment">// ... 使用 workbook 或 worksheet</span><br></code></pre></td></tr></table></figure>

<p>CSV 解析器使用 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/fast-csv">fast-csv</a> 读取 CSV 文件。传递给上述写入函数的选项中的 <code>formatterOptions</code> 将传递给 @fast-csv/format 模块以写入 csv 数据。 有关详细信息，请参阅 fast-csv README.md。</p>
<p>使用 npm 模块 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/dayjs">dayjs</a> 解析日期。如果未提供 <code>dateFormats</code> 数组，则使用以下 dateFormats：</p>
<ul>
<li>‘YYYY-MM-DD[T]HH:mm:ss’</li>
<li>‘MM-DD-YYYY’</li>
<li>‘YYYY-MM-DD’</li>
</ul>
<p>请参阅 <a target="_blank" rel="noopener" href="https://github.com/iamkun/dayjs/blob/HEAD/docs/en/Plugin.md#customparseformat">dayjs CustomParseFormat 插件</a>，以获取有关如何构造 <code>dateFormat</code> 的详细信息。</p>
<h4 id="写-CSV⬆"><a href="#写-CSV⬆" class="headerlink" title="写 CSV⬆"></a>写 CSV<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h4><p>写入 CSV 文件时支持的选项。</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>是否需要</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>dateFormat</td>
<td>N</td>
<td>String</td>
<td>指定 dayjs 的日期编码格式。</td>
</tr>
<tr>
<td>dateUTC</td>
<td>N</td>
<td>Boolean</td>
<td>指定 ExcelJS 是否使用<code>dayjs.utc()</code>转换时区以解析日期。</td>
</tr>
<tr>
<td>encoding</td>
<td>N</td>
<td>String</td>
<td>指定文件编码格式。</td>
</tr>
<tr>
<td>includeEmptyRows</td>
<td>N</td>
<td>Boolean</td>
<td>指定是否可以写入空行。</td>
</tr>
<tr>
<td>map</td>
<td>N</td>
<td>Function</td>
<td>自定义<code>Array.prototype.map()</code> 回调函数，用于处理行值。</td>
</tr>
<tr>
<td>sheetName</td>
<td>N</td>
<td>String</td>
<td>指定工作表名称。</td>
</tr>
<tr>
<td>sheetId</td>
<td>N</td>
<td>Number</td>
<td>指定工作表 ID。</td>
</tr>
<tr>
<td>formatterOptions</td>
<td>N</td>
<td>Object</td>
<td><a target="_blank" rel="noopener" href="https://c2fo.io/fast-csv/docs/formatting/options/">formatterOptions 选项</a> @fast-csv/format 模块写入 csv 数据。</td>
</tr>
</tbody></table>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 写入文件</span><br><span class="hljs-keyword">const</span> workbook = <span class="hljs-title function_">createAndFillWorkbook</span>();<br><span class="hljs-keyword">await</span> workbook.<span class="hljs-property">csv</span>.<span class="hljs-title function_">writeFile</span>(filename);<br><br><span class="hljs-comment">// 写入流</span><br><span class="hljs-comment">// 请注意，您需要提供 sheetName 或 sheetId 以正确导入到 csv</span><br><span class="hljs-keyword">await</span> workbook.<span class="hljs-property">csv</span>.<span class="hljs-title function_">write</span>(stream, &#123; <span class="hljs-attr">sheetName</span>: <span class="hljs-string">&#x27;Page name&#x27;</span> &#125;);<br><br><span class="hljs-comment">// 使用欧洲日期时间写入文件</span><br><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Excel</span>.<span class="hljs-title class_">Workbook</span>();<br><span class="hljs-keyword">const</span> options = &#123;<br>  <span class="hljs-attr">dateFormat</span>: <span class="hljs-string">&#x27;DD/MM/YYYY HH:mm:ss&#x27;</span>,<br>  <span class="hljs-attr">dateUTC</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// 呈现日期时使用 utc</span><br>&#125;;<br><span class="hljs-keyword">await</span> workbook.<span class="hljs-property">csv</span>.<span class="hljs-title function_">writeFile</span>(filename, options);<br><br><span class="hljs-comment">// 使用自定义值格式写入文件</span><br><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Excel</span>.<span class="hljs-title class_">Workbook</span>();<br><span class="hljs-keyword">const</span> options = &#123;<br>  <span class="hljs-title function_">map</span>(<span class="hljs-params">value, index</span>) &#123;<br>    <span class="hljs-keyword">switch</span> (index) &#123;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>        <span class="hljs-comment">// 第1列是字符串</span><br>        <span class="hljs-keyword">return</span> value;<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>        <span class="hljs-comment">// 第2列是日期</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_">dayjs</span>(value).<span class="hljs-title function_">format</span>(<span class="hljs-string">&#x27;YYYY-MM-DD&#x27;</span>);<br>      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        <span class="hljs-comment">// 第3列是一个公式，只写结果</span><br>        <span class="hljs-keyword">return</span> value.<span class="hljs-property">result</span>;<br>      <span class="hljs-attr">default</span>:<br>        <span class="hljs-comment">// 其余的是数字</span><br>        <span class="hljs-keyword">return</span> value;<br>    &#125;<br>  &#125;,<br>  <span class="hljs-comment">// https://c2fo.io/fast-csv/docs/formatting/options</span><br>  <span class="hljs-attr">formatterOptions</span>: &#123;<br>    <span class="hljs-attr">delimiter</span>: <span class="hljs-string">&#x27;\t&#x27;</span>,<br>    <span class="hljs-attr">quote</span>: <span class="hljs-literal">false</span>,<br>  &#125;,<br>&#125;;<br><span class="hljs-keyword">await</span> workbook.<span class="hljs-property">csv</span>.<span class="hljs-title function_">writeFile</span>(filename, options);<br><br><span class="hljs-comment">// 写入新 buffer</span><br><span class="hljs-keyword">const</span> buffer = <span class="hljs-keyword">await</span> workbook.<span class="hljs-property">csv</span>.<span class="hljs-title function_">writeBuffer</span>();<br></code></pre></td></tr></table></figure>

<p>CSV 解析器使用 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/fast-csv">fast-csv</a> 编写 CSV 文件。传递给上述写入函数的选项中的 <code>formatterOptions</code> 将传递给 @fast-csv/format 模块以写入 csv 数据。有关详细信息，请参阅 fast-csv README.md。</p>
<p>日期使用 npm 模块 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/dayjs">dayjs</a> 格式化。如果未提供 <code>dateFormat</code>，则使用 <code>dayjs.ISO_8601</code>。编写 CSV 时，您可以提供布尔值 <code>dateUTC</code> 为 <code>true</code>，以使 ExcelJS 解析日期，而无需使用 <code>dayjs.utc()</code> 自动转换时区。</p>
<h3 id="流式-I-O⬆"><a href="#流式-I-O⬆" class="headerlink" title="流式 I/O⬆"></a>流式 I/O<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>上面记录的文件 I/O 需要在内存中建立整个工作簿，然后才能写入文件。虽然方便，但是由于所需的内存量，它可能会限制文档的大小。</p>
<p>流写入器（或读取器）在生成工作簿或工作表数据时对其进行处理，然后将其转换为文件形式。通常，这在内存上效率要高得多，因为最终的内存占用量，甚至中间的内存占用量都比文档版本要紧凑得多，尤其是当您考虑到行和单元格对象一旦提交就被销毁时，尤其如此。</p>
<p>流式工作簿和工作表的接口几乎与文档版本相同，但实际存在一些细微差别：</p>
<ul>
<li>将工作表添加到工作簿后，将无法将其删除。</li>
<li>提交行后，将无法再访问该行，因为该行将从工作表中删除。</li>
<li>不支持 <code>unMergeCells()</code>。</li>
</ul>
<p>请注意，可以在不提交任何行的情况下构建整个工作簿。提交工作簿后，所有添加的工作表（包括所有未提交的行）将自动提交。但是，在这种情况下，与文档版本相比收效甚微。</p>
<h4 id="流式-XLSX⬆"><a href="#流式-XLSX⬆" class="headerlink" title="流式 XLSX⬆"></a>流式 XLSX<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h4><h5 id="流式-XLSX-写入器⬆"><a href="#流式-XLSX-写入器⬆" class="headerlink" title="流式 XLSX 写入器⬆"></a>流式 XLSX 写入器<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h5><p>流式 XLSX 写入器在 <code>ExcelJS.stream.xlsx</code> 命名空间中可用。</p>
<p>构造函数采用带有以下字段的可选 <code>options</code> 对象：</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>stream</td>
<td>指定要写入 XLSX 工作簿的可写流。</td>
</tr>
<tr>
<td>filename</td>
<td>如果未指定流，则此字段指定要写入 XLSX 工作簿的文件的路径。</td>
</tr>
<tr>
<td>useSharedStrings</td>
<td>指定是否在工作簿中使用共享字符串。默认为 <code>false</code></td>
</tr>
<tr>
<td>useStyles</td>
<td>指定是否将样式信息添加到工作簿。样式会增加一些性能开销。默认为 <code>false</code></td>
</tr>
<tr>
<td>zip</td>
<td>ExcelJS 内部传递给 <a target="_blank" rel="noopener" href="https://github.com/archiverjs/node-archiver">Archiver</a> 的 <a target="_blank" rel="noopener" href="https://www.archiverjs.com/global.html#ZipOptions">Zip 选项</a>。默认值为 <code>undefined</code></td>
</tr>
</tbody></table>
<p>如果在选项中未指定 <code>stream</code> 或 <code>filename</code>，则工作簿编写器将创建一个 StreamBuf 对象，该对象将 XLSX 工作簿的内容存储在内存中。可以通过属性 <code>workbook.stream</code> 访问此 StreamBuf 对象，该对象可用于通过 <code>stream.read()</code> 直接访问字节，或将内容通过管道传输到另一个流。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 使用样式和共享字符串构造流式 XLSX 工作簿编写器</span><br><span class="hljs-keyword">const</span> options = &#123;<br>  <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;./streamed-workbook.xlsx&#x27;</span>,<br>  <span class="hljs-attr">useStyles</span>: <span class="hljs-literal">true</span>,<br>  <span class="hljs-attr">useSharedStrings</span>: <span class="hljs-literal">true</span>,<br>&#125;;<br><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Excel</span>.<span class="hljs-property">stream</span>.<span class="hljs-property">xlsx</span>.<span class="hljs-title class_">WorkbookWriter</span>(options);<br></code></pre></td></tr></table></figure>

<p>通常，流式 XLSX 写入器的接口与上述文档工作簿（和工作表）相同，实际上行，单元格和样式对象是相同的。</p>
<p>但是有一些区别…</p>
<p><strong>构造</strong></p>
<p>如上所示，WorkbookWriter 通常将要求在构造函数中指定输出流或文件。</p>
<p><strong>提交数据</strong></p>
<p>当工作表行准备就绪时，应将其提交，以便可以释放行对象和内容。通常，这将在添加每一行时完成…</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet<br>  .<span class="hljs-title function_">addRow</span>(&#123;<br>    <span class="hljs-attr">id</span>: i,<br>    <span class="hljs-attr">name</span>: theName,<br>    <span class="hljs-attr">etc</span>: someOtherDetail,<br>  &#125;)<br>  .<span class="hljs-title function_">commit</span>();<br></code></pre></td></tr></table></figure>

<p>WorksheetWriter 在添加行时不提交行的原因是允许单元格跨行合并：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">mergeCells</span>(<span class="hljs-string">&#x27;A1:B2&#x27;</span>);<br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;I am merged&#x27;</span>;<br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;C1&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;I am not&#x27;</span>;<br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;C2&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;Neither am I&#x27;</span>;<br>worksheet.<span class="hljs-title function_">getRow</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">commit</span>(); <span class="hljs-comment">// now rows 1 and two are committed.</span><br></code></pre></td></tr></table></figure>

<p>每个工作表完成后，还必须提交：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 完成添加数据。 提交工作表</span><br>worksheet.<span class="hljs-title function_">commit</span>();<br></code></pre></td></tr></table></figure>

<p>要完成 XLSX 文档，必须提交工作簿。 如果未提交工作簿中的任何工作表，则将在工作簿提交中自动提交它们。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 完成 workbook.</span><br><span class="hljs-keyword">await</span> workbook.<span class="hljs-title function_">commit</span>();<br><span class="hljs-comment">// ... 流已被写入</span><br></code></pre></td></tr></table></figure>

<h5 id="流式-XLSX-阅读器⬆"><a href="#流式-XLSX-阅读器⬆" class="headerlink" title="流式 XLSX 阅读器⬆"></a>流式 XLSX 阅读器<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h5><p>流式 XLSX 工作簿阅读器可以在 ExcelJS.stream.xlsx 命名空间中找到。</p>
<p>构造函数包含必需的输入参数和可选的 options 参数:</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>input (必需的)</td>
<td>指定从中读取 XLSX 工作簿的文件或可读流的名称</td>
</tr>
<tr>
<td>options (可选的)</td>
<td>指定如何处理读取解析期间发生的事件类型</td>
</tr>
<tr>
<td>options.entries</td>
<td>指定是否去触发事件(<code>&#39;emit&#39;</code>)或者不发出事件(<code>&#39;ignore&#39;</code>)，默认值是<code>&#39;emit&#39;</code></td>
</tr>
<tr>
<td>options.sharedStrings</td>
<td>指定是否去缓存(<code>&#39;cache&#39;</code>)共享字符串，将其插入到相应的单元格值中，或者是否去触发(<code>&#39;emit&#39;</code>)或忽略(<code>&#39;ignore&#39;</code>)它们，在这两种情况下，单元格值都将是对共享字符串索引的引用。默认值是<code>&#39;cache&#39;</code></td>
</tr>
<tr>
<td>options.hyperlinks</td>
<td>指定是否去缓存超链接(<code>&#39;cache&#39;</code>)，将其插入到相应的单元格值中，是否去触发(<code>&#39;emit&#39;</code>)或忽略(<code>&#39;ignore&#39;</code>)它们。默认值是<code>&#39;cache&#39;</code></td>
</tr>
<tr>
<td>options.styles</td>
<td>指定是否去缓存样式(<code>&#39;cache&#39;</code>)，将其插入到相应的行或单元格值中，或是否忽略(<code>&#39;忽略&#39;</code>)它们。默认值是<code>&#39;cache&#39;</code></td>
</tr>
<tr>
<td>options.worksheets</td>
<td>指定是否去触发(<code>&#39;emit&#39;</code>)或忽略(<code>&#39;ignore&#39;</code>)工作表。默认值是<code>&#39;emit&#39;</code></td>
</tr>
</tbody></table>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExcelJS</span>.<span class="hljs-property">stream</span>.<span class="hljs-property">xlsx</span>.<span class="hljs-title class_">WorkbookReader</span>(<span class="hljs-string">&#x27;./file.xlsx&#x27;</span>);<br><span class="hljs-keyword">for</span> <span class="hljs-title function_">await</span> (<span class="hljs-keyword">const</span> worksheetReader <span class="hljs-keyword">of</span> workbookReader) &#123;<br>  <span class="hljs-keyword">for</span> <span class="hljs-title function_">await</span> (<span class="hljs-keyword">const</span> row <span class="hljs-keyword">of</span> worksheetReader) &#123;<br>    <span class="hljs-comment">// ...</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>请注意，由于性能原因，<code>worksheetReader</code>返回一个行数组，而不是单独返回每一行: <a target="_blank" rel="noopener" href="https://github.com/nodejs/node/issues/31979">https://github.com/nodejs/node/issues/31979</a></p>
<h6 id="迭代遍历所有事件⬆"><a href="#迭代遍历所有事件⬆" class="headerlink" title="迭代遍历所有事件⬆"></a>迭代遍历所有事件<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h6><p>工作簿上的事件是 ‘worksheet’、’shared-strings’ 和 ‘hyperlinks’。 工作表上的事件是 ‘row’ 和 ‘hyperlinks’.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> options = &#123;<br>  <span class="hljs-attr">sharedStrings</span>: <span class="hljs-string">&#x27;emit&#x27;</span>,<br>  <span class="hljs-attr">hyperlinks</span>: <span class="hljs-string">&#x27;emit&#x27;</span>,<br>  <span class="hljs-attr">worksheets</span>: <span class="hljs-string">&#x27;emit&#x27;</span>,<br>&#125;;<br><span class="hljs-keyword">const</span> workbook = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExcelJS</span>.<span class="hljs-property">stream</span>.<span class="hljs-property">xlsx</span>.<span class="hljs-title class_">WorkbookReader</span>(<span class="hljs-string">&#x27;./file.xlsx&#x27;</span>, options);<br><span class="hljs-keyword">for</span> <span class="hljs-title function_">await</span> (<span class="hljs-keyword">const</span> &#123; eventType, value &#125; <span class="hljs-keyword">of</span> workbook.<span class="hljs-title function_">parse</span>()) &#123;<br>  <span class="hljs-keyword">switch</span> (eventType) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;shared-strings&#x27;</span>:<br>    <span class="hljs-comment">// 值是共享字符串</span><br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;worksheet&#x27;</span>:<br>    <span class="hljs-comment">// 值是worksheetReader</span><br>    <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;hyperlinks&#x27;</span>:<br>    <span class="hljs-comment">// 值是hyperlinksReader</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h6 id="可读流⬆"><a href="#可读流⬆" class="headerlink" title="可读流⬆"></a>可读流<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h6><p>我们强烈建议使用异步迭代，但我们也公开了流接口以实现向后兼容性。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> options = &#123;<br>  <span class="hljs-attr">sharedStrings</span>: <span class="hljs-string">&#x27;emit&#x27;</span>,<br>  <span class="hljs-attr">hyperlinks</span>: <span class="hljs-string">&#x27;emit&#x27;</span>,<br>  <span class="hljs-attr">worksheets</span>: <span class="hljs-string">&#x27;emit&#x27;</span>,<br>&#125;;<br><span class="hljs-keyword">const</span> workbookReader = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ExcelJS</span>.<span class="hljs-property">stream</span>.<span class="hljs-property">xlsx</span>.<span class="hljs-title class_">WorkbookReader</span>(<br>  <span class="hljs-string">&#x27;./file.xlsx&#x27;</span>,<br>  options<br>);<br>workbookReader.<span class="hljs-title function_">read</span>();<br><br>workbookReader.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;worksheet&#x27;</span>, <span class="hljs-function"><span class="hljs-params">worksheet</span> =&gt;</span> &#123;<br>  worksheet.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;row&#x27;</span>, <span class="hljs-function"><span class="hljs-params">row</span> =&gt;</span> &#123;&#125;);<br>&#125;);<br><br>workbookReader.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;shared-strings&#x27;</span>, <span class="hljs-function"><span class="hljs-params">sharedString</span> =&gt;</span> &#123;<br>  <span class="hljs-comment">// ...</span><br>&#125;);<br><br>workbookReader.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;hyperlinks&#x27;</span>, <span class="hljs-function"><span class="hljs-params">hyperlinksReader</span> =&gt;</span> &#123;<br>  <span class="hljs-comment">// ...</span><br>&#125;);<br><br>workbookReader.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;end&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-comment">// ...</span><br>&#125;);<br>workbookReader.<span class="hljs-title function_">on</span>(<span class="hljs-string">&#x27;error&#x27;</span>, <span class="hljs-function"><span class="hljs-params">err</span> =&gt;</span> &#123;<br>  <span class="hljs-comment">// ...</span><br>&#125;);<br></code></pre></td></tr></table></figure>

<h1 id="浏览器⬆"><a href="#浏览器⬆" class="headerlink" title="浏览器⬆"></a>浏览器<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h1><p>该库的一部分已被隔离，并经过测试可在浏览器环境中使用。</p>
<p>由于工作簿读写器的流式传输性质，因此未包括这些内容。只能使用基于文档的工作簿（有关详细信息，请参见 <a href="#创建工作簿">创建工作簿</a>）。</p>
<p>例如，在浏览器中使用 ExcelJS 的代码可查看 github 中的<a target="_blank" rel="noopener" href="https://github.com/exceljs/exceljs/tree/master/spec/browser"> spec / browser </a>文件夹。</p>
<h2 id="预捆绑⬆"><a href="#预捆绑⬆" class="headerlink" title="预捆绑⬆"></a>预捆绑<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>以下文件已预先捆绑在一起，并包含在 <em>dist</em> 文件夹中。</p>
<ul>
<li>exceljs.js</li>
<li>exceljs.min.js</li>
</ul>
<h1 id="值类型⬆"><a href="#值类型⬆" class="headerlink" title="值类型⬆"></a>值类型<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h1><p>支持以下值类型。</p>
<h2 id="Null-值⬆"><a href="#Null-值⬆" class="headerlink" title="Null 值⬆"></a>Null 值<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>Enum: <code>Excel.ValueType.Null</code></p>
<p>空值表示没有值，通常在写入文件时将不存储（合并的单元格除外）。可用于从单元格中删除该值。例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-literal">null</span>;<br></code></pre></td></tr></table></figure>

<h2 id="合并单元格⬆-1"><a href="#合并单元格⬆-1" class="headerlink" title="合并单元格⬆"></a>合并单元格<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>Enum: <code>Excel.ValueType.Merge</code></p>
<p>合并单元格是其值绑定到另一个“主”单元格的单元格。分配给合并单元将导致修改单元格。</p>
<h2 id="数字值⬆"><a href="#数字值⬆" class="headerlink" title="数字值⬆"></a>数字值<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>Enum: <code>Excel.ValueType.Number</code></p>
<p>一个数字值。</p>
<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-number">5</span>;<br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A2&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-number">3.14159</span>;<br></code></pre></td></tr></table></figure>

<h2 id="字符串值⬆"><a href="#字符串值⬆" class="headerlink" title="字符串值⬆"></a>字符串值<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>Enum: <code>Excel.ValueType.String</code></p>
<p>一个简单的文本字符串。</p>
<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-string">&#x27;Hello, World!&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h2 id="日期值⬆"><a href="#日期值⬆" class="headerlink" title="日期值⬆"></a>日期值<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>Enum: <code>Excel.ValueType.Date</code></p>
<p>日期值，由 JavaScript Date 类型表示。</p>
<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>(<span class="hljs-number">2017</span>, <span class="hljs-number">2</span>, <span class="hljs-number">15</span>);<br></code></pre></td></tr></table></figure>

<h2 id="超链接值⬆"><a href="#超链接值⬆" class="headerlink" title="超链接值⬆"></a>超链接值<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>Enum: <code>Excel.ValueType.Hyperlink</code></p>
<p>具有文本和链接值的 URL。</p>
<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 链接到网络</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = &#123;<br>  <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;www.mylink.com&#x27;</span>,<br>  <span class="hljs-attr">hyperlink</span>: <span class="hljs-string">&#x27;http://www.mylink.com&#x27;</span>,<br>  <span class="hljs-attr">tooltip</span>: <span class="hljs-string">&#x27;www.mylink.com&#x27;</span>,<br>&#125;;<br><br><span class="hljs-comment">// 内部链接</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = &#123; <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;Sheet2&#x27;</span>, <span class="hljs-attr">hyperlink</span>: <span class="hljs-string">&quot;#&#x27;Sheet2&#x27;!A1&quot;</span> &#125;;<br></code></pre></td></tr></table></figure>

<h2 id="公式值⬆"><a href="#公式值⬆" class="headerlink" title="公式值⬆"></a>公式值<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>Enum: <code>Excel.ValueType.Formula</code></p>
<p>一个 Excel 公式，用于即时计算值。请注意，虽然单元格类型将为“公式”，但该单元格可能具有一个有效类型值，该值将从结果值中得出。</p>
<p>请注意，ExcelJS 无法处理公式以生成结果，必须提供该公式。</p>
<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A3&#x27;</span>).<span class="hljs-property">value</span> = &#123; <span class="hljs-attr">formula</span>: <span class="hljs-string">&#x27;A1+A2&#x27;</span>, <span class="hljs-attr">result</span>: <span class="hljs-number">7</span> &#125;;<br></code></pre></td></tr></table></figure>

<p>单元格还支持便捷的获取器，以访问公式和结果：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A3&#x27;</span>).<span class="hljs-property">formula</span> === <span class="hljs-string">&#x27;A1+A2&#x27;</span>;<br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A3&#x27;</span>).<span class="hljs-property">result</span> === <span class="hljs-number">7</span>;<br></code></pre></td></tr></table></figure>

<h3 id="共享公式⬆"><a href="#共享公式⬆" class="headerlink" title="共享公式⬆"></a>共享公式<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>共享的公式通过减少工作表 xml 中文本的重复来增强 xlsx 文档的压缩。范围中左上角的单元格是指定的母版，它将保留该范围内的所有其他单元格都将引用的公式。然后，其他“从属”单元格可以引用此主单元格，而不必再次重新定义整个公式。请注意，主公式将以常用的 Excel 方式转换为从属单元格，以便对其他单元格的引用将根据从属单元相对于主单元的偏移量向右下移。例如：如果主单元格 A2 具有引用 A1 的公式，则如果单元格 B2 共享 A2 的公式，则它将引用 B1。</p>
<p>可以将主公式与该范围内的从属单元格一起分配给该单元格</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A2&#x27;</span>).<span class="hljs-property">value</span> = &#123;<br>  <span class="hljs-attr">formula</span>: <span class="hljs-string">&#x27;A1&#x27;</span>,<br>  <span class="hljs-attr">result</span>: <span class="hljs-number">10</span>,<br>  <span class="hljs-attr">shareType</span>: <span class="hljs-string">&#x27;shared&#x27;</span>,<br>  <span class="hljs-attr">ref</span>: <span class="hljs-string">&#x27;A2:B3&#x27;</span>,<br>&#125;;<br></code></pre></td></tr></table></figure>

<p>可以使用新的值形式将共享公式分配给单元格：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B2&#x27;</span>).<span class="hljs-property">value</span> = &#123; <span class="hljs-attr">sharedFormula</span>: <span class="hljs-string">&#x27;A2&#x27;</span>, <span class="hljs-attr">result</span>: <span class="hljs-number">10</span> &#125;;<br></code></pre></td></tr></table></figure>

<p>这指定单元格 B2 是将从 A2 中的公式派生的公式，其结果为 10。</p>
<p>公式便捷获取器会将 A2 中的公式转换为 B2 中应具有的公式：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-title function_">expect</span>(worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B2&#x27;</span>).<span class="hljs-property">formula</span>).<span class="hljs-property">to</span>.<span class="hljs-title function_">equal</span>(<span class="hljs-string">&#x27;B1&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>可以使用 <code>fillFormula</code> 方法将共享的公式分配到工作表中：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 将 A1 设置为起始编号</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-number">1</span>;<br><br><span class="hljs-comment">// 从 A1 开始以递增计数将 A2 填充到 A10</span><br>worksheet.<span class="hljs-title function_">fillFormula</span>(<span class="hljs-string">&#x27;A2:A10&#x27;</span>, <span class="hljs-string">&#x27;A1+1&#x27;</span>, [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>]);<br></code></pre></td></tr></table></figure>

<p><code>fillFormula</code> 也可以使用回调函数来计算每个单元格的值</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 从A1开始以递增计数将 A2 填充到 A100</span><br>worksheet.<span class="hljs-title function_">fillFormula</span>(<span class="hljs-string">&#x27;A2:A100&#x27;</span>, <span class="hljs-string">&#x27;A1+1&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">row, col</span>) =&gt;</span> row);<br></code></pre></td></tr></table></figure>

<h3 id="公式类型⬆"><a href="#公式类型⬆" class="headerlink" title="公式类型⬆"></a>公式类型<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>要区分真正的和转换后的公式单元格，请使用 FormulaType getter：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A3&#x27;</span>).<span class="hljs-property">formulaType</span> === <span class="hljs-title class_">Enums</span>.<span class="hljs-property">FormulaType</span>.<span class="hljs-property">Master</span>;<br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;B3&#x27;</span>).<span class="hljs-property">formulaType</span> === <span class="hljs-title class_">Enums</span>.<span class="hljs-property">FormulaType</span>.<span class="hljs-property">Shared</span>;<br></code></pre></td></tr></table></figure>

<p>公式类型具有以下值：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>值</th>
</tr>
</thead>
<tbody><tr>
<td>Enums.FormulaType.None</td>
<td>0</td>
</tr>
<tr>
<td>Enums.FormulaType.Master</td>
<td>1</td>
</tr>
<tr>
<td>Enums.FormulaType.Shared</td>
<td>2</td>
</tr>
</tbody></table>
<h3 id="数组公式⬆"><a href="#数组公式⬆" class="headerlink" title="数组公式⬆"></a>数组公式<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>在 Excel 中表示共享公式的一种新方法是数组公式。以这种形式，主单元格是唯一包含与公式有关的任何信息的单元格。它包含 shareType ‘array’ 以及适用于其的单元格范围以及将要复制的公式。其余单元格是具有常规值的常规单元格。</p>
<p>注意：数组公式不会以共享公式的方式转换。因此，如果主单元 A2 引用 A1，则从单元 B2 也将引用 A1。</p>
<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 将数组公式分配给 A2:B3</span><br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A2&#x27;</span>).<span class="hljs-property">value</span> = &#123;<br>  <span class="hljs-attr">formula</span>: <span class="hljs-string">&#x27;A1&#x27;</span>,<br>  <span class="hljs-attr">result</span>: <span class="hljs-number">10</span>,<br>  <span class="hljs-attr">shareType</span>: <span class="hljs-string">&#x27;array&#x27;</span>,<br>  <span class="hljs-attr">ref</span>: <span class="hljs-string">&#x27;A2:B3&#x27;</span>,<br>&#125;;<br><br><span class="hljs-comment">// 可能没有必要填写工作表中的其余值</span><br></code></pre></td></tr></table></figure>

<p><code>fillFormula</code> 方法也可以用于填充数组公式</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// 用数组公式 &quot;A1&quot; 填充 A2:B3</span><br>worksheet.<span class="hljs-title function_">fillFormula</span>(<span class="hljs-string">&#x27;A2:B3&#x27;</span>, <span class="hljs-string">&#x27;A1&#x27;</span>, [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>], <span class="hljs-string">&#x27;array&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h2 id="富文本值⬆"><a href="#富文本值⬆" class="headerlink" title="富文本值⬆"></a>富文本值<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>Enum: <code>Excel.ValueType.RichText</code></p>
<p>样式丰富的文本。</p>
<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = &#123;<br>  <span class="hljs-attr">richText</span>: [&#123; <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;This is &#x27;</span> &#125;, &#123; <span class="hljs-attr">font</span>: &#123; <span class="hljs-attr">italic</span>: <span class="hljs-literal">true</span> &#125;, <span class="hljs-attr">text</span>: <span class="hljs-string">&#x27;italic&#x27;</span> &#125;],<br>&#125;;<br></code></pre></td></tr></table></figure>

<h2 id="布尔值⬆"><a href="#布尔值⬆" class="headerlink" title="布尔值⬆"></a>布尔值<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>Enum: <code>Excel.ValueType.Boolean</code></p>
<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-literal">true</span>;<br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A2&#x27;</span>).<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;<br></code></pre></td></tr></table></figure>

<h2 id="错误值⬆"><a href="#错误值⬆" class="headerlink" title="错误值⬆"></a>错误值<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>Enum: <code>Excel.ValueType.Error</code></p>
<p>例如：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript">worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A1&#x27;</span>).<span class="hljs-property">value</span> = &#123; <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;#N/A&#x27;</span> &#125;;<br>worksheet.<span class="hljs-title function_">getCell</span>(<span class="hljs-string">&#x27;A2&#x27;</span>).<span class="hljs-property">value</span> = &#123; <span class="hljs-attr">error</span>: <span class="hljs-string">&#x27;#VALUE!&#x27;</span> &#125;;<br></code></pre></td></tr></table></figure>

<p>当前有效的错误文本值为：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>值</th>
</tr>
</thead>
<tbody><tr>
<td>Excel.ErrorValue.NotApplicable</td>
<td>#N/A</td>
</tr>
<tr>
<td>Excel.ErrorValue.Ref</td>
<td>#REF!</td>
</tr>
<tr>
<td>Excel.ErrorValue.Name</td>
<td>#NAME?</td>
</tr>
<tr>
<td>Excel.ErrorValue.DivZero</td>
<td>#DIV/0!</td>
</tr>
<tr>
<td>Excel.ErrorValue.Null</td>
<td>#NULL!</td>
</tr>
<tr>
<td>Excel.ErrorValue.Value</td>
<td>#VALUE!</td>
</tr>
<tr>
<td>Excel.ErrorValue.Num</td>
<td>#NUM!</td>
</tr>
</tbody></table>
<h1 id="接口变化⬆"><a href="#接口变化⬆" class="headerlink" title="接口变化⬆"></a>接口变化<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h1><p>我们会尽一切努力创建一个良好的，一致的接口，该接口不会在版本之间不兼容，但令人遗憾的是，为了实现更大的利益，有时需要进行一些更改。</p>
<h2 id="0-1-0⬆"><a href="#0-1-0⬆" class="headerlink" title="0.1.0⬆"></a>0.1.0<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><h3 id="Worksheet-eachRow⬆"><a href="#Worksheet-eachRow⬆" class="headerlink" title="Worksheet.eachRow⬆"></a>Worksheet.eachRow<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>在 <code>Worksheet.eachRow</code> 的回调函数中的参数已被交换和更改；它是 <code>function(rowNumber，rowValues)</code>，现在是 <code>function(row，rowNumber)</code>，使它的外观更像 <em>underscore(<code>_.each</code>)方法，并且行对象优先于行号。</em></p>
<h3 id="Worksheet-getRow⬆"><a href="#Worksheet-getRow⬆" class="headerlink" title="Worksheet.getRow⬆"></a>Worksheet.getRow<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p>此函数已从返回稀疏的单元格数组更改为返回 <code>Row</code> 对象。这样可以访问行属性，并有助于管理行样式等。</p>
<p>仍可通过 <code>Worksheet.getRow(rowNumber).values;</code> 获得稀疏的单元格值的数组。</p>
<h2 id="0-1-1⬆"><a href="#0-1-1⬆" class="headerlink" title="0.1.1⬆"></a>0.1.1<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><h3 id="cell-model⬆"><a href="#cell-model⬆" class="headerlink" title="cell.model⬆"></a>cell.model<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h3><p><code>cell.styles</code> 重命名为 <code>cell.style</code></p>
<h2 id="0-2-44⬆"><a href="#0-2-44⬆" class="headerlink" title="0.2.44⬆"></a>0.2.44<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>从 Bluebird 切换到 Node 原生 Promise 的函数返回的 Promise 如果依赖 Bluebird 的额外功能，则可能会破坏调用代码。</p>
<p>为了减少这种情况的出现，在 0.3.0 中添加了以下两个更改：</p>
<ul>
<li>默认情况下使用功能更全且仍与浏览器兼容的 promise lib。 该库支持 Bluebird 的许多功能，但占用空间少得多。</li>
<li>注入其他 Promise 实现的选项。有关更多详细信息，请参见<a href="#配置">配置</a>部分。</li>
</ul>
<h1 id="配置⬆"><a href="#配置⬆" class="headerlink" title="配置⬆"></a>配置<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h1><p>ExcelJS 现在支持对 Promise 库的依赖项注入。您可以通过在模块中包含以下代码来还原 Bluebird Promise。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">ExcelJS</span>.<span class="hljs-property">config</span>.<span class="hljs-title function_">setValue</span>(<span class="hljs-string">&#x27;promise&#x27;</span>, <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;bluebird&#x27;</span>));<br></code></pre></td></tr></table></figure>

<p>请注意：我已经使用 bluebird 专门测试了 ExcelJS（直到最近，这是它使用的库）。根据我所做的测试，它不适用于 Q。</p>
<h1 id="注意事项⬆"><a href="#注意事项⬆" class="headerlink" title="注意事项⬆"></a>注意事项<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h1><h2 id="Dist-文件夹⬆"><a href="#Dist-文件夹⬆" class="headerlink" title="Dist 文件夹⬆"></a>Dist 文件夹<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>在发布此模块之前，先对源代码进行编译和其他处理，然后再将它们放置在 <em>dist/</em> 文件夹中。该自述文件标识两个文件-浏览器捆绑和压缩版本。除了在 package.json 中指定为 <code>&quot;main&quot;</code> 的文件外，不能保证 <em>dist/</em> 文件夹的其他内容。</p>
<h1 id="已知的问题⬆"><a href="#已知的问题⬆" class="headerlink" title="已知的问题⬆"></a>已知的问题<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h1><h2 id="使用-Puppeteer-进行测试⬆"><a href="#使用-Puppeteer-进行测试⬆" class="headerlink" title="使用 Puppeteer 进行测试⬆"></a>使用 Puppeteer 进行测试<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>该 lib 中包含的测试套件包括一个在无头浏览器中执行的小脚本，以验证捆绑的软件包。 在撰写本文时，其表现出该测试在 Windows Linux 子系统中不能很好地进行。</p>
<p>因此，可以通过存在名为 <em>.disable-test-browser</em> 的文件来禁用浏览器测试。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt-get install libfontconfig<br></code></pre></td></tr></table></figure>

<h2 id="拼接与合并⬆"><a href="#拼接与合并⬆" class="headerlink" title="拼接与合并⬆"></a>拼接与合并<a href="#%E7%9B%AE%E5%BD%95">⬆</a><!-- Link generated with jump2header --></h2><p>如果任何 <code>splice</code> 操作影响合并的单元格，则合并组将无法正确移动</p>

    

    

    
    <div class="declare"> 
      <ul class="post-copyright">
        <li>
          <strong>本文作者：</strong>
          luckyship
        </li>
        <li>
          <strong>本文链接：</strong>
          <a href="https://luckyship.github.io/2023/07/02/2023-07-02-node-excel/" title="nodejs操作excel文件" target="_blank">https://luckyship.github.io/2023/07/02/2023-07-02-node-excel/</a>
        </li>
        
        <li>
          <strong>版权声明： </strong>
          
          本博客所有文章除特别声明外，均采用 <a href="https://github.com/JoeyBling/hexo-theme-yilia-plus/blob/master/LICENSE" rel="external nofollow" target="_blank">MIT</a> 许可协议。转载请注明出处！
        </li>
        
      </ul>
    </div>
    

  </div>
  <div class="article-info article-info-index">
    
    
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color1">javascript</a>
        		</li>
      		
		</ul>
	</div>

    

    

    
    
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <!-- <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a> -->
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
     <!-- <img src="//pan.baidu.com/share/qrcode?url=https://luckyship.github.io/2023/07/02/2023-07-02-node-excel/" alt="微信分享二维码"> -->
    </div>
</div>

<div class="mask js-mask"></div>

    
    <div class="clearfix"></div>
  </div>
  </div>
</article>


<nav id="article-nav">
  
    <a href="/2023/09/23/2023-09-23-flutter-source-pub/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          flutter安装包切换国内源
        
      </div>
    </a>
  
  
    <a href="/2023/06/14/2023-06-14-github-gitee-blog/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">github、gitee自动部署hexo博客</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>


<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>







  <section id="comments" style="margin:10px;padding:10px;background:#fff;">
    <div id="vcomment" class="comment"></div>
<!-- <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script> -->
<script src="/js/valine.js" async></script>
<script async>
  var notify = 'true' == true ? true : false;
  var verify = 'false' == true ? true : false;
  window.onload = function () {
    new Valine({
      el: '.comment',
      notify: notify,
      verify: verify,
      app_id: '3d3mgdb7guWJsXLE6mWY3Cyn-gzGzoHsz',
      app_key: 'fstd3ABXC89jc5VDSe6ANGV6',
      placeholder: 'Just go go',
      avatar: 'mm',
    });
  };
</script>

  </section>










          </div>
        </div>
      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2020-2025 <a href="https://luckyship.github.io/" target="_blank">luckyship</a>
    	</div>
      	<div class="footer-right">
			
			
      		GitHub:<a href="https://github.com/JoeyBling/hexo-theme-yilia-plus" target="_blank">hexo-theme-yilia-plus</a> by Litten
      	</div>
    </div>
  </div>

  
	<script async src="/lib/busuanzi.pure.js"></script>
	
  
  
	
	<span id="busuanzi_container_site_pv" style="display:none">
		本站总访问量<span id="busuanzi_value_site_pv"></span>次
	        <span class="post-meta-divider" >|</span>
	</span>
  	<span id="busuanzi_container_site_uv" style='display:none'>
  		本站访客数<span id="busuanzi_value_site_uv"></span>人
  	</span>
  
</footer>

    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: true
	}
</script>




<!--  -->

<script>
  /* 标签页标题切换 */
  var originTitle = document.title;
  var titleTime;
  document.addEventListener("visibilitychange", function () {
    if (document.hidden) {
      document.title = "(つェ⊂) 我藏好了哦~ " + originTitle;
      clearTimeout(titleTime);
    } else {
      document.title = "(*´∇｀*) 被你发现啦~ " + originTitle;
      titleTime = setTimeout(function () {
        document.title = originTitle;
      }, 2000);
    }
  });
</script>



    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 50%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">搜索</a></li>
      
        
      
      <li style="width: 50%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">mongo</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">ruby</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">dataTable</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">web</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">javascript</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">linux</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">network</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">base</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">rails</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">git</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">css</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">docker</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">kubernetes</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">centos</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">html</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">debian</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">ubuntu</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">nodejs</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">hexo</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">jquery</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">es6</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">npm</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">video</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">nginx</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">vue</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">+ vue</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">angular</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">sass</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">less</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">angualr</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">typescript</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">react</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">js</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">regexp</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">vscode</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">regex</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color2">review</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">tool</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">flutter</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">unicode</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color4">sql</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color1">postgresql</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">vite</a>
              </li>
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color3">go</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia-plus根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
            <a q-attr="href:path|urlformat">
              <p class="search-content" q-show="matchContent.val">
                <span q-text="matchContent.pre"></span><span class="red" q-text="matchContent.val"></span><span q-text="matchContent.next"></span>
              </p>
            </a>
          </li>
        </ul>
    	</section>
    

    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
        
          
  	  		<div class="aboutme-wrap" id="aboutme">前端攻城狮<br>记录分享自己工作、学习中学到的知识</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>

  
  
<script
  type="text/javascript"
  src="/plugins/activate-power-mode/activate-power-mode.js"
></script>
<script>
  document.addEventListener('DOMContentLoaded',function(){
    POWERMODE.colorful = true; // make power mode colorful
    POWERMODE.shake = false; // turn off shake
    document.body.addEventListener('input', POWERMODE);
  });
</script>


  
  <!-- <script async type="text/javascript" size="90" alpha="0.2" zIndex="0" src="/plugins/ribbon.js/ribbon.min.js"></script> -->
  
  
  
</body>

</html>
