[{"title":"go ç¯å¢ƒç®¡ç†","date":"2025-07-30T03:28:28.000Z","path":"2025/07/30/2025-07-30-go-env/","text":"Go æœ‰å¤šç§ç‰ˆæœ¬ç®¡ç†å·¥å…·å¯ä»¥å¸®åŠ©æ‚¨åœ¨ä¸åŒç‰ˆæœ¬ä¹‹é—´åˆ‡æ¢ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ Go ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼š 1. goenvgoenv æ˜¯ä¸€ä¸ªç±»ä¼¼äº rbenv çš„ Go ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åœ¨ä¸åŒ Go ç‰ˆæœ¬ä¹‹é—´åˆ‡æ¢ã€‚ å®‰è£…æ–¹å¼ï¼ˆåœ¨ Linux/macOS ä¸Šï¼‰ï¼š # å…‹éš† goenvgit clone https://github.com/syndbg/goenv.git ~/.goenv# æ·»åŠ åˆ° ~/.bashrc æˆ– ~/.zshrcecho &#x27;export GOENV_ROOT=&quot;$HOME/.goenv&quot;&#x27; &gt;&gt; ~/.bashrcecho &#x27;export PATH=&quot;$GOENV_ROOT/bin:$PATH&quot;&#x27; &gt;&gt; ~/.bashrcecho &#x27;eval &quot;$(goenv init -)&quot;&#x27; &gt;&gt; ~/.bashrc# é‡æ–°åŠ è½½é…ç½®source ~/.bashrc# å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ Gogoenv install 1.18.10goenv install 1.21.5# è®¾ç½®å…¨å±€ç‰ˆæœ¬goenv global 1.21.5# ä¸ºç‰¹å®šé¡¹ç›®è®¾ç½®ç‰ˆæœ¬cd /path/to/projectgoenv local 1.18.10 2. gvm (Go Version Manager)gvm æ˜¯å¦ä¸€ä¸ªæµè¡Œçš„ Go ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚ å®‰è£…æ–¹å¼ï¼š # å®‰è£… gvmbash &lt; &lt;(curl -s -S -L https://raw.githubusercontent.com/moovweb/gvm/master/binscripts/gvm-installer)# æ·»åŠ åˆ° shell é…ç½®echo &#x27;[[ -s &quot;$HOME/.gvm/scripts/gvm&quot; ]] &amp;&amp; source &quot;$HOME/.gvm/scripts/gvm&quot;&#x27; &gt;&gt; ~/.bashrc# é‡æ–°åŠ è½½é…ç½®source ~/.bashrc# å®‰è£…å’Œä½¿ç”¨ç‰¹å®šç‰ˆæœ¬gvm install go1.18.10gvm install go1.21.5gvm use go1.18.10 3. ä½¿ç”¨å®˜æ–¹æ–¹å¼ç®¡ç†å¤šä¸ª Go ç‰ˆæœ¬æ‚¨ä¹Ÿå¯ä»¥æ‰‹åŠ¨å®‰è£…å¤šä¸ªç‰ˆæœ¬çš„ Goï¼š # ä¸‹è½½å¹¶è§£å‹ä¸åŒç‰ˆæœ¬åˆ°ä¸åŒç›®å½•wget https://go.dev/dl/go1.18.10.linux-amd64.tar.gzwget https://go.dev/dl/go1.21.5.linux-amd64.tar.gzsudo tar -C /usr/local -xzf go1.18.10.linux-amd64.tar.gzsudo tar -C /usr/local -xzf go1.21.5.linux-amd64.tar.gz# åˆ›å»ºç¬¦å·é“¾æ¥æ¥åˆ‡æ¢ç‰ˆæœ¬sudo ln -s /usr/local/go1.18.10 /usr/local/go-currentexport PATH=&quot;/usr/local/go-current/bin:$PATH&quot;# æˆ–è€…ç›´æ¥ä½¿ç”¨å®Œæ•´è·¯å¾„/usr/local/go1.18.10/bin/go version/usr/local/go1.21.5/bin/go version 4. ä½¿ç”¨ Dockerå¦‚æœæ‚¨ä¸æƒ³åœ¨æœ¬åœ°å®‰è£…å¤šä¸ª Go ç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Docker å®¹å™¨æ¥è¿è¡Œä¸åŒç‰ˆæœ¬çš„ Goï¼š # ä½¿ç”¨ Go 1.18 è¿è¡Œé¡¹ç›®docker run -it -v $(pwd):/app -w /app golang:1.18 go run main.go# ä½¿ç”¨ Go 1.21 è¿è¡Œé¡¹ç›®docker run -it -v $(pwd):/app -w /app golang:1.21 go run main.go æ¨èæ–¹æ¡ˆæ¨èä½¿ç”¨ goenvï¼Œå› ä¸ºï¼š å®ƒç®€å•æ˜“ç”¨ï¼Œç±»ä¼¼äº Python çš„ pyenv å¯ä»¥è½»æ¾åœ°åœ¨é¡¹ç›®çº§åˆ«è®¾ç½®ç‰¹å®šçš„ Go ç‰ˆæœ¬ ä¸ä¼šå½±å“ç³»ç»Ÿå…¶ä»–éƒ¨åˆ† åœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»º .go-version æ–‡ä»¶å³å¯è‡ªåŠ¨åˆ‡æ¢ç‰ˆæœ¬","updated":"2025-08-02T05:46:04.182Z","tags":[{"name":"go","slug":"go","permalink":"https://luckyship.github.io/tags/go/"}]},{"title":"vite æ€§èƒ½ä¼˜åŒ–","date":"2025-07-28T23:19:29.000Z","path":"2025/07/29/2025-07-29-vite-optimize/","text":"Vite æœ¬èº«å› å…¶åŸç”Ÿ ESMã€åŸºäº esbuild çš„æé€Ÿæ„å»ºå’Œå¼€å‘æ€§èƒ½è€Œè¢«è§†ä¸ºæ€§èƒ½ä¼˜ç§€çš„æ„å»ºå·¥å…·ã€‚ä½†åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼ŒVite æ€§èƒ½ä¾ç„¶å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Œä¸»è¦å¯ä»¥ä» å¼€å‘æ—¶æ€§èƒ½ï¼ˆdev serverï¼‰ å’Œ æ„å»ºæ€§èƒ½ï¼ˆbuildï¼‰ ä¸¤å¤§æ–¹å‘å…¥æ‰‹ã€‚ ğŸ”§ ä¸€ã€å¼€å‘é˜¶æ®µæ€§èƒ½ä¼˜åŒ–ï¼ˆvite devï¼‰1. âœ… ä¼˜åŒ–ä¾èµ–é¢„æ„å»ºï¼ˆé¢„æ‰“åŒ…ï¼‰Vite ä¼šè‡ªåŠ¨é€šè¿‡ esbuild å¯¹ä¾èµ–è¿›è¡Œé¢„æ„å»ºï¼ˆé¢„æ‰“åŒ…ï¼‰ï¼ŒåŠ å¿«å†·å¯åŠ¨é€Ÿåº¦ã€‚ é…ç½®ä¼˜åŒ–ï¼š optimizeDeps: &#123; include: [&#x27;lodash-es&#x27;, &#x27;dayjs&#x27;], // æŒ‡å®šé¢„æ„å»ºä¾èµ–ï¼ˆé¿å…åŠ¨æ€å¯¼å…¥ä¸è¢«è¯†åˆ«ï¼‰ exclude: [&#x27;jspdf&#x27;], // æ’é™¤æŸäº›å¤§å‹åŒ…ï¼Œé¿å…æ‰“åŒ…è¿‡æ…¢ï¼Œè¯¥ç”¨cdnæ–¹å¼å¼•å…¥ã€ä¾‹å¦‚video.js ã€ jspdfç­‰&#125; 2. âœ… ç¦ç”¨ä¸å¿…è¦æ’ä»¶ / ä¸­é—´ä»¶ ä¸€äº›æ’ä»¶ï¼ˆå¦‚ legacyã€PWAã€è‡ªåŠ¨ç”Ÿæˆè·¯ç”±ï¼‰ä¼šå¯¼è‡´å¼€å‘æœåŠ¡å™¨å˜æ…¢ æ¨èï¼šä»…åœ¨ build ç¯å¢ƒä¸­ä½¿ç”¨æ’ä»¶ plugins: isBuild ? [legacy(), compress(), visualizer()] : [vue()]; legacy æ’ä»¶ï¼šç”¨äºå…¼å®¹æ—§ç‰ˆæµè§ˆå™¨ï¼Œå¦‚ IE11ã€‚ compress æ’ä»¶ï¼šç”¨äºå‹ç¼©èµ„æºæ–‡ä»¶ã€‚ visualizer æ’ä»¶ï¼šç”¨äºå¯è§†åŒ–æ‰“åŒ…åˆ†æã€‚ 3. âœ… å‡å°‘çƒ­æ›´æ–°å¼€é”€ï¼ˆHMRï¼‰ é¿å…å·¨å‹æ¨¡å—ï¼ˆå¦‚ store/index.tsï¼‰é¢‘ç¹è¢«ä¿®æ”¹ æ‹†åˆ†ä¸ºå°æ¨¡å—ï¼ŒæŒ‰éœ€ importï¼Œå¯æå‡ HMR é€Ÿåº¦ ä½¿ç”¨ defineOptions() / defineStore() æ›¿ä»£æ‰‹åŠ¨æ³¨å†Œæ¨¡å— 4. âœ… æå‡å†·å¯åŠ¨é€Ÿåº¦ å¼€å¯ç¼“å­˜ï¼ˆVite é»˜è®¤ç¼“å­˜åˆ° node_modules/.viteï¼‰ é¿å…é¡¹ç›®æ ¹ç›®å½•ä¸‹å­˜åœ¨å¤§é‡æ— å…³æ–‡ä»¶ï¼ˆå¦‚ .git, dist, temp, å¤§å›¾åƒç­‰ï¼‰ è®¾ç½® server.watch.ignored å¿½ç•¥ç›‘å¬æ— å…³è·¯å¾„ï¼š server: &#123; watch: &#123; ignored: [&#x27;**/dist/**&#x27;, &#x27;**/.git/**&#x27;], &#125;,&#125; ğŸ“¦ äºŒã€æ„å»ºé˜¶æ®µä¼˜åŒ–ï¼ˆvite buildï¼‰1. âœ… åˆç†ä½¿ç”¨ Rollup é€‰é¡¹build: &#123; rollupOptions: &#123; output: &#123; manualChunks(id) &#123; if (id.includes(&#x27;node_modules&#x27;)) &#123; return &#x27;vendor&#x27; // å°† node_modules å•ç‹¬æ‰“åŒ… &#125; &#125; &#125; &#125;&#125; 2. âœ… å¼€å¯æ„å»ºç¼“å­˜ æ„å»ºç¼“å­˜æ˜¯ Vite 4.x åæœŸå¼•å…¥çš„åŠŸèƒ½ï¼ˆé€šè¿‡ plugin æˆ–è‡ªå»ºç¼“å­˜å±‚ï¼‰ å¯é…åˆ turbo, nx, vite-plugin-cache å®ç°å¢é‡æ„å»º 3. âœ… å¼€å¯ CSS ä»£ç åˆ†ç¦» + å‹ç¼©build: &#123; cssCodeSplit: true, minify: &#x27;esbuild&#x27;, // æˆ– &#x27;terser&#x27;ï¼Œä½† esbuild æ›´å¿«&#125; 4. âœ… å‹ç¼©ä½“ç§¯ + å¯è§†åŒ–åˆ†ææ’ä»¶æ¨èï¼š rollup-plugin-visualizer â€”â€” æ‰“åŒ…åˆ†æå›¾ vite-plugin-compression â€”â€” å¼€å¯ gzip/br [vite-plugin-image-optimizer] â€”â€” å›¾åƒå‹ç¼© ğŸŒ ä¸‰ã€ç½‘ç»œä¼˜åŒ–ï¼ˆé€‚ç”¨äºéƒ¨ç½²åï¼‰âœ… é…åˆä½¿ç”¨ï¼š HTTP/2 CDN é™æ€èµ„æºç¼“å­˜ SSR with streaming (å¦‚ Vue SSRã€React Server Component) ä½¿ç”¨ vite-ssg è¿›è¡Œé¢„æ¸²æŸ“ï¼ˆé™æ€åŒ–ï¼‰ ğŸ§© æ’ä»¶è¾…åŠ©ä¼˜åŒ–ï¼ˆæ¨èï¼‰ æ’ä»¶ ç”¨é€” vite-plugin-imp æŒ‰éœ€å¼•å…¥ç»„ä»¶åº“ï¼ˆå¦‚ antdï¼‰ vite-plugin-compression Gzip/Brotli å‹ç¼© vite-plugin-inspect æ’ä»¶æ‰§è¡Œé“¾è°ƒè¯•å·¥å…· vite-plugin-cache ç¼“å­˜æ„å»ºæ–‡ä»¶ï¼ŒåŠ é€Ÿæ„å»º rollup-plugin-visualizer æ‰“åŒ…ä½“ç§¯åˆ†æ ğŸ¯ å®æˆ˜æ¨èï¼šæ€§èƒ½ä¼˜åŒ– Checklist é˜¶æ®µ ä¼˜åŒ–é¡¹ å»ºè®® å¼€å‘ ç¼“å­˜ node_modules/.vite âœ… å¼€å¯å¢é‡é¢„æ„å»º å¼€å‘ HMR å˜æ…¢ âœ… æ‹†åˆ†æ¨¡å—ï¼Œé¿å…å·¨å‹æ–‡ä»¶ æ„å»º æ„å»ºæ…¢ âœ… ä½¿ç”¨ manualChunks, å¼€å¯ç¼“å­˜ æ„å»º åŒ…å¤§ âœ… åŠ¨æ€å¯¼å…¥ï¼Œgzip å‹ç¼©ï¼ŒTree Shaking æ„å»º ç¼–è¯‘æ…¢ âœ… ä½¿ç”¨ esbuild æ›¿ä»£ babel / terser æ„å»º ä¾èµ–å¤§ âœ… æ›¿æ¢å¤§å‹åº“ï¼Œå¦‚ moment â†’ dayjs","updated":"2025-08-02T05:46:04.182Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"vue","slug":"vue","permalink":"https://luckyship.github.io/tags/vue/"},{"name":"vite","slug":"vite","permalink":"https://luckyship.github.io/tags/vite/"}]},{"title":"Babel AST é­”æ³•ï¼šVite æ’ä»¶å¦‚ä½•è®©ä½ çš„ try...catch ä¸å†â€œè£¸å¥”â€ï¼Ÿ","date":"2025-07-27T07:56:54.000Z","path":"2025/07/27/2025-07-27-vite-plugin/","text":"æ’ä»¶çš„â€œåˆå¿ƒâ€ï¼šä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿåœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œtry...catch å—æ˜¯å¤„ç†å¼‚å¸¸çš„åˆ©å™¨ã€‚ä½†å¾ˆå¤šæ—¶å€™ï¼Œå¼€å‘è€…å¯èƒ½ä¼šå†™å‡ºè¿™æ ·çš„ä»£ç ï¼š try &#123; // å¯èƒ½ä¼šå‡ºé”™çš„ä»£ç  throw new Error(&quot;Something went wrong&quot;);&#125; catch (e) &#123; // æ•è·äº†é”™è¯¯ï¼Œä½†å¯èƒ½æ²¡æœ‰å¤„ç†ï¼Œæˆ–è€…å¤„ç†ä¸å½“&#125; æˆ–è€…æ›´â€œå·æ‡’â€çš„ï¼š try &#123; // å¯èƒ½ä¼šå‡ºé”™çš„ä»£ç  throw new Error(&quot;Something went wrong&quot;);&#125; catch &#123;&#125; // æ•è·äº†ï¼Œä½†å•¥ä¹Ÿæ²¡å¹² è¿™æ ·ä¸€æ¥ï¼Œé”™è¯¯è™½ç„¶è¢«æ•è·äº†ï¼Œä½†å¹¶æ²¡æœ‰è¢«æœ‰æ•ˆåœ°è®°å½•ä¸‹æ¥ï¼ˆæ¯”å¦‚ console.errorï¼‰ï¼Œå¯¼è‡´é—®é¢˜éš¾ä»¥è¿½è¸ªã€‚è¿™ä¸ªæ’ä»¶çš„â€œåˆå¿ƒâ€å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼šè‡ªåŠ¨åœ¨æ‰€æœ‰ try...catch å—çš„ catch éƒ¨åˆ†æ³¨å…¥ console.error(error)ï¼Œç¡®ä¿æ¯ä¸€ä¸ªè¢«æ•è·çš„é”™è¯¯éƒ½èƒ½è¢«æ‰“å°å‡ºæ¥ã€‚ æ ¸å¿ƒæ€è·¯ï¼šAST è½¬æ¢è¦å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œæˆ‘ä»¬ä¸èƒ½ç®€å•åœ°åšå­—ç¬¦ä¸²æ›¿æ¢ï¼Œå› ä¸ºä»£ç ç»“æ„å¤æ‚ï¼Œå®¹æ˜“å‡ºé”™ã€‚æœ€å¯é çš„æ–¹æ³•æ˜¯è¿›è¡Œ æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰è½¬æ¢ã€‚ç®€å•æ¥è¯´ï¼Œå°±æ˜¯æŠŠä»£ç è§£ææˆä¸€æ£µæ ‘å½¢ç»“æ„ï¼Œç„¶ååœ¨è¿™æ£µæ ‘ä¸Šæ‰¾åˆ° catch èŠ‚ç‚¹ï¼Œä¿®æ”¹å®ƒï¼Œæœ€åå†æŠŠä¿®æ”¹åçš„æ ‘é‡æ–°ç”Ÿæˆä¸ºä»£ç ã€‚ è¿™é‡Œç”¨åˆ°çš„ä¸»è¦å·¥å…·æ˜¯ Babelï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼ºå¤§çš„ JavaScript ç¼–è¯‘å™¨ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å®Œæˆ AST çš„è§£æã€éå†å’Œç”Ÿæˆã€‚ æ’ä»¶å®ç°æ­¥éª¤è¯¦è§£ Vite æ’ä»¶çš„éª¨æ¶ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª Vite æ’ä»¶ã€‚Vite æ’ä»¶é€šå¸¸æ˜¯ä¸€ä¸ªè¿”å› Plugin å¯¹è±¡çš„å‡½æ•°ï¼Œå…¶ä¸­æœ€æ ¸å¿ƒçš„æ˜¯ transform é’©å­ã€‚transform é’©å­ä¼šåœ¨æ¯ä¸ªæ¨¡å—è¢« Vite å¤„ç†æ—¶è°ƒç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œæ‹¿åˆ°åŸå§‹ä»£ç  code å’Œæ¨¡å— ID idã€‚ import &#123; Plugin &#125; from &quot;vite&quot;;// ... å…¶ä»–å¯¼å…¥const vitePluginTryCatchConsole = (): Plugin =&gt; &#123; return &#123; name: &quot;vite-plugin-try-catch-console&quot;, enforce: &quot;post&quot;, // ç¡®ä¿åœ¨å…¶ä»–è½¬æ¢ä¹‹åæ‰§è¡Œ async transform(code, id) &#123; // 1. è¿‡æ»¤æ–‡ä»¶ç±»å‹ï¼Œåªå¤„ç† JS/TS/JSX/TSX/Vue æ–‡ä»¶ï¼Œå¹¶è·³è¿‡ node_modules if (!/\\.(js|ts|jsx|tsx|vue)$/.test(id) || id.includes(&quot;node_modules&quot;)) &#123; return null; // ä¸å¤„ç†è¿™äº›æ–‡ä»¶ &#125; // 2. è§£æä»£ç ç”Ÿæˆ AST const ast = parse(code, &#123; /* ...é…ç½® */ &#125;); if (!ast) return null; let transformed = false; // æ ‡è®°æ˜¯å¦è¿›è¡Œäº†è½¬æ¢ // 3. éå† ASTï¼Œæ‰¾åˆ° CatchClause èŠ‚ç‚¹å¹¶ä¿®æ”¹ traverse(ast, &#123; CatchClause(path) &#123; // ... æ ¸å¿ƒé€»è¾‘ transformed = true; &#125;, &#125;); // 4. å¦‚æœæœ‰ä¿®æ”¹ï¼Œé‡æ–°ç”Ÿæˆä»£ç å’Œ Source Map if (transformed) &#123; const output = generate(ast, &#123; sourceMaps: true, sourceFileName: id &#125;, code); return &#123; code: output.code, map: output.map &#125;; &#125; return null; // æ²¡æœ‰ä¿®æ”¹åˆ™è¿”å› null &#125;, &#125;;&#125;;export default vitePluginTryCatchConsole; Babel çš„å¼•å…¥ä¸é…ç½® @babel/coreï¼šç”¨äºè§£æä»£ç  (parse)ã€‚ @babel/traverseï¼šç”¨äºéå† AST (traverse)ã€‚ @babel/generatorï¼šç”¨äºå°† AST é‡æ–°ç”Ÿæˆä»£ç  (generate)ã€‚ @babel/typesï¼šæä¾›äº†åˆ›å»º AST èŠ‚ç‚¹çš„æ–¹æ³• (t)ã€‚ åœ¨ parse ä»£ç æ—¶ï¼Œéœ€è¦æ ¹æ®æ–‡ä»¶ç±»å‹é…ç½® Babel æ’ä»¶ï¼Œä¾‹å¦‚ï¼š import * as babel from &quot;@babel/core&quot;;import &#123; parse &#125; from &quot;@babel/core&quot;;import _traverse from &quot;@babel/traverse&quot;;const traverse = typeof _traverse === &quot;function&quot; ? _traverse : (_traverse as any).default; // å…¼å®¹ä¸åŒå¯¼å…¥æ–¹å¼import &#123; generate &#125; from &quot;@babel/generator&quot;; // æ³¨æ„è¿™é‡Œæ˜¯å‘½åå¯¼å…¥import * as t from &quot;@babel/types&quot;;// ...const ast = parse(code, &#123; sourceType: &quot;module&quot;, filename: id, plugins: [ &quot;@babel/plugin-transform-typescript&quot;, // å¤„ç† TypeScript &quot;@vue/babel-plugin-jsx&quot;, // å¤„ç† Vue ä¸­çš„ JSXï¼Œè¿™æ˜¯ä¸ªå‘ç‚¹ï¼ ],&#125;); è¸©å‘ç‚¹ 1ï¼šgenerate çš„å¯¼å…¥æ–¹å¼ ä¸€å¼€å§‹æˆ‘å¯èƒ½å†™æˆäº† import * as generate from &#39;@babel/generator&#39;;ï¼Œå¯¼è‡´ generate is not a functionã€‚è¿™æ˜¯å› ä¸º @babel/generator çš„ generate å‡½æ•°æ˜¯ä½œä¸ºå‘½åå¯¼å‡ºï¼ˆnamed exportï¼‰çš„ï¼Œè€Œä¸æ˜¯é»˜è®¤å¯¼å‡ºï¼ˆdefault exportï¼‰æˆ–æ•´ä¸ªæ¨¡å—çš„å‘½åç©ºé—´ã€‚æ­£ç¡®çš„å¯¼å…¥æ–¹å¼åº”è¯¥æ˜¯ import &#123; generate &#125; from &#39;@babel/generator&#39;;ã€‚ è¸©å‘ç‚¹ 2ï¼šJSX æ’ä»¶çš„é€‰æ‹© åœ¨å¤„ç† Vue æ–‡ä»¶æ—¶ï¼Œå¦‚æœä»£ç ä¸­åŒ…å« JSX è¯­æ³•ï¼ˆæ¯”å¦‚ render å‡½æ•°é‡Œå†™ JSXï¼‰ï¼Œéœ€è¦æ­£ç¡®çš„ Babel JSX æ’ä»¶ã€‚ä¸€å¼€å§‹æˆ‘å¯èƒ½ç”¨äº† @babel/plugin-transform-react-jsxï¼Œè¿™æ˜¯ React ä¸“ç”¨çš„ã€‚åœ¨ Vue é¡¹ç›®ä¸­ï¼Œåº”è¯¥ä½¿ç”¨ @vue/babel-plugin-jsxï¼Œå¦åˆ™ä¼šå¯¼è‡´ JSX è¯­æ³•è§£æå¤±è´¥ï¼Œè¿›è€Œå¼•å‘åç»­çš„é”™è¯¯ã€‚ æ ¸å¿ƒé€»è¾‘ï¼šCatchClause èŠ‚ç‚¹çš„å¤„ç† è¿™æ˜¯æ’ä»¶çš„â€œå¿ƒè„â€éƒ¨åˆ†ã€‚æˆ‘ä»¬é€šè¿‡ traverse æ‰¾åˆ°æ‰€æœ‰çš„ CatchClause èŠ‚ç‚¹ï¼ˆå³ catch (error) &#123; ... &#125; ä¸­çš„ catch éƒ¨åˆ†ï¼‰ã€‚ traverse(ast, &#123; CatchClause(path: babel.NodePath&lt;t.CatchClause&gt;) &#123; const block = path.node.body; // è·å– catch å—çš„å‡½æ•°ä½“ // æ£€æŸ¥ catch å—ä¸­æ˜¯å¦å·²ç»æœ‰ console.error(error) äº† const hasConsoleError = block.body.some((statement: t.Statement) =&gt; &#123; return ( t.isExpressionStatement(statement) &amp;&amp; t.isCallExpression(statement.expression) &amp;&amp; t.isMemberExpression(statement.expression.callee) &amp;&amp; t.isIdentifier(statement.expression.callee.object, &#123; name: &quot;console&quot; &#125;) &amp;&amp; t.isIdentifier(statement.expression.callee.property, &#123; name: &quot;error&quot; &#125;) ); &#125;); if (!hasConsoleError) &#123; // è¸©å‘ç‚¹ 3ï¼šå¤„ç†ç©ºçš„ catch å—å’Œé”™è¯¯å‚æ•° // å¦‚æœ catch å—æ²¡æœ‰å‚æ•° (catch &#123;&#125;)ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç»™å®ƒæ·»åŠ ä¸€ä¸ªå‚æ•° if (!path.node.param) &#123; path.node.param = t.identifier(&quot;error&quot;); // æ·»åŠ ä¸€ä¸ªåä¸º &#x27;error&#x27; çš„æ ‡è¯†ç¬¦ä½œä¸ºå‚æ•° &#125; const errorArg = path.node.param as t.Identifier; // è·å– catch å—çš„é”™è¯¯å‚æ•° // åˆ›å»º console.error(errorArg) è¯­å¥ const consoleErrorStatement = t.expressionStatement( t.callExpression( t.memberExpression(t.identifier(&quot;console&quot;), t.identifier(&quot;error&quot;)), // console.error [errorArg] // ä¼ å…¥é”™è¯¯å‚æ•° ) ); // å°†æ–°è¯­å¥æ’å…¥åˆ° catch å—çš„æœ€å‰é¢ block.body.unshift(consoleErrorStatement); transformed = true; &#125; &#125;,&#125;); è¸©å‘ç‚¹ 3ï¼šReferenceError: e is not defined æˆ– error is not defined è¿™ä¸ªé—®é¢˜æ˜¯æœ€â€œç£¨äººâ€çš„ã€‚å½“é‡åˆ° try &#123; ... &#125; catch &#123;&#125; è¿™ç§æ²¡æœ‰æ˜¾å¼é”™è¯¯å‚æ•°çš„ catch å—æ—¶ï¼Œpath.node.param æ˜¯ nullã€‚å¦‚æœç›´æ¥å°è¯•ä½¿ç”¨ path.node.param ä½œä¸º console.error çš„å‚æ•°ï¼Œå°±ä¼šå¯¼è‡´ ReferenceErrorã€‚è§£å†³æ–¹æ¡ˆæ˜¯ï¼šåœ¨ path.node.param ä¸ºç©ºæ—¶ï¼Œæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ª t.identifier(&#39;error&#39;) å¹¶èµ‹å€¼ç»™ path.node.paramï¼Œè¿™æ · catch å—å°±ä¼šå˜æˆ catch (error) &#123;&#125;ï¼Œç„¶åæˆ‘ä»¬å†ä½¿ç”¨è¿™ä¸ª error æ ‡è¯†ç¬¦æ¥æ„å»º console.error(error) è¯­å¥ã€‚ æ’ä»¶æ‰€éœ€ä¾èµ–è¦è®©è¿™ä¸ª vite-plugin-try-catch-console æ’ä»¶æ­£å¸¸å·¥ä½œï¼Œä½ éœ€è¦å®‰è£…ä»¥ä¸‹ Babel ç›¸å…³çš„æ ¸å¿ƒä¾èµ–ï¼š npm install --save-dev @babel/core @babel/traverse @babel/generator @babel/types @babel/plugin-transform-typescript @vue/babel-plugin-jsx# æˆ–è€…ä½¿ç”¨ yarnyarn add --dev @babel/core @babel/traverse @babel/generator @babel/types @babel/plugin-transform-typescript @vue/babel-plugin-jsx# æˆ–è€…ä½¿ç”¨ pnpmpnpm add --save-dev @babel/core @babel/traverse @babel/generator @babel/types @babel/plugin-transform-typescript @vue/babel-plugin-jsx è¿™äº›åŒ…çš„ä½œç”¨åˆ†åˆ«æ˜¯ï¼š @babel/core: Babel çš„æ ¸å¿ƒåº“ï¼Œç”¨äºè§£æå’Œè½¬æ¢ä»£ç ã€‚ @babel/traverse: ç”¨äºéå† ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼‰ã€‚ @babel/generator: ç”¨äºå°† AST é‡æ–°ç”Ÿæˆä¸ºä»£ç ã€‚ @babel/types: æä¾›äº†ç”¨äºåˆ›å»ºã€éªŒè¯å’Œè½¬æ¢ AST èŠ‚ç‚¹çš„å·¥å…·å‡½æ•°ã€‚ @babel/plugin-transform-typescript: Babel æ’ä»¶ï¼Œç”¨äºå¤„ç† TypeScript è¯­æ³•ã€‚ @vue/babel-plugin-jsx: Babel æ’ä»¶ï¼Œç”¨äºå¤„ç† Vue é¡¹ç›®ä¸­çš„ JSX è¯­æ³•ã€‚ å®Œæ•´çš„ vite-plugin-try-catch-console.ts æ–‡ä»¶å†…å®¹ç»è¿‡æˆ‘ä»¬ä¹‹å‰çš„â€œæ‰“ç£¨â€ï¼Œæœ€ç»ˆçš„æ’ä»¶ä»£ç å¦‚ä¸‹ï¼š import &#123; Plugin &#125; from &quot;vite&quot;;import * as babel from &quot;@babel/core&quot;;import &#123; parse &#125; from &quot;@babel/core&quot;;import _traverse from &quot;@babel/traverse&quot;;const traverse = typeof _traverse === &quot;function&quot; ? _traverse : (_traverse as any).default;import &#123; generate &#125; from &quot;@babel/generator&quot;;import * as t from &quot;@babel/types&quot;;const vitePluginTryCatchConsole = (): Plugin =&gt; &#123; return &#123; name: &quot;vite-plugin-try-catch-console&quot;, enforce: &quot;post&quot;, // ç¡®ä¿åœ¨å…¶ä»–è½¬æ¢ä¹‹åæ‰§è¡Œ async transform(code, id) &#123; // 1. è¿‡æ»¤æ–‡ä»¶ç±»å‹ï¼Œåªå¤„ç† JS/TS/JSX/TSX/Vue æ–‡ä»¶ï¼Œå¹¶è·³è¿‡ node_modules if (!/\\.(js|ts|jsx|tsx|vue)$/.test(id) || id.includes(&quot;node_modules&quot;)) &#123; return null; // ä¸å¤„ç†è¿™äº›æ–‡ä»¶ &#125; // 2. è§£æä»£ç ç”Ÿæˆ AST const ast = parse(code, &#123; sourceType: &quot;module&quot;, filename: id, plugins: [ &quot;@babel/plugin-transform-typescript&quot;, // å¤„ç† TypeScript &quot;@vue/babel-plugin-jsx&quot;, // å¤„ç† Vue ä¸­çš„ JSX ], &#125;); if (!ast) &#123; return null; &#125; let transformed = false; // æ ‡è®°æ˜¯å¦è¿›è¡Œäº†è½¬æ¢ // 3. éå† ASTï¼Œæ‰¾åˆ° CatchClause èŠ‚ç‚¹å¹¶ä¿®æ”¹ traverse(ast, &#123; CatchClause(path: babel.NodePath&lt;t.CatchClause&gt;) &#123; const block = path.node.body; // è·å– catch å—çš„å‡½æ•°ä½“ // æ£€æŸ¥ catch å—ä¸­æ˜¯å¦å·²ç»æœ‰ console.error(error) äº† const hasConsoleError = block.body.some((statement: t.Statement) =&gt; &#123; return ( t.isExpressionStatement(statement) &amp;&amp; t.isCallExpression(statement.expression) &amp;&amp; t.isMemberExpression(statement.expression.callee) &amp;&amp; t.isIdentifier(statement.expression.callee.object, &#123; name: &quot;console&quot; &#125;) &amp;&amp; t.isIdentifier(statement.expression.callee.property, &#123; name: &quot;error&quot; &#125;) ); &#125;); if (!hasConsoleError) &#123; // å¦‚æœ catch å—æ²¡æœ‰å‚æ•° (catch &#123;&#125;)ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç»™å®ƒæ·»åŠ ä¸€ä¸ªå‚æ•° if (!path.node.param) &#123; path.node.param = t.identifier(&quot;error&quot;); // æ·»åŠ ä¸€ä¸ªåä¸º &#x27;error&#x27; çš„æ ‡è¯†ç¬¦ä½œä¸ºå‚æ•° &#125; const errorArg = path.node.param as t.Identifier; // è·å– catch å—çš„é”™è¯¯å‚æ•° // åˆ›å»º console.error(errorArg) è¯­å¥ const consoleErrorStatement = t.expressionStatement( t.callExpression( t.memberExpression(t.identifier(&quot;console&quot;), t.identifier(&quot;error&quot;)), // console.error [errorArg] // ä¼ å…¥é”™è¯¯å‚æ•° ) ); // å°†æ–°è¯­å¥æ’å…¥åˆ° catch å—çš„æœ€å‰é¢ block.body.unshift(consoleErrorStatement); transformed = true; &#125; &#125;, &#125;); // 4. å¦‚æœæœ‰ä¿®æ”¹ï¼Œé‡æ–°ç”Ÿæˆä»£ç å’Œ Source Map if (transformed) &#123; const output = generate(ast, &#123; sourceMaps: true, sourceFileName: id &#125;, code); return &#123; code: output.code, map: output.map &#125;; &#125; return null; // æ²¡æœ‰ä¿®æ”¹åˆ™è¿”å› null &#125;, &#125;;&#125;;export default vitePluginTryCatchConsole; å¦‚ä½•åœ¨ Vite é¡¹ç›®ä¸­å¼•å…¥æ’ä»¶ å°†æ’ä»¶æ–‡ä»¶æ”¾ç½®åˆ°é¡¹ç›®æ ¹ç›®å½• å°†ä¸Šè¿°ä»£ç ä¿å­˜ä¸º æ–‡ä»¶ï¼Œå¹¶æ”¾ç½®åœ¨ä½ çš„ Vite é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼ˆä¸ vite.config.ts åŒçº§ï¼‰ã€‚ ä¿®æ”¹ vite.config.ts æ–‡ä»¶ æ‰“å¼€ä½ é¡¹ç›®ä¸­çš„æ–‡ä»¶ï¼Œç„¶åæŒ‰ç…§ä»¥ä¸‹æ–¹å¼å¼•å…¥å¹¶ä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼š import &#123; defineConfig &#125; from &quot;vite&quot;;import vue from &quot;@vitejs/plugin-vue&quot;;import vitePluginTryCatchConsole from &quot;./vite-plugin-try-catch-console&quot;; // å¼•å…¥ä½ çš„æ’ä»¶// https://vitejs.dev/config/export default defineConfig(&#123; plugins: [ vue(), vitePluginTryCatchConsole(), // åœ¨è¿™é‡Œæ·»åŠ ä½ çš„æ’ä»¶ ],&#125;); æ³¨æ„ï¼š æ’ä»¶çš„å¼•å…¥è·¯å¾„ ./vite-plugin-try-catch-console æ˜¯ç›¸å¯¹äº vite.config.ts æ–‡ä»¶çš„ã€‚ç¡®ä¿è·¯å¾„æ­£ç¡®ã€‚ è¿è¡Œé¡¹ç›® ä¿å­˜æ‰€æœ‰ä¿®æ”¹åï¼Œé‡æ–°è¿è¡Œä½ çš„ Vite é¡¹ç›®ï¼š npm run dev ç°åœ¨ï¼Œä½ çš„ try...catch å—å°±ä¼šè¢«è¿™ä¸ªâ€œå°½èŒå°½è´£â€çš„æ’ä»¶è‡ªåŠ¨æ³¨å…¥ console.error è¯­å¥äº†ï¼ä½ å¯ä»¥å°è¯•åœ¨ src/App.vue ä¸­æ·»åŠ ä¸€ä¸ª try &#123; throw new Error(&#39;test error&#39;); &#125; catch &#123;&#125; è¿™æ ·çš„ä»£ç ï¼Œç„¶åæ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼Œçœ‹çœ‹æ˜¯å¦èƒ½çœ‹åˆ°é”™è¯¯ä¿¡æ¯è¢«æ‰“å°å‡ºæ¥ã€‚ å¸Œæœ›è¿™ä»½è¯¦ç»†çš„â€œä½¿ç”¨è¯´æ˜ä¹¦â€èƒ½å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£å’Œä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼ æ€»ç»“è¿™ä¸ª vite-plugin-try-catch-console æ’ä»¶çš„å®ç°ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åˆ©ç”¨ Babel å¯¹ JavaScript ä»£ç è¿›è¡Œ AST çº§åˆ«çš„é™æ€åˆ†æå’Œè½¬æ¢ã€‚é€šè¿‡ç²¾ç¡®åœ°å®šä½ CatchClause èŠ‚ç‚¹ï¼Œå¹¶æ ¹æ®éœ€è¦æ³¨å…¥ console.error è¯­å¥ï¼Œæˆ‘ä»¬å®ç°äº†åœ¨ç¼–è¯‘æ—¶è‡ªåŠ¨å¢å¼ºä»£ç çš„é”™è¯¯æ—¥å¿—åŠŸèƒ½ã€‚","updated":"2025-08-02T05:46:04.182Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"vue","slug":"vue","permalink":"https://luckyship.github.io/tags/vue/"},{"name":"vite","slug":"vite","permalink":"https://luckyship.github.io/tags/vite/"}]},{"title":"angular æœ€æ–°çŠ¶æ€å˜æ›´æ£€æµ‹ signal","date":"2025-07-12T09:00:40.000Z","path":"2025/07/12/2025-07-12-angular-signal/","text":"åœ¨ Angular v16 åŠä»¥åçš„ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨ Signal å¹¶éå¼ºåˆ¶è¦æ±‚ï¼Œä¼ ç»Ÿçš„å˜æ›´æ£€æµ‹æœºåˆ¶ä»ç„¶å®Œå…¨æœ‰æ•ˆã€‚Signal æ˜¯ä¸€ç§å¯é€‰çš„å¢å¼ºåŠŸèƒ½ï¼Œç”¨äºä¼˜åŒ–æ€§èƒ½å’Œç®€åŒ–çŠ¶æ€ç®¡ç†ï¼Œä½† Angular çš„æ ¸å¿ƒå˜æ›´æ£€æµ‹ç³»ç»Ÿï¼ˆåŸºäº Zone.js å’Œè„æ£€æŸ¥ï¼‰å¹¶æœªæ”¹å˜ã€‚ ä¸€ã€ä¼ ç»Ÿå˜æ›´æ£€æµ‹ä»ç„¶æœ‰æ•ˆå¦‚æœä½ ç»§ç»­ä½¿ç”¨ä»¥ä¸‹æ–¹å¼å®šä¹‰ç»„ä»¶çŠ¶æ€ï¼Œå˜æ›´æ£€æµ‹ä»ä¼šæ­£å¸¸å·¥ä½œï¼š @Input/@Output è£…é¥°å™¨ @Component(&#123; template: ` &lt;p&gt;&#123;&#123; message &#125;&#125;&lt;/p&gt; &lt;button (click)=&quot;updateMessage()&quot;&gt;Update&lt;/button&gt; `,&#125;)export class MyComponent &#123; message = &quot;Initial value&quot;; updateMessage() &#123; this.message = &quot;Updated value&quot;; // ä¼ ç»Ÿæ–¹å¼æ›´æ–°ï¼Œå˜æ›´æ£€æµ‹ä¼šæ•è· &#125;&#125; RxJS Observable + async ç®¡é“ @Component(&#123; template: ` &lt;p&gt;&#123;&#123; data$ | async &#125;&#125;&lt;/p&gt; &lt;!-- ä»ç„¶éœ€è¦asyncç®¡é“ --&gt; `,&#125;)export class MyComponent &#123; data$ = this.http.get(&quot;/api/data&quot;); // ä¼ ç»ŸObservableæ–¹å¼&#125; ChangeDetectionStrategy.OnPushæ‰‹åŠ¨æ§åˆ¶å˜æ›´æ£€æµ‹çš„ç­–ç•¥ä»ç„¶æœ‰æ•ˆï¼š @Component(&#123; changeDetection: ChangeDetectionStrategy.OnPush,&#125;)export class MyComponent &#123; @Input() data: any; @Output() updated = new EventEmitter();&#125; äºŒã€Signal ä¸ä¼ ç»Ÿæ–¹å¼çš„å¯¹æ¯” ç‰¹æ€§ ä¼ ç»Ÿæ–¹å¼ Signal æ–¹å¼ è§¦å‘å˜æ›´æ£€æµ‹çš„æ–¹å¼ äº‹ä»¶ã€å®šæ—¶å™¨ã€HTTP è¯·æ±‚ç­‰ï¼ˆZone.js æ•è·ï¼‰ ç›´æ¥è°ƒç”¨ Signal çš„ set/update æ–¹æ³• ä¾èµ–è¿½è¸ª å…¨ç»„ä»¶æ ‘æ£€æµ‹ï¼ˆæˆ– OnPush é™å®šï¼‰ è‡ªåŠ¨è¿½è¸ªä¾èµ–ï¼Œä»…æ›´æ–°ç›¸å…³éƒ¨åˆ† æ¨¡æ¿è¯­æ³• éœ€è¦ async ç®¡é“å¤„ç† Observable ç›´æ¥è°ƒç”¨ Signal()å³å¯ çŠ¶æ€ç®¡ç†å¤æ‚åº¦ æ‰‹åŠ¨ç®¡ç†è®¢é˜…ã€ä¸å¯å˜æ›´æ–° è‡ªåŠ¨å¤„ç†ï¼Œå‡å°‘æ ·æ¿ä»£ç  ä¸‰ã€ä½•æ—¶åº”è¯¥ä½¿ç”¨ Signalï¼Ÿ æ€§èƒ½æ•æ„Ÿçš„åœºæ™¯ä¾‹å¦‚å¤§å‹åˆ—è¡¨æˆ–é¢‘ç¹æ›´æ–°çš„ UI ç»„ä»¶ï¼ŒSignal å¯ä»¥é¿å…ä¸å¿…è¦çš„å˜æ›´æ£€æµ‹ï¼š @Component(&#123; template: ` &lt;ul&gt; @for (item of items(); track item.id) &#123; &lt;li&gt;&#123;&#123; item.name &#125;&#125;&lt;/li&gt; &#125; &lt;/ul&gt; `,&#125;)export class MyListComponent &#123; items = signal&lt;Item[]&gt;([]); updateItems() &#123; this.items.update((old) =&gt; [...old, newItem]); &#125;&#125; ç®€åŒ–çŠ¶æ€ç®¡ç†æ›¿ä»£å¤æ‚çš„ RxJS æµï¼Œä½¿ä»£ç æ›´æ˜“è¯»ï¼š // ä¼ ç»Ÿæ–¹å¼this.data$.pipe(map((x) =&gt; x * 2)).subscribe((result) =&gt; (this.value = result));// Signalæ–¹å¼const source = signal(1);const result = computed(() =&gt; source() * 2); // è‡ªåŠ¨è®¡ç®—ï¼Œæ— éœ€è®¢é˜… è·¨ç»„ä»¶çŠ¶æ€å…±äº«åœ¨æœåŠ¡ä¸­å®šä¹‰ Signalï¼Œå¤šä¸ªç»„ä»¶å¯ç›´æ¥ä½¿ç”¨ï¼š @Injectable(&#123; providedIn: &quot;root&quot; &#125;)export class AuthService &#123; isLoggedIn = signal(false); login() &#123; this.isLoggedIn.set(true); &#125;&#125; å››ã€Signal ä¸å˜æ›´æ£€æµ‹çš„äº¤äº’ Signal è§¦å‘å˜æ›´æ£€æµ‹å½“ Signal çš„å€¼å˜åŒ–æ—¶ï¼ŒAngular ä¼šè§¦å‘å˜æ›´æ£€æµ‹ï¼Œä½†ä»…é’ˆå¯¹ä¾èµ–è¯¥ Signal çš„ç»„ä»¶ï¼š const count = signal(0);@Component(&#123; template: `&#123;&#123; count() &#125;&#125;`,&#125;)export class CounterComponent &#123; count = inject(MyService).count; // ä»…è¯¥ç»„ä»¶ä¼šåœ¨countå˜åŒ–æ—¶æ›´æ–°&#125; ä¸ OnPush ç­–ç•¥ç»“åˆSignal å¯ä»¥ä¸ChangeDetectionStrategy.OnPushé…åˆä½¿ç”¨ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–æ€§èƒ½ï¼š @Component(&#123; changeDetection: ChangeDetectionStrategy.OnPush, template: `&#123;&#123; user().name &#125;&#125;`,&#125;)export class UserComponent &#123; @Input(&#123; transform: signal &#125;) user: Signal&lt;User&gt;;&#125; äº”ã€æ¸è¿›å¼é‡‡ç”¨ Signalä½ å¯ä»¥åœ¨ç°æœ‰é¡¹ç›®ä¸­é€æ­¥å¼•å…¥ Signalï¼Œè€Œä¸å¿…é‡æ„æ•´ä¸ªåº”ç”¨ï¼š åœ¨æ–°ç»„ä»¶ä¸­ä¼˜å…ˆä½¿ç”¨ Signalã€‚ ä½¿ç”¨toSignal()å°†ç°æœ‰çš„ Observable è½¬æ¢ä¸º Signalï¼š // ç°æœ‰æœåŠ¡export class DataService &#123; getData() &#123; return this.http.get(&quot;/api/data&quot;); &#125;&#125;// åœ¨ç»„ä»¶ä¸­è½¬æ¢ä¸ºSignalexport class MyComponent &#123; data = toSignal(this.dataService.getData(), &#123; initialValue: null &#125;);&#125; å¯¹äºå¤æ‚çŠ¶æ€ç®¡ç†ï¼Œå¯å°† Signal ä¸ NgRx ç­‰çŠ¶æ€ç®¡ç†åº“ç»“åˆä½¿ç”¨ã€‚ æ€»ç»“ ä¼ ç»Ÿå˜æ›´æ£€æµ‹ä»ç„¶æœ‰æ•ˆï¼šAngular ä¸ä¼šå¼ºåˆ¶ä½ ä½¿ç”¨ Signalï¼Œä»¥å‰çš„å˜é‡å®šä¹‰å’Œæ›´æ–°æ–¹å¼ç»§ç»­æ­£å¸¸å·¥ä½œã€‚ Signal æ˜¯å¢å¼ºè€Œéæ›¿ä»£ï¼šå®ƒæä¾›äº†æ›´é«˜æ•ˆçš„çŠ¶æ€ç®¡ç†æ–¹å¼ï¼Œå°¤å…¶é€‚åˆæ€§èƒ½æ•æ„Ÿæˆ–å¤æ‚çš„åœºæ™¯ã€‚ æ¸è¿›å¼è¿ç§»ï¼šå¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚é€æ­¥å¼•å…¥ Signalï¼Œæ— éœ€ä¸€æ¬¡æ€§é‡æ„æ•´ä¸ªåº”ç”¨ã€‚ Signal ä»£è¡¨äº† Angular çŠ¶æ€ç®¡ç†çš„æœªæ¥æ–¹å‘ï¼Œä½† Angular å›¢é˜Ÿä¸€ç›´è‡´åŠ›äºä¿æŒå‘åå…¼å®¹æ€§ï¼Œç¡®ä¿å¼€å‘è€…å¯ä»¥æŒ‰ç…§è‡ªå·±çš„èŠ‚å¥é‡‡ç”¨æ–°ç‰¹æ€§ã€‚","updated":"2025-08-02T05:46:04.182Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"angular","slug":"angular","permalink":"https://luckyship.github.io/tags/angular/"}]},{"title":"æ·±å…¥ç†è§£ React çš„ Fiber æ¶æ„","date":"2025-07-06T11:19:15.000Z","path":"2025/07/06/2025-07-06-react-fiber-node/","text":"ä¼ ç»Ÿ React æ¶æ„çš„å±€é™æ€§React æœ€åˆçš„æ¶æ„åœ¨å¤„ç† UI æ›´æ–°æ—¶é‡‡ç”¨äº†åŒæ­¥çš„ã€é˜»å¡çš„æ–¹å¼ã€‚å³ä¸€æ¬¡æ›´æ–°ä¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹é€’å½’éå†æ•´æ£µç»„ä»¶æ ‘ï¼Œç›´è‡³å®Œæˆæ‰€æœ‰ç»„ä»¶çš„æ¸²æŸ“ã€‚è¿™ç§æ–¹å¼åœ¨å¤„ç†ç®€å•çš„ UI æ—¶è¡¨ç°è‰¯å¥½ï¼Œä½†éšç€åº”ç”¨çš„å¤æ‚æ€§å¢åŠ ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡èŠ‚ç‚¹æ›´æ–°æˆ–é¢‘ç¹ç”¨æˆ·äº¤äº’æ—¶ï¼Œä¼ ç»Ÿæ¶æ„æš´éœ²å‡ºäº†ä»¥ä¸‹å‡ ä¸ªä¸»è¦å±€é™æ€§ï¼š å•æ¬¡æ¸²æŸ“æ—¶é—´è¿‡é•¿ï¼šå½“ç»„ä»¶æ ‘è¾ƒå¤§æ—¶ï¼Œä¸€æ¬¡å®Œæ•´çš„æ¸²æŸ“æ›´æ–°å¯èƒ½ä¼šå ç”¨å¤§é‡çš„æ—¶é—´ï¼Œè¿™ä¼šå¯¼è‡´ä¸»çº¿ç¨‹è¢«é˜»å¡ï¼Œæ— æ³•å“åº”ç”¨æˆ·çš„è¾“å…¥ï¼Œè¿›è€Œå½±å“ç”¨æˆ·ä½“éªŒã€‚ ç¼ºä¹ä¼˜å…ˆçº§ç®¡ç†ï¼šä¼ ç»Ÿæ¶æ„æ— æ³•æ ¹æ®ä»»åŠ¡çš„é‡è¦æ€§åˆ†é…ä¼˜å…ˆçº§ï¼Œæ‰€æœ‰æ›´æ–°ä¸€è§†åŒä»ï¼Œè¿™æ„å‘³ç€å…³é”®ä»»åŠ¡ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥å¤„ç†ï¼‰å¯èƒ½ä¼šè¢«ä¸é‡è¦çš„ä»»åŠ¡ï¼ˆå¦‚ä½ä¼˜å…ˆçº§çš„åŠ¨ç”»æˆ–æ—¥å¿—æ›´æ–°ï¼‰é˜»å¡ã€‚ ä¸­æ–­å’Œæ¢å¤å›°éš¾ï¼šåœ¨ä¼ ç»Ÿæ¶æ„ä¸­ï¼Œä¸€æ—¦å¼€å§‹æ¸²æŸ“æ›´æ–°ï¼Œå°±æ— æ³•ä¸­é€”ä¸­æ–­å¹¶æ¢å¤ï¼Œè¿™ä½¿å¾—åœ¨å¤„ç†é«˜ä¼˜å…ˆçº§ä»»åŠ¡æ—¶éå¸¸ä¸çµæ´»ã€‚ ä¸ºä»€ä¹ˆéœ€è¦ Fiberï¼Ÿä¸ºäº†å…‹æœä¼ ç»Ÿ React æ¶æ„çš„å±€é™æ€§ï¼ŒReact å›¢é˜Ÿæå‡ºäº† Fiber æ¶æ„ã€‚Fiber æ˜¯ React çš„ä¸€ç§æ–°çš„åè°ƒå¼•æ“ï¼Œå®ƒé€šè¿‡å°†æ›´æ–°è¿‡ç¨‹æ‹†åˆ†ä¸ºå¤šä¸ªå°ä»»åŠ¡æ¥è§£å†³æ€§èƒ½ç“¶é¢ˆå’Œç”¨æˆ·ä½“éªŒé—®é¢˜ã€‚ æ€§èƒ½ç“¶é¢ˆ å¢é‡æ¸²æŸ“ï¼šFiber å°†æ¸²æŸ“è¿‡ç¨‹åˆ†æˆå¤šä¸ªå¯ä»¥ä¸­æ–­çš„å°ä»»åŠ¡ï¼Œè¿™æ ·å³ä½¿ç»„ä»¶æ ‘éå¸¸åºå¤§ï¼Œæ¯ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ä¹Ÿä¼šè¾ƒçŸ­ï¼Œé¿å…äº†é•¿æ—¶é—´çš„é˜»å¡ã€‚ ä»»åŠ¡åˆ†ç‰‡ï¼šé€šè¿‡ä»»åŠ¡åˆ†ç‰‡ï¼ˆTime Slicingï¼‰æŠ€æœ¯ï¼ŒFiber å¯ä»¥åœ¨ç©ºé—²æ—¶é—´ç‰‡æ®µå†…æ‰§è¡Œæ¸²æŸ“ä»»åŠ¡ï¼Œä»è€Œæœ€å¤§é™åº¦åœ°åˆ©ç”¨æµè§ˆå™¨çš„ç©ºé—²æ—¶é—´ï¼Œæå‡æ•´ä½“æ€§èƒ½ã€‚ ç”¨æˆ·ä½“éªŒé—®é¢˜ å“åº”æ€§æå‡ï¼šé€šè¿‡å°†ä»»åŠ¡æ‹†åˆ†å¹¶åˆ†é…ä¼˜å…ˆçº§ï¼ŒFiber å¯ä»¥ç¡®ä¿é«˜ä¼˜å…ˆçº§çš„ç”¨æˆ·äº¤äº’ä»»åŠ¡èƒ½å¤Ÿå°½å¿«å¾—åˆ°å¤„ç†ï¼Œè€Œä¸ä¼šè¢«ä½ä¼˜å…ˆçº§ä»»åŠ¡é˜»å¡ã€‚ å¹³æ»‘çš„ç”¨æˆ·ä½“éªŒï¼šç”±äºæ¸²æŸ“è¿‡ç¨‹å¯ä»¥ä¸­æ–­å¹¶æ¢å¤ï¼ŒFiber å¯ä»¥æ›´çµæ´»åœ°å¤„ç†åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœï¼Œæä¾›æ›´åŠ å¹³æ»‘çš„ç”¨æˆ·ä½“éªŒã€‚ Fiber çš„ç›®æ ‡React å›¢é˜Ÿè®¾è®¡ Fiber æ¶æ„çš„ä¸»è¦ç›®æ ‡æ˜¯ï¼š æå‡æ€§èƒ½ï¼šé€šè¿‡å¢é‡æ¸²æŸ“å’Œä»»åŠ¡åˆ†ç‰‡ç­‰æŠ€æœ¯ï¼Œæ˜¾è‘—é™ä½é•¿æ—¶é—´æ¸²æŸ“ä»»åŠ¡å¯¹ç”¨æˆ·ä½“éªŒçš„å½±å“ã€‚ çµæ´»æ€§å’Œæ‰©å±•æ€§ï¼šFiber æ¶æ„ä¸ºæœªæ¥çš„æ–°ç‰¹æ€§å’Œä¼˜åŒ–å¥ å®šäº†åŸºç¡€ï¼Œä¾‹å¦‚ Concurrent Mode å’Œ Suspenseï¼Œè¿™äº›ç‰¹æ€§èƒ½å¤Ÿè¿›ä¸€æ­¥æå‡ React åº”ç”¨çš„æ€§èƒ½å’Œå¼€å‘ä½“éªŒã€‚ å¯ç»´æŠ¤æ€§å’Œå¯è°ƒè¯•æ€§ï¼šæ–°çš„æ¶æ„ä¸ä»…æå‡äº†æ€§èƒ½ï¼Œè¿˜æ”¹è¿›äº† React å†…éƒ¨çš„ä»£ç ç»“æ„ï¼Œä½¿å¾—è°ƒè¯•å’Œç»´æŠ¤æ›´åŠ å®¹æ˜“ã€‚ é€šè¿‡å¼•å…¥ Fiber æ¶æ„ï¼ŒReact åœ¨å¤„ç†å¤æ‚å’Œé«˜é¢‘æ›´æ–°åœºæ™¯ä¸‹çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒæ–¹é¢å–å¾—äº†æ˜¾è‘—è¿›æ­¥ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ Fiber çš„åŸºæœ¬æ¦‚å¿µå’Œå·¥ä½œåŸç†ã€‚ Fiber æ¶æ„çš„åŸºæœ¬æ¦‚å¿µä»€ä¹ˆæ˜¯ Fiberï¼Ÿåœ¨ React ä¸­ï¼ŒFiber æ˜¯ä¸€ç§ç”¨äºæè¿°ç»„ä»¶æ ‘çš„æ•°æ®ç»“æ„ï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªå¯ä¸­æ–­çš„ã€å¯æ¢å¤çš„æ¸²æŸ“ä»»åŠ¡ã€‚ä¼ ç»Ÿçš„æ¸²æŸ“è¿‡ç¨‹æ˜¯é€’å½’å¼çš„ï¼Œä¸€æ—¦å¼€å§‹æ¸²æŸ“ï¼Œå°±æ— æ³•ä¸­æ–­ï¼Œç›´åˆ°æ¸²æŸ“å®Œæˆæˆ–å‘ç”Ÿé”™è¯¯ã€‚è€Œ Fiber æ¶æ„å°†æ¸²æŸ“è¿‡ç¨‹åˆ†è§£æˆå¤šä¸ªå°ä»»åŠ¡ï¼Œä½¿å¾—åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­å¯ä»¥ä¸­æ–­ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦é‡æ–°è°ƒåº¦ä»»åŠ¡ã€‚Fiber çš„å¼•å…¥ä½¿å¾— React åº”ç”¨èƒ½å¤Ÿæ›´å¥½åœ°åˆ©ç”¨æµè§ˆå™¨çš„ç©ºé—²æ—¶é—´ï¼Œæå‡æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚ Fiber æ˜¯ä¸€ç§æ•°æ®ç»“æ„&#123; stateNode: new ClickCounter(), type: clickCounter, alternate: null, key: null, updateQueue: null, memoizedstate: &#123; count: 0 &#125;, pendingProps: &#123;&#125;, memoizedProps: &#123;&#125;, tag: 1, effectTag: 0, nextEffect: null,&#125;; Fiber èŠ‚ç‚¹æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ï¼Œç”¨äºæè¿°ç»„ä»¶æ ‘çš„ç»“æ„å’ŒçŠ¶æ€ã€‚æ¯ä¸ª Fiber èŠ‚ç‚¹åŒ…å«äº†ä¸ç»„ä»¶ç›¸å…³çš„ä¿¡æ¯ï¼Œå¦‚ç±»å‹ã€propsã€stateã€æ•ˆæœæ ‡è®°ï¼ˆeffect tagï¼‰ç­‰ã€‚Fiber èŠ‚ç‚¹è¿˜åŒ…å«äº†æŒ‡å‘å…¶å­èŠ‚ç‚¹ã€å…„å¼ŸèŠ‚ç‚¹å’Œçˆ¶èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œä»¥æ„å»ºç»„ä»¶æ ‘çš„å±‚çº§ç»“æ„ã€‚Fiber èŠ‚ç‚¹çš„æ•°æ®ç»“æ„è®¾è®¡ä½¿å¾— React èƒ½å¤Ÿæ›´é«˜æ•ˆåœ°ç®¡ç†ç»„ä»¶æ ‘çš„æ›´æ–°å’Œæ¸²æŸ“è¿‡ç¨‹ã€‚ Fiber æ ‘Fiber æ ‘çš„åˆ›å»ºè¿‡ç¨‹Fiber æ ‘çš„åˆ›å»ºè¿‡ç¨‹ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š æ ¹æ® JSX æ„å»ºè™šæ‹Ÿ DOM æ ‘ï¼šReact ä¼šæ ¹æ® JSX è¯­æ³•æ„å»ºè™šæ‹Ÿ DOM æ ‘ï¼Œè¡¨ç¤ºæ•´ä¸ªç»„ä»¶æ ‘çš„ç»“æ„ã€‚ ç”Ÿæˆ Fiber èŠ‚ç‚¹ï¼šå¯¹äºæ¯ä¸ªè™šæ‹Ÿ DOM èŠ‚ç‚¹ï¼ŒReact ä¼šç”Ÿæˆå¯¹åº”çš„ Fiber èŠ‚ç‚¹ï¼Œå¹¶å»ºç«‹èµ· Fiber æ ‘çš„å±‚çº§ç»“æ„ã€‚ æ‰§è¡Œåˆæ¬¡æ¸²æŸ“ï¼šReact ä¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹é€’å½’éå† Fiber æ ‘ï¼Œæ‰§è¡Œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’Œæ¸²æŸ“å‡½æ•°ï¼Œå°†ç»„ä»¶æ ‘æ¸²æŸ“åˆ° DOM ä¸­ã€‚ Fiber èŠ‚ç‚¹ä¹‹é—´é€šè¿‡ä¸åŒç±»å‹çš„æŒ‡é’ˆï¼ˆå¦‚ childã€siblingã€return ç­‰ï¼‰ç›¸äº’è¿æ¥ï¼Œæ„æˆäº† Fiber æ ‘ï¼Œè¡¨ç¤ºäº†ç»„ä»¶æ ‘çš„ç»“æ„ã€‚ åœ¨ Fiber æ¶æ„ä¸­ï¼ŒFiber æ ‘çš„æ„å»ºæ˜¯ä¸€ä¸ªå¢é‡çš„è¿‡ç¨‹ï¼Œå³æ¸²æŸ“è¿‡ç¨‹å¯ä»¥åœ¨ä»»æ„æ—¶åˆ»ä¸­æ–­ï¼Œå¹¶åœ¨ä¸‹ä¸€ä¸ªç©ºé—²æ—¶é—´ç‰‡æ®µå†…æ¢å¤ã€‚è¿™ç§è®¾è®¡ä½¿å¾— React èƒ½å¤Ÿæ›´çµæ´»åœ°å¤„ç†å¤§å‹ç»„ä»¶æ ‘çš„æ›´æ–°ï¼Œå¹¶ä¸”å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´æ›´æ–°çš„ä¼˜å…ˆçº§ã€‚ æ ‘çš„æ›´æ–°æ›´æ–°è¿‡ç¨‹æ˜¯æŒ‡åœ¨ç»„ä»¶çŠ¶æ€æˆ–å±æ€§å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒReact å¦‚ä½•æ›´æ–°ç»„ä»¶æ ‘ä»¥åæ˜ è¿™äº›å˜åŒ–ã€‚æ ‘çš„åè°ƒå’Œæ›´æ–°è¿‡ç¨‹ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š è§¦å‘æ›´æ–°ï¼šå½“ç»„ä»¶çš„çŠ¶æ€æˆ–å±æ€§å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒReact ä¼šè°ƒç”¨ç›¸åº”çš„æ›´æ–°å‡½æ•°ï¼Œæ ‡è®°ç»„ä»¶ä¸ºéœ€è¦æ›´æ–°çŠ¶æ€ã€‚ ç”Ÿæˆæ–°çš„è™šæ‹Ÿ DOM æ ‘ï¼šReact ä¼šæ ¹æ®æ–°çš„çŠ¶æ€æˆ–å±æ€§ç”Ÿæˆä¸€æ£µæ–°çš„è™šæ‹Ÿ DOM æ ‘ï¼Œè¡¨ç¤ºç»„ä»¶æ ‘çš„æ›´æ–°åçŠ¶æ€ã€‚ åè°ƒæ–°æ—§æ ‘ï¼šReact ä½¿ç”¨åè°ƒç®—æ³•æ¯”è¾ƒæ–°æ—§ä¸¤æ£µè™šæ‹Ÿ DOM æ ‘çš„å·®å¼‚ï¼Œæ‰¾å‡ºéœ€è¦æ›´æ–°çš„éƒ¨åˆ†ã€‚ æ‰§è¡Œæ›´æ–°ï¼šæ ¹æ®åè°ƒç®—æ³•çš„ç»“æœï¼ŒReact ä¼šæ›´æ–° Fiber æ ‘çš„ç›¸åº”èŠ‚ç‚¹ï¼Œæ‰§è¡Œç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’Œæ¸²æŸ“å‡½æ•°ï¼Œå°†æ›´æ–°åçš„ç»„ä»¶æ ‘æ¸²æŸ“åˆ° DOM ä¸­ã€‚ åè°ƒï¼ˆReconciliationï¼‰ åœ¨ React ä¸­ï¼Œåè°ƒæ˜¯æŒ‡ç¡®å®šç»„ä»¶æ ‘çš„æ›´æ–°æ–¹å¼ï¼Œå³å¦‚ä½•å°†æ–°çš„çŠ¶æ€æ˜ å°„åˆ° UI ä¸Šã€‚ä¼ ç»Ÿçš„åè°ƒç®—æ³•æ˜¯é€’å½’å¼çš„æ·±åº¦ä¼˜å…ˆéå†ï¼Œå³é€šè¿‡é€’å½’éå†è™šæ‹Ÿ DOM æ ‘æ¥æŸ¥æ‰¾éœ€è¦æ›´æ–°çš„èŠ‚ç‚¹ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„æ›´æ–°æ“ä½œã€‚ç„¶è€Œï¼Œè¿™ç§ç®—æ³•åœ¨å¤„ç†å¤§å‹ç»„ä»¶æ ‘æˆ–é«˜é¢‘æ›´æ–°æ—¶æ•ˆç‡è¾ƒä½ï¼Œå¯èƒ½å¯¼è‡´ç•Œé¢å¡é¡¿æˆ–å“åº”ç¼“æ…¢ã€‚ æ—§çš„åè°ƒç®—æ³•ä¼ ç»Ÿçš„åè°ƒç®—æ³•é‡‡ç”¨æ·±åº¦ä¼˜å…ˆéå†è™šæ‹Ÿ DOM æ ‘çš„æ–¹å¼æ¥è¿›è¡Œæ›´æ–°ã€‚è¿™ç§ç®—æ³•çš„é—®é¢˜åœ¨äºï¼Œä¸€æ—¦å¼€å§‹æ›´æ–°ï¼Œå°±æ— æ³•ä¸­æ–­ï¼Œç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½å®Œæˆæ›´æ–°æˆ–è€…å‘ç”Ÿé”™è¯¯ã€‚è¿™å¯¼è‡´åœ¨æ›´æ–°è¿‡ç¨‹ä¸­æ— æ³•å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œä»è€Œå½±å“äº†ç”¨æˆ·ä½“éªŒã€‚ æ–°çš„åè°ƒç®—æ³•ï¼šå¢é‡æ¸²æŸ“ä¸ºäº†è§£å†³ä¼ ç»Ÿåè°ƒç®—æ³•çš„å±€é™æ€§ï¼ŒReact å¼•å…¥äº†ä¸€ç§æ–°çš„åè°ƒç®—æ³•ï¼šå¢é‡æ¸²æŸ“ã€‚å¢é‡æ¸²æŸ“çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†åè°ƒè¿‡ç¨‹åˆ†è§£ä¸ºå¤šä¸ªå°ä»»åŠ¡ï¼Œå¹¶ä½¿ç”¨ä»»åŠ¡è°ƒåº¦å™¨ï¼ˆSchedulerï¼‰æ¥åŠ¨æ€åœ°è°ƒåº¦è¿™äº›ä»»åŠ¡ã€‚è¿™ç§æ–¹å¼ä½¿å¾—åœ¨æ›´æ–°è¿‡ç¨‹ä¸­å¯ä»¥ä¸­æ–­ï¼Œå¹¶åœ¨ä¸‹ä¸€ä¸ªç©ºé—²æ—¶é—´ç‰‡æ®µå†…æ¢å¤ï¼Œä»è€Œæé«˜äº†æ¸²æŸ“çš„çµæ´»æ€§å’Œæ•ˆç‡ã€‚ é€šè¿‡å¢é‡æ¸²æŸ“ï¼ŒReact èƒ½å¤Ÿæ›´å¥½åœ°åˆ©ç”¨æµè§ˆå™¨çš„ç©ºé—²æ—¶é—´ï¼Œæå‡ç•Œé¢çš„å“åº”é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒã€‚åŒæ—¶ï¼Œå¢é‡æ¸²æŸ“è¿˜ä¸º React å¼•å…¥äº†ä¸€äº›æ–°çš„ç‰¹æ€§ï¼Œå¦‚æ—¶é—´åˆ‡ç‰‡ï¼ˆTime Slicingï¼‰å’Œä»»åŠ¡ä¼˜å…ˆçº§è°ƒåº¦ï¼Œä½¿å¾— React åº”ç”¨èƒ½å¤Ÿæ›´å¥½åœ°é€‚åº”ä¸åŒçš„ç½‘ç»œç¯å¢ƒå’Œè®¾å¤‡æ€§èƒ½ã€‚ Fiber æ¶æ„çš„å·¥ä½œåŸç†åŒç¼“å­˜ä»€ä¹ˆæ˜¯åŒç¼“å­˜åœ¨ React ä¸­ï¼ŒåŒç¼“å­˜æ˜¯ä¸€ç§ç”¨äºè§£å†³ UI æ¸²æŸ“è¿‡ç¨‹ä¸­é—ªçƒå’Œè§†è§‰ä¸è¿ç»­çš„æŠ€æœ¯ã€‚ä¼ ç»Ÿçš„æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œæ›´æ–°æ“ä½œä¼šç›´æ¥ä¿®æ”¹ DOMï¼Œå¯¼è‡´åœ¨æ›´æ–°è¿‡ç¨‹ä¸­ç”¨æˆ·å¯èƒ½ä¼šçœ‹åˆ°ä¸­é—´çŠ¶æ€çš„ UIï¼Œé€ æˆè§†è§‰ä¸Šçš„ä¸è¿ç»­å’Œä¸ç¨³å®šã€‚åŒç¼“å­˜æŠ€æœ¯é€šè¿‡åœ¨å†…å­˜ä¸­ç»´æŠ¤ä¸¤ä»½ UI çŠ¶æ€ï¼Œä¸€ä»½ç”¨äºæ¸²æŸ“å½“å‰å¸§ï¼Œå¦ä¸€ä»½ç”¨äºè®¡ç®—ä¸‹ä¸€å¸§çš„çŠ¶æ€ï¼Œä»è€Œé¿å…äº†ç›´æ¥åœ¨ DOM ä¸Šè¿›è¡Œæ›´æ–°æ“ä½œã€‚ åŒç¼“å­˜ Fiber æ ‘åœ¨Reactä¸­æœ€å¤šä¼šåŒæ—¶å­˜åœ¨ä¸¤æ£µFiberæ ‘ã€‚å½“å‰å±å¹•ä¸Šæ˜¾ç¤ºå†…å®¹å¯¹åº”çš„Fiberæ ‘ç§°ä¸ºcurrent Fiberæ ‘ï¼Œæ­£åœ¨å†…å­˜ä¸­æ„å»ºçš„Fiberæ ‘ç§°ä¸ºworkInProgress Fiberæ ‘ã€‚ current Fiberæ ‘ä¸­çš„FiberèŠ‚ç‚¹è¢«ç§°ä¸ºcurrent fiberï¼ŒworkInProgress Fiberæ ‘ä¸­çš„FiberèŠ‚ç‚¹è¢«ç§°ä¸ºworkInProgress fiberï¼Œä»–ä»¬é€šè¿‡alternateå±æ€§è¿æ¥ã€‚ currentFiber.alternate === workInProgressFiber;workInProgressFiber.alternate === currentFiber; Reactåº”ç”¨çš„æ ¹èŠ‚ç‚¹é€šè¿‡ä½¿currentæŒ‡é’ˆåœ¨ä¸åŒFiberæ ‘çš„rootFiberé—´åˆ‡æ¢æ¥å®Œæˆcurrent Fiberæ ‘æŒ‡å‘çš„åˆ‡æ¢ã€‚ å³å½“workInProgress Fiberæ ‘æ„å»ºå®Œæˆäº¤ç»™Rendereræ¸²æŸ“åœ¨é¡µé¢ä¸Šåï¼Œåº”ç”¨æ ¹èŠ‚ç‚¹çš„currentæŒ‡é’ˆæŒ‡å‘workInProgress Fiberæ ‘ï¼Œæ­¤æ—¶workInProgress Fiberæ ‘å°±å˜ä¸ºcurrent Fiberæ ‘ã€‚ æ¯æ¬¡çŠ¶æ€æ›´æ–°éƒ½ä¼šäº§ç”Ÿæ–°çš„workInProgress Fiberæ ‘ï¼Œé€šè¿‡currentä¸workInProgressçš„æ›¿æ¢ï¼Œå®ŒæˆDOMæ›´æ–°ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬ä»¥å…·ä½“ä¾‹å­è®²è§£mountã€updateçš„æ„å»º/æ›¿æ¢æµç¨‹ã€‚ mount æ—¶function App() &#123; const [count, add] = useState(0); return &lt;div onClick=&#123;() =&gt; add(count + 1)&#125;&gt;&#123;count&#125;&lt;/div&gt;;&#125;ReactDOM.render(&lt;App /&gt;, document.getElementById(&quot;root&quot;)); é¦–æ¬¡åˆ›å»ºæ—¶ é¦–æ¬¡æ‰§è¡ŒReactDOM.renderä¼šåˆ›å»ºfiberRootNodeï¼ˆæºç ä¸­å«fiberRootï¼‰å’ŒrootFiberã€‚å…¶ä¸­fiberRootNodeæ˜¯æ•´ä¸ªåº”ç”¨çš„æ ¹èŠ‚ç‚¹ï¼ŒrootFiberæ˜¯&lt;App/&gt;æ‰€åœ¨ç»„ä»¶æ ‘çš„æ ¹èŠ‚ç‚¹ã€‚ ä¹‹æ‰€ä»¥è¦åŒºåˆ†fiberRootNodeä¸rootFiberï¼Œæ˜¯å› ä¸ºåœ¨åº”ç”¨ä¸­æˆ‘ä»¬å¯ä»¥å¤šæ¬¡è°ƒç”¨ReactDOM.renderæ¸²æŸ“ä¸åŒçš„ç»„ä»¶æ ‘ï¼Œä»–ä»¬ä¼šæ‹¥æœ‰ä¸åŒçš„rootFiberã€‚ä½†æ˜¯æ•´ä¸ªåº”ç”¨çš„æ ¹èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªï¼Œé‚£å°±æ˜¯fiberRootNodeã€‚ fiberRootNodeçš„currentä¼šæŒ‡å‘å½“å‰é¡µé¢ä¸Šå·²æ¸²æŸ“å†…å®¹å¯¹åº”Fiberæ ‘ï¼Œå³current Fiberæ ‘ã€‚ fiberRootNode.current = rootFiber; ç”±äºæ˜¯é¦–å±æ¸²æŸ“ï¼Œé¡µé¢ä¸­è¿˜æ²¡æœ‰æŒ‚è½½ä»»ä½•DOMï¼Œæ‰€ä»¥fiberRootNode.currentæŒ‡å‘çš„rootFiberæ²¡æœ‰ä»»ä½•å­FiberèŠ‚ç‚¹ï¼ˆå³current Fiberæ ‘ä¸ºç©ºï¼‰ã€‚ æ¸²æŸ“é˜¶æ®µ æ¥ä¸‹æ¥è¿›å…¥ render é˜¶æ®µï¼Œæ ¹æ®ç»„ä»¶è¿”å›çš„ JSX åœ¨å†…å­˜ä¸­ä¾æ¬¡åˆ›å»º Fiber èŠ‚ç‚¹å¹¶è¿æ¥åœ¨ä¸€èµ·æ„å»º Fiber æ ‘ï¼Œè¢«ç§°ä¸º workInProgress Fiber æ ‘ ã€‚ åœ¨æ„å»º workInProgress Fiber æ ‘æ—¶ä¼šå°è¯•å¤ç”¨ current Fiber æ ‘ä¸­å·²æœ‰çš„ Fiber èŠ‚ç‚¹å†…çš„å±æ€§ï¼Œåœ¨é¦–å±æ¸²æŸ“æ—¶åªæœ‰ rootFiber å­˜åœ¨å¯¹åº”çš„ current fiber (å³ rootFiber.alternate ) ã€‚ ä¸‹å›¾ä¸­å·¦ä¾§ä¸ºé¡µé¢æ˜¾ç¤ºçš„æ ‘ï¼Œå³ä¾§ä¸ºå†…å­˜ä¸­æ„å»ºçš„æ ‘ï¼š æäº¤é˜¶æ®µ å·²æ„å»ºå®Œçš„ workInProgress Fiber æ ‘ åœ¨ commit é˜¶æ®µ æ¸²æŸ“åˆ°é¡µé¢ã€‚ æ­¤æ—¶ DOM æ›´æ–°ä¸ºå³ä¾§æ ‘å¯¹åº”çš„æ ·å­ã€‚fiberRootNode çš„ current æŒ‡é’ˆæŒ‡å‘ workInProgress Fiber æ ‘ ä½¿å…¶å˜ä¸º current Fiber æ ‘ ã€‚ update æ—¶ ç‚¹å‡» div èŠ‚ç‚¹ï¼Œè§¦å‘çŠ¶æ€æ”¹å˜ æ¥ä¸‹æ¥æˆ‘ä»¬ç‚¹å‡» div èŠ‚ç‚¹è§¦å‘çŠ¶æ€æ”¹å˜ï¼Œè¿™ä¼šå¼€å¯ä¸€æ¬¡æ–°çš„ render é˜¶æ®µå¹¶æ„å»ºä¸€æ£µæ–°çš„ workInProgress Fiber æ ‘ã€‚ å’Œ mount æ—¶ä¸€æ ·ï¼ŒworkInProgress fiber çš„åˆ›å»ºå¯ä»¥å¤ç”¨ current Fiber æ ‘å¯¹åº”çš„èŠ‚ç‚¹æ•°æ®ã€‚ æ¸²æŸ“ä¹‹åï¼Œæäº¤ workInProgress Fiber æ ‘åœ¨ render é˜¶æ®µ å®Œæˆæ„å»ºåè¿›å…¥ commit é˜¶æ®µ æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚æ¸²æŸ“å®Œæ¯•åï¼ŒworkInProgress Fiber æ ‘å˜ä¸º current Fiber æ ‘ã€‚ åŒç¼“å­˜æŠ€æœ¯èƒ½å¤Ÿæœ‰æ•ˆåœ°è§£å†³ UI æ¸²æŸ“è¿‡ç¨‹ä¸­çš„é—ªçƒå’Œä¸è¿ç»­é—®é¢˜ï¼Œæå‡ç”¨æˆ·ä½“éªŒå’Œç•Œé¢ç¨³å®šæ€§ã€‚ æ—¶é—´åˆ‡ç‰‡ä»€ä¹ˆæ˜¯æ—¶é—´åˆ‡ç‰‡æ—¶é—´åˆ‡ç‰‡æ˜¯ä¸€ç§å°†ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ç‰‡æ®µï¼Œåœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´æ‰§è¡Œçš„æŠ€æœ¯ã€‚åœ¨ React ä¸­ï¼Œæ—¶é—´åˆ‡ç‰‡è¢«ç”¨äºå°†æ¸²æŸ“ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡ï¼Œå¹¶åœ¨å¤šä¸ªå¸§ä¹‹é—´åŠ¨æ€è°ƒåº¦æ‰§è¡Œï¼Œä»¥æé«˜é¡µé¢çš„å“åº”é€Ÿåº¦å’Œç”¨æˆ·ä½“éªŒã€‚ ä»»åŠ¡é˜Ÿåˆ—ï¼ˆTask Queueï¼‰: React å°†æ‰€æœ‰çš„æ›´æ–°æ“ä½œï¼ˆå¦‚çŠ¶æ€æ›´æ–°æˆ–å±æ€§æ›´æ”¹ï¼‰å°è£…æˆä»»åŠ¡ï¼Œå¹¶æ”¾å…¥ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚ æ‰§è¡Œä»»åŠ¡: React ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡å¹¶æ‰§è¡Œã€‚åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒReact ä¼šæ£€æŸ¥å½“å‰ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ã€‚ æ—¶é—´æ£€æŸ¥: å¦‚æœä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´è¶…è¿‡äº†ä¸€ä¸ªé¢„è®¾çš„é˜ˆå€¼ï¼ˆé»˜è®¤æ˜¯ 5 æ¯«ç§’ï¼‰ï¼ŒReact ä¼šä¸­æ–­å½“å‰ä»»åŠ¡çš„æ‰§è¡Œã€‚ è®©å‡ºçº¿ç¨‹: React ä½¿ç”¨ MessageChannel å’Œ postMessage API æ¥è®©å‡ºæ‰§è¡Œçº¿ç¨‹ã€‚è¿™æ„å‘³ç€æµè§ˆå™¨å¯ä»¥åœ¨æ­¤æ—¶å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œå¦‚ç”¨æˆ·è¾“å…¥æˆ–åŠ¨ç”»ã€‚ ç»§ç»­æ‰§è¡Œ: ä¸€æ—¦æµè§ˆå™¨å¤„ç†å®Œå…¶ä»–ä»»åŠ¡ï¼Œå®ƒå°†é€šè¿‡ onmessage äº‹ä»¶æ¥ç»§ç»­æ‰§è¡Œä¹‹å‰ä¸­æ–­çš„ä»»åŠ¡ã€‚ å¾ªç¯æ‰§è¡Œ: è¿™ä¸ªè¿‡ç¨‹ä¼šä¸€ç›´é‡å¤ï¼Œç›´åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡éƒ½è¢«æ‰§è¡Œå®Œæ¯•ã€‚ ä¼˜å…ˆçº§è°ƒåº¦ä¸åŒä¼˜å…ˆçº§çš„ä»»åŠ¡// æ— ä¼˜å…ˆçº§ä»»åŠ¡export const NoPriority = 0;// ç«‹å³æ‰§è¡Œä»»åŠ¡export const ImmediatePriority = 1;// ç”¨æˆ·é˜»å¡ä»»åŠ¡export const UserBlockingPriority = 2;// æ­£å¸¸ä»»åŠ¡export const NormalPriority = 3;// ä½ä¼˜å…ˆçº§ä»»åŠ¡export const LowPriority = 4;// ç©ºé—²æ‰§è¡Œä»»åŠ¡export const IdlePriority = 5; åœ¨ React ä¸­ï¼Œä»»åŠ¡è¢«åˆ’åˆ†ä¸ºä¸åŒçš„ä¼˜å…ˆçº§ï¼Œä»¥ä¾¿æ ¹æ®ä»»åŠ¡çš„é‡è¦æ€§è¿›è¡Œè°ƒåº¦ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒReact å°†ä»»åŠ¡åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªä¼˜å…ˆçº§ï¼š åŒæ­¥ä»»åŠ¡ï¼šæœ€é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼Œé€šå¸¸ç”¨äºå¤„ç†ç”¨æˆ·äº¤äº’äº‹ä»¶å’Œé¡µé¢åŠ è½½è¿‡ç¨‹ä¸­çš„åŒæ­¥æ“ä½œã€‚ å¼‚æ­¥ä»»åŠ¡ï¼šä¸­ç­‰ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼ŒåŒ…æ‹¬æ™®é€šçš„æ›´æ–°ä»»åŠ¡å’Œç½‘ç»œè¯·æ±‚ç­‰å¼‚æ­¥æ“ä½œã€‚ ç©ºé—²ä»»åŠ¡ï¼šæœ€ä½ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼Œé€šå¸¸ç”¨äºæ‰§è¡Œä¸€äº›ä¸ç´§æ€¥çš„ä»»åŠ¡ï¼Œå¦‚æ—¥å¿—è®°å½•æˆ–ç»Ÿè®¡ä¿¡æ¯æ”¶é›†ç­‰ã€‚ è°ƒåº¦å™¨çš„å·¥ä½œæ–¹å¼è°ƒåº¦å™¨æ˜¯ React ä¸­è´Ÿè´£ä»»åŠ¡è°ƒåº¦çš„æ ¸å¿ƒç»„ä»¶ï¼Œå®ƒæ ¹æ®ä»»åŠ¡çš„ä¼˜å…ˆçº§å’Œç±»å‹æ¥åŠ¨æ€åœ°å®‰æ’ä»»åŠ¡çš„æ‰§è¡Œé¡ºåºã€‚è°ƒåº¦å™¨ä¼šç›‘è§†æµè§ˆå™¨çš„ç©ºé—²æ—¶é—´ï¼Œå¹¶æ ¹æ®å½“å‰ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ä¼˜å…ˆçº§ï¼Œå†³å®šåœ¨ä½•æ—¶æ‰§è¡Œå“ªäº›ä»»åŠ¡ã€‚ React Fiber ä¸ Concurrent Modeä»€ä¹ˆæ˜¯ Concurrent ModeConcurrent Mode æ˜¯ React Fiber çš„ä¸€é¡¹é‡è¦ç‰¹æ€§ï¼Œå®ƒæ˜¯ä¸€ç§æ–°çš„æ¸²æŸ“æ¨¡å¼ï¼Œæ—¨åœ¨æé«˜ React åº”ç”¨çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚åœ¨ Concurrent Mode ä¸‹ï¼ŒReact èƒ½å¤Ÿåœ¨å¤šä¸ªä¼˜å…ˆçº§ä»»åŠ¡ä¹‹é—´åŠ¨æ€åœ°è°ƒåº¦æ‰§è¡Œï¼Œä½¿å¾—é«˜ä¼˜å…ˆçº§ä»»åŠ¡èƒ½å¤Ÿä¼˜å…ˆå¾—åˆ°å¤„ç†ï¼Œä»è€Œæé«˜äº†é¡µé¢çš„å“åº”é€Ÿåº¦å’Œç”¨æˆ·äº¤äº’çš„æµç•…åº¦ã€‚ Concurrent Mode å¦‚ä½•åˆ©ç”¨ FiberConcurrent Mode åˆ©ç”¨äº† Fiber æ¶æ„çš„å¢é‡æ¸²æŸ“å’Œæ—¶é—´åˆ‡ç‰‡æŠ€æœ¯ï¼Œå®ç°äº†å¤šä¼˜å…ˆçº§ä»»åŠ¡çš„åŠ¨æ€è°ƒåº¦ã€‚é€šè¿‡ Fiber æ¶æ„ï¼ŒReact èƒ½å¤Ÿå°†æ¸²æŸ“ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡ï¼Œå¹¶åœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´æ‰§è¡Œï¼Œä»è€Œæœ€å¤§é™åº¦åœ°åˆ©ç”¨æµè§ˆå™¨çš„èµ„æºï¼Œæé«˜äº†æ¸²æŸ“æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚ Concurrent Mode çš„å®é™…åº”ç”¨batchedUpdatesåœ¨ React çš„äº‹ä»¶å¤„ç†è¿‡ç¨‹ä¸­ï¼Œå¦‚æœè¿ç»­è§¦å‘å¤šæ¬¡çŠ¶æ€æ›´æ–°ï¼Œè¿™äº›æ›´æ–°å¯èƒ½ä¼šè¢«æ™ºèƒ½åœ°åˆå¹¶ä¸ºå•ä¸€çš„æ›´æ–°æ“ä½œï¼Œä»¥é¿å…ä¸å¿…è¦çš„æ¸²æŸ“ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä»£ç ç‰‡æ®µï¼š // classonClick() &#123; this.setState(&#123; count: 1 &#125;); this.setState(&#123; flag: false &#125;); this.setState(&#123; count: 2 &#125;);&#125;// functionconst [count, setCount] = useState(0);const [flag, setFlag] = useState(false);function handleClick() &#123; setCount((c) =&gt; c + 1); // ä¸ä¼šé‡æ–°render setFlag((f) =&gt; !f); // ä¸ä¼šé‡æ–°render // // åˆå¹¶åæ‰ä¼š é‡æ–°render&#125; å°½ç®¡çœ‹èµ·æ¥æˆ‘ä»¬è¿›è¡Œäº†ä¸‰æ¬¡çŠ¶æ€æ›´æ–°ï¼Œå®é™…ä¸Šï¼ŒReact ä¼šå°†è¿™äº›æ›´æ–°åˆå¹¶ï¼Œåªè§¦å‘ä¸€æ¬¡ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚è¿™ç§ä¼˜åŒ–ç­–ç•¥è¢«ç§°ä¸º batchedUpdatesã€‚ batchedUpdates åœ¨ React æ—©æœŸç‰ˆæœ¬å°±å·²ç»å­˜åœ¨ï¼Œä½†å…¶æ—©æœŸå®ç°æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œä¸»è¦æ˜¯å®ƒä¸èƒ½åˆå¹¶é‚£äº›è„±ç¦»å½“å‰ä¸Šä¸‹æ–‡ç¯å¢ƒçš„æ›´æ–°ã€‚ åœ¨ Concurrent Mode è¿™ç§æ¨¡å¼ä¸‹ï¼ŒçŠ¶æ€æ›´æ–°çš„åˆå¹¶ä¸å†å±€é™äºå½“å‰ä¸Šä¸‹æ–‡ï¼Œè€Œæ˜¯æ ¹æ®æ›´æ–°çš„ä¼˜å…ˆçº§æ¥å†³å®šæ˜¯å¦åˆå¹¶ã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿æ›´æ–°æ“ä½œå‘ç”Ÿåœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡æˆ–å¼‚æ­¥æ“ä½œä¸­ï¼Œåªè¦å®ƒä»¬çš„ä¼˜å…ˆçº§å…è®¸ï¼Œè¿™äº›æ›´æ–°ä»ç„¶å¯ä»¥è¢«æœ‰æ•ˆåœ°åˆå¹¶ã€‚ è¿™ç§åŸºäºä¼˜å…ˆçº§çš„æ›´æ–°åˆå¹¶ç­–ç•¥ï¼Œä¸ä»…æé«˜äº†åº”ç”¨çš„å“åº”é€Ÿåº¦ï¼Œè¿˜ä½¿å¾—çŠ¶æ€ç®¡ç†æ›´åŠ é«˜æ•ˆå’Œçµæ´»ã€‚ SuspenseSuspense æ˜¯ä¸€ç§ç”¨äºåœ¨ç»„ä»¶æ ‘ä¸­ç­‰å¾…å¼‚æ­¥åŠ è½½å†…å®¹çš„æœºåˆ¶ï¼Œèƒ½å¤Ÿåœ¨æ•°æ®åŠ è½½å®Œæˆä¹‹å‰æ˜¾ç¤ºå ä½ç¬¦æˆ– loading ç•Œé¢ï¼Œä»è€Œæé«˜ç”¨æˆ·ä½“éªŒã€‚ Lazy LoadingLazy Loading æ˜¯ä¸€ç§å»¶è¿ŸåŠ è½½ç»„ä»¶æˆ–èµ„æºçš„æŠ€æœ¯ï¼Œèƒ½å¤Ÿæé«˜é¡µé¢çš„åŠ è½½é€Ÿåº¦å’Œå“åº”é€Ÿåº¦ï¼Œå‡å°‘åˆæ¬¡åŠ è½½æ—¶çš„èµ„æºå ç”¨å’Œç­‰å¾…æ—¶é—´ã€‚ useDeferredValueuseDeferredValueæ˜¯ä¸€ä¸ª React Hookï¼Œè¿”å›ä¸€ä¸ªå»¶åæ›´æ–°çš„å€¼ã€‚ const deferredValue = useDeferredValue(value); åœ¨useDeferredValueå†…éƒ¨ä¼šè°ƒç”¨useStateå¹¶è§¦å‘ä¸€æ¬¡æ›´æ–°ã€‚ è¿™æ¬¡æ›´æ–°çš„ä¼˜å…ˆçº§å¾ˆä½ï¼Œæ‰€ä»¥å½“å‰å¦‚æœæœ‰æ­£åœ¨è¿›è¡Œä¸­çš„æ›´æ–°ï¼Œä¸ä¼šå—useDeferredValueäº§ç”Ÿçš„æ›´æ–°å½±å“ã€‚æ‰€ä»¥useDeferredValueèƒ½å¤Ÿè¿”å›å»¶è¿Ÿçš„å€¼ã€‚ Concurrent Mode è¿˜æä¾›äº†ä¸€ç§ä¼˜é›…é™çº§çš„æœºåˆ¶ï¼Œç”¨äºå¤„ç†ä½ä¼˜å…ˆçº§ä»»åŠ¡æ— æ³•ç«‹å³æ‰§è¡Œçš„æƒ…å†µã€‚åœ¨ä»»åŠ¡æ— æ³•ç«‹å³æ‰§è¡Œæ—¶ï¼ŒConcurrent Mode èƒ½å¤Ÿè‡ªåŠ¨è°ƒæ•´ä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼Œä¿è¯é«˜ä¼˜å…ˆçº§ä»»åŠ¡èƒ½å¤Ÿå¾—åˆ°åŠæ—¶å¤„ç†ï¼Œä»è€Œé¿å…é¡µé¢åŠ è½½å’Œæ¸²æŸ“çš„é˜»å¡ï¼Œæé«˜ç”¨æˆ·ä½“éªŒçš„ç¨³å®šæ€§å’Œæµç•…åº¦ã€‚ ç»“è®ºFiber æ¶æ„ä½œä¸º React çš„æ ¸å¿ƒæ¶æ„ä¹‹ä¸€ï¼Œä¸º React åº”ç”¨çš„æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒå¸¦æ¥äº†é‡å¤§æ”¹è¿›å’Œä¼˜åŠ¿ï¼š å¢é‡æ¸²æŸ“å’Œæ—¶é—´åˆ‡ç‰‡ï¼šFiber æ¶æ„é€šè¿‡å¢é‡æ¸²æŸ“å’Œæ—¶é—´åˆ‡ç‰‡æŠ€æœ¯ï¼Œå°†æ¸²æŸ“ä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡ï¼Œåœ¨æµè§ˆå™¨ç©ºé—²æ—¶é—´æ‰§è¡Œï¼Œæé«˜äº†é¡µé¢çš„å“åº”é€Ÿåº¦å’Œç”¨æˆ·äº¤äº’çš„æµç•…åº¦ã€‚ ä¼˜å…ˆçº§è°ƒåº¦ï¼šFiber æ¶æ„æ ¹æ®ä»»åŠ¡çš„ä¼˜å…ˆçº§åŠ¨æ€è°ƒåº¦ä»»åŠ¡çš„æ‰§è¡Œé¡ºåºï¼Œç¡®ä¿é«˜ä¼˜å…ˆçº§ä»»åŠ¡èƒ½å¤Ÿä¼˜å…ˆå¾—åˆ°å¤„ç†ï¼Œæé«˜äº†ç³»ç»Ÿçš„å“åº”é€Ÿåº¦å’Œç¨³å®šæ€§ã€‚ Concurrent Mode å’Œ Suspenseï¼šConcurrent Mode å’Œ Suspense æ˜¯ Fiber æ¶æ„çš„é‡è¦ç‰¹æ€§ï¼Œèƒ½å¤Ÿæé«˜é¡µé¢åŠ è½½é€Ÿåº¦å’Œæ€§èƒ½è¡¨ç°ï¼Œä¼˜åŒ–ç”¨æˆ·çš„äº¤äº’ä½“éªŒã€‚ è½¬è½½","updated":"2025-08-02T05:46:04.182Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"react","slug":"react","permalink":"https://luckyship.github.io/tags/react/"}]},{"title":"ä¸ºä»€ä¹ˆ JavaScript ä¸­ `'str'` ä¸æ˜¯å¯¹è±¡ï¼Œå´èƒ½è°ƒç”¨æ–¹æ³•ï¼Ÿ","date":"2025-07-06T04:12:25.000Z","path":"2025/07/06/2025-07-06-js-string/","text":"æˆ‘ä»¬åœ¨æ—¥å¸¸ JavaScript ç¼–ç¨‹ä¸­ï¼Œç»å¸¸ä¼šçœ‹åˆ°è¿™æ ·çš„ä»£ç ï¼š &quot;hello&quot;.toUpperCase(); // &#x27;HELLO&#x27; ä½ å¯èƒ½ä¼šæƒ³ï¼š&#39;hello&#39; æ˜¯å­—ç¬¦ä¸²å­—é¢é‡ï¼Œå®ƒä¸æ˜¯å¯¹è±¡ï¼Œé‚£ä¸ºä»€ä¹ˆå¯ä»¥è°ƒç”¨æ–¹æ³•ï¼Ÿæ›´æœ‰è¶£çš„æ˜¯ï¼š console.log(&quot;hello&quot; instanceof String); // falseconsole.log(new String(&quot;hello&quot;) instanceof String); // true è¿™å°±å¼•å‡ºä¸€ä¸ªéå¸¸æ ¸å¿ƒä½†åˆå®¹æ˜“è¢«å¿½ç•¥çš„é—®é¢˜ï¼š ä¸ºä»€ä¹ˆ JavaScript ä¸­çš„å­—ç¬¦ä¸²ï¼ˆ&#39;str&#39;ï¼‰ä¸æ˜¯å¯¹è±¡ï¼Ÿä¸ºä»€ä¹ˆä¸ä¸€å¼€å§‹å°±å†™æˆ new String(&#39;str&#39;)ï¼Ÿè¿™æ ·ä¸æ˜¯æ›´ç»Ÿä¸€å—ï¼Ÿ æœ¬æ–‡å°†ä»åŸå§‹å€¼ã€åŒ…è£…å¯¹è±¡ã€è‡ªåŠ¨è£…ç®±æœºåˆ¶ã€æ€§èƒ½è®¾è®¡ç­‰è§’åº¦å…¨é¢è§£ç­”è¿™ä¸ªé—®é¢˜ã€‚ ä¸€ã€å­—ç¬¦ä¸²æ˜¯å¯¹è±¡å—ï¼Ÿå…ˆä¸Šä¸ªä¾‹å­ï¼š typeof &quot;hello&quot;; // &#x27;string&#x27;typeof new String(&quot;hello&quot;); // &#x27;object&#x27;&quot;hello&quot; instanceof String; // falsenew String(&quot;hello&quot;) instanceof String; // true ç»“è®ºå¾ˆæ˜ç¡®ï¼š &#39;hello&#39; æ˜¯åŸå§‹å€¼ï¼ˆprimitiveï¼‰ï¼Œä¸æ˜¯å¯¹è±¡ã€‚ new String(&#39;hello&#39;) æ˜¯åŒ…è£…å¯¹è±¡ï¼ˆboxed objectï¼‰ï¼Œæ˜¯ String æ„é€ å‡½æ•°å®ä¾‹ã€‚ äºŒã€ä½†ä¸ºä»€ä¹ˆ &#39;hello&#39;.toUpperCase() èƒ½è°ƒç”¨æ–¹æ³•ï¼Ÿè¿™å…¶å®æ˜¯ JavaScript ä¸­çš„ä¸€ä¸ª â€œè‡ªåŠ¨è£…ç®±ï¼ˆautoboxingï¼‰â€æœºåˆ¶ åœ¨é»˜é»˜å¸®æˆ‘ä»¬å·¥ä½œã€‚ å½“ä½ è°ƒç”¨ &#39;hello&#39;.toUpperCase() æ—¶ï¼ŒJS å¼•æ“ä¼šåšå¦‚ä¸‹å¤„ç†ï¼š // éšå¼è½¬æ¢ï¼šnew String(&quot;hello&quot;).toUpperCase(); å³ï¼š ä¸´æ—¶æŠŠ &#39;hello&#39; è½¬æˆ new String(&#39;hello&#39;)ã€‚ è°ƒç”¨å…¶åŸå‹æ–¹æ³•ã€‚ è°ƒç”¨å®Œæ¯•åé”€æ¯è¿™ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œè¿”å›ç»“æœã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ èƒ½åƒè°ƒç”¨å¯¹è±¡æ–¹æ³•ä¸€æ ·ä½¿ç”¨åŸå§‹å€¼çš„åŸå› ã€‚ ä¸‰ã€ä¸ºä»€ä¹ˆä¸ç›´æ¥è®© &#39;str&#39; å°±æ˜¯ new String(&#39;str&#39;)ï¼Ÿä½ å¯èƒ½ä¼šæƒ³ï¼šå¦‚æœå­—ç¬¦ä¸²æœ¬è´¨å°±æ˜¯å¯¹è±¡ï¼Œé‚£æ˜¯ä¸æ˜¯è®¾è®¡æ›´ç»Ÿä¸€ï¼Ÿå…¶å®è¿™æ˜¯ JS çš„è®¾è®¡è€…æ•…æ„ ä¸è¿™ä¹ˆåšï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹è€ƒè™‘ï¼š 1. æ€§èƒ½æ›´å¥½ åŸå§‹å€¼ï¼ˆå¦‚ &#39;abc&#39;, 42, trueï¼‰æ˜¯ è½»é‡çº§çš„å€¼ï¼Œæ²¡æœ‰åŸå‹é“¾ï¼Œè®¿é—®å¿«ï¼Œå†…å­˜å°ã€‚ å¦‚æœæ¯ä¸ªå­—ç¬¦ä¸²é»˜è®¤éƒ½æ˜¯ new String()ï¼Œé‚£åœ¨å¤§é‡å­—ç¬¦ä¸²å¤„ç†æ—¶ä¼šæ˜¾è‘—å¢åŠ å†…å­˜å ç”¨å’Œ GC å‹åŠ›ã€‚ ğŸ’¡ åŸå§‹å€¼ = å¿«é€Ÿ + è½»é‡åŒ…è£…å¯¹è±¡ = çµæ´» + å å†…å­˜ JS è¦æ±‚ä¸¤è€…å…¼å¾—ï¼Œå°±å¼•å…¥äº†â€œæŒ‰éœ€è£…ç®±â€çš„æœºåˆ¶ã€‚ 2. è¯­ä¹‰æ›´æ¸…æ™°ï¼Œé¿å…é™·é˜±&quot;abc&quot; === new String(&quot;abc&quot;); // false å¦‚æœå­—ç¬¦ä¸²å…¨æ˜¯å¯¹è±¡ï¼Œå€¼æ¯”è¾ƒå°±ä¼šå¼•å‘å„ç§â€œå¼•ç”¨ vs å€¼â€çš„æ··æ·†ã€‚ æ¯”å¦‚ Setã€Map çš„ key ä¹Ÿå¯èƒ½è¡Œä¸ºä¸ä¸€è‡´ã€‚ const set = new Set();set.add(&quot;abc&quot;);set.add(new String(&quot;abc&quot;));console.log(set.size); // 2ï¼ä¸æ˜¯ä½ æƒ³è±¡çš„ 1 è¿™ä¼šå¯¼è‡´å¼€å‘è€…å¾ˆå®¹æ˜“æ‰å‘ã€‚ 3. è¯­æ³•ä¸€è‡´æ€§ä½“éªŒJavaScript æ˜¯â€œç”¨æˆ·å‹å¥½â€çš„è¯­è¨€ï¼š &quot;abc&quot;.length;&quot;abc&quot;.charAt(1); è¿™äº›éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼ŒèƒŒåé çš„æ˜¯ä¸´æ—¶çš„åŒ…è£…å¯¹è±¡å®ç°æ–¹æ³•è®¿é—®ï¼Œè€Œä¸æ˜¯å¼ºè¿«ä½ æ¯æ¬¡å†™ new String()ã€‚ å¼€å‘è€…ç”¨å¾—é¡ºæ‰‹ï¼Œå¼•æ“å¸®ä½ å¤„ç†å¤æ‚æ€§ï¼Œè¿™æ­£æ˜¯ JS è®¾è®¡çš„åˆè¡·ã€‚ å››ã€è‡ªåŠ¨è£…ç®±æœ‰æ€§èƒ½é—®é¢˜å—ï¼Ÿå‡ ä¹æ²¡æœ‰ã€‚ ç°ä»£ JS å¼•æ“ï¼ˆå¦‚ V8ï¼‰å¯¹è‡ªåŠ¨è£…ç®±åšäº†å¾ˆå¤šä¼˜åŒ–ï¼š ä½¿ç”¨â€œéšè—ç±»â€ã€â€œå†…è”ç¼“å­˜â€ç­‰æœºåˆ¶é¿å…çœŸæ­£ new å‡ºä¸€ä¸ªå¯¹è±¡ã€‚ åŒ…è£…å¯¹è±¡æ˜¯ä¸´æ—¶çš„ï¼Œç”¨å®Œå³é”€æ¯ï¼ŒGC éå¸¸å¿«ã€‚ æ‰€ä»¥ä½ å¤§å¯ä»¥æ”¾å¿ƒä½¿ç”¨ &#39;abc&#39;.toUpperCase()ï¼Œæ€§èƒ½ä¸æ˜¯é—®é¢˜ã€‚ äº”ã€ä½•æ—¶ä¼šä¸»åŠ¨ä½¿ç”¨åŒ…è£…å¯¹è±¡ï¼Ÿè™½ç„¶å¤§å¤šæ•°æƒ…å†µä¸‹ä½ ä¸éœ€è¦ç”¨ new String()ï¼Œä½†ä»¥ä¸‹åœºæ™¯å¯èƒ½ä¼šç”¨åˆ°ï¼š âœ… éœ€è¦å¯¹è±¡è¡Œä¸ºæ—¶ï¼ˆå¦‚æŒ‚å±æ€§ï¼‰const str = new String(&quot;abc&quot;);str.custom = &quot;hello&quot;;console.log(str.custom); // &#x27;hello&#x27; æ³¨æ„ï¼šåŸå§‹å­—ç¬¦ä¸²ä¸èƒ½æŒ‚å±æ€§ï¼ŒæŒ‚ä¸Šä¹Ÿè®¿é—®ä¸åˆ°ã€‚ âœ… ç‰¹æ®Š API è¦æ±‚å¯¹è±¡ä½œä¸º keyæ¯”å¦‚ WeakMap çš„ key å¿…é¡»æ˜¯å¯¹è±¡ï¼š const wm = new WeakMap();const n = new Number(123);wm.set(n, &quot;value&quot;); // åˆæ³• å…­ã€æ€»ç»“ é—®é¢˜ è§£é‡Š &#39;str&#39; æ˜¯å¯¹è±¡å—ï¼Ÿ âŒ ä¸æ˜¯ï¼Œæ˜¯åŸå§‹å€¼ ä¸ºä»€ä¹ˆèƒ½è°ƒç”¨æ–¹æ³•ï¼Ÿ âœ… è‡ªåŠ¨è£…ç®±ï¼šä¸´æ—¶è½¬æˆåŒ…è£…å¯¹è±¡è°ƒç”¨æ–¹æ³• ä¸ºä»€ä¹ˆä¸æ˜¯ç›´æ¥ç”¨å¯¹è±¡ï¼Ÿ æ€§èƒ½æ›´å¥½ã€è¯­ä¹‰æ›´æ¸…æ™° è£…ç®±æœ‰æ€§èƒ½é—®é¢˜å—ï¼Ÿ å‡ ä¹æ²¡æœ‰ï¼Œç°ä»£å¼•æ“ä¼˜åŒ–å¾ˆå¥½ åŒ…è£…å¯¹è±¡è¿˜ç”¨å—ï¼Ÿ æå°‘ç”¨ï¼Œé™¤éä½ éœ€è¦æŒ‚å±æ€§ã€ä½œä¸ºå¯¹è±¡é”® âœ… æœ€åä¸€å¥è¯æ€»ç»“ï¼š JavaScript ä¸­çš„ &#39;str&#39; æ˜¯åŸå§‹å€¼ï¼Œä¸ºäº†æ€§èƒ½ä¸è¯­ä¹‰æ¸…æ™°ï¼›åŒ…è£…å¯¹è±¡æ˜¯å¹•åè‹±é›„ï¼Œè®©åŸå§‹å€¼ä¹Ÿæ‹¥æœ‰â€œåƒå¯¹è±¡ä¸€æ ·â€çš„èƒ½åŠ›ï¼Œè€Œè‡ªåŠ¨è£…ç®±æœºåˆ¶åˆ™å¹³è¡¡äº†ä¸¤è€…çš„çŸ›ç›¾ï¼Œä½“ç°äº† JavaScript çš„çµæ´»ä¸å·§å¦™ã€‚","updated":"2025-08-02T05:46:04.182Z","tags":[]},{"title":"è‡ªå·±å®ç°ä¸€ä¸ªç®€å•ç‰ˆ Piniaï¼ˆminiPiniaï¼‰","date":"2025-06-23T12:55:56.000Z","path":"2025/06/23/2025-06-23-mini-pinia/","text":"æˆ‘ä»¬åšä¸€ä¸ªæç®€ Piniaï¼Œå®ç°ï¼š åˆ›å»º store å“åº”å¼ state æ”¯æŒ actions æ”¯æŒåœ¨ç»„ä»¶ä¸­ä½¿ç”¨ åˆ›å»º storecreatePinia() â€”â€” åˆ›å»ºä¸€ä¸ªâ€å…¨å±€å®¹å™¨â€ export function createPinia() &#123; const stores = new Map(); return &#123; install(app) &#123; app.provide(piniaSymbol, this); &#125;, _stores: stores, useStore(storeId, createStoreFn) &#123; if (!this._stores.has(storeId)) &#123; const store = createStoreFn(); this._stores.set(storeId, store); &#125; return this._stores.get(storeId); &#125;, &#125;;&#125; ç›¸å½“äº Pinia å®ä¾‹ï¼ŒæŒæœ‰æ‰€æœ‰çš„ storeï¼ˆç”¨ Map å­˜å‚¨ï¼‰ æä¾› useStore æ–¹æ³•ï¼Œç¡®ä¿æ¯ä¸ª store æ˜¯å•ä¾‹ åœ¨ app.use(pinia) æ—¶é€šè¿‡ provide å°† pinia å®ä¾‹æŒ‚è¿› Vue çš„ä¸Šä¸‹æ–‡ä¸­ï¼ˆç”¨äº inject()ï¼‰ ğŸ” store æ˜¯å•ä¾‹çš„ï¼Œæ€ä¹ˆå®ç°çš„ï¼Ÿ if (!this._stores.has(storeId)) &#123; const store = createStoreFn(); this._stores.set(storeId, store);&#125; æ¯ä¸ª storeId å¯¹åº”çš„ store åªä¼šåˆå§‹åŒ–ä¸€æ¬¡ åç»­æ‰€æœ‰ useStore() éƒ½è¿”å›åŒä¸€ä¸ªå¯¹è±¡ defineStore() â€”â€” å®šä¹‰ store çš„æ³¨å†Œé€»è¾‘export function defineStore(id, setupFn) &#123; return function useStore() &#123; const pinia = inject(piniaSymbol); if (!pinia) throw new Error(&quot;Pinia not installed&quot;); return pinia.useStore(id, () =&gt; setupFn()); &#125;;&#125; ä½¿ç”¨è€…å†™ï¼šdefineStore(&#39;counter&#39;, () =&gt; &#123; ... &#125;) è¿”å›ä¸€ä¸ªå‡½æ•° useStore()ï¼Œç”¨äºç»„ä»¶ä¸­è°ƒç”¨ å†…éƒ¨è°ƒç”¨ pinia çš„ useStore()ï¼Œä¼ å…¥ storeId å’Œ setup é€»è¾‘ æ³¨å…¥ pinia å®ä¾‹ï¼Œä» provide ä¸­è·å–ï¼Œç¡®ä¿ store å¯ä»¥åœ¨å…¨å±€è®¿é—® setupFn() â€”â€” åˆ›å»ºå“åº”å¼çš„ state å’Œ actionsconst state = reactive(&#123; count: 0 &#125;);function increment() &#123; state.count++;&#125; ä½¿ç”¨ Vue 3 çš„ reactive() åˆ›å»ºå“åº”å¼æ•°æ® ç»„åˆå¼ API çš„æ–¹å¼å°† state å’Œæ–¹æ³•ç»„ç»‡æˆä¸€ä¸ª store è¿”å›ç»™ç»„ä»¶ä½¿ç”¨ useStore() in ç»„ä»¶ä¸­ â€”â€” è·å– store å®ä¾‹const counter = useCounterStore(); æ•´ä½“ä»£ç ğŸ”§ miniPinia.js // miniPinia.jsimport &#123; reactive, inject, provide &#125; from &quot;vue&quot;;const piniaSymbol = Symbol(&quot;miniPinia&quot;);export function createPinia() &#123; const stores = new Map(); return &#123; install(app) &#123; app.provide(piniaSymbol, this); &#125;, _stores: stores, useStore(storeId, createStoreFn) &#123; if (!this._stores.has(storeId)) &#123; const store = createStoreFn(); this._stores.set(storeId, store); &#125; return this._stores.get(storeId); &#125;, &#125;;&#125;export function defineStore(id, setupFn) &#123; return function useStore() &#123; const pinia = inject(piniaSymbol); if (!pinia) throw new Error(&quot;Pinia not installed&quot;); return pinia.useStore(id, () =&gt; setupFn()); &#125;;&#125; // counterStore.jsimport &#123; reactive &#125; from &quot;vue&quot;;import &#123; defineStore &#125; from &quot;./miniPinia&quot;;export const useCounterStore = defineStore(&quot;counter&quot;, () =&gt; &#123; const state = reactive(&#123; count: 0, &#125;); function increment() &#123; state.count++; &#125; return &#123; state, increment, &#125;;&#125;); &lt;!-- App.vue --&gt;&lt;template&gt; &lt;div&gt; &lt;h2&gt;Count: &#123;&#123; counter.state.count &#125;&#125;&lt;/h2&gt; &lt;button @click=&quot;counter.increment()&quot;&gt;+1&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script setup&gt; import &#123; useCounterStore &#125; from &quot;./counterStore&quot;; const counter = useCounterStore();&lt;/script&gt; // main.jsimport &#123; createApp &#125; from &quot;vue&quot;;import App from &quot;./App.vue&quot;;import &#123; createPinia &#125; from &quot;./miniPinia&quot;;const app = createApp(App);const pinia = createPinia();app.use(pinia);app.mount(&quot;#app&quot;);","updated":"2025-08-02T05:46:04.182Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"vue","slug":"vue","permalink":"https://luckyship.github.io/tags/vue/"}]},{"title":"PostgreSQLæ•°æ®åº“å¤‡ä»½è¿˜åŸ","date":"2025-01-11T08:01:25.000Z","path":"2025/01/11/2025-01-11-postgresql-backup/","text":"å‰è¨€ é€»è¾‘å¤‡ä»½ å³ SQL è½¬å‚¨æ–¹å¼ï¼Œä½¿ç”¨ pg_dump å’Œ pg_dumpall è¿›è¡Œå¤‡ä»½ã€‚é€»è¾‘å¤‡ä»½åœ¨æ¢å¤æ—¶ï¼Œä»‹äºé€»è¾‘å¤‡ä»½ä¸æ•…éšœæ—¶é—´ç‚¹ä¹‹é—´çš„æ•°æ®éš¾ä»¥æ¢å¤ï¼Œæ‰€ä»¥é€»è¾‘å¤‡ä»½é€‚ç”¨äºç•™å­˜æŸä¸ªæ—¶é—´ç‚¹çš„å¤‡ä»½æˆ–è¿›è¡Œè·¨å¹³å°è·¨ç‰ˆæœ¬çš„æ•°æ®è¿ç§»ã€‚ æ–‡ä»¶ç³»ç»Ÿçº§å¤‡ä»½ å³æ‹·è´æ•°æ®æ–‡ä»¶çš„å®Œæ•´ç›®å½•ï¼Œå¤‡ä»½æ—¶éœ€è¦å…³é—­æ•°æ®åº“ã€‚æ¢å¤æ•°æ®åº“æ—¶ï¼Œåªéœ€å°†æ•°æ®ç›®å½•å¤åˆ¶åˆ°åŸæ¥çš„ä½ç½®ã€‚è¯¥æ–¹å¼å®é™…å·¥ä½œä¸­å¾ˆå°‘ä½¿ç”¨ã€‚ è¿ç»­å½’æ¡£ è¯¥æ–¹å¼æ˜¯æŠŠä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿçº§åˆ«çš„å…¨é‡å¤‡ä»½å’Œ WAL(é¢„å†™å¼æ—¥å¿—)çº§åˆ«çš„å¢é‡å¤‡ä»½ç»“åˆèµ·æ¥ã€‚å½“éœ€è¦æ¢å¤æ—¶ï¼Œæˆ‘ä»¬å…ˆæ¢å¤æ–‡ä»¶ç³»ç»Ÿçº§åˆ«çš„å¤‡ä»½ï¼Œç„¶åé‡æ”¾å¤‡ä»½çš„ WAL æ–‡ä»¶ï¼ŒæŠŠç³»ç»Ÿæ¢å¤åˆ°ä¹‹å‰çš„æŸä¸ªçŠ¶æ€ã€‚ æœ¬æ–‡ä¸»è¦ä»‹ç»é€»è¾‘å¤‡ä»½å’Œè¿ç»­å½’æ¡£æ–¹å¼çš„å¤‡ä»½åŠè¿˜åŸï¼Œæ–‡ä»¶ç³»ç»Ÿçº§å¤‡ä»½ç”±äºæ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œä¸åœ¨èµ˜è¿°ã€‚ä»¥ä¸‹æ“ä½œä½¿ç”¨çš„æ•°æ®åº“ç‰ˆæœ¬ä¸º PostgreSQL 12.5ï¼Œä¸åŒçš„æ•°æ®åº“ç‰ˆæœ¬åœ¨è¿›è¡Œè¿ç»­å½’æ¡£æ“ä½œæ—¶ä¼šæœ‰ç»†å¾®å·®å¼‚ã€‚ é€»è¾‘å¤‡ä»½ä½¿ç”¨sqlå‘½ä»¤å¤‡ä»½éƒ¨åˆ†æ•°æ®ï¼ˆé€‚ç”¨äºä¿®æ”¹åˆ é™¤æŸäº›ç‰¹å®šæ•°æ®çš„å¤‡ä»½ï¼‰# å¤‡ä»½åˆ°æŒ‡å®šcsvè¡¨æ ¼psql -h localhost -U username -d database -p 5433 -c &quot;\\copy (select * from test_table oc where id = 139375) TO &#x27;~/test.csv&#x27; WITH (FORMAT CSV, HEADER);&quot;# ä»csvè¡¨æ ¼æ¢å¤æ•°æ®åˆ°æ•°æ®åº“psql -h localhost -U username -d database -p 5433 -c &quot;\\copy test_table FROM &#x27;~/test.csv&#x27; WITH (FORMAT CSV, HEADER);&quot; pg_dump å·¥å…·ä»¥ä¸‹ä¸º pg_dump å·¥å…·çš„å¸¸ç”¨å‚æ•°é€‰é¡¹ï¼ˆæ›´å¤šå‚æ•°å¯ä½¿ç”¨ pg_dump â€“help æŸ¥çœ‹ï¼‰ è”æ¥é€‰é¡¹:-h, --host=ä¸»æœºå æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºåæˆ–å¥—æ¥å­—ç›®å½•-U, --username=åå­— ä»¥æŒ‡å®šçš„æ•°æ®åº“ç”¨æˆ·è”æ¥-d, --dbname=DBNAME å¯¹æ•°æ®åº“ DBNAMEå¤‡ä»½-p, --port=ç«¯å£å· æ•°æ®åº“æœåŠ¡å™¨çš„ç«¯å£å·-w, --no-password æ°¸è¿œä¸æç¤ºè¾“å…¥å£ä»¤-W, --password å¼ºåˆ¶å£ä»¤æç¤º (è‡ªåŠ¨)--role=ROLENAME åœ¨è½¬å‚¨å‰è¿è¡ŒSET ROLEä¸€èˆ¬é€‰é¡¹:-f, --file=FILENAME è¾“å‡ºæ–‡ä»¶æˆ–ç›®å½•åï¼Œå¯¼å‡ºåˆ°æŒ‡å®šæ–‡ä»¶-F, --format= p|c|d|t å¯¼å‡ºæ–‡ä»¶æ ¼å¼ï¼ˆp|c|d|tï¼‰ pï¼šplain-è¾“å‡ºæ™®é€šæ–‡å­—SQLè„šæœ¬ï¼ˆé»˜è®¤ï¼‰ï¼› cï¼šcustom-è¾“å‡ºè‡ªå®šä¹‰å½’æ¡£æ ¼å¼ï¼Œé€‚ç”¨äºpg_restoreå¯¼å…¥ï¼Œè¯¥æ ¼å¼æ˜¯æœ€çµæ´»å¯¼å‡ºæ–¹å¼ï¼Œå…è®¸åœ¨å¯¼å…¥æ—¶è‡ªå®šä¹‰é€‰æ‹©å’Œé‡ æ’åºå½’æ¡£æ¡ç›®ã€‚è¯¥æ ¼å¼é»˜è®¤å¯ç”¨å‹ç¼©ï¼› dï¼šdirectory-è¾“å‡ºæ–‡ä»¶å¤¹å½’æ¡£æ ¼å¼ï¼Œé€‚ç”¨äºpg_restoreå¯¼å…¥ã€‚è¯¥æ ¼å¼ä¼šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªè¡¨å¯¹åº”ä¸€ä¸ªæ–‡ä»¶ã€‚è¯¥æ ¼å¼é»˜è®¤å¯ç”¨å‹ç¼©ï¼Œå¹¶ä¸”æ”¯æŒå¹¶è¡Œå¯¼å‡ºï¼› tï¼štar-è¾“å‡ºtarå‹ç¼©å½’æ¡£æ ¼å¼ï¼Œé€‚ç”¨äºpg_restoreå¯¼å…¥ã€‚è¯¥æ ¼å¼å°†æ–‡ä»¶å¤¹å½’æ¡£æ ¼å¼äº§ç”Ÿçš„æ–‡ä»¶å¤¹å‹ç¼©æˆtarå‹ç¼©åŒ…ã€‚ä½†è¯¥æ ¼å¼ä¸æ”¯æŒå‹ç¼©ï¼ˆæ–‡ä»¶å¤¹å½’æ¡£å·²ç»å‹ç¼©äº†ï¼‰ï¼Œå¹¶ä¸”åœ¨å¯¼å…¥æ—¶ä¹Ÿä¸èƒ½æ›´æ”¹ç›¸å…³çš„è¡¨é¡ºåºã€‚æ§åˆ¶è¾“å‡ºå†…å®¹é€‰é¡¹:-s, --schema-only åªè½¬å‚¨æ¨¡å¼, ä¸åŒ…æ‹¬æ•°æ®-a, --data-only åªè½¬å‚¨æ•°æ®,ä¸åŒ…æ‹¬æ¨¡å¼-t, --table=TABLE åªè½¬å‚¨æŒ‡å®šåç§°çš„è¡¨-T, --exclude-table=TABLE ä¸è½¬å‚¨æŒ‡å®šåç§°çš„è¡¨-C, --create åœ¨è½¬å‚¨ä¸­åŒ…æ‹¬åˆ›å»ºæ•°æ®åº“è¯­å¥-c, --cleanï¼šåŒ…å«dropåˆ é™¤è¯­å¥ï¼Œå»ºè®®ä¸--if-existsåŒæ—¶ä½¿ç”¨ï¼›--if-existsï¼Œdropåˆ é™¤è¯­å¥æ—¶å¸¦ä¸ŠIF EXISTSæŒ‡ä»¤-n, --schema=SCHEMA åªè½¬å‚¨æŒ‡å®šåç§°çš„æ¨¡å¼-N, --exclude-schema=SCHEMA ä¸è½¬å‚¨å·²å‘½åçš„æ¨¡å¼-O, --no-owner åœ¨æ˜æ–‡æ ¼å¼ä¸­, å¿½ç•¥æ¢å¤å¯¹è±¡æ‰€å±è€…-S, --superuser=NAME åœ¨æ˜æ–‡æ ¼å¼ä¸­ä½¿ç”¨æŒ‡å®šçš„è¶…çº§ç”¨æˆ·å--column-inserts ä»¥å¸¦æœ‰åˆ—åçš„INSERTå‘½ä»¤å½¢å¼è½¬å‚¨æ•°æ®--inserts ä»¥INSERTå‘½ä»¤ï¼Œè€Œä¸æ˜¯COPYå‘½ä»¤çš„å½¢å¼è½¬å‚¨æ•°æ®--disable-triggers åœ¨åªæ¢å¤æ•°æ®çš„è¿‡ç¨‹ä¸­ç¦ç”¨è§¦å‘å™¨--exclude-table-data=TABLE ä¸è½¬å‚¨æŒ‡å®šåç§°çš„è¡¨ä¸­çš„æ•°æ®--no-synchronized-snapshots åœ¨å¹¶è¡Œå·¥ä½œé›†ä¸­ä¸ä½¿ç”¨åŒæ­¥å¿«ç…§--no-tablespaces ä¸è½¬å‚¨è¡¨ç©ºé—´åˆ†é…ä¿¡æ¯--no-unlogged-table-data ä¸è½¬å‚¨æ²¡æœ‰æ—¥å¿—çš„è¡¨æ•°æ®--quote-all-identifiers æ‰€æœ‰æ ‡è¯†ç¬¦åŠ å¼•å·ï¼Œå³ä½¿ä¸æ˜¯å…³é”®å­—--section=SECTION å¤‡ä»½å‘½åçš„èŠ‚ (æ•°æ®å‰, æ•°æ®, åŠ æ•°æ®å)--serializable-deferrable ç­‰åˆ°å¤‡ä»½å¯ä»¥æ— å¼‚å¸¸è¿è¡Œ--snapshot=SNAPSHOT ä¸ºè½¬å‚¨ä½¿ç”¨ç»™å®šçš„å¿«ç…§--strict-names è¦æ±‚æ¯ä¸ªè¡¨å’Œ/æˆ–schemaåŒ…æ‹¬æ¨¡å¼ä»¥åŒ¹é…è‡³å°‘ä¸€ä¸ªå®ä½“ å¸¸ç”¨ç¤ºä¾‹ï¼š #å¤‡ä»½schemaåŠæ•°æ®ï¼ŒæŒ‡å®šæ•°æ®åº“pg_hiveï¼ŒæŒ‡å®šæ–‡ä»¶ä¸ºpg_hive20210108.sqlpg_dump -h 127.0.0.1 -U postgres -d pg_hive -f /opt/pg_hive20210108.sql#åªå¤‡ä»½schemapg_dump -h 127.0.0.1 -U postgres -d pg_hive -s -f /opt/pg_hive20210108.sql#åªå¤‡ä»½æ•°æ®pg_dump -h 127.0.0.1 -U postgres -d pg_hive -a -f /opt/pg_hive20210108.sql#å¤‡ä»½å•ä¸ªè¡¨pg_dump -h 127.0.0.1 -U postgres -d pg_hive â€“t table1 -f /opt/pg_hive20210108.sql#å¤‡ä»½å¤šä¸ªè¡¨pg_dump -h 127.0.0.1 -U postgres -d pg_hive â€“t table1 â€“t table2 -f /opt/pg_hive20210108.sql#ä»¥å¸¦æœ‰åˆ—åçš„INSERTå‘½ä»¤å½¢å¼è½¬å‚¨æ•°æ®pg_dump -h 127.0.0.1 -U postgres -d pg_hive --column-inserts -f /opt/pg_hive20210108.sql#æŒ‡å®šå¯¼å‡ºæ ¼å¼ä¸ºè‡ªå®šä¹‰æ ¼å¼(äºŒè¿›åˆ¶å½¢å¼)pg_dump -h 127.0.0.1 -U postgres -d pg_hive -Fc -f /opt/pg_hive20210108.dump#ä½¿ç”¨gzipå‹ç¼©è½¬å‚¨ï¼ˆé’ˆå¯¹å¤§å‹æ•°æ®åº“ï¼‰pg_dump -h 127.0.0.1 -U postgres -d pg_hive | gzip &gt; /opt/pg_hive20210108_gz.sql.gz#ä½¿ç”¨splitåˆ‡ç‰‡æ–‡ä»¶ï¼ˆé’ˆå¯¹å¤§å‹æ•°æ®åº“ï¼‰/pg_dump -h 127.0.0.1 -U postgres -d pg_hive | split -b 100m - /opt/pg_hive20210108_sp.sql pg_dumpall å·¥å…·ç›¸å¯¹äº pg_dump åªèƒ½å¤‡ä»½å•ä¸ªåº“ï¼Œpg_dumpall å¯ä»¥å¤‡ä»½æ•´ä¸ªPostgreSqlå®ä¾‹ä¸­æ‰€æœ‰çš„æ•°æ®ï¼ŒåŒ…æ‹¬è§’è‰²å’Œè¡¨ç©ºé—´å®šä¹‰ã€‚ ä½¿ç”¨ç¤ºä¾‹ï¼š #å¤‡ä»½æ•´ä¸ªpostgresqlå®ä¾‹ä¸­æ‰€æœ‰çš„æ•°pg_dumpall -h 127.0.0.1 -U postgres -f /opt/pg_hive20210108_all.sql é€»è¾‘å¤‡ä»½è¿˜åŸé€»è¾‘å¤‡ä»½çš„è¿˜åŸå‘½ä»¤ä¸º psql å’Œ pg_restoreï¼šå¦‚æœä½¿ç”¨ pg_dump æœªæŒ‡å®š formatï¼ˆå³æœªä½¿ç”¨-F å‚æ•°ï¼‰ï¼Œåˆ™å¯¼å‡ºçš„æ˜¯ SQL è„šæœ¬ï¼Œå¯¼å…¥æ—¶éœ€ç”¨ psql å‘½ä»¤ï¼Œå¦åˆ™ç”¨ pg_restore è¿˜åŸã€‚å› è¿™ 2 ä¸ªè¿˜åŸå·¥å…·å¤§éƒ¨åˆ†å‚æ•°ä¸ pg_dump å«ä¹‰ç›¸è¿‘ï¼Œå¯ä½¿ç”¨å‘½ä»¤ååŠ â€“help æŸ¥çœ‹è¯¦ç»†å‚æ•°ã€‚ å¸¸ç”¨ç¤ºä¾‹ï¼š #pg_dumpå¤‡ä»½æ—¶æœªæŒ‡å®šformatï¼Œè¿˜åŸæ—¶ç”¨psqlpsql -h 127.0.0.1 -U postgres -d pg_hive -f /opt/pg_hive20210108.sql#pg_dumpå¤‡ä»½æ—¶å€™ä½¿ç”¨-Få‚æ•°æŒ‡å®šformatï¼Œè¿˜åŸæ—¶ç”¨pg_restorepg_restore -h 127.0.0.1 -U postgres -d pg_hive /opt/pg_hive20210108.dump#è¿˜åŸgzipå‹ç¼©æ•°æ®åº“å¤‡ä»½gunzip -c /opt/pg_hive20210108_gz.sql.gz | psql -h 127.0.0.1 -U postgres -d pg_hive#è¿˜åŸåˆ‡ç‰‡æ•°æ®åº“å¤‡ä»½cat /opt/pg_hive20210108_sp.sql* | psql -h 127.0.0.1 -U postgres -d pg_hive è¿ç»­å½’æ¡£å¤‡ä»½è¿ç»­å½’æ¡£æ˜¯é€šè¿‡åŸºç¡€å¤‡ä»½å’Œ wal æ—¥å¿—ç›¸ç»“åˆçš„æ–¹å¼è¿›è¡Œå¤‡ä»½ï¼Œæ¢å¤çš„æ—¶å€™å¯ä»¥é€‰æ‹©æ¢å¤åˆ°æŒ‡å®šçš„æ—¶é—´ç‚¹ã€æŒ‡å®šäº‹åŠ¡ç‚¹ã€æˆ–è€…å®Œå…¨æ¢å¤åˆ° wal æ—¥å¿—çš„æœ€æ–°ä½ç½®ã€‚ æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š1ã€åˆ›å»ºå¤‡ä»½ç›®å½• #åˆ›å»ºåŸºç¡€å¤‡ä»½ç›®å½•mkdir -p /data/pg_base#åˆ›å»ºwalæ—¥å¿—å¤‡ä»½ç›®å½•mkdir -p /data/pg_archive æ³¨æ„æ–°å»ºå¤‡ä»½æ–‡ä»¶å¤¹çš„æƒé™åŠæ‰€æœ‰è€…ï¼Œå¦åˆ™ä¼šå¤‡ä»½å¤±è´¥ #æ›´æ–°å¤‡ä»½æ–‡ä»¶å¤¹çš„æ‰€æœ‰è€…chown postgres:postgres /data/pg_basechown postgres:postgres /data/pg_archive 2ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ æ‰“å¼€ postgresql.conf é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹ 3 ä¸ªå‚æ•°ï¼š vi postgresql.conf#wal_levelä¸­æœ‰ä¸‰ä¸ªä¸»è¦çš„å‚æ•°ï¼šminimalã€archiveå’Œhot_standbyã€‚1.minimalæ˜¯é»˜è®¤çš„å€¼ï¼Œå®ƒä»…å†™å…¥å´©æºƒæˆ–è€…çªå‘å…³æœºæ—¶æ‰€éœ€è¦çš„ä¿¡æ¯ï¼ˆä¸å»ºè®®ä½¿ç”¨ï¼‰ã€‚2.archiveæ˜¯å¢åŠ walå½’æ¡£æ‰€éœ€çš„æ—¥å¿—ï¼ˆæœ€å¸¸ç”¨ï¼‰ã€‚3.hot_standbyæ˜¯åœ¨å¤‡ç”¨æœåŠ¡å™¨ä¸Šå¢åŠ äº†è¿è¡Œåªè¯»æŸ¥è¯¢æ‰€éœ€çš„ä¿¡æ¯ï¼Œä¸€èˆ¬å®åœ¨æµå¤åˆ¶çš„æ—¶å€™ä½¿ç”¨åˆ°wal_level = archive#å¼€å¯å½’æ¡£æ¨¡å¼archive_mode = on#å¤‡ä»½walæ—¥å¿—ï¼Œæ¯å¤©ç”Ÿæˆä¸€ä¸ªæ—¥æœŸå‘½åçš„æ–‡ä»¶å¤¹archive_command = &#x27;DIR=/data/pg_archive/`date +%F`; test ! -d $DIR &amp;&amp; mkdir -p $DIR; test ! -f $DIR/%f &amp;&amp; cp %p $DIR/%f&#x27; 3ã€é‡å¯ pg æ•°æ®åº“ å‘½ä»¤ä¸ºï¼špg_ctl restart4ã€åˆ›å»ºè¡¨è¯¥æ­¥éª¤ä¸ºæµ‹è¯•å¤‡ä»½åŠæ¢å¤æ•ˆæœä½¿ç”¨ --åˆ›å»ºè¡¨ï¼Œæ’å…¥10æ¡æµ‹è¯•æ•°æ®ï¼šcreate table test (id integer);insert into test values(generate_series(1,10)); 5ã€åšåŸºç¡€å¤‡ä»½ pg_basebackup -Ft -Pv -Xf -z -Z5 -D /data/pg_base/`date +%F` ä¸ºäº†æµ‹è¯•å¤‡ä»½å’Œæ¢å¤æ•ˆæœï¼Œå†æ’å…¥ 10 æ¡æ•°æ®ï¼Œå¹¶è¿›è¡Œæ‰‹åŠ¨åˆ‡æ¢ wal æ—¥å¿—ï¼Œæ‰§è¡Œå¦‚ä¸‹ sqlï¼š #æ’å…¥æ•°æ®insert into test values(generate_series(1,10));#åˆ‡æ¢walæ—¥å¿—select pg_switch_wal(); è¿ç»­å½’æ¡£æ¢å¤1ã€åˆ›å»º data æ–‡ä»¶å¤¹ #é‡å‘½ååŸæ¥çš„dataæ–‡ä»¶å¤¹mv /pgsql/postgresql/data /pgsql/postgresql/data.bak#åˆ›å»ºæ–°çš„dataæ–‡ä»¶å¤¹mkdir data 2ã€è§£å‹åŸºç¡€å¤‡ä»½è‡³æ–°å»ºçš„ data æ–‡ä»¶å¤¹ #æ‹·è´åŸºç¡€å¤‡ä»½åˆ°æ–°å»ºdataæ–‡ä»¶å¤¹cp /data/pg_base/2021-01-15/base.tar.gz /pgsql/postgresql/data#è§£å‹æ–‡ä»¶tar -zxvf base.tar.gz#åˆ é™¤åŸºç¡€å¤‡ä»½ä¸­çš„walæ—¥å¿—å’Œpostmaster.pidæ–‡ä»¶Cd /pgsql/postgresql/datarm -rf pg_walrm -rf postmaster.pid#åˆ›å»ºarchive_statusæ–‡ä»¶å¤¹mkdir -p pg_wal/archive_status 3ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ vi postgresql.conf#ä¿®æ”¹restore_commandä¸ºè¦æ¢å¤çš„walæ—¥å¿—ç›®å½•restore_command = &#x27;cp /data/pg_archive/2021-01-15/%f %p&#x27; 4ã€æ–°å»º recovery.signal æ–‡ä»¶ #æ¢å¤æ—¶ä¾èµ–è¯¥æ–‡ä»¶ï¼Œæ¢å¤è‡³æœ€æ–°walä½ç½®ï¼Œæ–‡ä»¶æ— éœ€æ·»åŠ å†…å®¹touch recovery.signal 5ã€èµ‹æƒå¹¶å¯åŠ¨æ•°æ®åº“ #æ–°å»ºçš„dataæ–‡ä»¶å¤¹æ›´æ”¹æ‰€æœ‰è€…chown -R postgres:postgres /pgsql/postgresql/data#ä¿®æ”¹dataç›®å½•æƒé™ï¼Œå¦åˆ™ä¼šå› ä¸ºç›®å½•æƒé™è¿‡å¤§æ— æ³•å¯åŠ¨æ•°æ®åº“chmod 0700 data -R#å¯åŠ¨æ•°æ®åº“pg_ctl start","updated":"2025-08-02T05:46:04.182Z","tags":[{"name":"sql","slug":"sql","permalink":"https://luckyship.github.io/tags/sql/"},{"name":"postgresql","slug":"postgresql","permalink":"https://luckyship.github.io/tags/postgresql/"}]},{"title":"linux-command","date":"2024-07-01T03:10:05.000Z","path":"2024/07/01/2024-07-01-linux-command/","text":"æŸ¥çœ‹å¤§æ–‡ä»¶ # å¯æŸ¥çœ‹ä»»æ„ç›®å½•ä¸‹çš„å¤§æ–‡ä»¶sudo du -h --max-depth=1 / | sort -hr","updated":"2025-08-02T05:46:04.182Z","tags":[]},{"title":"ä¸€æ–‡å½»åº•ææ‡‚providedInçš„æ‰€æœ‰é€‰é¡¹ï¼Œé™¤äº†rootè¿˜èƒ½é€‰æ‹©å•¥","date":"2024-04-13T11:32:09.000Z","path":"2024/04/13/2024-04-13-angular-service-providedIn/","text":"å½“æˆ‘ä»¬åœ¨åˆ›å»º angular çš„æœåŠ¡æ—¶ï¼ŒprovidedInçš„é€‰é¡¹é»˜è®¤éƒ½æ˜¯rootï¼Œæœ‰çš„å°ä¼™ä¼´å°±ä¼šé—®äº†ï¼Œè¿™ä¸ªprovidedInæ˜¯åšä»€ä¹ˆçš„ï¼Œé™¤äº† root è¿˜èƒ½å¡«å…¶ä»–å€¼å˜› ğŸ¤”ã€‚ æŸ¥é˜…angular(v15)æ–‡æ¡£ï¼Œå‘ç°providedInæ€»å…±æœ‰ 5 ç§å€¼ rootï¼šåœ¨å¤§å¤šæ•°åº”ç”¨ç¨‹åºä¸­æ˜¯æŒ‡åº”ç”¨ç¨‹åºçº§æ³¨å…¥å™¨ã€‚ anyï¼šåœ¨æ¯ä¸ªæƒ°æ€§åŠ è½½çš„æ¨¡å—ä¸­æä¾›ä¸€ä¸ªå”¯ä¸€å®ä¾‹ï¼Œè€Œæ‰€æœ‰çƒ­åˆ‡åŠ è½½çš„æ¨¡å—å…±äº«ä¸€ä¸ªå®ä¾‹ã€‚ nullï¼šç­‰æ•ˆäº undefined ã€‚å¯æ³¨å…¥ç‰©ä¸ä¼šåœ¨ä»»ä½•èŒƒå›´å†…è‡ªåŠ¨æä¾›ï¼Œå¿…é¡»æ·»åŠ åˆ°@NgModule ã€ @Componentæˆ–@Directiveçš„ providers æ•°ç»„ä¸­ã€‚ platformï¼šç”±é¡µé¢ä¸Šæ‰€æœ‰åº”ç”¨ç¨‹åºå…±äº«çš„ç‰¹æ®Šå•ä¾‹å¹³å°æ³¨å…¥å™¨ã€‚ Type&lt;any&gt; - å°†å¯æ³¨å…¥ç‰©ä¸ @NgModule æˆ–å…¶ä»– InjectorType ç›¸å…³è”ã€‚æ­¤é€‰é¡¹å·²å¼ƒç”¨ã€‚ angular å®˜ç½‘çš„æ–‡æ¡£ä¸€å¦‚æ—¢å¾€çš„ä¸ç»™åŠ› ğŸ˜³ï¼Œåªæœ‰é€‰é¡¹ï¼Œå¹¶æ²¡æœ‰ç¤ºä¾‹è¯´æ˜ï¼Œä¸‹é¢æˆ‘ä»¬é€šè¿‡å‡ ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œæ¥çœ‹çœ‹è¿™å‡ ä¸ªé€‰é¡¹å…·ä½“çš„è¡¨ç° ğŸ˜ rootprovidedIn æœ€å¸¸è§çš„å°±æ˜¯ rootï¼Œå› ä¸ºæœåŠ¡åˆ›å»ºæ—¶ï¼Œé»˜è®¤å€¼éƒ½æ˜¯ rootï¼Œ root å°±æ˜¯åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œæ‰€æœ‰æ³¨å…¥è¿™ä¸ªæœåŠ¡çš„ç»„ä»¶ï¼Œéƒ½ä¼šå…±äº«è¿™ä¸ªå®ä¾‹ã€‚åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨å®ƒå»åšç»„ä»¶é—´çš„ä¼ å€¼ï¼Œæˆ–è€…åšå…¨å±€çš„ä¼ å€¼ã€‚ æˆ‘ä»¬æŒ‰ç…§ä¸‹é¢æ­¥éª¤ï¼Œåˆ›å»ºä¸€ä¸ªç¤ºä¾‹ åˆ›å»º 2 ä¸ª moduleï¼Œ åˆ†åˆ«å‘½åä¸º root-firstã€root-secondï¼Œå¹¶ä¸”ä½¿ç”¨è·¯ç”±æ‡’åŠ è½½ åˆ›å»ºrootService, providedInä¸º root, åˆ›å»ºå˜é‡count ç»™ 2 ä¸ª moudlue ä¸­çš„ component éƒ½å¼•å…¥rootService, æ˜¾ç¤ºå˜é‡countï¼Œå¹¶ä¸”æ·»åŠ +æŒ‰é’®ä½¿count + 1 import &#123; Component, NgModule &#125; from &quot;@angular/core&quot;;import &#123; BrowserModule &#125; from &quot;@angular/platform-browser&quot;;import &#123; RouterModule &#125; from &quot;@angular/router&quot;;import &#123; Injectable &#125; from &quot;@angular/core&quot;;@Injectable(&#123; providedIn: &quot;root&quot;,&#125;)export class RootService &#123; count = 0; constructor() &#123;&#125;&#125;// ç¬¬ä¸€ä¸ªmodule@Component(&#123; selector: &quot;root-first&quot;, template: ` &lt;div&gt; root-first: &#123;&#123; service.count &#125;&#125; &lt;button (click)=&quot;service.count = service.count + 1&quot;&gt;+&lt;/button&gt; &lt;a [routerLink]=&quot;&#x27;/root-second&#x27;&quot;&gt; second &lt;/a&gt; &lt;/div&gt; `, styles: [&quot;&quot;],&#125;)export class RootFirstComponent &#123; constructor(public service: RootService) &#123;&#125;&#125;@NgModule(&#123; imports: [ RouterModule, RouterModule.forChild([ &#123; path: &quot;&quot;, component: RootFirstComponent, &#125;, ]), ], declarations: [RootFirstComponent],&#125;)export class RootFirstModule &#123;&#125;// ç¬¬äºŒä¸ªmodule@Component(&#123; selector: &quot;root-second&quot;, template: ` &lt;div&gt; root-second: &#123;&#123; service.count &#125;&#125; &lt;button (click)=&quot;service.count = service.count + 1&quot;&gt;+&lt;/button&gt; &lt;a [routerLink]=&quot;&#x27;/root-first&#x27;&quot;&gt; first &lt;/a&gt; &lt;/div&gt; `, styles: [&quot;&quot;],&#125;)export class RootSecondComponent &#123; constructor(public service: RootService) &#123;&#125;&#125;@NgModule(&#123; imports: [ RouterModule, RouterModule.forChild([ &#123; path: &quot;&quot;, component: RootSecondComponent, &#125;, ]), ], declarations: [RootSecondComponent],&#125;)export class RootSecondModule &#123;&#125;// app component, app module@Component(&#123; selector: &quot;app-root&quot;, template: ` &lt;router-outlet&gt;&lt;/router-outlet&gt; `, styles: [``],&#125;)export class AppComponent &#123;&#125;@NgModule(&#123; declarations: [AppComponent], imports: [ BrowserModule, RouterModule, RouterModule.forRoot([ &#123; path: &quot;root-first&quot;, loadChildren: () =&gt; import(&quot;./app.module&quot;).then((val) =&gt; val.RootFirstModule), &#125;, &#123; path: &quot;root-second&quot;, loadChildren: () =&gt; import(&quot;./app.module&quot;).then((val) =&gt; val.RootSecondModule), &#125;, ]), ], providers: [], bootstrap: [AppComponent],&#125;)export class AppModule &#123;&#125; å¦‚å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ root-first ä¸­æ”¹å˜å˜é‡çš„å€¼ï¼Œåœ¨ root-second ä¸­ä¸€æ ·ä¼šèµ·æ•ˆï¼ŒåŒæ ·åœ¨ root-second ä¸­æ”¹å€¼ï¼Œroot-first ä¹Ÿä¼šç”Ÿæ•ˆã€‚ anyæ¯ä¸ªæ‡’åŠ è½½çš„æ¨¡å—ä¸­ä¼šåˆ†åˆ«å…±äº«ä¸€ä¸ªå®ä¾‹ï¼Œè€Œæ‰€æœ‰éæ‡’åŠ è½½çš„æ¨¡å—å…±äº«ä¸€ä¸ªå®ä¾‹ ä»€ä¹ˆæ„æ€å‘¢ï¼ŒåŒæ ·æ˜¯ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬æŠŠ service ä¸­çš„providedInæ”¹ä¸ºanyï¼Œè¿™ä¸ªæ—¶å€™ï¼Œåœ¨ root-first ä¸­æ”¹å˜å€¼ï¼Œroot-second ä¸­çš„å€¼å°±ä¸ä¼šå˜åŒ–äº† @Injectable(&#123; providedIn: &quot;any&quot;,&#125;)export class RootService &#123; count = 0; constructor() &#123;&#125;&#125; è¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬æŠŠ root-first æ”¹ä¸ºæ€¥æ€§åŠ è½½ï¼Œå¹¶åœ¨ app.component ä¸­ä¹Ÿæ³¨å…¥ root.service import &#123; Component, NgModule &#125; from &quot;@angular/core&quot;;import &#123; BrowserModule &#125; from &quot;@angular/platform-browser&quot;;import &#123; RouterModule &#125; from &quot;@angular/router&quot;;import &#123; Injectable &#125; from &quot;@angular/core&quot;;@Injectable(&#123; providedIn: &quot;any&quot;,&#125;)export class RootService &#123; count = 0; constructor() &#123;&#125;&#125;// ç¬¬ä¸€ä¸ªmodule@Component(&#123; selector: &quot;root-first&quot;, template: ` &lt;div&gt; root-first: &#123;&#123; service.count &#125;&#125; &lt;button (click)=&quot;service.count = service.count + 1&quot;&gt;+&lt;/button&gt; &lt;a [routerLink]=&quot;&#x27;/root-second&#x27;&quot;&gt; second &lt;/a&gt; &lt;/div&gt; `, styles: [&quot;&quot;],&#125;)export class RootFirstComponent &#123; constructor(public service: RootService) &#123;&#125;&#125;@NgModule(&#123; imports: [ RouterModule, RouterModule.forChild([ &#123; path: &quot;root-first&quot;, component: RootFirstComponent, &#125;, ]), ], declarations: [RootFirstComponent],&#125;)export class RootFirstModule &#123;&#125;// ç¬¬äºŒä¸ªmodule@Component(&#123; selector: &quot;root-second&quot;, template: ` &lt;div&gt; root-second: &#123;&#123; service.count &#125;&#125; &lt;button (click)=&quot;service.count = service.count + 1&quot;&gt;+&lt;/button&gt; &lt;a [routerLink]=&quot;&#x27;/root-first&#x27;&quot;&gt; first &lt;/a&gt; &lt;/div&gt; `, styles: [&quot;&quot;],&#125;)export class RootSecondComponent &#123; constructor(public service: RootService) &#123;&#125;&#125;@NgModule(&#123; imports: [ RouterModule, RouterModule.forChild([ &#123; path: &quot;&quot;, component: RootSecondComponent, &#125;, ]), ], declarations: [RootSecondComponent],&#125;)export class RootSecondModule &#123;&#125;// app component, app module@Component(&#123; selector: &quot;app-root&quot;, template: ` app header: &#123;&#123; service.count &#125;&#125; &lt;button (click)=&quot;service.count = service.count + 1&quot;&gt;+&lt;/button&gt; &lt;router-outlet&gt;&lt;/router-outlet&gt; `, styles: [``],&#125;)export class AppComponent &#123; constructor(public service: RootService) &#123;&#125;&#125;@NgModule(&#123; declarations: [AppComponent], imports: [ BrowserModule, RouterModule, RootFirstModule, RouterModule.forRoot([ // &#123; // path: &#x27;root-first&#x27;, // loadChildren: () =&gt; // import(&#x27;./app.module&#x27;).then((val) =&gt; val.RootFirstModule), // &#125;, &#123; path: &quot;root-second&quot;, loadChildren: () =&gt; import(&quot;./app.module&quot;).then((val) =&gt; val.RootSecondModule), &#125;, ]), ], providers: [], bootstrap: [AppComponent],&#125;)export class AppModule &#123;&#125; è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å‘ç°ï¼Œåœ¨ app.component å’Œ root-first ä¸­ count æ˜¯å…±äº«çš„ ğŸ¤“ï¼Œä½†æ˜¯ root-second ä¸­çš„ count æ˜¯ä¸ä¸ä»–ä»¬å…±äº«çš„, è¿™æ˜¯å› ä¸º root-second æ˜¯æ‡’åŠ è½½çš„ï¼Œè€Œå…¶ä»–çš„åˆ™æ˜¯æ€¥æ€§åŠ è½½æ‰€ä»¥ä»–ä»¬ä¼šå…±äº«æ•°æ® nullå¦‚æœæˆ‘ä»¬æŠŠprovidedInè®¾ä¸º null æˆ–è€…ä¸å¡«ï¼Œé‚£ä¹ˆæ­¤æ—¶ï¼Œå°±éœ€è¦åœ¨ module ä¸­çš„ providers æ³¨å…¥è¿™ä¸ªæœåŠ¡ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ ğŸ˜² @Injectable(&#123; providedIn: null,&#125;)export class RootService &#123; count = 0; constructor() &#123;&#125;&#125; æ­¤æ—¶æˆ‘ä»¬åœ¨æ‰€æœ‰ç”¨åˆ° root.service æœåŠ¡çš„ module ä¸­å…¨éƒ¨æ³¨å…¥ service, å®ƒçš„è¡¨ç°å½¢å¼å’Œ any ä¸€æ ·ï¼Œå³åœ¨æ¯ä¸ªæ‡’åŠ è½½çš„æ¨¡å—ä¸­ä¼šåˆ†åˆ«å…±äº«ä¸€ä¸ªå®ä¾‹ï¼Œè€Œæ‰€æœ‰éæ‡’åŠ è½½çš„æ¨¡å—å…±äº«ä¸€ä¸ªå®ä¾‹ import &#123; Component, NgModule &#125; from &quot;@angular/core&quot;;import &#123; BrowserModule &#125; from &quot;@angular/platform-browser&quot;;import &#123; RouterModule &#125; from &quot;@angular/router&quot;;import &#123; Injectable &#125; from &quot;@angular/core&quot;;@Injectable(&#123; providedIn: null,&#125;)export class RootService &#123; count = 0; constructor() &#123;&#125;&#125;// ç¬¬ä¸€ä¸ªmodule@Component(&#123; selector: &quot;root-first&quot;, template: ` &lt;div&gt; root-first: &#123;&#123; service.count &#125;&#125; &lt;button (click)=&quot;service.count = service.count + 1&quot;&gt;+&lt;/button&gt; &lt;a [routerLink]=&quot;&#x27;/root-second&#x27;&quot;&gt; second &lt;/a&gt; &lt;/div&gt; `, styles: [&quot;&quot;],&#125;)export class RootFirstComponent &#123; constructor(public service: RootService) &#123;&#125;&#125;@NgModule(&#123; imports: [ RouterModule, RouterModule.forChild([ &#123; path: &quot;root-first&quot;, component: RootFirstComponent, &#125;, ]), ], declarations: [RootFirstComponent], // æ³¨å…¥æœåŠ¡ providers: [RootService],&#125;)export class RootFirstModule &#123;&#125;// ç¬¬ä¸€ä¸ªmodule@Component(&#123; selector: &quot;&quot;, template: ` &lt;div&gt; root-second: &#123;&#123; service.count &#125;&#125; &lt;button (click)=&quot;service.count = service.count + 1&quot;&gt;+&lt;/button&gt; &lt;a [routerLink]=&quot;&#x27;/root-first&#x27;&quot;&gt; first &lt;/a&gt; &lt;/div&gt; `, styles: [&quot;&quot;],&#125;)export class RootSecondComponent &#123; constructor(public service: RootService) &#123;&#125;&#125;@NgModule(&#123; imports: [ RouterModule, RouterModule.forChild([ &#123; path: &quot;&quot;, component: RootSecondComponent, &#125;, ]), ], declarations: [RootSecondComponent], // æ³¨å…¥æœåŠ¡ providers: [RootService],&#125;)export class RootSecondModule &#123;&#125;// app component, app module@Component(&#123; selector: &quot;app-root&quot;, template: ` app header: &#123;&#123; service.count &#125;&#125; &lt;button (click)=&quot;service.count = service.count + 1&quot;&gt;+&lt;/button&gt; &lt;router-outlet&gt;&lt;/router-outlet&gt; `, styles: [``],&#125;)export class AppComponent &#123; constructor(public service: RootService) &#123;&#125;&#125;@NgModule(&#123; declarations: [AppComponent], imports: [ BrowserModule, RouterModule, RootFirstModule, // RootSecondModule, RouterModule.forRoot([ &#123; path: &quot;root-first&quot;, loadChildren: () =&gt; import(&quot;./app.module&quot;).then((val) =&gt; val.RootFirstModule), &#125;, &#123; path: &quot;root-second&quot;, loadChildren: () =&gt; import(&quot;./app.module&quot;).then((val) =&gt; val.RootSecondModule), &#125;, ]), ], // æ³¨å…¥æœåŠ¡ providers: [RootService], bootstrap: [AppComponent],&#125;)export class AppModule &#123;&#125; platformé¡µé¢ä¸Šæ‰€æœ‰åº”ç”¨ç¨‹åºå…±äº«çš„å¹³å°æ³¨å…¥å™¨çš„ç‰¹æ®Šå•ä¾‹ã€‚ åˆ›å»º appMoudle2 // ç¬¬äºŒä¸ªæ ¹æ¨¡å—@Component(&#123; selector: &quot;app-root2&quot;, template: ` app-root2 header: &#123;&#123; service.count &#125;&#125; &lt;button (click)=&quot;service.count = service.count + 1&quot;&gt;+&lt;/button&gt; `, styles: [``],&#125;)export class AppComponent2 &#123; constructor(public service: RootService) &#123;&#125;&#125;@NgModule(&#123; declarations: [AppComponent2], imports: [BrowserModule, RouterModule], bootstrap: [AppComponent2],&#125;)export class AppModule2 &#123;&#125; åŒæ—¶åœ¨main.tsä¸­å¼•å…¥ import &#123; platformBrowserDynamic &#125; from &quot;@angular/platform-browser-dynamic&quot;;import &#123; AppModule, AppModule2 &#125; from &quot;./app/app.module&quot;;platformBrowserDynamic() .bootstrapModule(AppModule) .catch((err) =&gt; console.error(err));platformBrowserDynamic() .bootstrapModule(AppModule2) .catch((err) =&gt; console.error(err)); åœ¨index.htmlä¸­å¼•å…¥app-root2 &lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot; /&gt; &lt;title&gt;AngularService&lt;/title&gt; &lt;base href=&quot;/&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt; &lt;link rel=&quot;icon&quot; type=&quot;image/x-icon&quot; href=&quot;favicon.ico&quot; /&gt; &lt;/head&gt; &lt;body&gt; &lt;app-root&gt;&lt;/app-root&gt; &lt;hr /&gt; &lt;app-root2&gt;&lt;/app-root2&gt; &lt;/body&gt;&lt;/html&gt; ç„¶åæˆ‘ä»¬æŠŠ root.service çš„providedInè®¾ä¸ºplatform @Injectable(&#123; providedIn: &quot;platform&quot;,&#125;)export class RootService &#123; count = 0; constructor() &#123;&#125;&#125; è¿™æ—¶ï¼Œæˆ‘ä»¬å‘ç°è™½ç„¶æ˜¯ 2 ä¸ªæ ¹æ¨¡å—ï¼Œä½†æ˜¯æ•°æ®è¿˜æ˜¯å…±äº«äº†ï¼ˆæ²¡æœ‰å®æ—¶åˆ·æ–°çš„åŸå› ï¼Œæ˜¯å› ä¸ºåˆ†å±ä¸åŒæ ¹æ¨¡å—ï¼Œæ²¡æœ‰è§¦å‘è„æ£€æŸ¥ï¼‰ ngModuleåœ¨è¿™é‡Œæˆ‘ä»¬æ–°åˆ›å»ºä¸€ä¸ª ngModuleï¼Œå‘½åä¸ºRootChildModule, æœåŠ¡çš„providedInæˆ‘ä»¬è®¾ç½®RootChildModule,å¹¶ä¸”åœ¨app.moduleä¸­å¼•å…¥RootChildModule @NgModule()export class RootChildModule &#123;&#125;@Injectable(&#123; providedIn: RootChildModule,&#125;)export class RootService &#123; count = 0; constructor() &#123; console.log(&quot;--lucky---&quot;); &#125;&#125;@NgModule(&#123; declarations: [AppComponent], imports: [ BrowserModule, RouterModule, RootChildModule, RouterModule.forRoot([ &#123; path: &quot;root-first&quot;, loadChildren: () =&gt; import(&quot;./app.module&quot;).then((val) =&gt; val.RootFirstModule), &#125;, &#123; path: &quot;root-second&quot;, loadChildren: () =&gt; import(&quot;./app.module&quot;).then((val) =&gt; val.RootSecondModule), &#125;, ]), ], bootstrap: [AppComponent],&#125;)export class AppModule &#123;&#125; æ­¤æ—¶çš„æ•ˆæœä¸rootç›¸åŒï¼Œä¸åŒä¹‹å¤„åœ¨äºï¼Œåªæœ‰åœ¨ component ä¸­å¼•å…¥ root.serviceï¼Œè¯¥æœåŠ¡çš„ä»£ç æ‰ä¼šè¢«æ‰“åŒ…è¿›å»ï¼Œå¦åˆ™ä»£ç å°†ä¼šè¢«æ‘‡æ ‘ä¼˜åŒ–ã€‚ ä¸ºäº†éªŒè¯æ­¤åŠŸèƒ½ï¼Œæˆ‘ä»¬æŠŠ root.service ç§»å‡ºï¼Œæ–°å»º/child/root.service æ–‡ä»¶ import &#123; Injectable &#125; from &quot;@angular/core&quot;;import &#123; RootChildModule &#125; from &quot;./root-child.module&quot;;@Injectable(&#123; providedIn: RootChildModule,&#125;)export class RootService &#123; count = 0; constructor() &#123; console.log(&quot;--lucky---&quot;); &#125;&#125; åŒæ—¶æ–°å»º/child/root-child.module æ¥ç»™ providedIn æä¾›å€¼ import &#123; NgModule &#125; from &quot;@angular/core&quot;;@NgModule()export class RootChildModule &#123;&#125; ç„¶åä¿®æ”¹ä¸€ä¸‹app.moduleçš„ä»£ç  import &#123; Component, NgModule &#125; from &quot;@angular/core&quot;;import &#123; BrowserModule &#125; from &quot;@angular/platform-browser&quot;;import &#123; RouterModule &#125; from &quot;@angular/router&quot;;import &#123; RootChildModule &#125; from &quot;./child/root-child.module&quot;;// ç¬¬ä¸€ä¸ªæ¨¡å—@Component(&#123; selector: &quot;root-first&quot;, template: ` &lt;div&gt;root-first&lt;/div&gt; `, styles: [&quot;&quot;],&#125;)export class RootFirstComponent &#123; constructor() &#123;&#125;&#125;@NgModule(&#123; imports: [ RouterModule, RootChildModule, RouterModule.forChild([ &#123; path: &quot;&quot;, component: RootFirstComponent, &#125;, ]), ], declarations: [RootFirstComponent],&#125;)export class RootFirstModule &#123;&#125;// app component, app module@Component(&#123; selector: &quot;app-root&quot;, template: ` app header &lt;router-outlet&gt;&lt;/router-outlet&gt; `, styles: [``],&#125;)export class AppComponent &#123; constructor() &#123;&#125;&#125;@NgModule(&#123; declarations: [AppComponent], imports: [ BrowserModule, RouterModule, RouterModule.forRoot([ &#123; path: &quot;root-first&quot;, loadChildren: () =&gt; import(&quot;./app.module&quot;).then((val) =&gt; val.RootFirstModule), &#125;, ]), ], bootstrap: [AppComponent],&#125;)export class AppModule &#123;&#125; æ³¨æ„ï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹æ³¨å…¥root.service, æ­¤æ—¶æˆ‘ä»¬åœ¨æµè§ˆå™¨ network ä¸­æœç´¢ root.service ä¸­çš„ä»£ç  ç»“æœå¯çŸ¥ï¼Œä»£ç æ²¡æœ‰æ‰“åŒ…è¿›å» æ­¤æ—¶ï¼Œæˆ‘ä»¬åœ¨RootFirstComponentä¸­æ³¨å…¥root.service import &#123; RootService &#125; from &quot;./child/root.service&quot;;// ç¬¬ä¸€ä¸ªæ¨¡å—@Component(&#123; selector: &quot;root-first&quot;, template: ` &lt;div&gt;root-first&lt;/div&gt; `, styles: [&quot;&quot;],&#125;)export class RootFirstComponent &#123; constructor(public rootService: RootService) &#123;&#125;&#125; æ­¤æ—¶ï¼Œå†å» network ä¸­æœç´¢ï¼Œå‘ç°å·²æœ‰ä»£ç  æˆ‘ä»¬å†åˆ é™¤RootFirstComponentä¸­å·²æ³¨å…¥çš„root.serviceï¼Œå¹¶ä¸”æŠŠprovidedInçš„å€¼æ”¹ä¸ºnullï¼Œå¹¶ä¸”åœ¨RootFirstModuleé‡Œé¢ç”³æ˜RootService import &#123; Injectable &#125; from &quot;@angular/core&quot;;import &#123; RootChildModule &#125; from &quot;./root-child.module&quot;;@Injectable(&#123; providedIn: null,&#125;)export class RootService &#123; count = 0; constructor() &#123; console.log(&quot;--lucky---&quot;); &#125;&#125; import &#123; RootService &#125; from &quot;./child/root.service&quot;;// ç¬¬ä¸€ä¸ªæ¨¡å—@Component(&#123; selector: &quot;root-first&quot;, template: ` &lt;div&gt;root-first&lt;/div&gt; `, styles: [&quot;&quot;],&#125;)export class RootFirstComponent &#123; constructor() &#123;&#125;&#125;@NgModule(&#123; imports: [ RouterModule, RootChildModule, RouterModule.forChild([ &#123; path: &quot;&quot;, component: RootFirstComponent, &#125;, ]), ], providers: [RootService], declarations: [RootFirstComponent],&#125;)export class RootFirstModule &#123;&#125; æ­¤æ—¶æœç´¢ network, è™½ç„¶å·²ç»åˆ é™¤äº†æ³¨å…¥éƒ¨åˆ†çš„ä»£ç ï¼Œä½†æ˜¯ root.service ä¸­çš„ä»£ç ä¾ç„¶èƒ½æœç´¢åˆ° è¿™é‡Œï¼Œæˆ‘ä»¬ä¸ç”¨providedInï¼šrootä¸¾ä¾‹çš„åŸå› æ˜¯ï¼ŒæœåŠ¡çš„ providedIn ä¸º root æ—¶ï¼Œä¸ç”¨å£°æ˜ï¼Œä¹Ÿèƒ½ä½¿ç”¨ï¼Œæ‰€ä»¥è‡ªç„¶ä»£ç ä¹Ÿä¼šè¢«æ‘‡æ ‘ä¼˜åŒ–æ‰ï¼Œæˆ‘æƒ³è¿™ä¹Ÿæ˜¯ ngModuleè¿™ä¸ªé€‰é¡¹è¢«å¼ƒç”¨çš„åŸå› ã€‚ æ€»ç»“å®é™…ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¯”è¾ƒå¤šçš„åªæœ‰rootå’Œnullï¼Œ rootåŒæ—¶å…·å¤‡æ‘‡æ ‘ä¼˜åŒ–çš„èƒ½åŠ›ï¼Œä½†æ˜¯ä»–ä¼šåœ¨å…¨å±€å…±äº«æ•°æ®ï¼Œå¹¶ä¸”æ²¡æœ‰é™åˆ¶ï¼Œä»»æ„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨ nullå¯ä»¥æ ¹æ®æƒ…å†µï¼Œåœ¨éœ€è¦çš„æ—¶å€™ä½¿ç”¨providersæ³¨å…¥ä½¿ç”¨ï¼Œå¹¶ä¸”ä¼šåŒºåˆ†æ‡’åŠ è½½å’Œæ€¥æ€§åŠ è½½ platformè™½ç„¶æœ‰å®é™…çš„åº”ç”¨åœºæ™¯ï¼Œä½†æ˜¯ä½¿ç”¨æ¯”è¾ƒå°‘ï¼Œè€Œanyå’ŒngModuleéƒ½å¯ä»¥è¢«anyå’Œrootå–ä»£ æºç angular-injectable-providedIn","updated":"2025-08-02T05:46:04.182Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"angular","slug":"angular","permalink":"https://luckyship.github.io/tags/angular/"}]},{"title":"angular form è‡ªå®šä¹‰ç»„ä»¶","date":"2024-04-10T09:31:25.000Z","path":"2024/04/10/2024-04-10-angular-custom-form/","text":"angular è¡¨å•é‡Œé¢éœ€è¦ä½¿ç”¨ è‡ªå®šä¹‰ç»„ä»¶æ—¶ï¼Œæƒ³è¦æ–¹ä¾¿çš„ä½¿ç”¨formGroupçš„formControlNameï¼Œéœ€è¦è‡ªå®šä¹‰ç»„ä»¶çš„formControlNameå±æ€§ï¼Œå¦‚ä½•å»è‡ªå®šä¹‰ç»„ä»¶çš„formControlNameå±æ€§å‘¢ï¼Ÿ å¼•å…¥ControlValueAccessor æ¥å£ControlValueAccessor æ¥å£æ˜¯angular è¡¨å•ç»„ä»¶çš„formControlNameå±æ€§çš„ä¾èµ–æ³¨å…¥ï¼ŒControlValueAccessor æ¥å£éœ€è¦å®ç°registerOnChangeã€registerOnTouchedã€setDisabledStateã€writeValueæ–¹æ³•ï¼Œæˆ‘ä»¬è¿™é‡Œä¸éœ€è¦ç”¨åˆ°è¡¨å•çš„disabledå±æ€§ï¼Œæ‰€ä»¥å¯ä»¥å¿½ç•¥setDisabledState æˆ‘ä»¬æ–°å»ºinput-numberç»„ä»¶å¼•å…¥NG_VALUE_ACCESSOR, å¹¶å†™å‡ºå¯¹åº”çš„registerOnChangeã€registerOnTouchedã€writeValueæ–¹æ³• import &#123; Component, OnInit, forwardRef &#125; from &#x27;@angular/core&#x27;;import &#123; NG_VALUE_ACCESSOR &#125; from &#x27;@angular/forms&#x27;;@Component(&#123; selector: &#x27;app-input-number&#x27;, template: ` &lt;div&gt; &lt;span&gt;&#123;&#123; count &#125;&#125;&lt;/span&gt; &lt;/div&gt; `, styleUrls: [&#x27;./input-number.component.css&#x27;], providers: [ &#123; provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() =&gt; InputNumberComponent), multi: true, &#125;, ],&#125;)export class InputNumberComponent implements OnInit &#123; /** * formControlNameå¯¹åº”çš„è¡¨å•å€¼ä¼šåœ¨æ­¤ä¼ å…¥ */ writeValue(value: any) &#123; if (value) &#123; this.count = value; &#125; &#125; /** * formè¡¨å•çš„æ›´æ–°å‡½æ•°ä¼šåœ¨æ­¤ä¼ å…¥ï¼Œéœ€è¦è°ƒç”¨æ­¤å‡½æ•°æ›´æ–°è¡¨å•çš„å€¼ */ registerOnChange(fn: any) &#123;&#125; registerOnTouched(fn: any) &#123;&#125;&#125; å®šä¹‰ updateValue å‡½æ•°æ–°å»º updateValueå‡½æ•°ï¼Œå¹¶ä¸”åœ¨incrementã€decrementã€writeValueå‡½æ•°ä¸­è°ƒç”¨updateValueå‡½æ•°ï¼Œæ›´æ–°è¡¨å•çš„å€¼è¯¥ç»„ä»¶æ˜¾ç¤ºæ•°å­—ï¼Œå¹¶ä¸”å¯ä»¥ç‚¹å‡»å¢åŠ å’Œå‡å°‘æŒ‰é’® import &#123; Component, OnInit, forwardRef &#125; from &#x27;@angular/core&#x27;;import &#123; NG_VALUE_ACCESSOR &#125; from &#x27;@angular/forms&#x27;;@Component(&#123; selector: &#x27;app-input-number&#x27;, template: ` &lt;div&gt; &lt;button (click)=&quot;decrement()&quot;&gt;-&lt;/button&gt; &lt;span&gt;&#123;&#123; count &#125;&#125;&lt;/span&gt; &lt;button (click)=&quot;increment()&quot;&gt;+&lt;/button&gt; &lt;/div&gt; `, styleUrls: [&#x27;./input-number.component.css&#x27;], providers: [ &#123; provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() =&gt; InputNumberComponent), multi: true, &#125;, ],&#125;)export class InputNumberComponent implements OnInit &#123; /** * formControlNameå¯¹åº”çš„è¡¨å•å€¼ä¼šåœ¨æ­¤ä¼ å…¥ */ writeValue(value: any) &#123; if (value) &#123; this.count = value; this.updateValue(this.count); &#125; &#125; updateValue: (value: any) =&gt; void = (_: any) =&gt; &#123;&#125;; updateValueByTouched: (value: any) =&gt; void = (_: any) =&gt; &#123;&#125;; /** * formè¡¨å•çš„æ›´æ–°å‡½æ•°ä¼šåœ¨æ­¤ä¼ å…¥ï¼Œéœ€è¦è°ƒç”¨æ­¤å‡½æ•°æ›´æ–°è¡¨å•çš„å€¼ */ registerOnChange(fn: any) &#123; this.updateValue = fn; &#125; registerOnTouched(fn: any) &#123; this.updateValueByTouched = fn; &#125; increment() &#123; this.count++; this.updateValue(this.count); &#125; decrement() &#123; this.count--; this.updateValue(this.count); &#125;&#125; ä¸ºäº†ä¸åœ¨æ¯æ¬¡æ›´æ–°countå€¼çš„æ—¶å€™ï¼Œéƒ½å»æ‰‹åŠ¨è°ƒç”¨updateValueå‡½æ•°,æˆ‘ä»¬æ›´æ–°ä¸€ä¸‹æ•°æ®ç»“æ„ï¼Œè®©å…¶åœ¨ count å€¼æ”¹å˜æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨updateValueå‡½æ•° import &#123; Component, OnInit, forwardRef &#125; from &#x27;@angular/core&#x27;;import &#123; NG_VALUE_ACCESSOR &#125; from &#x27;@angular/forms&#x27;;@Component(&#123; selector: &#x27;app-input-number&#x27;, template: ` &lt;div&gt; &lt;button (click)=&quot;decrement()&quot;&gt;-&lt;/button&gt; &lt;span&gt;&#123;&#123; count &#125;&#125;&lt;/span&gt; &lt;button (click)=&quot;increment()&quot;&gt;+&lt;/button&gt; &lt;/div&gt; `, styleUrls: [&#x27;./input-number.component.css&#x27;], providers: [ &#123; provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() =&gt; InputNumberComponent), multi: true, &#125;, ],&#125;)export class InputNumberComponent implements OnInit &#123; _count: number = 0; get count() &#123; return this._count; &#125; set count(value: number) &#123; this._count = value; this.updateValue(this._count); &#125; constructor() &#123;&#125; ngOnInit() &#123;&#125; writeValue(value: any) &#123; if (value) &#123; this.count = value; &#125; &#125; updateValue: (value: any) =&gt; void = (_: any) =&gt; &#123;&#125;; updateValueByTouched: (value: any) =&gt; void = (_: any) =&gt; &#123;&#125;; registerOnChange(fn: any) &#123; this.updateValue = fn; &#125; registerOnTouched(fn: any) &#123; this.updateValueByTouched = fn; &#125; increment() &#123; this.count++; &#125; decrement() &#123; this.count--; &#125;&#125; è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å†™å¥½äº†è‡ªå®šä¹‰çš„ form ç»„ä»¶ ä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶å“åº”å¼è¡¨å•ä¸‹é¢æˆ‘ä»¬åœ¨ form è¡¨å•é‡Œå¼•å…¥è‡ªå®šä¹‰ç»„ä»¶ï¼Œè¯•è¯•çœ‹æ•ˆæœ import &#123; Component &#125; from &#x27;@angular/core&#x27;;import &#123; FormBuilder &#125; from &#x27;@angular/forms&#x27;;@Component(&#123; selector: &#x27;app-root&#x27;, template: ` &lt;div&gt; &lt;form [formGroup]=&quot;numberForm&quot;&gt; &lt;app-input-number formControlName=&quot;count&quot;&gt;&lt;/app-input-number&gt; &lt;div&gt;&#123;&#123; numberForm.get(&#x27;count&#x27;)?.value &#125;&#125;&lt;/div&gt; &lt;/form&gt; &lt;/div&gt; `, styleUrls: [&#x27;./app.component.css&#x27;],&#125;)export class AppComponent &#123; numberForm = this.fb.group(&#123; count: 5, // è®¾ç½®åˆå§‹å€¼ &#125;); constructor(private fb: FormBuilder) &#123;&#125;&#125; æˆ‘ä»¬åœ¨ç»„ä»¶ä¸‹é¢æ˜¾ç¤ºå‡ºå¯¹åº”çš„ form çš„è¡¨å•å€¼ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„è‡ªå®šä¹‰ç»„ä»¶input-numberå·²ç»ç”Ÿæ•ˆäº† æ¨¡æ¿é©±åŠ¨å¼è¡¨å•ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬æ˜¯ä½¿ç”¨ formControlNameï¼Œ ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨ngModelåŒæ ·å¯ä»¥ import &#123; Component &#125; from &#x27;@angular/core&#x27;;import &#123; FormBuilder &#125; from &#x27;@angular/forms&#x27;;@Component(&#123; selector: &#x27;app-root&#x27;, template: ` &lt;div&gt; &lt;app-input-number [(ngModel)]=&quot;count&quot;&gt;&lt;/app-input-number&gt; &lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt; &lt;/div&gt; `, styleUrls: [&#x27;./app.component.css&#x27;],&#125;)export class AppComponent &#123; count = 5; constructor(private fb: FormBuilder) &#123;&#125;&#125; æºç angular-custom-form-example","updated":"2025-08-02T05:46:04.182Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"angular","slug":"angular","permalink":"https://luckyship.github.io/tags/angular/"}]},{"title":"unicodeä¸­æ–‡å­—èŠ‚ä¸ºä»€ä¹ˆæœ‰çš„å 2ä¸ªæœ‰çš„å 3ä¸ª","date":"2023-12-11T08:16:50.000Z","path":"2023/12/11/2023-12-11-unicode/","text":"æœ¬æ–‡ä¸ºæ˜é‡‘æ–‡ç« è½¬è½½ èƒŒæ™¯ä¸Šå‘¨åœ¨è¯„å®¡æµ‹è¯•ç”¨ä¾‹æ—¶ï¼Œæœ‰ä¸€ä¸ªè¥é”€è¯æœ¯çš„æ¥å£å­—æ®µï¼Œä¸šåŠ¡ä¸Šè¦æ±‚ä¸èƒ½è¶…è¿‡ 200 å­—ï¼Œä¼šä¸Šæœ‰äººé—®ï¼Œåç«¯æ•°æ®è¡¨ä¸­çš„è¿™ä¸ªå­—æ®µï¼Œæœ€å¤šèƒ½å­˜å‚¨å¤šå°‘ä¸ªä¸­æ–‡å­—ç¬¦ï¼Œæœ‰æ²¡æœ‰å¯¹å­˜å‚¨å­—æ•°åšé™åˆ¶ã€‚æˆ‘æ’å…¥äº†ä¸€å¥ï¼Œé‚£è¦çœ‹æ•°æ®è¡¨ä¸­è¿™ä¸ªå­—æ®µå®šä¹‰çš„æ˜¯ä»€ä¹ˆæ•°æ®ç±»å‹ï¼ˆCHARã€VARCHARï¼ŒTEXT ç­‰ï¼‰ï¼Œä¸€ä¸ªä¸­æ–‡å ä¸¤ä¸ªå­—èŠ‚ï¼Œç”¨è¿™ç§æ•°æ®ç±»å‹çš„å­—èŠ‚æ•°é™¤ä»¥ 2ï¼Œå°±æ˜¯èƒ½å­˜å‚¨çš„ä¸­æ–‡å­—ç¬¦æ•°ã€‚ç„¶åå¦ä¸€ä¸ªåŒäº‹è¯´ï¼ŒUTF-8 ç¼–ç ï¼Œä¸€ä¸ªä¸­æ–‡å ç”¨ 3 ä¸ªå­—èŠ‚ã€‚è¿™å¥è¯é¢ è¦†äº†æˆ‘ä¹‹å‰çš„è®¤çŸ¥ï¼Œåœ¨æˆ‘çš„å°è±¡é‡Œï¼Œä¸€ä¸ªä¸­æ–‡å ç”¨ä¸¤ä¸ªå­—èŠ‚ï¼Œæ€ä¹ˆä¼šæ˜¯ä¸‰ä¸ªã€‚æˆ‘å†³å®šæŸ¥ä¸€æŸ¥ï¼Œçœ‹çœ‹è°å¯¹è°é”™ã€‚ ä¸€çŸ³æ¿€èµ·åƒå±‚æµªæœ¬ä»¥ä¸ºæœç´¢ä¸€ä¸‹å°±èƒ½è·å¾—ç­”æ¡ˆï¼Œå¯æ˜¯å‘ç°è¿™ä¸ªçŸ¥è¯†ç‚¹ï¼Œæœ‰äº›æ¸Šæºï¼Œä¸€è¨€éš¾å°½ã€‚è¯´å¾—å¤ªæ¦‚æ‹¬ï¼Œäººéš¾å…è¿˜æ˜¯ä¼šæœ‰ç–‘é—®ã€‚éœ€è¦è¿½æ ¹æº¯æºï¼Œæ‰èƒ½è®²æ¸…æ¥šã€‚åœ¨æŸ¥æ‰¾ç­”æ¡ˆçš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°ç½‘ä¸Šçš„æ–‡ç« è‰¯è ä¸é½ï¼Œå¯¹äºåŒä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼Œä¸åŒçš„æ–‡ç« è¯´æ³•ç›¸äº’çŸ›ç›¾ï¼Œè®©äººæ€ç»´æœ‰äº›å‡Œä¹±ï¼Œå¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘é€‰æ‹©å–è¿™äº›æ–‡ç« çš„äº¤é›†ï¼Œæ‘’å¼ƒçŸ›ç›¾ä¸å†²çªã€‚ ç¼˜èµ· ASCII ç å­—ç¬¦ç¼–ç çš„èµ·æºï¼Œæ˜¯ä¸ºäº†è§£å†³åœ¨è®¡ç®—æœºä¸­å­˜å‚¨ä¸è¡¨è¾¾ç‰¹å®šå­—ç¬¦çš„é—®é¢˜ã€‚æ¯”å¦‚è¯´è‹±æ–‡å­—æ¯ A, å¦‚ä½•è¡¨è¾¾æ‰èƒ½è®©è®¡ç®—æœºèƒ½å¤Ÿè¯†åˆ«ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨è®¡ç®—æœºåº•å±‚åªè¯†åˆ« 0 å’Œ 1ã€‚å½“è®¡ç®—æœºè¦å­˜å‚¨/å±•ç¤ºå­—ç¬¦æ—¶ï¼Œéœ€è¦ä¸€ä¸ªè§„åˆ™ï¼Œåœ¨å­—ç¬¦å’Œ 0/1 åºåˆ—ä¹‹é—´å»ºç«‹æ˜ å°„å…³ç³»ï¼Œè¿™å°±æ˜¯å­—ç¬¦ç¼–ç è§„åˆ™ã€‚ 1945 å¹´ä¸–ç•Œç¬¬ä¸€å°è®¡ç®—æœºè¯ç”Ÿäºç¾å›½ï¼Œæ‰€ä»¥ç¾å›½äººç¬¬ä¸€ä¸ªé‡åˆ°å­—ç¬¦ç¼–ç é—®é¢˜ã€‚è‡ªç„¶è€Œç„¶ç¬¬ä¸€ä¸ªç¼–ç è§„åˆ™ä¹Ÿæ˜¯ç¾å›½äººåˆ¶å®šçš„ã€‚ç¾å›½ä½¿ç”¨çš„æ˜¯è‹±è¯­ï¼Œè‹±è¯­å­—ç¬¦æ•°é‡æ¯”è¾ƒå°‘ï¼Œ26 ä¸ªè‹±æ–‡å­—æ¯+æ•°å­—+æ ‡ç‚¹ç¬¦å·ã€‚ä¸€ä¸ªå­—èŠ‚æ˜¯ 8 ä½ï¼Œå¦‚æœæ¯ä¸€ä¸ªçŠ¶æ€å¯¹åº”ä¸€ä¸ªç‰¹å®šå­—ç¬¦ï¼Œæ¯ä¸ªäºŒè¿›åˆ¶ä½æœ‰0å’Œ1ä¸¤ç§å–å€¼ï¼Œå¯ä»¥ç»„åˆå‡º 256 ä¸ªå­—ç¬¦ï¼Œè¶³å¤Ÿè‹±è¯­è¯­å¢ƒä½¿ç”¨äº†ã€‚æœ€æ—©çš„å­—ç¬¦ç¼–ç æ ‡å‡†å°±è¿™æ ·è¯ç”Ÿäº†ã€‚ç¾å›½äººèµ·è‰äº†è®¡ç®—æœºçš„ç¬¬ä¸€ä»½å­—ç¬¦é›†å’Œç¼–ç æ ‡å‡†ï¼Œå« ASCIIï¼ˆAmerican Standard Code for Information Interchangeâ€“ç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç ï¼‰ï¼Œä¸€å…±è§„å®šäº† 128 ä¸ªå­—ç¬¦åŠå¯¹åº”çš„äºŒè¿›åˆ¶è½¬æ¢å…³ç³»ï¼Œ128 ä¸ªå­—ç¬¦åŒ…æ‹¬äº†å¯æ˜¾ç¤ºçš„ 26 ä¸ªå­—æ¯ï¼ˆå¤§å°å†™ï¼‰ã€10 ä¸ªæ•°å­—ã€æ ‡ç‚¹ç¬¦å·ä»¥åŠç‰¹æ®Šçš„æ§åˆ¶ç¬¦ï¼Œä¹Ÿå°±æ˜¯è‹±è¯­ä¸è¥¿æ¬§è¯­è¨€ä¸­å¸¸è§çš„å­—ç¬¦ã€‚1967 å¹´å®šæ¡ˆï¼Œæœ€åˆæ˜¯ç¾å›½å›½å®¶æ ‡å‡†ï¼Œåæ¥è¢«å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ ISO(International Organization for Standardization)å®šä¸ºå›½é™…æ ‡å‡†ï¼Œç§°ä¸º ISO 646 æ ‡å‡†ï¼Œé€‚ç”¨äºæ‰€æœ‰æ‹‰ä¸æ–‡å­—å­—æ¯ã€‚ å„å›½è¡ç”Ÿè‡ªå·±çš„ç¼–ç è®¡ç®—æœºåœ¨ä¸–ç•Œæ™®åŠä¹‹åï¼Œäººä»¬å‘ç°ï¼Œåœ¨è‹±è¯­å›½å®¶ï¼Œ128 ä¸ªå­—ç¬¦ç¼–ç å¤Ÿç”¨äº†ï¼Œä½†æ˜¯å¯¹äºéè‹±è¯­å›½å®¶ï¼Œæ— æ³•åœ¨ ASCII å­—ç¬¦é›†ä¸­æ‰¾åˆ°æœ¬å›½çš„åŸºæœ¬å­—ç¬¦ã€‚å¦‚åœ¨æ³•è¯­ä¸­ï¼Œå­—æ¯ä¸Šæ–¹æœ‰æ³¨éŸ³ç¬¦å·ï¼Œæ— æ³•ç”¨ ASCII ç è¡¨ç¤ºã€‚äºæ˜¯æœ‰äººå»ºè®®ï¼ŒASCII å­—ç¬¦åªæ˜¯ä½¿ç”¨äº†ä¸€ä¸ªå­—èŠ‚çš„å‰ 128 ä¸ªï¼Œåé¢çš„ 128 ä¸ªå®Œå…¨å¯ä»¥åˆ©ç”¨èµ·æ¥ï¼Œäºæ˜¯ä¸€äº›æ¬§æ´²å›½å®¶å°±å†³å®šï¼Œåˆ©ç”¨å­—èŠ‚ä¸­é—²ç½®çš„æœ€é«˜ä½ç¼–å…¥æ–°çš„ç¬¦å·ã€‚æ¯”å¦‚ï¼Œæ³•è¯­ä¸­çš„ Ã© çš„ç¼–ç ä¸º 130ï¼ˆäºŒè¿›åˆ¶ 10000010ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œè¿™äº›æ¬§æ´²å›½å®¶ä½¿ç”¨çš„ç¼–ç ä½“ç³»ï¼Œå¯ä»¥æœ€å¤šè¡¨ç¤º 256 ä¸ªç¬¦å·ã€‚ ä½†æ˜¯åˆå‡ºç°äº†æ–°çš„é—®é¢˜ã€‚ä¸åŒå›½å®¶æœ‰ä¸åŒçš„å­—æ¯(å‚è§ä¸‹å›¾,è‹±è¯­ï¼Œæ³•è¯­å±äºæ‹‰ä¸å­—æ¯ä½“ç³»ï¼Œä¿„è¯­å±äºæ–¯æ‹‰å¤«å­—æ¯ä½“ç³»ï¼Œä»¥è‰²åˆ—ç”¨çš„æ˜¯å¸Œä¼¯æ¥å­—æ¯)ï¼Œå®ƒä»¬éƒ½ä½¿ç”¨ 256 ä¸ªç¬¦å·çš„ç¼–ç æ–¹å¼ï¼Œä»£è¡¨çš„å­—æ¯å´ä¸ä¸€æ ·ã€‚æ¯”å¦‚ï¼Œ130 åœ¨æ³•è¯­ç¼–ç ä¸­ä»£è¡¨äº† Ã©ï¼Œåœ¨å¸Œä¼¯æ¥è¯­ç¼–ç ä¸­å´ä»£è¡¨äº†å­—æ¯ Gimel (×’)ï¼Œåœ¨ä¿„è¯­ç¼–ç ä¸­åˆä»£è¡¨å¦ä¸€ä¸ªç¬¦å·ã€‚128-255 ä¹‹é—´ä¸åŒçš„å­—ç¬¦é›†å¯¼è‡´äººä»¬æ— æ³•è·¨æœºå™¨ä¼ æ’­äº¤æµå„ç§ä¿¡æ¯ã€‚ è‡³äºäºšæ´²å›½å®¶çš„æ–‡å­—ï¼Œä½¿ç”¨çš„ç¬¦å·å°±æ›´å¤šäº†ï¼Œæœ€å…¸å‹å°±æ˜¯ä¸­æ–‡ï¼Œæ±‰å­—å¤šè¾¾ 10 ä¸‡å·¦å³ã€‚å¸¸ç”¨æ±‰å­—æœ‰ 6000 ä¸ªå·¦å³ï¼Œç”¨ä¸€ä¸ªå­—èŠ‚æ˜¯æ— æ³•è¡¨ç¤ºçš„ï¼Œæ‰€ä»¥ä¹Ÿå‘å±•å‡ºäº†è‡ªå·±çš„ä¸€å¥—ç¼–ç è§„èŒƒï¼š 1980 å¹´ï¼Œä¸­å›½æäº†è‡ªå·±çš„ç¼–ç æ–¹æ¡ˆ GB/T 2312ï¼Œä¸€èˆ¬ç®€ç§° GB2312ã€‚ 1993 å¹´ï¼Œå›½é™…æ ‡å‡†åŒ–ç»„ç»‡ ISO åˆ¶å®šäº†ç¼–ç æ ‡å‡† ISO/IEC 10646-1:1993ï¼Œå›½å†…äºˆä»¥æ‰¿è®¤ï¼Œå¹¶ç¼–å·ä¸º GB 13000.1-1993ã€‚ 1995 å¹´ï¼Œå›½å†…åŸºäº GB2312 æ‰©å±•äº†ä¸€å¥—ç¼–ç æ–¹æ¡ˆ GBKï¼ˆæ±‰å­—å†…ç æ‰©å±•è§„èŒƒï¼‰ï¼Œå¹¶æ”¶å½•äº† GB13000.1 å’Œ Big5ï¼ˆç”±å°æ¹¾èµ„è®¯å·¥ä¸šç­–è¿›ä¼šåœ¨ 1984 å¹´åˆ¶å®šï¼‰ä¸­çš„æ±‰å­—ï¼Œå¾®è½¯åœ¨ Windows 95ã€Windows NT 3.51 ä¸­è¿›è¡Œäº†å®ç°ï¼Œç§°ä¸º Code Page 936ã€‚ 2000 å¹´ï¼Œåˆ¶å®šäº†å›½æ ‡ GB 18030-2000ï¼Œç›®å‰å·²ä½œåºŸã€‚ 2005 å¹´ï¼Œåˆ¶å®šäº†å›½æ ‡ GB 18030-2005ï¼Œä¸ºç°è¡Œçš„ GB18030 æ ‡å‡†ã€‚ 2022 å¹´ï¼Œåˆ¶å®šäº†å›½æ ‡ GB 18030-2022ï¼Œ2023 å¹´ 8 æœˆ 1 æ—¥ç”Ÿæ•ˆã€‚ å‰é¢åªä»‹ç»äº†è¥¿æ–¹å›½å®¶å’Œä¸­æ–‡çš„ç¼–ç ï¼Œæ”¾çœ¼å…¨ä¸–ç•Œï¼Œæœ‰è®¸å¤šç§è¯­è¨€æ–‡å­—ï¼Œå¦‚æœå„è‡ªéƒ½æä¸€å¥—å°±ä¹±æˆä¸€é”…ç²¥äº†ã€‚å¦‚æœæœ‰ä¸€ç§ç¼–ç ï¼Œå°†ä¸–ç•Œä¸Šæ‰€æœ‰çš„ç¬¦å·éƒ½çº³å…¥å…¶ä¸­ã€‚ç»™æ¯ä¸€ä¸ªç¬¦å·èµ‹äºˆä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ç¼–ç ï¼Œé‚£ä¹ˆç›¸åŒçš„äºŒè¿›åˆ¶å€¼åœ¨ä¸–ç•Œä¸åŒå›½å®¶ç¼–ç ä¸­ä»£è¡¨ä¸åŒçš„å­—ç¬¦ä¹±å±€å°±ä¼šæ¶ˆå¤±ã€‚ Unicode ç ç»Ÿä¸€ä¹±å±€Unicode ç å°†ä¸–ç•Œå„ç§è¯­è¨€çš„æ¯ä¸ªå­—ç¬¦å®šä¹‰ä¸€ä¸ªå”¯ä¸€çš„ç¼–ç ï¼Œä»¥æ»¡è¶³è·¨è¯­è¨€ã€è·¨å¹³å°çš„æ–‡æœ¬ä¿¡æ¯è½¬æ¢ã€‚ç¬¬ä¸€ç‰ˆ å‘å¸ƒäº 1991 å¹´ ï¼Œç›®å‰å·²å‘å±•åˆ°ç¬¬ 15 ç‰ˆã€‚Unicode å­—ç¬¦é›†çš„ç¼–ç èŒƒå›´æ˜¯ 0x0000 - 0x10FFFF , Unicode çš„ç¼–ç ç©ºé—´ä»U+0000åˆ°U+10FFFFï¼Œå…±æœ‰ 1,112,064 ä¸ªç ä½ï¼ˆcode pointï¼‰å¯ç”¨æ¥æ˜ å°„å­—ç¬¦ï¼Œå¯ä»¥å®¹çº³ä¸€ç™¾å¤šä¸‡ä¸ªå­—ç¬¦ï¼Œ æ¯ä¸ªå­—ç¬¦éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ç¼–ç ï¼Œä¹Ÿå³æ¯ä¸ªå­—ç¬¦éƒ½æœ‰ä¸€ä¸ªäºŒè¿›åˆ¶æ•°å€¼å’Œå®ƒå¯¹åº”ï¼Œè¿™é‡Œçš„äºŒè¿›åˆ¶æ•°å€¼ä¹Ÿå« ç ç‚¹ , æ¯”å¦‚ï¼šæ±‰å­— â€œæ±‰â€ çš„ ç ç‚¹æ˜¯ 0x6C49, å¤§å†™å­—æ¯ A çš„ç ç‚¹æ˜¯ 0x41, å…·ä½“å­—ç¬¦å¯¹åº”çš„ Unicode ç¼–ç å¯ä»¥æŸ¥è¯¢ Unicode å­—ç¬¦ç¼–ç è¡¨ã€‚ Unicode æ¨è¡Œè¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜Unicode ä¸ºæ¯ä¸ªå­—ç¬¦è§„å®šäº†å”¯ä¸€çš„äºŒè¿›åˆ¶ä»£ç ï¼Œå´æ²¡æœ‰è§„å®šè¿™ä¸ªäºŒè¿›åˆ¶ä»£ç åº”è¯¥å¦‚ä½•å­˜å‚¨ã€‚ä¾‹å¦‚ï¼Œæ±‰å­—çš„â€æ±‰â€ Unicode ç¼–ç æ˜¯åå…­è¿›åˆ¶æ•° 0x6C49ï¼Œè¡¨ç¤ºè¿™ä¸ªç¬¦å·éœ€è¦ 2 ä¸ªå­—èŠ‚ã€‚ä¾æ­¤ç±»æ¨ï¼Œè¡¨ç¤ºå…¶å®ƒåœ¨ Unicode ç¼–ç ä¸­æ’åºæ›´é åçš„ç¬¦å·ï¼Œéœ€è¦ 3 ä¸ªæˆ– 4 ä¸ªå­—èŠ‚ã€‚ è¿™å°±å‡ºç°ä¸¤ä¸ªé—®é¢˜ï¼š æ€æ ·åŒºåˆ« Unicode å’Œ ASCII ç ï¼Ÿè®¡ç®—æœºæ— æ³•çŸ¥é“ä¸‰ä¸ªå­—èŠ‚æ˜¯è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦çš„ Unicode ç ï¼Œè¿˜æ˜¯åˆ†åˆ«è¡¨ç¤ºä¸‰ä¸ªå­—ç¬¦çš„ ASCII ç ã€‚ è‹±æ–‡å­—æ¯åªç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºå°±å¤Ÿäº†ï¼Œå¦‚æœæŒ‰ç…§ Unicode ç¼–ç ï¼Œæ¯ä¸ªç¬¦å·ç”¨ä¸‰ä¸ªæˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œè‹±æ–‡æ–‡æœ¬æ–‡ä»¶çš„ä½“ç§¯å› æ­¤å¤§å‡ºäºŒä¸‰å€ï¼Œè¿™å¯¹å­˜å‚¨æ¥è¯´æ˜¯å¾ˆå¤§çš„æµªè´¹ã€‚ å®ƒä»¬é€ æˆçš„ç»“æœæ˜¯ï¼š Unicode åœ¨å¾ˆé•¿ä¸€æ®µæ—¶é—´å†…æ— æ³•æ¨å¹¿ï¼Œç”±äº ASCII å­—ç¬¦ç»è¿‡ UTF-16 ç¼–ç åå¾—åˆ°çš„ä¸¤ä¸ªå­—èŠ‚ï¼Œé«˜å­—èŠ‚å§‹ç»ˆæ˜¯ 0Ã—00ï¼Œå¾ˆå¤š C è¯­è¨€çš„å‡½æ•°éƒ½å°†æ­¤å­—èŠ‚è§†ä¸ºå­—ç¬¦ä¸²æœ«å°¾ä»è€Œå¯¼è‡´æ— æ³•æ­£ç¡®è§£ææ–‡æœ¬ã€‚å› æ­¤ UTF-16 åˆšæ¨å‡ºçš„æ—¶å€™é­åˆ°å¾ˆå¤šè¥¿æ–¹å›½å®¶çš„æŠµè§¦ï¼Œå¤§å¤§å½±å“äº† Unicode çš„æ¨è¡Œã€‚ ä¸ºäº†å¹³è¡¡ Unicode æµªè´¹å­˜å‚¨ç©ºé—´å’Œè¡¨è¾¾æ›´å¤šå­—ç¬¦çš„é—®é¢˜ï¼Œå‡ºç°äº†å¤šç§ä¸åŒçš„ Unicode ç¼–ç å­˜å‚¨æ ¼å¼ã€‚ UTF-8 é—®ä¸–ä¼´éšç€äº’è”ç½‘çš„æ™®åŠï¼Œå¼ºçƒˆéœ€è¦ä¸€ç§ç»Ÿä¸€çš„ Unicode çš„ç¼–ç æ–¹æ¡ˆ, å°¤å…¶æ˜¯è·¨å›½å•†åŠ¡åŠå…¬åœºæ™¯ã€‚UTF-8 æ˜¯ç›®å‰äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¹¿çš„ä¸€ç§ Unicode çš„ç¼–ç å®ç°æ–¹å¼ã€‚Unicode çš„å…¶å®ƒå®ç°æ–¹å¼è¿˜æœ‰ UTF-16ï¼ˆå­—ç¬¦ç”¨ä¸¤ä¸ªå­—èŠ‚æˆ–å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼‰å’Œ UTF-32ï¼ˆå­—ç¬¦ç”¨å››ä¸ªå­—èŠ‚è¡¨ç¤ºï¼‰ï¼Œåœ¨æµè§ˆå™¨ä¸Šå¾ˆå°‘ç”¨ï¼Œåœ¨æœ¬åœ°æ–‡ä»¶ä¸­ç”¨çš„è¾ƒå¤šã€‚ UTF-8 æœ€å¤§çš„ç‰¹ç‚¹ï¼Œå°±æ˜¯å®ƒæ˜¯ä¸€ç§â€œå˜é•¿â€ç¼–ç æ–¹å¼ã€‚å®ƒå¯ä»¥ä½¿ç”¨ 1 åˆ° 4 ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªç¬¦å·ï¼Œæ ¹æ®ä¸åŒçš„ç¬¦å·è€Œå˜åŒ–å­—èŠ‚é•¿åº¦ã€‚UTF-8 ç¼–ç è§„åˆ™æ˜¯ï¼š å¯¹äºå•å­—èŠ‚çš„ç¬¦å·ï¼Œå­—èŠ‚çš„ç¬¬ä¸€ä½è®¾ä¸º 0ï¼Œåé¢ 7 ä½ä¸ºè¿™ä¸ªç¬¦å·çš„ Unicode ç ã€‚å› æ­¤å¯¹äºè‹±æ–‡å­—æ¯ï¼ŒUTF-8 å’Œ ASCII ç¼–ç æ˜¯ç›¸åŒçš„ï¼› å¯¹äº n å­—èŠ‚çš„ç¬¦å·ï¼ˆn&gt;1ï¼‰ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚çš„å‰ n ä½éƒ½è®¾ä¸º 1ï¼Œç¬¬ n+1 ä½è®¾ä¸º 0ï¼Œåé¢å­—èŠ‚çš„å‰ä¸¤ä½ä¸€å¾‹è®¾ä¸º 10ã€‚å‰©ä¸‹çš„æ²¡æœ‰æåŠçš„äºŒè¿›åˆ¶ä½ï¼Œå…¨éƒ¨ä¸ºè¿™ä¸ªç¬¦å·çš„ Unicode ç ï¼›ä¸‹è¡¨æ€»ç»“äº†ç¼–ç è§„åˆ™ï¼Œå­—æ¯ x è¡¨ç¤ºå¯ç”¨ç¼–ç çš„ä½ï¼š UTF-8 ç¼–ç æ–¹å¼ Unicode ç¬¦å·èŒƒå›´(åå…­è¿›åˆ¶) äºŒè¿›åˆ¶è¡¨ç¤º 000000-00007F (0-127) 0xxxxxxx 000080-0007FF (128-2047) 110xxxxx 10xxxxxx 000800-00FFFF (2048-65535) 1110xxxx 10xxxxxx 10xxxxxx 010000-10FFFF (65536 ä»¥ä¸Š) 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx åŸºäº UTF-8 ç¼–ç è§„åˆ™ï¼Œè§£è¯» UTF-8 ç¼–ç å°±éå¸¸ç®€å•ã€‚å¦‚æœä¸€ä¸ªå­—èŠ‚çš„ç¬¬ä¸€ä½æ˜¯ 0ï¼Œåˆ™è¿™ä¸ªå­—èŠ‚å•ç‹¬å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼›å¦‚æœç¬¬ä¸€ä½æ˜¯ 1ï¼Œåˆ™è¿ç»­æœ‰å¤šå°‘ä¸ª 1ï¼Œå°±è¡¨ç¤ºå½“å‰å­—ç¬¦å ç”¨å¤šå°‘ä¸ªå­—èŠ‚ã€‚ è¿˜æ˜¯ä»¥æ±‰å­—çš„æ±‰ä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•å®ç° UTF-8 ç¼–ç ï¼š æ±‰çš„ Unicode ç æ˜¯ U+6C49ï¼ˆåè¿›åˆ¶è¡¨ç¤ºä¸º 27721ï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºä¸º 110 1100 0100 1001ï¼‰ï¼Œæ ¹æ®ä¸Šè¡¨ï¼Œå¯ä»¥å‘ç° 6C49 å¤„åœ¨ç¬¬ä¸‰è¡Œçš„èŒƒå›´å†…ï¼ˆ0000 0800 - 0000 FFFFï¼‰ï¼Œå› æ­¤æ±‰çš„ UTF-8 ç¼–ç éœ€è¦ä¸‰ä¸ªå­—èŠ‚ï¼Œå³æ ¼å¼æ˜¯ 1110xxxx 10xxxxxx 10xxxxxxã€‚ç„¶åï¼Œä»æ±‰çš„æœ€åä¸€ä¸ªäºŒè¿›åˆ¶ä½å¼€å§‹ï¼Œä¾æ¬¡ä»åå‘å‰å¡«å…¥æ ¼å¼ä¸­çš„ xï¼Œå¤šå‡ºçš„ä½è¡¥ 0ã€‚è¿™æ ·å°±å¾—åˆ°äº†ï¼Œæ±‰çš„ UTF-8 ç¼–ç æ˜¯ 11100110 10110001 10001001ï¼Œè½¬æ¢æˆåå…­è¿›åˆ¶å°±æ˜¯ 0xE6B789ã€‚ UTF-8 BOM æ¦‚å¿µè§£æå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä½¿ç”¨ NodePad++ä¿å­˜æ–‡ä»¶ï¼Œé€‰æ‹©ç¼–ç æ–¹å¼æ—¶ï¼Œä¼šçœ‹åˆ°ä¸€ä¸ª UTF-8 BOM çš„é€‰é¡¹ï¼Œè¿™ä¸ªé€‰é¡¹æ˜¯ä»€ä¹ˆå«ä¹‰ï¼Ÿ BOMï¼ˆbyte order markï¼‰æ˜¯ä¸º UTF-16 å’Œ UTF-32 å‡†å¤‡çš„ï¼Œç”¨äºæ ‡è®°å­—èŠ‚åºï¼ˆbyte orderï¼‰ã€‚Byte Order Mark(BOM)ï¼Œå³å­—èŠ‚é¡ºåºæ ‡è®°ï¼Œé€šå¸¸å«åšå¤§å°ç«¯ã€‚ä½äºæ–‡ä»¶å¼€å§‹çš„åœ°æ–¹ã€‚ç”¨äºæ ‡è®°é«˜ä½åœ¨å‰ï¼Œè¿˜æ˜¯ä½ä½åœ¨å‰ã€‚å³æ–‡ä»¶å¼€å¤´æœ‰æ²¡æœ‰ U+FEFFã€‚å¾®è½¯åœ¨ UTF-8 ä¸­ä½¿ç”¨ BOM æ˜¯å› ä¸ºè¿™æ ·å¯ä»¥æŠŠ UTF-8 å’Œ ASCII ç­‰ç¼–ç æ˜ç¡®åŒºåˆ†å¼€ï¼Œä½†è¿™æ ·çš„æ–‡ä»¶åœ¨ Windows ä¹‹å¤–çš„æ“ä½œç³»ç»Ÿé‡Œä¼šå¸¦æ¥é—®é¢˜ã€‚BOM ä¸å—æ¬¢è¿ä¸»è¦æ˜¯åœ¨ UNIX ç¯å¢ƒä¸‹ï¼Œå› ä¸º BOM æœ¬èº«è¿åäº†ä¸€ä¸ª UNIX è®¾è®¡çš„å¸¸è§åŸåˆ™ï¼Œå°±æ˜¯æ–‡æ¡£ä¸­å­˜åœ¨çš„æ•°æ®å¿…é¡»å¯è§ã€‚BOM ä¸èƒ½ä½œä¸ºå¯è§å­—ç¬¦è¢«æ–‡æœ¬ç¼–è¾‘å™¨ç¼–è¾‘ï¼Œå°±è¿™ä¸€æ¡å¾ˆå¤š UNIX å¼€å‘è€…å°±ä¸æ»¡æ„ã€‚å› ä¸ºå¾ˆå¤š UNIX ç¨‹åºä¸é¸Ÿ BOMã€‚ä¸»è¦é—®é¢˜å‡ºåœ¨ UNIX é‚£ä¸ªæ‰€æœ‰è„šæœ¬è¯­è¨€é€šè¡Œçš„é¦–è¡Œ#!æ ‡ç¤ºï¼Œè¿™ä¸œè¥¿ä¾èµ–äº shell è§£æï¼Œè€Œå¾ˆå¤š shell å‡ºäºå…¼å®¹çš„è€ƒè™‘ä¸æ£€æµ‹ BOMï¼Œæ‰€ä»¥åŠ è¿› BOM æ—¶ shell ä¼šæŠŠå®ƒè§£é‡Šä¸ºæŸä¸ªæ™®é€šå­—ç¬¦è¾“å…¥å¯¼è‡´ç ´å#!æ ‡ç¤ºï¼Œè¿™å°±ä¼šé€ æˆé”™è¯¯ã€‚æ‰€ä»¥ä¸å« BOM çš„ UTF-8 æ‰æ˜¯æ ‡å‡†å½¢å¼ï¼Œåœ¨ UTF-8 æ–‡ä»¶ä¸­æ”¾ç½® BOM ä¸»è¦æ˜¯å¾®è½¯çš„ä¹ æƒ¯ã€‚BOM è§£è¯»è§„åˆ™å¦‚ä¸‹: ç›¸å¯¹å¤æ‚çš„ UTF-16 ç¼–ç å¹³é¢çš„æ¦‚å¿µ åœ¨äº†è§£ UTF-16 ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å¹³é¢çš„æ¦‚å¿µã€‚Unicode ç¼–ç ä¸­æœ‰å¾ˆå¤šå­—ç¬¦ï¼Œå¹¶ä¸æ˜¯ä¸€æ¬¡æ€§å®šä¹‰çš„ï¼Œè€Œæ˜¯åˆ†åŒºè¿›è¡Œå®šä¹‰çš„ã€‚æ¯ä¸ªåŒºå­˜æ”¾ 65536 ä¸ªå­—ç¬¦ï¼Œè¿™ç§°ä¸ºä¸€ä¸ªå¹³é¢ï¼Œç›®å‰å…±æœ‰ 17 ä¸ªå¹³é¢ã€‚ç¬¬ä¸€ä¸ªå¹³é¢ç§°ä¸ºåŸºæœ¬å¹³é¢ï¼Œå®ƒçš„ç ç‚¹ä» 0-65535ï¼Œå†™æˆ 16 è¿›åˆ¶å°±æ˜¯ U+0000 ä¸€ U+FFFFï¼Œé‚£å‰©ä¸‹çš„ 16 ä¸ªå¹³é¢å°±æ˜¯è¾…åŠ©å¹³é¢(é™¤äº†ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå¹³é¢ï¼Œå…¶å®ƒçš„éƒ½æ²¡æœ‰å¹¿æ³›ä½¿ç”¨ï¼Œå‚è§æ­¤æ–‡çš„å¹³é¢è®²è§£)ï¼Œç ç‚¹èŒƒå›´æ˜¯ U+10000â€“U+10FFFFã€‚UTF-16 æŠŠ Unicode å­—ç¬¦é›†çš„æŠ½è±¡ç ä½æ˜ å°„ä¸º 16 ä½é•¿çš„æ•´æ•°è¿›è¡Œæ•°æ®å­˜å‚¨ã€‚ Unicode å­—ç¬¦çš„ç ä½éœ€è¦ 1 ä¸ªæˆ–è€… 2 ä¸ª 16 ä½é•¿çš„ç å…ƒæ¥è¡¨ç¤ºï¼Œå› æ­¤ UTF-16 ä¹Ÿæ˜¯å˜é•¿å­—èŠ‚ã€‚ UTF-16 ç¼–ç è§„åˆ™: ç¼–å·åœ¨ U+0000-U+FFFF çš„å­—ç¬¦(å¸¸ç”¨å­—ç¬¦é›†)ï¼Œç›´æ¥ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤º ç¼–å·åœ¨ U+10000-U+10FFFF ä¹‹é—´çš„å­—ç¬¦ï¼Œéœ€è¦ç”¨å››ä¸ªå­—èŠ‚è¡¨ç¤º é€šè¿‡ä¸Šè¡¨ï¼Œå¯ä»¥å‘ç°ï¼ŒUTF-16 ç”¨äºŒä¸ªå­—èŠ‚æ¥è¡¨ç¤ºåŸºæœ¬å¹³é¢ï¼Œç”¨å››ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºæ‰©å±•å¹³é¢ã€‚ ç¼–ç è¯†åˆ« å½“é‡åˆ°ä¸¤ä¸ªå­—èŠ‚æ—¶ï¼Œæ€ä¹ˆçŸ¥é“æ˜¯æŠŠå®ƒå½“åšä¸€ä¸ªå­—ç¬¦è¿˜æ˜¯å’Œåé¢çš„ä¸¤ä¸ªå­—èŠ‚ä¸€èµ·å½“åšä¸€ä¸ªå­—ç¬¦å‘¢? åœ¨åŸºæœ¬å¹³é¢å†…ï¼Œä» U+D800-U+DFFF æ˜¯ä¸ªç©ºæ®µï¼Œè¿™ä¸ªåŒºé—´çš„ç ç‚¹ä¸å¯¹åº”ä»»ä½•å­—ç¬¦ï¼Œè¿™äº›ç©ºæ®µè¢«ç”¨æ¥æ˜ å°„è¾…åŠ©å¹³é¢çš„å­—ç¬¦ã€‚110110xx xxxxxxxxï¼ˆ0xd800 - 0xdbffï¼‰ä¸ºé«˜ä½ä»£ç†ï¼ˆHigh Surrogateï¼‰ï¼Œ110111xx xxxxxxxxï¼ˆ0xdc00 - 0xdfffï¼‰ ä¸ºä½ä½ä»£ç†(Low Surrogate)ã€‚å®ƒçš„ä½œç”¨æ˜¯å‘Šè¯‰è®¡ç®—æœºï¼Œåªè¦ç¢°ç€äº†è¿™ä¸ªåŒºé—´çš„æ•°å€¼ï¼Œå°±çŸ¥é“æ‰©å±•å¹³é¢çš„å­—ç¬¦æ¥äº†,è¦æŠŠè¿ç»­ä¸¤ä¸ªåŒå­—èŠ‚å½“åšä¸€ä¸ªå­—ç¬¦è§£ç ã€‚ ä¸€ä¸ªé«˜ä½ä»£ç†å’Œä¸€ä¸ªä½ä½ä»£ç†å¯ä»¥ç»„æˆä¸€ä¸ªä»£ç†å¯¹ï¼ˆSurrogate Pairï¼‰ã€‚å¦‚æœ y å’Œ x å…¨ä¸º 0ï¼Œåˆ™ä¸º 0x010000 çš„ä»£ç ç‚¹ï¼Œå…¨ä¸º 1 åˆ™ä¸º 0x10ffff çš„ä»£ç ç‚¹ï¼Œåˆšå¥½èƒ½æŠŠæ‰€æœ‰æ‰©å±•å¹³é¢å…¨éƒ¨ç¼–ç ã€‚ å¦‚æœä»£ç ç‚¹ä½äº 0x000000 - 0x00ffffï¼Œç›´æ¥è¿›è¡ŒäºŒè¿›åˆ¶ç¼–ç ï¼Œä½æ•°ä¸å¤Ÿçš„å·¦è¾¹å…… 0ã€‚ å¦‚æœä»£ç ç‚¹ä½äº 0x010000 - 0x10ffffï¼Œåˆ™ï¼š ä»£ç ç‚¹å‡å» 0x10000ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªä½äº 0x000000 å’Œ 0x0fffff ä¹‹é—´çš„æ•°å­—ã€‚ è¿™ä¸ªæ•°å­—è½¬æ¢ä¸º 20 ä½äºŒè¿›åˆ¶æ•°ï¼Œä½æ•°ä¸å¤Ÿçš„ï¼Œå·¦è¾¹å…… 0ï¼Œè®°ä½œï¼šyyyy yyyy yyxx xxxx xxxxã€‚ å–å‡º yy yyyyyyyyï¼Œå¹¶åŠ ä¸Š 11011000 00000000(0xD800)ï¼Œå¾—åˆ°é«˜ä½ä»£ç†ã€‚ å–å‡º xx xxxxxxxxï¼Œå¹¶åŠ ä¸Š 11011100 00000000(0xDC00)ï¼Œå¾—åˆ°ä½ä½ä»£ç†ã€‚ é«˜ä½ä»£ç†å’Œä½ä½ä»£ç†ç›¸è¿ï¼Œå¾—åˆ° 110110yy yyyyyyyy 110111xx xxxxxxxxã€‚ ä¸¾ä¾‹è¯´æ˜ ä»¥â€œå«¦â€å­—ä¸ºä¾‹ï¼Œå®ƒçš„ Unicode ç ç‚¹ä¸º 0x21800 ï¼Œè¯¥ç ç‚¹è¶…å‡ºäº†åŸºæœ¬å¹³é¢çš„èŒƒå›´ï¼Œå› æ­¤éœ€è¦ç”¨å››ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼Œæ­¥éª¤å¦‚ä¸‹: é¦–å…ˆè®¡ç®—è¶…å‡ºéƒ¨åˆ†çš„ç»“æœ: 0x21800 - 0x10000 å°†ä¸Šé¢çš„è®¡ç®—ç»“æœè½¬ä¸º 20 ä½çš„äºŒè¿›åˆ¶æ•°ï¼Œä¸è¶³ 20 ä½å°±åœ¨å‰é¢è¡¥ 0ï¼Œç»“æœä¸º: 0001 0001 1000 0000 0000 å°†å¾—åˆ°çš„ä¸¤ä¸ª 10 ä½äºŒè¿›åˆ¶æ•°åˆ†åˆ«å¯¹åº”åˆ°ä¸¤ä¸ªåŒºé—´ä¸­ å–å‡º 0001000110 å¹¶åŠ ä¸Š 11011000 00000000(0xD800)ï¼Œå¾—åˆ°é«˜ä½ä»£ç† 1101100001000110 ï¼Œè½¬æˆ 16 è¿›åˆ¶æ•°ä¸º 0xD846 ã€‚åŒç†è®¡ç®—ä½ä½ä»£ç†ä¸º 0xDC00ï¼Œæ‰€ä»¥è¿™ä¸ªå­—çš„ UTF-16 ç¼–ç ä¸º 0xD846 0xDC00 æœ€å¥½ç†è§£çš„ UTF-32UTF-32 å°±æ˜¯å­—ç¬¦æ‰€å¯¹åº”ç¼–å·çš„æ•´æ•°äºŒè¿›åˆ¶å½¢å¼ï¼Œæ¯ä¸ªå­—ç¬¦å å››ä¸ªå­—èŠ‚ï¼Œè¿™ä¸ªæ˜¯ç›´æ¥è¿›è¡Œè½¬æ¢çš„ã€‚è¯¥ç¼–ç æ–¹å¼å ç”¨çš„å‚¨å­˜ç©ºé—´è¾ƒå¤šï¼Œæ‰€ä»¥ä½¿ç”¨è¾ƒå°‘ã€‚æ¯”å¦‚â€œé©¬â€å­—çš„ Unicode ç¼–å·æ˜¯ U+9A6C ï¼Œæ•´æ•°ç¼–å·æ˜¯ 39532 ï¼Œç›´æ¥è½¬åŒ–ä¸ºäºŒè¿›åˆ¶: 1001 1010 0110 1100 ï¼Œè¿™å°±æ˜¯å®ƒçš„ UTF-32 ç¼–ç ã€‚ ä¸ºä»€ä¹ˆ UTF-8 ä¸éœ€è¦å­—èŠ‚åº,UTF-16,UTF-32 éœ€è¦å­—èŠ‚åºï¼Ÿè™½ç„¶ UTF-8 æ˜¯å˜é•¿ç¼–ç ï¼Œä½†æ˜¯ä»¥å•å­—èŠ‚ä¸ºç¼–ç å•å…ƒï¼Œä¸å­˜åœ¨è°åœ¨é«˜ä½ä½çš„é—®é¢˜ï¼Œç”±äº UTF-8 çš„é¦–å­—èŠ‚è®°å½•äº†æ€»å­—èŠ‚æ•°ï¼ˆæ¯”å¦‚ 3 ä¸ªï¼‰ï¼Œæ‰€ä»¥è¯»å–é¦–å­—èŠ‚åï¼Œå†è¯»å–åç»­å­—èŠ‚ï¼ˆ2 ä¸ªï¼‰ï¼Œç„¶åè¿›è¡Œè§£ç ï¼Œå¾—åˆ°å®Œæ•´çš„å­—èŠ‚æ•°ï¼Œä»è€Œèƒ½ä¿è¯è§£ç ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚ UTF-16 æ˜¯å˜é•¿ç¼–ç ï¼Œä½¿ç”¨ 1 ä¸ª 16-bit ç¼–ç å•å…ƒæˆ–è€… 2 ä¸ª 16-bit ç¼–ç å•å…ƒï¼ŒUTF32 æ˜¯å®šé•¿ç¼–ç ï¼Œä½¿ç”¨ 2 ä¸ª 16-bit ç¼–ç å•å…ƒï¼Œç”±äºç¡¬ä»¶ CPU çš„ä¸åŒï¼Œå¯¹äºä¸€ä¸ªç”± 2 ä¸ªå­—èŠ‚ç»„æˆçš„ 16 ä½æ•´æ•°ï¼Œåœ¨å†…å­˜ä¸­å­˜å‚¨è¿™ä¸¤ä¸ªå­—èŠ‚æœ‰ä¸¤ç§æ–¹æ³•ï¼šä¸€ç§æ˜¯å°†ä½åºå­—èŠ‚å­˜å‚¨åœ¨èµ·å§‹åœ°å€ï¼Œè¿™ç§°ä¸ºå°ç«¯(little-endian)å­—èŠ‚åºï¼›å¦ä¸€ç§æ–¹æ³•æ˜¯å°†é«˜åºå­—èŠ‚å­˜å‚¨åœ¨èµ·å§‹åœ°å€ï¼Œè¿™ç§°ä¸ºå¤§ç«¯(big-endian)å­—èŠ‚åºã€‚å‡å¦‚ CPU æ˜¯å¤§ç«¯åºé‚£ä¹ˆé«˜ä½åœ¨å‰ï¼Œå¦‚æœ CPU æ˜¯å°ç«¯åºé‚£ä¹ˆä½ä½åœ¨å‰ï¼Œä¸ºäº†åŒºåˆ†ï¼Œæ‰€ä»¥æœ‰äº† BOMï¼ˆbyte order markï¼‰ï¼Œç„¶åè®¡ç®—æœºæ‰èƒ½çŸ¥é“è°æ˜¯é«˜ä½ï¼Œè°æ˜¯ä½ä½ï¼ŒçŸ¥é“äº†é«˜ä½ä½ï¼Œä»è€Œèƒ½æ­£ç¡®ç»„è£…ï¼Œç„¶åæ‰èƒ½è§£ç æ­£ç¡®ã€‚ Unicodeã€UTF-8ã€UTF-16ã€UTF-32 åŒºåˆ«? Unicode æ˜¯ç¼–ç å­—ç¬¦é›† (å­—ç¬¦é›†) ï¼Œè€Œ UTF-8 ã€UTF-16 ã€UTF-32 æ˜¯å­—ç¬¦é›†ç¼–ç  UTF-16 ä½¿ç”¨å˜ç å…ƒåºåˆ—çš„ç¼–ç æ–¹å¼ï¼Œç›¸è¾ƒäºå®šé•¿ç å…ƒåºåˆ—çš„ UTF-32 ç®—æ³•æ›´å¤æ‚ï¼Œç”šè‡³æ¯”åŒæ ·æ˜¯å˜é•¿ç å…ƒåºåˆ—çš„ UTF-8 ä¹Ÿæ›´ä¸ºå¤æ‚ UTF-8 éœ€è¦åˆ¤æ–­æ¯ä¸ªå­—èŠ‚ä¸­çš„å¼€å¤´æ ‡å¿—ä¿¡æ¯ï¼Œæ‰€ä»¥å¦‚æœæŸä¸ªå­—èŠ‚åœ¨ä¼ é€è¿‡ç¨‹ä¸­å‡ºé”™äº†ï¼Œå°±ä¼šå¯¼è‡´åé¢çš„å­—èŠ‚ä¹Ÿä¼šè§£æå‡ºé”™ï¼›è€Œ UTF-16 ä¸ä¼šåˆ¤æ–­å¼€å¤´æ ‡å¿—ï¼Œå³ä½¿é”™ä¹Ÿåªä¼šé”™ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥å®¹é”™èƒ½åŠ›è¾ƒå¼º å¦‚æœå­—ç¬¦å†…å®¹å…¨éƒ¨è‹±æ–‡æˆ–è‹±æ–‡ä¸å…¶å®ƒæ–‡å­—æ··åˆï¼Œä½†è‹±æ–‡å ç»å¤§éƒ¨åˆ†ï¼Œé‚£ä¹ˆç”¨ UTF-8 å°±æ¯” UTF-16 èŠ‚çœäº†å¾ˆå¤šç©ºé—´; è€Œå¦‚æœå­—ç¬¦å†…å®¹å…¨éƒ¨æ˜¯ä¸­æ–‡è¿™æ ·ç±»ä¼¼çš„å­—ç¬¦æˆ–è€…æ··åˆå­—ç¬¦ä¸­ä¸­æ–‡å ç»å¤§å¤šæ•°ï¼Œé‚£ä¹ˆ UTF-16 å°±å ä¼˜åŠ¿äº†ï¼Œå¯ä»¥èŠ‚çœå¾ˆå¤šç©ºé—´ã€‚ ä¹±ç é—®é¢˜åˆ†ææ‰€è°“â€œä¹±ç â€æ˜¯æŒ‡åº”ç”¨ç¨‹åºæ˜¾ç¤ºå‡ºæ¥çš„å­—ç¬¦æ–‡æœ¬æ— æ³•ç”¨ä»»ä½•è¯­è¨€å»è§£è¯»ï¼Œé€šå¸¸ä¼šåŒ…å«å¤§é‡ ? æˆ– ï¿½ï¼Œé€ æˆä¹±ç çš„æ ¹æœ¬åŸå› å°±æ˜¯å› ä¸ºä½¿ç”¨äº†é”™è¯¯çš„å­—ç¬¦ç¼–ç å»è§£ç å­—èŠ‚æµï¼Œæƒ³è¦è§£å†³ä¹±ç é—®é¢˜ï¼Œå°±å…ˆè¦ææ¸…æ¥šåº”ç”¨ç¨‹åºå½“å‰ä½¿ç”¨çš„å­—ç¬¦ç¼–ç æ˜¯ä»€ä¹ˆã€‚ æ¯”å¦‚æœ€å¸¸è§çš„ç½‘é¡µä¹±ç é—®é¢˜ã€‚éœ€è¦ä»ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢æŸ¥æ‰¾åŸå› ï¼š ç½‘é¡µæ–‡ä»¶æœ¬èº«å­˜å‚¨æ—¶ä½¿ç”¨çš„å­—ç¬¦ç¼–ç å’Œç½‘é¡µå£°æ˜çš„å­—ç¬¦ç¼–ç æ˜¯å¦ä¸€è‡´ &lt;meta charset=&quot;utf-8&quot; /&gt; æœåŠ¡å™¨è¿”å›çš„å“åº”å¤´ Content-Type æœ‰æ²¡æœ‰æŒ‡æ˜å­—ç¬¦ç¼–ç  ç½‘é¡µå†…æ˜¯å¦ä½¿ç”¨ META HTTP-EQUIV æ ‡ç­¾æŒ‡å®šäº†å­—ç¬¦ç¼–ç  &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt; MySQL ä¸­ä¸€ä¸ªä¸­æ–‡å ç”¨å‡ ä¸ªå­—èŠ‚varchar(n)èƒ½å­˜å‚¨å‡ ä¸ªæ±‰å­—ï¼Ÿvarchar(n)è¡¨ç¤º n ä¸ªå­—ç¬¦ï¼Œä¸€ä¸ªæ±‰å­—ä¹Ÿè¢«è§†ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œæ— è®ºæ±‰å­—å’Œè‹±æ–‡ï¼ŒMySQL éƒ½èƒ½å­˜å…¥ n ä¸ªå­—ç¬¦ï¼ŒåŒºåˆ«æ˜¯å®é™…å ç”¨å­—èŠ‚é•¿åº¦ä¸åŒ ä¸€ä¸ªä¸­æ–‡æ±‰å­—å å¤šå°‘å­—èŠ‚ä¸ç¼–ç æœ‰å…³ UTF8ï¼šä¸€ä¸ªä¸­æ–‡æ±‰å­—ï¼ 3 ä¸ªå­—èŠ‚ (å¸¸ç”¨æ±‰å­—æ˜¯æ±‰å­—æ€»æ•°ä¸­å æ¯”è¾ƒå°ï¼Œå¸¸ç”¨æ±‰å­—æ¯ä¸ªå ç”¨ 3 ä¸ªå­—èŠ‚ï¼Œå¤šæ•°ä¸å¤ªå¸¸ç”¨çš„æ±‰å­—æ¯ä¸ªå ç”¨ 4 ä¸ªå­—èŠ‚)ã€‚ GBKï¼šä¸€ä¸ªä¸­æ–‡æ±‰å­—ï¼ 2 ä¸ªå­—èŠ‚ Unicode ç®€ä½“ä¸­æ–‡å­—ç¬¦é›†èŒƒå›´Unicode ç®€ä½“ä¸­æ–‡å­—ç¬¦é›†çš„èŒƒå›´æ˜¯U+4E00 åˆ° U+9FFFï¼Œå…±åŒ…æ‹¬ 20992 ä¸ªå­—ç¬¦ã€‚ å…¶ä¸­ï¼š U+4E00 åˆ° U+62FF æ˜¯å¸¸ç”¨æ±‰å­—åŒº U+6300 åˆ° U+77FF æ˜¯æ¬¡å¸¸ç”¨æ±‰å­—åŒº U+7800 åˆ° U+8CFF æ˜¯éå¸¸ç”¨æ±‰å­—åŒº U+8D00 åˆ° U+9FFF æ˜¯æœªåˆ†ç±»æ±‰å­—åŒº é™¤äº†æ±‰å­—ï¼Œè¿™ä¸ªå­—ç¬¦èŒƒå›´è¿˜åŒ…æ‹¬äº†æ±‰è¯­æ‹¼éŸ³ã€æ³¨éŸ³ç¬¦å·ã€éƒ¨åˆ†æ±‰è¯­æ–¹è¨€æ–‡å­—å’Œä¸€äº›ç¬¦å·ç­‰ã€‚æ‰€ä»¥ä¸€ä¸ªç®€ä½“ä¸­æ–‡æ±‰å­—çš„ Unicode ç¼–ç å€¼æ˜¯ç”¨ 2 ä½ 16 è¿›åˆ¶æ•°è¡¨ç¤ºï¼Œå ç”¨ 2 ä¸ªå­—èŠ‚ã€‚ è½¬è½½æˆ‘è¯´ä¸€ä¸ªä¸­æ–‡å  2 ä¸ªå­—èŠ‚ï¼ŒåŒäº‹è¯´ UTF-8 ç¼–ç ä¸­ï¼Œä¸€ä¸ªä¸­æ–‡å  3 ä¸ªå­—èŠ‚ï¼Œåˆ°åº•è°å¯¹è°é”™ï¼Ÿ","updated":"2025-08-02T05:46:04.182Z","tags":[{"name":"unicode","slug":"unicode","permalink":"https://luckyship.github.io/tags/unicode/"}]},{"title":"window.print è‡ªå®šä¹‰é¡µçœ‰é¡µè„š","date":"2023-11-28T00:47:07.000Z","path":"2023/11/28/2023-11-28-window-print/","text":"&lt;style&gt; .header, .header-space, .footer, .footer-space &#123; height: 100px; &#125; .header &#123; position: fixed; top: 0; &#125; .footer &#123; position: fixed; bottom: 0; &#125;&lt;/style&gt;&lt;table&gt; &lt;thead&gt; &lt;tr&gt; &lt;td&gt; &lt;div class=&quot;header-space&quot;&gt;&amp;nbsp;&lt;/div&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td&gt; &lt;div class=&quot;content&quot;&gt;...&lt;/div&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;tfoot&gt; &lt;tr&gt; &lt;td&gt; &lt;div class=&quot;footer-space&quot;&gt;&amp;nbsp;&lt;/div&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tfoot&gt;&lt;/table&gt;&lt;div class=&quot;header&quot;&gt;...&lt;/div&gt;&lt;div class=&quot;footer&quot;&gt;...&lt;/div&gt; æ–¹æ³•ä¸€ï¼šposition fixed&lt;style&gt; .header &#123; position: fixed; top: 0; &#125; .footer &#123; position: fixed; bottom: 0; &#125;&lt;/style&gt;&lt;div class=&quot;header&quot;&gt;...&lt;/div&gt;&lt;div class=&quot;content&quot;&gt;...&lt;/div&gt;&lt;div class=&quot;footer&quot;&gt;...&lt;/div&gt;// CSS è¿™ä¸ªæ–¹æ³•è¶…è¿‡ä¸€é¡µåï¼Œé¡µçœ‰é¡µè„šä¼šä¸å†…å®¹é‡å  æ–¹æ³•äºŒï¼štable&lt;table&gt; &lt;thead&gt; &lt;tr&gt;&lt;td&gt; &lt;div class=&quot;header&quot;&gt;...&lt;/div&gt; &lt;/td&gt;&lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &lt;tr&gt;&lt;td&gt; &lt;div class=&quot;content&quot;&gt;...&lt;/div&gt; &lt;/td&gt;&lt;/tr&gt; &lt;/tbody&gt; &lt;tfoot&gt; &lt;tr&gt;&lt;td&gt; &lt;div class=&quot;footer&quot;&gt;...&lt;/div&gt; &lt;/td&gt;&lt;/tr&gt; &lt;/tfoot&gt;&lt;/table&gt; åˆ©ç”¨è¡¨æ ¼ tableï¼Œæ‰“å°ä¼šè‡ªåŠ¨æŠŠ thead,tfoot è®¾ç½®ä¸ºé¡µçœ‰é¡µè„šï¼Œä¸è¿‡è¿™ä¸ªæ–¹æ³•é¡µè„šä¼šè·Ÿåœ¨å†…å®¹åé¢ï¼Œä¸ä¼šåœ¨é¡µé¢åº•éƒ¨ æ€»ç»“ï¼šä¸¤ç§æ–¹æ³•ç»“åˆï¼Œå¯ä»¥å¾ˆå¥½çš„å®ç°&lt;style&gt; .header, .header-space, .footer, .footer-space &#123; height: 100px; &#125; .header &#123; position: fixed; top: 0; &#125; .footer &#123; position: fixed; bottom: 0; &#125;&lt;/style&gt;&lt;table&gt; &lt;thead&gt; &lt;tr&gt; &lt;td&gt; &lt;div class=&quot;header-space&quot;&gt;&amp;nbsp;&lt;/div&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td&gt; &lt;div class=&quot;content&quot;&gt;...&lt;/div&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;tfoot&gt; &lt;tr&gt; &lt;td&gt; &lt;div class=&quot;footer-space&quot;&gt;&amp;nbsp;&lt;/div&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tfoot&gt;&lt;/table&gt;&lt;div class=&quot;header&quot;&gt;...&lt;/div&gt;&lt;div class=&quot;footer&quot;&gt;...&lt;/div&gt; å‚è€ƒèµ„æ–™","updated":"2025-08-02T05:46:04.182Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"flutteræŠ“åŒ…ã€æŸ¥çœ‹ç½‘ç»œè¯·æ±‚","date":"2023-10-26T05:56:36.000Z","path":"2023/10/26/2023-10-26-flutter-network/","text":"ç”±äº flutter çš„ http è¯·æ±‚ä»£ç†ä¸èµ°ç³»ç»Ÿï¼Œæ‰€ä»¥åªèƒ½åœ¨ä»£ç ä¸­è®¾ç½®ä»£ç† ip, ä½¿æˆ‘ä»¬çš„æŠ“åŒ…å·¥å…·èƒ½è·å–åˆ° http çš„è¯·æ±‚ flutter ä½¿ç”¨ Charles ä»£ç†çˆ¬è™«class MyHttpOverrides extends HttpOverrides &#123; bool _badCertificateCallback(X509Certificate cert, String host, int port) &#123; return true; &#125; @override HttpClient createHttpClient(SecurityContext? context) &#123; return super.createHttpClient(context) ..badCertificateCallback = _badCertificateCallback ..findProxy = (uri) &#123; return &#x27;PROXY 192.168.1.193:8888;DIRECT;&#x27;;//192.168.1.193:8888æ˜¯ä»£ç†ipç«¯å£ &#125; ; &#125;&#125; åœ¨å¯åŠ¨æ—¶è®¾ç½® httpoverride HttpOverrides.global = MyHttpOverrides(); ä¿®æ”¹ Charles çš„ ssl ä»£ç†è®¾ç½®ï¼ŒProxy-&gt;SSL Proxying Settings -&gt; SSL Proxying-&gt;Include,æ·»åŠ è¦éœ€è¦çˆ¬å–çš„åŸŸåã€‚ æœ‰æ—¶æˆ‘ä»¬éœ€è¦æŠ“ https çš„è¯·æ±‚ï¼Œæ­¤æ—¶ç”¨ charles æŠ“åŒ…çš„å†…å®¹æ˜¯åŠ å¯†çš„ï¼Œçœ‹ä¸åˆ°æ˜æ–‡ï¼Œè¿™æ—¶å€™éœ€è¦å®‰è£…ä¸‹ Charles çš„è¯ä¹¦æ¥è§£å†³ã€‚ç‚¹å‡» help &gt; SSL Proxying &gt; Install Charles Root Certificateï¼Œå®‰è£…åˆ°ç³»ç»Ÿçš„é’¥åŒ™ä¸²ä¸­ã€‚","updated":"2025-08-02T05:46:04.181Z","tags":[{"name":"flutter","slug":"flutter","permalink":"https://luckyship.github.io/tags/flutter/"}]},{"title":"flutterå®‰è£…åŒ…åˆ‡æ¢å›½å†…æº","date":"2023-09-23T03:43:19.000Z","path":"2023/09/23/2023-09-23-flutter-source-pub/","text":"åœ¨å­¦ä¹ Flutterï¼Œå‘ç°æ— æ³•å®‰è£…ï¼Œæ§åˆ¶å°æç¤º Got TLS error trying to find package flutter_inappwebview at https://pub.dev. ç»è¿‡ç½‘ä¸ŠæŸ¥æ‰¾èµ„æ–™ï¼Œå‘ç°ï¼š å¦‚æœåœ¨ä¸­å›½å®‰è£… flutterï¼Œé…ç½®å›½å†…é•œåƒæ˜¯å¾ˆå¥½çš„è§£å†³åŠæ³•ã€‚ åˆ°æ­¤ï¼Œè§£å†³æ–¹æ³•æ‰¾åˆ°ã€‚ é…ç½®æœ¬åœ°ç¯å¢ƒæ–¹æ³• å¯¹äº Linux å’Œ MacOS æ¥è¯´ï¼Œæ·»åŠ å¦‚ä¸‹ä¸¤æ¡ç¯å¢ƒå˜é‡å³å¯ï¼š export PUB_HOSTED_URL=https://pub.flutter-io.cnexport FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn å¯¹äº Window åˆ›å»ºä¸Šè¿°ä¸¤ä¸ªç³»ç»Ÿå˜é‡å³å¯ name: PUB_HOSTED_URL;value: https://pub.flutter-io.cnname: FLUTTER_STORAGE_BASE_URL;value: https://storage.flutter-io.cn","updated":"2025-08-02T05:46:04.181Z","tags":[{"name":"flutter","slug":"flutter","permalink":"https://luckyship.github.io/tags/flutter/"}]},{"title":"nodejsæ“ä½œexcelæ–‡ä»¶","date":"2023-07-02T02:08:48.000Z","path":"2023/07/02/2023-07-02-node-excel/","text":"ExcelJSè¯»å–ï¼Œæ“ä½œå¹¶å†™å…¥ç”µå­è¡¨æ ¼æ•°æ®å’Œæ ·å¼åˆ° XLSX å’Œ JSON æ–‡ä»¶ã€‚ ä¸€ä¸ª Excel ç”µå­è¡¨æ ¼æ–‡ä»¶é€†å‘å·¥ç¨‹é¡¹ç›®ã€‚ å®‰è£…npm install exceljs å¯¼å…¥â¬†const ExcelJS = require(&#x27;exceljs&#x27;); ES5 å¯¼å…¥â¬†è¦ä½¿ç”¨ ES5 ç¼–è¯‘ä»£ç ï¼Œè¯·ä½¿ç”¨ dist/es5 è·¯å¾„ã€‚ const ExcelJS = require(&#x27;exceljs/dist/es5&#x27;); æ³¨æ„ï¼šES5 ç‰ˆæœ¬å¯¹è®¸å¤š polyfill éƒ½å…·æœ‰éšå¼ä¾èµ–ï¼Œè€Œ exceljs ä¸å†æ˜ç¡®æ·»åŠ ã€‚æ‚¨éœ€è¦åœ¨ä¾èµ–é¡¹ä¸­æ·»åŠ  core-js å’Œ regenerator-runtimeï¼Œå¹¶åœ¨å¯¼å…¥ exceljs ä¹‹å‰åœ¨ä»£ç ä¸­åŒ…å«ä»¥ä¸‹å¼•ç”¨ï¼š // exceljs æ‰€éœ€çš„ polyfillsrequire(&#x27;core-js/modules/es.promise&#x27;);require(&#x27;core-js/modules/es.string.includes&#x27;);require(&#x27;core-js/modules/es.object.assign&#x27;);require(&#x27;core-js/modules/es.object.keys&#x27;);require(&#x27;core-js/modules/es.symbol&#x27;);require(&#x27;core-js/modules/es.symbol.async-iterator&#x27;);require(&#x27;regenerator-runtime/runtime&#x27;);const ExcelJS = require(&#x27;exceljs/dist/es5&#x27;); å¯¹äº IE 11ï¼Œæ‚¨è¿˜éœ€è¦ä¸€ä¸ª polyfill ä»¥æ”¯æŒ unicode regex æ¨¡å¼ã€‚ ä¾‹å¦‚ï¼Œ const rewritePattern = require(&#x27;regexpu-core&#x27;);const &#123; generateRegexpuOptions,&#125; = require(&#x27;@babel/helper-create-regexp-features-plugin/lib/util&#x27;);const &#123; RegExp &#125; = global;try &#123; new RegExp(&#x27;a&#x27;, &#x27;u&#x27;);&#125; catch (err) &#123; global.RegExp = function (pattern, flags) &#123; if (flags &amp;&amp; flags.includes(&#x27;u&#x27;)) &#123; return new RegExp( rewritePattern( pattern, flags, generateRegexpuOptions(&#123; flags, pattern &#125;) ) ); &#125; return new RegExp(pattern, flags); &#125;; global.RegExp.prototype = RegExp.prototype;&#125; æµè§ˆå™¨ç«¯â¬†ExcelJS åœ¨ dist/ æ–‡ä»¶å¤¹å†…å‘å¸ƒäº†ä¸¤ä¸ªæ”¯æŒæµè§ˆå™¨çš„åŒ…ï¼š ä¸€ä¸ªæ˜¯éšå¼ä¾èµ– core-js polyfills çš„â€¦ &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;exceljs.js&quot;&gt;&lt;/script&gt; å¦ä¸€ä¸ªåˆ™æ²¡æœ‰â€¦ &lt;script src=&quot;--your-project&#x27;s-pollyfills-here--&quot;&gt;&lt;/script&gt;&lt;script src=&quot;exceljs.bare.js&quot;&gt;&lt;/script&gt; æ¥å£â¬†åˆ›å»ºå·¥ä½œç°¿â¬†const workbook = new ExcelJS.Workbook(); è®¾ç½®å·¥ä½œç°¿å±æ€§â¬†workbook.creator = &#x27;Me&#x27;;workbook.lastModifiedBy = &#x27;Her&#x27;;workbook.created = new Date(1985, 8, 30);workbook.modified = new Date();workbook.lastPrinted = new Date(2016, 9, 27); // å°†å·¥ä½œç°¿æ—¥æœŸè®¾ç½®ä¸º 1904 å¹´æ—¥æœŸç³»ç»Ÿworkbook.properties.date1904 = true; è®¾ç½®è®¡ç®—å±æ€§â¬†// åœ¨åŠ è½½æ—¶å¼ºåˆ¶å·¥ä½œç°¿è®¡ç®—å±æ€§workbook.calcProperties.fullCalcOnLoad = true; å·¥ä½œç°¿è§†å›¾â¬†å·¥ä½œç°¿è§†å›¾æ§åˆ¶åœ¨æŸ¥çœ‹å·¥ä½œç°¿æ—¶ Excel å°†æ‰“å¼€å¤šå°‘ä¸ªå•ç‹¬çš„çª—å£ã€‚ workbook.views = [ &#123; x: 0, y: 0, width: 10000, height: 20000, firstSheet: 0, activeTab: 1, visibility: &#x27;visible&#x27;, &#125;,]; æ·»åŠ å·¥ä½œè¡¨â¬†const sheet = workbook.addWorksheet(&#x27;My Sheet&#x27;); ä½¿ç”¨ addWorksheet å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°æ¥æŒ‡å®šå·¥ä½œè¡¨çš„é€‰é¡¹ã€‚ ç¤ºä¾‹ï¼š // åˆ›å»ºå¸¦æœ‰çº¢è‰²æ ‡ç­¾é¢œè‰²çš„å·¥ä½œè¡¨const sheet = workbook.addWorksheet(&#x27;My Sheet&#x27;, &#123; properties: &#123; tabColor: &#123; argb: &#x27;FFC0000&#x27; &#125; &#125;,&#125;);// åˆ›å»ºä¸€ä¸ªéšè—äº†ç½‘æ ¼çº¿çš„å·¥ä½œè¡¨const sheet = workbook.addWorksheet(&#x27;My Sheet&#x27;, &#123; views: [&#123; showGridLines: false &#125;],&#125;);// åˆ›å»ºä¸€ä¸ªç¬¬ä¸€è¡Œå’Œåˆ—å†»ç»“çš„å·¥ä½œè¡¨const sheet = workbook.addWorksheet(&#x27;My Sheet&#x27;, &#123; views: [&#123; xSplit: 1, ySplit: 1 &#125;],&#125;);// ä½¿ç”¨A4è®¾ç½®çš„é¡µé¢è®¾ç½®è®¾ç½®åˆ›å»ºæ–°å·¥ä½œè¡¨ - æ¨ªå‘const worksheet = workbook.addWorksheet(&#x27;My Sheet&#x27;, &#123; pageSetup: &#123; paperSize: 9, orientation: &#x27;landscape&#x27; &#125;,&#125;);// åˆ›å»ºä¸€ä¸ªå…·æœ‰é¡µçœ‰é¡µè„šçš„å·¥ä½œè¡¨const sheet = workbook.addWorksheet(&#x27;My Sheet&#x27;, &#123; headerFooter: &#123; firstHeader: &#x27;Hello Exceljs&#x27;, firstFooter: &#x27;Hello World&#x27; &#125;,&#125;);// åˆ›å»ºä¸€ä¸ªå†»ç»“äº†ç¬¬ä¸€è¡Œå’Œç¬¬ä¸€åˆ—çš„å·¥ä½œè¡¨const sheet = workbook.addWorksheet(&#x27;My Sheet&#x27;, &#123; views: [&#123; state: &#x27;frozen&#x27;, xSplit: 1, ySplit: 1 &#125;],&#125;); åˆ é™¤å·¥ä½œè¡¨â¬†ä½¿ç”¨å·¥ä½œè¡¨çš„ id ä»å·¥ä½œç°¿ä¸­åˆ é™¤å·¥ä½œè¡¨ã€‚ ç¤ºä¾‹ï¼š // åˆ›å»ºå·¥ä½œè¡¨const sheet = workbook.addWorksheet(&#x27;My Sheet&#x27;);// ä½¿ç”¨å·¥ä½œè¡¨ id åˆ é™¤å·¥ä½œè¡¨workbook.removeWorksheet(sheet.id); è®¿é—®å·¥ä½œè¡¨â¬†// éå†æ‰€æœ‰å·¥ä½œè¡¨// æ³¨æ„ï¼š workbook.worksheets.forEach ä»ç„¶æ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ï¼Œ ä½†æ˜¯ä»¥ä¸‹çš„æ–¹å¼æ›´å¥½workbook.eachSheet(function (worksheet, sheetId) &#123; // ...&#125;);// æŒ‰ name æå–å·¥ä½œè¡¨const worksheet = workbook.getWorksheet(&#x27;My Sheet&#x27;);// æŒ‰ id æå–å·¥ä½œè¡¨const worksheet = workbook.getWorksheet(1); å·¥ä½œè¡¨çŠ¶æ€â¬†// ä½¿å·¥ä½œè¡¨å¯è§worksheet.state = &#x27;visible&#x27;;// éšè—å·¥ä½œè¡¨worksheet.state = &#x27;hidden&#x27;;// ä»â€œéšè—/å–æ¶ˆéšè—â€å¯¹è¯æ¡†ä¸­éšè—å·¥ä½œè¡¨worksheet.state = &#x27;veryHidden&#x27;; å·¥ä½œè¡¨å±æ€§â¬†å·¥ä½œè¡¨æ”¯æŒå±æ€§å­˜å‚¨ï¼Œä»¥å…è®¸æ§åˆ¶å·¥ä½œè¡¨çš„æŸäº›åŠŸèƒ½ã€‚ // åˆ›å»ºå…·æœ‰å±æ€§çš„æ–°å·¥ä½œè¡¨const worksheet = workbook.addWorksheet(&#x27;sheet&#x27;, &#123; properties: &#123; tabColor: &#123; argb: &#x27;FF00FF00&#x27; &#125; &#125;,&#125;);// åˆ›å»ºä¸€ä¸ªå…·æœ‰å±æ€§çš„å¯å†™çš„æ–°å·¥ä½œè¡¨const worksheetWriter = workbookWriter.addWorksheet(&#x27;sheet&#x27;, &#123; properties: &#123; outlineLevelCol: 1 &#125;,&#125;);// ä¹‹åè°ƒæ•´å±æ€§ï¼ˆå·¥ä½œè¡¨è¯»å†™å™¨ä¸æ”¯æŒè¯¥æ“ä½œï¼‰worksheet.properties.outlineLevelCol = 2;worksheet.properties.defaultRowHeight = 15; æ”¯æŒçš„å±æ€§ å±æ€§å é»˜è®¤å€¼ æè¿° tabColor undefined æ ‡ç­¾çš„é¢œè‰² outlineLevelCol 0 å·¥ä½œè¡¨åˆ—å¤§çº²çº§åˆ« outlineLevelRow 0 å·¥ä½œè¡¨è¡Œå¤§çº²çº§åˆ« defaultRowHeight 15 é»˜è®¤è¡Œé«˜ defaultColWidth (optional) é»˜è®¤åˆ—å®½ dyDescent 55 TBD å·¥ä½œè¡¨å°ºå¯¸â¬†ä¸€äº›æ–°çš„å°ºå¯¸å±æ€§å·²æ·»åŠ åˆ°å·¥ä½œè¡¨ä¸­â€¦ å±æ€§å æè¿° rowCount æ–‡æ¡£çš„æ€»è¡Œæ•°ã€‚ ç­‰äºå…·æœ‰å€¼çš„æœ€åä¸€è¡Œçš„è¡Œå·ã€‚ actualRowCount å…·æœ‰å€¼çš„è¡Œæ•°çš„è®¡æ•°ã€‚ å¦‚æœä¸­é—´æ–‡æ¡£è¡Œä¸ºç©ºï¼Œåˆ™è¯¥è¡Œå°†ä¸åŒ…æ‹¬åœ¨è®¡æ•°ä¸­ã€‚ columnCount æ–‡æ¡£çš„æ€»åˆ—æ•°ã€‚ ç­‰äºæ‰€æœ‰è¡Œçš„æœ€å¤§å•å…ƒæ•°ã€‚ actualColumnCount å…·æœ‰å€¼çš„åˆ—æ•°çš„è®¡æ•°ã€‚ é¡µé¢è®¾ç½®â¬†æ‰€æœ‰å¯èƒ½å½±å“å·¥ä½œè¡¨æ‰“å°çš„å±æ€§éƒ½ä¿å­˜åœ¨å·¥ä½œè¡¨ä¸Šçš„ pageSetup å¯¹è±¡ä¸­ã€‚ // ä½¿ç”¨ A4 æ¨ªå‘çš„é¡µé¢è®¾ç½®åˆ›å»ºæ–°å·¥ä½œè¡¨const worksheet = workbook.addWorksheet(&#x27;sheet&#x27;, &#123; pageSetup: &#123; paperSize: 9, orientation: &#x27;landscape&#x27; &#125;,&#125;);// ä½¿ç”¨é€‚åˆé¡µé¢çš„pageSetupè®¾ç½®åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œè¡¨ç¼–å†™å™¨const worksheetWriter = workbookWriter.addWorksheet(&#x27;sheet&#x27;, &#123; pageSetup: &#123; fitToPage: true, fitToHeight: 5, fitToWidth: 7 &#125;,&#125;);// ä¹‹åè°ƒæ•´é¡µé¢è®¾ç½®é…ç½®worksheet.pageSetup.margins = &#123; left: 0.7, right: 0.7, top: 0.75, bottom: 0.75, header: 0.3, footer: 0.3,&#125;;// è®¾ç½®å·¥ä½œè¡¨çš„æ‰“å°åŒºåŸŸworksheet.pageSetup.printArea = &#x27;A1:G20&#x27;;// é€šè¿‡ä½¿ç”¨ `&amp;&amp;` åˆ†éš”æ‰“å°åŒºåŸŸæ¥è®¾ç½®å¤šä¸ªæ‰“å°åŒºåŸŸworksheet.pageSetup.printArea = &#x27;A1:G10&amp;&amp;A11:G20&#x27;;// åœ¨æ¯ä¸ªæ‰“å°é¡µé¢ä¸Šé‡å¤ç‰¹å®šçš„è¡Œworksheet.pageSetup.printTitlesRow = &#x27;1:3&#x27;;// åœ¨æ¯ä¸ªæ‰“å°é¡µé¢ä¸Šé‡å¤ç‰¹å®šåˆ—worksheet.pageSetup.printTitlesColumn = &#x27;A:C&#x27;; æ”¯æŒçš„é¡µé¢è®¾ç½®é…ç½®é¡¹ å±æ€§å é»˜è®¤å€¼ æè¿° margins é¡µé¢ä¸Šçš„ç©ºç™½è¾¹è·ã€‚ å•ä½ä¸ºè‹±å¯¸ã€‚ orientation &#39;portrait&#39; é¡µé¢æ–¹å‘ - å³è¾ƒé«˜ (&#39;portrait&#39;) æˆ–è€…è¾ƒå®½ (&#39;landscape&#39;) horizontalDpi 4294967295 æ°´å¹³æ–¹å‘ä¸Šçš„ DPIã€‚é»˜è®¤å€¼ä¸º -1 verticalDpi 4294967295 å‚ç›´æ–¹å‘ä¸Šçš„ DPIã€‚é»˜è®¤å€¼ä¸º -1 fitToPage æ˜¯å¦ä½¿ç”¨ fitToWidth å’Œ fitToHeight æˆ– scale è®¾ç½®ã€‚é»˜è®¤åŸºäºå­˜åœ¨äº pageSetup å¯¹è±¡ä¸­çš„è®¾ç½®-å¦‚æœä¸¤è€…éƒ½å­˜åœ¨ï¼Œåˆ™ scale ä¼˜å…ˆçº§é«˜ï¼ˆé»˜è®¤å€¼ä¸º falseï¼‰ã€‚ pageOrder &#39;downThenOver&#39; æ‰“å°é¡µé¢çš„é¡ºåº-[&#39;downThenOver&#39;, &#39;overThenDown&#39;] ä¹‹ä¸€ blackAndWhite false æ— è‰²æ‰“å° draft false æ‰“å°è´¨é‡è¾ƒä½ï¼ˆå¢¨æ°´ï¼‰ cellComments &#39;None&#39; åœ¨ä½•å¤„æ”¾ç½®æ‰¹æ³¨-[&#39;atEnd&#39;ï¼Œ&#39;asDisplayed&#39;ï¼Œ&#39;None&#39;]ä¸­çš„ä¸€ä¸ª errors &#39;displayed&#39; å“ªé‡Œæ˜¾ç¤ºé”™è¯¯ -[&#39;dash&#39;, &#39;blank&#39;, &#39;NA&#39;, &#39;displayed&#39;] ä¹‹ä¸€ scale 100 å¢åŠ æˆ–å‡å°æ‰“å°å°ºå¯¸çš„ç™¾åˆ†æ¯”å€¼ã€‚ å½“ fitToPage ä¸º false æ—¶æ¿€æ´» fitToWidth 1 çº¸å¼ åº”æ‰“å°å¤šå°‘é¡µå®½ã€‚ å½“ fitToPage ä¸º true æ—¶æ¿€æ´» fitToHeight 1 çº¸å¼ åº”æ‰“å°å¤šå°‘é¡µé«˜ã€‚ å½“ fitToPage ä¸º true æ—¶æ¿€æ´» paperSize ä½¿ç”¨å“ªç§çº¸å¼ å°ºå¯¸ï¼ˆè§ä¸‹æ–‡ï¼‰ showRowColHeaders false æ˜¯å¦æ˜¾ç¤ºè¡Œå·å’Œåˆ—å­—æ¯ showGridLines false æ˜¯å¦æ˜¾ç¤ºç½‘æ ¼çº¿ firstPageNumber ç¬¬ä¸€é¡µä½¿ç”¨å“ªä¸ªé¡µç  horizontalCentered false æ˜¯å¦å°†å·¥ä½œè¡¨æ•°æ®æ°´å¹³å±…ä¸­ verticalCentered false æ˜¯å¦å°†å·¥ä½œè¡¨æ•°æ®å‚ç›´å±…ä¸­ ç¤ºä¾‹çº¸å¼ å°ºå¯¸ å±æ€§å å€¼ Letter undefined Legal 5 Executive 7 A3 8 A4 9 A5 11 B5 (JIS) 13 Envelope #10 20 Envelope DL 27 Envelope C5 28 Envelope B5 34 Envelope Monarch 37 Double Japan Postcard Rotated 82 16K 197x273 mm 119 é¡µçœ‰å’Œé¡µè„šâ¬†è¿™æ˜¯æ·»åŠ é¡µçœ‰å’Œé¡µè„šçš„æ–¹æ³•ã€‚æ·»åŠ çš„å†…å®¹ä¸»è¦æ˜¯æ–‡æœ¬ï¼Œä¾‹å¦‚æ—¶é—´ï¼Œç®€ä»‹ï¼Œæ–‡ä»¶ä¿¡æ¯ç­‰ï¼Œæ‚¨å¯ä»¥è®¾ç½®æ–‡æœ¬çš„æ ·å¼ã€‚æ­¤å¤–ï¼Œæ‚¨å¯ä»¥ä¸ºé¦–é¡µå’Œå¶æ•°é¡µè®¾ç½®ä¸åŒçš„æ–‡æœ¬ã€‚ æ³¨æ„ï¼šç›®å‰ä¸æ”¯æŒå›¾ç‰‡ã€‚ // åˆ›å»ºä¸€ä¸ªå¸¦æœ‰é¡µçœ‰å’Œé¡µè„šçš„å·¥ä½œè¡¨var sheet = workbook.addWorksheet(&#x27;My Sheet&#x27;, &#123; headerFooter: &#123; firstHeader: &#x27;Hello Exceljs&#x27;, firstFooter: &#x27;Hello World&#x27; &#125;,&#125;);// åˆ›å»ºä¸€ä¸ªå¸¦æœ‰é¡µçœ‰å’Œé¡µè„šå¯å†™çš„å·¥ä½œè¡¨var worksheetWriter = workbookWriter.addWorksheet(&#x27;sheet&#x27;, &#123; headerFooter: &#123; firstHeader: &#x27;Hello Exceljs&#x27;, firstFooter: &#x27;Hello World&#x27; &#125;,&#125;);// ä»£ç ä¸­å‡ºç°çš„&amp;å¼€å¤´å­—ç¬¦å¯¹åº”å˜é‡ï¼Œç›¸å…³ä¿¡æ¯å¯æŸ¥é˜…ä¸‹æ–‡çš„å˜é‡è¡¨// è®¾ç½®é¡µè„š(é»˜è®¤å±…ä¸­),ç»“æœï¼šâ€œç¬¬ 2 é¡µï¼Œå…± 16 é¡µâ€worksheet.headerFooter.oddFooter = &#x27;ç¬¬ &amp;P é¡µï¼Œå…± &amp;N é¡µ&#x27;;// å°†é¡µè„šï¼ˆé»˜è®¤å±…ä¸­ï¼‰è®¾ç½®ä¸ºç²—ä½“ï¼Œç»“æœæ˜¯ï¼šâ€œç¬¬2é¡µï¼Œå…±16é¡µâ€worksheet.headerFooter.oddFooter = &#x27;Page &amp;P of &amp;N&#x27;;// å°†å·¦é¡µè„šè®¾ç½®ä¸º 18px å¹¶ä»¥æ–œä½“æ˜¾ç¤ºã€‚ ç»“æœï¼šâ€œç¬¬2é¡µï¼Œå…±16é¡µâ€worksheet.headerFooter.oddFooter = &#x27;&amp;LPage &amp;P of &amp;N&#x27;;// å°†ä¸­é—´æ ‡é¢˜è®¾ç½®ä¸ºç°è‰²Arilï¼Œç»“æœä¸ºï¼šâ€œ 52 exceljsâ€worksheet.headerFooter.oddHeader = &#x27;&amp;C&amp;KCCCCCC&amp;&quot;Aril&quot;52 exceljs&#x27;;// è®¾ç½®é¡µè„šçš„å·¦ï¼Œä¸­å’Œå³æ–‡æœ¬ã€‚ ç»“æœï¼šé¡µè„šå·¦ä¾§ä¸ºâ€œ Exceljsâ€ã€‚ é¡µè„šä¸­å¿ƒçš„â€œ demo.xlsxâ€ã€‚ é¡µè„šå³ä¾§çš„â€œç¬¬2é¡µâ€worksheet.headerFooter.oddFooter = &#x27;&amp;Lexceljs&amp;C&amp;F&amp;RPage &amp;P&#x27;;// åœ¨é¦–é¡µæ·»åŠ ä¸åŒçš„é¡µçœ‰å’Œé¡µè„šworksheet.headerFooter.differentFirst = true;worksheet.headerFooter.firstHeader = &#x27;Hello Exceljs&#x27;;worksheet.headerFooter.firstFooter = &#x27;Hello World&#x27;; æ”¯æŒçš„ headerFooter è®¾ç½® å±æ€§å é»˜è®¤å€¼ æè¿° differentFirst false å°† differentFirst çš„å€¼è®¾ç½®ä¸º trueï¼Œè¿™è¡¨ç¤ºç¬¬ä¸€é¡µçš„é¡µçœ‰/é¡µè„šä¸å…¶ä»–é¡µä¸åŒ differentOddEven false å°† differentOddEven çš„å€¼è®¾ç½®ä¸º trueï¼Œè¡¨ç¤ºå¥‡æ•°é¡µå’Œå¶æ•°é¡µçš„é¡µçœ‰/é¡µè„šä¸åŒ oddHeader null è®¾ç½®å¥‡æ•°ï¼ˆé»˜è®¤ï¼‰é¡µé¢çš„æ ‡é¢˜å­—ç¬¦ä¸²ï¼Œå¯ä»¥è®¾ç½®æ ¼å¼åŒ–å­—ç¬¦ä¸² oddFooter null è®¾ç½®å¥‡æ•°ï¼ˆé»˜è®¤ï¼‰é¡µé¢çš„é¡µè„šå­—ç¬¦ä¸²ï¼Œå¯ä»¥è®¾ç½®æ ¼å¼åŒ–å­—ç¬¦ä¸² evenHeader null è®¾ç½®å¶æ•°é¡µçš„æ ‡é¢˜å­—ç¬¦ä¸²ï¼Œå¯ä»¥è®¾ç½®æ ¼å¼åŒ–å­—ç¬¦ä¸² evenFooter null ä¸ºå¶æ•°é¡µè®¾ç½®é¡µè„šå­—ç¬¦ä¸²ï¼Œå¯ä»¥è®¾ç½®æ ¼å¼åŒ–å­—ç¬¦ä¸² firstHeader null è®¾ç½®é¦–é¡µçš„æ ‡é¢˜å­—ç¬¦ä¸²ï¼Œå¯ä»¥è®¾ç½®æ ¼å¼åŒ–å­—ç¬¦ä¸² firstFooter null è®¾ç½®é¦–é¡µçš„é¡µè„šå­—ç¬¦ä¸²ï¼Œå¯ä»¥è®¾ç½®æ ¼å¼åŒ–å­—ç¬¦ä¸² è„šæœ¬å‘½ä»¤ å‘½ä»¤ æè¿° &amp;L å°†ä½ç½®è®¾å®šåœ¨å·¦ä¾§ &amp;C å°†ä½ç½®è®¾ç½®åœ¨ä¸­å¿ƒ &amp;R å°†ä½ç½®è®¾å®šåœ¨å³è¾¹ &amp;P å½“å‰é¡µç  &amp;N æ€»é¡µæ•° &amp;D å½“å‰æ—¥æœŸ &amp;T å½“å‰æ—¶é—´ &amp;G ç…§ç‰‡ &amp;A å·¥ä½œè¡¨åç§° &amp;F æ–‡ä»¶åç§° &amp;B åŠ ç²—æ–‡æœ¬ &amp;I æ–œä½“æ–‡æœ¬ &amp;U æ–‡æœ¬ä¸‹åˆ’çº¿ &amp;â€font nameâ€ å­—ä½“åç§°ï¼Œä¾‹å¦‚ï¼†â€œ Arilâ€ &amp;font size å­—ä½“å¤§å°ï¼Œä¾‹å¦‚ 12 &amp;KHEXCode å­—ä½“é¢œè‰²ï¼Œä¾‹å¦‚ &amp;KCCCCCC å·¥ä½œè¡¨è§†å›¾â¬†ç°åœ¨ï¼Œå·¥ä½œè¡¨æ”¯æŒè§†å›¾åˆ—è¡¨ï¼Œè¿™äº›è§†å›¾æ§åˆ¶ Excel å¦‚ä½•æ˜¾ç¤ºå·¥ä½œè¡¨ï¼š frozen - é¡¶éƒ¨å’Œå·¦ä¾§çš„è®¸å¤šè¡Œå’Œåˆ—è¢«å†»ç»“åœ¨é€‚å½“çš„ä½ç½®ã€‚ ä»…å³ä¸‹éƒ¨åˆ†ä¼šæ»šåŠ¨ split - è¯¥è§†å›¾åˆ†ä¸º 4 ä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†å¯åŠç‹¬ç«‹æ»šåŠ¨ã€‚ æ¯ä¸ªè§†å›¾è¿˜æ”¯æŒå„ç§å±æ€§ï¼š å±æ€§å é»˜è®¤å€¼ æè¿° state &#39;normal&#39; æ§åˆ¶è§†å›¾çŠ¶æ€ - &#39;normal&#39;, &#39;frozen&#39; æˆ–è€… &#39;split&#39; ä¹‹ä¸€ rightToLeft false å°†å·¥ä½œè¡¨è§†å›¾çš„æ–¹å‘è®¾ç½®ä¸ºä»å³åˆ°å·¦ activeCell undefined å½“å‰é€‰æ‹©çš„å•å…ƒæ ¼ showRuler true åœ¨é¡µé¢å¸ƒå±€ä¸­æ˜¾ç¤ºæˆ–éšè—æ ‡å°º showRowColHeaders true æ˜¾ç¤ºæˆ–éšè—è¡Œæ ‡é¢˜å’Œåˆ—æ ‡é¢˜ï¼ˆä¾‹å¦‚ï¼Œé¡¶éƒ¨çš„ A1ï¼ŒB1 å’Œå·¦ä¾§çš„ 1,2,3ï¼‰ showGridLines true æ˜¾ç¤ºæˆ–éšè—ç½‘æ ¼çº¿ï¼ˆé’ˆå¯¹æœªå®šä¹‰è¾¹æ¡†çš„å•å…ƒæ ¼æ˜¾ç¤ºï¼‰ zoomScale 100 ç”¨äºè§†å›¾çš„ç¼©æ”¾æ¯”ä¾‹ zoomScaleNormal 100 æ­£å¸¸ç¼©æ”¾è§†å›¾ style undefined æ¼”ç¤ºæ ·å¼- pageBreakPreview æˆ– pageLayout ä¹‹ä¸€ã€‚ æ³¨æ„ï¼šé¡µé¢å¸ƒå±€ä¸ frozen è§†å›¾ä¸å…¼å®¹ å†»ç»“è§†å›¾â¬†å†»ç»“è§†å›¾æ”¯æŒä»¥ä¸‹é¢å¤–å±æ€§ï¼š å±æ€§å é»˜è®¤å€¼ æè¿° xSplit 0 å†»ç»“å¤šå°‘åˆ—ã€‚è¦ä»…å†»ç»“è¡Œï¼Œè¯·å°†å…¶è®¾ç½®ä¸º 0 æˆ– undefined ySplit 0 å†»ç»“å¤šå°‘è¡Œã€‚è¦ä»…å†»ç»“åˆ—ï¼Œè¯·å°†å…¶è®¾ç½®ä¸º 0 æˆ– undefined topLeftCell special å“ªä¸ªå•å…ƒæ ¼å°†åœ¨å³ä¸‹çª—æ ¼ä¸­çš„å·¦ä¸Šè§’ã€‚æ³¨æ„ï¼šä¸èƒ½æ˜¯å†»ç»“å•å…ƒæ ¼ã€‚é»˜è®¤ä¸ºç¬¬ä¸€ä¸ªæœªå†»ç»“çš„å•å…ƒæ ¼ worksheet.views = [ &#123; state: &#x27;frozen&#x27;, xSplit: 2, ySplit: 3, topLeftCell: &#x27;G10&#x27;, activeCell: &#x27;A1&#x27;, &#125;,]; æ‹†åˆ†è§†å›¾â¬†æ‹†åˆ†è§†å›¾æ”¯æŒä»¥ä¸‹é¢å¤–å±æ€§ï¼š å±æ€§å é»˜è®¤å€¼ æè¿° xSplit 0 ä»å·¦ä¾§å¤šå°‘ä¸ªç‚¹èµ·ï¼Œä»¥æ”¾ç½®æ‹†åˆ†å™¨ã€‚è¦å‚ç›´æ‹†åˆ†ï¼Œè¯·å°†å…¶è®¾ç½®ä¸º 0 æˆ– undefined ySplit 0 ä»é¡¶éƒ¨å¤šå°‘ä¸ªç‚¹èµ·ï¼Œæ”¾ç½®æ‹†åˆ†å™¨ã€‚è¦æ°´å¹³æ‹†åˆ†ï¼Œè¯·å°†å…¶è®¾ç½®ä¸º 0 æˆ– undefined topLeftCell undefined å“ªä¸ªå•å…ƒæ ¼å°†åœ¨å³ä¸‹çª—æ ¼ä¸­çš„å·¦ä¸Šè§’ã€‚ activePane undefined å“ªä¸ªçª—æ ¼å°†å¤„äºæ´»åŠ¨çŠ¶æ€-topLeftï¼ŒtopRightï¼ŒbottomLeft å’Œ bottomRight ä¸­çš„ä¸€ä¸ª worksheet.views = [ &#123; state: &#x27;split&#x27;, xSplit: 2000, ySplit: 3000, topLeftCell: &#x27;G10&#x27;, activeCell: &#x27;A1&#x27;, &#125;,]; è‡ªåŠ¨ç­›é€‰å™¨â¬†å¯ä»¥å¯¹å·¥ä½œè¡¨åº”ç”¨è‡ªåŠ¨ç­›é€‰å™¨ã€‚ worksheet.autoFilter = &#x27;A1:C1&#x27;; å°½ç®¡èŒƒå›´å­—ç¬¦ä¸²æ˜¯ autoFilter çš„æ ‡å‡†å½¢å¼ï¼Œä½†å·¥ä½œè¡¨è¿˜å°†æ”¯æŒä»¥ä¸‹å€¼ï¼š // å°†è‡ªåŠ¨ç­›é€‰å™¨è®¾ç½®ä¸ºä» A1 åˆ° C1worksheet.autoFilter = &#123; from: &#x27;A1&#x27;, to: &#x27;C1&#x27;,&#125;;// å°†è‡ªåŠ¨ç­›é€‰å™¨è®¾ç½®ä¸ºä»ç¬¬3è¡Œç¬¬1åˆ—çš„å•å…ƒæ ¼åˆ°ç¬¬5è¡Œç¬¬12åˆ—çš„å•å…ƒæ ¼worksheet.autoFilter = &#123; from: &#123; row: 3, column: 1, &#125;, to: &#123; row: 5, column: 12, &#125;,&#125;;// å°†è‡ªåŠ¨ç­›é€‰å™¨è®¾ç½®ä¸ºä»D3åˆ°ç¬¬7è¡Œç¬¬5åˆ—ä¸­çš„å•å…ƒæ ¼worksheet.autoFilter = &#123; from: &#x27;D3&#x27;, to: &#123; row: 7, column: 5, &#125;,&#125;; åˆ—â¬†// æ·»åŠ åˆ—æ ‡é¢˜å¹¶å®šä¹‰åˆ—é”®å’Œå®½åº¦// æ³¨æ„ï¼šè¿™äº›åˆ—ç»“æ„ä»…æ˜¯æ„å»ºå·¥ä½œç°¿çš„æ–¹ä¾¿ä¹‹å¤„ï¼Œé™¤äº†åˆ—å®½ä¹‹å¤–ï¼Œå®ƒä»¬ä¸ä¼šå®Œå…¨ä¿ç•™ã€‚worksheet.columns = [ &#123; header: &#x27;Id&#x27;, key: &#x27;id&#x27;, width: 10 &#125;, &#123; header: &#x27;Name&#x27;, key: &#x27;name&#x27;, width: 32 &#125;, &#123; header: &#x27;D.O.B.&#x27;, key: &#x27;DOB&#x27;, width: 10, outlineLevel: 1 &#125;,];// é€šè¿‡é”®ï¼Œå­—æ¯å’ŒåŸºäº1çš„åˆ—å·è®¿é—®å•ä¸ªåˆ—const idCol = worksheet.getColumn(&#x27;id&#x27;);const nameCol = worksheet.getColumn(&#x27;B&#x27;);const dobCol = worksheet.getColumn(3);// è®¾ç½®åˆ—å±æ€§// æ³¨æ„ï¼šå°†è¦†ç›– C1 å•å…ƒæ ¼å€¼dobCol.header = &#x27;Date of Birth&#x27;;// æ³¨æ„ï¼šè¿™å°†è¦†ç›– C1:C2 å•å…ƒæ ¼å€¼dobCol.header = [&#x27;Date of Birth&#x27;, &#x27;A.K.A. D.O.B.&#x27;];// ä»ç°åœ¨å¼€å§‹ï¼Œæ­¤åˆ—å°†ä»¥ â€œdobâ€ è€Œä¸æ˜¯ â€œDOBâ€ å»ºç«‹ç´¢å¼•dobCol.key = &#x27;dob&#x27;;dobCol.width = 15;// å¦‚æœéœ€è¦ï¼Œéšè—åˆ—dobCol.hidden = true;// ä¸ºåˆ—è®¾ç½®å¤§çº²çº§åˆ«worksheet.getColumn(4).outlineLevel = 0;worksheet.getColumn(5).outlineLevel = 1;// åˆ—æ”¯æŒä¸€ä¸ªåªè¯»å­—æ®µï¼Œä»¥æŒ‡ç¤ºåŸºäº `OutlineLevel` çš„æŠ˜å çŠ¶æ€expect(worksheet.getColumn(4).collapsed).to.equal(false);expect(worksheet.getColumn(5).collapsed).to.equal(true);// éå†æ­¤åˆ—ä¸­çš„æ‰€æœ‰å½“å‰å•å…ƒæ ¼dobCol.eachCell(function (cell, rowNumber) &#123; // ...&#125;);// éå†æ­¤åˆ—ä¸­çš„æ‰€æœ‰å½“å‰å•å…ƒæ ¼ï¼ŒåŒ…æ‹¬ç©ºå•å…ƒæ ¼dobCol.eachCell(&#123; includeEmpty: true &#125;, function (cell, rowNumber) &#123; // ...&#125;);// æ·»åŠ ä¸€åˆ—æ–°å€¼worksheet.getColumn(6).values = [1, 2, 3, 4, 5];// æ·»åŠ ç¨€ç–åˆ—å€¼worksheet.getColumn(7).values = [, , 2, 3, , 5, , 7, , , , 11];// å‰ªåˆ‡ä¸€åˆ—æˆ–å¤šåˆ—ï¼ˆå³è¾¹çš„åˆ—å‘å·¦ç§»åŠ¨ï¼‰// å¦‚æœå®šä¹‰äº†åˆ—å±æ€§ï¼Œåˆ™ä¼šç›¸åº”åœ°å¯¹å…¶è¿›è¡Œåˆ‡å‰²æˆ–ç§»åŠ¨// å·²çŸ¥é—®é¢˜ï¼šå¦‚æœæ‹¼æ¥å¯¼è‡´ä»»ä½•åˆå¹¶çš„å•å…ƒæ ¼ç§»åŠ¨ï¼Œç»“æœå¯èƒ½æ˜¯ä¸å¯é¢„æµ‹çš„worksheet.spliceColumns(3, 2);// åˆ é™¤ä¸€åˆ—ï¼Œå†æ’å…¥ä¸¤åˆ—ã€‚// æ³¨æ„ï¼šç¬¬4åˆ—åŠä»¥ä¸Šçš„åˆ—å°†å³ç§»1åˆ—ã€‚// å¦å¤–ï¼šå¦‚æœå·¥ä½œè¡¨ä¸­çš„è¡Œæ•°å¤šäºåˆ—æ’å…¥é¡¹ä¸­çš„å€¼ï¼Œåˆ™è¡Œå°†ä»ç„¶è¢«æ’å…¥ï¼Œå°±å¥½åƒå€¼å­˜åœ¨ä¸€æ ·ã€‚const newCol3Values = [1, 2, 3, 4, 5];const newCol4Values = [&#x27;one&#x27;, &#x27;two&#x27;, &#x27;three&#x27;, &#x27;four&#x27;, &#x27;five&#x27;];worksheet.spliceColumns(3, 1, newCol3Values, newCol4Values); è¡Œâ¬†// è·å–ä¸€ä¸ªè¡Œå¯¹è±¡ã€‚å¦‚æœå°šä¸å­˜åœ¨ï¼Œåˆ™å°†è¿”å›ä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡const row = worksheet.getRow(5);// Get multiple row objects. If it doesn&#x27;t already exist, new empty ones will be returnedconst rows = worksheet.getRows(5, 2); // start, length (&gt;0, else undefined is returned)// è·å–å·¥ä½œè¡¨ä¸­çš„æœ€åä¸€ä¸ªå¯ç¼–è¾‘è¡Œï¼ˆå¦‚æœæ²¡æœ‰ï¼Œåˆ™ä¸º `undefined`ï¼‰const row = worksheet.lastRow;// è®¾ç½®ç‰¹å®šçš„è¡Œé«˜row.height = 42.5;// éšè—è¡Œrow.hidden = true;// ä¸ºè¡Œè®¾ç½®å¤§çº²çº§åˆ«worksheet.getRow(4).outlineLevel = 0;worksheet.getRow(5).outlineLevel = 1;// è¡Œæ”¯æŒä¸€ä¸ªåªè¯»å­—æ®µï¼Œä»¥æŒ‡ç¤ºåŸºäº `OutlineLevel` çš„æŠ˜å çŠ¶æ€expect(worksheet.getRow(4).collapsed).to.equal(false);expect(worksheet.getRow(5).collapsed).to.equal(true);row.getCell(1).value = 5; // A5 çš„å€¼è®¾ç½®ä¸º5row.getCell(&#x27;name&#x27;).value = &#x27;Zeb&#x27;; // B5 çš„å€¼è®¾ç½®ä¸º â€œZebâ€ - å‡è®¾ç¬¬2åˆ—ä»æŒ‰åç§°é”®å…¥row.getCell(&#x27;C&#x27;).value = new Date(); // C5 çš„å€¼è®¾ç½®ä¸ºå½“å‰æ—¶é—´// è·å–è¡Œå¹¶ä½œä¸ºç¨€ç–æ•°ç»„è¿”å›// æ³¨æ„ï¼šæ¥å£æ›´æ”¹ï¼šworksheet.getRow(4) ==&gt; worksheet.getRow(4).valuesrow = worksheet.getRow(4).values;expect(row[5]).toEqual(&#x27;Kyle&#x27;);// é€šè¿‡è¿ç»­æ•°ç»„åˆ†é…è¡Œå€¼ï¼ˆå…¶ä¸­æ•°ç»„å…ƒç´  0 å…·æœ‰å€¼ï¼‰row.values = [1, 2, 3];expect(row.getCell(1).value).toEqual(1);expect(row.getCell(2).value).toEqual(2);expect(row.getCell(3).value).toEqual(3);// é€šè¿‡ç¨€ç–æ•°ç»„åˆ†é…è¡Œå€¼ï¼ˆå…¶ä¸­æ•°ç»„å…ƒç´  0 ä¸º `undefined`ï¼‰const values = [];values[5] = 7;values[10] = &#x27;Hello, World!&#x27;;row.values = values;expect(row.getCell(1).value).toBeNull();expect(row.getCell(5).value).toEqual(7);expect(row.getCell(10).value).toEqual(&#x27;Hello, World!&#x27;);// ä½¿ç”¨åˆ—é”®æŒ‰å¯¹è±¡åˆ†é…è¡Œå€¼row.values = &#123; id: 13, name: &#x27;Thing 1&#x27;, dob: new Date(),&#125;;// åœ¨è¯¥è¡Œä¸‹æ–¹æ’å…¥ä¸€ä¸ªåˆ†é¡µç¬¦row.addPageBreak();// éå†å·¥ä½œè¡¨ä¸­å…·æœ‰å€¼çš„æ‰€æœ‰è¡Œworksheet.eachRow(function (row, rowNumber) &#123; console.log(&#x27;Row &#x27; + rowNumber + &#x27; = &#x27; + JSON.stringify(row.values));&#125;);// éå†å·¥ä½œè¡¨ä¸­çš„æ‰€æœ‰è¡Œï¼ˆåŒ…æ‹¬ç©ºè¡Œï¼‰worksheet.eachRow(&#123; includeEmpty: true &#125;, function (row, rowNumber) &#123; console.log(&#x27;Row &#x27; + rowNumber + &#x27; = &#x27; + JSON.stringify(row.values));&#125;);// è¿ç»­éå†æ‰€æœ‰éç©ºå•å…ƒæ ¼row.eachCell(function (cell, colNumber) &#123; console.log(&#x27;Cell &#x27; + colNumber + &#x27; = &#x27; + cell.value);&#125;);// éå†ä¸€è¡Œä¸­çš„æ‰€æœ‰å•å…ƒæ ¼ï¼ˆåŒ…æ‹¬ç©ºå•å…ƒæ ¼ï¼‰row.eachCell(&#123; includeEmpty: true &#125;, function (cell, colNumber) &#123; console.log(&#x27;Cell &#x27; + colNumber + &#x27; = &#x27; + cell.value);&#125;);// æäº¤ç»™æµä¸€ä¸ªå®Œæˆçš„è¡Œrow.commit();// è¡Œå°ºå¯¸const rowSize = row.cellCount;const numValues = row.actualCellCount; Add Rowsâ¬†// Add a couple of Rows by key-value, after the last current row, using the column keysworksheet.addRow(&#123; id: 1, name: &#x27;John Doe&#x27;, dob: new Date(1970, 1, 1) &#125;);worksheet.addRow(&#123; id: 2, name: &#x27;Jane Doe&#x27;, dob: new Date(1965, 1, 7) &#125;);// Add a row by contiguous Array (assign to columns A, B &amp; C)worksheet.addRow([3, &#x27;Sam&#x27;, new Date()]);// Add a row by sparse Array (assign to columns A, E &amp; I)const rowValues = [];rowValues[1] = 4;rowValues[5] = &#x27;Kyle&#x27;;rowValues[9] = new Date();worksheet.addRow(rowValues);// Add a row with inherited style// This new row will have same style as last row// And return as row objectconst newRow = worksheet.addRow(rowValues, &#x27;i&#x27;);// Add an array of rowsconst rows = [ [5, &#x27;Bob&#x27;, new Date()], // row by array &#123; id: 6, name: &#x27;Barbara&#x27;, dob: new Date() &#125;,];// add new rows and return them as array of row objectsconst newRows = worksheet.addRows(rows);// Add an array of rows with inherited style// These new rows will have same styles as last row// and return them as array of row objectsconst newRowsStyled = worksheet.addRows(rows, &#x27;i&#x27;); Parameter Description Default Value value/s The new row/s values style â€˜iâ€™ for inherit from row above, â€˜i+â€™ to include empty cells, â€˜nâ€™ for none â€˜nâ€™ å¤„ç†å•ä¸ªå•å…ƒæ ¼â¬†const cell = worksheet.getCell(&#x27;C3&#x27;);// ä¿®æ”¹/æ·»åŠ å•ä¸ªå•å…ƒæ ¼cell.value = new Date(1968, 5, 1);// æŸ¥è¯¢å•å…ƒæ ¼çš„ç±»å‹expect(cell.type).toEqual(Excel.ValueType.Date);// ä½¿ç”¨å•å…ƒæ ¼çš„å­—ç¬¦ä¸²å€¼myInput.value = cell.text;// ä½¿ç”¨ html å®‰å…¨çš„å­—ç¬¦ä¸²è¿›è¡Œæ¸²æŸ“...const html = &#x27;&lt;div&gt;&#x27; + cell.html + &#x27;&lt;/div&gt;&#x27;; åˆå¹¶å•å…ƒæ ¼â¬†// åˆå¹¶ä¸€ç³»åˆ—å•å…ƒæ ¼worksheet.mergeCells(&#x27;A4:B5&#x27;);// ...åˆå¹¶çš„å•å…ƒæ ¼è¢«é“¾æ¥èµ·æ¥äº†worksheet.getCell(&#x27;B5&#x27;).value = &#x27;Hello, World!&#x27;;expect(worksheet.getCell(&#x27;B5&#x27;).value).toBe(worksheet.getCell(&#x27;A4&#x27;).value);expect(worksheet.getCell(&#x27;B5&#x27;).master).toBe(worksheet.getCell(&#x27;A4&#x27;));// ...åˆå¹¶çš„å•å…ƒæ ¼å…±äº«ç›¸åŒçš„æ ·å¼å¯¹è±¡expect(worksheet.getCell(&#x27;B5&#x27;).style).toBe(worksheet.getCell(&#x27;A4&#x27;).style);worksheet.getCell(&#x27;B5&#x27;).style.font = myFonts.arial;expect(worksheet.getCell(&#x27;A4&#x27;).style.font).toBe(myFonts.arial);// å–æ¶ˆå•å…ƒæ ¼åˆå¹¶å°†æ‰“ç ´é“¾æ¥çš„æ ·å¼worksheet.unMergeCells(&#x27;A4&#x27;);expect(worksheet.getCell(&#x27;B5&#x27;).style).not.toBe(worksheet.getCell(&#x27;A4&#x27;).style);expect(worksheet.getCell(&#x27;B5&#x27;).style.font).not.toBe(myFonts.arial);// æŒ‰å·¦ä¸Šï¼Œå³ä¸‹åˆå¹¶worksheet.mergeCells(&#x27;K10&#x27;, &#x27;M12&#x27;);// æŒ‰å¼€å§‹è¡Œï¼Œå¼€å§‹åˆ—ï¼Œç»“æŸè¡Œï¼Œç»“æŸåˆ—åˆå¹¶ï¼ˆç›¸å½“äº K10:M12ï¼‰worksheet.mergeCells(10, 11, 12, 13); Insert Rowsâ¬†insertRow(pos, value, (style = &#x27;n&#x27;));insertRows(pos, values, (style = &#x27;n&#x27;));// Insert a couple of Rows by key-value, shifting down rows every timeworksheet.insertRow(1, &#123; id: 1, name: &#x27;John Doe&#x27;, dob: new Date(1970, 1, 1) &#125;);worksheet.insertRow(1, &#123; id: 2, name: &#x27;Jane Doe&#x27;, dob: new Date(1965, 1, 7) &#125;);// Insert a row by contiguous Array (assign to columns A, B &amp; C)worksheet.insertRow(1, [3, &#x27;Sam&#x27;, new Date()]);// Insert a row by sparse Array (assign to columns A, E &amp; I)var rowValues = [];rowValues[1] = 4;rowValues[5] = &#x27;Kyle&#x27;;rowValues[9] = new Date();// insert new row and return as row objectconst insertedRow = worksheet.insertRow(1, rowValues);// Insert a row, with inherited style// This new row will have same style as row on top of it// And return as row objectconst insertedRowInherited = worksheet.insertRow(1, rowValues, &#x27;i&#x27;);// Insert a row, keeping original style// This new row will have same style as it was previously// And return as row objectconst insertedRowOriginal = worksheet.insertRow(1, rowValues, &#x27;o&#x27;);// Insert an array of rows, in position 1, shifting down current position 1 and later rows by 2 rowsvar rows = [ [5, &#x27;Bob&#x27;, new Date()], // row by array &#123; id: 6, name: &#x27;Barbara&#x27;, dob: new Date() &#125;,];// insert new rows and return them as array of row objectsconst insertedRows = worksheet.insertRows(1, rows);// Insert an array of rows, with inherited style// These new rows will have same style as row on top of it// And return them as array of row objectsconst insertedRowsInherited = worksheet.insertRows(1, rows, &#x27;i&#x27;);// Insert an array of rows, keeping original style// These new rows will have same style as it was previously in &#x27;pos&#x27; positionconst insertedRowsOriginal = worksheet.insertRows(1, rows, &#x27;o&#x27;); Parameter Description Default Value pos Row number where you want to insert, pushing down all rows from there value/s The new row/s values style â€˜iâ€™ for inherit from row above, , â€˜i+â€™ to include empty cells, â€˜oâ€™ for original style, â€˜o+â€™ to include empty cells, â€˜nâ€™ for none â€˜nâ€™ Spliceâ¬†// Cut one or more rows (rows below are shifted up)// Known Issue: If a splice causes any merged cells to move, the results may be unpredictableworksheet.spliceRows(4, 3);// remove one row and insert two more.// Note: rows 4 and below will be shifted down by 1 row.const newRow3Values = [1, 2, 3, 4, 5];const newRow4Values = [&#x27;one&#x27;, &#x27;two&#x27;, &#x27;three&#x27;, &#x27;four&#x27;, &#x27;five&#x27;];worksheet.spliceRows(3, 1, newRow3Values, newRow4Values);// Cut one or more cells (cells to the right are shifted left)// Note: this operation will not affect other rowsrow.splice(3, 2);// remove one cell and insert two more (cells to the right of the cut cell will be shifted right)row.splice(4, 1, &#x27;new value 1&#x27;, &#x27;new value 2&#x27;); Parameter Description Default Value start Starting point to splice from count Number of rows/cells to remove â€¦inserts New row/cell values to insert é‡å¤è¡Œâ¬†duplicateRow(start, (amount = 1), (insert = true));const wb = new ExcelJS.Workbook();const ws = wb.addWorksheet(&#x27;duplicateTest&#x27;);ws.getCell(&#x27;A1&#x27;).value = &#x27;One&#x27;;ws.getCell(&#x27;A2&#x27;).value = &#x27;Two&#x27;;ws.getCell(&#x27;A3&#x27;).value = &#x27;Three&#x27;;ws.getCell(&#x27;A4&#x27;).value = &#x27;Four&#x27;;// è¯¥è¡Œå°†é‡å¤å¤åˆ¶ç¬¬ä¸€è¡Œä¸¤æ¬¡ï¼Œä½†å°†æ›¿æ¢ç¬¬äºŒè¡Œå’Œç¬¬ä¸‰è¡Œ// å¦‚æœç¬¬ä¸‰ä¸ªå‚æ•°ä¸º trueï¼Œåˆ™å®ƒå°†æ’å…¥2ä¸ªæ–°è¡Œï¼Œå…¶ä¸­åŒ…å«è¡Œ â€œOneâ€ çš„å€¼å’Œæ ·å¼ws.duplicateRow(1, 2, false); å‚æ•° æè¿° é»˜è®¤å€¼ start è¦å¤åˆ¶çš„è¡Œå·ï¼ˆExcel ä¸­çš„ç¬¬ä¸€ä¸ªæ˜¯ 1ï¼‰ amount æ‚¨è¦å¤åˆ¶è¡Œçš„æ¬¡æ•° 1 insert å¦‚æœè¦ä¸ºé‡å¤é¡¹æ’å…¥æ–°è¡Œï¼Œåˆ™ä¸º trueï¼Œå¦åˆ™ä¸º false å°†æ›¿æ¢å·²æœ‰è¡Œ true å®šä¹‰åç§°â¬†å•ä¸ªå•å…ƒæ ¼ï¼ˆæˆ–å¤šä¸ªå•å…ƒæ ¼ç»„ï¼‰å¯ä»¥ä¸ºå®ƒä»¬åˆ†é…åç§°ã€‚åç§°å¯ç”¨äºå…¬å¼å’Œæ•°æ®éªŒè¯ï¼ˆå¯èƒ½è¿˜æœ‰æ›´å¤šï¼‰ã€‚ // ä¸ºå•å…ƒæ ¼åˆ†é…ï¼ˆæˆ–è·å–ï¼‰åç§°ï¼ˆå°†è¦†ç›–è¯¥å•å…ƒå…·æœ‰çš„å…¶ä»–ä»»ä½•åç§°ï¼‰worksheet.getCell(&#x27;A1&#x27;).name = &#x27;PI&#x27;;expect(worksheet.getCell(&#x27;A1&#x27;).name).to.equal(&#x27;PI&#x27;);// ä¸ºå•å…ƒæ ¼åˆ†é…ï¼ˆæˆ–è·å–ï¼‰ä¸€ç»„åç§°ï¼ˆå•å…ƒå¯ä»¥å…·æœ‰å¤šä¸ªåç§°ï¼‰worksheet.getCell(&#x27;A1&#x27;).names = [&#x27;thing1&#x27;, &#x27;thing2&#x27;];expect(worksheet.getCell(&#x27;A1&#x27;).names).to.have.members([&#x27;thing1&#x27;, &#x27;thing2&#x27;]);// ä»å•å…ƒæ ¼ä¸­åˆ é™¤åç§°worksheet.getCell(&#x27;A1&#x27;).removeName(&#x27;thing1&#x27;);expect(worksheet.getCell(&#x27;A1&#x27;).names).to.have.members([&#x27;thing2&#x27;]); æ•°æ®éªŒè¯â¬†å•å…ƒæ ¼å¯ä»¥å®šä¹‰å“ªäº›å€¼æœ‰æ•ˆæˆ–æ— æ•ˆï¼Œå¹¶æç¤ºç”¨æˆ·ä»¥å¸®åŠ©æŒ‡å¯¼å®ƒä»¬ã€‚ éªŒè¯ç±»å‹å¯ä»¥æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š ç±»å‹ æè¿° list å®šä¹‰ä¸€ç»„ç¦»æ•£çš„æœ‰æ•ˆå€¼ã€‚Excel å°†åœ¨ä¸‹æ‹‰èœå•ä¸­æä¾›è¿™äº›å†…å®¹ï¼Œä»¥ä¾¿äºè¾“å…¥ whole è¯¥å€¼å¿…é¡»æ˜¯æ•´æ•° decimal è¯¥å€¼å¿…é¡»æ˜¯åè¿›åˆ¶æ•° textLength è¯¥å€¼å¯ä»¥æ˜¯æ–‡æœ¬ï¼Œä½†é•¿åº¦æ˜¯å—æ§çš„ custom è‡ªå®šä¹‰å…¬å¼æ§åˆ¶æœ‰æ•ˆå€¼ å¯¹äº list æˆ– custom ä»¥å¤–çš„å…¶ä»–ç±»å‹ï¼Œä»¥ä¸‹è¿ç®—ç¬¦ä¼šå½±å“éªŒè¯ï¼š è¿ç®—ç¬¦ æè¿° between å€¼å¿…é¡»ä»‹äºå…¬å¼ç»“æœä¹‹é—´ notBetween å€¼ä¸èƒ½ä»‹äºå…¬å¼ç»“æœä¹‹é—´ equal å€¼å¿…é¡»ç­‰äºå…¬å¼ç»“æœ notEqual å€¼ä¸èƒ½ç­‰äºå…¬å¼ç»“æœ greaterThan å€¼å¿…é¡»å¤§äºå…¬å¼ç»“æœ lessThan å€¼å¿…é¡»å°äºå…¬å¼ç»“æœ greaterThanOrEqual å€¼å¿…é¡»å¤§äºæˆ–ç­‰äºå…¬å¼ç»“æœ lessThanOrEqual å€¼å¿…é¡»å°äºæˆ–ç­‰äºå…¬å¼ç»“æœ // æŒ‡å®šæœ‰æ•ˆå€¼çš„åˆ—è¡¨ï¼ˆOneï¼ŒTwoï¼ŒThreeï¼ŒFourï¼‰ã€‚// Excel å°†æä¾›ä¸€ä¸ªåŒ…å«è¿™äº›å€¼çš„ä¸‹æ‹‰åˆ—è¡¨ã€‚worksheet.getCell(&#x27;A1&#x27;).dataValidation = &#123; type: &#x27;list&#x27;, allowBlank: true, formulae: [&#x27;&quot;One,Two,Three,Four&quot;&#x27;],&#125;;// æŒ‡å®šèŒƒå›´å†…çš„æœ‰æ•ˆå€¼åˆ—è¡¨ã€‚// Excel å°†æä¾›ä¸€ä¸ªåŒ…å«è¿™äº›å€¼çš„ä¸‹æ‹‰åˆ—è¡¨ã€‚worksheet.getCell(&#x27;A1&#x27;).dataValidation = &#123; type: &#x27;list&#x27;, allowBlank: true, formulae: [&#x27;$D$5:$F$5&#x27;],&#125;;// æŒ‡å®šå•å…ƒæ ¼å¿…é¡»ä¸ºé5çš„æ•´æ•°ã€‚// å‘ç”¨æˆ·æ˜¾ç¤ºé€‚å½“çš„é”™è¯¯æ¶ˆæ¯ï¼ˆå¦‚æœä»–ä»¬å¼„é”™äº†ï¼‰worksheet.getCell(&#x27;A1&#x27;).dataValidation = &#123; type: &#x27;whole&#x27;, operator: &#x27;notEqual&#x27;, showErrorMessage: true, formulae: [5], errorStyle: &#x27;error&#x27;, errorTitle: &#x27;Five&#x27;, error: &#x27;The value must not be Five&#x27;,&#125;;// æŒ‡å®šå•å…ƒæ ¼å¿…é¡»ä¸º1.5åˆ°7ä¹‹é—´çš„åè¿›åˆ¶æ•°å­—ã€‚// æ·»åŠ â€œå·¥å…·æç¤ºâ€ä»¥å¸®åŠ©æŒ‡å¯¼ç”¨æˆ·worksheet.getCell(&#x27;A1&#x27;).dataValidation = &#123; type: &#x27;decimal&#x27;, operator: &#x27;between&#x27;, allowBlank: true, showInputMessage: true, formulae: [1.5, 7], promptTitle: &#x27;Decimal&#x27;, prompt: &#x27;The value must between 1.5 and 7&#x27;,&#125;;// æŒ‡å®šå•å…ƒæ ¼çš„æ–‡æœ¬é•¿åº¦å¿…é¡»å°äº15worksheet.getCell(&#x27;A1&#x27;).dataValidation = &#123; type: &#x27;textLength&#x27;, operator: &#x27;lessThan&#x27;, showErrorMessage: true, allowBlank: true, formulae: [15],&#125;;// æŒ‡å®šå•å…ƒæ ¼å¿…é¡»æ˜¯2016å¹´1æœˆ1æ—¥ä¹‹å‰çš„æ—¥æœŸworksheet.getCell(&#x27;A1&#x27;).dataValidation = &#123; type: &#x27;date&#x27;, operator: &#x27;lessThan&#x27;, showErrorMessage: true, allowBlank: true, formulae: [new Date(2016, 0, 1)],&#125;; å•å…ƒæ ¼æ³¨é‡Šâ¬†å°†æ—§æ ·å¼çš„æ³¨é‡Šæ·»åŠ åˆ°å•å…ƒæ ¼ // çº¯æ–‡å­—ç¬”è®°worksheet.getCell(&#x27;A1&#x27;).note = &#x27;Hello, ExcelJS!&#x27;;// å½©è‰²æ ¼å¼åŒ–çš„ç¬”è®°ws.getCell(&#x27;B1&#x27;).note = &#123; texts: [ &#123; font: &#123; size: 12, color: &#123; theme: 0 &#125;, name: &#x27;Calibri&#x27;, family: 2, scheme: &#x27;minor&#x27;, &#125;, text: &#x27;This is &#x27;, &#125;, &#123; font: &#123; italic: true, size: 12, color: &#123; theme: 0 &#125;, name: &#x27;Calibri&#x27;, scheme: &#x27;minor&#x27;, &#125;, text: &#x27;a&#x27;, &#125;, &#123; font: &#123; size: 12, color: &#123; theme: 1 &#125;, name: &#x27;Calibri&#x27;, family: 2, scheme: &#x27;minor&#x27;, &#125;, text: &#x27; &#x27;, &#125;, &#123; font: &#123; size: 12, color: &#123; argb: &#x27;FFFF6600&#x27; &#125;, name: &#x27;Calibri&#x27;, scheme: &#x27;minor&#x27;, &#125;, text: &#x27;colorful&#x27;, &#125;, &#123; font: &#123; size: 12, color: &#123; theme: 1 &#125;, name: &#x27;Calibri&#x27;, family: 2, scheme: &#x27;minor&#x27;, &#125;, text: &#x27; text &#x27;, &#125;, &#123; font: &#123; size: 12, color: &#123; argb: &#x27;FFCCFFCC&#x27; &#125;, name: &#x27;Calibri&#x27;, scheme: &#x27;minor&#x27;, &#125;, text: &#x27;with&#x27;, &#125;, &#123; font: &#123; size: 12, color: &#123; theme: 1 &#125;, name: &#x27;Calibri&#x27;, family: 2, scheme: &#x27;minor&#x27;, &#125;, text: &#x27; in-cell &#x27;, &#125;, &#123; font: &#123; bold: true, size: 12, color: &#123; theme: 1 &#125;, name: &#x27;Calibri&#x27;, family: 2, scheme: &#x27;minor&#x27;, &#125;, text: &#x27;format&#x27;, &#125;, ], margins: &#123; insetmode: &#x27;custom&#x27;, inset: [0.25, 0.25, 0.35, 0.35], &#125;, protection: &#123; locked: True, lockText: False, &#125;, editAs: &#x27;twoCells&#x27;,&#125;; å•å…ƒæ ¼æ‰¹æ³¨å±æ€§â¬†ä¸‹è¡¨å®šä¹‰äº†å•å…ƒæ ¼æ³¨é‡Šå·²æ”¯æŒçš„å±æ€§ã€‚ Field Required Default Value Description texts Y è¯„è®ºæ–‡å­— margins N {} ç¡®å®šè‡ªåŠ¨æˆ–è‡ªå®šä¹‰è®¾ç½®å•å…ƒæ ¼æ³¨é‡Šçš„è¾¹è·å€¼ protection N {} å¯ä»¥ä½¿ç”¨ä¿æŠ¤å±æ€§æ¥æŒ‡å®šå¯¹è±¡å’Œå¯¹è±¡æ–‡æœ¬çš„é”å®šçŠ¶æ€ editAs N â€˜absoluteâ€™ å¯ä»¥ä½¿ç”¨â€™editAsâ€™å±æ€§æ¥æŒ‡å®šæ³¨é‡Šå¦‚ä½•é”šå®šåˆ°å•å…ƒæ ¼ å•å…ƒæ ¼æ‰¹æ³¨é¡µè¾¹è·â¬†ç¡®å®šå•å…ƒæ ¼æ‰¹æ³¨çš„é¡µé¢è·è®¾ç½®æ¨¡å¼ï¼Œè‡ªåŠ¨æˆ–è€…è‡ªå®šä¹‰æ¨¡å¼ã€‚ ws.getCell(&#x27;B1&#x27;).note.margins = &#123; insetmode: &#x27;custom&#x27;, inset: [0.25, 0.25, 0.35, 0.35],&#125;; å·²æ”¯æŒçš„é¡µè¾¹è·å±æ€§â¬† Property Required Default Value Description insetmode N â€˜autoâ€™ ç¡®å®šæ˜¯å¦è‡ªåŠ¨è®¾ç½®æ³¨é‡Šè¾¹è·ï¼Œå¹¶ä¸”å€¼æ˜¯â€™autoâ€™ æˆ–è€… â€˜customâ€™ inset N [0.13, 0.13, 0.25, 0.25] æ‰¹æ³¨é¡µè¾¹è·çš„å€¼ï¼Œå•ä½æ˜¯å˜ç±³, æ–¹å‘æ˜¯å·¦-ä¸Š-å³-ä¸‹ æ³¨æ„ï¼šåªæœ‰å½“ insetmodeçš„å€¼è®¾ç½®ä¸ºâ€™customâ€™æ—¶ï¼Œinsetçš„è®¾ç½®æ‰ç”Ÿæ•ˆã€‚ å•å…ƒæ ¼æ‰¹æ³¨ä¿æŠ¤â¬†å¯ä»¥ä½¿ç”¨ä¿æŠ¤å±æ€§æ¥ä¿®æ”¹å•å…ƒçº§åˆ«ä¿æŠ¤ã€‚ ws.getCell(&#x27;B1&#x27;).note.protection = &#123; locked: &#x27;False&#x27;, lockText: &#x27;False&#x27;,&#125;; å·²æ”¯æŒçš„ä¿æŠ¤å±æ€§â¬† Property Required Default Value Description locked N â€˜Trueâ€™ æ­¤å…ƒç´ æŒ‡å®šåœ¨ä¿æŠ¤å·¥ä½œè¡¨æ—¶å¯¹è±¡å·²é”å®š lockText N â€˜Trueâ€™ è¯¥å…ƒç´ æŒ‡å®šå¯¹è±¡çš„æ–‡æœ¬å·²é”å®š å•å…ƒæ ¼æ‰¹æ³¨å¯¹è±¡ä½ç½®å±æ€§â¬†å•å…ƒæ ¼æ³¨é‡Šè¿˜å¯ä»¥å…·æœ‰å±æ€§ â€˜editAsâ€™ï¼Œè¯¥å±æ€§å°†æ§åˆ¶æ³¨é‡Šå¦‚ä½•é”šå®šåˆ°å•å…ƒæ ¼ã€‚å®ƒå¯ä»¥å…·æœ‰ä»¥ä¸‹å€¼ä¹‹ä¸€ï¼š ws.getCell(&#x27;B1&#x27;).note.editAs = &#x27;twoCells&#x27;; Value Description twoCells å®ƒæŒ‡å®šæ³¨é‡Šçš„å¤§å°ã€ä½ç½®éšå•å…ƒæ ¼è€Œå˜ oneCells å®ƒæŒ‡å®šæ³¨é‡Šçš„å¤§å°å›ºå®šï¼Œä½ç½®éšå•å…ƒæ ¼è€Œå˜ absolute è¿™æ˜¯é»˜è®¤å€¼ï¼Œå®ƒæŒ‡å®šæ³¨é‡Šçš„å¤§å°ã€ä½ç½®å‡å›ºå®š è¡¨æ ¼â¬†è¡¨å…è®¸è¡¨æ ¼å†…æ•°æ®çš„è¡¨å†…æ“ä½œã€‚ è¦å°†è¡¨æ·»åŠ åˆ°å·¥ä½œè¡¨ï¼Œè¯·å®šä¹‰è¡¨æ¨¡å‹å¹¶è°ƒç”¨ addTableï¼š // å°†è¡¨æ ¼æ·»åŠ åˆ°å·¥ä½œè¡¨ws.addTable(&#123; name: &#x27;MyTable&#x27;, ref: &#x27;A1&#x27;, headerRow: true, totalsRow: true, style: &#123; theme: &#x27;TableStyleDark3&#x27;, showRowStripes: true, &#125;, columns: [ &#123; name: &#x27;Date&#x27;, totalsRowLabel: &#x27;Totals:&#x27;, filterButton: true &#125;, &#123; name: &#x27;Amount&#x27;, totalsRowFunction: &#x27;sum&#x27;, filterButton: false &#125;, ], rows: [ [new Date(&#x27;2019-07-20&#x27;), 70.1], [new Date(&#x27;2019-07-21&#x27;), 70.6], [new Date(&#x27;2019-07-22&#x27;), 70.1], ],&#125;); æ³¨æ„ï¼šå°†è¡¨æ ¼æ·»åŠ åˆ°å·¥ä½œè¡¨å°†é€šè¿‡æ”¾ç½®è¡¨æ ¼çš„æ ‡é¢˜å’Œè¡Œæ•°æ®æ¥ä¿®æ”¹å·¥ä½œè¡¨ã€‚ç»“æœå°±æ˜¯è¡¨æ ¼è¦†ç›–çš„å·¥ä½œè¡¨ä¸Šçš„æ‰€æœ‰æ•°æ®ï¼ˆåŒ…æ‹¬æ ‡é¢˜å’Œæ‰€æœ‰çš„ï¼‰éƒ½å°†è¢«è¦†ç›–ã€‚ è¡¨æ ¼å±æ€§â¬†ä¸‹è¡¨å®šä¹‰äº†è¡¨æ ¼æ”¯æŒçš„å±æ€§ã€‚ è¡¨å±æ€§ æè¿° æ˜¯å¦éœ€è¦ é»˜è®¤å€¼ name è¡¨æ ¼åç§° Y displayName è¡¨æ ¼çš„æ˜¾ç¤ºåç§° N name ref è¡¨æ ¼çš„å·¦ä¸Šæ–¹å•å…ƒæ ¼ Y headerRow åœ¨è¡¨æ ¼é¡¶éƒ¨æ˜¾ç¤ºæ ‡é¢˜ N true totalsRow åœ¨è¡¨æ ¼åº•éƒ¨æ˜¾ç¤ºæ€»è®¡ N false style é¢å¤–çš„æ ·å¼å±æ€§ N {} columns åˆ—å®šä¹‰ Y rows æ•°æ®è¡Œ Y è¡¨æ ¼æ ·å¼å±æ€§â¬†ä¸‹è¡¨å®šä¹‰äº†è¡¨æ ¼ä¸­æ”¯æŒçš„å±æ€§æ ·å¼å±æ€§ã€‚ æ ·å¼å±æ€§ æè¿° æ˜¯å¦éœ€è¦ é»˜è®¤å€¼ theme æ¡Œå­çš„é¢œè‰²ä¸»é¢˜ N &#39;TableStyleMedium2&#39; showFirstColumn çªå‡ºæ˜¾ç¤ºç¬¬ä¸€åˆ—ï¼ˆç²—ä½“ï¼‰ N false showLastColumn çªå‡ºæ˜¾ç¤ºæœ€åä¸€åˆ—ï¼ˆç²—ä½“ï¼‰ N false showRowStripes ç”¨äº¤æ›¿çš„èƒŒæ™¯è‰²æ˜¾ç¤ºè¡Œ N false showColumnStripes ç”¨äº¤æ›¿çš„èƒŒæ™¯è‰²æ˜¾ç¤ºåˆ— N false è¡¨æ ¼åˆ—å±æ€§â¬†ä¸‹è¡¨å®šä¹‰äº†æ¯ä¸ªè¡¨æ ¼åˆ—ä¸­æ”¯æŒçš„å±æ€§ã€‚ åˆ—å±æ€§ æè¿° æ˜¯å¦éœ€è¦ é»˜è®¤å€¼ name åˆ—åï¼Œä¹Ÿç”¨åœ¨æ ‡é¢˜ä¸­ Y filterButton åˆ‡æ¢æ ‡é¢˜ä¸­çš„è¿‡æ»¤å™¨æ§ä»¶ N false totalsRowLabel ç”¨äºæè¿°ç»Ÿè®¡è¡Œçš„æ ‡ç­¾ï¼ˆç¬¬ä¸€åˆ—ï¼‰ N &#39;Total&#39; totalsRowFunction ç»Ÿè®¡å‡½æ•°åç§° N &#39;none&#39; totalsRowFormula è‡ªå®šä¹‰å‡½æ•°çš„å¯é€‰å…¬å¼ N ç»Ÿè®¡å‡½æ•°â¬†ä¸‹è¡¨åˆ—å‡ºäº†ç”±åˆ—å®šä¹‰çš„ totalsRowFunction å±æ€§çš„æœ‰æ•ˆå€¼ã€‚å¦‚æœä½¿ç”¨ &#39;custom&#39; ä»¥å¤–çš„ä»»ä½•å€¼ï¼Œåˆ™æ— éœ€åŒ…æ‹¬å…³è”çš„å…¬å¼ï¼Œå› ä¸ºè¯¥å…¬å¼å°†è¢«è¡¨æ ¼æ’å…¥ã€‚ ç»Ÿè®¡å‡½æ•° æè¿° none æ­¤åˆ—æ²¡æœ‰ç»Ÿè®¡å‡½æ•° average è®¡ç®—åˆ—çš„å¹³å‡å€¼ countNums ç»Ÿè®¡æ•°å­—æ¡ç›®æ•° count æ¡ç›®æ•° max æ­¤åˆ—ä¸­çš„æœ€å¤§å€¼ min æ­¤åˆ—ä¸­çš„æœ€å°å€¼ stdDev è¯¥åˆ—çš„æ ‡å‡†åå·® var æ­¤åˆ—çš„æ–¹å·® sum æ­¤åˆ—çš„æ¡ç›®æ€»æ•° custom è‡ªå®šä¹‰å…¬å¼ã€‚ éœ€è¦å…³è”çš„ totalsRowFormula å€¼ã€‚ è¡¨æ ¼æ ·å¼ä¸»é¢˜â¬†æœ‰æ•ˆçš„ä¸»é¢˜åç§°éµå¾ªä»¥ä¸‹æ¨¡å¼ï¼š â€œTableStyle[Shade][Number]â€ Shadesï¼ˆé˜´å½±ï¼‰ï¼ŒNumberï¼ˆæ•°å­—ï¼‰å¯ä»¥æ˜¯ä»¥ä¸‹ä¹‹ä¸€ï¼š Light, 1-21 Medium, 1-28 Dark, 1-11 å¯¹äºæ— ä¸»é¢˜ï¼Œè¯·ä½¿ç”¨å€¼ nullã€‚ æ³¨æ„ï¼šexceljs å°šä¸æ”¯æŒè‡ªå®šä¹‰è¡¨æ ¼ä¸»é¢˜ã€‚ ä¿®æ”¹è¡¨æ ¼â¬†è¡¨æ ¼æ”¯æŒä¸€ç»„æ“ä½œå‡½æ•°ï¼Œè¿™äº›æ“ä½œå‡½æ•°å…è®¸æ·»åŠ æˆ–åˆ é™¤æ•°æ®ä»¥åŠæ›´æ”¹æŸäº›å±æ€§ã€‚ç”±äºè¿™äº›æ“ä½œä¸­çš„è®¸å¤šæ“ä½œå¯èƒ½ä¼šå¯¹å·¥ä½œè¡¨äº§ç”Ÿå‰¯ä½œç”¨ï¼Œå› æ­¤æ›´æ”¹å¿…é¡»åœ¨å®Œæˆåç«‹å³æäº¤ã€‚ è¡¨ä¸­çš„æ‰€æœ‰ç´¢å¼•å€¼å‡åŸºäºé›¶ï¼Œå› æ­¤ç¬¬ä¸€è¡Œå·å’Œç¬¬ä¸€åˆ—å·ä¸º 0ã€‚ æ·»åŠ æˆ–åˆ é™¤æ ‡é¢˜å’Œç»Ÿè®¡ const table = ws.getTable(&#x27;MyTable&#x27;);// æ‰“å¼€æ ‡é¢˜è¡Œtable.headerRow = true;// å…³é—­ç»Ÿè®¡è¡Œtable.totalsRow = false;// å°†è¡¨æ›´æ”¹æäº¤åˆ°å·¥ä½œè¡¨ä¸­table.commit(); é‡å®šä½è¡¨ const table = ws.getTable(&#x27;MyTable&#x27;);// è¡¨æ ¼å·¦ä¸Šç§»è‡³ D4table.ref = &#x27;D4&#x27;;// å°†è¡¨æ›´æ”¹æäº¤åˆ°å·¥ä½œè¡¨ä¸­table.commit(); æ·»åŠ å’Œåˆ é™¤è¡Œ const table = ws.getTable(&#x27;MyTable&#x27;);// åˆ é™¤å‰ä¸¤è¡Œtable.removeRows(0, 2);// åœ¨ç´¢å¼• 5 å¤„æ’å…¥æ–°è¡Œtable.addRow([new Date(&#x27;2019-08-05&#x27;), 5, &#x27;Mid&#x27;], 5);// åœ¨è¡¨æ ¼åº•éƒ¨è¿½åŠ æ–°è¡Œtable.addRow([new Date(&#x27;2019-08-10&#x27;), 10, &#x27;End&#x27;]);// å°†è¡¨æ›´æ”¹æäº¤åˆ°å·¥ä½œè¡¨ä¸­table.commit(); æ·»åŠ å’Œåˆ é™¤åˆ— const table = ws.getTable(&#x27;MyTable&#x27;);// åˆ é™¤ç¬¬äºŒåˆ—table.removeColumns(1, 1);// åœ¨ç´¢å¼• 1 å¤„æ’å…¥æ–°åˆ—ï¼ˆåŒ…å«æ•°æ®ï¼‰table.addColumn( &#123; name: &#x27;Letter&#x27;, totalsRowFunction: &#x27;custom&#x27;, totalsRowFormula: &#x27;ROW()&#x27;, totalsRowResult: 6, filterButton: true, &#125;, [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;], 2);// å°†è¡¨æ›´æ”¹æäº¤åˆ°å·¥ä½œè¡¨ä¸­table.commit(); æ›´æ”¹åˆ—å±æ€§ const table = ws.getTable(&#x27;MyTable&#x27;);// è·å–ç¬¬äºŒåˆ—çš„åˆ—åŒ…è£…å™¨const column = table.getColumn(1);// è®¾ç½®ä¸€äº›å±æ€§column.name = &#x27;Code&#x27;;column.filterButton = true;column.style = &#123; font: &#123; bold: true, name: &#x27;Comic Sans MS&#x27; &#125; &#125;;column.totalsRowLabel = &#x27;Totals&#x27;;column.totalsRowFunction = &#x27;custom&#x27;;column.totalsRowFormula = &#x27;ROW()&#x27;;column.totalsRowResult = 10;// å°†è¡¨æ›´æ”¹æäº¤åˆ°å·¥ä½œè¡¨ä¸­table.commit(); æ ·å¼â¬†å•å…ƒæ ¼ï¼Œè¡Œå’Œåˆ—å‡æ”¯æŒä¸€ç»„ä¸°å¯Œçš„æ ·å¼å’Œæ ¼å¼ï¼Œè¿™äº›æ ·å¼å’Œæ ¼å¼ä¼šå½±å“å•å…ƒæ ¼çš„æ˜¾ç¤ºæ–¹å¼ã€‚ é€šè¿‡åˆ†é…ä»¥ä¸‹å±æ€§æ¥è®¾ç½®æ ·å¼ï¼š numFmt font alignment border fill // ä¸ºå•å…ƒæ ¼åˆ†é…æ ·å¼ws.getCell(&#x27;A1&#x27;).numFmt = &#x27;0.00%&#x27;;// å°†æ ·å¼åº”ç”¨äºå·¥ä½œè¡¨åˆ—ws.columns = [ &#123; header: &#x27;Id&#x27;, key: &#x27;id&#x27;, width: 10 &#125;, &#123; header: &#x27;Name&#x27;, key: &#x27;name&#x27;, width: 32, style: &#123; font: &#123; name: &#x27;Arial Black&#x27; &#125; &#125;, &#125;, &#123; header: &#x27;D.O.B.&#x27;, key: &#x27;DOB&#x27;, width: 10, style: &#123; numFmt: &#x27;dd/mm/yyyy&#x27; &#125; &#125;,];// å°†ç¬¬3åˆ—è®¾ç½®ä¸ºâ€œè´§å¸æ ¼å¼â€ws.getColumn(3).numFmt = &#x27;&quot;Â£&quot;#,##0.00;[Red]-&quot;Â£&quot;#,##0.00&#x27;;// å°†ç¬¬2è¡Œè®¾ç½®ä¸º Comic Sansã€‚ws.getRow(2).font = &#123; name: &#x27;Comic Sans MS&#x27;, family: 4, size: 16, underline: &#x27;double&#x27;, bold: true,&#125;; å°†æ ·å¼åº”ç”¨äºè¡Œæˆ–åˆ—æ—¶ï¼Œå®ƒå°†åº”ç”¨äºè¯¥è¡Œæˆ–åˆ—ä¸­æ‰€æœ‰å½“å‰å­˜åœ¨çš„å•å…ƒæ ¼ã€‚å¦å¤–ï¼Œåˆ›å»ºçš„ä»»ä½•æ–°å•å…ƒæ ¼éƒ½å°†ä»å…¶æ‰€å±çš„è¡Œå’Œåˆ—ç»§æ‰¿å…¶åˆå§‹æ ·å¼ã€‚ å¦‚æœå•å…ƒæ ¼çš„è¡Œå’Œåˆ—éƒ½å®šä¹‰äº†ç‰¹å®šçš„æ ·å¼ï¼ˆä¾‹å¦‚ï¼Œå­—ä½“ï¼‰ï¼Œåˆ™è¯¥å•å…ƒæ ¼æ‰€åœ¨è¡Œæ ·å¼æ¯”åˆ—æ ·å¼å…·æœ‰æ›´é«˜ä¼˜å…ˆçº§ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¡Œå’Œåˆ—å®šä¹‰äº†ä¸åŒçš„æ ·å¼ï¼ˆä¾‹å¦‚ column.numFmt å’Œ row.fontï¼‰ï¼Œåˆ™å•å…ƒæ ¼å°†ç»§æ‰¿è¡Œçš„å­—ä½“å’Œåˆ—çš„ numFmtã€‚ æ³¨æ„ï¼šä»¥ä¸Šæ‰€æœ‰å±æ€§ï¼ˆnumFmtï¼ˆå­—ç¬¦ä¸²ï¼‰é™¤å¤–ï¼‰éƒ½æ˜¯ JS å¯¹è±¡ç»“æ„ã€‚å¦‚æœå°†åŒä¸€æ ·å¼å¯¹è±¡åˆ†é…ç»™å¤šä¸ªç”µå­è¡¨æ ¼å®ä½“ï¼Œåˆ™æ¯ä¸ªå®ä½“å°†å…±äº«åŒä¸€æ ·å¼å¯¹è±¡ã€‚å¦‚æœæ ·å¼å¯¹è±¡åæ¥åœ¨ç”µå­è¡¨æ ¼åºåˆ—åŒ–ä¹‹å‰è¢«ä¿®æ”¹ï¼Œåˆ™æ‰€æœ‰å¼•ç”¨è¯¥æ ·å¼å¯¹è±¡çš„å®ä½“ä¹Ÿå°†è¢«ä¿®æ”¹ã€‚æ­¤è¡Œä¸ºæ—¨åœ¨é€šè¿‡å‡å°‘åˆ›å»ºçš„ JS å¯¹è±¡çš„æ•°é‡æ¥ä¼˜å…ˆè€ƒè™‘æ€§èƒ½ã€‚å¦‚æœå¸Œæœ›æ ·å¼å¯¹è±¡æ˜¯ç‹¬ç«‹çš„ï¼Œåˆ™éœ€è¦å…ˆå¯¹å…¶è¿›è¡Œå…‹éš†ï¼Œç„¶åå†åˆ†é…å®ƒä»¬ã€‚åŒæ ·ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœç”µå­è¡¨æ ¼å®ä½“å…±äº«ç›¸ä¼¼çš„æ ·å¼ï¼Œåˆ™ä»æ–‡ä»¶ï¼ˆæˆ–æµï¼‰ä¸­è¯»å–æ–‡æ¡£æ—¶ï¼Œå®ƒä»¬ä¹Ÿå°†å¼•ç”¨ç›¸åŒçš„æ ·å¼å¯¹è±¡ã€‚ æ•°å­—æ ¼å¼â¬†// å°†å€¼æ˜¾ç¤ºä¸ºâ€œ 1 3/5â€ws.getCell(&#x27;A1&#x27;).value = 1.6;ws.getCell(&#x27;A1&#x27;).numFmt = &#x27;# ?/?&#x27;;// æ˜¾ç¤ºä¸ºâ€œ 1.60ï¼…â€ws.getCell(&#x27;B1&#x27;).value = 0.016;ws.getCell(&#x27;B1&#x27;).numFmt = &#x27;0.00%&#x27;; å­—ä½“// for the wannabe graphic designers out therews.getCell(&#x27;A1&#x27;).font = &#123; name: &#x27;Comic Sans MS&#x27;, family: 4, size: 16, underline: true, bold: true,&#125;;// for the graduate graphic designers...ws.getCell(&#x27;A2&#x27;).font = &#123; name: &#x27;Arial Black&#x27;, color: &#123; argb: &#x27;FF00FF00&#x27; &#125;, family: 2, size: 14, italic: true,&#125;;// å‚ç›´å¯¹é½ws.getCell(&#x27;A3&#x27;).font = &#123; vertAlign: &#x27;superscript&#x27;,&#125;;// æ³¨æ„ï¼šè¯¥å•å…ƒæ ¼å°†å­˜å‚¨å¯¹åˆ†é…çš„å­—ä½“å¯¹è±¡çš„å¼•ç”¨ã€‚// å¦‚æœä¹‹åæ›´æ”¹äº†å­—ä½“å¯¹è±¡ï¼Œåˆ™å•å…ƒå­—ä½“ä¹Ÿå°†æ›´æ”¹ã€‚const font = &#123; name: &#x27;Arial&#x27;, size: 12 &#125;;ws.getCell(&#x27;A3&#x27;).font = font;font.size = 20; // å•å…ƒæ ¼ A3 ç°åœ¨å…·æœ‰20å·å­—ä½“ï¼// ä»æ–‡ä»¶æˆ–æµä¸­è¯»å–å·¥ä½œç°¿åï¼Œå…±äº«ç›¸ä¼¼å­—ä½“çš„å•å…ƒæ ¼å¯èƒ½å¼•ç”¨ç›¸åŒçš„å­—ä½“å¯¹è±¡ å­—ä½“å±æ€§ æè¿° ç¤ºä¾‹å€¼ name å­—ä½“åç§°ã€‚ â€˜Arialâ€™, â€˜Calibriâ€™, etc. family å¤‡ç”¨å­—ä½“å®¶æ—ã€‚æ•´æ•°å€¼ã€‚ 1 - Serif, 2 - Sans Serif, 3 - Mono, Others - unknown scheme å­—ä½“æ–¹æ¡ˆã€‚ â€˜minorâ€™, â€˜majorâ€™, â€˜noneâ€™ charset å­—ä½“å­—ç¬¦é›†ã€‚æ•´æ•°å€¼ã€‚ 1, 2, etc. size å­—ä½“å¤§å°ã€‚æ•´æ•°å€¼ã€‚ 9, 10, 12, 16, etc. color é¢œè‰²æè¿°ï¼Œä¸€ä¸ªåŒ…å« ARGB å€¼çš„å¯¹è±¡ã€‚ { argb: â€˜FFFF0000â€™} bold å­—ä½“ ç²—ç»† true, false italic å­—ä½“ å€¾æ–œ true, false underline å­—ä½“ ä¸‹åˆ’çº¿ æ ·å¼ true, false, â€˜noneâ€™, â€˜singleâ€™, â€˜doubleâ€™, â€˜singleAccountingâ€™, â€˜doubleAccountingâ€™ strike å­—ä½“ åˆ é™¤çº¿ true, false outline å­—ä½“è½®å»“ true, false vertAlign å‚ç›´å¯¹é½ â€˜superscriptâ€™, â€˜subscriptâ€™ å¯¹é½â¬†// å°†å•å…ƒæ ¼å¯¹é½æ–¹å¼è®¾ç½®ä¸ºå·¦ä¸Šï¼Œä¸­é—´å±…ä¸­ï¼Œå³ä¸‹ws.getCell(&#x27;A1&#x27;).alignment = &#123; vertical: &#x27;top&#x27;, horizontal: &#x27;left&#x27; &#125;;ws.getCell(&#x27;B1&#x27;).alignment = &#123; vertical: &#x27;middle&#x27;, horizontal: &#x27;center&#x27; &#125;;ws.getCell(&#x27;C1&#x27;).alignment = &#123; vertical: &#x27;bottom&#x27;, horizontal: &#x27;right&#x27; &#125;;// å°†å•å…ƒæ ¼è®¾ç½®ä¸ºè‡ªåŠ¨æ¢è¡Œws.getCell(&#x27;D1&#x27;).alignment = &#123; wrapText: true &#125;;// å°†å•å…ƒæ ¼ç¼©è¿›è®¾ç½®ä¸º1ws.getCell(&#x27;E1&#x27;).alignment = &#123; indent: 1 &#125;;// å°†å•å…ƒæ ¼æ–‡æœ¬æ—‹è½¬è®¾ç½®ä¸ºå‘ä¸Š30degï¼Œå‘ä¸‹45degå’Œå‚ç›´æ–‡æœ¬ws.getCell(&#x27;F1&#x27;).alignment = &#123; textRotation: 30 &#125;;ws.getCell(&#x27;G1&#x27;).alignment = &#123; textRotation: -45 &#125;;ws.getCell(&#x27;H1&#x27;).alignment = &#123; textRotation: &#x27;vertical&#x27; &#125;; æœ‰æ•ˆçš„å¯¹é½å±æ€§å€¼ æ°´å¹³çš„ å‚ç›´ æ–‡æœ¬æ¢è¡Œ è‡ªé€‚åº” ç¼©è¿› é˜…è¯»é¡ºåº æ–‡æœ¬æ—‹è½¬ left top true true integer rtl 0 to 90 center middle false false ltr -1 to -90 right bottom vertical fill distributed justify justify centerContinuous distributed è¾¹æ¡†â¬†// åœ¨A1å‘¨å›´è®¾ç½®å•ä¸ªç»†è¾¹æ¡†ws.getCell(&#x27;A1&#x27;).border = &#123; top: &#123; style: &#x27;thin&#x27; &#125;, left: &#123; style: &#x27;thin&#x27; &#125;, bottom: &#123; style: &#x27;thin&#x27; &#125;, right: &#123; style: &#x27;thin&#x27; &#125;,&#125;;// åœ¨A3å‘¨å›´è®¾ç½®åŒç»†ç»¿è‰²è¾¹æ¡†ws.getCell(&#x27;A3&#x27;).border = &#123; top: &#123; style: &#x27;double&#x27;, color: &#123; argb: &#x27;FF00FF00&#x27; &#125; &#125;, left: &#123; style: &#x27;double&#x27;, color: &#123; argb: &#x27;FF00FF00&#x27; &#125; &#125;, bottom: &#123; style: &#x27;double&#x27;, color: &#123; argb: &#x27;FF00FF00&#x27; &#125; &#125;, right: &#123; style: &#x27;double&#x27;, color: &#123; argb: &#x27;FF00FF00&#x27; &#125; &#125;,&#125;;// åœ¨A5ä¸­è®¾ç½®åšçº¢åå­—è¾¹æ¡†ws.getCell(&#x27;A5&#x27;).border = &#123; diagonal: &#123; up: true, down: true, style: &#x27;thick&#x27;, color: &#123; argb: &#x27;FFFF0000&#x27; &#125;, &#125;,&#125;; æœ‰æ•ˆè¾¹æ¡†æ ·å¼ thin dotted dashDot hair dashDotDot slantDashDot mediumDashed mediumDashDotDot mediumDashDot medium double thick å¡«å……â¬†// ç”¨çº¢è‰²æ·±è‰²å‚ç›´æ¡çº¹å¡«å……A1ws.getCell(&#x27;A1&#x27;).fill = &#123; type: &#x27;pattern&#x27;, pattern: &#x27;darkVertical&#x27;, fgColor: &#123; argb: &#x27;FFFF0000&#x27; &#125;,&#125;;// åœ¨A2ä¸­å¡«å……æ·±é»„è‰²æ ¼å­å’Œè“è‰²èƒŒæ™¯ws.getCell(&#x27;A2&#x27;).fill = &#123; type: &#x27;pattern&#x27;, pattern: &#x27;darkTrellis&#x27;, fgColor: &#123; argb: &#x27;FFFFFF00&#x27; &#125;, bgColor: &#123; argb: &#x27;FF0000FF&#x27; &#125;,&#125;;// ä»å·¦åˆ°å³ç”¨è“ç™½è“æ¸å˜å¡«å……A3ws.getCell(&#x27;A3&#x27;).fill = &#123; type: &#x27;gradient&#x27;, gradient: &#x27;angle&#x27;, degree: 0, stops: [ &#123; position: 0, color: &#123; argb: &#x27;FF0000FF&#x27; &#125; &#125;, &#123; position: 0.5, color: &#123; argb: &#x27;FFFFFFFF&#x27; &#125; &#125;, &#123; position: 1, color: &#123; argb: &#x27;FF0000FF&#x27; &#125; &#125;, ],&#125;;// ä»ä¸­å¿ƒå¼€å§‹ç”¨çº¢ç»¿è‰²æ¸å˜å¡«å……A4ws.getCell(&#x27;A4&#x27;).fill = &#123; type: &#x27;gradient&#x27;, gradient: &#x27;path&#x27;, center: &#123; left: 0.5, top: 0.5 &#125;, stops: [ &#123; position: 0, color: &#123; argb: &#x27;FFFF0000&#x27; &#125; &#125;, &#123; position: 1, color: &#123; argb: &#x27;FF00FF00&#x27; &#125; &#125;, ],&#125;; å¡«å……æ¨¡å¼â¬† å±æ€§ æ˜¯å¦éœ€è¦ æè¿° type Y å€¼: &#39;pattern&#39;æŒ‡å®šæ­¤å¡«å……ä½¿ç”¨æ¨¡å¼ pattern Y æŒ‡å®šæ¨¡å¼ç±»å‹ (æŸ¥çœ‹ä¸‹é¢ æœ‰æ•ˆæ¨¡å¼ç±»å‹ ) fgColor N æŒ‡å®šå›¾æ¡ˆå‰æ™¯è‰²ã€‚é»˜è®¤ä¸ºé»‘è‰²ã€‚ bgColor N æŒ‡å®šå›¾æ¡ˆèƒŒæ™¯è‰²ã€‚é»˜è®¤ä¸ºç™½è‰²ã€‚ æœ‰æ•ˆæ¨¡å¼ç±»å‹ none solid darkGray mediumGray lightGray gray125 gray0625 darkHorizontal darkVertical darkDown darkUp darkGrid darkTrellis lightHorizontal lightVertical lightDown lightUp lightGrid lightTrellis æ¸å˜å¡«å……â¬† å±æ€§ æ˜¯å¦éœ€è¦ æè¿° type Y å€¼: &#39;gradient&#39;æŒ‡å®šæ­¤å¡«å……ä½¿ç”¨æ¸å˜ gradient Y æŒ‡å®šæ¸å˜ç±»å‹ã€‚[&#39;angle&#39;ï¼Œ&#39;path&#39;] ä¹‹ä¸€ degree angle å¯¹äºâ€œè§’åº¦â€æ¸å˜ï¼ŒæŒ‡å®šæ¸å˜çš„æ–¹å‘ã€‚0 æ˜¯ä»å·¦åˆ°å³ã€‚å€¼ä» 1-359 é¡ºæ—¶é’ˆæ—‹è½¬æ–¹å‘ center path å¯¹äºâ€œè·¯å¾„â€æ¸å˜ã€‚æŒ‡å®šè·¯å¾„èµ·ç‚¹çš„ç›¸å¯¹åæ ‡ã€‚â€œå·¦â€å’Œâ€œé¡¶â€å€¼çš„èŒƒå›´æ˜¯ 0 åˆ° 1 stops Y æŒ‡å®šæ¸å˜é¢œè‰²åºåˆ—ã€‚æ˜¯åŒ…å«ä½ç½®å’Œé¢œè‰²ï¼ˆä»ä½ç½® 0 å¼€å§‹åˆ°ä½ç½® 1 ç»“æŸï¼‰çš„å¯¹è±¡çš„æ•°ç»„ã€‚ä¸­é—´ä½ç½®å¯ç”¨äºæŒ‡å®šè·¯å¾„ä¸Šçš„å…¶ä»–é¢œè‰²ã€‚ æ³¨æ„äº‹é¡¹ ä½¿ç”¨ä¸Šé¢çš„æ¥å£ï¼Œå¯èƒ½ä¼šåˆ›å»ºä½¿ç”¨ XLSX ç¼–è¾‘å™¨ç¨‹åºæ— æ³•å®ç°çš„æ¸å˜å¡«å……æ•ˆæœã€‚ä¾‹å¦‚ï¼ŒExcel ä»…æ”¯æŒ 0ã€45ã€90 å’Œ 135 çš„è§’åº¦æ¢¯åº¦ã€‚ç±»ä¼¼åœ°ï¼Œstops çš„é¡ºåºä¹Ÿå¯èƒ½å—åˆ° UI çš„é™åˆ¶ï¼Œå…¶ä¸­ä½ç½® [0,1] æˆ–[0,0.5,1] æ˜¯å”¯ä¸€çš„é€‰æ‹©ã€‚è¯·è°¨æ…å¤„ç†æ­¤å¡«å……ï¼Œä»¥ç¡®ä¿ç›®æ ‡ XLSX æŸ¥çœ‹å™¨æ”¯æŒè¯¥å¡«å……ã€‚ å¯Œæ–‡æœ¬â¬†ç°åœ¨ï¼Œå•ä¸ªå•å…ƒæ ¼æ”¯æŒ RTF æ–‡æœ¬æˆ–å•å…ƒæ ¼æ ¼å¼åŒ–ã€‚å¯Œæ–‡æœ¬å€¼å¯ä»¥æ§åˆ¶æ–‡æœ¬å€¼å†…ä»»æ„æ•°é‡çš„å­å­—ç¬¦ä¸²çš„å­—ä½“å±æ€§ã€‚æœ‰å…³æ”¯æŒå“ªäº›å­—ä½“å±æ€§çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§å­—ä½“ã€‚ ws.getCell(&#x27;A1&#x27;).value = &#123; richText: [ &#123; font: &#123; size: 12, color: &#123; theme: 0 &#125;, name: &#x27;Calibri&#x27;, family: 2, scheme: &#x27;minor&#x27;, &#125;, text: &#x27;This is &#x27;, &#125;, &#123; font: &#123; italic: true, size: 12, color: &#123; theme: 0 &#125;, name: &#x27;Calibri&#x27;, scheme: &#x27;minor&#x27;, &#125;, text: &#x27;a&#x27;, &#125;, &#123; font: &#123; size: 12, color: &#123; theme: 1 &#125;, name: &#x27;Calibri&#x27;, family: 2, scheme: &#x27;minor&#x27;, &#125;, text: &#x27; &#x27;, &#125;, &#123; font: &#123; size: 12, color: &#123; argb: &#x27;FFFF6600&#x27; &#125;, name: &#x27;Calibri&#x27;, scheme: &#x27;minor&#x27;, &#125;, text: &#x27;colorful&#x27;, &#125;, &#123; font: &#123; size: 12, color: &#123; theme: 1 &#125;, name: &#x27;Calibri&#x27;, family: 2, scheme: &#x27;minor&#x27;, &#125;, text: &#x27; text &#x27;, &#125;, &#123; font: &#123; size: 12, color: &#123; argb: &#x27;FFCCFFCC&#x27; &#125;, name: &#x27;Calibri&#x27;, scheme: &#x27;minor&#x27;, &#125;, text: &#x27;with&#x27;, &#125;, &#123; font: &#123; size: 12, color: &#123; theme: 1 &#125;, name: &#x27;Calibri&#x27;, family: 2, scheme: &#x27;minor&#x27;, &#125;, text: &#x27; in-cell &#x27;, &#125;, &#123; font: &#123; bold: true, size: 12, color: &#123; theme: 1 &#125;, name: &#x27;Calibri&#x27;, family: 2, scheme: &#x27;minor&#x27;, &#125;, text: &#x27;format&#x27;, &#125;, ],&#125;;expect(ws.getCell(&#x27;A1&#x27;).text).to.equal( &#x27;This is a colorful text with in-cell format&#x27;);expect(ws.getCell(&#x27;A1&#x27;).type).to.equal(Excel.ValueType.RichText); å•å…ƒæ ¼ä¿æŠ¤â¬†å¯ä»¥ä½¿ç”¨ä¿æŠ¤å±æ€§æ¥ä¿®æ”¹å•å…ƒçº§åˆ«ä¿æŠ¤ã€‚ ws.getCell(&#x27;A1&#x27;).protection = &#123; locked: false, hidden: true,&#125;; æ”¯æŒçš„ä¿æŠ¤å±æ€§ å±æ€§ é»˜è®¤å€¼ æè¿° locked true æŒ‡å®šåœ¨å·¥ä½œè¡¨å—ä¿æŠ¤çš„æƒ…å†µä¸‹æ˜¯å¦å°†å•å…ƒæ ¼é”å®šã€‚ hidden false æŒ‡å®šå¦‚æœå·¥ä½œè¡¨å—ä¿æŠ¤ï¼Œåˆ™å•å…ƒæ ¼çš„å…¬å¼æ˜¯å¦å¯è§ã€‚ æ¡ä»¶æ ¼å¼åŒ–â¬†æ¡ä»¶æ ¼å¼åŒ–å…è®¸å·¥ä½œè¡¨æ ¹æ®å•å…ƒæ ¼å€¼æˆ–ä»»æ„å…¬å¼æ˜¾ç¤ºç‰¹å®šçš„æ ·å¼ï¼Œå›¾æ ‡ç­‰ã€‚ æ¡ä»¶æ ¼å¼è®¾ç½®è§„åˆ™æ˜¯åœ¨å·¥ä½œè¡¨çº§åˆ«æ·»åŠ çš„ï¼Œé€šå¸¸ä¼šè¦†ç›–ä¸€ç³»åˆ—å•å…ƒæ ¼ã€‚ å¯ä»¥å°†å¤šä¸ªè§„åˆ™åº”ç”¨äºç»™å®šçš„å•å…ƒæ ¼èŒƒå›´ï¼Œå¹¶ä¸”æ¯ä¸ªè§„åˆ™éƒ½å°†åº”ç”¨è‡ªå·±çš„æ ·å¼ã€‚ å¦‚æœå¤šä¸ªè§„åˆ™å½±å“ç»™å®šçš„å•å…ƒæ ¼ï¼Œåˆ™è§„åˆ™ä¼˜å…ˆçº§å€¼å°†ç¡®å®šå¦‚æœç«äº‰æ ·å¼å†²çªï¼Œåˆ™å“ªä¸ªè§„åˆ™èƒœå‡ºã€‚ä¼˜å…ˆçº§å€¼è¾ƒä½çš„è§„åˆ™è·èƒœã€‚å¦‚æœæ²¡æœ‰ä¸ºç»™å®šè§„åˆ™æŒ‡å®šä¼˜å…ˆçº§å€¼ï¼ŒExcelJS å°†æŒ‰å‡åºåˆ†é…å®ƒä»¬ã€‚ æ³¨æ„ï¼šç›®å‰ï¼Œä»…æ”¯æŒæ¡ä»¶æ ¼å¼è®¾ç½®è§„åˆ™çš„å­é›†ã€‚å…·ä½“æ¥è¯´ï¼Œåªæœ‰æ ¼å¼è§„åˆ™ä¸éœ€è¦ &lt;extLst&amp;gt å…ƒç´ å†…çš„ XML å‘ˆç°ã€‚è¿™æ„å‘³ç€ä¸æ”¯æŒæ•°æ®é›†å’Œä¸‰ä¸ªç‰¹å®šçš„å›¾æ ‡é›†ï¼ˆ3Trianglesï¼Œ3Starsï¼Œ5Boxesï¼‰ã€‚ // æ ¹æ®è¡Œå’Œåˆ—ä¸ºå¶æ•°æˆ–å¥‡æ•°å‘ A1:E7 æ·»åŠ ä¸€ä¸ªæ£‹ç›˜å›¾æ¡ˆworksheet.addConditionalFormatting(&#123; ref: &#x27;A1:E7&#x27;, rules: [ &#123; type: &#x27;expression&#x27;, formulae: [&#x27;MOD(ROW()+COLUMN(),2)=0&#x27;], style: &#123; fill: &#123; type: &#x27;pattern&#x27;, pattern: &#x27;solid&#x27;, bgColor: &#123; argb: &#x27;FF00FF00&#x27; &#125;, &#125;, &#125;, &#125;, ],&#125;); æ”¯æŒçš„æ¡ä»¶æ ¼å¼è®¾ç½®è§„åˆ™ç±»å‹ ç±»å‹ æè¿° expression ä»»ä½•è‡ªå®šä¹‰åŠŸèƒ½å‡å¯ç”¨äºæ¿€æ´»è§„åˆ™ã€‚ cellIs ä½¿ç”¨æŒ‡å®šçš„è¿ç®—ç¬¦å°†å•å…ƒæ ¼å€¼ä¸æä¾›çš„å…¬å¼è¿›è¡Œæ¯”è¾ƒ top10 å°†æ ¼å¼åŒ–åº”ç”¨äºå€¼åœ¨é¡¶éƒ¨ï¼ˆæˆ–åº•éƒ¨ï¼‰èŒƒå›´å†…çš„å•å…ƒæ ¼ aboveAverage å°†æ ¼å¼åŒ–åº”ç”¨äºå€¼é«˜äºï¼ˆæˆ–ä½äºï¼‰å¹³å‡å€¼çš„å•å…ƒæ ¼ colorScale æ ¹æ®å…¶å€¼åœ¨èŒƒå›´å†…çš„ä½ç½®å°†å½©è‰²èƒŒæ™¯åº”ç”¨äºå•å…ƒæ ¼ iconSet æ ¹æ®å€¼å°†ä¸€ç³»åˆ—å›¾æ ‡ä¹‹ä¸€æ·»åŠ åˆ°å•å…ƒæ ¼ containsText æ ¹æ®å•å…ƒæ ¼æ˜¯å¦ä¸ºç‰¹å®šæ–‡æœ¬æ¥åº”ç”¨æ ¼å¼ timePeriod æ ¹æ®å•å…ƒæ ¼æ—¥æœŸæ—¶é—´å€¼æ˜¯å¦åœ¨æŒ‡å®šèŒƒå›´å†…åº”ç”¨æ ¼å¼ è¡¨è¾¾å¼â¬† å±æ€§ å¯é€‰ é»˜è®¤å€¼ æè¿° type &#39;expression&#39; priority Y &lt;auto&gt; ç¡®å®šæ ·å¼çš„ä¼˜å…ˆé¡ºåº formulae 1 ä¸ªåŒ…å«çœŸ/å‡å€¼çš„å…¬å¼å­—ç¬¦ä¸²æ•°ç»„ã€‚è¦å¼•ç”¨å•å…ƒæ ¼å€¼ï¼Œè¯·ä½¿ç”¨å·¦ä¸Šè§’çš„å•å…ƒæ ¼åœ°å€ style å…¬å¼è¿”å› true æ—¶è¦åº”ç”¨çš„æ ·å¼ç»“æ„ Cell Isâ¬† å±æ€§ å¯é€‰ é»˜è®¤å€¼ æè¿° type &#39;cellIs&#39; priority Y &lt;auto&gt; ç¡®å®šæ ·å¼çš„ä¼˜å…ˆé¡ºåº operator å¦‚ä½•å°†å•å…ƒæ ¼å€¼ä¸å…¬å¼ç»“æœè¿›è¡Œæ¯”è¾ƒ formulae 1 ä¸ªå…¬å¼å­—ç¬¦ä¸²æ•°ç»„ï¼Œè¿”å›è¦ä¸æ¯ä¸ªå•å…ƒæ ¼è¿›è¡Œæ¯”è¾ƒçš„å€¼ style å¦‚æœæ¯”è¾ƒè¿”å› trueï¼Œåˆ™åº”ç”¨æ ·å¼ç»“æ„ Cell Is è¿ç®—ç¬¦ è¿ç®— æè¿° equal å¦‚æœå•å…ƒæ ¼å€¼ç­‰äºå…¬å¼å€¼ï¼Œåˆ™åº”ç”¨æ ¼å¼ greaterThan å¦‚æœå•å…ƒæ ¼å€¼å¤§äºå…¬å¼å€¼ï¼Œåˆ™åº”ç”¨æ ¼å¼ lessThan å¦‚æœå•å…ƒæ ¼å€¼å°äºå…¬å¼å€¼ï¼Œåˆ™åº”ç”¨æ ¼å¼ between å¦‚æœå•å…ƒæ ¼å€¼åœ¨ä¸¤ä¸ªå…¬å¼å€¼ä¹‹é—´ï¼ˆåŒ…æ‹¬ä¸¤ä¸ªå€¼ï¼‰ï¼Œåˆ™åº”ç”¨æ ¼å¼ Top 10â¬† å±æ€§ å¯é€‰ é»˜è®¤å€¼ æè¿° type &#39;top10&#39; priority Y &lt;auto&gt; ç¡®å®šæ ·å¼çš„ä¼˜å…ˆé¡ºåº rank Y 10 æŒ‡å®šæ ¼å¼ä¸­åŒ…å«å¤šå°‘ä¸ªé¡¶éƒ¨ï¼ˆæˆ–åº•éƒ¨ï¼‰å€¼ percent Y false å¦‚æœä¸º trueï¼Œåˆ™ç­‰çº§å­—æ®µä¸ºç™¾åˆ†æ¯”ï¼Œè€Œä¸æ˜¯ç»å¯¹å€¼ bottom Y false å¦‚æœä¸º trueï¼Œåˆ™åŒ…å«æœ€ä½å€¼è€Œä¸æ˜¯æœ€é«˜å€¼ style å¦‚æœæ¯”è¾ƒè¿”å› trueï¼Œåˆ™åº”ç”¨æ ·å¼ç»“æ„ é«˜äºå¹³å‡å€¼â¬† å±æ€§ å¯é€‰ é»˜è®¤å€¼ æè¿° type &#39;aboveAverage&#39; priority Y &lt;auto&gt; ç¡®å®šæ ·å¼çš„ä¼˜å…ˆé¡ºåº aboveAverage Y false å¦‚æœä¸º trueï¼Œåˆ™ç­‰çº§å­—æ®µä¸ºç™¾åˆ†æ¯”ï¼Œè€Œä¸æ˜¯ç»å¯¹å€¼ style å¦‚æœæ¯”è¾ƒè¿”å› trueï¼Œåˆ™åº”ç”¨æ ·å¼ç»“æ„ è‰²é˜¶â¬† å±æ€§ å¯é€‰ é»˜è®¤å€¼ æè¿° type &#39;colorScale&#39; priority Y &lt;auto&gt; ç¡®å®šæ ·å¼çš„ä¼˜å…ˆé¡ºåº cfvo 2 åˆ° 5 ä¸ªæ¡ä»¶æ ¼å¼åŒ–å€¼å¯¹è±¡çš„æ•°ç»„ï¼ŒæŒ‡å®šå€¼èŒƒå›´å†…çš„èˆªè·¯ç‚¹ color åœ¨ç»™å®šçš„èˆªè·¯ç‚¹ä½¿ç”¨çš„ç›¸åº”é¢œè‰²æ•°ç»„ style å¦‚æœæ¯”è¾ƒè¿”å› trueï¼Œåˆ™åº”ç”¨æ ·å¼ç»“æ„ å›¾æ ‡é›†â¬† å±æ€§ å¯é€‰ é»˜è®¤å€¼ æè¿° type &#39;iconSet&#39; priority Y &lt;auto&gt; ç¡®å®šæ ·å¼çš„ä¼˜å…ˆé¡ºåº iconSet Y 3TrafficLights è®¾ç½®ä½¿ç”¨çš„å›¾æ ‡åç§° showValue true æŒ‡å®šåº”ç”¨èŒƒå›´å†…çš„å•å…ƒæ ¼æ˜¯æ˜¾ç¤ºå›¾æ ‡å’Œå•å…ƒæ ¼å€¼ï¼Œè¿˜æ˜¯ä»…æ˜¾ç¤ºå›¾æ ‡ reverse false æŒ‡å®šæ˜¯å¦ä»¥ä¿ç•™é¡ºåºæ˜¾ç¤º iconSet ä¸­æŒ‡å®šçš„å›¾æ ‡é›†ä¸­çš„å›¾æ ‡ã€‚ å¦‚æœ custom ç­‰äº trueï¼Œåˆ™å¿…é¡»å¿½ç•¥æ­¤å€¼ custom false æŒ‡å®šæ˜¯å¦ä½¿ç”¨è‡ªå®šä¹‰å›¾æ ‡é›† cfvo 2 åˆ° 5 ä¸ªæ¡ä»¶æ ¼å¼åŒ–å€¼å¯¹è±¡çš„æ•°ç»„ï¼ŒæŒ‡å®šå€¼èŒƒå›´å†…çš„èˆªè·¯ç‚¹ style å¦‚æœæ¯”è¾ƒè¿”å› trueï¼Œåˆ™åº”ç”¨æ ·å¼ç»“æ„ æ•°æ®æ¡â¬† å­—æ®µ å¯é€‰ é»˜è®¤å€¼ æè¿° type &#39;dataBar&#39; priority Y &lt;auto&gt; ç¡®å®šæ ·å¼çš„ä¼˜å…ˆé¡ºåº minLength 0 æŒ‡å®šæ­¤æ¡ä»¶æ ¼å¼èŒƒå›´å†…æœ€çŸ­æ•°æ®æ¡çš„é•¿åº¦ maxLength 100 æŒ‡å®šæ­¤æ¡ä»¶æ ¼å¼èŒƒå›´å†…æœ€é•¿æ•°æ®æ¡çš„é•¿åº¦ showValue true æŒ‡å®šæ¡ä»¶æ ¼å¼èŒƒå›´å†…çš„å•å…ƒæ ¼æ˜¯å¦åŒæ—¶æ˜¾ç¤ºæ•°æ®æ¡å’Œæ•°å€¼æˆ–æ•°æ®æ¡ gradient true æŒ‡å®šæ•°æ®æ¡æ˜¯å¦å…·æœ‰æ¸å˜å¡«å…… border true æŒ‡å®šæ•°æ®æ¡æ˜¯å¦æœ‰è¾¹æ¡† negativeBarColorSameAsPositive true æŒ‡å®šæ•°æ®æ¡æ˜¯å¦å…·æœ‰ä¸æ­£æ¡é¢œè‰²ä¸åŒçš„è´Ÿæ¡é¢œè‰² negativeBarBorderColorSameAsPositive true æŒ‡å®šæ•°æ®æ¡çš„è´Ÿè¾¹æ¡†é¢œè‰²æ˜¯å¦ä¸åŒäºæ­£è¾¹æ¡†é¢œè‰² axisPosition â€˜autoâ€™ æŒ‡å®šæ•°æ®æ¡çš„è½´ä½ç½® direction â€˜leftToRightâ€™ æŒ‡å®šæ•°æ®æ¡çš„æ–¹å‘ cfvo 2 åˆ° 5 ä¸ªæ¡ä»¶æ ¼å¼åŒ–å€¼å¯¹è±¡çš„æ•°ç»„ï¼ŒæŒ‡å®šå€¼èŒƒå›´å†…çš„èˆªè·¯ç‚¹ style å¦‚æœæ¯”è¾ƒè¿”å› trueï¼Œåˆ™åº”ç”¨æ ·å¼ç»“æ„ åŒ…å«æ–‡å­—â¬† å±æ€§ å¯é€‰ é»˜è®¤å€¼ æè¿° type &#39;containsText&#39; priority Y &lt;auto&gt; ç¡®å®šæ ·å¼çš„ä¼˜å…ˆé¡ºåº operator æ–‡æœ¬æ¯”è¾ƒç±»å‹ text è¦æœç´¢çš„æ–‡æœ¬ style å¦‚æœæ¯”è¾ƒè¿”å› trueï¼Œåˆ™åº”ç”¨æ ·å¼ç»“æ„ åŒ…å«æ–‡æœ¬è¿ç®—ç¬¦ è¿ç®—ç¬¦ æè¿° containsText å¦‚æœå•å…ƒæ ¼å€¼åŒ…å«åœ¨ text å­—æ®µä¸­æŒ‡å®šçš„å€¼ï¼Œåˆ™åº”ç”¨æ ¼å¼ containsBlanks å¦‚æœå•å…ƒæ ¼å€¼åŒ…å«ç©ºæ ¼ï¼Œåˆ™åº”ç”¨æ ¼å¼ notContainsBlanks å¦‚æœå•å…ƒæ ¼å€¼ä¸åŒ…å«ç©ºæ ¼ï¼Œåˆ™åº”ç”¨æ ¼å¼ containsErrors å¦‚æœå•å…ƒæ ¼å€¼åŒ…å«é”™è¯¯ï¼Œåˆ™åº”ç”¨æ ¼å¼ notContainsErrors å¦‚æœå•å…ƒæ ¼å€¼ä¸åŒ…å«é”™è¯¯ï¼Œåˆ™åº”ç”¨æ ¼å¼ æ—¶é—´æ®µâ¬† å±æ€§ å¯é€‰ é»˜è®¤å€¼ æè¿° type &#39;timePeriod&#39; priority Y &lt;auto&gt; ç¡®å®šæ ·å¼çš„ä¼˜å…ˆé¡ºåº timePeriod æ¯”è¾ƒå•å…ƒæ ¼å€¼çš„æ—¶é—´æ®µ style å¦‚æœæ¯”è¾ƒè¿”å› trueï¼Œåˆ™åº”ç”¨æ ·å¼ç»“æ„ æ—¶é—´æ®µ æ—¶é—´æ®µ æè¿° lastWeek å¦‚æœå•å…ƒæ ¼å€¼è½åœ¨æœ€åä¸€å‘¨å†…ï¼Œåˆ™åº”ç”¨æ ¼å¼ thisWeek å¦‚æœå•å…ƒæ ¼å€¼åœ¨æœ¬å‘¨ä¸‹é™ï¼Œåˆ™åº”ç”¨æ ¼å¼ nextWeek å¦‚æœå•å…ƒæ ¼å€¼åœ¨ä¸‹ä¸€å‘¨ä¸‹é™ï¼Œåˆ™åº”ç”¨æ ¼å¼ yesterday å¦‚æœå•å…ƒæ ¼å€¼ç­‰äºæ˜¨å¤©ï¼Œåˆ™åº”ç”¨æ ¼å¼ today å¦‚æœå•å…ƒæ ¼å€¼ç­‰äºä»Šå¤©ï¼Œåˆ™åº”ç”¨æ ¼å¼ tomorrow å¦‚æœå•å…ƒæ ¼å€¼ç­‰äºæ˜å¤©ï¼Œåˆ™åº”ç”¨æ ¼å¼ last7Days å¦‚æœå•å…ƒæ ¼å€¼åœ¨è¿‡å» 7 å¤©ä¹‹å†…ï¼Œåˆ™åº”ç”¨æ ¼å¼ lastMonth å¦‚æœå•å…ƒæ ¼å€¼å±äºä¸Šä¸ªæœˆï¼Œåˆ™åº”ç”¨æ ¼å¼ thisMonth å¦‚æœå•å…ƒæ ¼å€¼åœ¨æœ¬æœˆä¸‹é™ï¼Œåˆ™åº”ç”¨æ ¼å¼ nextMonth å¦‚æœå•å…ƒæ ¼å€¼åœ¨ä¸‹ä¸ªæœˆä¸‹é™ï¼Œåˆ™åº”ç”¨æ ¼å¼ å¤§çº²çº§åˆ«â¬†Excel æ”¯æŒå¤§çº²ï¼›è¡Œæˆ–åˆ—å¯ä»¥æ ¹æ®ç”¨æˆ·å¸Œæœ›æŸ¥çœ‹çš„è¯¦ç»†ç¨‹åº¦å±•å¼€æˆ–æŠ˜å ã€‚ å¤§çº²çº§åˆ«å¯ä»¥åœ¨åˆ—è®¾ç½®ä¸­å®šä¹‰ï¼š worksheet.columns = [ &#123; header: &#x27;Id&#x27;, key: &#x27;id&#x27;, width: 10 &#125;, &#123; header: &#x27;Name&#x27;, key: &#x27;name&#x27;, width: 32 &#125;, &#123; header: &#x27;D.O.B.&#x27;, key: &#x27;DOB&#x27;, width: 10, outlineLevel: 1 &#125;,]; æˆ–ç›´æ¥åœ¨è¡Œæˆ–åˆ—ä¸Š worksheet.getColumn(3).outlineLevel = 1;worksheet.getRow(3).outlineLevel = 1; å·¥ä½œè¡¨å¤§çº²çº§åˆ«å¯ä»¥åœ¨å·¥ä½œè¡¨ä¸Šè®¾ç½® // è®¾ç½®åˆ—å¤§çº²çº§åˆ«worksheet.properties.outlineLevelCol = 1;// è®¾ç½®è¡Œå¤§çº²çº§åˆ«worksheet.properties.outlineLevelRow = 1; æ³¨æ„ï¼šè°ƒæ•´è¡Œæˆ–åˆ—ä¸Šçš„å¤§çº²çº§åˆ«æˆ–å·¥ä½œè¡¨ä¸Šçš„å¤§çº²çº§åˆ«å°†äº§ç”Ÿå‰¯ä½œç”¨ï¼Œå³è¿˜ä¿®æ”¹å—å±æ€§æ›´æ”¹å½±å“çš„æ‰€æœ‰è¡Œæˆ–åˆ—çš„æŠ˜å å±æ€§ã€‚ ä¾‹å¦‚ã€‚ï¼š worksheet.properties.outlineLevelCol = 1;worksheet.getColumn(3).outlineLevel = 1;expect(worksheet.getColumn(3).collapsed).to.be.true;worksheet.properties.outlineLevelCol = 2;expect(worksheet.getColumn(3).collapsed).to.be.false; å¤§çº²å±æ€§å¯ä»¥åœ¨å·¥ä½œè¡¨ä¸Šè®¾ç½® worksheet.properties.outlineProperties = &#123; summaryBelow: false, summaryRight: false,&#125;; å›¾ç‰‡â¬†å°†å›¾åƒæ·»åŠ åˆ°å·¥ä½œè¡¨æ˜¯ä¸€ä¸ªåˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤çš„è¿‡ç¨‹ã€‚é¦–å…ˆï¼Œé€šè¿‡ addImage() å‡½æ•°å°†å›¾åƒæ·»åŠ åˆ°å·¥ä½œç°¿ä¸­ï¼Œè¯¥å‡½æ•°è¿˜å°†è¿”å› imageId å€¼ã€‚ç„¶åï¼Œä½¿ç”¨ imageIdï¼Œå¯ä»¥å°†å›¾åƒä½œä¸ºå¹³é“ºèƒŒæ™¯æˆ–è¦†ç›–å•å…ƒæ ¼åŒºåŸŸæ·»åŠ åˆ°å·¥ä½œè¡¨ä¸­ã€‚ æ³¨æ„ï¼šä»æ­¤ç‰ˆæœ¬å¼€å§‹ï¼Œä¸æ”¯æŒè°ƒæ•´æˆ–å˜æ¢å›¾åƒã€‚ å°†å›¾ç‰‡æ·»åŠ åˆ°å·¥ä½œç°¿â¬†Workbook.addImage å‡½æ•°æ”¯æŒæŒ‰æ–‡ä»¶åæˆ–æŒ‰ Buffer æ·»åŠ å›¾åƒã€‚è¯·æ³¨æ„ï¼Œåœ¨ä¸¤ç§æƒ…å†µä¸‹ï¼Œéƒ½å¿…é¡»æŒ‡å®šæ‰©å±•åã€‚æœ‰æ•ˆçš„æ‰©å±•ååŒ…æ‹¬ â€œjpegâ€ï¼Œâ€œpngâ€ï¼Œâ€œgifâ€ã€‚ // é€šè¿‡æ–‡ä»¶åå°†å›¾åƒæ·»åŠ åˆ°å·¥ä½œç°¿const imageId1 = workbook.addImage(&#123; filename: &#x27;path/to/image.jpg&#x27;, extension: &#x27;jpeg&#x27;,&#125;);// é€šè¿‡ buffer å°†å›¾åƒæ·»åŠ åˆ°å·¥ä½œç°¿const imageId2 = workbook.addImage(&#123; buffer: fs.readFileSync(&#x27;path/to.image.png&#x27;), extension: &#x27;png&#x27;,&#125;);// é€šè¿‡ base64 å°†å›¾åƒæ·»åŠ åˆ°å·¥ä½œç°¿const myBase64Image = &#x27;data:image/png;base64,iVBORw0KG...&#x27;;const imageId2 = workbook.addImage(&#123; base64: myBase64Image, extension: &#x27;png&#x27;,&#125;); å°†å›¾ç‰‡æ·»åŠ åˆ°å·¥ä½œè¡¨èƒŒæ™¯â¬†ä½¿ç”¨ Workbook.addImage ä¸­çš„å›¾åƒ IDï¼Œå¯ä»¥ä½¿ç”¨ addBackgroundImage å‡½æ•°è®¾ç½®å·¥ä½œè¡¨çš„èƒŒæ™¯ // è®¾ç½®èƒŒæ™¯worksheet.addBackgroundImage(imageId1); åœ¨ä¸€å®šèŒƒå›´å†…æ·»åŠ å›¾ç‰‡â¬†ä½¿ç”¨ Workbook.addImage ä¸­çš„å›¾åƒ IDï¼Œå¯ä»¥å°†å›¾åƒåµŒå…¥å·¥ä½œè¡¨ä¸­ä»¥è¦†ç›–ä¸€å®šèŒƒå›´ã€‚ä»è¯¥èŒƒå›´è®¡ç®—å‡ºçš„åæ ‡å°†è¦†ç›–ä»ç¬¬ä¸€ä¸ªå•å…ƒæ ¼çš„å·¦ä¸Šè§’åˆ°ç¬¬äºŒä¸ªå•å…ƒæ ¼çš„å³ä¸‹è§’ã€‚ // åœ¨ B2:D6 ä¸Šæ’å…¥å›¾ç‰‡worksheet.addImage(imageId2, &#x27;B2:D6&#x27;); ä½¿ç”¨ç»“æ„è€Œä¸æ˜¯èŒƒå›´å­—ç¬¦ä¸²ï¼Œå¯ä»¥éƒ¨åˆ†è¦†ç›–å•å…ƒæ ¼ã€‚ è¯·æ³¨æ„ï¼Œä¸ºæ­¤ä½¿ç”¨çš„åæ ‡ç³»åŸºäºé›¶ï¼Œå› æ­¤ A1 çš„å·¦ä¸Šè§’å°†ä¸º &#123;colï¼š0ï¼Œrowï¼š0&#125;ã€‚å•å…ƒæ ¼çš„åˆ†æ•°å¯ä»¥é€šè¿‡ä½¿ç”¨æµ®ç‚¹æ•°æ¥æŒ‡å®šï¼Œä¾‹å¦‚ A1 çš„ä¸­ç‚¹æ˜¯ &#123;colï¼š0.5ï¼Œrowï¼š0.5&#125;ã€‚ // åœ¨ B2:D6 çš„ä¸€éƒ¨åˆ†ä¸Šæ’å…¥å›¾åƒworksheet.addImage(imageId2, &#123; tl: &#123; col: 1.5, row: 1.5 &#125;, br: &#123; col: 3.5, row: 5.5 &#125;,&#125;); å•å…ƒæ ¼åŒºåŸŸè¿˜å¯ä»¥å…·æœ‰å±æ€§ &quot;editAs&quot;ï¼Œè¯¥å±æ€§å°†æ§åˆ¶å°†å›¾åƒé”šå®šåˆ°å•å…ƒæ ¼çš„æ–¹å¼ã€‚å®ƒå¯ä»¥å…·æœ‰ä»¥ä¸‹å€¼ä¹‹ä¸€ï¼š å€¼ æè¿° undefined å®ƒæŒ‡å®šä½¿å›¾åƒå°†æ ¹æ®å•å…ƒæ ¼ç§»åŠ¨å’Œè°ƒæ•´å…¶å¤§å° oneCell è¿™æ˜¯é»˜è®¤å€¼ã€‚å›¾åƒå°†ä¸å•å…ƒæ ¼ä¸€èµ·ç§»åŠ¨ï¼Œä½†å¤§å°ä¸å˜åŠ¨ absolute å›¾åƒå°†ä¸ä¼šéšç€å•å…ƒæ ¼ç§»åŠ¨æˆ–è°ƒæ•´å¤§å° ws.addImage(imageId, &#123; tl: &#123; col: 0.1125, row: 0.4 &#125;, br: &#123; col: 2.101046875, row: 3.4 &#125;, editAs: &#x27;oneCell&#x27;,&#125;); å°†å›¾ç‰‡æ·»åŠ åˆ°å•å…ƒæ ¼â¬†æ‚¨å¯ä»¥å°†å›¾åƒæ·»åŠ åˆ°å•å…ƒæ ¼ï¼Œç„¶åä»¥ 96dpi å®šä¹‰å…¶å®½åº¦å’Œé«˜åº¦ï¼ˆä»¥åƒç´ ä¸ºå•ä½ï¼‰ã€‚ worksheet.addImage(imageId2, &#123; tl: &#123; col: 0, row: 0 &#125;, ext: &#123; width: 500, height: 200 &#125;,&#125;); æ·»åŠ å¸¦æœ‰è¶…é“¾æ¥çš„å›¾ç‰‡â¬†æ‚¨å¯ä»¥å°†å¸¦æœ‰è¶…é“¾æ¥çš„å›¾åƒæ·»åŠ åˆ°å•å…ƒæ ¼ï¼Œå¹¶åœ¨å›¾åƒèŒƒå›´å†…å®šä¹‰è¶…é“¾æ¥ã€‚ worksheet.addImage(imageId2, &#123; tl: &#123; col: 0, row: 0 &#125;, ext: &#123; width: 500, height: 200 &#125;, hyperlinks: &#123; hyperlink: &#x27;http://www.somewhere.com&#x27;, tooltip: &#x27;http://www.somewhere.com&#x27;, &#125;,&#125;); å·¥ä½œè¡¨ä¿æŠ¤â¬†å¯ä»¥é€šè¿‡æ·»åŠ å¯†ç æ¥ä¿æŠ¤å·¥ä½œè¡¨å…å—ä¿®æ”¹ã€‚ await worksheet.protect(&#x27;the-password&#x27;, options); å·¥ä½œè¡¨ä¿æŠ¤ä¹Ÿå¯ä»¥åˆ é™¤ï¼š worksheet.unprotect(); æœ‰å…³å¦‚ä½•ä¿®æ”¹å•ä¸ªå•å…ƒæ ¼ä¿æŠ¤çš„è¯¦ç»†ä¿¡æ¯è¯·æŸ¥çœ‹ å•å…ƒæ ¼ä¿æŠ¤ã€‚ æ³¨æ„ï¼š å½“ protect() å‡½æ•°è¿”å›ä¸€ä¸ª Promise ä»£è¡¨å®ƒæ˜¯å¼‚æ­¥çš„ï¼Œå½“å‰çš„å®ç°åœ¨ä¸»çº¿ç¨‹ä¸Šè¿è¡Œï¼Œå¹¶ä¸”åœ¨ CPU ä¸Šå°†ä½¿ç”¨å¹³å‡å¤§çº¦ 600 æ¯«ç§’ã€‚å¯ä»¥é€šè¿‡è®¾ç½® spinCount è¿›è¡Œè°ƒæ•´ï¼Œè¯¥å€¼å¯ç”¨äºä½¿è¿‡ç¨‹æ›´å¿«æˆ–æ›´æœ‰å¼¹æ€§ã€‚ å·¥ä½œè¡¨ä¿æŠ¤é€‰é¡¹â¬† å±æ€§ é»˜è®¤å€¼ æè¿° selectLockedCells true å…è®¸ç”¨æˆ·é€‰æ‹©é”å®šçš„å•å…ƒæ ¼ selectUnlockedCells true å…è®¸ç”¨æˆ·é€‰æ‹©æœªé”å®šçš„å•å…ƒæ ¼ formatCells false å…è®¸ç”¨æˆ·æ ¼å¼åŒ–å•å…ƒæ ¼ formatColumns false å…è®¸ç”¨æˆ·æ ¼å¼åŒ–åˆ— formatRows false å…è®¸ç”¨æˆ·æ ¼å¼åŒ–è¡Œ insertRows false å…è®¸ç”¨æˆ·æ’å…¥è¡Œ insertColumns false å…è®¸ç”¨æˆ·æ’å…¥åˆ— insertHyperlinks false å…è®¸ç”¨æˆ·æ’å…¥è¶…é“¾æ¥ deleteRows false å…è®¸ç”¨æˆ·åˆ é™¤è¡Œ deleteColumns false å…è®¸ç”¨æˆ·åˆ é™¤åˆ— sort false å…è®¸ç”¨æˆ·å¯¹æ•°æ®è¿›è¡Œæ’åº autoFilter false å…è®¸ç”¨æˆ·è¿‡æ»¤è¡¨ä¸­çš„æ•°æ® pivotTables false å…è®¸ç”¨æˆ·ä½¿ç”¨æ•°æ®é€è§†è¡¨ spinCount 100000 ä¿æŠ¤æˆ–å–æ¶ˆä¿æŠ¤æ—¶æ‰§è¡Œçš„å“ˆå¸Œè¿­ä»£æ¬¡æ•° æ–‡ä»¶ I/Oâ¬†XLSXâ¬†è¯» XLSXâ¬†// ä»æ–‡ä»¶è¯»å–const workbook = new Excel.Workbook();await workbook.xlsx.readFile(filename);// ... ä½¿ç”¨ workbook// ä»æµè¯»å–const workbook = new Excel.Workbook();await workbook.xlsx.read(stream);// ... ä½¿ç”¨ workbook// ä» buffer åŠ è½½const workbook = new Excel.Workbook();await workbook.xlsx.load(data);// ... ä½¿ç”¨ workbook å†™ XLSX// å†™å…¥æ–‡ä»¶const workbook = createAndFillWorkbook();await workbook.xlsx.writeFile(filename);// å†™å…¥æµawait workbook.xlsx.write(stream);// å†™å…¥ bufferconst buffer = await workbook.xlsx.writeBuffer(); CSVâ¬†è¯» CSVâ¬†è¯»å– CSV æ–‡ä»¶æ—¶æ”¯æŒçš„é€‰é¡¹ã€‚ å±æ€§ æ˜¯å¦éœ€è¦ ç±»å‹ æè¿° dateFormats N Array æŒ‡å®š dayjs çš„æ—¥æœŸç¼–ç æ ¼å¼ã€‚ map N Function è‡ªå®šä¹‰Array.prototype.map() å›è°ƒå‡½æ•°ï¼Œç”¨äºå¤„ç†æ•°æ®ã€‚ sheetName N String æŒ‡å®šå·¥ä½œè¡¨åç§°ã€‚ parserOptions N Object parseOptions é€‰é¡¹ @fast-csv/format æ¨¡å—ä»¥å†™å…¥ csv æ•°æ®ã€‚ // ä»æ–‡ä»¶è¯»å–const workbook = new Excel.Workbook();const worksheet = await workbook.csv.readFile(filename);// ... ä½¿ç”¨ workbook æˆ– worksheet// ä»æµä¸­è¯»å–const workbook = new Excel.Workbook();const worksheet = await workbook.csv.read(stream);// ... ä½¿ç”¨ workbook æˆ– worksheet// ä»å¸¦æœ‰æ¬§æ´²æ—¥æœŸçš„æ–‡ä»¶ä¸­è¯»å–const workbook = new Excel.Workbook();const options = &#123; dateFormats: [&#x27;DD/MM/YYYY&#x27;],&#125;;const worksheet = await workbook.csv.readFile(filename, options);// ... ä½¿ç”¨ workbook æˆ– worksheet// ä»å…·æœ‰è‡ªå®šä¹‰å€¼è§£æçš„æ–‡ä»¶ä¸­è¯»å–const workbook = new Excel.Workbook();const options = &#123; map(value, index) &#123; switch (index) &#123; case 0: // ç¬¬1åˆ—æ˜¯å­—ç¬¦ä¸² return value; case 1: // ç¬¬2åˆ—æ˜¯æ—¥æœŸ return new Date(value); case 2: // ç¬¬3åˆ—æ˜¯å…¬å¼å€¼çš„JSON return JSON.parse(value); default: // å…¶ä½™çš„æ˜¯æ•°å­— return parseFloat(value); &#125; &#125;, // https://c2fo.io/fast-csv/docs/parsing/options parserOptions: &#123; delimiter: &#x27;\\t&#x27;, quote: false, &#125;,&#125;;const worksheet = await workbook.csv.readFile(filename, options);// ... ä½¿ç”¨ workbook æˆ– worksheet CSV è§£æå™¨ä½¿ç”¨ fast-csv è¯»å– CSV æ–‡ä»¶ã€‚ä¼ é€’ç»™ä¸Šè¿°å†™å…¥å‡½æ•°çš„é€‰é¡¹ä¸­çš„ formatterOptions å°†ä¼ é€’ç»™ @fast-csv/format æ¨¡å—ä»¥å†™å…¥ csv æ•°æ®ã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… fast-csv README.mdã€‚ ä½¿ç”¨ npm æ¨¡å— dayjs è§£ææ—¥æœŸã€‚å¦‚æœæœªæä¾› dateFormats æ•°ç»„ï¼Œåˆ™ä½¿ç”¨ä»¥ä¸‹ dateFormatsï¼š â€˜YYYY-MM-DD[T]HH:mm:ssâ€™ â€˜MM-DD-YYYYâ€™ â€˜YYYY-MM-DDâ€™ è¯·å‚é˜… dayjs CustomParseFormat æ’ä»¶ï¼Œä»¥è·å–æœ‰å…³å¦‚ä½•æ„é€  dateFormat çš„è¯¦ç»†ä¿¡æ¯ã€‚ å†™ CSVâ¬†å†™å…¥ CSV æ–‡ä»¶æ—¶æ”¯æŒçš„é€‰é¡¹ã€‚ å±æ€§ æ˜¯å¦éœ€è¦ ç±»å‹ æè¿° dateFormat N String æŒ‡å®š dayjs çš„æ—¥æœŸç¼–ç æ ¼å¼ã€‚ dateUTC N Boolean æŒ‡å®š ExcelJS æ˜¯å¦ä½¿ç”¨dayjs.utc()è½¬æ¢æ—¶åŒºä»¥è§£ææ—¥æœŸã€‚ encoding N String æŒ‡å®šæ–‡ä»¶ç¼–ç æ ¼å¼ã€‚ includeEmptyRows N Boolean æŒ‡å®šæ˜¯å¦å¯ä»¥å†™å…¥ç©ºè¡Œã€‚ map N Function è‡ªå®šä¹‰Array.prototype.map() å›è°ƒå‡½æ•°ï¼Œç”¨äºå¤„ç†è¡Œå€¼ã€‚ sheetName N String æŒ‡å®šå·¥ä½œè¡¨åç§°ã€‚ sheetId N Number æŒ‡å®šå·¥ä½œè¡¨ IDã€‚ formatterOptions N Object formatterOptions é€‰é¡¹ @fast-csv/format æ¨¡å—å†™å…¥ csv æ•°æ®ã€‚ // å†™å…¥æ–‡ä»¶const workbook = createAndFillWorkbook();await workbook.csv.writeFile(filename);// å†™å…¥æµ// è¯·æ³¨æ„ï¼Œæ‚¨éœ€è¦æä¾› sheetName æˆ– sheetId ä»¥æ­£ç¡®å¯¼å…¥åˆ° csvawait workbook.csv.write(stream, &#123; sheetName: &#x27;Page name&#x27; &#125;);// ä½¿ç”¨æ¬§æ´²æ—¥æœŸæ—¶é—´å†™å…¥æ–‡ä»¶const workbook = new Excel.Workbook();const options = &#123; dateFormat: &#x27;DD/MM/YYYY HH:mm:ss&#x27;, dateUTC: true, // å‘ˆç°æ—¥æœŸæ—¶ä½¿ç”¨ utc&#125;;await workbook.csv.writeFile(filename, options);// ä½¿ç”¨è‡ªå®šä¹‰å€¼æ ¼å¼å†™å…¥æ–‡ä»¶const workbook = new Excel.Workbook();const options = &#123; map(value, index) &#123; switch (index) &#123; case 0: // ç¬¬1åˆ—æ˜¯å­—ç¬¦ä¸² return value; case 1: // ç¬¬2åˆ—æ˜¯æ—¥æœŸ return dayjs(value).format(&#x27;YYYY-MM-DD&#x27;); case 2: // ç¬¬3åˆ—æ˜¯ä¸€ä¸ªå…¬å¼ï¼Œåªå†™ç»“æœ return value.result; default: // å…¶ä½™çš„æ˜¯æ•°å­— return value; &#125; &#125;, // https://c2fo.io/fast-csv/docs/formatting/options formatterOptions: &#123; delimiter: &#x27;\\t&#x27;, quote: false, &#125;,&#125;;await workbook.csv.writeFile(filename, options);// å†™å…¥æ–° bufferconst buffer = await workbook.csv.writeBuffer(); CSV è§£æå™¨ä½¿ç”¨ fast-csv ç¼–å†™ CSV æ–‡ä»¶ã€‚ä¼ é€’ç»™ä¸Šè¿°å†™å…¥å‡½æ•°çš„é€‰é¡¹ä¸­çš„ formatterOptions å°†ä¼ é€’ç»™ @fast-csv/format æ¨¡å—ä»¥å†™å…¥ csv æ•°æ®ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… fast-csv README.mdã€‚ æ—¥æœŸä½¿ç”¨ npm æ¨¡å— dayjs æ ¼å¼åŒ–ã€‚å¦‚æœæœªæä¾› dateFormatï¼Œåˆ™ä½¿ç”¨ dayjs.ISO_8601ã€‚ç¼–å†™ CSV æ—¶ï¼Œæ‚¨å¯ä»¥æä¾›å¸ƒå°”å€¼ dateUTC ä¸º trueï¼Œä»¥ä½¿ ExcelJS è§£ææ—¥æœŸï¼Œè€Œæ— éœ€ä½¿ç”¨ dayjs.utc() è‡ªåŠ¨è½¬æ¢æ—¶åŒºã€‚ æµå¼ I/Oâ¬†ä¸Šé¢è®°å½•çš„æ–‡ä»¶ I/O éœ€è¦åœ¨å†…å­˜ä¸­å»ºç«‹æ•´ä¸ªå·¥ä½œç°¿ï¼Œç„¶åæ‰èƒ½å†™å…¥æ–‡ä»¶ã€‚è™½ç„¶æ–¹ä¾¿ï¼Œä½†æ˜¯ç”±äºæ‰€éœ€çš„å†…å­˜é‡ï¼Œå®ƒå¯èƒ½ä¼šé™åˆ¶æ–‡æ¡£çš„å¤§å°ã€‚ æµå†™å…¥å™¨ï¼ˆæˆ–è¯»å–å™¨ï¼‰åœ¨ç”Ÿæˆå·¥ä½œç°¿æˆ–å·¥ä½œè¡¨æ•°æ®æ—¶å¯¹å…¶è¿›è¡Œå¤„ç†ï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºæ–‡ä»¶å½¢å¼ã€‚é€šå¸¸ï¼Œè¿™åœ¨å†…å­˜ä¸Šæ•ˆç‡è¦é«˜å¾—å¤šï¼Œå› ä¸ºæœ€ç»ˆçš„å†…å­˜å ç”¨é‡ï¼Œç”šè‡³ä¸­é—´çš„å†…å­˜å ç”¨é‡éƒ½æ¯”æ–‡æ¡£ç‰ˆæœ¬è¦ç´§å‡‘å¾—å¤šï¼Œå°¤å…¶æ˜¯å½“æ‚¨è€ƒè™‘åˆ°è¡Œå’Œå•å…ƒæ ¼å¯¹è±¡ä¸€æ—¦æäº¤å°±è¢«é”€æ¯æ—¶ï¼Œå°¤å…¶å¦‚æ­¤ã€‚ æµå¼å·¥ä½œç°¿å’Œå·¥ä½œè¡¨çš„æ¥å£å‡ ä¹ä¸æ–‡æ¡£ç‰ˆæœ¬ç›¸åŒï¼Œä½†å®é™…å­˜åœ¨ä¸€äº›ç»†å¾®å·®åˆ«ï¼š å°†å·¥ä½œè¡¨æ·»åŠ åˆ°å·¥ä½œç°¿åï¼Œå°†æ— æ³•å°†å…¶åˆ é™¤ã€‚ æäº¤è¡Œåï¼Œå°†æ— æ³•å†è®¿é—®è¯¥è¡Œï¼Œå› ä¸ºè¯¥è¡Œå°†ä»å·¥ä½œè¡¨ä¸­åˆ é™¤ã€‚ ä¸æ”¯æŒ unMergeCells()ã€‚ è¯·æ³¨æ„ï¼Œå¯ä»¥åœ¨ä¸æäº¤ä»»ä½•è¡Œçš„æƒ…å†µä¸‹æ„å»ºæ•´ä¸ªå·¥ä½œç°¿ã€‚æäº¤å·¥ä½œç°¿åï¼Œæ‰€æœ‰æ·»åŠ çš„å·¥ä½œè¡¨ï¼ˆåŒ…æ‹¬æ‰€æœ‰æœªæäº¤çš„è¡Œï¼‰å°†è‡ªåŠ¨æäº¤ã€‚ä½†æ˜¯ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸æ–‡æ¡£ç‰ˆæœ¬ç›¸æ¯”æ”¶æ•ˆç”šå¾®ã€‚ æµå¼ XLSXâ¬†æµå¼ XLSX å†™å…¥å™¨â¬†æµå¼ XLSX å†™å…¥å™¨åœ¨ ExcelJS.stream.xlsx å‘½åç©ºé—´ä¸­å¯ç”¨ã€‚ æ„é€ å‡½æ•°é‡‡ç”¨å¸¦æœ‰ä»¥ä¸‹å­—æ®µçš„å¯é€‰ options å¯¹è±¡ï¼š å­—æ®µ æè¿° stream æŒ‡å®šè¦å†™å…¥ XLSX å·¥ä½œç°¿çš„å¯å†™æµã€‚ filename å¦‚æœæœªæŒ‡å®šæµï¼Œåˆ™æ­¤å­—æ®µæŒ‡å®šè¦å†™å…¥ XLSX å·¥ä½œç°¿çš„æ–‡ä»¶çš„è·¯å¾„ã€‚ useSharedStrings æŒ‡å®šæ˜¯å¦åœ¨å·¥ä½œç°¿ä¸­ä½¿ç”¨å…±äº«å­—ç¬¦ä¸²ã€‚é»˜è®¤ä¸º false useStyles æŒ‡å®šæ˜¯å¦å°†æ ·å¼ä¿¡æ¯æ·»åŠ åˆ°å·¥ä½œç°¿ã€‚æ ·å¼ä¼šå¢åŠ ä¸€äº›æ€§èƒ½å¼€é”€ã€‚é»˜è®¤ä¸º false zip ExcelJS å†…éƒ¨ä¼ é€’ç»™ Archiver çš„ Zip é€‰é¡¹ã€‚é»˜è®¤å€¼ä¸º undefined å¦‚æœåœ¨é€‰é¡¹ä¸­æœªæŒ‡å®š stream æˆ– filenameï¼Œåˆ™å·¥ä½œç°¿ç¼–å†™å™¨å°†åˆ›å»ºä¸€ä¸ª StreamBuf å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°† XLSX å·¥ä½œç°¿çš„å†…å®¹å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚å¯ä»¥é€šè¿‡å±æ€§ workbook.stream è®¿é—®æ­¤ StreamBuf å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ç”¨äºé€šè¿‡ stream.read() ç›´æ¥è®¿é—®å­—èŠ‚ï¼Œæˆ–å°†å†…å®¹é€šè¿‡ç®¡é“ä¼ è¾“åˆ°å¦ä¸€ä¸ªæµã€‚ // ä½¿ç”¨æ ·å¼å’Œå…±äº«å­—ç¬¦ä¸²æ„é€ æµå¼ XLSX å·¥ä½œç°¿ç¼–å†™å™¨const options = &#123; filename: &#x27;./streamed-workbook.xlsx&#x27;, useStyles: true, useSharedStrings: true,&#125;;const workbook = new Excel.stream.xlsx.WorkbookWriter(options); é€šå¸¸ï¼Œæµå¼ XLSX å†™å…¥å™¨çš„æ¥å£ä¸ä¸Šè¿°æ–‡æ¡£å·¥ä½œç°¿ï¼ˆå’Œå·¥ä½œè¡¨ï¼‰ç›¸åŒï¼Œå®é™…ä¸Šè¡Œï¼Œå•å…ƒæ ¼å’Œæ ·å¼å¯¹è±¡æ˜¯ç›¸åŒçš„ã€‚ ä½†æ˜¯æœ‰ä¸€äº›åŒºåˆ«â€¦ æ„é€  å¦‚ä¸Šæ‰€ç¤ºï¼ŒWorkbookWriter é€šå¸¸å°†è¦æ±‚åœ¨æ„é€ å‡½æ•°ä¸­æŒ‡å®šè¾“å‡ºæµæˆ–æ–‡ä»¶ã€‚ æäº¤æ•°æ® å½“å·¥ä½œè¡¨è¡Œå‡†å¤‡å°±ç»ªæ—¶ï¼Œåº”å°†å…¶æäº¤ï¼Œä»¥ä¾¿å¯ä»¥é‡Šæ”¾è¡Œå¯¹è±¡å’Œå†…å®¹ã€‚é€šå¸¸ï¼Œè¿™å°†åœ¨æ·»åŠ æ¯ä¸€è¡Œæ—¶å®Œæˆâ€¦ worksheet .addRow(&#123; id: i, name: theName, etc: someOtherDetail, &#125;) .commit(); WorksheetWriter åœ¨æ·»åŠ è¡Œæ—¶ä¸æäº¤è¡Œçš„åŸå› æ˜¯å…è®¸å•å…ƒæ ¼è·¨è¡Œåˆå¹¶ï¼š worksheet.mergeCells(&#x27;A1:B2&#x27;);worksheet.getCell(&#x27;A1&#x27;).value = &#x27;I am merged&#x27;;worksheet.getCell(&#x27;C1&#x27;).value = &#x27;I am not&#x27;;worksheet.getCell(&#x27;C2&#x27;).value = &#x27;Neither am I&#x27;;worksheet.getRow(2).commit(); // now rows 1 and two are committed. æ¯ä¸ªå·¥ä½œè¡¨å®Œæˆåï¼Œè¿˜å¿…é¡»æäº¤ï¼š // å®Œæˆæ·»åŠ æ•°æ®ã€‚ æäº¤å·¥ä½œè¡¨worksheet.commit(); è¦å®Œæˆ XLSX æ–‡æ¡£ï¼Œå¿…é¡»æäº¤å·¥ä½œç°¿ã€‚ å¦‚æœæœªæäº¤å·¥ä½œç°¿ä¸­çš„ä»»ä½•å·¥ä½œè¡¨ï¼Œåˆ™å°†åœ¨å·¥ä½œç°¿æäº¤ä¸­è‡ªåŠ¨æäº¤å®ƒä»¬ã€‚ // å®Œæˆ workbook.await workbook.commit();// ... æµå·²è¢«å†™å…¥ æµå¼ XLSX é˜…è¯»å™¨â¬†æµå¼ XLSX å·¥ä½œç°¿é˜…è¯»å™¨å¯ä»¥åœ¨ ExcelJS.stream.xlsx å‘½åç©ºé—´ä¸­æ‰¾åˆ°ã€‚ æ„é€ å‡½æ•°åŒ…å«å¿…éœ€çš„è¾“å…¥å‚æ•°å’Œå¯é€‰çš„ options å‚æ•°: Argument Description input (å¿…éœ€çš„) æŒ‡å®šä»ä¸­è¯»å– XLSX å·¥ä½œç°¿çš„æ–‡ä»¶æˆ–å¯è¯»æµçš„åç§° options (å¯é€‰çš„) æŒ‡å®šå¦‚ä½•å¤„ç†è¯»å–è§£ææœŸé—´å‘ç”Ÿçš„äº‹ä»¶ç±»å‹ options.entries æŒ‡å®šæ˜¯å¦å»è§¦å‘äº‹ä»¶(&#39;emit&#39;)æˆ–è€…ä¸å‘å‡ºäº‹ä»¶(&#39;ignore&#39;)ï¼Œé»˜è®¤å€¼æ˜¯&#39;emit&#39; options.sharedStrings æŒ‡å®šæ˜¯å¦å»ç¼“å­˜(&#39;cache&#39;)å…±äº«å­—ç¬¦ä¸²ï¼Œå°†å…¶æ’å…¥åˆ°ç›¸åº”çš„å•å…ƒæ ¼å€¼ä¸­ï¼Œæˆ–è€…æ˜¯å¦å»è§¦å‘(&#39;emit&#39;)æˆ–å¿½ç•¥(&#39;ignore&#39;)å®ƒä»¬ï¼Œåœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå•å…ƒæ ¼å€¼éƒ½å°†æ˜¯å¯¹å…±äº«å­—ç¬¦ä¸²ç´¢å¼•çš„å¼•ç”¨ã€‚é»˜è®¤å€¼æ˜¯&#39;cache&#39; options.hyperlinks æŒ‡å®šæ˜¯å¦å»ç¼“å­˜è¶…é“¾æ¥(&#39;cache&#39;)ï¼Œå°†å…¶æ’å…¥åˆ°ç›¸åº”çš„å•å…ƒæ ¼å€¼ä¸­ï¼Œæ˜¯å¦å»è§¦å‘(&#39;emit&#39;)æˆ–å¿½ç•¥(&#39;ignore&#39;)å®ƒä»¬ã€‚é»˜è®¤å€¼æ˜¯&#39;cache&#39; options.styles æŒ‡å®šæ˜¯å¦å»ç¼“å­˜æ ·å¼(&#39;cache&#39;)ï¼Œå°†å…¶æ’å…¥åˆ°ç›¸åº”çš„è¡Œæˆ–å•å…ƒæ ¼å€¼ä¸­ï¼Œæˆ–æ˜¯å¦å¿½ç•¥(&#39;å¿½ç•¥&#39;)å®ƒä»¬ã€‚é»˜è®¤å€¼æ˜¯&#39;cache&#39; options.worksheets æŒ‡å®šæ˜¯å¦å»è§¦å‘(&#39;emit&#39;)æˆ–å¿½ç•¥(&#39;ignore&#39;)å·¥ä½œè¡¨ã€‚é»˜è®¤å€¼æ˜¯&#39;emit&#39; const workbook = new ExcelJS.stream.xlsx.WorkbookReader(&#x27;./file.xlsx&#x27;);for await (const worksheetReader of workbookReader) &#123; for await (const row of worksheetReader) &#123; // ... &#125;&#125; è¯·æ³¨æ„ï¼Œç”±äºæ€§èƒ½åŸå› ï¼ŒworksheetReaderè¿”å›ä¸€ä¸ªè¡Œæ•°ç»„ï¼Œè€Œä¸æ˜¯å•ç‹¬è¿”å›æ¯ä¸€è¡Œ: https://github.com/nodejs/node/issues/31979 è¿­ä»£éå†æ‰€æœ‰äº‹ä»¶â¬†å·¥ä½œç°¿ä¸Šçš„äº‹ä»¶æ˜¯ â€˜worksheetâ€™ã€â€™shared-stringsâ€™ å’Œ â€˜hyperlinksâ€™ã€‚ å·¥ä½œè¡¨ä¸Šçš„äº‹ä»¶æ˜¯ â€˜rowâ€™ å’Œ â€˜hyperlinksâ€™. const options = &#123; sharedStrings: &#x27;emit&#x27;, hyperlinks: &#x27;emit&#x27;, worksheets: &#x27;emit&#x27;,&#125;;const workbook = new ExcelJS.stream.xlsx.WorkbookReader(&#x27;./file.xlsx&#x27;, options);for await (const &#123; eventType, value &#125; of workbook.parse()) &#123; switch (eventType) &#123; case &#x27;shared-strings&#x27;: // å€¼æ˜¯å…±äº«å­—ç¬¦ä¸² case &#x27;worksheet&#x27;: // å€¼æ˜¯worksheetReader case &#x27;hyperlinks&#x27;: // å€¼æ˜¯hyperlinksReader &#125;&#125; å¯è¯»æµâ¬†æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½¿ç”¨å¼‚æ­¥è¿­ä»£ï¼Œä½†æˆ‘ä»¬ä¹Ÿå…¬å¼€äº†æµæ¥å£ä»¥å®ç°å‘åå…¼å®¹æ€§ã€‚ const options = &#123; sharedStrings: &#x27;emit&#x27;, hyperlinks: &#x27;emit&#x27;, worksheets: &#x27;emit&#x27;,&#125;;const workbookReader = new ExcelJS.stream.xlsx.WorkbookReader( &#x27;./file.xlsx&#x27;, options);workbookReader.read();workbookReader.on(&#x27;worksheet&#x27;, worksheet =&gt; &#123; worksheet.on(&#x27;row&#x27;, row =&gt; &#123;&#125;);&#125;);workbookReader.on(&#x27;shared-strings&#x27;, sharedString =&gt; &#123; // ...&#125;);workbookReader.on(&#x27;hyperlinks&#x27;, hyperlinksReader =&gt; &#123; // ...&#125;);workbookReader.on(&#x27;end&#x27;, () =&gt; &#123; // ...&#125;);workbookReader.on(&#x27;error&#x27;, err =&gt; &#123; // ...&#125;); æµè§ˆå™¨â¬†è¯¥åº“çš„ä¸€éƒ¨åˆ†å·²è¢«éš”ç¦»ï¼Œå¹¶ç»è¿‡æµ‹è¯•å¯åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ ç”±äºå·¥ä½œç°¿è¯»å†™å™¨çš„æµå¼ä¼ è¾“æ€§è´¨ï¼Œå› æ­¤æœªåŒ…æ‹¬è¿™äº›å†…å®¹ã€‚åªèƒ½ä½¿ç”¨åŸºäºæ–‡æ¡£çš„å·¥ä½œç°¿ï¼ˆæœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ åˆ›å»ºå·¥ä½œç°¿ï¼‰ã€‚ ä¾‹å¦‚ï¼Œåœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ ExcelJS çš„ä»£ç å¯æŸ¥çœ‹ github ä¸­çš„ spec / browser æ–‡ä»¶å¤¹ã€‚ é¢„æ†ç»‘â¬†ä»¥ä¸‹æ–‡ä»¶å·²é¢„å…ˆæ†ç»‘åœ¨ä¸€èµ·ï¼Œå¹¶åŒ…å«åœ¨ dist æ–‡ä»¶å¤¹ä¸­ã€‚ exceljs.js exceljs.min.js å€¼ç±»å‹â¬†æ”¯æŒä»¥ä¸‹å€¼ç±»å‹ã€‚ Null å€¼â¬†Enum: Excel.ValueType.Null ç©ºå€¼è¡¨ç¤ºæ²¡æœ‰å€¼ï¼Œé€šå¸¸åœ¨å†™å…¥æ–‡ä»¶æ—¶å°†ä¸å­˜å‚¨ï¼ˆåˆå¹¶çš„å•å…ƒæ ¼é™¤å¤–ï¼‰ã€‚å¯ç”¨äºä»å•å…ƒæ ¼ä¸­åˆ é™¤è¯¥å€¼ã€‚ä¾‹å¦‚ï¼š worksheet.getCell(&#x27;A1&#x27;).value = null; åˆå¹¶å•å…ƒæ ¼â¬†Enum: Excel.ValueType.Merge åˆå¹¶å•å…ƒæ ¼æ˜¯å…¶å€¼ç»‘å®šåˆ°å¦ä¸€ä¸ªâ€œä¸»â€å•å…ƒæ ¼çš„å•å…ƒæ ¼ã€‚åˆ†é…ç»™åˆå¹¶å•å…ƒå°†å¯¼è‡´ä¿®æ”¹å•å…ƒæ ¼ã€‚ æ•°å­—å€¼â¬†Enum: Excel.ValueType.Number ä¸€ä¸ªæ•°å­—å€¼ã€‚ ä¾‹å¦‚ï¼š worksheet.getCell(&#x27;A1&#x27;).value = 5;worksheet.getCell(&#x27;A2&#x27;).value = 3.14159; å­—ç¬¦ä¸²å€¼â¬†Enum: Excel.ValueType.String ä¸€ä¸ªç®€å•çš„æ–‡æœ¬å­—ç¬¦ä¸²ã€‚ ä¾‹å¦‚ï¼š worksheet.getCell(&#x27;A1&#x27;).value = &#x27;Hello, World!&#x27;; æ—¥æœŸå€¼â¬†Enum: Excel.ValueType.Date æ—¥æœŸå€¼ï¼Œç”± JavaScript Date ç±»å‹è¡¨ç¤ºã€‚ ä¾‹å¦‚ï¼š worksheet.getCell(&#x27;A1&#x27;).value = new Date(2017, 2, 15); è¶…é“¾æ¥å€¼â¬†Enum: Excel.ValueType.Hyperlink å…·æœ‰æ–‡æœ¬å’Œé“¾æ¥å€¼çš„ URLã€‚ ä¾‹å¦‚ï¼š // é“¾æ¥åˆ°ç½‘ç»œworksheet.getCell(&#x27;A1&#x27;).value = &#123; text: &#x27;www.mylink.com&#x27;, hyperlink: &#x27;http://www.mylink.com&#x27;, tooltip: &#x27;www.mylink.com&#x27;,&#125;;// å†…éƒ¨é“¾æ¥worksheet.getCell(&#x27;A1&#x27;).value = &#123; text: &#x27;Sheet2&#x27;, hyperlink: &quot;#&#x27;Sheet2&#x27;!A1&quot; &#125;; å…¬å¼å€¼â¬†Enum: Excel.ValueType.Formula ä¸€ä¸ª Excel å…¬å¼ï¼Œç”¨äºå³æ—¶è®¡ç®—å€¼ã€‚è¯·æ³¨æ„ï¼Œè™½ç„¶å•å…ƒæ ¼ç±»å‹å°†ä¸ºâ€œå…¬å¼â€ï¼Œä½†è¯¥å•å…ƒæ ¼å¯èƒ½å…·æœ‰ä¸€ä¸ªæœ‰æ•ˆç±»å‹å€¼ï¼Œè¯¥å€¼å°†ä»ç»“æœå€¼ä¸­å¾—å‡ºã€‚ è¯·æ³¨æ„ï¼ŒExcelJS æ— æ³•å¤„ç†å…¬å¼ä»¥ç”Ÿæˆç»“æœï¼Œå¿…é¡»æä¾›è¯¥å…¬å¼ã€‚ ä¾‹å¦‚ï¼š worksheet.getCell(&#x27;A3&#x27;).value = &#123; formula: &#x27;A1+A2&#x27;, result: 7 &#125;; å•å…ƒæ ¼è¿˜æ”¯æŒä¾¿æ·çš„è·å–å™¨ï¼Œä»¥è®¿é—®å…¬å¼å’Œç»“æœï¼š worksheet.getCell(&#x27;A3&#x27;).formula === &#x27;A1+A2&#x27;;worksheet.getCell(&#x27;A3&#x27;).result === 7; å…±äº«å…¬å¼â¬†å…±äº«çš„å…¬å¼é€šè¿‡å‡å°‘å·¥ä½œè¡¨ xml ä¸­æ–‡æœ¬çš„é‡å¤æ¥å¢å¼º xlsx æ–‡æ¡£çš„å‹ç¼©ã€‚èŒƒå›´ä¸­å·¦ä¸Šè§’çš„å•å…ƒæ ¼æ˜¯æŒ‡å®šçš„æ¯ç‰ˆï¼Œå®ƒå°†ä¿ç•™è¯¥èŒƒå›´å†…çš„æ‰€æœ‰å…¶ä»–å•å…ƒæ ¼éƒ½å°†å¼•ç”¨çš„å…¬å¼ã€‚ç„¶åï¼Œå…¶ä»–â€œä»å±â€å•å…ƒæ ¼å¯ä»¥å¼•ç”¨æ­¤ä¸»å•å…ƒæ ¼ï¼Œè€Œä¸å¿…å†æ¬¡é‡æ–°å®šä¹‰æ•´ä¸ªå…¬å¼ã€‚è¯·æ³¨æ„ï¼Œä¸»å…¬å¼å°†ä»¥å¸¸ç”¨çš„ Excel æ–¹å¼è½¬æ¢ä¸ºä»å±å•å…ƒæ ¼ï¼Œä»¥ä¾¿å¯¹å…¶ä»–å•å…ƒæ ¼çš„å¼•ç”¨å°†æ ¹æ®ä»å±å•å…ƒç›¸å¯¹äºä¸»å•å…ƒçš„åç§»é‡å‘å³ä¸‹ç§»ã€‚ä¾‹å¦‚ï¼šå¦‚æœä¸»å•å…ƒæ ¼ A2 å…·æœ‰å¼•ç”¨ A1 çš„å…¬å¼ï¼Œåˆ™å¦‚æœå•å…ƒæ ¼ B2 å…±äº« A2 çš„å…¬å¼ï¼Œåˆ™å®ƒå°†å¼•ç”¨ B1ã€‚ å¯ä»¥å°†ä¸»å…¬å¼ä¸è¯¥èŒƒå›´å†…çš„ä»å±å•å…ƒæ ¼ä¸€èµ·åˆ†é…ç»™è¯¥å•å…ƒæ ¼ worksheet.getCell(&#x27;A2&#x27;).value = &#123; formula: &#x27;A1&#x27;, result: 10, shareType: &#x27;shared&#x27;, ref: &#x27;A2:B3&#x27;,&#125;; å¯ä»¥ä½¿ç”¨æ–°çš„å€¼å½¢å¼å°†å…±äº«å…¬å¼åˆ†é…ç»™å•å…ƒæ ¼ï¼š worksheet.getCell(&#x27;B2&#x27;).value = &#123; sharedFormula: &#x27;A2&#x27;, result: 10 &#125;; è¿™æŒ‡å®šå•å…ƒæ ¼ B2 æ˜¯å°†ä» A2 ä¸­çš„å…¬å¼æ´¾ç”Ÿçš„å…¬å¼ï¼Œå…¶ç»“æœä¸º 10ã€‚ å…¬å¼ä¾¿æ·è·å–å™¨ä¼šå°† A2 ä¸­çš„å…¬å¼è½¬æ¢ä¸º B2 ä¸­åº”å…·æœ‰çš„å…¬å¼ï¼š expect(worksheet.getCell(&#x27;B2&#x27;).formula).to.equal(&#x27;B1&#x27;); å¯ä»¥ä½¿ç”¨ fillFormula æ–¹æ³•å°†å…±äº«çš„å…¬å¼åˆ†é…åˆ°å·¥ä½œè¡¨ä¸­ï¼š // å°† A1 è®¾ç½®ä¸ºèµ·å§‹ç¼–å·worksheet.getCell(&#x27;A1&#x27;).value = 1;// ä» A1 å¼€å§‹ä»¥é€’å¢è®¡æ•°å°† A2 å¡«å……åˆ° A10worksheet.fillFormula(&#x27;A2:A10&#x27;, &#x27;A1+1&#x27;, [2, 3, 4, 5, 6, 7, 8, 9, 10]); fillFormula ä¹Ÿå¯ä»¥ä½¿ç”¨å›è°ƒå‡½æ•°æ¥è®¡ç®—æ¯ä¸ªå•å…ƒæ ¼çš„å€¼ // ä»A1å¼€å§‹ä»¥é€’å¢è®¡æ•°å°† A2 å¡«å……åˆ° A100worksheet.fillFormula(&#x27;A2:A100&#x27;, &#x27;A1+1&#x27;, (row, col) =&gt; row); å…¬å¼ç±»å‹â¬†è¦åŒºåˆ†çœŸæ­£çš„å’Œè½¬æ¢åçš„å…¬å¼å•å…ƒæ ¼ï¼Œè¯·ä½¿ç”¨ FormulaType getterï¼š worksheet.getCell(&#x27;A3&#x27;).formulaType === Enums.FormulaType.Master;worksheet.getCell(&#x27;B3&#x27;).formulaType === Enums.FormulaType.Shared; å…¬å¼ç±»å‹å…·æœ‰ä»¥ä¸‹å€¼ï¼š åç§° å€¼ Enums.FormulaType.None 0 Enums.FormulaType.Master 1 Enums.FormulaType.Shared 2 æ•°ç»„å…¬å¼â¬†åœ¨ Excel ä¸­è¡¨ç¤ºå…±äº«å…¬å¼çš„ä¸€ç§æ–°æ–¹æ³•æ˜¯æ•°ç»„å…¬å¼ã€‚ä»¥è¿™ç§å½¢å¼ï¼Œä¸»å•å…ƒæ ¼æ˜¯å”¯ä¸€åŒ…å«ä¸å…¬å¼æœ‰å…³çš„ä»»ä½•ä¿¡æ¯çš„å•å…ƒæ ¼ã€‚å®ƒåŒ…å« shareType â€˜arrayâ€™ ä»¥åŠé€‚ç”¨äºå…¶çš„å•å…ƒæ ¼èŒƒå›´ä»¥åŠå°†è¦å¤åˆ¶çš„å…¬å¼ã€‚å…¶ä½™å•å…ƒæ ¼æ˜¯å…·æœ‰å¸¸è§„å€¼çš„å¸¸è§„å•å…ƒæ ¼ã€‚ æ³¨æ„ï¼šæ•°ç»„å…¬å¼ä¸ä¼šä»¥å…±äº«å…¬å¼çš„æ–¹å¼è½¬æ¢ã€‚å› æ­¤ï¼Œå¦‚æœä¸»å•å…ƒ A2 å¼•ç”¨ A1ï¼Œåˆ™ä»å•å…ƒ B2 ä¹Ÿå°†å¼•ç”¨ A1ã€‚ ä¾‹å¦‚ï¼š // å°†æ•°ç»„å…¬å¼åˆ†é…ç»™ A2:B3worksheet.getCell(&#x27;A2&#x27;).value = &#123; formula: &#x27;A1&#x27;, result: 10, shareType: &#x27;array&#x27;, ref: &#x27;A2:B3&#x27;,&#125;;// å¯èƒ½æ²¡æœ‰å¿…è¦å¡«å†™å·¥ä½œè¡¨ä¸­çš„å…¶ä½™å€¼ fillFormula æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨äºå¡«å……æ•°ç»„å…¬å¼ // ç”¨æ•°ç»„å…¬å¼ &quot;A1&quot; å¡«å…… A2:B3worksheet.fillFormula(&#x27;A2:B3&#x27;, &#x27;A1&#x27;, [1, 1, 1, 1], &#x27;array&#x27;); å¯Œæ–‡æœ¬å€¼â¬†Enum: Excel.ValueType.RichText æ ·å¼ä¸°å¯Œçš„æ–‡æœ¬ã€‚ ä¾‹å¦‚ï¼š worksheet.getCell(&#x27;A1&#x27;).value = &#123; richText: [&#123; text: &#x27;This is &#x27; &#125;, &#123; font: &#123; italic: true &#125;, text: &#x27;italic&#x27; &#125;],&#125;; å¸ƒå°”å€¼â¬†Enum: Excel.ValueType.Boolean ä¾‹å¦‚ï¼š worksheet.getCell(&#x27;A1&#x27;).value = true;worksheet.getCell(&#x27;A2&#x27;).value = false; é”™è¯¯å€¼â¬†Enum: Excel.ValueType.Error ä¾‹å¦‚ï¼š worksheet.getCell(&#x27;A1&#x27;).value = &#123; error: &#x27;#N/A&#x27; &#125;;worksheet.getCell(&#x27;A2&#x27;).value = &#123; error: &#x27;#VALUE!&#x27; &#125;; å½“å‰æœ‰æ•ˆçš„é”™è¯¯æ–‡æœ¬å€¼ä¸ºï¼š åç§° å€¼ Excel.ErrorValue.NotApplicable #N/A Excel.ErrorValue.Ref #REF! Excel.ErrorValue.Name #NAME? Excel.ErrorValue.DivZero #DIV/0! Excel.ErrorValue.Null #NULL! Excel.ErrorValue.Value #VALUE! Excel.ErrorValue.Num #NUM! æ¥å£å˜åŒ–â¬†æˆ‘ä»¬ä¼šå°½ä¸€åˆ‡åŠªåŠ›åˆ›å»ºä¸€ä¸ªè‰¯å¥½çš„ï¼Œä¸€è‡´çš„æ¥å£ï¼Œè¯¥æ¥å£ä¸ä¼šåœ¨ç‰ˆæœ¬ä¹‹é—´ä¸å…¼å®¹ï¼Œä½†ä»¤äººé—æ†¾çš„æ˜¯ï¼Œä¸ºäº†å®ç°æ›´å¤§çš„åˆ©ç›Šï¼Œæœ‰æ—¶éœ€è¦è¿›è¡Œä¸€äº›æ›´æ”¹ã€‚ 0.1.0â¬†Worksheet.eachRowâ¬†åœ¨ Worksheet.eachRow çš„å›è°ƒå‡½æ•°ä¸­çš„å‚æ•°å·²è¢«äº¤æ¢å’Œæ›´æ”¹ï¼›å®ƒæ˜¯ function(rowNumberï¼ŒrowValues)ï¼Œç°åœ¨æ˜¯ function(rowï¼ŒrowNumber)ï¼Œä½¿å®ƒçš„å¤–è§‚æ›´åƒ underscore(_.each)æ–¹æ³•ï¼Œå¹¶ä¸”è¡Œå¯¹è±¡ä¼˜å…ˆäºè¡Œå·ã€‚ Worksheet.getRowâ¬†æ­¤å‡½æ•°å·²ä»è¿”å›ç¨€ç–çš„å•å…ƒæ ¼æ•°ç»„æ›´æ”¹ä¸ºè¿”å› Row å¯¹è±¡ã€‚è¿™æ ·å¯ä»¥è®¿é—®è¡Œå±æ€§ï¼Œå¹¶æœ‰åŠ©äºç®¡ç†è¡Œæ ·å¼ç­‰ã€‚ ä»å¯é€šè¿‡ Worksheet.getRow(rowNumber).values; è·å¾—ç¨€ç–çš„å•å…ƒæ ¼å€¼çš„æ•°ç»„ã€‚ 0.1.1â¬†cell.modelâ¬†cell.styles é‡å‘½åä¸º cell.style 0.2.44â¬†ä» Bluebird åˆ‡æ¢åˆ° Node åŸç”Ÿ Promise çš„å‡½æ•°è¿”å›çš„ Promise å¦‚æœä¾èµ– Bluebird çš„é¢å¤–åŠŸèƒ½ï¼Œåˆ™å¯èƒ½ä¼šç ´åè°ƒç”¨ä»£ç ã€‚ ä¸ºäº†å‡å°‘è¿™ç§æƒ…å†µçš„å‡ºç°ï¼Œåœ¨ 0.3.0 ä¸­æ·»åŠ äº†ä»¥ä¸‹ä¸¤ä¸ªæ›´æ”¹ï¼š é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨åŠŸèƒ½æ›´å…¨ä¸”ä»ä¸æµè§ˆå™¨å…¼å®¹çš„ promise libã€‚ è¯¥åº“æ”¯æŒ Bluebird çš„è®¸å¤šåŠŸèƒ½ï¼Œä½†å ç”¨ç©ºé—´å°‘å¾—å¤šã€‚ æ³¨å…¥å…¶ä»– Promise å®ç°çš„é€‰é¡¹ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§é…ç½®éƒ¨åˆ†ã€‚ é…ç½®â¬†ExcelJS ç°åœ¨æ”¯æŒå¯¹ Promise åº“çš„ä¾èµ–é¡¹æ³¨å…¥ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨æ¨¡å—ä¸­åŒ…å«ä»¥ä¸‹ä»£ç æ¥è¿˜åŸ Bluebird Promiseã€‚ ExcelJS.config.setValue(&#x27;promise&#x27;, require(&#x27;bluebird&#x27;)); è¯·æ³¨æ„ï¼šæˆ‘å·²ç»ä½¿ç”¨ bluebird ä¸“é—¨æµ‹è¯•äº† ExcelJSï¼ˆç›´åˆ°æœ€è¿‘ï¼Œè¿™æ˜¯å®ƒä½¿ç”¨çš„åº“ï¼‰ã€‚æ ¹æ®æˆ‘æ‰€åšçš„æµ‹è¯•ï¼Œå®ƒä¸é€‚ç”¨äº Qã€‚ æ³¨æ„äº‹é¡¹â¬†Dist æ–‡ä»¶å¤¹â¬†åœ¨å‘å¸ƒæ­¤æ¨¡å—ä¹‹å‰ï¼Œå…ˆå¯¹æºä»£ç è¿›è¡Œç¼–è¯‘å’Œå…¶ä»–å¤„ç†ï¼Œç„¶åå†å°†å®ƒä»¬æ”¾ç½®åœ¨ dist/ æ–‡ä»¶å¤¹ä¸­ã€‚è¯¥è‡ªè¿°æ–‡ä»¶æ ‡è¯†ä¸¤ä¸ªæ–‡ä»¶-æµè§ˆå™¨æ†ç»‘å’Œå‹ç¼©ç‰ˆæœ¬ã€‚é™¤äº†åœ¨ package.json ä¸­æŒ‡å®šä¸º &quot;main&quot; çš„æ–‡ä»¶å¤–ï¼Œä¸èƒ½ä¿è¯ dist/ æ–‡ä»¶å¤¹çš„å…¶ä»–å†…å®¹ã€‚ å·²çŸ¥çš„é—®é¢˜â¬†ä½¿ç”¨ Puppeteer è¿›è¡Œæµ‹è¯•â¬†è¯¥ lib ä¸­åŒ…å«çš„æµ‹è¯•å¥—ä»¶åŒ…æ‹¬ä¸€ä¸ªåœ¨æ— å¤´æµè§ˆå™¨ä¸­æ‰§è¡Œçš„å°è„šæœ¬ï¼Œä»¥éªŒè¯æ†ç»‘çš„è½¯ä»¶åŒ…ã€‚ åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œå…¶è¡¨ç°å‡ºè¯¥æµ‹è¯•åœ¨ Windows Linux å­ç³»ç»Ÿä¸­ä¸èƒ½å¾ˆå¥½åœ°è¿›è¡Œã€‚ å› æ­¤ï¼Œå¯ä»¥é€šè¿‡å­˜åœ¨åä¸º .disable-test-browser çš„æ–‡ä»¶æ¥ç¦ç”¨æµè§ˆå™¨æµ‹è¯•ã€‚ sudo apt-get install libfontconfig æ‹¼æ¥ä¸åˆå¹¶â¬†å¦‚æœä»»ä½• splice æ“ä½œå½±å“åˆå¹¶çš„å•å…ƒæ ¼ï¼Œåˆ™åˆå¹¶ç»„å°†æ— æ³•æ­£ç¡®ç§»åŠ¨","updated":"2025-08-02T05:46:04.181Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"githubã€giteeè‡ªåŠ¨éƒ¨ç½²hexoåšå®¢","date":"2023-06-14T03:57:13.000Z","path":"2023/06/14/2023-06-14-github-gitee-blog/","text":"ä½¿ç”¨ hexo æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨æ‰§è¡Œhexo deployå»éƒ¨ç½²åšå®¢ä»£ç ï¼Œä½¿ç”¨ gitee éƒ¨ç½²åšå®¢æ—¶ï¼Œå› ä¸º gitee åšå®¢ä¸ä¼šè‡ªåŠ¨éƒ¨ç½²ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨ç‚¹å‡»éƒ¨ç½²æŒ‰é’® é’ˆå¯¹ä¸Šé¢ 2 ä¸ªé—®é¢˜æˆ‘ä»¬ä½¿ç”¨ github actions è‡ªåŠ¨å»æ‰§è¡Œç›¸å…³ä»£ç  github è‡ªåŠ¨éƒ¨ç½²ä»£ç åœ¨åˆ›å»ºä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆéœ€è¦æ‰‹åŠ¨åˆ›å»ºä¸»é¢˜çš„submodule # Add submodule$ git submodule add https://github.com/theme-next/hexo-theme-next themes/next# Get tags list$ cd themes/next$ git tag -lâ€¦v6.0.0v6.0.1v6.0.2...# Switch on v6.0.1 tagged release version$ git checkout tags/v6.0.1Note: checking out &#x27;tags/v6.0.1&#x27;.â€¦HEAD is now at da9cdd2... Release v6.0.1# If you want to switch on latest release version without defining tag (optional)$ git checkout $(git describe --tags $(git rev-list --tags --max-count=1)) å¦‚æœæ²¡æœ‰æ‰“ tagï¼Œåœ¨ git submodule addä¹‹åï¼Œ ç›´æ¥æäº¤ä»£ç å³å¯ name: Hexo Deploy Automatically and update gitee deployon: push: branches: [dev] workflow_dispatch:jobs: deploy-blog: runs-on: ubuntu-latest steps: - name: Checkout Latest Version uses: actions/checkout@v2 # éœ€è¦æäº¤åˆ›å»ºå¯¹åº”çš„themeçš„submodule - name: Checkout Theme run: | git submodule init git submodule update - name: Setup Node Env uses: actions/setup-node@v1 # Caching dependencies to speed up workflows. (GitHub will remove any cache entries that have not been accessed in over 7 days.) - name: Cache Node Dependencies id: cache uses: actions/cache@v1 with: path: node_modules key: $&#123;&#123;runner.OS&#125;&#125;-npm-caches-$&#123;&#123; hashFiles(&#x27;package-lock.json&#x27;) &#125;&#125; - name: Install Dependencies if: steps.cache.outputs.cache-hit != &#x27;true&#x27; run: npm install # å¡«å†™è‡ªå·±çš„github usernameã€email - name: Deploy env: SSH_KEY: $&#123;&#123;secrets.GITEE_RSA_PRIVATE_KEY&#125;&#125; run: | export TZ=&#x27;Asia/Shanghai&#x27; mkdir -p ~/.ssh/ echo &quot;$SSH_KEY&quot; &gt; ~/.ssh/id_rsa chmod 600 ~/.ssh/id_rsa ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts git config --global user.name &#x27;[username]&#x27; git config --global user.email &#x27;[email]&#x27; hexo clean hexo generate hexo deploy - name: Sync to Gitee uses: wearerequired/git-mirror-action@master env: # æ³¨æ„åœ¨ Settings-&gt;Secrets é…ç½® GITEE_RSA_PRIVATE_KEY SSH_PRIVATE_KEY: $&#123;&#123; secrets.GITEE_RSA_PRIVATE_KEY &#125;&#125; with: # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ GitHub æºä»“åº“åœ°å€ source-repo: git@github.com:luckyship/luckyship.github.io.git # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ Gitee ç›®æ ‡ä»“åº“åœ°å€ destination-repo: git@gitee.com:luckyship/luckyship.git - name: Build Gitee Pages uses: yanglbme/gitee-pages-action@main with: # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ Gitee ç”¨æˆ·å gitee-username: luckyship # æ³¨æ„åœ¨ Settings-&gt;Secrets é…ç½® GITEE_PASSWORD gitee-password: $&#123;&#123; secrets.GITEE_PASSWORD &#125;&#125; # æ³¨æ„æ›¿æ¢ä¸ºä½ çš„ Gitee ä»“åº“ï¼Œä»“åº“åä¸¥æ ¼åŒºåˆ†å¤§å°å†™ï¼Œè¯·å‡†ç¡®å¡«å†™ï¼Œå¦åˆ™ä¼šå‡ºé”™ gitee-repo: luckyship/luckyship # è¦éƒ¨ç½²çš„åˆ†æ”¯ï¼Œé»˜è®¤æ˜¯ masterï¼Œè‹¥æ˜¯å…¶ä»–åˆ†æ”¯ï¼Œåˆ™éœ€è¦æŒ‡å®šï¼ˆæŒ‡å®šçš„åˆ†æ”¯å¿…é¡»å­˜åœ¨ï¼‰ branch: main GITEE_RSA_PRIVATE_KEYä½¿ç”¨çš„æ˜¯ç§é’¥ï¼Œ åœ¨~/.ssh/id_rsa æ˜¯ç§é’¥, å¦‚ä½•ç”Ÿæˆå…¬é’¥å’Œç§é’¥ï¼Œå‚è€ƒgit å‚è€ƒgitee-pages-actionhexo-action","updated":"2025-08-02T05:46:04.181Z","tags":[{"name":"hexo","slug":"hexo","permalink":"https://luckyship.github.io/tags/hexo/"}]},{"title":"angularä¸­çš„å˜åŒ–æ£€æµ‹-zone.js","date":"2023-06-06T07:58:39.000Z","path":"2023/06/06/2023-06-06-angular-detect-changes/","text":"Zone æ˜¯è·¨å¼‚æ­¥ä»»åŠ¡è€ŒæŒä¹…å­˜åœ¨çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚ä½ å¯ä»¥å°†å…¶è§†ä¸º JavaScript VM ä¸­çš„çº¿ç¨‹æœ¬åœ°å­˜å‚¨ã€‚æœ¬æŒ‡å—ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Angular çš„ çš„ NgZone è‡ªåŠ¨æ£€æµ‹ç»„ä»¶ä¸­çš„æ›´æ”¹ä»¥æ›´æ–° HTMLã€‚ å˜æ›´æ£€æµ‹çš„åŸºç¡€è¦ç†è§£ NgZone çš„å¥½å¤„ï¼Œé‡è¦çš„æ˜¯è¦æ¸…æ¥šåœ°äº†è§£ä»€ä¹ˆæ˜¯å˜æ›´æ£€æµ‹ä»¥åŠå®ƒçš„å·¥ä½œåŸç†ã€‚ åœ¨ Angular ä¸­æ˜¾ç¤ºå’Œæ›´æ–°æ•°æ®åœ¨ Angular ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡æŠŠ HTML æ¨¡æ¿ä¸­çš„æ§ä»¶ç»‘å®šåˆ° Angular ç»„ä»¶çš„å±æ€§æ¥æ˜¾ç¤ºæ•°æ®ã€‚ // src/app/app.component.tsimport &#123; Component &#125; from &quot;@angular/core&quot;;@Component(&#123; selector: &quot;app-root&quot;, template: ` &lt;h1&gt;&#123;&#123; title &#125;&#125;&lt;/h1&gt; &lt;h2&gt;My favorite hero is: &#123;&#123; myHero &#125;&#125;&lt;/h2&gt; `,&#125;)export class AppComponent &#123; title = &quot;Tour of Heroes&quot;; myHero = &quot;Windstorm&quot;;&#125; å¦å¤–ï¼Œä½ ä¹Ÿå¯ä»¥å°† DOM äº‹ä»¶ç»‘å®šåˆ° Angular ç»„ä»¶ä¸­çš„æ–¹æ³•ã€‚åœ¨æ­¤ç±»æ–¹æ³•ä¸­ï¼Œä½ è¿˜å¯ä»¥æ›´æ–° Angular ç»„ä»¶çš„å±æ€§ï¼Œè¯¥å±æ€§å°†æ›´æ–°æ¨¡æ¿ä¸­æ˜¾ç¤ºçš„ç›¸åº”æ•°æ®ã€‚ // src/app/click-me.component.ts@Component(&#123; selector: &quot;app-click-me&quot;, template: ` &lt;button type=&quot;button&quot; (click)=&quot;onClickMe()&quot;&gt;Click me!&lt;/button&gt; &#123;&#123; clickMessage &#125;&#125;`,&#125;)export class ClickMeComponent &#123; clickMessage = &quot;&quot;; onClickMe() &#123; this.clickMessage = &quot;You are my hero!&quot;; &#125;&#125; åœ¨ä»¥ä¸Šä¸¤ä¸ªç¤ºä¾‹ä¸­ï¼Œç»„ä»¶çš„ä»£ç ä»…æ›´æ–°ç»„ä»¶çš„å±æ€§ã€‚ä½†æ˜¯ï¼ŒHTML ä¹Ÿä¼šè‡ªåŠ¨æ›´æ–°ã€‚æœ¬æŒ‡å—ä»‹ç»äº† Angular å¦‚ä½•ä»¥åŠä½•æ—¶æ ¹æ® Angular ç»„ä»¶ä¸­çš„æ•°æ®æ¸²æŸ“ HTMLã€‚ ä½¿ç”¨æ™®é€šï¼ˆPlainï¼‰JavaScript æ£€æµ‹æ›´æ”¹ä¸ºäº†é˜æ˜å¦‚ä½•æ£€æµ‹åˆ°æ›´æ”¹å’Œæ›´æ–°å€¼ï¼Œè¯·è€ƒè™‘ä»¥ä¸‹ç”¨æ™®é€š JavaScript ç¼–å†™çš„ä»£ç ã€‚ &lt;html&gt; &lt;div id=&quot;dataDiv&quot;&gt;&lt;/div&gt; &lt;button id=&quot;btn&quot;&gt;updateData&lt;/button&gt; &lt;canvas id=&quot;canvas&quot;&gt;&lt;/canvas&gt; &lt;script&gt; let value = &quot;initialValue&quot;; // initial rendering detectChange(); function renderHTML() &#123; document.getElementById(&quot;dataDiv&quot;).innerText = value; &#125; function detectChange() &#123; const currentValue = document.getElementById(&quot;dataDiv&quot;).innerText; if (currentValue !== value) &#123; renderHTML(); &#125; &#125; // Example 1: update data inside button click event handler document.getElementById(&quot;btn&quot;).addEventListener(&quot;click&quot;, () =&gt; &#123; // update value value = &quot;button update value&quot;; // call detectChange manually detectChange(); &#125;); // Example 2: HTTP Request const xhr = new XMLHttpRequest(); xhr.addEventListener(&quot;load&quot;, function () &#123; // get response from server value = this.responseText; // call detectChange manually detectChange(); &#125;); xhr.open(&quot;GET&quot;, serverUrl); xhr.send(); // Example 3: setTimeout setTimeout(() =&gt; &#123; // update value inside setTimeout callback value = &quot;timeout update value&quot;; // call detectChange manually detectChange(); &#125;, 100); // Example 4: Promise.then Promise.resolve(&quot;promise resolved a value&quot;).then((v) =&gt; &#123; // update value inside Promise thenCallback value = v; // call detectChange manually detectChange(); &#125;, 100); // Example 5: some other asynchronous APIs document.getElementById(&quot;canvas&quot;).toBlob((blob) =&gt; &#123; // update value when blob data is created from the canvas value = `value updated by canvas, size is $&#123;blob.size&#125;`; // call detectChange manually detectChange(); &#125;); &lt;/script&gt;&lt;/html&gt; æ›´æ–°æ•°æ®åï¼Œéœ€è¦è°ƒç”¨ detectChange() æ¥æ£€æŸ¥æ•°æ®æ˜¯å¦å·²æ›´æ”¹ã€‚å¦‚æœæ•°æ®å·²æ›´æ”¹ï¼Œåˆ™æ¸²æŸ“ HTML ä»¥åæ˜ æ›´æ–°çš„æ•°æ®ã€‚ åœ¨ Angular ä¸­ï¼Œæ­¤æ­¥éª¤æ˜¯ä¸å¿…è¦çš„ã€‚æ¯å½“ä½ æ›´æ–°æ•°æ®æ—¶ï¼Œä½ çš„ HTML éƒ½ä¼šè‡ªåŠ¨æ›´æ–°ã€‚ åº”ç”¨ä½•æ—¶æ›´æ–° HTMLè¦äº†è§£å˜æ›´æ£€æµ‹çš„å·¥ä½œåŸç†ï¼Œè¯·é¦–å…ˆè€ƒè™‘åº”ç”¨ç¨‹åºä½•æ—¶éœ€è¦æ›´æ–° HTMLã€‚é€šå¸¸ï¼Œä¼šç”±äºä»¥ä¸‹åŸå› ä¹‹ä¸€è€Œå‘ç”Ÿæ›´æ–°ï¼š ç»„ä»¶åˆå§‹åŒ–ã€‚æ¯”å¦‚ï¼Œå½“å¼•å¯¼ Angular åº”ç”¨ç¨‹åºæ—¶ï¼ŒAngular ä¼šåŠ è½½å¼•å¯¼ç»„ä»¶å¹¶è§¦å‘ ApplicationRef.tick() æ¥è°ƒç”¨å˜æ›´æ£€æµ‹å’Œè§†å›¾æ¸²æŸ“ã€‚ äº‹ä»¶ç›‘å¬å™¨ã€‚DOM äº‹ä»¶ä¾¦å¬å™¨å¯ä»¥æ›´æ–° Angular ç»„ä»¶ä¸­çš„æ•°æ®ï¼Œè¿˜å¯ä»¥è§¦å‘å˜æ›´æ£€æµ‹ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚ // src/app/click-me.component.ts@Component(&#123; selector: &quot;app-click-me&quot;, template: ` &lt;button type=&quot;button&quot; (click)=&quot;onClickMe()&quot;&gt;Click me!&lt;/button&gt; &#123;&#123; clickMessage &#125;&#125;`,&#125;)export class ClickMeComponent &#123; clickMessage = &quot;&quot;; onClickMe() &#123; this.clickMessage = &quot;You are my hero!&quot;; &#125;&#125; HTTP æ•°æ®è¯·æ±‚ã€‚ä½ è¿˜å¯ä»¥é€šè¿‡ HTTP è¯·æ±‚ä»æœåŠ¡å™¨è·å–æ•°æ®ã€‚æ¯”å¦‚ï¼š @Component(&#123; selector: &#x27;app-root&#x27;, template: &#x27;&lt;div&gt;&#123;&#123;data&#125;&#125;&lt;/div&gt;&#x27;;&#125;)export class AppComponent implements OnInit &#123; data = &#x27;initial value&#x27;; serverUrl = &#x27;SERVER_URL&#x27;; constructor(private httpClient: HttpClient) &#123;&#125; ngOnInit() &#123; this.httpClient.get(this.serverUrl).subscribe(response =&gt; &#123; // user does not need to trigger change detection manually this.data = response.data; &#125;); &#125;&#125; å®ä»»åŠ¡ï¼Œæ¯”å¦‚ setTimeout() æˆ– setInterval()ã€‚ä½ è¿˜å¯ä»¥åœ¨è¯¸å¦‚ setTimeout() macroTask çš„å›è°ƒå‡½æ•°ä¸­æ›´æ–°æ•°æ®ã€‚æ¯”å¦‚ï¼š @Component(&#123; selector: &#x27;app-root&#x27;, template: &#x27;&lt;div&gt;&#123;&#123;data&#125;&#125;&lt;/div&gt;&#x27;;&#125;)export class AppComponent implements OnInit &#123; data = &#x27;initial value&#x27;; ngOnInit() &#123; setTimeout(() =&gt; &#123; // user does not need to trigger change detection manually this.data = &#x27;value updated&#x27;; &#125;); &#125;&#125; å¾®ä»»åŠ¡ï¼Œæ¯”å¦‚ Promise.then()ã€‚å…¶ä»–å¼‚æ­¥ APIï¼ˆæ¯”å¦‚ fetchï¼‰ä¼šè¿”å› Promise å¯¹è±¡ï¼Œå› æ­¤ then() å›è°ƒå‡½æ•°ä¹Ÿå¯ä»¥æ›´æ–°æ•°æ®ã€‚æ¯”å¦‚ï¼š @Component(&#123; selector: &#x27;app-root&#x27;, template: &#x27;&lt;div&gt;&#123;&#123;data&#125;&#125;&lt;/div&gt;&#x27;;&#125;)export class AppComponent implements OnInit &#123; data = &#x27;initial value&#x27;; ngOnInit() &#123; Promise.resolve(1).then(v =&gt; &#123; // user does not need to trigger change detection manually this.data = v; &#125;); &#125;&#125; å…¶ä»–å¼‚æ­¥æ“ä½œã€‚é™¤äº† addEventListener()ï¼ŒsetTimeout() å’Œ Promise.then()ï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›æ“ä½œå¯ä»¥å¼‚æ­¥æ›´æ–°æ•°æ®ã€‚æ¯”å¦‚ WebSocket.onmessage() å’Œ Canvas.toBlob()ã€‚ å‰é¢çš„åˆ—è¡¨åŒ…å«åº”ç”¨ç¨‹åºå¯èƒ½ä¼šåœ¨å…¶ä¸­æ›´æ”¹æ•°æ®çš„æœ€å¸¸è§åœºæ™¯ã€‚åªè¦ Angular æ£€æµ‹åˆ°æ•°æ®å¯èƒ½å·²æ›´æ”¹ï¼Œå°±ä¼šè¿è¡Œå˜æ›´æ£€æµ‹ã€‚å˜æ›´æ£€æµ‹çš„ç»“æœæ˜¯ DOM è¢«è¿™äº›æ–°æ•°æ®æ›´æ–°ã€‚Angular ä¼šä»¥ä¸åŒçš„æ–¹å¼æ£€æµ‹å˜åŒ–ã€‚å¯¹äºç»„ä»¶åˆå§‹åŒ–ï¼ŒAngular è°ƒç”¨æ˜¾å¼å˜æ›´æ£€æµ‹ã€‚å¯¹äºå¼‚æ­¥æ“ä½œï¼ŒAngular ä¼šä½¿ç”¨ Zone åœ¨æ•°æ®å¯èƒ½è¢«ä¿®æ”¹çš„åœ°æ–¹æ£€æµ‹å˜åŒ–ï¼Œå¹¶è‡ªåŠ¨è¿è¡Œå˜æ›´æ£€æµ‹ã€‚ Zone å’Œæ‰§è¡Œä¸Šä¸‹æ–‡Zone æä¾›äº†åœ¨å¼‚æ­¥ä»»åŠ¡ä¹‹é—´æŒä¹…å­˜åœ¨çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œç”¨äºåœ¨å½“å‰æ‰§è¡Œçš„ä»£ç ä¸­ä¿å­˜æœ‰å…³ç¯å¢ƒçš„ä¿¡æ¯ã€‚è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼š const callback = function () &#123; console.log(&quot;setTimeout callback context is&quot;, this);&#125;;const ctx1 = &#123; name: &quot;ctx1&quot; &#125;;const ctx2 = &#123; name: &quot;ctx2&quot; &#125;;const func = function () &#123; console.log(&quot;caller context is&quot;, this); setTimeout(callback);&#125;;func.apply(ctx1);func.apply(ctx2); setTimeout() å›è°ƒä¸­çš„ this å€¼å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œå…·ä½“å–å†³äº setTimeout() çš„è°ƒç”¨æ—¶æœºã€‚å› æ­¤ï¼Œä½ å¯èƒ½ä¼šåœ¨å¼‚æ­¥æ“ä½œä¸­ä¸¢å¤±ä¸Šä¸‹æ–‡ã€‚ The value of this in the callback of setTimeout() might differ depending on when setTimeout() is called.Thus, you can lose the context in asynchronous operations. Zone æä¾›äº†ä¸åŒäº this çš„æ–°çš„ Zone ä¸Šä¸‹æ–‡ï¼Œè¯¥ Zone ä¸Šä¸‹æ–‡åœ¨å¼‚æ­¥æ“ä½œä¸­ä¿æŒä¸å˜ã€‚åœ¨ä¸‹ä¾‹ä¸­ï¼Œæ–°çš„ Zone ä¸Šä¸‹æ–‡ç§°ä¸º zoneThisã€‚ zone.run(() =&gt; &#123; // now you are in a zone expect(zoneThis).toBe(zone); setTimeout(function () &#123; // the zoneThis context will be the same zone // when the setTimeout is scheduled expect(zoneThis).toBe(zone); &#125;);&#125;); æ–°çš„ä¸Šä¸‹æ–‡ zoneThis å¯ä»¥ä» setTimeout() çš„å›è°ƒå‡½æ•°ä¸­æ£€ç´¢å‡ºæ¥ï¼Œè¿™ä¸ªä¸Šä¸‹æ–‡å’Œè°ƒç”¨ setTimeout() æ—¶çš„ä¸Šä¸‹æ–‡æ˜¯ä¸€æ ·çš„ã€‚è¦è·å–æ­¤ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥è°ƒç”¨ Zone.currentã€‚ Zone å’Œå¼‚æ­¥ç”Ÿå‘½å‘¨æœŸé’©å­Zone.js å¯ä»¥åˆ›å»ºåœ¨å¼‚æ­¥æ“ä½œä¸­æŒä¹…å­˜åœ¨çš„ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸ºå¼‚æ­¥æ“ä½œæä¾›ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚ const zone = Zone.current.fork(&#123; name: &quot;zone&quot;, onScheduleTask: function (delegate, curr, target, task) &#123; console.log(&quot;new task is scheduled:&quot;, task.type, task.source); return delegate.scheduleTask(target, task); &#125;, onInvokeTask: function (delegate, curr, target, task, applyThis, applyArgs) &#123; console.log(&quot;task will be invoked:&quot;, task.type, task.source); return delegate.invokeTask(target, task, applyThis, applyArgs); &#125;, onHasTask: function (delegate, curr, target, hasTaskState) &#123; console.log(&quot;task state changed in the zone:&quot;, hasTaskState); return delegate.hasTask(target, hasTaskState); &#125;, onInvoke: function (delegate, curr, target, callback, applyThis, applyArgs) &#123; console.log(&quot;the callback will be invoked:&quot;, callback); return delegate.invoke(target, callback, applyThis, applyArgs); &#125;,&#125;);zone.run(() =&gt; &#123; setTimeout(() =&gt; &#123; console.log(&quot;timeout callback is invoked.&quot;); &#125;);&#125;); ä¸Šé¢çš„ç¤ºä¾‹åˆ›å»ºäº†ä¸€ä¸ªå…·æœ‰å¤šä¸ªé’©å­çš„ Zoneã€‚ å½“ä»»åŠ¡çŠ¶æ€æ›´æ”¹æ—¶ï¼Œå°±ä¼šè§¦å‘ onXXXTask é’©å­ã€‚Zone ä»»åŠ¡çš„æ¦‚å¿µä¸ JavaScript VM ä¸­ä»»åŠ¡çš„æ¦‚å¿µéå¸¸ç›¸ä¼¼ï¼š macroTaskï¼šæ¯”å¦‚ setTimeout() microTaskï¼šæ¯”å¦‚ Promise.then() eventTaskï¼šæ¯”å¦‚ element.addEventListener()eventTask: such as element.addEventListener() è¿™äº›é’©å­åœ¨ä»¥ä¸‹æƒ…å†µä¸‹è§¦å‘ï¼š é’©å­ è¯¦æƒ… onScheduleTask åœ¨è®¡åˆ’æ–°çš„å¼‚æ­¥ä»»åŠ¡æ—¶è§¦å‘ï¼Œæ¯”å¦‚è°ƒç”¨ setTimeout() æ—¶ã€‚ onInvokeTask åœ¨å¼‚æ­¥ä»»åŠ¡å³å°†æ‰§è¡Œæ—¶è§¦å‘ï¼Œæ¯”å¦‚ setTimeout() çš„å›è°ƒå³å°†æ‰§è¡Œæ—¶ã€‚ onHasTask å½“ Zone å†…çš„ä¸€ç§ä»»åŠ¡çš„çŠ¶æ€ä»ç¨³å®šå˜ä¸ºä¸ç¨³å®šæˆ–ä»ä¸ç¨³å®šå˜ä¸ºç¨³å®šæ—¶è§¦å‘ã€‚çŠ¶æ€â€œç¨³å®šâ€è¡¨ç¤ºè¯¥ Zone å†…æ²¡æœ‰ä»»åŠ¡ï¼Œè€Œâ€œä¸ç¨³å®šâ€è¡¨ç¤ºåœ¨è¯¥ Zone ä¸­è®¡åˆ’äº†æ–°ä»»åŠ¡ã€‚ onInvoke å°†åœ¨ Zone ä¸­æ‰§è¡ŒåŒæ­¥å‡½æ•°æ—¶è§¦å‘ã€‚ ä½¿ç”¨è¿™äº›é’©å­ï¼ŒZone å¯ä»¥ç›‘è§† Zone å†…æ‰€æœ‰åŒæ­¥å’Œå¼‚æ­¥æ“ä½œçš„çŠ¶æ€ã€‚ ä¸Šé¢çš„ç¤ºä¾‹è¿”å›ä»¥ä¸‹è¾“å‡ºï¼š the callback will be invoked: () =&gt; &#123; setTimeout(() =&gt; &#123; console.log(&#x27;timeout callback is invoked.&#x27;); &#125;);&#125;new task is scheduled: macroTask setTimeouttask state changed in the zone: &#123; microTask: false, macroTask: true, eventTask: false, change: &#x27;macroTask&#x27; &#125;task will be invoked macroTask: setTimeouttimeout callback is invoked.task state changed in the zone: &#123; microTask: false, macroTask: false, eventTask: false, change: &#x27;macroTask&#x27; &#125; Zone çš„æ‰€æœ‰å‡½æ•°éƒ½ç”±ä¸€ä¸ªåä¸º Zone.js çš„åº“æä¾›ã€‚è¯¥åº“é€šè¿‡çŒ´å­è¡¥ä¸æ‹¦æˆªå¼‚æ­¥ API æ¥å®ç°è¿™äº›ç‰¹æ€§ã€‚ çŒ´å­è¡¥ä¸æ˜¯ä¸€ç§åœ¨è¿è¡Œæ—¶æ·»åŠ æˆ–æ›´æ”¹å‡½æ•°çš„é»˜è®¤è¡Œä¸ºè€Œä¸æ›´æ”¹æºä»£ç çš„æŠ€æœ¯ã€‚ Zone çš„æ‰€æœ‰åŠŸèƒ½å‡ç”±åä¸º Zone.js çš„åº“æä¾›ã€‚è¯¥åº“é€šè¿‡çŒ´å­è¡¥ä¸æ‹¦æˆªå¼‚æ­¥ API æ¥å®ç°è¿™äº›åŠŸèƒ½ã€‚çŒ´å­è¡¥ä¸æ˜¯ä¸€ç§åœ¨è¿è¡Œæ—¶æ·»åŠ æˆ–ä¿®æ”¹å‡½æ•°é»˜è®¤è¡Œä¸ºè€Œæ— éœ€æ›´æ”¹æºä»£ç çš„æŠ€æœ¯ã€‚ NgZoneè™½ç„¶ Zone.js å¯ä»¥ç›‘è§†åŒæ­¥å’Œå¼‚æ­¥æ“ä½œçš„æ‰€æœ‰çŠ¶æ€ï¼Œä½† Angular è¿˜æä¾›äº†ä¸€é¡¹åä¸º NgZone çš„æœåŠ¡ã€‚æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼Œæ­¤æœåŠ¡ä¼šåˆ›å»ºä¸€ä¸ªåä¸º angular çš„ Zone æ¥è‡ªåŠ¨è§¦å‘å˜æ›´æ£€æµ‹ã€‚ å½“æ‰§è¡ŒåŒæ­¥æˆ–å¼‚æ­¥åŠŸèƒ½æ—¶ å·²ç»æ²¡æœ‰å·²è®¡åˆ’çš„ microTask NgZone run() å’Œ runOutsideOfAngular()Zone å¤„ç†å¤§å¤šæ•°å¼‚æ­¥ APIï¼Œæ¯”å¦‚ setTimeout()ã€Promise.then() å’Œ addEventListener()ã€‚æœ‰å…³å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚è§ Zone æ¨¡å—çš„æ–‡æ¡£ã€‚åœ¨è¿™äº›å¼‚æ­¥ API ä¸­ï¼Œä½ æ— éœ€æ‰‹åŠ¨è§¦å‘å˜æ›´æ£€æµ‹ã€‚ æœ‰äº›ç¬¬ä¸‰æ–¹ API æ²¡æœ‰è¢« Zone å¤„ç†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ[NgZone](https://angular.cn/api/core/NgZone) æœåŠ¡æä¾›äº† run() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å…è®¸ä½ åœ¨ angular Zone ä¸­æ‰§è¡Œå‡½æ•°ã€‚æ­¤å‡½æ•°ä»¥åŠè¯¥å‡½æ•°ä¸­çš„æ‰€æœ‰å¼‚æ­¥æ“ä½œä¼šåœ¨æ­£ç¡®çš„æ—¶é—´è‡ªåŠ¨è§¦å‘å˜æ›´æ£€æµ‹ã€‚ export class AppComponent implements OnInit &#123; constructor(private ngZone: NgZone) &#123;&#125; ngOnInit() &#123; // New async API is not handled by Zone, so you need to use ngZone.run() // to make the asynchronous operation callback in the Angular zone and // trigger change detection automatically. someNewAsyncAPI(() =&gt; &#123; this.ngZone.run(() =&gt; &#123; // update the data of the component &#125;); &#125;); &#125;&#125; é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å¼‚æ­¥æ“ä½œéƒ½åœ¨ Angular Zone å†…ï¼Œè¿™ä¼šè‡ªåŠ¨è§¦å‘å˜æ›´æ£€æµ‹ã€‚å¦ä¸€ä¸ªå¸¸è§çš„æƒ…å†µæ˜¯ä½ ä¸æƒ³è§¦å‘å˜æ›´æ£€æµ‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ª [NgZone](https://angular.cn/api/core/NgZone) æ–¹æ³•ï¼šrunOutsideAngular()ã€‚ è®¾ç½® Zone.jsä¸ºäº†ä½¿ Zone.js åœ¨ Angular ä¸­å¯ç”¨ï¼Œä½ éœ€è¦å¯¼å…¥ zone.js åŒ…ã€‚å¦‚æœä½¿ç”¨çš„æ˜¯ Angular CLIï¼Œåˆ™æ­¤æ­¥éª¤å°†è‡ªåŠ¨å®Œæˆï¼Œå¹¶ä¸”ä½ ä¼šåœ¨ src/polyfills.ts ä¸­çœ‹åˆ°ä»¥ä¸‹è¡Œï¼š /*************************************************************************************************** * Zone JS is required by default for Angular itself. */import &quot;zone.js&quot;; // Included with Angular CLI. åœ¨å¯¼å…¥ zone.js è½¯ä»¶åŒ…ä¹‹å‰ï¼Œä½ å¯ä»¥åšå¦‚ä¸‹é…ç½®ï¼š ç¦ç”¨ä¸€äº›å¼‚æ­¥ API çš„çŒ´å­è¡¥ä¸ï¼Œä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ç¦ç”¨ requestAnimationFrame() çš„çŒ´å­è¡¥ä¸ï¼Œè¿™æ · requestAnimationFrame() çš„å›è°ƒå°±ä¸ä¼šè§¦å‘å˜æ›´æ£€æµ‹ã€‚å¦‚æœä½ çš„åº”ç”¨ç¨‹åºä¸ä¼šåœ¨ requestAnimationFrame() å›è°ƒä¸­æ›´æ–°ä»»ä½•æ•°æ®ï¼Œåˆ™è¿™ç§æ–¹å¼å¾ˆæœ‰ç”¨ã€‚ æŒ‡å®šæŸäº› DOM äº‹ä»¶ä¸åœ¨ Angular Zone å†…è¿è¡Œï¼›æ¯”å¦‚ï¼Œä¸ºäº†é˜²æ­¢ mousemove æˆ– scroll äº‹ä»¶æ¥è§¦å‘å˜æ›´æ£€æµ‹ã€‚ è¿˜å¯ä»¥æ›´æ”¹å¦å¤–å‡ ä¸ªè®¾ç½®ã€‚è¦è¿›è¡Œè¿™äº›æ›´æ”¹ï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ª zone-flags.ts æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ // disable patching requestAnimationFrame(window as any).__Zone_disable_requestAnimationFrame = true;// disable patching specified eventNames(window as any).__zone_symbol__UNPATCHED_EVENTS = [&quot;scroll&quot;, &quot;mousemove&quot;]; æœ‰å…³å¯ä»¥é…ç½®çš„å†…å®¹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…Zone.jsæ–‡æ¡£ã€‚ NoopZoneZone èƒ½å¸®åŠ© Angular çŸ¥é“ä½•æ—¶è¦è§¦å‘å˜æ›´æ£€æµ‹ï¼Œå¹¶ä½¿å¼€å‘äººå‘˜ä¸“æ³¨äºåº”ç”¨å¼€å‘ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒZone å·²åŠ è½½ä¸”æ— éœ€å…¶ä»–é…ç½®å³å¯å·¥ä½œã€‚ä¹Ÿä¸æ˜¯ä¸€å®šè¦ç”¨ Zone æ‰èƒ½ä½¿ Angular å·¥ä½œã€‚ç›¸åï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©è‡ªå·±è§¦å‘å˜æ›´æ£€æµ‹ã€‚ è¦åˆ é™¤ Zone.jsï¼Œè¯·è¿›è¡Œä»¥ä¸‹æ›´æ”¹ã€‚ ä» polyfills.ts ä¸­ç§»é™¤å¯¹ zone.js çš„å¯¼å…¥ /*************************************************************************************************** * Zone JS is required by default for Angular itself. */// import &#x27;zone.js&#x27;; // Included with Angular CLI. åœ¨ src/main.ts ä¸­ä½¿ç”¨ noop Zone å¼•å¯¼ Angularï¼š platformBrowserDynamic() .bootstrapModule(AppModule, &#123; ngZone: &quot;noop&quot; &#125;) .catch((err) =&gt; console.error(err)); è½¬è½½ngZone","updated":"2025-08-02T05:46:04.181Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"angular","slug":"angular","permalink":"https://luckyship.github.io/tags/angular/"}]},{"title":"ä»€ä¹ˆæ˜¯iconfont","date":"2023-06-05T05:41:43.000Z","path":"2023/06/05/2023-06-05-iconfont/","text":"iconfont æ˜¯ä»€ä¹ˆï¼š é¡¾åæ€ä¹‰ï¼ŒIconFont å°±æ˜¯å­—ä½“å›¾æ ‡ã€‚ä¸¥æ ¼åœ°è¯´ï¼Œå°±æ˜¯ä¸€ç§å­—ä½“ï¼Œä½†æ˜¯ï¼Œå®ƒä»¬ä¸åŒ…å«å­—æ¯æˆ–æ•°å­—ï¼Œè€Œæ˜¯åŒ…å«ç¬¦å·å’Œå­—å½¢ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ CSS è®¾ç½®æ ·å¼ï¼Œå°±åƒè®¾ç½®å¸¸è§„æ–‡æœ¬ä¸€æ ·ï¼Œè¿™ä½¿å¾— IconFont æˆä¸º Web å¼€å‘æ—¶å›¾æ ‡çš„çƒ­é—¨é€‰æ‹©ã€‚ IconFont çš„ä½¿ç”¨æ–¹å¼å’Œ ä¼ ç»Ÿçš„ WebFont å¦‚å‡ºä¸€è¾™ï¼ŒåˆæŠŠå¤§é‡çš„å›¾æ ‡å˜æˆäº†ä¸€ä¸ªå­—ä½“æ–‡ä»¶ï¼Œå‡å°‘äº†è¯·æ±‚æ•°ï¼Œè€Œä¸”æœ‰æ•ˆå‡å°è¯·æ±‚ä½“ç§¯ã€‚å½“ä¸€ä¸ªç½‘é¡µæœ‰è‡ªå·±çš„å›¾æ ‡å­—ä½“åº“ä¹‹åï¼Œå¯ä»¥å¤ç”¨åœ¨å¾ˆå¤šåœ°æ–¹ï¼Œå‡å°‘å¾ˆå¤šäºŒæ¬¡å¼€å‘æˆæœ¬ã€‚å› æ­¤ç°ä»£ç½‘é¡µå¤šä¼šä½¿ç”¨ IconFont æ¥å±•ç¤ºå›¾æ ‡ï¼Œé‚£ä¹ˆå¦‚ä½•ä½¿ç”¨å¹¶ä¸”ç”Ÿæˆ IconFont ä¹Ÿå°±å˜æˆäº†å‰ç«¯å¼€å‘äººå‘˜å¿…çŸ¥å¿…ä¼šçš„èƒ½åŠ›ã€‚ ä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ å¯ä»¥æ–¹ä¾¿åœ°å°†ä»»ä½• CSS æ•ˆæœåº”ç”¨äºå®ƒä»¬ã€‚ å› ä¸ºå®ƒä»¬æ˜¯çŸ¢é‡å›¾å½¢ï¼Œæ‰€ä»¥å®ƒä»¬æ˜¯å¯ä¼¸ç¼©çš„ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥åœ¨ä¸é™ä½è´¨é‡çš„æƒ…å†µä¸‹ä¼¸ç¼©å®ƒä»¬ã€‚ æˆ‘ä»¬åªéœ€è¦å‘é€ä¸€ä¸ªæˆ–å°‘é‡ HTTP è¯·æ±‚æ¥åŠ è½½å®ƒä»¬ï¼Œè€Œä¸æ˜¯åƒå›¾ç‰‡ï¼Œå¯èƒ½éœ€è¦å¤šä¸ª HTTP è¯·æ±‚ã€‚ ç”±äºå°ºå¯¸å°ï¼Œå®ƒä»¬åŠ è½½é€Ÿåº¦å¿«ã€‚ å®ƒä»¬åœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­éƒ½å¾—åˆ°æ”¯æŒï¼ˆç”šè‡³æ”¯æŒåˆ° IE6ï¼‰ã€‚ ç¼ºç‚¹ ä¸èƒ½ç”¨æ¥æ˜¾ç¤ºå¤æ‚å›¾åƒ é€šå¸¸åªé™äºä¸€ç§é¢œè‰²ï¼Œé™¤éåº”ç”¨ä¸€äº› CSS æŠ€å·§ å­—ä½“å›¾æ ‡é€šå¸¸æ˜¯æ ¹æ®ç‰¹å®šçš„ç½‘æ ¼è®¾è®¡çš„ï¼Œä¾‹å¦‚ 16x16, 32Ã—32, 48Ã—48ç­‰ã€‚å¦‚æœç”±äºæŸç§åŸå› å°†ç½‘æ ¼ç³»ç»Ÿæ”¹ä¸º25Ã—25ï¼Œå¯èƒ½ä¸ä¼šå¾—åˆ°æ¸…æ™°çš„ç»“æœ **IconFont åŸç†** IconFont çš„ä½¿ç”¨åŸç†æ¥è‡ªäº css çš„ @font-face å±æ€§ã€‚è¿™ä¸ªå±æ€§ç”¨æ¥å®šä¹‰ä¸€ä¸ªæ–°çš„å­—ä½“ï¼ŒåŸºæœ¬ç”¨æ³•å¦‚ä¸‹ï¼š @font-face &#123; font-family: &lt;YourFontName&gt;; src: &lt;url&gt; [&lt;format&gt;],[&lt;source&gt; [&lt;format&gt;]], *; [font-weight: &lt;weight&gt;]; [font-style: &lt;style&gt;];&#125; font-familyï¼šä¸ºè½½å…¥çš„å­—ä½“å–åå­—ã€‚ srcï¼š[url]åŠ è½½å­—ä½“ï¼Œå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç½‘ç»œåœ°å€ã€‚ [format]å®šä¹‰çš„å­—ä½“çš„æ ¼å¼ï¼Œç”¨æ¥å¸®åŠ©æµè§ˆå™¨è¯†åˆ«ã€‚ä¸»è¦å–å€¼ä¸ºï¼štruetype(.ttf)ã€opentypeï¼ˆ.otfï¼‰ã€truetype-aatã€embedded-opentype(.eot)ã€svg(.svg)ã€woff(.woff)ã€‚ font-weightï¼šå®šä¹‰åŠ ç²—æ ·å¼ã€‚ font-styleï¼šå®šä¹‰å­—ä½“æ ·å¼ã€‚ format å¯¹åº”å­—ä½“æ ¼å¼ **å¸¸è§å…¼å®¹æ€§å†™æ³•ï¼š** @font-face &#123; font-family: &quot;defineName&quot;; src: url(&quot;../fonts/custom-font.eot&quot;); src: url(&quot;../fonts/custom-font.eot?#iefix&quot;) format(&quot;embedded-opentype&quot;), url(&quot;../fonts/custom-font.woff&quot;) format(&quot;woff&quot;), url(&quot;../fonts/custom-font.ttf&quot;) format(&quot;truetype&quot;), url(&quot;../fonts/custom-font.svg#defineName&quot;) format(&quot;svg&quot;); font-weight: normal; font-style: normal;&#125; **iefixæœ‰ä½•ä½œç”¨ï¼Ÿ** IE9 ä¹‹å‰çš„ç‰ˆæœ¬æ²¡æœ‰æŒ‰ç…§æ ‡å‡†è§£æå­—ä½“å£°æ˜ï¼Œå½“ src å±æ€§åŒ…å«å¤šä¸ª url æ—¶ï¼Œå®ƒæ— æ³•æ­£ç¡®çš„è§£æè€Œè¿”å› 404 é”™è¯¯ï¼Œè€Œå…¶ä»–æµè§ˆå™¨ä¼šè‡ªåŠ¨é‡‡ç”¨è‡ªå·±é€‚ç”¨çš„ urlã€‚å› æ­¤æŠŠä»… IE9 ä¹‹å‰æ”¯æŒçš„ EOT æ ¼å¼æ”¾åœ¨ç¬¬ä¸€ä½ï¼Œç„¶ååœ¨ url ååŠ ä¸Š ?ï¼Œè¿™æ · IE9 ä¹‹å‰çš„ç‰ˆæœ¬ä¼šæŠŠé—®å·ä¹‹åçš„å†…å®¹å½“ä½œ url çš„å‚æ•°ã€‚ **è‡³äº #iefix çš„ä½œç”¨**ï¼Œä¸€æ˜¯èµ·åˆ°äº†æ³¨é‡Šçš„ä½œç”¨ï¼ŒäºŒæ˜¯å¯ä»¥å°† url å‚æ•°å˜ä¸ºé”šç‚¹ï¼Œå‡å°‘å‘é€ç»™æœåŠ¡å™¨çš„å­—ç¬¦ã€‚ **ä¸ºä½•æœ‰ä¸¤ä¸ªsrcï¼Ÿ** ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç¬¬ä¸€ä¸ª src æ˜¯å¯ä»¥å»æ‰çš„ï¼Œé™¤ééœ€è¦æ”¯æŒ IE9 ä¸‹çš„å…¼å®¹æ¨¡å¼ã€‚åœ¨ IE9 ä¸­å¯ä»¥ä½¿ç”¨ IE7 å’Œ IE8 çš„æ¨¡å¼æ¸²æŸ“é¡µé¢ï¼Œå¾®è½¯ä¿®æ”¹äº†åœ¨å…¼å®¹æ¨¡å¼ä¸‹çš„ CSS è§£æå™¨ï¼Œå¯¼è‡´ä½¿ç”¨ ? çš„æ–¹æ¡ˆå¤±æ•ˆã€‚ç”±äº CSS è§£é‡Šå™¨æ˜¯ä»ä¸‹å¾€ä¸Šè§£æçš„ï¼Œæ‰€ä»¥åœ¨ä¸Šé¢æ·»åŠ ä¸€ä¸ªä¸å¸¦é—®å·çš„ src å±æ€§ä¾¿å¯ä»¥è§£å†³æ­¤é—®é¢˜ã€‚ **å®šä¹‰å¥½è‡ªå·±çš„ font-face å**ï¼Œå°±æœ‰äº†æ–°çš„ IconFontï¼Œç»™è¦ä½¿ç”¨è¿™ä¸ª IconFont çš„å¯¹è±¡èµ‹äºˆå¯¹åº”çš„ font-family å³å¯ã€‚ .example &#123; font-family: &quot;defineName&quot;; content: &quot;/e103&quot;;&#125; å¤åˆ¶ä»£ç è¿™ä¸ªä¾‹å­å°±ä¼šå°† example é€‰ä¸­çš„å…ƒç´ æ¸²æŸ“ä¸º /e103 å¯¹åº”çš„ iconã€‚","updated":"2025-08-02T05:46:04.180Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"},{"name":"html","slug":"html","permalink":"https://luckyship.github.io/tags/html/"}]},{"title":"cssé€‰æ‹©å™¨å¤§å…¨","date":"2023-03-17T05:45:44.000Z","path":"2023/03/17/2023-03-17-css-selector/","text":"CSS é€‰æ‹©å™¨åœ¨ CSS ä¸­ï¼Œé€‰æ‹©å™¨æ˜¯é€‰å–éœ€è®¾ç½®æ ·å¼çš„å…ƒç´ çš„æ¨¡å¼ã€‚ ä¸‹é¢åˆ—ä¸¾äº†æ‰€æœ‰å¸¸è§çš„cssé€‰æ‹©å™¨ é€‰æ‹©å™¨ ä¾‹å­ ä¾‹å­æè¿° .class .intro é€‰æ‹© class=â€introâ€ çš„æ‰€æœ‰å…ƒç´ ã€‚ .class1.class2 .name1.name2 é€‰æ‹© class å±æ€§ä¸­åŒæ—¶æœ‰ name1 å’Œ name2 çš„æ‰€æœ‰å…ƒç´ ã€‚ .class1 .class2 .name1 .name2 é€‰æ‹©ä½œä¸ºç±»å name1 å…ƒç´ åä»£çš„æ‰€æœ‰ç±»å name2 å…ƒç´ ã€‚ #id #firstname é€‰æ‹© id=â€firstnameâ€ çš„å…ƒç´ ã€‚ * * é€‰æ‹©æ‰€æœ‰å…ƒç´ ã€‚ element p é€‰æ‹©æ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚ element.class p.intro é€‰æ‹© class=â€introâ€ çš„æ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚ element,element div, p é€‰æ‹©æ‰€æœ‰ &lt;div&gt; å…ƒç´ å’Œæ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚ element element div p é€‰æ‹© &lt;div&gt; å…ƒç´ å†…çš„æ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚ element&gt;element div &gt; p é€‰æ‹©çˆ¶å…ƒç´ æ˜¯ &lt;div&gt; çš„æ‰€æœ‰ &lt;p&gt; å…ƒç´ ã€‚ element+element div + p é€‰æ‹©ç´§è·Ÿ &lt;div&gt; å…ƒç´ çš„é¦–ä¸ª &lt;p&gt; å…ƒç´ ã€‚ element1~element2 p ~ ul é€‰æ‹©å‰é¢æœ‰ &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;ul&gt; å…ƒç´ ã€‚ [attribute] [target] é€‰æ‹©å¸¦æœ‰ target å±æ€§çš„æ‰€æœ‰å…ƒç´ ã€‚ [attribute=value] [target=_blank] é€‰æ‹©å¸¦æœ‰ target=â€_blankâ€ å±æ€§çš„æ‰€æœ‰å…ƒç´ ã€‚ [_attribute_~=value] [title~=flower] é€‰æ‹© title å±æ€§åŒ…å«å•è¯ â€œflowerâ€ çš„æ‰€æœ‰å…ƒç´ ã€‚ [attribute|=value] [lang|=en] é€‰æ‹© lang å±æ€§å€¼ä»¥ â€œenâ€ å¼€å¤´çš„æ‰€æœ‰å…ƒç´ ã€‚ [attribute_^=_value] a[href^=â€httpsâ€] é€‰æ‹©å…¶ src å±æ€§å€¼ä»¥ â€œhttpsâ€ å¼€å¤´çš„æ¯ä¸ª &lt;a&gt; å…ƒç´ ã€‚ [attribute$=value] a[href$=â€.pdfâ€] é€‰æ‹©å…¶ src å±æ€§ä»¥ â€œ.pdfâ€ ç»“å°¾çš„æ‰€æœ‰ &lt;a&gt; å…ƒç´ ã€‚ [attribute_*=_value] a[href*=â€w3schoolâ€] é€‰æ‹©å…¶ href å±æ€§å€¼ä¸­åŒ…å« â€œabcâ€ å­ä¸²çš„æ¯ä¸ª &lt;a&gt; å…ƒç´ ã€‚ :active a:active é€‰æ‹©æ´»åŠ¨é“¾æ¥ã€‚ ::after p::after åœ¨æ¯ä¸ª &lt;p&gt; çš„å†…å®¹ä¹‹åæ’å…¥å†…å®¹ã€‚ ::before p::before åœ¨æ¯ä¸ª &lt;p&gt; çš„å†…å®¹ä¹‹å‰æ’å…¥å†…å®¹ã€‚ :checked input:checked é€‰æ‹©æ¯ä¸ªè¢«é€‰ä¸­çš„ &lt;input&gt; å…ƒç´ ã€‚ :default input:default é€‰æ‹©é»˜è®¤çš„ &lt;input&gt; å…ƒç´ ã€‚ :disabled input:disabled é€‰æ‹©æ¯ä¸ªè¢«ç¦ç”¨çš„ &lt;input&gt; å…ƒç´ ã€‚ :empty p:empty é€‰æ‹©æ²¡æœ‰å­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ï¼ˆåŒ…æ‹¬æ–‡æœ¬èŠ‚ç‚¹ï¼‰ã€‚ :enabled input:enabled é€‰æ‹©æ¯ä¸ªå¯ç”¨çš„ &lt;input&gt; å…ƒç´ ã€‚ :first-child p:first-child é€‰æ‹©å±äºçˆ¶å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚ ::first-letter p::first-letter é€‰æ‹©æ¯ä¸ª &lt;p&gt; å…ƒç´ çš„é¦–å­—æ¯ã€‚ ::first-line p::first-line é€‰æ‹©æ¯ä¸ª &lt;p&gt; å…ƒç´ çš„é¦–è¡Œã€‚ :first-of-type p:first-of-type é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„é¦–ä¸ª &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚ :focus input:focus é€‰æ‹©è·å¾—ç„¦ç‚¹çš„ input å…ƒç´ ã€‚ :fullscreen :fullscreen é€‰æ‹©å¤„äºå…¨å±æ¨¡å¼çš„å…ƒç´ ã€‚ :hover a:hover é€‰æ‹©é¼ æ ‡æŒ‡é’ˆä½äºå…¶ä¸Šçš„é“¾æ¥ã€‚ :in-range input:in-range é€‰æ‹©å…¶å€¼åœ¨æŒ‡å®šèŒƒå›´å†…çš„ input å…ƒç´ ã€‚ :indeterminate input:indeterminate é€‰æ‹©å¤„äºä¸ç¡®å®šçŠ¶æ€çš„ input å…ƒç´ ã€‚ :invalid input:invalid é€‰æ‹©å…·æœ‰æ— æ•ˆå€¼çš„æ‰€æœ‰ input å…ƒç´ ã€‚ :lang(language) p:lang(it) é€‰æ‹© lang å±æ€§ç­‰äº â€œitâ€ï¼ˆæ„å¤§åˆ©ï¼‰çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚ :last-child p:last-child é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ æœ€åä¸€ä¸ªå­å…ƒç´ æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚ :last-of-type p:last-of-type é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„æœ€å &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚ :link a:link é€‰æ‹©æ‰€æœ‰æœªè®¿é—®è¿‡çš„é“¾æ¥ã€‚ :not(selector) :not(p) é€‰æ‹©é &lt;p&gt; å…ƒç´ çš„æ¯ä¸ªå…ƒç´ ã€‚ :nth-child(n) p:nth-child(2) é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„ç¬¬äºŒä¸ªå­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚ :nth-last-child(n) p:nth-last-child(2) åŒä¸Šï¼Œä»æœ€åä¸€ä¸ªå­å…ƒç´ å¼€å§‹è®¡æ•°ã€‚ :nth-of-type(n) p:nth-of-type(2) é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ ç¬¬äºŒä¸ª &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚ :nth-last-of-type(n) p:nth-last-of-type(2) åŒä¸Šï¼Œä½†æ˜¯ä»æœ€åä¸€ä¸ªå­å…ƒç´ å¼€å§‹è®¡æ•°ã€‚ :only-of-type p:only-of-type é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ å”¯ä¸€çš„ &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚ :only-child p:only-child é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„å”¯ä¸€å­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚ :optional input:optional é€‰æ‹©ä¸å¸¦ â€œrequiredâ€ å±æ€§çš„ input å…ƒç´ ã€‚ :out-of-range input:out-of-range é€‰æ‹©å€¼è¶…å‡ºæŒ‡å®šèŒƒå›´çš„ input å…ƒç´ ã€‚ ::placeholder input::placeholder é€‰æ‹©å·²è§„å®š â€œplaceholderâ€ å±æ€§çš„ input å…ƒç´ ã€‚ :read-only input:read-only é€‰æ‹©å·²è§„å®š â€œreadonlyâ€ å±æ€§çš„ input å…ƒç´ ã€‚ :read-write input:read-write é€‰æ‹©æœªè§„å®š â€œreadonlyâ€ å±æ€§çš„ input å…ƒç´ ã€‚ :required input:required é€‰æ‹©å·²è§„å®š â€œrequiredâ€ å±æ€§çš„ input å…ƒç´ ã€‚ :root :root é€‰æ‹©æ–‡æ¡£çš„æ ¹å…ƒç´ ã€‚ ::selection ::selection é€‰æ‹©ç”¨æˆ·å·²é€‰å–çš„å…ƒç´ éƒ¨åˆ†ã€‚ :target #news:target é€‰æ‹©å½“å‰æ´»åŠ¨çš„ #news å…ƒç´ ã€‚ :valid input:valid é€‰æ‹©å¸¦æœ‰æœ‰æ•ˆå€¼çš„æ‰€æœ‰ input å…ƒç´ ã€‚ :visited a:visited é€‰æ‹©æ‰€æœ‰å·²è®¿é—®çš„é“¾æ¥ã€‚","updated":"2025-08-02T05:46:04.180Z","tags":[{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"}]},{"title":"angularä¾èµ–æ³¨å…¥","date":"2023-03-14T07:14:06.000Z","path":"2023/03/14/2023-03-14-angular-service-inject/","text":"æ˜é‡‘ä¸Šçœ‹åˆ°ä¸€ç¯‡è®² angular ä¾èµ–æ³¨å…¥ çš„æ–‡ç« ï¼Œéå¸¸çš„ç»†è‡´ï¼Œè®°å½•ä¸€ä¸‹ ä¾èµ–æ³¨å…¥æ˜¯å‰ç«¯å¼€å‘è€…ä¹Ÿæ˜¯ Angular å¼€å‘è€…ä¸€é“å¾ˆéš¾è¿ˆè¿‡å»çš„åï¼Œä¾èµ–æ³¨å…¥åˆ°åº•æ˜¯å•¥ï¼Ÿä¸ºä»€ä¹ˆè¦ä¾èµ–æ³¨å…¥ï¼ŸAngular çš„ä¾èµ–æ³¨å…¥æ€ä¹ˆæœ‰é‚£ä¹ˆå¤šæ¦‚å¿µï¼Œçœ‹äº†å®˜æ–¹æ–‡æ¡£ä¸€éåæ„Ÿè§‰æ˜¯æ‡‚äº†ï¼Œä½†æ˜¯è¿‡ä¸€æ®µæ—¶é—´å‘ç°åˆä¸æ‡‚äº†ï¼Œè¿™æ˜¯å‰ç«¯å¼€å‘è€…æ™®éé‡åˆ°çš„é—®é¢˜ï¼Œæˆ‘å¸çš„å‰ç«¯ä¹Ÿä¸€æ ·ï¼Œé‚£ä¹ˆè¿™ç¯‡æ–‡ç« å°è¯•ç”¨æ›´å®¹æ˜“ç†è§£çš„è¯­è¨€å…¨é¢è§£æä¸€ä¸‹ Angular çš„ä¾èµ–æ³¨å…¥ï¼Œå†…å®¹æœ‰ç‚¹å¤šï¼Œå¯ä»¥å…ˆæ”¶è—è§‚çœ‹ã€‚ Angular å®˜æ–¹æ–‡æ¡£å…³äºä¾èµ–æ³¨å…¥ä»‹ç»çš„å…¶å®æŒºè¯¦ç»†çš„ï¼Œä½†æ˜¯ç»„ç»‡çš„è¯­è¨€è¿‡äºå®˜æ–¹ï¼Œä¸æ˜“ç†è§£ï¼Œå…¶æ¬¡å°±æ˜¯æ–‡æ¡£å¤ªè¿‡åˆ†æ•£ï¼Œæ²¡æœ‰æŠŠä¾èµ–æ³¨å…¥èšåˆåœ¨ä¸€èµ·ï¼Œæœ‰äº›æ ¸å¿ƒçš„æ¦‚å¿µå¯èƒ½åœ¨ç¤ºä¾‹ä¸­å‡ºç°äº†è§£è¯»ï¼Œä½ å¾ˆéš¾åœ¨ä¸€ä¸ªåœ°æ–¹æ‰¾åˆ°æ‰€æœ‰ä¾èµ–æ³¨å…¥çš„è®²è§£ã€‚åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ç®€å•åˆ—äº†ä¸€äº›å…³äº Angular ä¾èµ–æ³¨å…¥çš„é—®é¢˜ï¼Œå¦‚æœä½ æ¯ä¸ªé—®é¢˜éƒ½éå¸¸äº†è§£å¯ä»¥åˆ’è¿‡è¿™ç¯‡æ–‡ç« äº†ã€‚ ä¾èµ–æ³¨å…¥å’Œæ§åˆ¶åè½¬(Ioc)çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ providedIn: &#39;root&#39; â€‹ çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼ŒæŒ‡å®š root çš„å¥½å¤„æœ‰å“ªäº›ï¼Ÿ providedIn â€‹ é™¤äº† root å¤–è¿˜å¯ä»¥è®¾ç½®å“ªäº›å€¼ï¼Ÿ æ„é€ å‡½æ•°æ³¨å…¥ constructor(heroService: HeroService) â€‹ æ˜¯ä¾èµ–æ³¨å…¥çš„ç®€å†™ï¼Œé‚£ä¹ˆå®Œæ•´çš„å†™æ³•æ˜¯ä»€ä¹ˆï¼Ÿ ä¾èµ–æ³¨å…¥å¯ä»¥æ³¨å…¥ä¸€ä¸ªæ¥å£å—ï¼Ÿ constructor(heroService: IHeroService) â€‹ ä¸ºä»€ä¹ˆï¼Ÿ useClass â€‹ å’Œ useExisting â€‹ æä¾›è€…çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ providers: [ Logger ] â€‹ è¿™ç§å†™æ³• Logger â€‹ ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆç±»å‹çš„ä¾›åº”å•†ï¼Ÿ DI Token å¯ä»¥æ˜¯å­—ç¬¦ä¸²å—ï¼Ÿå¦‚æœå¯ä»¥å¦‚ä½•æ³¨å…¥ï¼Ÿ providers â€‹ ä¸ viewProviders â€‹ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ Injectable ã€ Inject â€‹ ã€ Injector â€‹ å’Œ Provider â€‹ è¿™äº›åè¯åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ ReflectiveInjector â€‹ å’Œ StaticInjector â€‹ çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆ Angular åœ¨ V5 ç‰ˆæœ¬åºŸå¼ƒäº† ReflectiveInjector â€‹APIï¼Ÿ æ‡’åŠ è½½æ¨¡å—ä¸­çš„ä¾›åº”å•†å’Œ AppModule â€‹ ä¸­æä¾›çš„ä¾›åº”å•†æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ ç®€å•ä¸€å¼ æ€ç»´å¯¼å›¾å®Œæ•´è¦†ç›–è¿™ç¯‡æ–‡ç« çš„å†…å®¹ï¼š å‰è¨€æ§åˆ¶åè½¬å’Œä¾èµ–æ³¨å…¥é‚£ä¹ˆåœ¨å¼€å§‹æ­£é¢˜ä¹‹å‰ï¼Œè‚¯å®šè¦å…ˆç†è§£ä¾èµ–æ³¨å…¥çš„æ¦‚å¿µï¼Œå¦‚æœå·²ç»ç†è§£çš„åŒå­¦å¯ä»¥å¿½ç•¥è¿™ä¸€ç« èŠ‚ï¼Œä¸€æèµ·ä¾èµ–æ³¨å…¥ï¼Œå¤§å®¶å°±ä¼šå’Œæ§åˆ¶åè½¬è”ç³»åœ¨ä¸€èµ·ï¼Œæˆ‘åœ¨çœ‹è¿‡å¾ˆå¤šæ–‡ç« ä¹‹åå‘ç°çŸ¥ä¹ä¸Šçš„ä¸€ä¸ªå›ç­” Spring IoC æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ ä»‹ç»çš„ç‰¹åˆ«è¯¦ç»†å’Œæ˜“æ‡‚ï¼Œå¤§å®¶ä¸äº†è§£çš„å¯ä»¥é˜…è¯»ä¸€ä¸‹ï¼Œç®€å•æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼š è½¯ä»¶åªæœ‰åˆ°è¾¾äº†ä¸€å®šçš„å¤æ‚åº¦æ‰ä¼šéœ€è¦å„ç§è®¾è®¡åŸåˆ™å’Œæ¨¡å¼ï¼Œé‚£ä¹ˆä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependency Inversion Principle ï¼‰å°±æ˜¯ä¸ºäº†è§£å†³è½¯ä»¶æ¨¡å—ä¹‹é—´çš„è€¦åˆæ€§æå‡ºçš„ä¸€ç§æ€æƒ³ï¼Œè®©å¤§å‹è½¯ä»¶å˜çš„å¯ç»´æŠ¤ï¼Œé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ï¼ŒæŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚é‚£ä¹ˆæ§åˆ¶åè½¬ï¼ˆInversion of Controlï¼‰ å°±æ˜¯ä¾èµ–å€’ç½®åŸåˆ™çš„ä¸€ç§ä»£ç è®¾è®¡æ€è·¯ï¼Œå…·ä½“é‡‡ç”¨çš„æ–¹æ³•å°±æ˜¯æ‰€è°“çš„ä¾èµ–æ³¨å…¥ï¼ˆDependency Injectionï¼‰ï¼Œé€šè¿‡ä¾èµ–æ³¨å…¥å®ç°æ§åˆ¶æƒçš„åè½¬ï¼Œé™¤äº†ä¾èµ–æ³¨å…¥å¤–ï¼Œè¿˜æœ‰å¯ä»¥é€šè¿‡æ¨¡æ¿æ–¹æ³•æ¨¡å¼å®ç°æ§åˆ¶åè½¬ï¼Œé‚£ä¹ˆæ‰€è°“ä¾èµ–æ³¨å…¥ï¼Œå°±æ˜¯æŠŠåº•å±‚ç±»ä½œä¸ºå‚æ•°ä¼ å…¥ä¸Šå±‚ç±»ï¼Œå®ç°ä¸Šå±‚ç±»å¯¹ä¸‹å±‚ç±»çš„â€œæ§åˆ¶â€ã€‚ ä»¥ä¸‹æ˜¯ä¸€ä¸ªé€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥çš„ç¤ºä¾‹ï¼Œé‚£ä¹ˆé™¤äº†æ„é€ å‡½æ•°æ³¨å…¥å¤–ï¼Œè¿˜ä¼šæœ‰ setter æ³¨å…¥å’Œæ¥å£æ³¨å…¥ã€‚ class Logger &#123; log(message: string) &#123;&#125;&#125;class HeroesService &#123; constructor(logger: Logger) &#123;&#125;&#125;const logger = new Logger();const heroesService = new HeroesService(logger); é€šè¿‡ä¸Šè¿°ç¤ºä¾‹å‘ç°ï¼Œ HeroesService â€‹ ä¸ç›´æ¥åˆ›å»º Logger â€‹ ç±»çš„å®ä¾‹ï¼Œç»Ÿä¸€åœ¨å¤–å±‚åˆ›å»ºåé€šè¿‡æ„é€ å‡½æ•°å¥½ä¼ å…¥ HeroesService â€‹ å¦‚æœæˆ‘ä»¬çš„ç±»æˆåƒä¸Šä¸‡ï¼Œé‚£ä¹ˆå®ä¾‹åŒ–ç±»çš„å·¥ä½œå˜å¾—ç›¸å½“ç¹çï¼Œä¼šæœ‰ä¸€å¤§æ¨æ ·æ¿ä»£ç ï¼Œä¸ºäº†ç®¡ç†åˆ›å»ºä¾èµ–å·¥ä½œï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ **æ§åˆ¶åè½¬å®¹å™¨(IoC Container) ** è¿›è¡Œç®¡ç†ã€‚åªéœ€è¦é€šè¿‡å¦‚ä¸‹ä¸€è¡Œä»£ç å³å¯å®ç° HeroesService â€‹ çš„åˆ›å»ºï¼Œ IocContainer â€‹ ä¼šé€šè¿‡ HeroesService â€‹ çš„æ„é€ å‡½æ•°å¯»æ‰¾ Logger â€‹ çš„ä¾èµ–å¹¶å®ä¾‹åŒ–ã€‚ const heroesService = IocContainer.get(HeroesService); å¦‚æœç±»å¾ˆå¤šï¼Œä¾èµ–å±‚çº§æ¯”è¾ƒæ·±ï¼Œé‚£ä¹ˆ IocContainer ä¼šå¸®æˆ‘ä»¬ç»Ÿä¸€ç®¡ç†ä¾èµ–ï¼Œ IocContainer â€‹ å…¶å®ä¹Ÿå«æ³¨å…¥å™¨ Injector â€‹, è¯´çš„å…¶å®å°±æ˜¯ä¸€å›äº‹ï¼ŒAngular æ¡†æ¶ä¸­å« Injector â€‹ã€‚å…³äºæ§åˆ¶åè½¬å’Œä¾èµ–æ³¨å…¥æ›´å¤šå‚è€ƒï¼šInversion of Control vs Dependency InjectionWikipedia Dependency Injection ä¾èµ–æ³¨å…¥çš„ä¼˜åŠ¿ï¼š æ›´å®¹æ˜“ç»´æŠ¤ ååŒåˆä½œ æ–¹ä¾¿å•å…ƒæµ‹è¯• æ¾è€¦åˆ å‡å°‘äº†æ ·æ¿ä»£ï¼ˆIoc å®¹å™¨/æ³¨å…¥å™¨ç»´æŠ¤ç®¡ç†ä¾èµ–ï¼‰ æ‰©å±•åº”ç”¨ç¨‹åºå˜å¾—æ›´åŠ å®¹æ˜“ ä¾èµ–æ³¨å…¥çš„ç¼ºç‚¹ï¼š å­¦ä¹ èµ·æ¥æœ‰ç‚¹å¤æ‚ é˜…è¯»ä»£ç å˜å¾—æŠ½è±¡ ä¾èµ–æ³¨å…¥æ¡†æ¶æ˜¯é€šè¿‡åå°„æˆ–åŠ¨æ€ç¼–ç¨‹å®ç°ï¼Œå¯¼è‡´ IDE å¯¹â€œæŸ¥æ‰¾å¼•ç”¨â€ï¼Œâ€œæ˜¾ç¤ºè°ƒç”¨å±‚æ¬¡ç»“æ„â€å’Œå®‰å…¨é‡æ„å˜å¾—å›°éš¾ ç¼–è¯‘æ—¶é”™è¯¯è¢«æ¨é€åˆ°è¿è¡Œæ—¶ ä¸ºä»€ä¹ˆ Angular æœ‰ä¾èµ–æ³¨å…¥é‚£ä¹ˆ Angular ä¸ºä»€ä¹ˆä¼šæœ‰ä¾èµ–æ³¨å…¥ï¼Ÿå‰é¢æˆ‘å·²ç»è¯´è¿‡ï¼Œåªæœ‰ç¨‹åºåˆ°è¾¾ä¸€å®šçš„å¤æ‚åº¦ï¼Œæ‰ä¼šéœ€è¦å„ç§è®¾è®¡æ¨¡å¼å’ŒåŸåˆ™ç­‰å·¥ç¨‹åŒ–æ–¹æ³•æå‡ç¨‹åºçš„å¯ç»´æŠ¤æ€§ï¼Œé‚£ä¹ˆ Angular.js èµ·åˆæ˜¯ä¸ºäº†è§£å†³è°·æ­Œå†…éƒ¨å¤æ‚ä¸­å¤§å‹çš„å‰ç«¯åº”ç”¨ï¼ŒåŒæ—¶æ˜¯ä¸€æ‰¹ Java ç¨‹åºæ‰“é€ çš„ï¼Œæ‰€ä»¥é¦–æ¬¡åœ¨å‰ç«¯ä¸­å¤§èƒ†å¼•å…¥äº†ä¾èµ–æ³¨å…¥ï¼Œé‚£ä¹ˆ Angular æ˜¯åŸºäº Angular.js æ‰“é€ çš„æ–°ä¸€ä»£å‰ç«¯æ¡†æ¶ï¼Œæ‰€ä»¥å»¶ç»­äº†ä¾èµ–æ³¨å…¥ç‰¹æ€§ï¼Œå¹¶æ”¹å–„äº†å±‚çº§æ³¨å…¥å™¨ï¼ŒåŒæ—¶é‡‡ç”¨äº†æ›´ä¼˜é›…çš„è£…é¥°å™¨ API å½¢å¼ã€‚ æœåŠ¡å’Œä¾èµ–æ³¨å…¥çš„å…³ç³»å¦å¤– Angular ä¸ºäº†è§£å†³æ•°æ®å…±äº«å’Œé€»è¾‘å¤ç”¨é—®é¢˜ï¼Œå¼•å…¥äº†æœåŠ¡çš„æ¦‚å¿µï¼ŒæœåŠ¡ç®€å•ç†è§£å°±æ˜¯ä¸€ä¸ªå¸¦æœ‰ç‰¹æ€§åŠŸèƒ½çš„ç±»ï¼ŒAngular æå€¡æŠŠä¸è§†å›¾æ— å…³çš„é€»è¾‘æŠ½å–åˆ°æœåŠ¡ä¸­ï¼Œè¿™æ ·å¯ä»¥è®©ç»„ä»¶ç±»æ›´åŠ ç²¾ç®€ã€é«˜æ•ˆï¼Œç»„ä»¶çš„å·¥ä½œåªç®¡ç”¨æˆ·ä½“éªŒï¼ŒæŠŠä¸šåŠ¡é€»è¾‘ç›¸å…³åŠŸèƒ½ï¼ˆæ¯”å¦‚ï¼šä»æœåŠ¡å™¨è·å–æ•°æ®ï¼ŒéªŒè¯ç”¨æˆ·è¾“å…¥æˆ–ç›´æ¥å¾€æ§åˆ¶å°ä¸­å†™æ—¥å¿—ç­‰ï¼‰å§”æ‰˜ç»™å„ç§æœåŠ¡ï¼Œæœ€åé€šè¿‡ Angular çš„ä¾èµ–æ³¨å…¥ï¼Œè¿™äº›å¸¦æœ‰ç‰¹å®šåŠŸèƒ½çš„æœåŠ¡ç±»å¯ä»¥è¢«ä»»ä½•ç»„ä»¶æ³¨å…¥å¹¶ä½¿ç”¨ã€‚Angular ä¾èµ–æ³¨å…¥ï¼š è¿æ¥æœåŠ¡çš„æ¡¥æ¢ï¼Œåœ¨éœ€è¦çš„åœ°æ–¹ï¼ˆç»„ä»¶/æŒ‡ä»¤/å…¶ä»–æœåŠ¡ï¼‰é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ä¾èµ–çš„æœåŠ¡ï¼Œä¾èµ–æ³¨å…¥ + æœåŠ¡çš„ç»„åˆé€ å°±äº†ä½¿ç”¨ Angular å¯ä»¥è½»æ¾ç»„ç»‡å¤æ‚åº”ç”¨ã€‚ é‚£ä¹ˆå…¶ä»–æ¡†æ¶ React å’Œ Vue æœ‰ä¾èµ–æ³¨å…¥å—ï¼Ÿå¯ä»¥è¯´æœ‰ï¼Œä¹Ÿå¯ä»¥è¯´æ²¡æœ‰ï¼ŒReact ä¸ºäº†è§£å†³å…¨å±€æ•°æ®çš„å…±äº«é—®é¢˜ï¼Œæå‡ºäº† Contextï¼Œé‚£ä¹ˆåˆ›å»ºå¥½ Context åéœ€è¦åœ¨ä¸Šå±‚ç»„ä»¶é€šè¿‡ &lt;MyContext.Provider value=&#123;/* æŸä¸ªå€¼ */&#125;&gt; â€‹ æä¾›ä¾èµ–å€¼ï¼Œç„¶ååœ¨ä»»ä½•çš„å­ç»„ä»¶ä¸­é€šè¿‡ &lt;MyContext.Consumer&gt; â€‹ è¿›è¡Œæ¶ˆè´¹ï¼ˆVue ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„ provide â€‹ å’Œ inject â€‹ï¼‰ï¼Œå…¶å®è¿™å¯ä»¥ç‹­éš˜çš„ç†è§£æˆæœ€ç®€å•çš„ä¾èµ–æ³¨å…¥ï¼Œåªä¸è¿‡ Context åªè§£å†³äº†æ•°æ®å…±äº«çš„é—®é¢˜ï¼Œè™½ç„¶ä¹Ÿå¯ä»¥ä½œä¸ºé€»è¾‘å¤ç”¨ï¼Œä½†æ˜¯å®˜æ–¹ä¸æ¨èï¼ŒReact å®˜æ–¹å…ˆåæ¨å‡º Mixinã€é«˜é˜¶ç»„ä»¶ã€Render Props ä»¥åŠæœ€æ–°çš„ Hooks ç”¨æ¥è§£å†³é€»è¾‘å¤ç”¨é—®é¢˜ã€‚ &lt;MyContext.Consumer&gt; &#123;value =&gt; /* åŸºäº context å€¼è¿›è¡Œæ¸²æŸ“*/&#125;&lt;/MyContext.Consumer&gt; é‚£ä¹ˆå›åˆ° Angular æ¡†æ¶æ¥è¯´ï¼ŒAngular çš„æœåŠ¡ + ä¾èµ–æ³¨å…¥å®Œç¾è§£å†³äº†æ•°æ®å…±äº«å’Œé€»è¾‘å¤ç”¨é—®é¢˜ï¼ŒæœåŠ¡æœ¬è´¨ä¸Šå’Œ React Hooks æ²¡æœ‰å¤ªå¤šçš„åŒºåˆ«ï¼Œåªæ˜¯ API å½¢æ€ä¸ä¸€æ ·ï¼Œä¸€ä¸ªæ˜¯é€šè¿‡å‡½æ•°å½¢å¼ä¸€ä¸ªæ˜¯é€šè¿‡ç±»+ä¾èµ–æ³¨å…¥ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªæ¡†æ¶çš„åº•å±‚æœºåˆ¶å’Œæ€æƒ³ä¸ä¸€æ ·ï¼Œå¯¼è‡´äº† API è¡¨ç°å½¢å¼çš„ä¸åŒï¼Œä½†æ˜¯æœ€ç»ˆéƒ½æ˜¯åœ¨è§£å†³æ•°æ®å…±äº«å’Œé€»è¾‘å¤ç”¨çš„é—®é¢˜ã€‚ å…¥é—¨åˆ°é«˜çº§é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä¼šä»ä¾èµ–æ³¨å…¥çš„åŸºæœ¬ä½¿ç”¨ =&gt; ä¾èµ–æä¾›è€… =&gt; å¤šçº§æ³¨å…¥å™¨ä¸‰ä¸ªæ–¹é¢è¯¦ç»†è®²è§£ä¸€ä¸‹ã€‚ åŸºæœ¬ä½¿ç”¨åœ¨ Angular ä¸­ï¼Œé€šè¿‡ @angular/cli â€‹ æä¾›çš„å‘½ä»¤ ng generate service heroes/hero (ç®€å†™ ng g s heroes/hero â€‹ ) å¯ä»¥å¿«é€Ÿçš„åˆ›å»ºä¸€ä¸ªæœåŠ¡ï¼Œåˆ›å»ºåçš„æœåŠ¡ä»£ç å¦‚ä¸‹ï¼š // src/app/heroes/hero.service.tsimport &#123; Injectable &#125; from &quot;@angular/core&quot;;@Injectable(&#123; providedIn: &quot;root&quot;,&#125;)export class HeroService &#123; constructor() &#123;&#125;&#125; HeroService é€šè¿‡ @Injectable() â€‹ è£…é¥°å™¨æ ‡è®°ä¸ºå¯ä»¥è¢«æ³¨å…¥çš„æœåŠ¡ï¼Œ providedIn: &#39;root&#39; â€‹ è¡¨ç¤ºå½“å‰æœåŠ¡åœ¨ Root æ³¨å…¥å™¨ä¸­æä¾›ï¼Œç®€å•ç†è§£å°±æ˜¯è¿™ä¸ªæœåŠ¡åœ¨æ•´ä¸ªåº”ç”¨æ‰€æœ‰åœ°æ–¹éƒ½å¯ä»¥æ³¨å…¥ï¼Œå¹¶å…¨å±€å”¯ä¸€å®ä¾‹ã€‚æ·»åŠ å®ŒæœåŠ¡åï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä»»ä½•ç»„ä»¶ä¸­é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥ HeroServiceï¼Œ é€šè¿‡ TS çš„æ„é€ å‡½æ•°èµ‹å€¼å±æ€§çš„ç‰¹æ€§è®¾ç½®ä¸ºå…¬å¼€ï¼Œè¿™æ ·ç»„ä»¶å†…å’Œæ¨¡æ¿ä¸­éƒ½å¯ä»¥ä½¿ç”¨è¯¥æœåŠ¡ç«¯çš„å‡½æ•°å’Œæ–¹æ³•ã€‚ // src/app/heroes/hero-list.componentconstructor(public heroService: HeroService) ç®€å•çš„ä»£ç å¦‚ä¸‹ï¼š import &#123; Hero &#125; from &quot;../hero&quot;;import &#123; HeroService &#125; from &quot;../hero.service&quot;;@Component(&#123; selector: &quot;app-hero-list&quot;, template: &quot;Heroes: &#123;&#123;heroes | json&#125;&#125;&quot;,&#125;)export class HeroListComponent implements OnInit &#123; heroes!: Hero[]; constructor(public heroService: HeroService) &#123;&#125; ngOnInit(): void &#123; this.heroes = this.heroService.getHeroes(); &#125;&#125; é™¤äº†åœ¨ç»„ä»¶ä¸­æ³¨å…¥æœåŠ¡å¤–ï¼Œåœ¨ Angular ä¸­è¿˜å¯ä»¥åœ¨æœåŠ¡ä¸­æ³¨å…¥å…¶ä»–æœåŠ¡ï¼Œå½“æŸä¸ªæœåŠ¡ä¾èµ–äºå¦ä¸€ä¸ªæœåŠ¡æ—¶ï¼Œéµå¾ªä¸æ³¨å…¥ç»„ä»¶ç›¸åŒçš„æ¨¡å¼ï¼Œæ¯”å¦‚ï¼š HeroService â€‹ è¦ä¾é  Logger â€‹ æœåŠ¡æ¥è®°å½•æ—¥å¿—ã€‚ // src/app/heroes/hero.service.tsimport &#123; Injectable &#125; from &quot;@angular/core&quot;;import &#123; HEROES &#125; from &quot;./mock-heroes&quot;;import &#123; Logger &#125; from &quot;../logger.service&quot;;@Injectable(&#123; providedIn: &quot;root&quot;,&#125;)export class HeroService &#123; constructor(private logger: Logger) &#123;&#125; getHeroes() &#123; this.logger.log(&quot;Getting heroes ...&quot;); return HEROES; &#125;&#125; ä»¥ä¸Šå°±æ˜¯åœ¨ Angular ä¸­æœ€ç®€å•çš„ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„å§¿åŠ¿ï¼Œæ˜¯ä¸æ˜¯è§‰å¾—å’Œ React çš„ Hooks ä¸€æ ·ï¼Œåªæ˜¯é€šè¿‡é¢å‘å¯¹è±¡çš„ API å…±äº«æ•°æ®å’Œä¸šåŠ¡é€»è¾‘ï¼Œä¸ªäººæ„Ÿè§‰æ›´åŠ çš„ç®€å•å’Œæ˜“è¯»ã€‚ Angular ä¾èµ–æ³¨å…¥ç®€ä»‹ä¸‹é¢ç®€å•çš„ä»‹ç»ä¸€ä¸‹ Angular ä¾èµ–æ³¨å…¥çš„å‡ ä¸ªåŸºæœ¬çš„å…ƒç´ ï¼š @Injectable() è£…é¥°å™¨æ¥æä¾›å…ƒæ•°æ®ï¼Œè¡¨ç¤ºä¸€ä¸ªæœåŠ¡å¯ä»¥è¢«æ³¨å…¥çš„ï¼ˆåœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ä¸åŠ ä¹Ÿæ˜¯å¯ä»¥è¢«æ³¨å…¥çš„ï¼Œåæ¥ 5.0 ç‰ˆæœ¬æ”¹æˆé™æ€æ³¨å…¥å™¨åå¿…é¡»è¦æ ‡è¯†ä¸€ä¸‹æ‰å¯ä»¥è¢«æ³¨å…¥ï¼Œå¦åˆ™ä¼šæŠ¥é”™ï¼‰ æ³¨å…¥å™¨ï¼ˆInjectorï¼‰ ä¼šåˆ›å»ºä¾èµ–ã€ç»´æŠ¤ä¸€ä¸ªå®¹å™¨æ¥ç®¡ç†è¿™äº›ä¾èµ–ï¼Œå¹¶å°½å¯èƒ½å¤ç”¨å®ƒä»¬ï¼ŒAngular é»˜è®¤ä¼šåˆ›å»ºå„ç§æ³¨å…¥å™¨ï¼Œç”šè‡³æ„Ÿè§‰ä¸åˆ°ä»–çš„å­˜åœ¨ï¼Œä½†æ˜¯ç†è§£æ³¨å…¥å™¨çš„åº•å±‚é€»è¾‘åå†çœ‹ä¾èµ–æ³¨å…¥å°±æ›´ç®€å•äº† @Inject() è£…é¥°å™¨è¡¨ç¤ºè¦åœ¨ç»„ä»¶æˆ–è€…æœåŠ¡ä¸­æ³¨å…¥ä¸€ä¸ªæœåŠ¡ æä¾›è€…ï¼ˆProviderï¼‰ æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å‘Šè¯‰æ³¨å…¥å™¨åº”è¯¥å¦‚ä½•è·å–æˆ–åˆ›å»ºä¾èµ–å€¼ã€‚ ä¸Šé¢çš„ç¤ºä¾‹ä¸­è™½ç„¶æ²¡æœ‰å‡ºç° @Inject() â€‹ è£…é¥°å™¨ï¼Œä½†æ˜¯è¿™æ˜¯ Angular æä¾›çš„ç®€å†™ï¼Œæ³¨å…¥ä¸€ä¸ªæœåŠ¡çš„å…¨å†™å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬é€šå¸¸å®šä¹‰æœåŠ¡éƒ½æ˜¯ä½¿ç”¨ç±»ï¼Œæ‰€ä»¥çœç•¥ @Inject(HeroService) â€‹ æå¤§çš„ç®€åŒ–äº†æ ·æ¿ä»£ç ã€‚ // src/app/heroes/hero-list.componentclass HeroListComponent &#123; constructor(@Inject(HeroService) private heroService: HeroService) &#123;&#125;&#125; ä¾èµ–æä¾›è€…ï¼ˆDependency providersï¼‰Angular å®˜æ–¹æ–‡æ¡£å¯¹äºä¾èµ–æä¾›è€…ï¼Œä¹Ÿå°±æ˜¯ providers â€‹ çš„è§£é‡Šå¦‚ä¸‹ï¼šè¯´å®è¯æˆ‘è¯»äº†å¾ˆå¤šééƒ½æ— æ³•ç†è§£å…·ä½“å«ä¹‰ï¼Œåæ¥æˆ‘ç®€å•æ€»ç»“ä¸ºä¾èµ–æä¾›è€…å°±åšäº†ä¸¤ä»¶äº‹ï¼š å‘Šè¯‰æ³¨å…¥å™¨å¦‚ä½•æä¾›ä¾èµ–å€¼ é™åˆ¶æœåŠ¡å¯ä½¿ç”¨çš„èŒƒå›´ åœ¨ä¸Šè¿°çš„ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨ @Inject(HeroService) â€‹ æ³¨å…¥ä¸€ä¸ªæœåŠ¡æ—¶ï¼ŒAngular æ³¨å…¥å™¨ä¼šé€šè¿‡ new HeroService() â€‹ å®ä¾‹åŒ–ä¸€ä¸ªç±»è¿”å›ä¾èµ–å€¼ï¼Œå®ä¾‹åŒ–ç±»å…¶å®å°±æ˜¯ å¦‚ä½•æä¾›ä¾èµ–å€¼ï¼Œ é‚£ä¹ˆ Angular ä¸­é™¤äº†å®ä¾‹åŒ–ç±»æä¾›ä¾èµ–å€¼å¤–è¿˜æä¾›ç»™äº†å¦‚ä¸‹ç±»å‹çš„ Provider â€‹ï¼Œæ¯ç§ Provider â€‹ éƒ½æœ‰å…¶ä½¿ç”¨åœºæ™¯ã€‚ export declare type Provider = | TypeProvider | ValueProvider | ClassProvider | ConstructorProvider | ExistingProvider | FactoryProvider | any[];export declare type StaticProvider = | ValueProvider | ExistingProvider | StaticClassProvider | ConstructorProvider | FactoryProvider | any[]; å…³äº é™åˆ¶æœåŠ¡å¯ä½¿ç”¨çš„èŒƒå›´ å°±æ›´å¥½ç†è§£äº† ï¼Œ æ»¡è¶³åªèƒ½åœ¨æŸä¸ªæ¨¡å—æˆ–è€…ç»„ä»¶ä¸­æ³¨å…¥ HeroService â€‹ çš„åœºæ™¯ã€‚ å¦‚ä½•å®šä¹‰æä¾›è€…åœ¨ç»„ä»¶æˆ–è€…æ¨¡å—ä¸­é€šè¿‡è£…é¥°å™¨å…ƒæ•°æ® providers å®šä¹‰æä¾›è€…ã€‚æ¯”å¦‚: ç±»æä¾›è€… provide å±æ€§æ˜¯ä¾èµ–ä»¤ç‰Œï¼Œå®ƒä½œä¸ºä¸€ä¸ª keyï¼Œåœ¨å®šä¹‰ä¾èµ–å€¼å’Œé…ç½®æ³¨å…¥å™¨æ—¶ä½¿ç”¨ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ª ç±»çš„ç±»å‹ ã€ InjectionToken ã€æˆ–è€…å­—ç¬¦ä¸²ï¼Œç”šè‡³å¯¹è±¡ï¼Œä½†æ˜¯ä¸èƒ½æ˜¯ä¸€ä¸ª Interfaceã€æ•°å­—å’Œå¸ƒå°”ç±»å‹ ç¬¬äºŒä¸ªå±æ€§æ˜¯ä¸€ä¸ªæä¾›è€…å®šä¹‰å¯¹è±¡ï¼Œå®ƒå‘Šè¯‰æ³¨å…¥å™¨è¦å¦‚ä½•åˆ›å»ºä¾èµ–å€¼ã€‚ æä¾›è€…å®šä¹‰å¯¹è±¡ä¸­çš„ key å¯ä»¥æ˜¯ useClass â€”â€” å°±åƒè¿™ä¸ªä¾‹å­ä¸­ä¸€æ ·ã€‚ ä¹Ÿå¯ä»¥æ˜¯ useExisting â€‹ ã€ useValue â€‹ æˆ– useFactory â€‹, æ¯ä¸€ä¸ª key éƒ½ç”¨äºæä¾›ä¸€ç§ä¸åŒç±»å‹çš„ä¾èµ–ã€‚ ç±»æä¾›è€…ï¼ˆTypeProvider å’Œ ClassProviderï¼‰ç±»æä¾›è€…åº”è¯¥æ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§ï¼Œæ–‡ç« å¼€å§‹ä¸­çš„ç¤ºä¾‹å°±æ˜¯ï¼Œç®€å†™å’Œå…¨å†™çš„é…ç½®å¦‚ä¸‹ï¼š provides: [Logger]; // ç®€å†™provides: [&#123; provide: Logger, useClass: Logger &#125;]; // å…¨å†™ provide: Logger æ„æ€æ˜¯æŠŠç±»çš„ç±»å‹ä½œä¸º DI Tokenï¼ˆä¾èµ–ä»¤ç‰Œï¼‰ useClass è¡¨ç¤ºä½¿ç”¨æ­¤ç±»å®ä¾‹åŒ–ä½œä¸ºä¾èµ–å€¼ï¼Œå…¶å®å°±æ˜¯é€šè¿‡ new Logger() â€‹ è¿”å›ä¾èµ–å€¼ ä½¿ç”¨åœºæ™¯ï¼š æ‰€æœ‰ class å®šä¹‰çš„æœåŠ¡é»˜è®¤éƒ½æ˜¯ç”¨ ç±»æä¾›è€… æŒ‡å®šæ›¿ä»£æ€§çš„ç±»æä¾›è€…ï¼Œæ›¿æ¢åŸæœ‰æœåŠ¡çš„è¡Œä¸ºå®ç°å¯æ‰©å±•æ€§ï¼Œè¿™æ ·æˆ‘åœ¨ä½¿ç”¨çš„æ—¶å€™è¿˜æ˜¯æ³¨å…¥ Logger â€‹ï¼Œä½†æ˜¯å®é™…è¿”å›çš„å¯¹è±¡æ˜¯ BetterLogger â€‹ ç¤ºä¾‹ [&#123; provide: Logger, useClass: BetterLogger &#125;];// å½“ä½¿ç”¨ Logger ä»¤ç‰Œè¯·æ±‚ Logger æ—¶ï¼Œè¿”å›ä¸€ä¸ª BetterLogger åˆ«åç±»æä¾›è€…ï¼ˆExistingProviderï¼‰åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå½“ç»„ä»¶è¯·æ±‚æ–°çš„æˆ–æ—§çš„ Logger æ—¶ï¼Œæ³¨å…¥å™¨éƒ½ä¼šæ³¨å…¥ä¸€ä¸ª NewLogger çš„å®ä¾‹ã€‚ é€šè¿‡è¿™ç§æ–¹å¼ï¼Œ OldLogger â€‹ å°±æˆäº† NewLogger â€‹ çš„åˆ«åã€‚ [ NewLogger, // Alias OldLogger reference to NewLogger &#123; provide: OldLogger, useExisting: NewLogger &#125;,]; é‚£ä¹ˆåˆ«åç±»æä¾›è€…å’Œç±»æä¾›è€…æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ [NewLogger, &#123; provide: OldLogger, useClass: NewLogger &#125;]; useExisting å€¼æ˜¯ä¸€ä¸ª DI Token ï¼Œprovide ä¹Ÿæ˜¯ä¸€ä¸ª DI Tokenï¼Œ 2 ä¸ª Token æŒ‡å‘åŒä¸€ä¸ªå®ä¾‹ useClass å€¼æ˜¯ä¸€ä¸ªå¯ä»¥å®ä¾‹åŒ–çš„ç±»ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ new å‡ºæ¥çš„ç±»ï¼Œè¿™ä¸ªç±»å¯ä»¥æ˜¯ä»»ä½•ç±» ä½¿ç”¨åœºæ™¯ï¼š æ”¶çª„ç±»å‹ MinimalLogger ï¼Œ Logger ç±»çš„è¿”å›çš„æ–¹æ³•å’Œå±æ€§å¤ªå¤šï¼Œå½“å‰åœºæ™¯åªéœ€è¦ä½¿ç”¨å°‘é‡çš„å±æ€§å’Œå‡½æ•°ï¼Œå¯ä»¥å®šä¹‰ä¸€ä¸ªç®€åŒ–ç‰ˆçš„ MinimalLoggerï¼Œ é€šè¿‡æ³¨å…¥ MinimalLogger â€‹ ä½¿ç”¨ï¼Œè¿è¡Œæ—¶è¿”å›çš„å…¶å®è¿˜æ˜¯ Logger å¯¹è±¡ é‡æ„ï¼Œæ›¿æ¢å‘½åï¼Œä¸€æ¬¡æ€§æ— æ³•å®Œå…¨ä¿®æ”¹ï¼Œå…ˆä¸´æ—¶æä¾›ä¸€ä¸ªæ–°çš„åˆ«åï¼Œå°†æ¥é€æ­¥æ›¿æ¢ è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œä¸ºç±»æ¥å£(æŠ½è±¡)æŒ‡å®šåˆ«å // Class used as a &quot;narrowing&quot; interface that exposes a minimal logger// Other members of the actual implementation are invisibleexport abstract class MinimalLogger &#123; abstract logs: string[]; abstract logInfo: (msg: string) =&gt; void;&#125;&#123; provide: MinimalLogger, useExisting: LoggerService &#125;, // parent.tsclass abstract Parent &#123; ...&#125;// alex.component.tsproviders: [&#123; provide: Parent, useExisting: forwardRef(() =&gt; AlexComponent) &#125;]class AlexComponent &#123; // ChildComponent&#125;// child.component.tsclass ChildComponent &#123; constructor(parent: Parent)&#125; å¯¹è±¡æä¾›è€…ï¼ˆValueProviderï¼‰è¦æ³¨å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ç”¨ useValue â€‹ é€‰é¡¹æ¥é…ç½®æ³¨å…¥å™¨ï¼Œä¸‹é¢çš„æä¾›è€…å®šä¹‰å¯¹è±¡ä½¿ç”¨ useValue â€‹ ä½œä¸º key æ¥æŠŠè¯¥å˜é‡ä¸ Logger â€‹ ä»¤ç‰Œå…³è”èµ·æ¥ã€‚ // An object in the shape of the logger servicefunction silentLoggerFn() &#123;&#125;export const silentLogger = &#123; logs: [&#x27;Silent logger says &quot;Shhhhh!&quot;. Provided via &quot;useValue&quot;&#x27;], log: silentLoggerFn,&#125;;[&#123; provide: Logger, useValue: silentLogger &#125;]; ä½¿ç”¨åœºæ™¯ï¼šé€šè¿‡å¯¹è±¡æä¾›è€…æ³¨å…¥ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œä¸€èˆ¬æ¨èä½¿ç”¨ InjectionToken â€‹ ä½œä¸ºä»¤ç‰Œ â€‹ // src/app/app.config.tsimport &#123; InjectionToken &#125; from &quot;@angular/core&quot;;export const APP_CONFIG = new InjectionToken&lt;AppConfig&gt;(&quot;app.config&quot;);export const HERO_DI_CONFIG: AppConfig = &#123; apiEndpoint: &quot;api.heroes.com&quot;, title: &quot;Dependency Injection&quot;,&#125;; // src/app/app.module.ts (providers)providers: [ &#123; provide: APP_CONFIG, useValue: HERO_DI_CONFIG &#125;], å½“ä½¿ç”¨ InjectionToken â€‹ ä½œä¸ºä»¤ç‰Œæ—¶ï¼Œåœ¨ç»„ä»¶æˆ–è€…æœåŠ¡ä¸­å¿…é¡»å€ŸåŠ©å‚æ•°è£…é¥°å™¨ @Inject() â€‹ ï¼Œæ‰å¯ä»¥æŠŠè¿™ä¸ªé…ç½®å¯¹è±¡æ³¨å…¥åˆ°æ„é€ å‡½æ•°ä¸­ã€‚ // src/app/app.component.tsconstructor(@Inject(APP_CONFIG) config: AppConfig) &#123; this.title = config.title;&#125; Inject, ç±»æ„é€ å‡½æ•°ä¸­ä¾èµ–é¡¹å‚æ•°ä¸Šçš„å‚æ•°è£…é¥°å™¨ï¼Œç”¨äºæŒ‡å®šä¾èµ–é¡¹çš„è‡ªå®šä¹‰æä¾›è€…ï¼Œå‚æ•°ä¼ å…¥ DI Tokenï¼Œæ˜ å°„åˆ°è¦æ³¨å…¥çš„ä¾èµ–é¡¹ã€‚åŒæ—¶åœ¨å®šä¹‰ InjectionToken â€‹ çš„æ—¶å€™è¿˜å¯ä»¥è®¾ç½® providedIn â€‹ å’Œ factory â€‹ export const TOKEN_FACTORY = new InjectionToken(&quot;factory-token&quot;, &#123; providedIn: &quot;root&quot;, factory: () =&gt; &#123; return &quot;I am from InjectionToken factory&quot;; &#125;,&#125;); å·¥å‚æä¾›è€…ï¼ˆFactoryProviderï¼‰è¦æƒ³æ ¹æ®è¿è¡Œå‰å°šä¸å¯ç”¨çš„ä¿¡æ¯åˆ›å»ºå¯å˜çš„ä¾èµ–å€¼ï¼Œå¯ä»¥ä½¿ç”¨å·¥å‚æä¾›è€…ã€‚ä¹Ÿå°±æ˜¯å®Œå…¨è‡ªå·±å†³å®šå¦‚ä½•åˆ›å»ºä¾èµ–ã€‚æ¯”å¦‚ï¼šåªæœ‰æˆæƒç”¨æˆ·æ‰èƒ½çœ‹åˆ° HeroService â€‹ ä¸­çš„ç§˜å¯†è‹±é›„ã€‚ // src/app/heroes/hero.service.ts (excerpt)constructor( private logger: Logger, private isAuthorized: boolean) &#123; &#125;getHeroes() &#123; const auth = this.isAuthorized ? &#x27;authorized &#x27; : &#x27;unauthorized&#x27;; this.logger.log(`Getting heroes for $&#123;auth&#125; user.`); return HEROES.filter(hero =&gt; this.isAuthorized || !hero.isSecret);&#125; // src/app/heroes/hero.service.provider.ts (excerpt)const heroServiceFactory = (logger: Logger, userService: UserService) =&gt; &#123; return new HeroService(logger, userService.user.isAuthorized);&#125;;export const heroServiceProvider = &#123; provide: HeroService, useFactory: heroServiceFactory, deps: [Logger, UserService],&#125;; useFactory â€‹ å­—æ®µæŒ‡å®šè¯¥æä¾›è€…æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œå…¶å®ç°ä»£ç æ˜¯ heroServiceFactory â€‹ deps â€‹ å±æ€§æ˜¯ä¸€ä¸ªæä¾›è€…ä»¤ç‰Œæ•°ç»„ï¼Œ Logger å’Œ UserService ç±»éƒ½æ˜¯ç±»æä¾›è€…çš„ä»¤ç‰Œã€‚è¯¥æ³¨å…¥å™¨è§£æäº†è¿™äº›ä»¤ç‰Œï¼Œå¹¶æŠŠç›¸åº”çš„æœåŠ¡æ³¨å…¥åˆ° heroServiceFactory â€‹ å·¥å‚å‡½æ•°çš„å‚æ•°ä¸­ ç†è§£äº†å·¥å‚æä¾›ç»™è€…åå†å›è¿‡å¤´çœ‹ï¼Œ useValue â€‹ ã€ useClass â€‹ å’Œ useExisting â€‹ çš„åŒºåˆ«å°±æ›´ç®€å•äº†ï¼Œ provider â€‹ å°±æ˜¯åœ¨è£…é¥°å™¨ä¸­é€šè¿‡ providers â€‹ æ•°ç»„é…ç½®çš„å…ƒæ•°æ®å¯¹è±¡ã€‚ æ¥å£å’Œä¾èµ–æ³¨å…¥è™½ç„¶ TypeScript çš„ AppConfig æ¥å£å¯ä»¥åœ¨ç±»ä¸­æä¾›ç±»å‹æ”¯æŒï¼Œä½†å®ƒåœ¨ä¾èµ–æ³¨å…¥æ—¶å´æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚åœ¨ TypeScript ä¸­ï¼Œæ¥å£åªèƒ½ä½œä¸ºç±»å‹æ£€æŸ¥ï¼Œå®ƒæ²¡æœ‰å¯ä¾› DI æ¡†æ¶ä½¿ç”¨çš„è¿è¡Œæ—¶è¡¨ç¤ºå½¢å¼æˆ–ä»¤ç‰Œã€‚ å½“è½¬è¯‘å™¨æŠŠ TypeScript è½¬æ¢æˆ JavaScript æ—¶ï¼Œæ¥å£å°±ä¼šæ¶ˆå¤±ï¼Œå› ä¸º JavaScript æ²¡æœ‰æ¥å£ã€‚ ç”±äº Angular åœ¨è¿è¡ŒæœŸæ²¡æœ‰æ¥å£ï¼Œæ‰€ä»¥è¯¥æ¥å£ä¸èƒ½ä½œä¸ºä»¤ç‰Œï¼Œä¹Ÿä¸èƒ½æ³¨å…¥å®ƒã€‚ // Can&#x27;t use interface as provider token[&#123; provide: AppConfig, useValue: HERO_DI_CONFIG &#125;)]// Can&#x27;t inject using the interface as the parameter typeconstructor(private config: AppConfig)&#123; &#125; multi å¤šä¸ªä¾èµ–å€¼å½“é…ç½®æä¾›è€…æ—¶è®¾ç½® multi ä¸º true æ—¶ï¼Œé€šè¿‡ @Inject(DIToken) â€‹ å‚æ•°æ³¨å…¥è·å–çš„ä¾èµ–å€¼å°±ä¼šè¿”å›ä¸€ä¸ªæ•°ç»„ã€‚ export declare interface ClassProvider extends ClassSansProvider &#123; /** * An injection token. (Typically an instance of `Type` or `InjectionToken`, but can be `any`). */ provide: any; /** * When true, injector returns an array of instances. This is useful to allow multiple * providers spread across many files to provide configuration information to a common token. */ multi?: boolean;&#125; ä½¿ç”¨åœºæ™¯ï¼šå†…ç½® API ï¼Œæ¯”å¦‚ï¼š NG_VALUE_ACCESSOR â€‹ã€ HTTP_INTERCEPTORS â€‹ã€ APP_INITIALIZER â€‹ ç­‰ @Component(&#123; selector: &quot;select&quot;, templateUrl: &quot;./select.component.html&quot;, changeDetection: ChangeDetectionStrategy.OnPush, providers: [ &#123; provide: NG_VALUE_ACCESSOR, useExisting: forwardRef(() =&gt; ThySelectComponent), multi: true, &#125;, ],&#125;)export class ThySelectComponent implements ControlValueAccessor &#123;&#125; ä»¥ä¸Šå°±æ˜¯ä¾èµ–æ³¨å…¥è€… provider ç›¸å…³çš„ä»‹ç»ï¼Œç†è§£äº† factory æä¾›ä¾èµ–å€¼åå†çœ‹å…¶ä»–ç±»å‹å°±ä¼šç®€å•å¾ˆå¤šï¼Œå…¶ä»–çš„ç±»å‹å°±æ˜¯ factory ä¹‹ä¸Šé«˜çº§çš„ API è€Œå·²ï¼Œæ»¡è¶³ä¸åŒçš„åœºæ™¯éœ€è¦ï¼Œè¿™æ˜¯ Angular ä¾èµ–æ³¨å…¥å…¥é—¨æ¯”è¾ƒéš¾æ‡‚çš„çŸ¥è¯†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„å¤šçº§æ³¨å…¥å™¨æ˜¯å¦ä¸€ä¸ªé‡è¦çš„çŸ¥è¯†ç‚¹ï¼Œè¿™ä¸¤éƒ¨åˆ†éƒ½æ·±å…¥ç†è§£é‚£ä¹ˆ Angular ä¾èµ–æ³¨å…¥å°±ä¸åœ¨æ˜¯éš¾ç‚¹äº†ã€‚ å‚è€ƒAngular ä¾èµ–æ³¨å…¥ - å…¨é¢è§£æ","updated":"2025-08-02T05:46:04.180Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"angular","slug":"angular","permalink":"https://luckyship.github.io/tags/angular/"}]},{"title":"angularç¼“å­˜é¡µé¢ã€å®ç°keepAliveæ•ˆæœ","date":"2023-02-24T06:24:00.000Z","path":"2023/02/24/2023-02-24-angular-cache-page/","text":"åœºæ™¯ï¼šå½“åœ¨æŸä¸ªé¡µé¢ç­›é€‰äº†ä¸€äº›æ¡ä»¶ï¼Œç„¶åéœ€è¦è·³åˆ°è¯¦æƒ…é¡µé¢ï¼Œæ­¤æ—¶è¿”å›åŸæ¥çš„åˆ—è¡¨é¡µï¼Œéœ€è¦ä¿æŒåŸæ¥çš„ç­›é€‰çŠ¶æ€ Angular RouteReuseStrategy è·¯ç”±å¤ç”¨ç­–ç•¥abstract class RouteReuseStrategy &#123; /* æ˜¯å¦å…è®¸å¤ç”¨è·¯ç”± */ abstract shouldDetach(route: ActivatedRouteSnapshot): boolean; /* å½“è·¯ç”±ç¦»å¼€æ—¶ä¼šè§¦å‘ï¼Œå­˜å‚¨è·¯ç”± */ abstract store(route: ActivatedRouteSnapshot, handle: DetachedRouteHandle): void; /* æ˜¯å¦å…è®¸è¿˜åŸè·¯ç”± */ abstract shouldAttach(route: ActivatedRouteSnapshot): boolean; /* è·å–å­˜å‚¨è·¯ç”± */ abstract retrieve(route: ActivatedRouteSnapshot): DetachedRouteHandle | null; /* è¿›å…¥è·¯ç”±è§¦å‘ï¼Œæ˜¯å¦åŒä¸€è·¯ç”±æ—¶å¤ç”¨è·¯ç”± */ abstract shouldReuseRoute(future: ActivatedRouteSnapshot, curr: ActivatedRouteSnapshot): boolean;&#125; è·¯ç”±å¤ç”¨ç­–ç•¥æ–¹æ³•æ‰§è¡Œé¡ºåºåˆ†å¸ƒè®²è§£å‡è®¾æˆ‘ä»¬ä»è·¯ç”± A â€”â€”&gt; è·¯ç”± B shouldReuseRoute(future, curr) å†³å®šæ˜¯å¦å¤ç”¨è·¯ç”±? æ ¹æ®åˆ‡æ¢çš„ future curr çš„èŠ‚ç‚¹å±‚çº§ä¾æ¬¡è°ƒç”¨ã€‚ è¿”å›å€¼ä¸º true æ—¶è¡¨ç¤ºå½“å‰èŠ‚ç‚¹å±‚çº§è·¯ç”±å¤ç”¨ï¼Œç„¶åç»§ç»­ä¸‹ä¸€è·¯ç”±èŠ‚ç‚¹è°ƒç”¨ï¼Œå…¥å‚ä¸ºåˆ‡æ¢çš„ä¸‹ä¸€çº§è·¯ç”±ï¼ˆå­çº§ï¼‰çš„ future curr è·¯ç”±çš„èŠ‚ç‚¹ã€‚ è¿”å›å€¼ä¸º false æ—¶è¡¨ç¤ºä¸åœ¨å¤ç”¨è·¯ç”±ï¼Œå¹¶ä¸”ä¸å†ç»§ç»­è°ƒç”¨æ­¤æ–¹æ³•ï¼ˆfuture è·¯ç”±ä¸å†å¤ç”¨ï¼Œå…¶å­çº§è·¯ç”±ä¹Ÿä¸ä¼šå¤ç”¨ï¼Œæ‰€ä»¥ä¸éœ€è¦å†è¯¢é—®ä¸‹å»ï¼‰ã€‚ root è·¯ç”±èŠ‚ç‚¹è°ƒç”¨ä¸€æ¬¡ï¼Œé root è·¯ç”±èŠ‚ç‚¹è°ƒç”¨ä¸¤æ¬¡è¿™ä¸ªæ–¹æ³•ï¼Œç¬¬ä¸€æ¬¡æ¯”è¾ƒçˆ¶çº§èŠ‚ç‚¹ï¼Œç¬¬äºŒæ¬¡æ¯”è¾ƒå½“å‰èŠ‚ç‚¹ï¼Œ retrieve(route) æ¥ä¸Šä¸€æ­¥éª¤ï¼Œå½“å½“å‰å±‚çº§è·¯ç”±ä¸éœ€è¦å¤ç”¨çš„æ—¶å€™ï¼Œè°ƒç”¨ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•ï¼Œå…¶å­çº§è·¯ç”±ä¹Ÿä¼šè°ƒç”¨ä¸€ä¸‹ retrieve æ–¹æ³•ã€‚å¦‚æœè¿”å›çš„æ˜¯ nullï¼Œé‚£ä¹ˆå½“å‰è·¯ç”±å¯¹åº”çš„ç»„ä»¶ä¼šå®ä¾‹åŒ–ï¼Œè¿™ç§è¡Œä¸ºä¸€ç›´æŒç»­åˆ°æœ«çº§è·¯ç”±ã€‚ shouldDetach(route)å¯¹ä¸Šä¸€è·¯ç”±æ˜¯å¦å®ç°å¤ç”¨åŠŸèƒ½ï¼Œå¦‚æœè¿”å› trueï¼Œè°ƒç”¨ä¸€ä¸‹ store æ–¹æ³•å­˜å‚¨è·¯ç”±ç»„ä»¶ï¼Œå¦‚æœè¿”å› falseï¼Œé‚£ä¹ˆå…ˆåˆ¤æ–­æœ‰æ²¡æœ‰å±‚çº§è·¯ç”±ï¼Œæœ‰çš„è¯ç»§ç»­æ‰§è¡Œ shouldDetach æ–¹æ³•ï¼Œæ²¡æœ‰çš„è¯åˆ™è·³è¿‡ç¬¬å››æ­¥éª¤ï¼Œæ‰§è¡Œç¬¬äº”æ­¥éª¤ store(route, handle)æ¥ä¸Šä¸€æ­¥éª¤ï¼Œå¦‚æœç¦»å¼€è·¯ç”± A çš„æ—¶å€™ï¼ŒshouldDetach è¿”å› true äº†ï¼Œé‚£ä¹ˆç¦»å¼€è·¯ç”± A åï¼Œè·¯ç”± A å¼•ç”¨çš„ç»„ä»¶ä½ å°±å¯ä»¥åœ¨è¿™é‡Œå­˜å‚¨èµ·æ¥ï¼Œä¸‹ä¸€æ¬¡å›åˆ°è·¯ç”± A çš„æ—¶å€™ï¼Œå°±å¯ä»¥æ‹¿åˆ° shouldAttach(route)å½“å‰è·¯ç”±æ˜¯ä¸æ˜¯å…è®¸è¿˜åŸå›æ¥ï¼Ÿå¦‚æœé…ç½®å…è®¸ï¼Œè¿”å› trueï¼Œç„¶åè°ƒç”¨ retrieve æ–¹æ³•è·å–å­˜å‚¨ç»„ä»¶ï¼Œåä¹‹è¿”å› falseï¼Œå°±æ­¤ç»“æŸ retrieve(route)ä¸Šä¸€æ­¥è¿”å› true äº†ï¼Œé‚£ä¹ˆè¯´æ˜è·¯ç”±æ—¶å…è®¸è¿˜åŸçš„ã€‚æˆ‘ä»¬åœ¨è¿™ä¸€æ­¥éª¤é‡Œé¢ï¼Œæ‹¿åˆ°æˆ‘ä»¬ä¹‹å‰ä¸ºè¿™ä¸ªè·¯ç”±ç¼“å­˜çš„æ•°æ®ï¼Œè¿”å›å³å¯ã€‚ store(route, handle)æ‹¿å®Œåï¼Œå†è°ƒç”¨ä¸€æ¬¡ store æ–¹æ³•ï¼Œè¿™é‡Œï¼Œå°±æ­¤ï¼Œæ•´ä¸ªè·¯ç”±å¤ç”¨ç­–ç•¥å°±ç»“æŸäº†ã€‚ åˆ›å»ºæ–°è·¯ç”±ç­–ç•¥å®ç° keepAlive åˆ›å»ºSimpleReuseStrategyæ–‡ä»¶ import &#123; RouteReuseStrategy, ActivatedRouteSnapshot, DetachedRouteHandle &#125; from &quot;@angular/router&quot;;export class SimpleReuseStrategy implements RouteReuseStrategy &#123; static cacheRouters = new Map&lt;string, DetachedRouteHandle&gt;(); /* ** æ¸…é™¤cachedroute: ** (this.routeReuseStrategy as AppRouteReuseStrategy).clearCachedRoute(&#x27;/factory/factoryManage&#x27;); */ public clearCachedRoute(key: string) &#123; const handle = this.cacheRouters.get(key); if (handle) &#123; (handle as any).componentRef.destroy(); &#125; this.cacheRouters.delete(key); &#125; public clearCacheOnNewUrl(url: string) &#123; this.cacheRouters.forEach((val, key) =&gt; &#123; if (url.indexOf(key) === -1) &#123; this.clearCachedRoute(key); &#125; &#125;); &#125; // one è¿›å…¥è·¯ç”±è§¦å‘ï¼Œæ˜¯å¦åŒä¸€è·¯ç”±æ—¶å¤ç”¨è·¯ç”± shouldReuseRoute(future: ActivatedRouteSnapshot, curr: ActivatedRouteSnapshot): boolean &#123; return future.routeConfig === curr.routeConfig &amp;&amp; JSON.stringify(future.params) === JSON.stringify(curr.params); &#125; // è·å–å­˜å‚¨è·¯ç”± retrieve(route: ActivatedRouteSnapshot): DetachedRouteHandle &#123; const url = this.getFullRouteURL(route); if (route.data.keep &amp;&amp; SimpleReuseStrategy.cacheRouters.has(url)) &#123; return SimpleReuseStrategy.cacheRouters.get(url); &#125; else &#123; return null; &#125; &#125; // æ˜¯å¦å…è®¸å¤ç”¨è·¯ç”± shouldDetach(route: ActivatedRouteSnapshot): boolean &#123; return Boolean(route.data.keep); &#125; // å½“è·¯ç”±ç¦»å¼€æ—¶ä¼šè§¦å‘ï¼Œå­˜å‚¨è·¯ç”± store(route: ActivatedRouteSnapshot, handle: DetachedRouteHandle): void &#123; const url = this.getFullRouteURL(route); SimpleReuseStrategy.cacheRouters.set(url, handle); &#125; // æ˜¯å¦å…è®¸è¿˜åŸè·¯ç”± shouldAttach(route: ActivatedRouteSnapshot): boolean &#123; const url = this.getFullRouteURL(route); return Boolean(route.data.keep) &amp;&amp; SimpleReuseStrategy.cacheRouters.has(url); &#125; // è·å–å½“å‰è·¯ç”±url private getFullRouteURL(route: ActivatedRouteSnapshot): string &#123; const &#123; pathFromRoot &#125; = route; let fullRouteUrlPath: string[] = []; pathFromRoot.forEach((item: ActivatedRouteSnapshot) =&gt; &#123; fullRouteUrlPath = fullRouteUrlPath.concat(this.getRouteUrlPath(item)); &#125;); return `/$&#123;fullRouteUrlPath.join(&quot;/&quot;)&#125;`; &#125; private getRouteUrlPath(route: ActivatedRouteSnapshot) &#123; return route.url.map((urlSegment) =&gt; urlSegment.path); &#125;&#125; åœ¨ providers é‡Œæ³¨å…¥ providers: [ &#123; provide: RouteReuseStrategy, useClass: SimpleReuseStrategy &#125;], åœ¨è·¯ç”±ä¸Šæ–°å¢ keepAlive å±æ€§ &#123; path: &#x27;cuttingTag&#x27;, component: CuttingTagComponent, data: &#123; keepAlive: true &#125; &#125; å‚è€ƒå½»åº•å¼„æ‡‚ Angular RouteReuseStrategy è·¯ç”±å¤ç”¨ç­–ç•¥github æºç å‚è€ƒ","updated":"2025-08-02T05:46:04.180Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"angular","slug":"angular","permalink":"https://luckyship.github.io/tags/angular/"}]},{"title":"htmlä¸­javascriptçš„6ç§åŠ è½½æ–¹å¼","date":"2023-02-24T05:58:50.000Z","path":"2023/02/24/2023-02-24-method-of-load-js/","text":"JS çš„ 6 ç§åŠ è½½æ–¹å¼1ï¼‰æ­£å¸¸æ¨¡å¼&lt;script src=&quot;index.js&quot;&gt;&lt;/script&gt; è¿™ç§æƒ…å†µä¸‹ JS ä¼šé˜»å¡ dom æ¸²æŸ“ï¼Œæµè§ˆå™¨å¿…é¡»ç­‰å¾… index.js åŠ è½½å’Œæ‰§è¡Œå®Œæˆåæ‰èƒ½å»åšå…¶å®ƒäº‹æƒ… 2ï¼‰async æ¨¡å¼&lt;script async src=&quot;index.js&quot;&gt;&lt;/script&gt; async æ¨¡å¼ä¸‹ï¼Œå®ƒçš„åŠ è½½æ˜¯å¼‚æ­¥çš„ï¼ŒJS ä¸ä¼šé˜»å¡ DOM çš„æ¸²æŸ“ï¼Œasync åŠ è½½æ˜¯æ— é¡ºåºçš„ï¼Œå½“å®ƒåŠ è½½ç»“æŸï¼ŒJS ä¼šç«‹å³æ‰§è¡Œ ä½¿ç”¨åœºæ™¯ï¼šè‹¥è¯¥ JS èµ„æºä¸ DOM å…ƒç´ æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œä¹Ÿä¸ä¼šäº§ç”Ÿå…¶ä»–èµ„æºæ‰€éœ€è¦çš„æ•°æ®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ async æ¨¡å¼ï¼Œæ¯”å¦‚åŸ‹ç‚¹ç»Ÿè®¡ 3ï¼‰defer æ¨¡å¼&lt;script defer src=&quot;index.js&quot;&gt;&lt;/script&gt; defer æ¨¡å¼ä¸‹ï¼ŒJS çš„åŠ è½½ä¹Ÿæ˜¯å¼‚æ­¥çš„ï¼Œdefer èµ„æºä¼šåœ¨ DOMContentLoaded äº‹ä»¶è§¦å‘ä¹‹å‰æ‰§è¡Œï¼Œå¹¶ä¸” defer æ˜¯æœ‰é¡ºåºçš„æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡ dom è§£æ å¦‚æœæœ‰å¤šä¸ªè®¾ç½®äº† defer çš„ script æ ‡ç­¾å­˜åœ¨ï¼Œåˆ™ä¼šæŒ‰ç…§å¼•å…¥çš„å‰åé¡ºåºæ‰§è¡Œï¼Œå³ä¾¿æ˜¯åé¢çš„ script èµ„æºå…ˆè¿”å› æ‰€ä»¥ defer å¯ä»¥ç”¨æ¥æ§åˆ¶ JS æ–‡ä»¶çš„æ‰§è¡Œé¡ºåºï¼Œæ¯”å¦‚ element-ui.js å’Œ vue.jsï¼Œå› ä¸º element-ui.js ä¾èµ–äº vueï¼Œæ‰€ä»¥å¿…é¡»å…ˆå¼•å…¥ vue.jsï¼Œå†å¼•å…¥ element-ui.js &lt;script defer src=&quot;vue.js&quot;&gt;&lt;/script&gt;&lt;script defer src=&quot;element-ui.js&quot;&gt;&lt;/script&gt; defer ä½¿ç”¨åœºæ™¯ï¼šä¸€èˆ¬æƒ…å†µä¸‹éƒ½å¯ä»¥ä½¿ç”¨ deferï¼Œç‰¹åˆ«æ˜¯éœ€è¦æ§åˆ¶èµ„æºåŠ è½½é¡ºåºæ—¶ 4ï¼‰module æ¨¡å¼&lt;script type=&quot;module&quot;&gt; import &#123; a &#125; from &quot;./a.js&quot;;&lt;/script&gt; åœ¨ä¸»æµçš„ç°ä»£æµè§ˆå™¨ä¸­ï¼Œscript æ ‡ç­¾çš„å±æ€§å¯ä»¥åŠ ä¸Š type=&quot;module&quot;ï¼Œæµè§ˆå™¨ä¼šå¯¹å…¶å†…éƒ¨çš„ import å¼•ç”¨å‘èµ· HTTP è¯·æ±‚ï¼Œè·å–æ¨¡å—å†…å®¹ã€‚è¿™æ—¶ script çš„è¡Œä¸ºä¼šåƒæ˜¯ defer ä¸€æ ·ï¼Œåœ¨åå°ä¸‹è½½ï¼Œå¹¶ä¸”ç­‰å¾… DOM è§£æ Vite å°±æ˜¯åˆ©ç”¨æµè§ˆå™¨æ”¯æŒåŸç”Ÿçš„ es module æ¨¡å—ï¼Œå¼€å‘æ—¶è·³è¿‡æ‰“åŒ…çš„è¿‡ç¨‹ï¼Œæå‡ç¼–è¯‘æ•ˆç‡ 5ï¼‰ preload&lt;link rel=&quot;preload&quot; as=&quot;script&quot; href=&quot;index.js&quot; /&gt; å€¼å¾—å…³æ³¨çš„å°±æ˜¯ as å±æ€§ï¼Œpreload çš„ä¼˜å…ˆçº§é¡ºåºå’Œè¿™ä¸ªå±æ€§æŒ‡å®šçš„èµ„æºç±»å‹ç›¸å…³ã€‚ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œå‡å¦‚æˆ‘ä»¬æŒ‡å®šäº† as çš„å€¼æ˜¯ styleï¼Œä¹Ÿå°±æ˜¯æŠŠå®ƒå½“åš css èµ„æºï¼Œé‚£å®ƒçš„ä¼˜å…ˆçº§å°±ä¼šå˜å¾—æœ€é«˜ã€‚ä½†æ˜¯ä¹Ÿæœ‰ä¸€ä¸ªä¾‹å¤–ï¼šè™½ç„¶ font çš„ä¼˜å…ˆçº§æ˜¯æœ€é«˜ï¼Œä½†æŠŠ as çš„å€¼æŒ‡å®šä¸º font å¹¶ä¸ä¼šæŠŠæ­¤èµ„æºçš„ä¼˜å…ˆçº§æ”¾åˆ°æœ€é«˜ï¼Œæ–‡æ¡£ä¸“é—¨ä¸º font çš„ preload æŒ‡å®šäº†ä¼˜å…ˆçº§ï¼šä½äºç¬¬äºŒçº§ã€‚ç›®å‰æ¥è¯´ï¼Œé™¤äº† fontï¼Œå…¶ä»–éƒ½æŒ‰ç…§å’Œèµ„æºä¼˜å…ˆçº§ç›¸åŒçš„è§„åˆ™ã€‚as å±æ€§å¯ä»¥è¯´æ˜¯å¿…é¡»è¦è®¾ç½®çš„ï¼Œé™¤äº†ä¸Šé¢å¯ä»¥ç»™ä¼˜å…ˆçº§æ’çº§åˆ«ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªåŸå› ï¼šå¦‚æœä¸è®¾ç½®çš„è¯ï¼Œå®ƒä¼šè¢«ä½œä¸ºä¸€ä¸ª XHR è¯·æ±‚å»è§¦å‘ï¼Œæµè§ˆå™¨å¯èƒ½ä¸èƒ½æ­£ç¡®çš„è®¤è¯†åˆ°ï¼Œæˆ‘ä»¬å…¶å®å·²ç»æŠŠèµ„æºé¢„åŠ è½½äº†ï¼Œè¿™æ ·å­å°±ä¼šåŠ è½½ä¸¤æ¬¡äº†ï¼Œå®Œå…¨æ²¡æœ‰äº†ä¼˜åŒ–çš„æ•ˆæœã€‚ä¸æŒ‡å®š as æµè§ˆå™¨ä¹Ÿä¼šæœ‰è­¦å‘Šï¼š preload åªä¼šåŠ è½½ï¼ŒçœŸæ­£æ‰§è¡Œè¦ç­‰åˆ°èµ„æºè¢«ç”¨åˆ°çš„åœ°æ–¹ã€‚ æ¥ä¸‹æ¥å†ç»™å¤§å®¶ä»‹ç»ä¸€ä¸ªå®ƒçš„åº”ç”¨åœºæ™¯ã€‚ ç°åœ¨æˆ‘ä»¬çš„æ–‡ä»¶æ˜¯è¿™æ ·çš„ï¼š index.html|--main.js |--styles.css æˆ‘ä»¬æœ‰ä¸€ä¸ª main.js ï¼Œå®ƒä¼šåœ¨ 200 ms åä¸‹è½½å®Œï¼Œåœ¨å®ƒçš„å†…éƒ¨ä¼šåŠ è½½ä¸€æ®µ CSS æ¥æ§åˆ¶é¡µé¢çš„æ ·å¼ï¼Œå®ƒä¹Ÿéœ€è¦ä¸‹è½½ 200 msã€‚è™½ç„¶ style.css æˆ‘ä»¬è‚¯å®šä¼šç”¨åˆ°ï¼Œä½†æ˜¯æµè§ˆå™¨å¿…é¡»è¦ç­‰ä¸‹è½½ã€è§£æå®Œ main.js æ‰å¼€å§‹ä¸‹è½½ style.cssï¼Œè¿™å°±ç™½ç™½æµªè´¹äº†è‡³å°‘ 200 msã€‚è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥æŠŠ style.css ç”¨ preload ä¼˜åŒ–ï¼šæŠŠ style.css æ ‡è¯†ä¸º preload çš„èµ„æºã€‚ä¹Ÿä¸æ˜¯æ‰€æœ‰çš„èµ„æºéƒ½é€‚åˆç”¨ preloadï¼Œå®ƒåªé€‚åˆç”¨äº page load é˜¶æ®µçš„èµ„æºã€‚æ¯•ç«Ÿï¼Œå®ƒçš„ä¼˜å…ˆçº§è¿˜æ˜¯å¾ˆé«˜çš„ï¼Œä¹±ç”¨çš„è¯ï¼Œä¸€ä¸ªæ˜¯å è¯·æ±‚çº¿ç¨‹ï¼Œä¸€ä¸ªæ˜¯å æµè§ˆå™¨çš„ç¼“å­˜ã€‚å¦‚æœæˆ‘ä»¬ preload çš„èµ„æºåœ¨ load äº‹ä»¶å‡ ç§’åæ²¡æœ‰ç”¨ï¼Œæ§åˆ¶å°è¿˜ä¼šè­¦å‘Šæˆ‘ä»¬ã€‚æ¯”å¦‚æˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­ï¼Œæ²¡æœ‰å®é™…å¼•ç”¨ style.cssï¼Œå°±æœ‰ä¸‹é¢çš„è­¦å‘Šï¼š preload ç‰¹ç‚¹ï¼š 1ï¼‰preload åŠ è½½çš„èµ„æºæ˜¯åœ¨æµè§ˆå™¨æ¸²æŸ“æœºåˆ¶ä¹‹å‰è¿›è¡Œå¤„ç†çš„ï¼Œå¹¶ä¸”ä¸ä¼šé˜»å¡ onload äº‹ä»¶ï¼› 2ï¼‰preload åŠ è½½çš„ JS è„šæœ¬å…¶åŠ è½½å’Œæ‰§è¡Œçš„è¿‡ç¨‹æ˜¯åˆ†ç¦»çš„ï¼Œå³ preload ä¼šé¢„åŠ è½½ç›¸åº”çš„è„šæœ¬ä»£ç ï¼Œå¾…åˆ°éœ€è¦æ—¶è‡ªè¡Œè°ƒç”¨ï¼› 6ï¼‰prefetch&lt;link rel=&quot;prefetch&quot; as=&quot;script&quot; href=&quot;index.js&quot; /&gt; prefetch æ˜¯åˆ©ç”¨æµè§ˆå™¨çš„ç©ºé—²æ—¶é—´ï¼ŒåŠ è½½é¡µé¢å°†æ¥å¯èƒ½ç”¨åˆ°çš„èµ„æºçš„ä¸€ç§æœºåˆ¶ï¼›é€šå¸¸å¯ä»¥ç”¨äºåŠ è½½å…¶ä»–é¡µé¢ï¼ˆéé¦–é¡µï¼‰æ‰€éœ€è¦çš„èµ„æºï¼Œä»¥ä¾¿åŠ å¿«åç»­é¡µé¢çš„æ‰“å¼€é€Ÿåº¦prefetch ç‰¹ç‚¹ï¼š 1ï¼‰pretch åŠ è½½çš„èµ„æºå¯ä»¥è·å–éå½“å‰é¡µé¢æ‰€éœ€è¦çš„èµ„æºï¼Œå¹¶ä¸”å°†å…¶æ”¾å…¥ç¼“å­˜è‡³å°‘ 5 åˆ†é’Ÿï¼ˆæ— è®ºèµ„æºæ˜¯å¦å¯ä»¥ç¼“å­˜ï¼‰ 2ï¼‰å½“é¡µé¢è·³è½¬æ—¶ï¼Œæœªå®Œæˆçš„ prefetch è¯·æ±‚ä¸ä¼šè¢«ä¸­æ–­ åŠ è½½æ–¹å¼æ€»ç»“asyncã€defer æ˜¯ script æ ‡ç­¾çš„ä¸“å±å±æ€§ï¼Œå¯¹äºç½‘é¡µä¸­çš„å…¶ä»–èµ„æºï¼Œå¯ä»¥é€šè¿‡ link çš„ preloadã€prefetch å±æ€§æ¥é¢„åŠ è½½ å¦‚ä»Šç°ä»£æ¡†æ¶å·²ç»å°† preloadã€prefetch æ·»åŠ åˆ°æ‰“åŒ…æµç¨‹ä¸­äº†ï¼Œé€šè¿‡çµæ´»çš„é…ç½®ï¼Œå»ä½¿ç”¨è¿™äº›é¢„åŠ è½½åŠŸèƒ½ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å®¡æ—¶åº¦åŠ¿åœ°å‘ script æ ‡ç­¾æ·»åŠ  asyncã€defer å±æ€§å»å¤„ç†èµ„æºï¼Œè¿™æ ·å¯ä»¥æ˜¾è‘—æå‡æ€§èƒ½ å‚è€ƒæ€§èƒ½ä¼˜åŒ–ä¹‹ preloadã€prefetchã€preconnect çš„åŒºåˆ«ä¸ä½¿ç”¨å‰ç«¯æ€§èƒ½ä¼˜åŒ–â€”â€”é¦–é¡µèµ„æºå‹ç¼© 63%ã€ç™½å±æ—¶é—´ç¼©çŸ­ 86%","updated":"2025-08-02T05:46:04.180Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"å¯Œæ–‡æœ¬ç¼–è¾‘å™¨Quillæ”¯æŒå¤åˆ¶ç²˜è´´æ–‡å­—å›¾ç‰‡","date":"2022-10-11T03:54:06.000Z","path":"2022/10/11/2022-10-11-quill-support-word-img/","text":"åœ¨ä½¿ç”¨å¯Œæ–‡æœ¬ç¼–è¾‘å™¨æ—¶ï¼Œé€šå¸¸ word æ•´ä½“ç²˜è´´æ—¶ï¼Œå›¾ç‰‡æ€»æ˜¯æ— æ³•æ­£å¸¸æ˜¾ç¤ºï¼Œå›¾ç‰‡åœ°å€ä¼šæ˜¯ src=â€//0â€çš„æƒ…å†µï¼Œè¿™ä¸»è¦æ—¶å› ä¸ºï¼Œæˆ‘ä»¬æ•´ä½“ç²˜è´´æ—¶ï¼Œå®é™…ä¸Šæˆ‘æˆ‘ä»¬ç²˜è´´è¿‡å»çš„æ˜¯ä¸€ç‰‡ word çš„ dom å­—ç¬¦ä¸²ï¼Œå…¶ä¸­ç¼–è¾‘å™¨ä¼šä¸ºæˆ‘ä»¬è¿‡æ»¤å…¶ä»–æ— ç”¨æ ‡ç­¾ï¼Œä¿ç•™äº†ä¸»è¦éƒ¨åˆ†ã€‚ç”±äºç²˜è´´æ—¶å€™ word æ–‡æ¡£ä¸­å›¾ç‰‡éƒ¨åˆ†å®é™…ä¸Šå¼•ç”¨çš„æ˜¯æœ¬åœ°åœ°å€ï¼Œç”±äºæµè§ˆå™¨å’Œ js é™åˆ¶æ— æ³•è¯»å–æˆ–è€…æ“ä½œæœ¬åœ°æ–‡ä»¶ï¼Œå› æ­¤æ— æ³•æ­£å¸¸æ˜¾ç¤ºã€‚å¦‚æœæ˜¯ç½‘ç»œä¸Šå¤åˆ¶ç²˜è´´çš„æ–‡æ¡£åˆ™å¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚ ä¸€ä¸‹æ˜¯ä» word ç›´æ¥ç²˜è´´è¿‡æ¥çš„æ•ˆæœä¸€ä¸‹æ˜¯ä»ç½‘ç»œä¸Šç²˜è´´è¿‡æ¥çš„æ•ˆæœ ç²˜è´´äº‹ä»¶é€šå¸¸è¦è§£å†³ä» word ä¸­å¤åˆ¶ç²˜è´´åˆ°å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ä¸­ï¼Œéƒ½ç¦»ä¸å¼€è¿™ä¸ª paste äº‹ä»¶,æˆ‘ä»¬ç®€å•åˆ†æä¸€ä¸‹è¿™ä¸ªäº‹ä»¶ã€‚ç²˜è´´äº‹ä»¶æä¾›äº†ä¸€ä¸ª clipboardData çš„å±æ€§ï¼Œå¦‚æœè¯¥å±æ€§æœ‰ items å±æ€§ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŸ¥çœ‹ items ä¸­æ˜¯å¦æœ‰å›¾ç‰‡ç±»å‹çš„æ•°æ®äº†ã€‚clipboardData çš„å±æ€§ä»‹ç»ï¼š å±æ€§ ç±»å‹ è¯´æ˜ dropEffect String é»˜è®¤æ˜¯ none effectAllowed String ç²˜è´´æ“ä½œä¸ºç©º List items DataTransferItemList å‰ªåˆ‡æ¿ä¸­çš„å„é¡¹æ•°æ® types Array å‰ªåˆ‡æ¿ä¸­çš„æ•°æ®ç±»å‹ items æ˜¯ä¸€ä¸ª DataTransferItemList(æµè§ˆå™¨åŸºäº file å¯¹è±¡å®ç°çš„æ–¹æ³•ï¼Œæ‰€ä»¥èƒ½å¤Ÿè½¬æ¢æˆ file å¯¹è±¡)å¯¹è±¡ï¼Œé‡Œé¢éƒ½æ˜¯ DataTransferItem ç±»å‹çš„æ•°æ®äº†ã€‚ items çš„ DataTransferItem æœ‰ä¸¤ä¸ªå±æ€§ kind å’Œ typeã€‚kind ä¸€èˆ¬ä¸º string æˆ–è€… filetype å…·ä½“çš„æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚å…·ä½“æ˜¯å“ªç§ç±»å‹å­—ç¬¦ä¸²æˆ–è€…å“ªç§ç±»å‹çš„æ–‡ä»¶ï¼Œå³ MIME-Type æ–¹æ³• getAsFile ç©º å¦‚æœ kind æ˜¯ fileï¼Œå¯ä»¥ç”¨è¯¥æ–¹æ³•è·å–åˆ°æ–‡ä»¶ getAsString å›è°ƒå‡½æ•° å¦‚æœ kind æ˜¯ stringï¼Œå¯ä»¥ç”¨è¯¥æ–¹æ³•è·å–åˆ°å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²éœ€è¦ç”¨å›è°ƒå‡½æ•°å¾—åˆ°ï¼Œå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯å‰ªåˆ‡æ¿ä¸­çš„å­—ç¬¦ä¸² é€šå¸¸æˆ‘ä»¬é€šè¿‡ä»¥ä¸Šæä¾›çš„å±æ€§å°±èƒ½å¤Ÿå®ç°ä¸è®ºæ˜¯ä»ä½•å¤„ç²˜è´´çš„å†…å®¹,ä»è¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°å…¶å†²ç²˜è´´çš„å†…å®¹ï¼Œè¿™é‡Œç®€å•å®ç°ä¸€ä¸ªå•å¼ å›¾ç‰‡ç²˜è´´çš„ä¾‹å­ã€‚ å•å¼ å›¾ç‰‡ç²˜è´´let quill = this.$refs.myQuillEditor.quill; quill.root.addEventListener( &quot;paste&quot;, (evt) =&gt; &#123; // ç²˜è´´äº‹ä»¶ if ( evt.clipboardData &amp;&amp; evt.clipboardData.files &amp;&amp; evt.clipboardData.files.length ) &#123; evt.preventDefault(); [].forEach.call(evt.clipboardData.files, (file) =&gt; &#123; if (!file.type.match(/^image\\/(gif|jpe?g|a?png|bmp)/i)) &#123; return; &#125; console.log(&#x27;å•ä¸ªå›¾ç‰‡ç²˜è´´&#x27;, file); // è½¬base64æ ¼å¼ const reader = new FileReader() reader.readAsDataURL(file) reader.onload = (e) =&gt; &#123; // æ’å…¥å›¾ç‰‡ quill.insertEmbed( quill.getSelection().index, &quot;image&quot;, reader.result ) &#125; reader.onerror = (error) =&gt;reject(error) // obsUpload(file, this.$refs.myQuillEditor); &#125;); &#125; å¤åˆ¶å†…å®¹æ•´ä½“ç²˜è´´å¤åˆ¶å†…å®¹æ•´ä½“ç²˜è´´ï¼Œæˆ‘ä»¬é€šè¿‡ä¸Šè¿°çš„æ–¹æ³•åŒæ ·å¯ä»¥æ‹¿åˆ°å…¶ä¸­å†…å®¹ã€‚ let length = evt.clipboardData.items.length;for (let i = 0; i &lt; length; i++) &#123; var item = evt.clipboardData.items[i]; if (item.kind === &quot;string&quot;) &#123; item.getAsString(function (str) &#123; // str æ˜¯è·å–åˆ°çš„å­—ç¬¦ä¸² console.log(str); &#125;); &#125; else if (item.kind === &quot;file&quot;) &#123; var pasteFile = item.getAsFile(); console.log(pasteFile); &#125;&#125; æ•´ä½“ç²˜è´´è¿‡æ¥ï¼Œkind ä¸º stringï¼Œå®é™…ä¸Šæˆ‘ä»¬æ‹¿åˆ°çš„æ˜¯ä¸€ä¸ª html æ–‡æ¡£ã€‚æ•´ä½“ç²˜è´´è¿‡æ¥ï¼Œkind ä¸º fileï¼Œå®é™…ä¸Šæˆ‘ä»¬æ‹¿åˆ°çš„æ˜¯ä¸€ä¸ª file æ–‡ä»¶å¯¹è±¡ã€‚è¿™é‡Œå®é™…ä¸Šå’Œç¬¬ä¸€éƒ¨ç²˜è´´å•å¼ å›¾ç‰‡å¤„ç†æ–¹å¼ä¸€æ ·ã€‚ æ•´ä½“ç²˜è´´å¦‚ä½•å®ç°ä»å‰ªåˆ‡æ¿ä¸­æå–å‡ºå›¾ç‰‡ä¸Šè¿°å†…å®¹ä»…ä»…æ˜¯ä½œä¸ºäº†è§£å†…å®¹ï¼ŒçŸ¥é“åŸºæœ¬åŸç†ï¼Œä¸‹é¢è¿™é‡Œæ‰æ˜¯é‡ç‚¹ã€‚å¦‚æœä¸Šé¢èƒ½è§£å†³ä½ çš„å•å¼ å›¾ç‰‡ç²˜è´´é—®é¢˜ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥æ‰æ˜¯å®ç°æ•´ä½“ç²˜è´´æå–å›¾ç‰‡çš„å…³é”®ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ clipboardData æä¾›çš„å…¶ä»–å‡ ä¸ªæ–¹æ³•ã€‚ clearData(sDataFormat) åˆ é™¤å‰ªè´´æ¿ä¸­æŒ‡å®šæ ¼å¼çš„æ•°æ®ã€‚ getData(sDataFormat) ä»å‰ªè´´æ¿è·å–æŒ‡å®šæ ¼å¼çš„æ•°æ®ã€‚ setData(sDataFormat, sData) ç»™å‰ªè´´æ¿èµ‹äºˆæŒ‡å®šæ ¼å¼çš„æ•°æ®ã€‚è¿”å› true è¡¨ç¤ºæ“ä½œæˆåŠŸã€‚ è¿™é‡Œæˆ‘ä»¬é‡ç‚¹è®¨è®º getData è¿™ä¸ªæ–¹æ³•ï¼Œå…¶ä»–æ–¹æ³•è¯·è‡ªè¡Œå®è·µã€‚getData è¿™ä¸ªæ–¹æ³•æ˜¯ clipboardData æä¾›ç»™æˆ‘ä»¬å¿«é€Ÿä»å‰ªåˆ‡æ¿ä¸­æå–å†…å®¹çš„æ–¹æ³•ã€‚å…¶ä¸­å¸¸ç”¨å‚æ•°ï¼š text/html è·å– html å†…å®¹ text/plain è·å–æ–‡æœ¬å†…å®¹ text/rtf è·å–å¯Œåª’ä½“å†…å®¹ (ä»€ä¹ˆæ˜¯ rtf è¯·è‡ªè¡ŒæŸ¥è¯¢èµ„æ–™,è¿™é‡Œé¢å°±å«æœ‰æˆ‘ä»¬éœ€è¦çš„å›¾ç‰‡ä¿¡æ¯) æˆ‘ä»¬éœ€è¦ç»“åˆ text/html å’Œ text/rtf ä¸¤ç§ä¸¤ç§æ–¹æ³•å®ç°ï¼Œå¯¹ç²˜è´´å†…å®¹ä¸­å›¾ç‰‡çš„æå–ã€‚é€šè¿‡ text/html æˆ‘ä»¬æå–åˆ°å›¾ç‰‡ä¹‹åï¼Œæˆ‘ä»¬å‘ç°å›¾ç‰‡åœ°å€éƒ½æ˜¯ file:/// å¼€å§‹çš„æœ¬åœ°æ–‡ä»¶ï¼Œjs æ— æ³•å®Œæˆå¯¹æœ¬åœ°æ–‡ä»¶çš„å¤„ç†,æ— æ³•åš base64 å¤„ç†ã€‚æµè§ˆå™¨ä¼šç»™å‡ºè­¦å‘Šã€‚æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦ï¼Œä» html æ–‡æ¡£ä¸­æå–å‡ºæ˜¯ file æ ¼å¼çš„æœ¬åœ°æ–‡ä»¶çš„ img, ç„¶åè®²è¿™äº›å›¾ç‰‡æ›¿æ¢æˆ loading å›¾ç‰‡ã€‚ç„¶åå°±æ˜¯å¦‚ä½•æŠŠè¿™äº›å›¾ç‰‡è½¬æ¢æˆå¯¹åº”çš„å›¾ç‰‡ã€‚åœ¨ QuillEditor ä¸­æä¾›ä¸€ä¸ª clipboard é…ç½®é¡¹ï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªé…ç½®é¡¹å®ç°å°†å›¾ç‰‡æ›¿æ¢æˆ loading å›¾ç‰‡ã€‚ // è‡ªå®šä¹‰ç²˜è´´å†…å®¹è¿‡æ»¤æ–¹æ³•function customMatcherNode(node, delta) &#123; if (delta.ops &amp;&amp; delta.ops.length &gt; 0) &#123; delta.ops = delta.ops.map((item) =&gt; &#123; if (item.insert) &#123; if (item.insert.image) &#123; // åˆ¤æ–­æ˜¯å¦æ˜¯ç½‘ç»œåœ°å€ if (/file:\\/\\//.test(item.insert.image)) &#123; item.insert.image = &quot;https://img.zcool.cn/community/0196fa582abab6a84a0d304f899eaf.gif&quot;; &#125; &#125; return item; &#125; &#125;); &#125; return delta;&#125; é€šè¿‡ä»¥ä¸Šæ–¹æ³•ï¼Œæˆ‘ä»¬å®ç°è®²äº†æ•´ä½“ç²˜è´´è¿‡æ¥çš„å†…å®¹æ¢æˆ loading å›¾ç‰‡ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦è®²å¯¹åº”çš„ loading å›¾ç‰‡ï¼Œæ›¿æ¢æˆå¯¹åº”çš„çœŸå®å›¾ç‰‡ã€‚è¿™äº›å›¾ç‰‡çš„å¯¹åº”çš„å†…å®¹å°±ä¿å­˜åœ¨ getData(&#39;text/rtf&#39;)ä¸­ï¼Œè¿™é‡Œé¢æ˜¯ä¸€ç§ç‰¹æ®Š hex æ ¼å¼çš„å†…å®¹ã€‚æˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œè½¬æ¢å’Œæå–ã€‚æ‰èƒ½æ‹¿åˆ°å¯¹åº”çš„ base64 å›¾ç‰‡ã€‚ ä» rtf ä¸­æå–å›¾ç‰‡ä¿¡æ¯// rtfä¸­æå–å›¾ç‰‡ä¿¡æ¯function extractImageDataFromRtf(rtfData) &#123; if (!rtfData) &#123; return []; &#125; const regexPictureHeader = /&#123;\\\\pict[\\s\\S]+?(&#123;\\\\\\*\\\\blipuid\\s?[\\da-fA-F]+)[\\s&#125;]*/; const regexPicture = new RegExp( &quot;(?:(&quot; + regexPictureHeader.source + &quot;))([\\\\da-fA-F\\\\s]+)\\\\&#125;&quot;, &quot;g&quot; ); const images = rtfData.match(regexPicture); const result = []; if (images) &#123; for (const image of images) &#123; let imageType = false; if (image.includes(&quot;\\\\pngblip&quot;)) &#123; imageType = &quot;image/png&quot;; &#125; else if (image.includes(&quot;\\\\jpegblip&quot;)) &#123; imageType = &quot;image/jpeg&quot;; &#125; if (imageType) &#123; result.push(&#123; hex: image .replace(regexPictureHeader, &quot;&quot;) .replace(/[^\\da-fA-F]/g, &quot;&quot;), type: imageType, &#125;); &#125; &#125; &#125; return result;&#125; åˆ©ç”¨æ­£åˆ™ä» rtf å†…å®¹ä¸­æå–åˆ°å›¾ç‰‡çš„æ ¸å¿ƒä¿¡æ¯ï¼Œå¾—åˆ°æ•°ç»„ã€‚å…¶ä¸­æ•°ç»„ä¸­ä¿å­˜çš„ä¿¡æ¯æœ‰ &#123; &quot;type&quot;: &quot;&quot;, //å›¾ç‰‡ç±»å‹ &quot;hex&quot;: &quot;&quot; // hexå­—ç¬¦ä¸²&#125; å°† hex å­—ç¬¦ä¸²è½¬åŒ–ä¸º base64 å›¾ç‰‡ä¿¡æ¯// è®²hexæ ¼å¼è½¬åŒ–ä¸ºbase64function convertHexToBase64(hexString) &#123; return btoa( hexString .match(/\\w&#123;2&#125;/g) .map((char) =&gt; &#123; return String.fromCharCode(parseInt(char, 16)); &#125;) .join(&quot;&quot;) );&#125; åˆ°è¿™é‡Œæ ¸å¿ƒçš„æ–¹æ³•æå– rtf å†…å®¹åˆ°å›¾ç‰‡ä¿¡æ¯å°±å¤„ç†å®Œäº†ã€‚è¯¦ç»†ä»£ç ï¼š console.log(&quot;æ‰¹é‡ç²˜è´´&quot;);// const pastDom = evt.clipboardData.getData(&#x27;text/html&#x27;);const rtf = evt.clipboardData.getData(&quot;text/rtf&quot;);const hexStrings = extractImageDataFromRtf(rtf);// è·å–base64å›¾ç‰‡æ•°æ®const base64Images = hexStrings.map((hexObj) =&gt; &#123; return convertHexToBase64(hexObj.hex);&#125;);// ç²˜è´´åå¤„ç†ç²˜è´´å†…å®¹setTimeout(() =&gt; &#123; const editorDom = this.$refs.myQuillEditor.quill.root; const editorImgs = editorDom.querySelectorAll( &#x27;img[src*=&quot;0196fa582abab6a84a0d304f899eaf.gif&quot;]&#x27; ); editorImgs.forEach((item, index) =&gt; &#123; item.src = `data:$&#123;hexStrings[index].type&#125;;base64,$&#123;base64Images[index]&#125;`; &#125;);&#125;, 200); åˆ©ç”¨æŸ¥æ‰¾ quillEditor ç¼–è¾‘å™¨ä¸­ loading å›¾ç‰‡ï¼Œç„¶åéå†æ›¿æ¢ä¸º base64 å›¾ç‰‡æ ¼å¼ã€‚æ ¹æ®ä¸Šè¿°æ–¹æ³•ï¼Œå¤§å®¶å¯ä»¥è‡ªè¡Œæ ¹æ®å®é™…æƒ…å†µåœ¨ä¸åŒç¼–è¾‘å™¨ä¸‹ä¿®æ”¹ä»£ç ï¼Œè¿›ä¸€æ­¥å®Œå–„ä¸Šä¼ åˆ°äº‘å­˜å‚¨ä¹Ÿå¯è°ƒæ•´æ›¿æ¢å›¾ç‰‡çš„ src çš„éƒ¨åˆ†ã€‚å¼‚æ­¥åæ‹¿åˆ°è·¯å¾„ä¹‹åä¿®æ”¹å®Œå–„ã€‚ è½¬è½½å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ word æ•´ä½“ç²˜è´´å®ç°å›¾ç‰‡è‡ªåŠ¨å±•ç¤º(ä¸€)","updated":"2025-08-02T05:46:04.180Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"whistleæŠ“åŒ…å·¥å…·","date":"2022-10-11T02:47:51.000Z","path":"2022/10/11/2022-10-11-whistle/","text":"ä¸€ã€whistle ç®€ä»‹whistle æ˜¯ä¸€æ¬¾åŸºäº Node.js å®ç°çš„ï¼Œç±»ä¼¼ Fiddlerã€Charles çš„ä»£ç†å·¥å…·ï¼Œå¯ç”¨äº HTTPã€Websocket ç­‰è¯·æ±‚çš„æŠ“å–ã€ç¼–è¾‘ã€é‡æ”¾ç­‰åŠŸèƒ½ã€‚ åˆ©ç”¨ whistle çš„æ”¹åŒ…åŠŸèƒ½ï¼Œåœ¨è¿›è¡Œ HTTP(S) è¯·æ±‚æ—¶ï¼Œå¯ä»¥è½»æ¾å®ŒæˆæŸäº›ä¸å…·å¤‡æµ‹è¯•æ¡ä»¶æˆ–ä¸æ˜“æ„é€ çœŸå®åœºæ™¯çš„æµ‹è¯•å·¥ä½œï¼Œå¦‚å¼‚å¸¸åœºæ™¯ã€è¾¹ç•Œåœºæ™¯çš„æµ‹è¯•ç­‰ã€‚ äºŒã€å®‰è£…ã€å¯åŠ¨ã€é…ç½®2.1 å®‰è£… Node.jsç”±äº whistle æ˜¯åŸºäº Node å®ç°çš„ï¼Œå› æ­¤éœ€è¦é¢„å…ˆå®‰è£… Node.js Node.js å®˜ç½‘ï¼ˆ https://nodejs.org/zh-cn/ ï¼‰ 2.2 å®‰è£… whistleé€šè¿‡ npm åŒ…ç®¡ç†å·¥å…·è¿›è¡Œå®‰è£… npm install -g whistle 1 2.3 å¯åŠ¨ whistleå®‰è£…å¥½ whistle åï¼Œæ‰“å¼€å‘½ä»¤è¡Œå·¥å…·ï¼Œæ‰§è¡Œå¦‚ä¸‹å¯åŠ¨å‘½ä»¤ w2 start 1 å¯åŠ¨æˆåŠŸåï¼Œä¼šæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯ â€‹ ã€ whistle æˆåŠŸå¯åŠ¨çŠ¶æ€ ã€‘ å¯é€šè¿‡è®¿é—®æœ¬åœ°ç«¯å£è®¿é—® whistle æ§åˆ¶å° â€‹ ã€ è®¿é—® whistle é¡µé¢ ã€‘ whistle æŸ¥çœ‹è¿è¡ŒçŠ¶æ€å’Œåœæ­¢å‘½ä»¤åˆ†åˆ«å¦‚ä¸‹ w2 status # æŸ¥çœ‹è¿è¡ŒçŠ¶æ€w2 stop # åœæ­¢è¿è¡Œ 1 2 2.4 é…ç½®ä»£ç† ï¼ˆæ¨èï¼‰ç”±äº whistle æ˜¯é€šè¿‡ä»£ç†æœåŠ¡æ¥è¿›è¡Œå·¥ä½œçš„ï¼Œå› æ­¤éœ€è¦ç»™è¯·æ±‚å®¢æˆ·ç«¯é…ç½® whistle çš„ä»£ç†ï¼Œä»£ç†åœ°å€å³ whistle çš„ç›‘å¬åœ°å€ï¼ˆé»˜è®¤ä¸º http://127.0.0.1:8899/ ï¼‰ã€‚ åœ¨è¿›è¡Œ Web æµ‹è¯•æ—¶ï¼Œæ¨èç»“åˆ SwitchyOmega ç­‰æµè§ˆå™¨ï¼ˆé€‚ç”¨ Chromeã€Firefoxï¼‰ä»£ç†æ’ä»¶æ¥è¿›è¡Œä½¿ç”¨ã€‚å¦‚ä¸‹å›¾ï¼Œåœ¨ Chrome æµè§ˆå™¨å®‰è£…å¥½æ‰©å±•åï¼Œé…ç½®ä»£ç†æœåŠ¡å™¨ä¸º whistle åœ°å€ï¼Œå¹¶å°†æµè§ˆå™¨è¯·æ±‚åˆ‡æ¢ä¸º whistle ä»£ç† â€‹ ã€ SwitchyOmega è®¾ç½® whistle ä»£ç†æƒ…æ™¯æ¨¡å¼ ã€‘ â€‹ ã€ æµè§ˆå™¨è®¿é—®åˆ‡æ¢ä¸º whistle æƒ…æ™¯æ¨¡å¼ ã€‘ æ­¤æ—¶æµè§ˆå™¨å‘é€çš„è¯·æ±‚å³å¯è¢« whistle æŠ“å– # â€‹ ã€ whistle æŠ“å–æµè§ˆå™¨è¯·æ±‚è®°å½• ã€‘ 2.5 æŠ“å– HTTPS è¯·æ±‚ï¼ˆå¯é€‰ï¼‰æŠ“å– HTTPS è¯·æ±‚ä»…éœ€è¦è¿›è¡Œè¯ä¹¦é…ç½®ï¼Œå…¶ä½™æ­¥éª¤ä¸æŠ“å– HTTP ç›¸åŒã€‚ä»¥ä¸‹ä»‹ç» HTTPS é…ç½®æ–¹æ³• 2.5.1 ä¸‹è½½ whistle è¯ä¹¦ &amp; å¼€å¯æŠ“å– HTTPS è¯·æ±‚ åœ¨ whistle æ§åˆ¶å°ç‚¹å‡» ã€Networkã€‘-ã€ HTTPS ã€‘é€‰é¡¹ï¼Œç‚¹å‡»ä¸‹è½½ CA è¯ä¹¦ï¼Œå¹¶ä¸”å‹¾é€‰æŠ“å– TUNNEL è¯·æ±‚ï¼ˆéƒ¨åˆ†ç‰ˆæœ¬ä¸º HTTPS è¯·æ±‚ï¼‰ï¼Œå¦‚ä¸‹å›¾ â€‹ ã€ whistle é…ç½®å¼€å¯æŠ“å– HTTPS è¯·æ±‚ ã€‘ 2.5.2 ä¿¡ä»» whistle è¯ä¹¦ç”±äº whistle è¯ä¹¦ä¸ºè‡ªç­¾è¯ä¹¦ï¼Œå› æ­¤éœ€è¦é…ç½®æœ¬åœ°æœºå™¨ä¿¡ä»»è¯ä¹¦ï¼Œå¦åˆ™æµè§ˆå™¨ä¼šå› ä¸ºè¯ä¹¦ä¸å®‰å…¨è€Œæ‹¦æˆª whistle ä»£ç†çš„ HTTPS è¯·æ±‚ã€‚ Mac é…ç½®ï¼š æ‰“å¼€ã€é’¥åŒ™ä¸²ã€‘ï¼ˆæˆ–é»˜è®¤æ‰“å¼€ä¸‹è½½çš„è¯ä¹¦ï¼‰ï¼Œå³ä¸Šè§’æœç´¢ whistle è¯ä¹¦ï¼Œç„¶åå³é”®è¯ä¹¦å¼¹å‡ºæ¡†ä¸­é€‰æ‹©ã€æ˜¾ç¤ºç®€ä»‹ã€‘ï¼Œåœ¨ã€ä¿¡ä»»ã€‘-ã€ä½¿ç”¨æ­¤è¯ä¹¦æ—¶ã€‘é€‰æ‹© â€œå§‹ç»ˆä¿¡ä»»â€ å³å¯ï¼Œå¦‚ä¸‹å›¾ â€‹ ã€ Mac ä¿¡ä»» whistle è¯ä¹¦ ã€‘ Windows é…ç½®ï¼š ä¸‹è½½å®Œè¯ä¹¦åï¼ŒåŒå‡»æ‰“å¼€ï¼Œåœ¨å¯¹è¯æ¡†ä¸­ç‚¹å‡»ã€å®‰è£…è¯ä¹¦ã€‘ï¼Œå¹¶å°†è¯ä¹¦å­˜å‚¨åˆ° â€œå—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„â€ï¼Œç¡®è®¤å®Œæˆå³å¯ï¼Œï¼ˆWin10 é…ç½®ï¼‰å¦‚ä¸‹å›¾ â€‹ ã€ Windows10 ä¿¡ä»» whistle è¯ä¹¦ ã€‘ 2.5.3 éªŒè¯æŠ“å– HTTPS è¯·æ±‚å®Œæˆä¸Šè¿°ä¸¤ä¸ªæ­¥éª¤åï¼Œæµè§ˆå™¨å‘èµ· HTTPS è¯·æ±‚ï¼ŒæŸ¥çœ‹ whistle æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°æ­£å¸¸æŠ“å–åˆ° HTTPS è¯·æ±‚ â€‹ ã€ æŠ“å– HTTPS è¯·æ±‚ ã€‘ ä¸‰ã€ä¿®æ”¹è¯·æ±‚å®ä¾‹æ¼”ç¤ºä¿®æ”¹è¯·æ±‚å†…å®¹é€šå¸¸éœ€è¦ç»è¿‡å¦‚ä¸‹è¿‡ç¨‹ï¼š Valuesï¼š values ä¸­å…è®¸è‡ªå®šä¹‰å˜é‡ï¼Œä»¥ä¾›åœ¨å®šä¹‰ä¿®æ”¹åŒ…å†…å®¹æ—¶è¿›è¡Œå¼•ç”¨ã€‚ Rulesï¼š Rules å³å®šä¹‰ä¿®æ”¹åŒ…å†…å®¹è§„åˆ™ã€‚ æ ¹æ®ä¸Šé¢ä¿®æ”¹è¯·æ±‚ã€å“åº”çš„è¿‡ç¨‹ï¼Œä¸‹é¢ç®€å•æ¼”ç¤ºå‡ ç§å¸¸ç”¨ä¿®æ”¹åŒ…å†…å®¹ï¼ˆå®Œæ•´çš„ä¿®æ”¹å†…å®¹æ”¯æŒè¯·å‚è€ƒ whistle æ–‡æ¡£ï¼‰ã€‚ 3.1 ä¿®æ”¹è¯·æ±‚3.1.1 ä¿®æ”¹è¯·æ±‚æ–¹æ³•ä¿®æ”¹è¯·æ±‚æ–¹æ³•æ¨¡å¼å¦‚ä¸‹ pattern method://newMethod 1 å¦‚ kyfw.12306.cn method://post 1 â€‹ ã€ ä¿®æ”¹è¯·æ±‚æ–¹æ³• ã€‘ å¦‚ä¸‹åœ¨æµè§ˆå™¨å‘èµ·è¯·æ±‚æ—¶ï¼Œé€šè¿‡å¼€å‘è€…å·¥å…·æŠ“åŒ…å‘ç°åŸå§‹è¯·æ±‚æ–¹æ³•ä¸º GET â€‹ ã€ æµè§ˆå™¨åŸå§‹è¯·æ±‚æ–¹æ³• ã€‘ è¯·æ±‚ç»è¿‡ whistle ä¿®æ”¹åï¼ŒæŸ¥çœ‹è¯·æ±‚åŒ…å†…å®¹ï¼Œå‘ç°è¯·æ±‚åŒ¹é…æ¨¡å¼ç«™ç‚¹çš„è¯·æ±‚æ–¹æ³•ç”± GET æ”¹ä¸º POSTï¼Œå¦‚ä¸‹å›¾ â€‹ ã€ è¯·æ±‚æ–¹æ³•ç»è¿‡ whistle ä¿®æ”¹ ã€‘ 3.1.2 ä¿®æ”¹è¯·æ±‚å¤´ä¿®æ”¹è¯·æ±‚å¤´æ¨¡å¼å¦‚ä¸‹ pattern reqHeaders://&#123;values&#125; 1 å¦‚ kyfw.12306.cn reqHeaders://&#123;new_headers&#125; 1 å…¶ä¸­å¼•ç”¨åˆ°çš„ values å˜é‡ new_headers å®šä¹‰å¦‚ä¸‹ test-header1: value1upgrade-insecure-requests: 10 1 2 â€‹ ã€ å¤´éƒ¨å¼•ç”¨å˜é‡ new_headers å®šä¹‰ ã€‘ â€‹ ã€ æµè§ˆå™¨åŸå§‹è¯·æ±‚å¤´éƒ¨ ã€‘ å‘èµ·è¯·æ±‚åï¼ŒæŸ¥çœ‹ whistle æŠ“åŒ…å†…å®¹ï¼Œå¯¹åº”å¤´éƒ¨å‘ç”Ÿæ”¹å˜ï¼Œå¦‚ä¸‹å›¾ â€‹ ã€ è¯·æ±‚å¤´éƒ¨ç»è¿‡ whistle ä¿®æ”¹ ã€‘ 3.1.3 ä¿®æ”¹è¯·æ±‚ä½“ä¿®æ”¹è¯·æ±‚ä½“æ¨¡å¼å¦‚ä¸‹ pattern reqBody://&#123;values&#125; 1 å¦‚ kyfw.12306.cn reqBody://&#123;new_reqBody&#125; 1 å¼•ç”¨å˜é‡ new_reqBody å®šä¹‰å¦‚ä¸‹ my new reqbody 1 å‘èµ·è¯·æ±‚åï¼ŒæŠ“èµ·æµè§ˆå™¨åŸå§‹è¯·æ±‚å¦‚ä¸‹ â€‹ ã€ æµè§ˆå™¨åŸå§‹æ—  body è¯·æ±‚åŒ… ã€‘ whistle æŠ“å–ç»ä¿®æ”¹åè¯·æ±‚åŒ…å†…å®¹å¦‚ä¸‹ â€‹ ã€ body ç»è¿‡ whistle ä¿®æ”¹è¯·æ±‚åŒ… ã€‘ 3.2 ä¿®æ”¹å“åº”3.2.1 ä¿®æ”¹å“åº”çŠ¶æ€ç ä¿®æ”¹å“åº”çŠ¶æ€ç æ¨¡å¼å¦‚ä¸‹ pattern statusCode://code 1 æˆ– pattern replaceStatus://code 1 ä¸¤è€…åŒºåˆ«ä¸ºï¼Œè®¾ç½® statusCode åä¸å†å‘é€è¯·æ±‚ï¼Œç›´æ¥è¿”å›è®¾ç½®çš„çŠ¶æ€ç ï¼›è€Œ replaceStatus ç»§ç»­è¿›è¡Œè¯·æ±‚ï¼Œå¹¶å¯¹å“åº”çš„çŠ¶æ€ç è¿›è¡Œæ›¿æ¢ã€‚ä¸‹é¢ä»¥ statusCode ä¸ºä¾‹ï¼Œå¦‚ kyfw.12306.cn statusCode://500 1 ä¿®æ”¹çŠ¶æ€ç åï¼ŒæŸ¥çœ‹ whistle åŠæµè§ˆå™¨åŒ…å†…å®¹å‡æ˜¾ç¤ºä¸ºä¿®æ”¹çš„çŠ¶æ€ç  â€‹ ã€ whistle æŠ“å–ä¿®æ”¹å“åº”çŠ¶æ€ç è¯·æ±‚åŒ… ã€‘ â€‹ ã€ æµè§ˆå™¨æŠ“å–åŸå§‹è¯·æ±‚åŒ… ã€‘ 3.2.2 ä¿®æ”¹å“åº”å¤´éƒ¨ä¿®æ”¹è¯·æ±‚ä½“æ¨¡å¼å¦‚ä¸‹ pattern resHeaders://&#123;values&#125; 1 å¦‚ kyfw.12306.cn resHeaders://&#123;new_resHeaders&#125; 1 å¼•ç”¨å˜é‡ new_resHeaders å®šä¹‰å¦‚ä¸‹ test-res-header: felix-test 1 â€‹ ã€ è‡ªå®šä¹‰å“åº”å¤´éƒ¨å¼•ç”¨å˜é‡ new_resHeaders å®šä¹‰ ã€‘ æŠ“å–è¯·æ±‚å†…å®¹ï¼Œå“åº”å¤´éƒ¨ä¸­åŒ…å« whistle ä¿®æ”¹çš„å†…å®¹ â€‹ ã€ å“åº”å¤´éƒ¨åŒ…å« whistle ä¿®æ”¹å†…å®¹ ã€‘ 3.2.3 ä¿®æ”¹å“åº”ä½“ä¿®æ”¹è¯·æ±‚ä½“æ¨¡å¼å¦‚ä¸‹ pattern resBody://&#123;values&#125; 1 å¦‚ kyfw.12306.cn resBody://&#123;new_resBody&#125; 1 å¼•ç”¨å˜é‡ new_resBody å®šä¹‰å¦‚ä¸‹ my response body 1 â€‹ ã€ è‡ªå®šä¹‰å“åº”ä½“å¼•ç”¨å˜é‡ new_resBody å®šä¹‰ ã€‘ å‘èµ·è¯·æ±‚åæŠ“å–è¯·æ±‚åŒ…å†…å®¹ï¼Œå‘ç°æ¥å£åˆ°å“åº” body ä¸ºä¿®æ”¹åçš„å†…å®¹ â€‹ ã€ è¯·æ±‚å“åº”ä½“ä¸º whistle ä¿®æ”¹å†…å®¹ ã€‘ å››ã€æ€»ç»“ è·¨å¹³å°æ€§ å¾—ç›Šäº Node.js çš„è·¨å¹³å°æ€§ï¼Œwhistle åœ¨ Windowsã€Macã€Linux å‡å¯ä»¥è¿è¡Œï¼Œç›¸æ¯”äº Fiddlerã€Charles ç­‰å®¢æˆ·ç«¯å·¥å…·è€Œè¨€ï¼Œæœ‰æ›´å¥½çš„ç³»ç»Ÿå…¼å®¹æ€§ï¼Œé™ä½äº†ä½¿ç”¨è€…åœ¨ä¸åŒç³»ç»Ÿé—´çš„å­¦ä¹ å’Œä½¿ç”¨æˆæœ¬ï¼Œæ»¡è¶³ç”¨æˆ·ä¸€ä¸ªå·¥å…·æ‰“å¤©ä¸‹çš„éœ€æ±‚ã€‚ ä½¿ç”¨ç®€å• whistle æ‰€æœ‰å®‰è£…é…ç½®å·¥ä½œå¯åœ¨ 5 åˆ†é’Ÿä¹‹å†…å®Œæˆï¼ˆä¸è€ƒè™‘ç½‘ç»œä¸‹è½½ç­‰å› ç´ å½±å“ï¼‰ï¼ŒåŒæ—¶ whistle å…·å¤‡è¯¦ç»†çš„å¸®åŠ©è¯´æ˜æ–‡æ¡£ï¼Œæå¤§é™ä½äº†ç”¨æˆ·ä¸Šæ‰‹çš„é—¨æ§›ï¼Œå¯¹åˆå­¦è€…éå¸¸å‹å¥½ã€‚ è½¬è½½whistle ä½¿ç”¨æŒ‡å—","updated":"2025-08-02T05:46:04.180Z","tags":[{"name":"tool","slug":"tool","permalink":"https://luckyship.github.io/tags/tool/"}]},{"title":"ä½¿ç”¨jsé€‰ä¸­å…ƒç´ ï¼Œç§»åŠ¨å…‰æ ‡","date":"2022-09-22T01:58:25.000Z","path":"2022/09/22/2022-09-22-js-selection/","text":"// åˆ é™¤ä¹‹å‰æ‰€æœ‰çš„é€‰åŒºwindow.getSelection().removeAllRanges();let selection = window.getSelection();let range = document.createRange();range.selectNode(ele); // éœ€è¦é€‰ä¸­çš„elementselection.addRange(range); å¦‚æœéœ€è¦ç§»åŠ¨å…‰æ ‡ï¼Œå¯ä»¥ä½¿ç”¨: selection.collapseToEnd();selection.collapseToStart(); å¦‚æœéœ€è¦é€‰ä¸­æ‰€æœ‰å­å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨: selection.selectAllChildren(ele);","updated":"2025-08-02T05:46:04.180Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"Vuexæ ¸å¿ƒåŸç†","date":"2022-07-16T07:08:31.000Z","path":"2022/07/16/2022-07-16-vuex-theory/","text":"ä¸€ã€æ ¸å¿ƒåŸç† Vuex æœ¬è´¨æ˜¯ä¸€ä¸ªå¯¹è±¡ Vuex å¯¹è±¡æœ‰ä¸¤ä¸ªå±æ€§ï¼Œä¸€ä¸ªæ˜¯ install æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯ Store è¿™ä¸ªç±» install æ–¹æ³•çš„ä½œç”¨æ˜¯å°† store è¿™ä¸ªå®ä¾‹æŒ‚è½½åˆ°æ‰€æœ‰çš„ç»„ä»¶ä¸Šï¼Œæ³¨æ„æ˜¯åŒä¸€ä¸ª store å®ä¾‹ã€‚ Store è¿™ä¸ªç±»æ‹¥æœ‰ commitï¼Œdispatch è¿™äº›æ–¹æ³•ï¼ŒStore ç±»é‡Œå°†ç”¨æˆ·ä¼ å…¥çš„ state åŒ…è£…æˆ dataï¼Œä½œä¸º new Vue çš„å‚æ•°ï¼Œä»è€Œå®ç°äº† state å€¼çš„å“åº”å¼ã€‚ äºŒã€åŸºæœ¬å‡†å¤‡å·¥ä½œæˆ‘ä»¬å…ˆåˆ©ç”¨ vue-cli å»ºä¸€ä¸ªé¡¹ç›® åˆ é™¤ä¸€äº›ä¸å¿…è¦çš„ç»„å»ºåé¡¹ç›®ç›®å½•æš‚æ—¶å¦‚ä¸‹ï¼š å·²ç»æŠŠé¡¹ç›®æ”¾åˆ° githubï¼šgithub.com/Sunny-luckiâ€¦ å¯ä»¥å‘å¾®åœ°è¦ä¸ª star å—ã€‚æœ‰ä»€ä¹ˆä¸ç†è§£çš„æˆ–è€…æ˜¯å»ºè®®æ¬¢è¿è¯„è®ºæå‡º æˆ‘ä»¬ä¸»è¦çœ‹ä¸‹ App.vue,main.js,store/index.js ä»£ç å¦‚ä¸‹: App.vue &lt;template&gt; &lt;div id=&quot;app&quot;&gt; 123 &lt;/div&gt;&lt;/template&gt; store/index.js import Vue from &quot;vue&quot;;import Vuex from &quot;vuex&quot;;Vue.use(Vuex);export default new Vuex.Store(&#123; state: &#123;&#125;, mutations: &#123;&#125;, actions: &#123;&#125;, modules: &#123;&#125;,&#125;); main.js import Vue from &quot;vue&quot;;import App from &quot;./App.vue&quot;;import store from &quot;./store&quot;;Vue.config.productionTip = false;new Vue(&#123; store, render: (h) =&gt; h(App),&#125;).$mount(&quot;#app&quot;); ç°åœ¨æˆ‘ä»¬å¯åŠ¨ä¸€ä¸‹é¡¹ç›®ã€‚çœ‹çœ‹é¡¹ç›®åˆå§‹åŒ–æœ‰æ²¡æœ‰æˆåŠŸã€‚ okï¼Œæ²¡æ¯›ç—…ï¼Œåˆå§‹åŒ–æˆåŠŸã€‚ ç°åœ¨æˆ‘ä»¬å†³å®šåˆ›å»ºè‡ªå·±çš„ Vuexï¼Œäºæ˜¯åˆ›å»º myVuex.js æ–‡ä»¶ ç›®å‰ç›®å½•å¦‚ä¸‹ å†å°† Vuex å¼•å…¥ æ”¹æˆæˆ‘ä»¬çš„ myVuex //store/index.jsimport Vue from &quot;vue&quot;;import Vuex from &quot;./myVuex&quot;; //ä¿®æ”¹ä»£ç Vue.use(Vuex);export default new Vuex.Store(&#123; state: &#123;&#125;, mutations: &#123;&#125;, actions: &#123;&#125;, modules: &#123;&#125;,&#125;); ä¸‰ã€å‰–æ Vuex æœ¬è´¨å…ˆæŠ›å‡ºä¸ªé—®é¢˜ï¼ŒVue é¡¹ç›®ä¸­æ˜¯æ€ä¹ˆå¼•å…¥ Vuexã€‚ å®‰è£… Vuexï¼Œå†é€šè¿‡import Vuex from &#39;vuex&#39;å¼•å…¥ å…ˆ var store = new Vuex.Store({â€¦}),å†æŠŠ store ä½œä¸ºå‚æ•°çš„ä¸€ä¸ªå±æ€§å€¼ï¼Œnew Vue({store}) é€šè¿‡ Vue.use(Vuex) ä½¿å¾—æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥æ‹¥æœ‰ store å®ä¾‹ ä»è¿™ä¸ªå¼•å…¥è¿‡ç¨‹æˆ‘ä»¬å¯ä»¥å‘ç°ä»€ä¹ˆï¼Ÿ æˆ‘ä»¬æ˜¯é€šè¿‡ new Vuex.store({})è·å¾—ä¸€ä¸ª store å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¼•å…¥çš„ Vuex ä¸­æœ‰ Store è¿™ä¸ªç±»ä½œä¸º Vuex å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚å› ä¸ºé€šè¿‡ import å¼•å…¥çš„ï¼Œå®è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªå¯¼å‡ºä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆæ­¥å‡è®¾ Class Store&#123;&#125;let Vuex = &#123; Store&#125; æˆ‘ä»¬è¿˜ä½¿ç”¨äº† Vue.use(),è€Œ Vue.use çš„ä¸€ä¸ªåŸåˆ™å°±æ˜¯æ‰§è¡Œå¯¹è±¡çš„ install è¿™ä¸ªæ–¹æ³• æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å†ä¸€æ­¥ å‡è®¾ Vuex æœ‰æœ‰ install è¿™ä¸ªæ–¹æ³•ã€‚ class Store &#123;&#125;let install = function () &#123;&#125;;let Vuex = &#123; Store, install,&#125;; åˆ°è¿™é‡Œï¼Œä½ èƒ½å¤§æ¦‚åœ°å°† Vuex å†™å‡ºæ¥å—ï¼Ÿ å¾ˆç®€å•ï¼Œå°±æ˜¯å°†ä¸Šé¢çš„ Vuex å¯¹è±¡å¯¼å‡ºï¼Œå¦‚ä¸‹å°±æ˜¯ myVuex.js //myVuex.jsclass Store &#123;&#125;let install = function () &#123;&#125;;let Vuex = &#123; Store, install,&#125;;export default Vuex; æˆ‘ä»¬æ‰§è¡Œä¸‹é¡¹ç›®ï¼Œå¦‚æœæ²¡æŠ¥é”™ï¼Œè¯´æ˜æˆ‘ä»¬çš„å‡è®¾æ²¡æ¯›ç—…ã€‚ å¤©å•Šï¼Œæ²¡æŠ¥é”™ã€‚æ²¡æ¯›ç—…ï¼ å››ã€åˆ†æ Vue.useVue.use(plugin); ï¼ˆ1ï¼‰å‚æ•° &#123; Object | Function;&#125;plugin; ï¼ˆ2ï¼‰ç”¨æ³• å®‰è£… Vue.js æ’ä»¶ã€‚å¦‚æœæ’ä»¶æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¿…é¡»æä¾› install æ–¹æ³•ã€‚å¦‚æœæ’ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä¼šè¢«ä½œä¸º install æ–¹æ³•ã€‚è°ƒç”¨ install æ–¹æ³•æ—¶ï¼Œä¼šå°† Vue ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚install æ–¹æ³•è¢«åŒä¸€ä¸ªæ’ä»¶å¤šæ¬¡è°ƒç”¨æ—¶ï¼Œæ’ä»¶ä¹Ÿåªä¼šè¢«å®‰è£…ä¸€æ¬¡ã€‚ ï¼ˆ3ï¼‰ä½œç”¨ æ³¨å†Œæ’ä»¶ï¼Œæ­¤æ—¶åªéœ€è¦è°ƒç”¨ install æ–¹æ³•å¹¶å°† Vue ä½œä¸ºå‚æ•°ä¼ å…¥å³å¯ã€‚ä½†åœ¨ç»†èŠ‚ä¸Šæœ‰ä¸¤éƒ¨åˆ†é€»è¾‘è¦å¤„ç†ï¼š 1ã€æ’ä»¶çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯ install æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å« install æ–¹æ³•çš„å¯¹è±¡ã€‚ 2ã€æ’ä»¶åªèƒ½è¢«å®‰è£…ä¸€æ¬¡ï¼Œä¿è¯æ’ä»¶åˆ—è¡¨ä¸­ä¸èƒ½æœ‰é‡å¤çš„æ’ä»¶ã€‚ ï¼ˆ4ï¼‰å®ç° Vue.use = function (plugin) &#123; const installedPlugins = this._installedPlugins || (this._installedPlugins = []); if (installedPlugins.indexOf(plugin) &gt; -1) &#123; return this; &#125; // &lt;!-- å…¶ä»–å‚æ•° --&gt; const args = toArray(arguments, 1); args.unshift(this); if (typeof plugin.install === &quot;function&quot;) &#123; plugin.install.apply(plugin, args); &#125; else if (typeof plugin === &quot;function&quot;) &#123; plugin.apply(null, plugin, args); &#125; installedPlugins.push(plugin); return this;&#125;; 1ã€åœ¨ Vue.js ä¸Šæ–°å¢äº† use æ–¹æ³•ï¼Œå¹¶æ¥æ”¶ä¸€ä¸ªå‚æ•° pluginã€‚ 2ã€é¦–å…ˆåˆ¤æ–­æ’ä»¶æ˜¯ä¸æ˜¯å·²ç»åˆ«æ³¨å†Œè¿‡ï¼Œå¦‚æœè¢«æ³¨å†Œè¿‡ï¼Œåˆ™ç›´æ¥ç»ˆæ­¢æ–¹æ³•æ‰§è¡Œï¼Œæ­¤æ—¶åªéœ€è¦ä½¿ç”¨ indexOf æ–¹æ³•å³å¯ã€‚ 3ã€toArray æ–¹æ³•æˆ‘ä»¬åœ¨å°±æ˜¯å°†ç±»æ•°ç»„è½¬æˆçœŸæ­£çš„æ•°ç»„ã€‚ä½¿ç”¨ toArray æ–¹æ³•å¾—åˆ° argumentsã€‚é™¤äº†ç¬¬ä¸€ä¸ªå‚æ•°ä¹‹å¤–ï¼Œå‰©ä½™çš„æ‰€æœ‰å‚æ•°å°†å¾—åˆ°çš„åˆ—è¡¨èµ‹å€¼ç»™ argsï¼Œç„¶åå°† Vue æ·»åŠ åˆ° args åˆ—è¡¨çš„æœ€å‰é¢ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¿è¯ install æ–¹æ³•è¢«æ‰§è¡Œæ—¶ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ Vueï¼Œå…¶ä½™å‚æ•°æ˜¯æ³¨å†Œæ’ä»¶æ—¶ä¼ å…¥çš„å‚æ•°ã€‚ 4ã€ç”±äº plugin å‚æ•°æ”¯æŒå¯¹è±¡å’Œå‡½æ•°ç±»å‹ï¼Œæ‰€ä»¥é€šè¿‡åˆ¤æ–­ plugin.install å’Œ plugin å“ªä¸ªæ˜¯å‡½æ•°ï¼Œå³å¯çŸ¥ç”¨æˆ·ä½¿ç”¨å“ªç§æ–¹å¼ç¥–å†Œçš„æ’ä»¶ï¼Œç„¶åæ‰§è¡Œç”¨æˆ·ç¼–å†™çš„æ’ä»¶å¹¶å°† args ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚ 5ã€æœ€åï¼Œå°†æ’ä»¶æ·»åŠ åˆ° installedPlugins ä¸­ï¼Œä¿è¯ç›¸åŒçš„æ’ä»¶ä¸ä¼šåå¤è¢«æ³¨å†Œã€‚(~~è®©æˆ‘æƒ³èµ·äº†æ›¾ç»é¢è¯•å®˜é—®æˆ‘ä¸ºä»€ä¹ˆæ’ä»¶ä¸ä¼šè¢«é‡æ–°åŠ è½½ï¼ï¼ï¼å“­å”§å”§ï¼Œç°åœ¨æ€»ç®—æ˜ç™½äº†) äº”ã€å®Œå–„ install æ–¹æ³•æˆ‘ä»¬å‰é¢æåˆ° é€šè¿‡ Vue.use(Vuex) ä½¿å¾—æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥æ‹¥æœ‰ store å®ä¾‹ã€‚ è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿï¼Ÿï¼Ÿ æ¥çœ‹ mian.js import Vue from &quot;vue&quot;;import App from &quot;./App.vue&quot;;import store from &quot;./store&quot;;Vue.config.productionTip = false;new Vue(&#123; store, render: (h) =&gt; h(App),&#125;).$mount(&quot;#app&quot;); æˆ‘ä»¬å¯ä»¥å‘ç°è¿™é‡Œåªæ˜¯å°† store ï¼Œä¹Ÿå°±æ˜¯ store/index.js å¯¼å‡ºçš„ store å®ä¾‹ï¼Œä½œä¸º Vue å‚æ•°çš„ä¸€éƒ¨åˆ†ã€‚ ä½†æ˜¯è¿™é‡Œå°±æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜å’¯ï¼Œè¿™é‡Œçš„ Vue æ˜¯æ ¹ç»„ä»¶å•Šã€‚ä¹Ÿå°±æ˜¯è¯´ç›®å‰åªæœ‰æ ¹ç»„ä»¶æœ‰è¿™ä¸ª store å€¼ï¼Œè€Œå…¶ä»–ç»„ä»¶æ˜¯è¿˜æ²¡æœ‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è®©å…¶ä»–ç»„ä»¶ä¹Ÿæ‹¥æœ‰è¿™ä¸ª storeã€‚ å› æ­¤ï¼Œinstall æ–¹æ³•æˆ‘ä»¬å¯ä»¥è¿™æ ·å®Œå–„ let install = function (Vue) &#123; Vue.mixin(&#123; beforeCreate() &#123; if (this.$options &amp;&amp; this.$options.store) &#123; // å¦‚æœæ˜¯æ ¹ç»„ä»¶ this.$store = this.$options.store; &#125; else &#123; //å¦‚æœæ˜¯å­ç»„ä»¶ this.$store = this.$parent &amp;&amp; this.$parent.$store; &#125; &#125;, &#125;);&#125;; è§£é‡Šä¸‹ä»£ç ï¼š å‚æ•° Vueï¼Œæˆ‘ä»¬åœ¨ç¬¬å››å°èŠ‚åˆ†æ Vue.use çš„æ—¶å€™ï¼Œå†æ‰§è¡Œ install çš„æ—¶å€™ï¼Œå°† Vue ä½œä¸ºå‚æ•°ä¼ è¿›å»ã€‚ mixin çš„ä½œç”¨æ˜¯å°† mixin çš„å†…å®¹æ··åˆåˆ° Vue çš„åˆå§‹å‚æ•° options ä¸­ã€‚ç›¸ä¿¡ä½¿ç”¨ vue çš„åŒå­¦åº”è¯¥ä½¿ç”¨è¿‡ mixin äº†ã€‚ ä¸ºä»€ä¹ˆæ˜¯ beforeCreate è€Œä¸æ˜¯ created å‘¢ï¼Ÿå› ä¸ºå¦‚æœæ˜¯åœ¨ created æ“ä½œçš„è¯ï¼Œ$optionså·²ç»åˆå§‹åŒ–å¥½äº†ã€‚ å¦‚æœåˆ¤æ–­å½“å‰ç»„ä»¶æ˜¯æ ¹ç»„ä»¶çš„è¯ï¼Œå°±å°†æˆ‘ä»¬ä¼ å…¥çš„ store æŒ‚åœ¨åˆ°æ ¹ç»„ä»¶å®ä¾‹ä¸Šï¼Œå±æ€§åä¸º$storeã€‚ å¦‚æœåˆ¤æ–­å½“å‰ç»„ä»¶æ˜¯å­ç»„ä»¶çš„è¯ï¼Œå°±å°†æˆ‘ä»¬æ ¹ç»„ä»¶çš„$storeä¹Ÿå¤åˆ¶ç»™å­ç»„ä»¶ã€‚æ³¨æ„æ˜¯å¼•ç”¨çš„å¤åˆ¶ï¼Œå› æ­¤æ¯ä¸ªç»„ä»¶éƒ½æ‹¥æœ‰äº†åŒä¸€ä¸ª$storeæŒ‚è½½åœ¨å®ƒèº«ä¸Šã€‚ è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆåˆ¤æ–­å½“å‰ç»„ä»¶æ˜¯å­ç»„ä»¶ï¼Œå°±å¯ä»¥ç›´æ¥ä»çˆ¶ç»„ä»¶æ‹¿åˆ°$storeå‘¢ï¼Ÿè¿™è®©æˆ‘æƒ³èµ·äº†æ›¾ç»ä¸€ä¸ªé¢è¯•å®˜é—®æˆ‘çš„é—®é¢˜ï¼šçˆ¶ç»„ä»¶å’Œå­ç»„ä»¶çš„æ‰§è¡Œé¡ºåºï¼Ÿ Aï¼šçˆ¶ beforeCreate-&gt; çˆ¶ created -&gt; çˆ¶ beforeMounte -&gt; å­ beforeCreate -&gt;å­ create -&gt;å­ beforeMount -&gt;å­ mounted -&gt; çˆ¶ mounted å¯ä»¥å¾—åˆ°ï¼Œåœ¨æ‰§è¡Œå­ç»„ä»¶çš„ beforeCreate çš„æ—¶å€™ï¼Œçˆ¶ç»„ä»¶å·²ç»æ‰§è¡Œå®Œ beforeCreate äº†ï¼Œé‚£ç†æ‰€å½“ç„¶çˆ¶ç»„ä»¶å·²ç»æœ‰$storeäº†ã€‚ å…­ã€å®ç° Vuex çš„ state&lt;p&gt;&#123;&#123;this.$store.state.num&#125;&#125;&lt;/p&gt; æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ª è¯­å¥è·å¾— state çš„å€¼ ä½†æ˜¯æˆ‘ä»¬åœ¨ Store ç±»é‡Œè¿˜æ²¡å®ç°ï¼Œæ˜¾ç„¶ï¼Œç°åœ¨å°±è¿™æ ·å–å¾—è¯è‚¯å®šæŠ¥é”™ã€‚ å‰é¢è®²è¿‡ï¼Œæˆ‘ä»¬æ˜¯è¿™æ ·ä½¿ç”¨ Store çš„ export default new Vuex.Store(&#123; state: &#123; num: 0, &#125;, mutations: &#123;&#125;, actions: &#123;&#125;, modules: &#123;&#125;,&#125;); ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªå¯¹è±¡ &#123; state: &#123; num: 0; &#125; , mutations: &#123; &#125; , actions: &#123; &#125; , modules: &#123; &#125;&#125; å½“ä½œå‚æ•°äº†ã€‚ é‚£æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ Class Store é‡Œï¼Œè·å–è¿™ä¸ªå¯¹è±¡ class Store &#123; constructor(options) &#123; this.state = options.state || &#123;&#125;; &#125;&#125; é‚£è¿™æ ·æ˜¯ä¸æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨äº†å‘¢ï¼Ÿ è¯•ä¸€ä¸‹å‘—ï¼ //App.vue&lt;template&gt; &lt;div id=&quot;app&quot;&gt; 123 &lt;p&gt;&#123;&#123;this.$store.state.num&#125;&#125;&lt;/p&gt; &lt;/div&gt;&lt;/template&gt; è¿è¡Œç»“æœï¼š å¤ªèµäº†å§ï¼Œæ€ä¹ˆä¼šè¿™ä¹ˆç®€å•ã€‚ã€‚ã€‚ä¸æ•¢ç›¸ä¿¡ã€‚ å“¦ä¸ï¼Œå½“ç„¶æ²¡æœ‰è¿™ä¹ˆç®€å•ï¼Œæˆ‘ä»¬å¿½ç•¥äº†ä¸€ç‚¹ï¼Œstate é‡Œçš„å€¼ä¹Ÿæ˜¯å“åº”å¼çš„å“¦ï¼Œæˆ‘ä»¬è¿™æ ·å¯æ²¡æœ‰å®ç°å“åº”å¼ã€‚ æ›¾ç»é¢è¯•å®˜é—®æˆ‘ Vuex å’Œå…¨å±€å˜é‡æ¯”æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚è¿™ä¸€ç‚¹å°±æ˜¯æ³¨æ„åŒºåˆ«å§ é‚£è¦æ€ä¹ˆå®ç°å“åº”å¼å‘¢ï¼Ÿ æˆ‘ä»¬çŸ¥é“ï¼Œæˆ‘ä»¬ new Vueï¼ˆï¼‰çš„æ—¶å€™ï¼Œä¼ å…¥çš„ data æ˜¯å“åº”å¼çš„ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ new ä¸€ä¸ª Vueï¼Œç„¶åæŠŠ state å½“ä½œ data ä¼ å…¥å‘¢ï¼Ÿ æ²¡æœ‰é”™ï¼Œå°±æ˜¯è¿™æ ·ã€‚ class Store &#123; constructor(options) &#123; this.vm = new Vue(&#123; data: &#123; state: options.state, &#125;, &#125;); &#125;&#125; ç°åœ¨æ˜¯å®ç°å“åº”å¼äº†ï¼Œä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆè·å¾— state å‘¢ï¼Ÿå¥½åƒåªèƒ½é€šè¿‡this.$store.vm.stateäº†ï¼Ÿä½†æ˜¯è·Ÿæˆ‘ä»¬å¹³æ—¶ç”¨çš„æ—¶å€™ä¸ä¸€æ ·ï¼Œæ‰€ä»¥ï¼Œæ˜¯éœ€è¦è½¬åŒ–ä¸‹çš„ã€‚ æˆ‘ä»¬å¯ä»¥ç»™ Store ç±»æ·»åŠ ä¸€ä¸ª state å±æ€§ã€‚è¿™ä¸ªå±æ€§è‡ªåŠ¨è§¦å‘ get æ¥å£ã€‚ class Store &#123; constructor(options) &#123; this.vm = new Vue(&#123; data: &#123; state: options.state, &#125;, &#125;); &#125; //æ–°å¢ä»£ç  get state() &#123; return this.vm.state; &#125;&#125; è¿™æ˜¯ ES6ï¼Œçš„è¯­æ³•ï¼Œæœ‰ç‚¹ç±»ä¼¼äº Object.defineProperty çš„ get æ¥å£ æˆåŠŸå®ç°ã€‚ ä¸ƒã€å®ç° getter//myVuex.jsclass Store &#123; constructor(options) &#123; this.vm = new Vue(&#123; data: &#123; state: options.state, &#125;, &#125;); // æ–°å¢ä»£ç  let getters = options.getter || &#123;&#125;; this.getters = &#123;&#125;; Object.keys(getters).forEach((getterName) =&gt; &#123; Object.defineProperty(this.getters, getterName, &#123; get: () =&gt; &#123; return getters[getterName](this.state); &#125;, &#125;); &#125;); &#125; get state() &#123; return this.vm.state; &#125;&#125; æˆ‘ä»¬æŠŠç”¨æˆ·ä¼ è¿›æ¥çš„ getter ä¿å­˜åˆ° getters æ•°ç»„é‡Œã€‚ æœ€æœ‰æ„æ€çš„æ˜¯ç»å¸¸ä¼šæœ‰é¢è¯•é¢˜é—®ï¼šä¸ºä»€ä¹ˆç”¨ getter çš„æ—¶å€™ä¸ç”¨å†™æ‹¬å·ã€‚è¦ä¸æ˜¯æˆ‘å­¦åˆ°è¿™ä¸ªæ‰‹å†™ Vuexï¼Œä¹Ÿä¸ä¼šæƒ³ä¸æ˜ç™½ï¼ŒåŸæ¥è¿™ä¸ªé—®é¢˜å°±åƒé—®æˆ‘ä»¬å¹³æ—¶å†™ä¸ªå˜é‡ï¼Œä¸ºä»€ä¹ˆä¸ç”¨æ‹¬å·ä¸€æ ·ã€‚ï¼ˆå¦‚&#123;&#123;num&#125;&#125;,è€Œä¸æ˜¯&#123;&#123;num()&#125;&#125;ï¼‰ åŸæ¥å°±æ˜¯åˆ©ç”¨äº† Object.defineProperty çš„ get æ¥å£ã€‚ okï¼Œç°åœ¨æ¥è¯•ä¸€ä¸‹ï¼Œgetter å¯ä¸å¯ä»¥ä½¿ç”¨ã€‚ //store/index.jsimport Vue from &quot;vue&quot;;import Vuex from &quot;./myVuex&quot;;Vue.use(Vuex);export default new Vuex.Store(&#123; state: &#123; num: 0, &#125;, // æ–°å¢æµ‹è¯•ä»£ç  getter: &#123; getNum: (state) =&gt; &#123; return state.num; &#125;, &#125;, mutations: &#123;&#125;, actions: &#123;&#125;,&#125;); &lt;template&gt; &lt;div id=&quot;app&quot;&gt; 123 &lt;p&gt;stateï¼š&#123;&#123;this.$store.state.num&#125;&#125;&lt;/p&gt; &lt;p&gt;getter:&#123;&#123;this.$store.getters.getNum&#125;&#125;&lt;/p&gt; &lt;/div&gt;&lt;/template&gt; å®Œç¾ã€‚æ¯«æ— äº‹æ•…ã€‚ å…«ã€å®ç° mutation//myVuex.jsclass Store &#123; constructor(options) &#123; this.vm = new Vue(&#123; data: &#123; state: options.state, &#125;, &#125;); let getters = options.getter || &#123;&#125;; this.getters = &#123;&#125;; Object.keys(getters).forEach((getterName) =&gt; &#123; Object.defineProperty(this.getters, getterName, &#123; get: () =&gt; &#123; return getters[getterName](this.state); &#125;, &#125;); &#125;); //æ–°å¢ä»£ç  let mutations = options.mutations || &#123;&#125;; this.mutations = &#123;&#125;; Object.keys(mutations).forEach((mutationName) =&gt; &#123; this.mutations[mutationName] = (arg) =&gt; &#123; mutations[mutationName](this.state, arg); &#125;; &#125;); &#125; get state() &#123; return this.vm.state; &#125;&#125; mutations è·Ÿ getter ä¸€æ ·ï¼Œè¿˜æ˜¯ç”¨ mutations å¯¹è±¡å°†ç”¨æˆ·ä¼ å…¥çš„ mutations å­˜å‚¨èµ·æ¥ã€‚ ä½†æ˜¯æ€ä¹ˆè§¦å‘å‘¢ï¼Ÿå›å¿†ä¸€ä¸‹ï¼Œæˆ‘ä»¬æ˜¯æ€ä¹ˆè§¦å‘ mutations çš„ã€‚ this.$store.commit(&#x27;incre&#x27;,1) å¯¹ï¼Œæ˜¯è¿™ç§å½¢å¼çš„ã€‚å¯ä»¥çœ‹å‡º store å¯¹è±¡æœ‰ commit è¿™ä¸ªæ–¹æ³•ã€‚è€Œ commit æ–¹æ³•è§¦å‘äº† mutations å¯¹è±¡ä¸­çš„æŸä¸ªå¯¹åº”çš„æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç»™ Store ç±»æ·»åŠ  commit æ–¹æ³• //myVuex.jsclass Store &#123; constructor(options) &#123; this.vm = new Vue(&#123; data: &#123; state: options.state, &#125;, &#125;); let getters = options.getter || &#123;&#125;; this.getters = &#123;&#125;; Object.keys(getters).forEach((getterName) =&gt; &#123; Object.defineProperty(this.getters, getterName, &#123; get: () =&gt; &#123; return getters[getterName](this.state); &#125;, &#125;); &#125;); let mutations = options.mutations || &#123;&#125;; this.mutations = &#123;&#125;; Object.keys(mutations).forEach((mutationName) =&gt; &#123; this.mutations[mutationName] = (arg) =&gt; &#123; mutations[mutationName](this.state, arg); &#125;; &#125;); &#125; //æ–°å¢ä»£ç  commit(method, arg) &#123; this.mutations[method](arg); &#125; get state() &#123; return this.vm.state; &#125;&#125; å¥½äº†ï¼Œç°åœ¨æ¥æµ‹è¯•ä¸€ä¸‹ã€‚ &lt;template&gt; &lt;div id=&quot;app&quot;&gt; 123 &lt;p&gt;state:&#123;&#123;this.$store.state.num&#125;&#125;&lt;/p&gt; &lt;p&gt;getter:&#123;&#123;this.$store.getters.getNum&#125;&#125;&lt;/p&gt; &lt;button @click=&quot;add&quot;&gt;+1&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;//æ–°å¢æµ‹è¯•ä»£ç &lt;script&gt; export default &#123; methods:&#123; add()&#123; this.$store.commit(&#x27;incre&#x27;,1) &#125; &#125; &#125;&lt;/script&gt; store/index.js //store/index.jsimport Vue from &quot;vue&quot;;import Vuex from &quot;./myVuex&quot;;Vue.use(Vuex);export default new Vuex.Store(&#123; state: &#123; num: 0, &#125;, getter: &#123; getNum: (state) =&gt; &#123; return state.num; &#125;, &#125;, // æ–°å¢æµ‹è¯•ä»£ç  mutations: &#123; incre(state, arg) &#123; state.num += arg; &#125;, &#125;, actions: &#123;&#125;,&#125;); è¿è¡ŒæˆåŠŸã€‚ ä¹ã€å®ç° actionså½“ä¼šå®ç° mutations åï¼Œé‚£ actions çš„å®ç°ä¹Ÿå¾ˆç®€å•ï¼Œå¾ˆç±»ä¼¼ï¼Œä¸ä¿¡çœ‹ä»£ç ï¼š //myVuex.jsclass Store &#123; constructor(options) &#123; this.vm = new Vue(&#123; data: &#123; state: options.state, &#125;, &#125;); let getters = options.getter || &#123;&#125;; this.getters = &#123;&#125;; Object.keys(getters).forEach((getterName) =&gt; &#123; Object.defineProperty(this.getters, getterName, &#123; get: () =&gt; &#123; return getters[getterName](this.state); &#125;, &#125;); &#125;); let mutations = options.mutations || &#123;&#125;; this.mutations = &#123;&#125;; Object.keys(mutations).forEach((mutationName) =&gt; &#123; this.mutations[mutationName] = (arg) =&gt; &#123; mutations[mutationName](this.state, arg); &#125;; &#125;); //æ–°å¢ä»£ç  let actions = options.actions; this.actions = &#123;&#125;; Object.keys(actions).forEach((actionName) =&gt; &#123; this.actions[actionName] = (arg) =&gt; &#123; actions[actionName](this, arg); &#125;; &#125;); &#125; // æ–°å¢ä»£ç  dispatch(method, arg) &#123; this.actions[method](arg); &#125; commit(method, arg) &#123; console.log(this); this.mutations[method](arg); &#125; get state() &#123; return this.vm.state; &#125;&#125; ä¸€æ¯›ä¸€æ ·ï¼Œä¸è¿‡æœ‰ä¸€ç‚¹éœ€è¦è§£é‡Šä¸‹ï¼Œå°±æ˜¯è¿™é‡Œä¸ºä»€ä¹ˆæ˜¯ä¼  this è¿›å»ã€‚è¿™ä¸ª this ä»£è¡¨çš„å°±æ˜¯ store å®ä¾‹æœ¬èº« è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ actions æ˜¯è¿™æ ·ä½¿ç”¨çš„ï¼š actions: &#123; asyncIncre(&#123;commit&#125;,arg)&#123; setTimeout(()=&gt;&#123; commit(&#x27;incre&#x27;,arg) &#125;,1000) &#125;&#125;, å…¶å®{commit} å°±æ˜¯å¯¹ thisï¼Œå³ store å®ä¾‹çš„è§£æ„ ã€‚ é‚£æˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹ã€‚ &lt;template&gt; &lt;div id=&quot;app&quot;&gt; 123 &lt;p&gt;state:&#123;&#123;this.$store.state.num&#125;&#125;&lt;/p&gt; &lt;p&gt;getter:&#123;&#123;this.$store.getters.getNum&#125;&#125;&lt;/p&gt; &lt;button @click=&quot;add&quot;&gt;+1&lt;/button&gt; &lt;button @click=&quot;asyncAdd&quot;&gt;å¼‚æ­¥+2&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; export default &#123; methods: &#123; add() &#123; this.$store.commit(&quot;incre&quot;, 1); &#125;, asyncAdd() &#123; this.$store.dispatch(&quot;asyncIncre&quot;, 2); &#125;, &#125;, &#125;;&lt;/script&gt; store/index.js //store/index.jsimport Vue from &quot;vue&quot;;import Vuex from &quot;./myVuex&quot;;Vue.use(Vuex);export default new Vuex.Store(&#123; state: &#123; num: 0, &#125;, getter: &#123; getNum: (state) =&gt; &#123; return state.num; &#125;, &#125;, mutations: &#123; incre(state, arg) &#123; state.num += arg; &#125;, &#125;, //æ–°å¢æµ‹è¯•ä»£ç  actions: &#123; asyncIncre(&#123; commit &#125;, arg) &#123; setTimeout(() =&gt; &#123; commit(&quot;incre&quot;, arg); &#125;, 1000); &#125;, &#125;,&#125;); oh my godï¼Œå±…ç„¶å‡ºé”™äº†ï¼Œå®ƒè¿™é‡Œé”™è¯¯ è¯´çš„æ˜¯æ‰§è¡Œåˆ°è¿™é‡Œå‘ç°è¿™é‡Œçš„ this ä¸º undefinedã€‚ ä¸è¿‡ï¼Œä¸å¯¹å•Šï¼Œæˆ‘ä»¬åœ¨å®ç° mutation çš„æ—¶å€™ä¹Ÿæ‰§è¡Œåˆ°è¿™é‡Œäº†å•Šï¼Œè€Œä¸”æ‰§è¡ŒæˆåŠŸäº†å•Šã€‚ æ¥åˆ†æä¸€ä¸‹ï¼š this.$store.commit(&quot;incre&quot;, 1); æ‰§è¡Œè¿™æ®µä»£ç çš„æ—¶å€™ï¼Œæ‰§è¡Œ commit çš„æ—¶å€™ï¼Œthis æ˜¯è°è°ƒç”¨å°±æŒ‡å‘è°ï¼Œæ‰€ä»¥ this æŒ‡å‘$storeã€‚ this.$store.dispatch(&quot;asyncIncre&quot;, 2); æ‰§è¡Œè¿™æ®µä»£ç ï¼Œå°±ä¼šæ‰§è¡Œ asyncIncre(&#123;commit&#125;,arg)&#123; setTimeout(()=&gt;&#123; commit(&#x27;incre&#x27;,arg) &#125;,1000)&#125; å‘ç°é—®é¢˜äº†å§ï¼Ÿï¼Ÿ è°è°ƒç”¨ commitï¼Ÿï¼Ÿæ˜¯$storeå—ï¼Ÿå¹¶ä¸æ˜¯ã€‚æ‰€ä»¥è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¿…é¡»æ¢æˆç®­å¤´å‡½æ•° //myVuex.jsclass Store &#123; constructor(options) &#123; this.vm = new Vue(&#123; data: &#123; state: options.state, &#125;, &#125;); let getters = options.getter || &#123;&#125;; this.getters = &#123;&#125;; Object.keys(getters).forEach((getterName) =&gt; &#123; Object.defineProperty(this.getters, getterName, &#123; get: () =&gt; &#123; return getters[getterName](this.state); &#125;, &#125;); &#125;); let mutations = options.mutations || &#123;&#125;; this.mutations = &#123;&#125;; Object.keys(mutations).forEach((mutationName) =&gt; &#123; this.mutations[mutationName] = (arg) =&gt; &#123; mutations[mutationName](this.state, arg); &#125;; &#125;); let actions = options.actions; this.actions = &#123;&#125;; Object.keys(actions).forEach((actionName) =&gt; &#123; this.actions[actionName] = (arg) =&gt; &#123; actions[actionName](this, arg); &#125;; &#125;); &#125; dispatch(method, arg) &#123; this.actions[method](arg); &#125; // ä¿®æ”¹ä»£ç  commit = (method, arg) =&gt; &#123; console.log(method); console.log(this.mutations); this.mutations[method](arg); &#125;; get state() &#123; return this.vm.state; &#125;&#125; å†æ¥æµ‹è¯• å®Œç¾æ”¶å®˜ï¼ï¼ï¼ï¼ è½¬è½½æ‰‹å†™ Vuex æ ¸å¿ƒåŸç†ï¼Œå†ä¹Ÿä¸æ€•é¢è¯•å®˜é—®æˆ‘ Vuex åŸç†","updated":"2025-08-02T05:46:04.180Z","tags":[]},{"title":"VueåŸç†","date":"2022-07-16T06:55:26.000Z","path":"2022/07/16/2022-07-16-vue-theory/","text":"vue åŒå‘ç»‘å®šåŸç† ã€åŸç†é¢˜ã€‘ æ ¸å¿ƒå®ç°ç±»:Observer : å®ƒçš„ä½œç”¨æ˜¯ç»™å¯¹è±¡çš„å±æ€§æ·»åŠ  getter å’Œ setterï¼Œç”¨äºä¾èµ–æ”¶é›†å’Œæ´¾å‘æ›´æ–° Dep : ç”¨äºæ”¶é›†å½“å‰å“åº”å¼å¯¹è±¡çš„ä¾èµ–å…³ç³»,æ¯ä¸ªå“åº”å¼å¯¹è±¡åŒ…æ‹¬å­å¯¹è±¡éƒ½æ‹¥æœ‰ä¸€ä¸ª Dep å®ä¾‹ï¼ˆé‡Œé¢ subs æ˜¯ Watcher å®ä¾‹æ•°ç»„ï¼‰,å½“æ•°æ®æœ‰å˜æ›´æ—¶,ä¼šé€šè¿‡ dep.notify()é€šçŸ¥å„ä¸ª watcherã€‚ Watcher : è§‚å¯Ÿè€…å¯¹è±¡ , å®ä¾‹åˆ†ä¸ºæ¸²æŸ“ watcher (render watcher),è®¡ç®—å±æ€§ watcher (computed watcher),ä¾¦å¬å™¨ watcherï¼ˆuser watcherï¼‰ä¸‰ç§ Watcher å’Œ Dep çš„å…³ç³»watcher ä¸­å®ä¾‹åŒ–äº† dep å¹¶å‘ dep.subs ä¸­æ·»åŠ äº†è®¢é˜…è€…,dep é€šè¿‡ notify éå†äº† dep.subs é€šçŸ¥æ¯ä¸ª watcher æ›´æ–°ã€‚ ä¾èµ–æ”¶é›†initState æ—¶,å¯¹ computed å±æ€§åˆå§‹åŒ–æ—¶,è§¦å‘ computed watcher ä¾èµ–æ”¶é›†initState æ—¶,å¯¹ä¾¦å¬å±æ€§åˆå§‹åŒ–æ—¶,è§¦å‘ user watcher ä¾èµ–æ”¶é›†render()çš„è¿‡ç¨‹,è§¦å‘ render watcher ä¾èµ–æ”¶é›†re-render æ—¶,vm.render()å†æ¬¡æ‰§è¡Œ,ä¼šç§»é™¤æ‰€æœ‰ subs ä¸­çš„ watcer çš„è®¢é˜…,é‡æ–°èµ‹å€¼ã€‚æ´¾å‘æ›´æ–°ç»„ä»¶ä¸­å¯¹å“åº”çš„æ•°æ®è¿›è¡Œäº†ä¿®æ”¹,è§¦å‘ setter çš„é€»è¾‘è°ƒç”¨ dep.notify()éå†æ‰€æœ‰çš„ subsï¼ˆWatcher å®ä¾‹ï¼‰,è°ƒç”¨æ¯ä¸€ä¸ª watcher çš„ update æ–¹æ³•ã€‚åŸç†å½“åˆ›å»º Vue å®ä¾‹æ—¶,vue ä¼šéå† data é€‰é¡¹çš„å±æ€§,åˆ©ç”¨ Object.defineProperty ä¸ºå±æ€§æ·»åŠ  getter å’Œ setter å¯¹æ•°æ®çš„è¯»å–è¿›è¡ŒåŠ«æŒï¼ˆgetter ç”¨æ¥ä¾èµ–æ”¶é›†,setter ç”¨æ¥æ´¾å‘æ›´æ–°ï¼‰,å¹¶ä¸”åœ¨å†…éƒ¨è¿½è¸ªä¾èµ–,åœ¨å±æ€§è¢«è®¿é—®å’Œä¿®æ”¹æ—¶é€šçŸ¥å˜åŒ–ã€‚ æ¯ä¸ªç»„ä»¶å®ä¾‹ä¼šæœ‰ç›¸åº”çš„ watcher å®ä¾‹,ä¼šåœ¨ç»„ä»¶æ¸²æŸ“çš„è¿‡ç¨‹ä¸­è®°å½•ä¾èµ–çš„æ‰€æœ‰æ•°æ®å±æ€§ï¼ˆè¿›è¡Œä¾èµ–æ”¶é›†,è¿˜æœ‰ computed watcher,user watcher å®ä¾‹ï¼‰,ä¹‹åä¾èµ–é¡¹è¢«æ”¹åŠ¨æ—¶,setter æ–¹æ³•ä¼šé€šçŸ¥ä¾èµ–ä¸æ­¤ data çš„ watcher å®ä¾‹é‡æ–°è®¡ç®—ï¼ˆæ´¾å‘æ›´æ–°ï¼‰,ä»è€Œä½¿å®ƒå…³è”çš„ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚ ä¸€å¥è¯æ€»ç»“: vue.js é‡‡ç”¨æ•°æ®åŠ«æŒç»“åˆå‘å¸ƒ-è®¢é˜…æ¨¡å¼,é€šè¿‡ Object.defineproperty æ¥åŠ«æŒå„ä¸ªå±æ€§çš„ setter,getter,åœ¨æ•°æ®å˜åŠ¨æ—¶å‘å¸ƒæ¶ˆæ¯ç»™è®¢é˜…è€…,è§¦å‘å“åº”çš„ç›‘å¬å›è°ƒ è‡ªå·±å®ç°ä¸€ä¸ª Vue çš„åŒå‘ç»‘å®š computed çš„å®ç°åŸç†ã€åŸç†é¢˜ã€‘computed æœ¬è´¨æ˜¯ä¸€ä¸ªæƒ°æ€§æ±‚å€¼çš„è§‚å¯Ÿè€…ã€‚ computed å†…éƒ¨å®ç°äº†ä¸€ä¸ªæƒ°æ€§çš„ watcher,ä¹Ÿå°±æ˜¯ computed watcher,computed watcher ä¸ä¼šç«‹åˆ»æ±‚å€¼,åŒæ—¶æŒæœ‰ä¸€ä¸ª dep å®ä¾‹ã€‚ å…¶å†…éƒ¨é€šè¿‡ this.dirty å±æ€§æ ‡è®°è®¡ç®—å±æ€§æ˜¯å¦éœ€è¦é‡æ–°æ±‚å€¼ã€‚ å½“ computed çš„ä¾èµ–çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶,å°±ä¼šé€šçŸ¥è¿™ä¸ªæƒ°æ€§çš„ watcher, computed watcher é€šè¿‡ this.dep.subs.length åˆ¤æ–­æœ‰æ²¡æœ‰è®¢é˜…è€…, æœ‰çš„è¯,ä¼šé‡æ–°è®¡ç®—,ç„¶åå¯¹æ¯”æ–°æ—§å€¼,å¦‚æœå˜åŒ–äº†,ä¼šé‡æ–°æ¸²æŸ“ã€‚ (Vue æƒ³ç¡®ä¿ä¸ä»…ä»…æ˜¯è®¡ç®—å±æ€§ä¾èµ–çš„å€¼å‘ç”Ÿå˜åŒ–ï¼Œè€Œæ˜¯å½“è®¡ç®—å±æ€§æœ€ç»ˆè®¡ç®—çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šè§¦å‘æ¸²æŸ“ watcher é‡æ–°æ¸²æŸ“ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§ä¼˜åŒ–ã€‚) æ²¡æœ‰çš„è¯,ä»…ä»…æŠŠ this.dirty = trueã€‚ (å½“è®¡ç®—å±æ€§ä¾èµ–äºå…¶ä»–æ•°æ®æ—¶ï¼Œå±æ€§å¹¶ä¸ä¼šç«‹å³é‡æ–°è®¡ç®—ï¼Œåªæœ‰ä¹‹åå…¶ä»–åœ°æ–¹éœ€è¦è¯»å–å±æ€§çš„æ—¶å€™ï¼Œå®ƒæ‰ä¼šçœŸæ­£è®¡ç®—ï¼Œå³å…·å¤‡ lazyï¼ˆæ‡’è®¡ç®—ï¼‰ç‰¹æ€§ã€‚) computed å’Œ watch æœ‰ä»€ä¹ˆåŒºåˆ«åŠè¿ç”¨åœºæ™¯?ã€åŸç†é¢˜ã€‘ åŒºåˆ« computed è®¡ç®—å±æ€§ : ä¾èµ–å…¶å®ƒå±æ€§å€¼,å¹¶ä¸” computed çš„å€¼æœ‰ç¼“å­˜,åªæœ‰å®ƒä¾èµ–çš„å±æ€§å€¼å‘ç”Ÿæ”¹å˜,ä¸‹ä¸€æ¬¡è·å– computed çš„å€¼æ—¶æ‰ä¼šé‡æ–°è®¡ç®— computed çš„å€¼ã€‚ ã€ç®€å•è¡¨è¾¾ï¼š ä¾èµ–ç¼“å­˜ï¼Œä¾èµ–çš„å€¼å˜åŒ–äº†æ‰ä¼šè‡ªåŠ¨å˜åŒ–ã€‘ watch ä¾¦å¬å™¨ : æ›´å¤šçš„æ˜¯ã€Œè§‚å¯Ÿã€çš„ä½œç”¨,æ— ç¼“å­˜æ€§,ç±»ä¼¼äºæŸäº›æ•°æ®çš„ç›‘å¬å›è°ƒ,æ¯å½“ç›‘å¬çš„æ•°æ®å˜åŒ–æ—¶éƒ½ä¼šæ‰§è¡Œå›è°ƒè¿›è¡Œåç»­æ“ä½œã€‚ ã€ç®€å•è¡¨è¾¾ï¼šwatch ç›‘å¬æ•°å˜åŒ–ï¼Œæ— ç¼“å­˜ä¾èµ–ï¼Œç›‘å¬çš„å€¼å˜åŒ–äº†ä»–å°±å˜åŒ–ã€‘ è¿ç”¨åœºæ™¯ å½“æˆ‘ä»¬éœ€è¦è¿›è¡Œæ•°å€¼è®¡ç®—,å¹¶ä¸”ä¾èµ–äºå…¶å®ƒæ•°æ®æ—¶,åº”è¯¥ä½¿ç”¨ computed,å› ä¸ºå¯ä»¥åˆ©ç”¨ computed çš„ç¼“å­˜ç‰¹æ€§,é¿å…æ¯æ¬¡è·å–å€¼æ—¶,éƒ½è¦é‡æ–°è®¡ç®—ã€‚ ã€ä¸èƒ½æ”¾å¼‚æ­¥ã€‘ å½“æˆ‘ä»¬éœ€è¦åœ¨æ•°æ®å˜åŒ–æ—¶æ‰§è¡Œå¼‚æ­¥æˆ–å¼€é”€è¾ƒå¤§çš„æ“ä½œæ—¶,åº”è¯¥ä½¿ç”¨ watch,ä½¿ç”¨ watch é€‰é¡¹å…è®¸æˆ‘ä»¬æ‰§è¡Œå¼‚æ­¥æ“ä½œ ( è®¿é—®ä¸€ä¸ª API ),é™åˆ¶æˆ‘ä»¬æ‰§è¡Œè¯¥æ“ä½œçš„é¢‘ç‡,å¹¶åœ¨æˆ‘ä»¬å¾—åˆ°æœ€ç»ˆç»“æœå‰,è®¾ç½®ä¸­é—´çŠ¶æ€ã€‚è¿™äº›éƒ½æ˜¯è®¡ç®—å±æ€§æ— æ³•åšåˆ°çš„ã€‚ ã€å¯ä»¥æ”¾å¼‚æ­¥å¤„ç†ã€‘ ä¸ºä»€ä¹ˆåœ¨ Vue3.0 é‡‡ç”¨äº† Proxy,æŠ›å¼ƒäº† Object.definePropertyï¼Ÿã€åŸç†é¢˜ã€‘Object.defineProperty æœ¬èº«æœ‰ä¸€å®šçš„ç›‘æ§åˆ°æ•°ç»„ä¸‹æ ‡å˜åŒ–çš„èƒ½åŠ›,ä½†æ˜¯åœ¨ Vue ä¸­,ä»æ€§èƒ½/ä½“éªŒçš„æ€§ä»·æ¯”è€ƒè™‘,å°¤å¤§å¤§å°±å¼ƒç”¨äº†è¿™ä¸ªç‰¹æ€§(Vue ä¸ºä»€ä¹ˆä¸èƒ½æ£€æµ‹æ•°ç»„å˜åŠ¨ )ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜,ç»è¿‡ vue å†…éƒ¨å¤„ç†åå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡ ç§æ–¹æ³•æ¥ç›‘å¬æ•°ç»„ push();pop();shift();unshift();splice();sort();reverse(); ç”±äºåªé’ˆå¯¹äº†ä»¥ä¸Š 7 ç§æ–¹æ³•è¿›è¡Œäº† hack å¤„ç†,æ‰€ä»¥å…¶ä»–æ•°ç»„çš„å±æ€§ä¹Ÿæ˜¯æ£€æµ‹ä¸åˆ°çš„,è¿˜æ˜¯å…·æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚ **Object.defineProperty åªèƒ½åŠ«æŒå¯¹è±¡çš„å±æ€§,**å› æ­¤æˆ‘ä»¬éœ€è¦å¯¹æ¯ä¸ªå¯¹è±¡çš„æ¯ä¸ªå±æ€§è¿›è¡Œéå†ã€‚Vue 2.x é‡Œ,æ˜¯é€šè¿‡ é€’å½’ + éå† data å¯¹è±¡æ¥å®ç°å¯¹æ•°æ®çš„ç›‘æ§çš„,å¦‚æœå±æ€§å€¼ä¹Ÿæ˜¯å¯¹è±¡é‚£ä¹ˆéœ€è¦æ·±åº¦éå†,æ˜¾ç„¶å¦‚æœèƒ½åŠ«æŒä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡æ˜¯æ‰æ˜¯æ›´å¥½çš„é€‰æ‹©ã€‚Proxy å¯ä»¥åŠ«æŒæ•´ä¸ªå¯¹è±¡,å¹¶è¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚Proxy ä¸ä»…å¯ä»¥ä»£ç†å¯¹è±¡,è¿˜å¯ä»¥ä»£ç†æ•°ç»„ã€‚è¿˜å¯ä»¥ä»£ç†åŠ¨æ€å¢åŠ çš„å±æ€§ã€‚ Vue ä¸­çš„ key åˆ°åº•æœ‰ä»€ä¹ˆç”¨ï¼Ÿã€åŸç†é¢˜ã€‘å›ç­”ï¼š ã€ç®€å•è¡¨è¾¾ï¼šä¸ºäº†é˜²æ­¢å°±åœ°å¤ç”¨ï¼ã€‘ key æ˜¯ç»™æ¯ä¸€ä¸ª vnode çš„å”¯ä¸€ id,ä¾é  key,æˆ‘ä»¬çš„ diff æ“ä½œå¯ä»¥æ›´å‡†ç¡®ã€æ›´å¿«é€Ÿ (å¯¹äºç®€å•åˆ—è¡¨é¡µæ¸²æŸ“æ¥è¯´ diff èŠ‚ç‚¹ä¹Ÿæ›´å¿«,ä½†ä¼šäº§ç”Ÿä¸€äº›éšè—çš„å‰¯ä½œç”¨,æ¯”å¦‚å¯èƒ½ä¸ä¼šäº§ç”Ÿè¿‡æ¸¡æ•ˆæœ,æˆ–è€…åœ¨æŸäº›èŠ‚ç‚¹æœ‰ç»‘å®šæ•°æ®ï¼ˆè¡¨å•ï¼‰çŠ¶æ€ï¼Œä¼šå‡ºç°çŠ¶æ€é”™ä½ã€‚) diff ç®—æ³•çš„è¿‡ç¨‹ä¸­,å…ˆä¼šè¿›è¡Œæ–°æ—§èŠ‚ç‚¹çš„é¦–å°¾äº¤å‰å¯¹æ¯”,å½“æ— æ³•åŒ¹é…çš„æ—¶å€™ä¼šç”¨æ–°èŠ‚ç‚¹çš„ key ä¸æ—§èŠ‚ç‚¹è¿›è¡Œæ¯”å¯¹,ä»è€Œæ‰¾åˆ°ç›¸åº”æ—§èŠ‚ç‚¹. æ›´å‡†ç¡® : å› ä¸ºå¸¦ key å°±ä¸æ˜¯å°±åœ°å¤ç”¨äº†,åœ¨ sameNode å‡½æ•° a.key === b.key å¯¹æ¯”ä¸­å¯ä»¥é¿å…å°±åœ°å¤ç”¨çš„æƒ…å†µã€‚æ‰€ä»¥ä¼šæ›´åŠ å‡†ç¡®,å¦‚æœä¸åŠ  key,ä¼šå¯¼è‡´ä¹‹å‰èŠ‚ç‚¹çš„çŠ¶æ€è¢«ä¿ç•™ä¸‹æ¥,ä¼šäº§ç”Ÿä¸€ç³»åˆ—çš„ bugã€‚ æ›´å¿«é€Ÿ : key çš„å”¯ä¸€æ€§å¯ä»¥è¢« Map æ•°æ®ç»“æ„å……åˆ†åˆ©ç”¨,ç›¸æ¯”äºéå†æŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦ O(n),Map çš„æ—¶é—´å¤æ‚åº¦ä»…ä»…ä¸º O(1),æºç å¦‚ä¸‹: function createKeyToOldIdx(children, beginIdx, endIdx) &#123; let i, key; const map = &#123;&#125;; for (i = beginIdx; i &lt;= endIdx; ++i) &#123; key = children[i].key; if (isDef(key)) map[key] = i; &#125; return map;&#125; è°ˆä¸€è°ˆ nextTick çš„åŸç†ã€åŸç†é¢˜ã€‘JS è¿è¡Œæœºåˆ¶ JS æ‰§è¡Œæ˜¯å•çº¿ç¨‹çš„ï¼Œå®ƒæ˜¯åŸºäºäº‹ä»¶å¾ªç¯çš„ã€‚äº‹ä»¶å¾ªç¯å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤: æ‰€æœ‰åŒæ­¥ä»»åŠ¡éƒ½åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œå½¢æˆä¸€ä¸ªæ‰§è¡Œæ ˆï¼ˆexecution context stackï¼‰ã€‚ä¸»çº¿ç¨‹ä¹‹å¤–ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ªâ€ä»»åŠ¡é˜Ÿåˆ—â€ï¼ˆtask queueï¼‰ã€‚åªè¦å¼‚æ­¥ä»»åŠ¡æœ‰äº†è¿è¡Œç»“æœï¼Œå°±åœ¨â€ä»»åŠ¡é˜Ÿåˆ—â€ä¹‹ä¸­æ”¾ç½®ä¸€ä¸ªäº‹ä»¶ã€‚ä¸€æ—¦â€æ‰§è¡Œæ ˆâ€ä¸­çš„æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œç³»ç»Ÿå°±ä¼šè¯»å–â€ä»»åŠ¡é˜Ÿåˆ—â€ï¼Œçœ‹çœ‹é‡Œé¢æœ‰å“ªäº›äº‹ä»¶ã€‚é‚£äº›å¯¹åº”çš„å¼‚æ­¥ä»»åŠ¡ï¼Œäºæ˜¯ç»“æŸç­‰å¾…çŠ¶æ€ï¼Œè¿›å…¥æ‰§è¡Œæ ˆï¼Œå¼€å§‹æ‰§è¡Œã€‚ä¸»çº¿ç¨‹ä¸æ–­é‡å¤ä¸Šé¢çš„ç¬¬ä¸‰æ­¥ã€‚ ä¸»çº¿ç¨‹çš„æ‰§è¡Œè¿‡ç¨‹å°±æ˜¯ä¸€ä¸ª tickï¼Œè€Œæ‰€æœ‰çš„å¼‚æ­¥ç»“æœéƒ½æ˜¯é€šè¿‡ â€œä»»åŠ¡é˜Ÿåˆ—â€ æ¥è°ƒåº¦ã€‚ æ¶ˆæ¯é˜Ÿåˆ—ä¸­å­˜æ”¾çš„æ˜¯ä¸€ä¸ªä¸ªçš„ä»»åŠ¡ï¼ˆtaskï¼‰ã€‚ è§„èŒƒä¸­è§„å®š task åˆ†ä¸ºä¸¤å¤§ç±»ï¼Œåˆ†åˆ«æ˜¯ macro task å’Œ micro taskï¼Œå¹¶ä¸”æ¯ä¸ª macro task ç»“æŸåï¼Œéƒ½è¦æ¸…ç©ºæ‰€æœ‰çš„ micro taskã€‚ for (macroTask of macroTaskQueue) &#123; // 1. Handle current MACRO-TASK handleMacroTask(); // 2. Handle all MICRO-TASK for (microTask of microTaskQueue) &#123; handleMicroTask(microTask); &#125;&#125; åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ : å¸¸è§çš„ macro task æœ‰ setTimeoutã€MessageChannelã€postMessageã€setImmediate å¸¸è§çš„ micro task æœ‰ MutationObsever å’Œ Promise.then å¼‚æ­¥æ›´æ–°é˜Ÿåˆ— å¯èƒ½ä½ è¿˜æ²¡æœ‰æ³¨æ„åˆ°ï¼ŒVue åœ¨æ›´æ–° DOM æ—¶æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚åªè¦ä¾¦å¬åˆ°æ•°æ®å˜åŒ–ï¼ŒVue å°†å¼€å¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶ç¼“å†²åœ¨åŒä¸€äº‹ä»¶å¾ªç¯ä¸­å‘ç”Ÿçš„æ‰€æœ‰æ•°æ®å˜æ›´ã€‚ å¦‚æœåŒä¸€ä¸ª watcher è¢«å¤šæ¬¡è§¦å‘ï¼Œåªä¼šè¢«æ¨å…¥åˆ°é˜Ÿåˆ—ä¸­ä¸€æ¬¡ã€‚è¿™ç§åœ¨ç¼“å†²æ—¶å»é™¤é‡å¤æ•°æ®å¯¹äºé¿å…ä¸å¿…è¦çš„è®¡ç®—å’Œ DOM æ“ä½œæ˜¯éå¸¸é‡è¦çš„ã€‚ ç„¶åï¼Œåœ¨ä¸‹ä¸€ä¸ªçš„äº‹ä»¶å¾ªç¯â€œtickâ€ä¸­ï¼ŒVue åˆ·æ–°é˜Ÿåˆ—å¹¶æ‰§è¡Œå®é™… (å·²å»é‡çš„) å·¥ä½œã€‚ Vue åœ¨å†…éƒ¨å¯¹å¼‚æ­¥é˜Ÿåˆ—å°è¯•ä½¿ç”¨åŸç”Ÿçš„ Promise.thenã€MutationObserver å’Œ setImmediateï¼Œå¦‚æœæ‰§è¡Œç¯å¢ƒä¸æ”¯æŒï¼Œåˆ™ä¼šé‡‡ç”¨ setTimeout(fn, 0) ä»£æ›¿ã€‚ åœ¨ vue2.5 çš„æºç ä¸­ï¼Œmacrotask é™çº§çš„æ–¹æ¡ˆä¾æ¬¡æ˜¯ï¼šsetImmediateã€MessageChannelã€setTimeout vue çš„ nextTick æ–¹æ³•çš„å®ç°åŸç†: vue ç”¨å¼‚æ­¥é˜Ÿåˆ—çš„æ–¹å¼æ¥æ§åˆ¶ DOM æ›´æ–°å’Œ nextTick å›è°ƒå…ˆåæ‰§è¡Œ microtask å› ä¸ºå…¶é«˜ä¼˜å…ˆçº§ç‰¹æ€§ï¼Œèƒ½ç¡®ä¿é˜Ÿåˆ—ä¸­çš„å¾®ä»»åŠ¡åœ¨ä¸€æ¬¡äº‹ä»¶å¾ªç¯å‰è¢«æ‰§è¡Œå®Œæ¯•è€ƒè™‘å…¼å®¹é—®é¢˜,vue åšäº† microtask å‘ macrotask çš„é™çº§æ–¹æ¡ˆ å¦‚ä½•åˆ¤æ–­ dom æ›´æ–°å®Œæˆåï¼Œå†æ‰§è¡Œ nextTick åçš„å‡½æ•°å®é™…ä¸Š dom æ›´æ–°æ˜¯å®æ—¶çš„ï¼Œæ‰€ä»¥ä¸ä¼šé˜»å¡ï¼Œä½¿ç”¨å¾®ä»»åŠ¡åï¼Œå¯ä»¥ä¿è¯æ‰€æ‰§è¡Œçš„æ–¹æ³•åœ¨ dom æ›´æ–°å vue æ˜¯å¦‚ä½•å¯¹æ•°ç»„æ–¹æ³•è¿›è¡Œå˜å¼‚çš„ ?ã€åŸç†é¢˜ã€‘æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æºç  const arrayProto = Array.prototype;export const arrayMethods = Object.create(arrayProto);const methodsToPatch = [&#x27;push&#x27;, &#x27;pop&#x27;, &#x27;shift&#x27;, &#x27;unshift&#x27;, &#x27;splice&#x27;, &#x27;sort&#x27;, &#x27;reverse&#x27;];/** * Intercept mutating methods and emit events */methodsToPatch.forEach(function (method) &#123; // cache original method const original = arrayProto[method]; def(arrayMethods, method, function mutator(...args) &#123; const result = original.apply(this, args); const ob = this.__ob__; let inserted; switch (method) &#123; case &#x27;push&#x27;: case &#x27;unshift&#x27;: inserted = args; break; case &#x27;splice&#x27;: inserted = args.slice(2); break; &#125; if (inserted) ob.observeArray(inserted); // notify change ob.dep.notify(); return result; &#125;);&#125;);/** * Observe a list of Array items. */Observer.prototype.observeArray = function observeArray(items) &#123; for (var i = 0, l = items.length; i &lt; l; i++) &#123; observe(items[i]); &#125;&#125;; ç®€å•æ¥è¯´,Vue é€šè¿‡åŸå‹æ‹¦æˆªçš„æ–¹å¼é‡å†™äº†æ•°ç»„çš„ 7 ä¸ªæ–¹æ³•,é¦–å…ˆè·å–åˆ°è¿™ä¸ªæ•°ç»„çš„ ob,ä¹Ÿå°±æ˜¯å®ƒçš„ Observer å¯¹è±¡,å¦‚æœæœ‰æ–°çš„å€¼,å°±è°ƒç”¨ observeArray å¯¹æ–°çš„å€¼è¿›è¡Œç›‘å¬,ç„¶åæ‰‹åŠ¨è°ƒç”¨ notify,é€šçŸ¥ render watcher,æ‰§è¡Œ update Vue ç»„ä»¶ data ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯å‡½æ•° ?ã€åŸç†é¢˜ã€‘new Vue()å®ä¾‹ä¸­,data å¯ä»¥ç›´æ¥æ˜¯ä¸€ä¸ªå¯¹è±¡,ä¸ºä»€ä¹ˆåœ¨ vue ç»„ä»¶ä¸­,data å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°å‘¢?å› ä¸ºç»„ä»¶æ˜¯å¯ä»¥å¤ç”¨çš„,JS é‡Œå¯¹è±¡æ˜¯å¼•ç”¨å…³ç³»,å¦‚æœç»„ä»¶ data æ˜¯ä¸€ä¸ªå¯¹è±¡,é‚£ä¹ˆå­ç»„ä»¶ä¸­çš„ data å±æ€§å€¼ä¼šäº’ç›¸æ±¡æŸ“,äº§ç”Ÿå‰¯ä½œç”¨ã€‚ æ‰€ä»¥ä¸€ä¸ªç»„ä»¶çš„ data é€‰é¡¹å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°,å› æ­¤æ¯ä¸ªå®ä¾‹å¯ä»¥ç»´æŠ¤ä¸€ä»½è¢«è¿”å›å¯¹è±¡çš„ç‹¬ç«‹çš„æ‹·è´ã€‚new Vue çš„å®ä¾‹æ˜¯ä¸ä¼šè¢«å¤ç”¨çš„,å› æ­¤ä¸å­˜åœ¨ä»¥ä¸Šé—®é¢˜ã€‚ è°ˆè°ˆ Vue äº‹ä»¶æœºåˆ¶,æ‰‹å†™$on,$off,$emit,$once ã€åŸç†é¢˜ã€‘Vue äº‹ä»¶æœºåˆ¶ æœ¬è´¨ä¸Šå°±æ˜¯ ä¸€ä¸ª å‘å¸ƒ-è®¢é˜… æ¨¡å¼çš„å®ç°ã€‚ class Vue &#123; constructor() &#123; // äº‹ä»¶é€šé“è°ƒåº¦ä¸­å¿ƒ this._events = Object.create(null); &#125; $on(event, fn) &#123; if (Array.isArray(event)) &#123; event.map(item =&gt; &#123; this.$on(item, fn); &#125;); &#125; else &#123; (this._events[event] || (this._events[event] = [])).push(fn); &#125; return this; &#125; $once(event, fn) &#123; function on() &#123; this.$off(event, on); fn.apply(this, arguments); &#125; on.fn = fn; this.$on(event, on); return this; &#125; $off(event, fn) &#123; if (!arguments.length) &#123; this._events = Object.create(null); return this; &#125; if (Array.isArray(event)) &#123; event.map(item =&gt; &#123; this.$off(item, fn); &#125;); return this; &#125; const cbs = this._events[event]; if (!cbs) &#123; return this; &#125; if (!fn) &#123; this._events[event] = null; return this; &#125; let cb; let i = cbs.length; while (i--) &#123; cb = cbs[i]; if (cb === fn || cb.fn === fn) &#123; cbs.splice(i, 1); break; &#125; &#125; return this; &#125; $emit(event) &#123; let cbs = this._events[event]; if (cbs) &#123; const args = [].slice.call(arguments, 1); cbs.map(item =&gt; &#123; args ? item.apply(this, args) : item.call(this); &#125;); &#125; return this; &#125;&#125; è¯´è¯´ Vue çš„æ¸²æŸ“è¿‡ç¨‹ ã€åŸç†é¢˜ã€‘è°ƒç”¨ compile å‡½æ•°,ç”Ÿæˆ render å‡½æ•°å­—ç¬¦ä¸² ,ç¼–è¯‘è¿‡ç¨‹å¦‚ä¸‹: parse å‡½æ•°è§£æ template,ç”Ÿæˆ ast(æŠ½è±¡è¯­æ³•æ ‘) optimize å‡½æ•°ä¼˜åŒ–é™æ€èŠ‚ç‚¹ (æ ‡è®°ä¸éœ€è¦æ¯æ¬¡éƒ½æ›´æ–°çš„å†…å®¹,diff ç®—æ³•ä¼šç›´æ¥è·³è¿‡é™æ€èŠ‚ç‚¹,ä»è€Œå‡å°‘æ¯”è¾ƒçš„è¿‡ç¨‹,ä¼˜åŒ–äº† patch çš„æ€§èƒ½)generate å‡½æ•°ç”Ÿæˆ render å‡½æ•°å­—ç¬¦ä¸² è°ƒç”¨ new Watcher å‡½æ•°,ç›‘å¬æ•°æ®çš„å˜åŒ–,å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒRender å‡½æ•°æ‰§è¡Œç”Ÿæˆ vnode å¯¹è±¡è°ƒç”¨ patch æ–¹æ³•,å¯¹æ¯”æ–°æ—§ vnode å¯¹è±¡,é€šè¿‡ DOM diff ç®—æ³•,æ·»åŠ ã€ä¿®æ”¹ã€åˆ é™¤çœŸæ­£çš„ DOM å…ƒç´  èŠèŠ keep-alive çš„å®ç°åŸç†å’Œç¼“å­˜ç­–ç•¥ ã€åŸç†é¢˜ã€‘export default &#123; name: &#x27;keep-alive&#x27;, abstract: true, // æŠ½è±¡ç»„ä»¶å±æ€§ ,å®ƒåœ¨ç»„ä»¶å®ä¾‹å»ºç«‹çˆ¶å­å…³ç³»çš„æ—¶å€™ä¼šè¢«å¿½ç•¥,å‘ç”Ÿåœ¨ initLifecycle çš„è¿‡ç¨‹ä¸­ props: &#123; include: patternTypes, // è¢«ç¼“å­˜ç»„ä»¶ exclude: patternTypes, // ä¸è¢«ç¼“å­˜ç»„ä»¶ max: [String, Number], // æŒ‡å®šç¼“å­˜å¤§å° &#125;, created() &#123; this.cache = Object.create(null); // ç¼“å­˜ this.keys = []; // ç¼“å­˜çš„VNodeçš„é”® &#125;, destroyed() &#123; for (const key in this.cache) &#123; // åˆ é™¤æ‰€æœ‰ç¼“å­˜ pruneCacheEntry(this.cache, key, this.keys); &#125; &#125;, mounted() &#123; // ç›‘å¬ç¼“å­˜/ä¸ç¼“å­˜ç»„ä»¶ this.$watch(&#x27;include&#x27;, val =&gt; &#123; pruneCache(this, name =&gt; matches(val, name)); &#125;); this.$watch(&#x27;exclude&#x27;, val =&gt; &#123; pruneCache(this, name =&gt; !matches(val, name)); &#125;); &#125;, render() &#123; // è·å–ç¬¬ä¸€ä¸ªå­å…ƒç´ çš„ vnode const slot = this.$slots.default; const vnode: VNode = getFirstComponentChild(slot); const componentOptions: ?VNodeComponentOptions = vnode &amp;&amp; vnode.componentOptions; if (componentOptions) &#123; // nameä¸åœ¨inlcudeä¸­æˆ–è€…åœ¨exludeä¸­ ç›´æ¥è¿”å›vnode // check pattern const name: ?string = getComponentName(componentOptions); const &#123; include, exclude &#125; = this; if ( // not included (include &amp;&amp; (!name || !matches(include, name))) || // excluded (exclude &amp;&amp; name &amp;&amp; matches(exclude, name)) ) &#123; return vnode; &#125; const &#123; cache, keys &#125; = this; // è·å–é”®ï¼Œä¼˜å…ˆè·å–ç»„ä»¶çš„nameå­—æ®µï¼Œå¦åˆ™æ˜¯ç»„ä»¶çš„tag const key: ?string = vnode.key == null ? // same constructor may get registered as different local components // so cid alone is not enough (#3269) componentOptions.Ctor.cid + (componentOptions.tag ? `::$&#123;componentOptions.tag&#125;` : &#x27;&#x27;) : vnode.key; // å‘½ä¸­ç¼“å­˜,ç›´æ¥ä»ç¼“å­˜æ‹¿vnode çš„ç»„ä»¶å®ä¾‹,å¹¶ä¸”é‡æ–°è°ƒæ•´äº† key çš„é¡ºåºæ”¾åœ¨äº†æœ€åä¸€ä¸ª if (cache[key]) &#123; vnode.componentInstance = cache[key].componentInstance; // make current key freshest remove(keys, key); keys.push(key); &#125; // ä¸å‘½ä¸­ç¼“å­˜,æŠŠ vnode è®¾ç½®è¿›ç¼“å­˜ else &#123; cache[key] = vnode; keys.push(key); // prune oldest entry // å¦‚æœé…ç½®äº† max å¹¶ä¸”ç¼“å­˜çš„é•¿åº¦è¶…è¿‡äº† this.maxï¼Œè¿˜è¦ä»ç¼“å­˜ä¸­åˆ é™¤ç¬¬ä¸€ä¸ª if (this.max &amp;&amp; keys.length &gt; parseInt(this.max)) &#123; pruneCacheEntry(cache, keys[0], keys, this._vnode); &#125; &#125; // keepAliveæ ‡è®°ä½ vnode.data.keepAlive = true; &#125; return vnode || (slot &amp;&amp; slot[0]); &#125;,&#125;; åŸç† è·å– keep-alive åŒ…è£¹ç€çš„ç¬¬ä¸€ä¸ªå­ç»„ä»¶å¯¹è±¡åŠå…¶ç»„ä»¶åæ ¹æ®è®¾å®šçš„ include/excludeï¼ˆå¦‚æœæœ‰ï¼‰è¿›è¡Œæ¡ä»¶åŒ¹é…,å†³å®šæ˜¯å¦ç¼“å­˜ã€‚ä¸åŒ¹é…,ç›´æ¥è¿”å›ç»„ä»¶å®ä¾‹æ ¹æ®ç»„ä»¶ ID å’Œ tag ç”Ÿæˆç¼“å­˜ Key,å¹¶åœ¨ç¼“å­˜å¯¹è±¡ä¸­æŸ¥æ‰¾æ˜¯å¦å·²ç¼“å­˜è¿‡è¯¥ç»„ä»¶å®ä¾‹ã€‚å¦‚æœå­˜åœ¨,ç›´æ¥å–å‡ºç¼“å­˜å€¼å¹¶æ›´æ–°è¯¥ key åœ¨ this.keys ä¸­çš„ä½ç½®(æ›´æ–° key çš„ä½ç½®æ˜¯å®ç° LRU ç½®æ¢ç­–ç•¥çš„å…³é”®)åœ¨ this.cache å¯¹è±¡ä¸­å­˜å‚¨è¯¥ç»„ä»¶å®ä¾‹å¹¶ä¿å­˜ key å€¼,ä¹‹åæ£€æŸ¥ç¼“å­˜çš„å®ä¾‹æ•°é‡æ˜¯å¦è¶…è¿‡ max çš„è®¾ç½®å€¼,è¶…è¿‡åˆ™æ ¹æ® LRU ç½®æ¢ç­–ç•¥åˆ é™¤æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„å®ä¾‹ï¼ˆå³æ˜¯ä¸‹æ ‡ä¸º 0 çš„é‚£ä¸ª keyï¼‰æœ€åç»„ä»¶å®ä¾‹çš„ keepAlive å±æ€§è®¾ç½®ä¸º true,è¿™ä¸ªåœ¨æ¸²æŸ“å’Œæ‰§è¡Œè¢«åŒ…è£¹ç»„ä»¶çš„é’©å­å‡½æ•°ä¼šç”¨åˆ°,è¿™é‡Œä¸ç»†è¯´ LRU ç¼“å­˜æ·˜æ±°ç®—æ³• LRUï¼ˆLeast recently usedï¼‰ç®—æ³•æ ¹æ®æ•°æ®çš„å†å²è®¿é—®è®°å½•æ¥è¿›è¡Œæ·˜æ±°æ•°æ®,å…¶æ ¸å¿ƒæ€æƒ³æ˜¯â€œå¦‚æœæ•°æ®æœ€è¿‘è¢«è®¿é—®è¿‡,é‚£ä¹ˆå°†æ¥è¢«è®¿é—®çš„å‡ ç‡ä¹Ÿæ›´é«˜â€ã€‚ keep-alive çš„å®ç°æ­£æ˜¯ç”¨åˆ°äº† LRU ç­–ç•¥,å°†æœ€è¿‘è®¿é—®çš„ç»„ä»¶ push åˆ° this.keys æœ€åé¢,this.keys[0]ä¹Ÿå°±æ˜¯æœ€ä¹…æ²¡è¢«è®¿é—®çš„ç»„ä»¶,å½“ç¼“å­˜å®ä¾‹è¶…è¿‡ max è®¾ç½®å€¼,åˆ é™¤ this.keys[0] vm.$set()å®ç°åŸç†æ˜¯ä»€ä¹ˆ? ã€åŸç†é¢˜ã€‘å—ç°ä»£ JavaScript çš„é™åˆ¶ (è€Œä¸” Object.observe ä¹Ÿå·²ç»è¢«åºŸå¼ƒ)ï¼ŒVue æ— æ³•æ£€æµ‹åˆ°å¯¹è±¡å±æ€§çš„æ·»åŠ æˆ–åˆ é™¤ã€‚ ç”±äº Vue ä¼šåœ¨åˆå§‹åŒ–å®ä¾‹æ—¶å¯¹å±æ€§æ‰§è¡Œ getter/setter è½¬åŒ–ï¼Œæ‰€ä»¥å±æ€§å¿…é¡»åœ¨ data å¯¹è±¡ä¸Šå­˜åœ¨æ‰èƒ½è®© Vue å°†å®ƒè½¬æ¢ä¸ºå“åº”å¼çš„ã€‚ å¯¹äºå·²ç»åˆ›å»ºçš„å®ä¾‹ï¼ŒVue ä¸å…è®¸åŠ¨æ€æ·»åŠ æ ¹çº§åˆ«çš„å“åº”å¼å±æ€§ã€‚ä½†æ˜¯ï¼Œå¯ä»¥ä½¿ç”¨ Vue.set(object, propertyName, value) æ–¹æ³•å‘åµŒå¥—å¯¹è±¡æ·»åŠ å“åº”å¼å±æ€§ã€‚ é‚£ä¹ˆ Vue å†…éƒ¨æ˜¯å¦‚ä½•è§£å†³å¯¹è±¡æ–°å¢å±æ€§ä¸èƒ½å“åº”çš„é—®é¢˜çš„å‘¢? export function set(target: Array | Object, key: any, val: any): any &#123; // target ä¸ºæ•°ç»„ if (Array.isArray(target) &amp;&amp; isValidArrayIndex(key)) &#123; // ä¿®æ”¹æ•°ç»„çš„é•¿åº¦, é¿å…ç´¢å¼•&gt;æ•°ç»„é•¿åº¦å¯¼è‡´splice()æ‰§è¡Œæœ‰è¯¯ target.length = Math.max(target.length, key); // åˆ©ç”¨æ•°ç»„çš„spliceå˜å¼‚æ–¹æ³•è§¦å‘å“åº”å¼ target.splice(key, 1, val); return val; &#125; // targetä¸ºå¯¹è±¡, keyåœ¨targetæˆ–è€…target.prototypeä¸Š ä¸”å¿…é¡»ä¸èƒ½åœ¨ Object.prototype ä¸Š,ç›´æ¥èµ‹å€¼ if (key in target &amp;&amp; !(key in Object.prototype)) &#123; target[key] = val; return val; &#125; // ä»¥ä¸Šéƒ½ä¸æˆç«‹, å³å¼€å§‹ç»™targetåˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å±æ€§ // è·å–Observerå®ä¾‹ const ob = (target: any).__ob__; // target æœ¬èº«å°±ä¸æ˜¯å“åº”å¼æ•°æ®, ç›´æ¥èµ‹å€¼ if (!ob) &#123; target[key] = val; return val; &#125; // è¿›è¡Œå“åº”å¼å¤„ç† defineReactive(ob.value, key, val); ob.dep.notify(); return val;&#125; å¦‚æœç›®æ ‡æ˜¯æ•°ç»„,ä½¿ç”¨ vue å®ç°çš„å˜å¼‚æ–¹æ³• splice å®ç°å“åº”å¼å¦‚æœç›®æ ‡æ˜¯å¯¹è±¡,åˆ¤æ–­å±æ€§å­˜åœ¨,å³ä¸ºå“åº”å¼,ç›´æ¥èµ‹å€¼å¦‚æœ target æœ¬èº«å°±ä¸æ˜¯å“åº”å¼,ç›´æ¥èµ‹å€¼å¦‚æœå±æ€§ä¸æ˜¯å“åº”å¼,åˆ™è°ƒç”¨ defineReactive æ–¹æ³•è¿›è¡Œå“åº”å¼å¤„ç† Vue.use æ–¹æ³•çš„å®ç°åŸç†Vue.use(plugin); ï¼ˆ1ï¼‰å‚æ•° plugin &#123; Object | Function;&#125; ï¼ˆ2ï¼‰ç”¨æ³• å®‰è£… Vue.js æ’ä»¶ã€‚å¦‚æœæ’ä»¶æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¿…é¡»æä¾› install æ–¹æ³•ã€‚å¦‚æœæ’ä»¶æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒä¼šè¢«ä½œä¸º install æ–¹æ³•ã€‚è°ƒç”¨ install æ–¹æ³•æ—¶ï¼Œä¼šå°† Vue ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚install æ–¹æ³•è¢«åŒä¸€ä¸ªæ’ä»¶å¤šæ¬¡è°ƒç”¨æ—¶ï¼Œæ’ä»¶ä¹Ÿåªä¼šè¢«å®‰è£…ä¸€æ¬¡ã€‚ å…³äºå¦‚ä½•ä¸Šå¼€å‘ Vue æ’ä»¶ï¼Œè¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼Œéå¸¸ç®€å•ï¼Œä¸ç”¨ä¸¤åˆ†é’Ÿå°±çœ‹å®Œï¼šå¦‚ä½•å¼€å‘ Vue æ’ä»¶ï¼Ÿ ï¼ˆ3ï¼‰ä½œç”¨ æ³¨å†Œæ’ä»¶ï¼Œæ­¤æ—¶åªéœ€è¦è°ƒç”¨ install æ–¹æ³•å¹¶å°† Vue ä½œä¸ºå‚æ•°ä¼ å…¥å³å¯ã€‚ä½†åœ¨ç»†èŠ‚ä¸Šæœ‰ä¸¤éƒ¨åˆ†é€»è¾‘è¦å¤„ç†ï¼š 1ã€æ’ä»¶çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯ install æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å« install æ–¹æ³•çš„å¯¹è±¡ã€‚ 2ã€æ’ä»¶åªèƒ½è¢«å®‰è£…ä¸€æ¬¡ï¼Œä¿è¯æ’ä»¶åˆ—è¡¨ä¸­ä¸èƒ½æœ‰é‡å¤çš„æ’ä»¶ã€‚ ï¼ˆ4ï¼‰å®ç° Vue.use = function (plugin) &#123; const installedPlugins = this._installedPlugins || (this._installedPlugins = []); if (installedPlugins.indexOf(plugin) &gt; -1) &#123; return this; &#125; // å…¶ä»–å‚æ•° const args = toArray(arguments, 1); args.unshift(this); if (typeof plugin.install === &#x27;function&#x27;) &#123; plugin.install.apply(plugin, args); &#125; else if (typeof plugin === &#x27;function&#x27;) &#123; plugin.apply(null, plugin, args); &#125; installedPlugins.push(plugin); return this;&#125;; 1ã€åœ¨ Vue å¯¹è±¡ ä¸Šæ–°å¢äº† use æ–¹æ³•ï¼Œå¹¶æ¥æ”¶ä¸€ä¸ªå‚æ•° pluginã€‚ 2ã€é¦–å…ˆåˆ¤æ–­æ’ä»¶æ˜¯ä¸æ˜¯å·²ç»åˆ«æ³¨å†Œè¿‡ï¼Œå¦‚æœè¢«æ³¨å†Œè¿‡ï¼Œåˆ™ç›´æ¥ç»ˆæ­¢æ–¹æ³•æ‰§è¡Œï¼Œæ­¤æ—¶åªéœ€è¦ä½¿ç”¨ indexOf æ–¹æ³•å³å¯ã€‚ 3ã€toArray æ–¹æ³•æˆ‘ä»¬åœ¨å°±æ˜¯å°†ç±»æ•°ç»„è½¬æˆçœŸæ­£çš„æ•°ç»„ã€‚ä½¿ç”¨ toArray æ–¹æ³•å¾—åˆ° argumentsã€‚é™¤äº†ç¬¬ä¸€ä¸ªå‚æ•°ä¹‹å¤–ï¼Œå‰©ä½™çš„æ‰€æœ‰å‚æ•°å°†å¾—åˆ°çš„åˆ—è¡¨èµ‹å€¼ç»™ argsï¼Œç„¶åå°† Vue æ·»åŠ åˆ° args åˆ—è¡¨çš„æœ€å‰é¢ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ä¿è¯ install æ–¹æ³•è¢«æ‰§è¡Œæ—¶ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ Vueï¼Œå…¶ä½™å‚æ•°æ˜¯æ³¨å†Œæ’ä»¶æ—¶ä¼ å…¥çš„å‚æ•°ã€‚ 4ã€ç”±äº plugin å‚æ•°æ”¯æŒå¯¹è±¡å’Œå‡½æ•°ç±»å‹ï¼Œæ‰€ä»¥é€šè¿‡åˆ¤æ–­ plugin.install å’Œ plugin å“ªä¸ªæ˜¯å‡½æ•°ï¼Œå³å¯çŸ¥ç”¨æˆ·ä½¿ç”¨å“ªç§æ–¹å¼ç¥–å†Œçš„æ’ä»¶ï¼Œç„¶åæ‰§è¡Œç”¨æˆ·ç¼–å†™çš„æ’ä»¶å¹¶å°† args ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚ 5ã€æœ€åï¼Œå°†æ’ä»¶æ·»åŠ åˆ° installedPlugins ä¸­ï¼Œä¿è¯ç›¸åŒçš„æ’ä»¶ä¸ä¼šåå¤è¢«æ³¨å†Œã€‚ Vuex çš„åŸç†vuex æœ¬è´¨æ˜¯æŒ‚è½½ä¸€ä¸ªåä¸º store çš„ vm ç»„ä»¶åœ¨ Vue çš„ä¸Šä¸‹æ–‡ç¯å¢ƒ 1.æ‰€ä»¥ this.$store éƒ½æ˜¯æ‰§è¡Œç»‘å®šçš„åŒä¸€ä¸ª sotre 2.åŒæ—¶ state å› ä¸ºåœ¨ vm ç»„ä»¶é‡Œé¢çš„ data, data æ˜¯ä½¿ç”¨new Vue()å»åˆ›å»ºä¸€ä¸ª Vue ç»„ä»¶â€“æ‰€ä»¥å…·å¤‡å“åº”å¼ ä¸ºä»€ä¹ˆä¸€å®šè¦ç”¨ mutation ä¸­ä¿®æ”¹ statestate ä¿®æ”¹çš„æºç â€“mutationæ“ä½œæ˜¯è°ƒç”¨_withCommit _withCommit (fn) &#123; // ä¿å­˜ä¹‹å‰çš„æäº¤çŠ¶æ€ const committing = this._committing // è¿›è¡Œæœ¬æ¬¡æäº¤ï¼Œè‹¥ä¸è®¾ç½®ä¸ºtrueï¼Œç›´æ¥ä¿®æ”¹stateï¼Œstrictæ¨¡å¼ä¸‹ï¼ŒVuexå°†ä¼šäº§ç”Ÿéæ³•ä¿®æ”¹stateçš„è­¦å‘Š this._committing = true // æ‰§è¡Œstateçš„ä¿®æ”¹æ“ä½œ fn() // ä¿®æ”¹å®Œæˆï¼Œè¿˜åŸæœ¬æ¬¡ä¿®æ”¹ä¹‹å‰çš„çŠ¶æ€ this._committing = committing&#125; Vuex æ ¸å¿ƒåŸç†","updated":"2025-08-02T05:46:04.180Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"vue","slug":"vue","permalink":"https://luckyship.github.io/tags/vue/"}]},{"title":"angular è·¯ç”±","date":"2022-07-09T02:59:05.000Z","path":"2022/07/09/2022-07-09-angular-router/","text":"è·¯ç”±æ³¨å†Œ&lt;router-outlet&gt;&lt;/router-outlet&gt;æ˜¯ angular è·¯ç”±çš„å ä½å…ƒç´ ï¼Œè¡¨ç¤ºè¦æŠŠå¯¹åº”çš„è·¯ç”±ç»„ä»¶æ¸²æŸ“åˆ°router-outletä¸­ä½¿ç”¨angular routerçš„é¡¹ç›®ï¼Œéœ€ä½¿ç”¨&lt;a routerLink=&quot;/crisis-center&quot;&gt;Crisis Center&lt;/a&gt;çš„å½¢å¼ï¼Œæ‰èƒ½åœ¨ angular å†…éƒ¨è·³è½¬ html &lt;h1&gt;Angular Router&lt;/h1&gt;&lt;nav&gt; &lt;a routerLink=&quot;/crisis-center&quot; routerLinkActive=&quot;active&quot; ariaCurrentWhenActive=&quot;page&quot;&gt;Crisis Center&lt;/a&gt; &lt;a routerLink=&quot;/heroes&quot; routerLinkActive=&quot;active&quot; ariaCurrentWhenActive=&quot;page&quot;&gt;Heroes&lt;/a&gt;&lt;/nav&gt;&lt;router-outlet&gt;&lt;/router-outlet&gt; æŠŠ RouterModule.forRoot() æ³¨å†Œåˆ° AppModule çš„ imports æ•°ç»„ä¸­ï¼Œèƒ½è®©è¯¥ Router æœåŠ¡åœ¨åº”ç”¨çš„ä»»ä½•åœ°æ–¹éƒ½èƒ½ä½¿ç”¨ã€‚ module import &#123; NgModule &#125; from &#x27;@angular/core&#x27;;import &#123; BrowserModule &#125; from &#x27;@angular/platform-browser&#x27;;import &#123; FormsModule &#125; from &#x27;@angular/forms&#x27;;import &#123; RouterModule, Routes &#125; from &#x27;@angular/router&#x27;;import &#123; AppComponent &#125; from &#x27;./app.component&#x27;;import &#123; CrisisListComponent &#125; from &#x27;./crisis-list/crisis-list.component&#x27;;import &#123; HeroListComponent &#125; from &#x27;./hero-list/hero-list.component&#x27;;const appRoutes: Routes = [ &#123; path: &#x27;crisis-center&#x27;, component: CrisisListComponent &#125;, &#123; path: &#x27;heroes&#x27;, component: HeroListComponent &#125;,];@NgModule(&#123; imports: [ BrowserModule, FormsModule, RouterModule.forRoot( appRoutes, &#123; enableTracing: true &#125; // &lt;-- debugging purposes only ), ], declarations: [AppComponent, HeroListComponent, CrisisListComponent], bootstrap: [AppComponent],&#125;)export class AppModule &#123;&#125; forRootåœ¨ä¸€ä¸ª angular é¡¹ç›®ä¸­åªèƒ½å‡ºç°ä¸€æ¬¡ï¼Œå¦‚æœæƒ³åœ¨å…¶ä»–æ¨¡å—ä¸­åœ¨å¼•å…¥å­è·¯ç”±ï¼Œåº”ä½¿ç”¨forChild é…ç½®è·¯ç”±è·³è½¬è§„åˆ™æ·»åŠ ä¸€ä¸ª redirect è·¯ç”±ï¼ŒæŠŠæœ€åˆçš„ç›¸å¯¹ URLï¼ˆ&#39;&#39;ï¼‰è½¬æ¢æˆæ‰€éœ€çš„é»˜è®¤è·¯å¾„ï¼ˆ/heroesï¼‰ã€‚&#39;**&#39;è¡¨ç¤ºæ²¡æœ‰ä»»ä½•åŒ¹é…æ—¶ï¼Œè·³è½¬åˆ°å¯¹åº”çš„æ²¡æœ‰é¡µé¢æç¤º const appRoutes: Routes = [ &#123; path: &#x27;crisis-center&#x27;, component: CrisisListComponent &#125;, &#123; path: &#x27;heroes&#x27;, component: HeroListComponent &#125;, &#123; path: &#x27;&#x27;, redirectTo: &#x27;/heroes&#x27;, pathMatch: &#x27;full&#x27; &#125;, &#123; path: &#x27;**&#x27;, component: PageNotFoundComponent &#125;,]; è·¯ç”±æ¨¡å—å£°æ˜ä¸€ä¸ªè·¯ç”±æ–‡ä»¶ src/app/app-routing.module.ts import &#123; NgModule &#125; from &#x27;@angular/core&#x27;;import &#123; RouterModule, Routes &#125; from &#x27;@angular/router&#x27;;import &#123; CrisisListComponent &#125; from &#x27;./crisis-list/crisis-list.component&#x27;;import &#123; HeroListComponent &#125; from &#x27;./hero-list/hero-list.component&#x27;;import &#123; PageNotFoundComponent &#125; from &#x27;./page-not-found/page-not-found.component&#x27;;const appRoutes: Routes = [ &#123; path: &#x27;crisis-center&#x27;, component: CrisisListComponent &#125;, &#123; path: &#x27;heroes&#x27;, component: HeroListComponent &#125;, &#123; path: &#x27;&#x27;, redirectTo: &#x27;/heroes&#x27;, pathMatch: &#x27;full&#x27; &#125;, &#123; path: &#x27;**&#x27;, component: PageNotFoundComponent &#125;,];@NgModule(&#123; imports: [ RouterModule.forRoot( appRoutes, &#123; enableTracing: true &#125; // &lt;-- debugging purposes only ), ], exports: [RouterModule],&#125;)export class AppRoutingModule &#123;&#125; src/app/app.module.ts import &#123; NgModule &#125; from &#x27;@angular/core&#x27;;import &#123; BrowserModule &#125; from &#x27;@angular/platform-browser&#x27;;import &#123; FormsModule &#125; from &#x27;@angular/forms&#x27;;import &#123; AppComponent &#125; from &#x27;./app.component&#x27;;import &#123; AppRoutingModule &#125; from &#x27;./app-routing.module&#x27;;import &#123; CrisisListComponent &#125; from &#x27;./crisis-list/crisis-list.component&#x27;;import &#123; HeroListComponent &#125; from &#x27;./hero-list/hero-list.component&#x27;;import &#123; PageNotFoundComponent &#125; from &#x27;./page-not-found/page-not-found.component&#x27;;@NgModule(&#123; imports: [BrowserModule, FormsModule, AppRoutingModule], declarations: [AppComponent, HeroListComponent, CrisisListComponent, PageNotFoundComponent], bootstrap: [AppComponent],&#125;)export class AppModule &#123;&#125; è·¯ç”±å‚æ•°&#123; path: &#x27;hero/:id&#x27;, component: HeroDetailComponent &#125; &lt;a [routerLink]=&quot;[&#x27;/hero&#x27;, hero.id]&quot;&gt;&lt;/a&gt; å¦‚ä½•åœ¨å¯¹åº”çš„ç»„ä»¶ä¸­æ‹¿åˆ° id çš„å‚æ•° import &#123; Router, ActivatedRoute, ParamMap &#125; from &#x27;@angular/router&#x27;;import &#123; switchMap &#125; from &#x27;rxjs/operators&#x27;;constructor( private route: ActivatedRoute, private router: Router, private service: HeroService) &#123;&#125;ngOnInit() &#123; this.hero$ = this.route.paramMap.pipe( switchMap((params: ParamMap) =&gt; this.service.getHero(params.get(&#x27;id&#x27;)!)) );&#125; å½“è¿™ä¸ª map å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒparamMap ä¼šä»æ›´æ”¹åçš„å‚æ•°ä¸­è·å– id å‚æ•°ã€‚ å½“ç”¨æˆ·ä»ä¸€ä¸ªè¯¦æƒ…åˆ—è¡¨è·³è½¬åˆ°å¦ä¸€ä¸ªè¯¦æƒ…åˆ—è¡¨ä¸­æ—¶ï¼Œangular ä¼šå¤ç”¨è¿™ä¸ªç»„ä»¶ï¼Œæ‰€ä»¥éœ€è¦è®¢é˜… router å¯¹è±¡çš„å˜åŒ–ï¼Œæ‰èƒ½å‡ºå‘è¯¦æƒ…åˆ—è¡¨è·¯ç”±å‚æ•°çš„å˜åŒ– activateRouterç›‘å¬ActivatedRouteä¹Ÿèƒ½æ‹¿åˆ°è·¯ç”±çš„å‚æ•°å€¼ constructor(private activatedRoute: ActivatedRoute)&#123;&#125;this.activatedRoute.params.subscribe(params =&gt; &#123; this.deviceId = params.deviceId;&#125;); sanpshotæœ¬åº”ç”¨ä¸éœ€è¦å¤ç”¨ HeroDetailComponentã€‚ç”¨æˆ·æ€»æ˜¯ä¼šå…ˆè¿”å›è‹±é›„åˆ—è¡¨ï¼Œå†é€‰æ‹©å¦ä¸€ä½è‹±é›„ã€‚æ‰€ä»¥ï¼Œä¸å­˜åœ¨ä»ä¸€ä¸ªè‹±é›„è¯¦æƒ…å¯¼èˆªåˆ°å¦ä¸€ä¸ªè€Œä¸ç”¨ç»è¿‡è‹±é›„åˆ—è¡¨çš„æƒ…å†µã€‚è¿™æ„å‘³ç€è·¯ç”±å™¨æ¯æ¬¡éƒ½ä¼šåˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ HeroDetailComponent å®ä¾‹ã€‚ å‡å¦‚ä½ å¾ˆç¡®å®šè¿™ä¸ª HeroDetailComponent å®ä¾‹æ°¸è¿œä¸ä¼šè¢«å¤ç”¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ snapshotã€‚ ngOnInit() &#123; const id = this.route.snapshot.paramMap.get(&#x27;id&#x27;)!; this.hero$ = this.service.getHero(id);&#125; ç”¨è¿™ç§æŠ€æœ¯ï¼Œsnapshot åªä¼šå¾—åˆ°è¿™äº›å‚æ•°çš„åˆå§‹å€¼ã€‚å¦‚æœè·¯ç”±å™¨å¯èƒ½å¤ç”¨è¯¥ç»„ä»¶ï¼Œé‚£ä¹ˆå°±è¯¥ç”¨ paramMap å¯è§‚å¯Ÿå¯¹è±¡çš„æ–¹å¼ã€‚æœ¬æ•™ç¨‹çš„ç¤ºä¾‹åº”ç”¨ä¸­å°±ç”¨äº† paramMap å¯è§‚å¯Ÿå¯¹è±¡ã€‚ ç¬¬äºŒè·¯ç”±ä½¿ç”¨ 2 ä¸ªrouter-outletï¼Œä½†æ˜¯å½¼æ­¤å¹¶ä¸äº’ç›¸å½±å“ &lt;div [@routeAnimation]=&quot;getAnimationData()&quot;&gt; &lt;router-outlet&gt;&lt;/router-outlet&gt;&lt;/div&gt;&lt;router-outlet name=&quot;popup&quot;&gt;&lt;/router-outlet&gt; æ³¨å†Œç¬¬äºŒè·¯ç”±module &#123; path: &#x27;compose&#x27;, component: ComposeMessageComponent, outlet: &#x27;popup&#x27;&#125;, å¦‚ä½•è·³è½¬åˆ°ç¬¬äºŒè·¯ç”± &lt;a [routerLink]=&quot;[&#123; outlets: &#123; popup: [&#x27;compose&#x27;] &#125; &#125;]&quot;&gt;Contact&lt;/a&gt; å› ä¸ºç¬¬äºŒè·¯ç”±ä¸ä¸»è·¯ç”±ä¸ç›¸äº’å½±å“ï¼Œå³ä½¿åœ¨ä¸»è·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç¬¬äºŒè·¯ç”±æ˜¾ç¤ºçš„ç»„ä»¶ä¹Ÿä¸ä¼šæ¶ˆå¤±ï¼Œæ‰€ä»¥é€‚ç”¨äºï¼šéœ€è¦ä¸€ç›´æ˜¾ç¤ºçš„ç»„ä»¶ï¼Œæ¯”å¦‚å¼¹çª—ï¼Œéœ€è¦åœ¨ä¸åŒçš„é¡µé¢éƒ½æ˜¾ç¤º é‚£ä¹ˆå¦‚ä½•æ¸…é™¤ç¬¬äºŒè·¯ç”± closePopup() &#123; // Providing a `null` value to the named outlet // clears the contents of the named outlet this.router.navigate([&#123; outlets: &#123; popup: null &#125;&#125;]);&#125; è·¯ç”±å®ˆå« å®ˆå«æ¥å£ è¯¦æƒ… CanActivate å¯¼èˆªåˆ°æŸè·¯ç”±æ—¶ä»‹å…¥ CanActivateChild å¯¼èˆªåˆ°æŸä¸ªå­è·¯ç”±æ—¶ä»‹å…¥ CanDeactivate ä»å½“å‰è·¯ç”±ç¦»å¼€æ—¶ä»‹å…¥ Resolve åœ¨æŸè·¯ç”±æ¿€æ´»ä¹‹å‰è·å–è·¯ç”±æ•°æ® CanLoad å¯¼èˆªåˆ°æŸä¸ªå¼‚æ­¥åŠ è½½çš„ç‰¹æ€§æ¨¡å—æ—¶ä»‹å…¥ å®ˆå«è¿”å›çš„å€¼ è¯¦æƒ… true å¯¼èˆªè¿‡ç¨‹ä¼šç»§ç»­ false å¯¼èˆªè¿‡ç¨‹å°±ä¼šç»ˆæ­¢ï¼Œä¸”ç”¨æˆ·ç•™åœ¨åŸåœ°ã€‚ UrlTree å–æ¶ˆå½“å‰å¯¼èˆªï¼Œå¹¶å¼€å§‹å¯¼èˆªåˆ°æ‰€è¿”å›çš„ UrlTree const crisisCenterRoutes: Routes = [ &#123; path: &#x27;crisis-center&#x27;, component: CrisisCenterComponent, children: [ &#123; path: &#x27;&#x27;, component: CrisisListComponent, children: [ &#123; path: &#x27;:id&#x27;, component: CrisisDetailComponent, canDeactivate: [CanDeactivateGuard], resolve: &#123; crisis: CrisisDetailResolverService, &#125;, &#125;, &#123; path: &#x27;&#x27;, component: CrisisCenterHomeComponent, &#125;, ], &#125;, ], &#125;,]; è·¯ç”±æ‡’åŠ è½½&#123; path: &#x27;admin&#x27;, loadChildren: () =&gt; import(&#x27;./admin/admin.module&#x27;).then(m =&gt; m.AdminModule),&#125;, é¢„åŠ è½½è¿™é¡¹é…ç½®ä¼šè®© Router é¢„åŠ è½½å™¨ç«‹å³åŠ è½½æ‰€æœ‰æƒ°æ€§åŠ è½½è·¯ç”±ï¼ˆå¸¦ loadChildren å±æ€§çš„è·¯ç”±ï¼‰ã€‚ RouterModule.forRoot(appRoutes, &#123; enableTracing: true, // &lt;-- debugging purposes only preloadingStrategy: PreloadAllModules,&#125;); å‚è€ƒangular router","updated":"2025-08-02T05:46:04.179Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"angular","slug":"angular","permalink":"https://luckyship.github.io/tags/angular/"}]},{"title":"typescriptä¸­privateã€publicã€protectedã€staticã€abstractã€readonly","date":"2022-05-01T10:25:34.000Z","path":"2022/05/01/2022-05-01-typescript-type-of-var/","text":"å­—æ®µå èŒƒå›´ private ç±»å†…éƒ¨ public ï¼ˆé»˜è®¤ï¼‰ç±»å†…éƒ¨å’Œå¤–éƒ¨ã€åŠå…¶å­ç±»éƒ½å¯è®¿é—® protected ç±»å†…éƒ¨å’Œå…¶å­ç±»ï¼ˆåŒºåˆ«ä¸ publicï¼Œå³å½“å‰ç±»å®ä¾‹åŒ–ä¸å¯è®¿é—®ï¼‰ static å­˜åœ¨äºç±»æœ¬èº«è€Œä¸æ˜¯ç±»çš„å®ä¾‹ä¸Š abstract å®šä¹‰æŠ½è±¡ç±»å’Œåœ¨æŠ½è±¡ç±»å†…éƒ¨å®šä¹‰æŠ½è±¡æ–¹æ³•ï¼Œåšä¸ºå…¶å®ƒæ´¾ç”Ÿç±»çš„åŸºç±»ä½¿ç”¨ï¼Œä¸€èˆ¬ä¸ä¼šç›´æ¥è¢«å®ä¾‹åŒ– readonly åªè¯»å±æ€§ å¤šä¸ªå…³é”®å­—å¯ä»¥åŒæ—¶ä½¿ç”¨é»˜è®¤ä¸å†™éƒ½ä¸º publicæ„é€ å‡½æ•°è¢«æ ‡è®°æˆ [protected]ã€‚ è¿™æ„å‘³ç€è¿™ä¸ªç±»ä¸èƒ½åœ¨åŒ…å«å®ƒçš„ç±»å¤–è¢«å®ä¾‹åŒ–ï¼Œä½†æ˜¯èƒ½è¢«ç»§æ‰¿class Person &#123; protected name: string; protected constructor(theName: string) &#123; this.name = theName; &#125;&#125;// Employee èƒ½å¤Ÿç»§æ‰¿ Personclass Employee extends Person &#123; private department: string; constructor(name: string, department: string) &#123; super(name); this.department = department; &#125; public getElevatorPitch() &#123; return `Hello, my name is $&#123;this.name&#125; and I work in $&#123;this.department&#125;.`; &#125;&#125;let howard = new Employee(&#x27;Howard&#x27;, &#x27;Sales&#x27;);let john = new Person(&#x27;John&#x27;); // é”™è¯¯: &#x27;Person&#x27; çš„æ„é€ å‡½æ•°æ˜¯è¢«ä¿æŠ¤çš„. [readonly] å…³é”®å­—å°†å±æ€§è®¾ç½®ä¸ºåªè¯»çš„class Octopus &#123; readonly name: string; readonly numberOfLegs: number = 8; constructor(theName: string) &#123; this.name = theName; &#125;&#125;let dad = new Octopus(&#x27;Man with the 8 strong legs&#x27;);dad.name = &#x27;Man with the 3-piece suit&#x27;; // é”™è¯¯! name æ˜¯åªè¯»çš„. [static] å…³é”®å­—ï¼Œä½¿å¾—å±æ€§å­˜åœ¨äºç±»æœ¬èº«è€Œä¸æ˜¯ç±»çš„å®ä¾‹ä¸Šclass Test &#123; static $name: string = &#x27;bob&#x27;;&#125;console.log(Test.$name); // bob [abstract]å…³é”®å­—æ˜¯ç”¨äºå®šä¹‰æŠ½è±¡ç±»å’Œåœ¨æŠ½è±¡ç±»å†…éƒ¨å®šä¹‰æŠ½è±¡æ–¹æ³•ï¼Œåšä¸ºå…¶å®ƒæ´¾ç”Ÿç±»çš„åŸºç±»ä½¿ç”¨ï¼Œä¸€èˆ¬ä¸ä¼šç›´æ¥è¢«å®ä¾‹åŒ–abstract class Animal &#123; abstract makeSound(): void; move(): void &#123; console.log(&#x27;roaming the earch...&#x27;); &#125;&#125; abstract å’Œ protected åŒºåˆ«abstract å…³é”®å­—æ–¹æ³•å±æ€§å¿…é¡»è¢«[å­ç±»]å®šä¹‰ï¼Œå½“å‰ç±»ä¸å¯å®ä¾‹åŒ–ï¼Œå­ç±»å®ä¾‹å¯ç›´æ¥è¾“å‡ºï¼›protected å…³é”®å­—æ–¹æ³•å±æ€§ä»…å¯è¢«å½“å‰ç±»å’Œå­ç±»ä½¿ç”¨ï¼Œä¸å¯ç›´æ¥è¾“å‡º abstract class Father &#123; protected name: string = &#x27;bob&#x27;; abstract age: number = 12;&#125;class Son1 extends Father &#123; age: number; sayName() &#123; console.log(this.name); &#125;&#125;class Son2 extends Son1 &#123; age: number; sayName() &#123; console.log(this.name); &#125;&#125;const s1 = new Son1();const s2 = new Son2();console.log(s1.name, s2.name); // Errorconsole.log(s1.age, s2.age);console.log(s1.sayName(), s2.sayName());","updated":"2025-08-02T05:46:04.179Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"typescript","slug":"typescript","permalink":"https://luckyship.github.io/tags/typescript/"}]},{"title":"å‰ç«¯debuggeræŠ€å·§","date":"2022-03-13T13:26:16.000Z","path":"2022/03/13/2022-03-13-frontend-debugger/","text":"å¯¼è¨€å¼€å‘ç¯å¢ƒ debug æ˜¯æ¯ä¸ªç¨‹åºå‘˜ä¸Šå²—çš„å¿…å¤‡æŠ€èƒ½ã€‚ç”Ÿäº§ç¯å¢ƒå‘¢ï¼Ÿè™½ç„¶ç”Ÿäº§ç¯å¢ƒ debug æ˜¯ä¸€ä»¶éå¸¸ä¸ä¼˜é›…çš„è¡Œä¸ºï¼Œä½†æ˜¯ç”±äºç§ç§åŸå› ï¼Œæˆ‘ä»¬åˆä¸å¾—ä¸è¿™ä¹ˆå¹²ã€‚ é‚£æˆ‘ä»¬ä»Šå¤©è®²ä¸€è®²å¦‚ä½•ä½¿ç”¨ chrome åœ¨ç”Ÿäº§ç¯å¢ƒè¿›è¡Œ debug ã€‚ ç”Ÿäº§ç¯å¢ƒ debug æ­¥éª¤ç”Ÿäº§ç¯å¢ƒ debug éœ€è¦å‡ æ­¥ï¼Ÿè¿™é—®é¢˜å’Œâ€œæŠŠå¤§è±¡è£…è¿›å†°ç®±æ‹¢å…±åˆ†å‡ æ­¥â€ä¸€æ ·ç®€å•ã€‚ ç¬¬ä¸€æ­¥ï¼ŒæŠŠå†°ç®±é—¨æ‰“å¼€ã€‚F12 æ‰“å¼€ devToolsï¼› ç¬¬äºŒæ­¥ï¼ŒæŠŠå¤§è±¡è£…è¿›å†°ç®±ã€‚æ‰¾åˆ°éœ€è¦ debug çš„å‰ç«¯æ–‡ä»¶ï¼Œæ ¼å¼åŒ–ï¼Œæ‰“æ–­ç‚¹ï¼Œè°ƒè¯•ä¸Šä¸‹æ–‡ï¼Œå®šä½é—®é¢˜ï¼› ç¬¬ä¸‰æ­¥ï¼Œå…³é—­å†°ç®±é—¨ã€‚è§£å†³é—®é¢˜ã€‚ å¦‚ä½•å¿«é€Ÿå®šä½é”™è¯¯æ˜¯å‰ç«¯è¿˜æ˜¯åç«¯æ¥å£è¿”å›çš„ï¼Ÿåœ¨æŠŠå¤§è±¡è£…è¿›å†°ç®±ä¹‹å‰ï¼Œå…ˆåˆæ­¥åˆ¤æ–­ä¸‹ï¼Œæ˜¯å¦çœŸçš„éœ€è¦ç”±ä½ å°†å¤§è±¡è£…è¿›å†°ç®±ã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ¤æ–­ï¼Œé”™è¯¯æ˜¯å‰ç«¯è¿˜æ˜¯åç«¯æŠ¥çš„ï¼Œé‚£ä¹ˆå¦‚ä½•å¿«é€Ÿåˆ¤æ–­ï¼Ÿ æ–¹æ¡ˆä¸€ï¼šæ ¹æ®å¯¹ä»£ç çš„å®ç°çš„äº†è§£ï¼Œåˆ¤æ–­æŠ¥é”™å±äºå‰ç«¯è¿˜æ˜¯åç«¯ã€‚è¿™ä¸ªæ–¹æ¡ˆå‰ææ˜¯éœ€è¦ä½ å¯¹ä»£ç å®ç°å¾ˆç†Ÿæ‚‰ï¼Œä¹Ÿæ˜¯æœ€ç®€å•çš„æ–¹å¼ã€‚ æ–¹æ¡ˆäºŒï¼šå‰ç«¯ä»£ç å…¨å±€æœç´¢å…³é”®å­—ï¼Œå·¥ç¨‹ä»£ç é‡Œæœç´¢/æ§åˆ¶å°æ‰“å¼€æœç´¢ã€‚å¯¹åº”å·¥ç¨‹ gitlab æˆ–è€… vscode æˆ–è€… devTools global search é‡Œå»è¿›è¡Œå…¨å±€æœç´¢ã€‚ æ–¹æ¡ˆä¸‰ï¼šç¿»é˜… network é¢æ¿ä¸­çš„è¯·æ±‚ã€‚ç¿»é˜… network é¢æ¿ä¸­çš„è¯·æ±‚ï¼Œçœ‹ä¸‹è¿”å›çš„ response æ˜¯å¦æºå¸¦é”™è¯¯æç¤ºï¼Œæœ‰åˆ™è¡¨ç¤ºåç«¯è¿”å›çš„ï¼›å¦‚æœæŠ¥é”™çš„æ¥å£åˆšå¥½æ˜¯ä»¥é200 çš„çŠ¶æ€è¿”å›ï¼Œæˆ–è€…æ˜¯ç”±æ–°çš„æ“ä½œè§¦å‘è°ƒç”¨æ¥å£ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±èƒ½æŸ¥æ‰¾åˆ°å¯¹åº”çš„æ¥å£ æ–¹æ¡ˆå››ï¼šä½¿ç”¨ network search è¿›è¡Œæœç´¢ã€‚ä½†æ˜¯å¾ˆå¤šæƒ…å†µï¼Œæ¥å£ä¸šåŠ¡é”™è¯¯ä¼šä»¥ http status 200 çš„çŠ¶æ€ç è¿”å›ï¼Œå¦‚æœæ­¤æ—¶è¯·æ±‚äº†å¤§é‡çš„æ¥å£ï¼ˆä¸¾ä¸ªä¾‹å­ï¼šè¿›å…¥é¡µé¢è°ƒç”¨äº†å¤§é‡çš„æ¥å£ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæ¥å£è¿”å›äº†é”™è¯¯ä¿¡æ¯ï¼‰ï¼Œé‚£ä¹ˆé™¤äº†é€ä¸ªç¿»é˜… network è¿™ç§ä½æ•ˆçš„æ–¹å¼ï¼Œchrome devTools è¿˜æä¾›äº† network search é¢æ¿è¿™ç§æ›´ä¾¿æ·çš„æ–¹å¼ï¼Œå¯ä»¥æœç´¢æ¥å£è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…æ‹¬è¯¦ç»†çš„è¿”å›ä¿¡æ¯ï¼‰ï¼Œè¿”å›åŒ¹é…ç»“æœã€‚ å¦‚ä½•æ‰“å¼€ network search é¢æ¿ï¼Ÿ åœ¨ network é¢æ¿ä¸­ï¼ŒæŒ‰å¿«æ·é”® âŒ˜ + Fï¼ˆMacï¼‰ã€ CTRL + Fï¼ˆWindowsï¼‰å¯å‘¼å‡º network search é¢æ¿ã€‚å¦‚æœç¡®å®šéœ€è¦ä½ æŠŠå¤§è±¡è£…è¿›å†°ç®±ï¼Œé‚£æŠŠå¤§è±¡è£…è¿›å†°ç®±çš„æŠ€å·§æœ‰å“ªäº›ï¼Ÿ å¦‚ä½•å¿«é€Ÿå®šä½åˆ°é—®é¢˜ç›¸å…³çš„ä»£ç global search ï¼Œå…¨å±€æœç´ å…³é”®å­—ï¼Œå†å®šä½åˆ°å…³é”®çš„ä»£ç chrome devTools çš„ global search æ˜¯ä¸€ä¸ªéå¸¸å®ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå½“ä½ ä¸çŸ¥é“éœ€è¦è°ƒè¯•çš„ä»£ç åœ¨å“ªä¸ªæ–‡ä»¶æ—¶ï¼Œå½“ä½ æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„ç³»ç»Ÿï¼Œå¼•ç”¨äº†å¾ˆå¤šçš„èµ„æºæ–‡ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ global search è¿›è¡Œæœç´¢å…³é”®å­—ï¼Œè¿™ä¸ªæ“ä½œä¼šæœç´¢æ‰€æœ‰åŠ è½½è¿›æ¥çš„èµ„æºï¼Œç‚¹å‡»æœç´¢ç»“æœï¼Œå°±å¯ä»¥ä½¿ç”¨ source é¢æ¿æ‰“å¼€å¯¹åº”çš„èµ„æºæ–‡ä»¶ï¼Œç„¶åæ ¼å¼åŒ–ä»£ç ï¼Œå†ç„¶ååœ¨å½“å‰çš„æ–‡ä»¶å†… å†æ¬¡æœç´¢å…³é”®å­—ï¼Œæ‰“æ–­ç‚¹ã€‚ æ‰“å¼€ global search å¿«æ·é”®ï¼š âŒ˜ + âŒ¥ + F ï¼ˆMacï¼‰ï¼ŒCTRL + SHIFT + F ï¼ˆWindowsï¼‰ çœ‹ä¸‹å›¾ä¾‹å­ï¼Œæˆ‘ä»¬éšä¾¿æ‰¾ä¸ªé¡µé¢æ ¹æ®æç¤ºæœç´¢ä»£ç ï¼š å¯ä»¥å°è¯•ä½¿ç”¨å“ªäº›å…³é”®å­—è¿›è¡Œæœç´¢ï¼š (1) é¡µé¢å­˜åœ¨æ˜ç¡®çš„æŠ¥é”™ä¿¡æ¯ï¼Œä¸”å·²ç»æ˜ç¡®è¯¥é”™è¯¯æ–‡æ¡ˆæ˜¯å†™åœ¨å‰ç«¯ä»£ç ä¸­é”™è¯¯ä¿¡æ¯æ–‡æ¡ˆã€‚æç¤ºä¿¡æ¯åœ¨ coding è¿‡ç¨‹ä¸­ä¸€èˆ¬æ˜¯ä½¿ç”¨ å­—ç¬¦ä¸²ï¼Œå‹ç¼©æ··æ·†è¿‡ç¨‹ä¸­ä¸€èˆ¬æ˜¯ä¸ä¼šè¿›è¡Œå¤„ç†çš„ï¼Œä¼šä¿ç•™åŸæ–‡ï¼Œå½“ç„¶ä»£ç æ‰“åŒ…æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå¯¹ä»£ç å‹ç¼©æ··æ·†ä¹Ÿå¯ä»¥é€‰æ‹©å¯¹ä¸­æ–‡è¿›è¡Œ unicode è½¬ç ï¼Œæ­¤æ—¶å¦‚æœå…³é”®å­—æ˜¯ä¸­æ–‡ï¼Œå°±éœ€è¦å…ˆè½¬ç å†æœç´¢äº†ã€‚ (2) å·²çŸ¥ç›¸å…³ä»£ç ä¸­å­˜åœ¨çš„ç¼–è¯‘æ··æ·†åä¾ç„¶è¿˜ä¿ç•™çš„çš„å…³é”®ä»£ç ï¼Œä¼šå‘å¤–æš´éœ²çš„æ–¹æ³•åï¼› å¦‚ä½• debug æ··æ·†åçš„ js ï¼Ÿç”Ÿäº§ç¯å¢ƒçš„ js åŸºæœ¬ä¸Šéƒ½æ˜¯æ··æ·†è¿‡çš„ï¼ˆç‚¹å‡»äº†è§£å‰ç«¯ä»£ç çš„å‹ç¼©æ··æ·† (https://todo.com/)ï¼‰ï¼Œå‹ç¼©æ··æ·†çš„ä¼˜ç‚¹å°±ä¸èµ˜è¿°äº†ï¼Œå‹ç¼©æ··æ·†åéšä¹‹æ¥çš„æ˜¯ç”Ÿäº§ç¯å¢ƒè°ƒè¯•çš„éš¾åº¦ï¼Œè™½ç„¶é€šè¿‡æ‰“æ–­ç‚¹ï¼Œå‹‰å¼ºè¿˜èƒ½çœ‹çš„æ‡‚ï¼Œä½†æ˜¯å·²ç»å¾ˆåäººç±»äº†ã€‚ æˆ‘ä»¬ç”¨ä¸€ä¸ªæœ€ç®€å•çš„ demo ï¼Œå¯¹æ¯”ä¸€ä¸‹ä»£ç ç”Ÿäº§ç¯å¢ƒæ„å»ºç¼–è¯‘å‰åçš„å·®è·ã€‚ è¿™é‡Œé€‰æ‹©ç”¨ vue-cli åˆ›å»ºäº†ä¸€ä¸ªæœ€ç®€å•çš„ demo ï¼Œçœ‹ä¸‹æºä»£ç å’Œç¼–è¯‘åçš„ä»£ç ã€‚ æºä»£ç ï¼š æ„å»ºç¼–è¯‘åçš„ä»£ç ï¼ˆæ­¤å¤„å…³é—­äº† sourceMap ï¼‰ï¼š è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°æ„å»ºç¼–è¯‘åçš„ä»£ç åšäº†å‹ç¼©æ··æ·†ï¼Œå‡ºç°äº†å‡ºç°äº†å¤§é‡å¤§çš„ a ã€b ã€ c ã€ d æ›¿æ¢äº†åŸæœ‰çš„å‡½æ•°æ–¹æ³•åã€å˜é‡åï¼Œç¼–è¯‘åçš„ä»£ç å·²ç»ä¸æ˜¯èƒ½é€šè¿‡å•çº¯çš„è¯»ä»£ç ç èƒ½è¯»æ‡‚çš„äº†ã€‚ä½†æ˜¯æˆ‘ä»¬é€šè¿‡ debug ï¼Œå¤§æ¦‚è¿˜æ˜¯èƒ½çœ‹å¾—æ‡‚ã€‚ é‚£ä¹ˆæœ‰æ²¡æœ‰æ–¹å¼ä½¿ç”¨æœ¬åœ°çš„ sourceMap è°ƒè¯•ç”Ÿäº§ç¯å¢ƒçš„ä»£ç ï¼Ÿç­”æ¡ˆå½“ç„¶æ˜¯æœ‰çš„ã€‚ å¦‚ä½•åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨æœ¬åœ° sourceMap è°ƒè¯•ï¼Ÿç¬¬ä¸€æ­¥ï¼šæ‰“å¼€æ··æ·†ä»£ç  ç¬¬äºŒæ­¥ï¼šå³é”® -&gt; é€‰æ‹©ã€Add source mapã€‘ ç¬¬ä¸‰æ­¥ï¼šè¾“å…¥æœ¬åœ° sourceMap çš„åœ°å€ï¼ˆæ­¤å¤„éœ€è¦å¯ç”¨ä¸€ä¸ªé™æ€èµ„æºæœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ http-server (https://www.npmjs.com/package/http-server)ï¼‰ï¼Œå®Œæˆã€‚æœ¬åœ°ä»£ç æ‰§è¡Œæ„å»ºå‘½ä»¤ï¼Œæ³¨æ„éœ€è¦æ‰“å¼€ sourceMap é…ç½®ï¼Œç¼–è¯‘äº§ç”Ÿå‡ºæ„å»ºåçš„ä»£ç ï¼Œæ­¤æ—¶æ„å»ºåçš„ç»“æœä¼šåŒ…å« sourceMap æ–‡ä»¶ã€‚ å…³è”ä¸Š sourceMap åï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ° sources -&gt; page é¢æ¿ä¸Šçš„å˜åŒ–äº† å¦‚ä½•åœ¨ chrome ä¸­ä¿®æ”¹ä»£ç å¹¶è°ƒè¯•ï¼Ÿå¼€å‘ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ IDE ä¸­ä¿®æ”¹ä»£ç ï¼Œä»£ç çš„å˜æ›´å°±ç›´æ¥æ›´æ–°åˆ°äº†æµè§ˆå™¨ä¸­äº†ã€‚é‚£ä¹ˆç”Ÿäº§ç¯å¢ƒï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ chrome ä¸­ä¿®æ”¹ä»£ç ï¼Œç„¶åç«‹é©¬çœ‹ä»£ç ä¿®æ”¹åçš„æ•ˆæœå—ï¼Ÿ å½“ç„¶ï¼Œä½ æƒ³è¦çš„ chrome devTools éƒ½æœ‰ã€‚chrome devTools æä¾›äº† local overrides èƒ½åŠ›ã€‚ local overrides å¦‚ä½•å·¥ä½œçš„ï¼ŸæŒ‡å®šä¿®æ”¹åçš„æ–‡ä»¶çš„æœ¬åœ°ä¿å­˜ç›®å½•ï¼Œå½“ä¿®æ”¹å®Œä»£ç ä¿å­˜çš„æ—¶å€™ï¼Œå°±ä¼šå°†ä¿®æ”¹åçš„æ–‡ä»¶ä¿å­˜åˆ°ä½ æŒ‡å®šçš„ç›®å½•ç›®å½•ä¸‹ï¼Œå½“å†æ¬¡åŠ è½½é¡µé¢çš„æ—¶å€™ï¼Œå¯¹åº”çš„æ–‡ä»¶ä¸å†è¯»å–ç½‘ç»œä¸Šçš„æ–‡ä»¶ï¼Œè€Œæ˜¯è¯»å–å­˜å‚¨åœ¨æœ¬åœ°ä¿®æ”¹è¿‡çš„æ–‡ä»¶ã€‚ local overrides å¦‚ä½•ä½¿ç”¨ï¼Ÿé¦–å…ˆï¼Œæ‰“å¼€ sources ä¸‹çš„ overrides é¢æ¿ï¼› ç„¶åï¼Œç‚¹å‡»ã€select folder overridesã€‘é€‰æ‹©ä¿®æ”¹åçš„æ–‡ä»¶å­˜å‚¨åœ°å€ï¼› å†ç„¶åï¼Œç‚¹å‡»é¡¶éƒ¨çš„æˆæƒï¼Œç¡®è®¤åŒæ„ï¼› æœ€åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰“å¼€æ–‡ä»¶ä¿®æ”¹ï¼Œä¿®æ”¹å®Œæˆåä¿å­˜ï¼Œé‡æ–°åˆ·æ–°é¡µé¢åï¼Œä¿®æ”¹åçš„ä»£ç å°±è¢«æ‰§è¡Œåˆ°äº†ã€‚ âš ï¸ æ³¨æ„ï¼ŒåŸ js æ–‡ä»¶ç›´æ¥ format æ˜¯æ— æ³•ä¿®æ”¹çš„ï¼›åœ¨ä»£ç  format ä¹‹å‰å…ˆæ·»åŠ æ— æ•ˆä»£ç è¿›è¡Œä»£ç å˜æ›´è¿›è¡Œä¿å­˜ï¼Œç„¶åå† format å°±å¯ä»¥ä¿®æ”¹ æ€»ç»“chrome è°ƒè¯•æŠ€å·§è¿œè¿œå½“ç„¶ä¸åªè¿™äº›ï¼Œä»¥ä¸Šåªæ˜¯ç”Ÿäº§ç¯å¢ƒ debug çš„å°æŠ€å·§ï¼Œç¥æ„¿å¤§å®¶ç”¨ä¸åˆ°ï¼Œæœ€å¥½çš„ bug å¤„ç†æ–¹å¼å½“ç„¶æ˜¯äº‹å‰ï¼Œåœ¨ä¸Šçº¿å‰å¾—åˆ°å°±è§£å†³ï¼›å¦‚æœçœŸçš„å‘ç”Ÿé—®é¢˜ï¼Œå¦‚æœåšå¥½ç›‘æ§å’Œæ—¥å¿—ï¼Œåœ¨é—®é¢˜å‘ç”Ÿçš„ç¬¬ä¸€æ—¶é—´å‘ç°å¹¶è§£å†³ã€‚","updated":"2025-08-02T05:46:04.179Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"ç®—æ³•ä¸­çš„æ—¶é—´å¤æ‚åº¦","date":"2022-03-13T06:50:11.000Z","path":"2022/03/13/2022-03-13-time-complexity/","text":"å¦‚ä½•è®¡ç®—æ—¶é—´å¤æ‚åº¦æˆ‘ä»¬æ¥çœ‹ä¸€é“é¢˜ç›®ï¼š åŠ›æ‰£é¢˜ç›®é“¾æ¥ ç»™å®šä¸€ä¸ªå«æœ‰ n ä¸ªæ­£æ•´æ•°çš„æ•°ç»„å’Œä¸€ä¸ªæ­£æ•´æ•° s ï¼Œæ‰¾å‡ºè¯¥æ•°ç»„ä¸­æ»¡è¶³å…¶å’Œ â‰¥ s çš„é•¿åº¦æœ€å°çš„ è¿ç»­ å­æ•°ç»„ï¼Œå¹¶è¿”å›å…¶é•¿åº¦ã€‚å¦‚æœä¸å­˜åœ¨ç¬¦åˆæ¡ä»¶çš„å­æ•°ç»„ï¼Œè¿”å› 0ã€‚ ç¤ºä¾‹ï¼š è¾“å…¥ï¼šs = 7, nums = [2,3,1,2,4,3] è¾“å‡ºï¼š2 è§£é‡Šï¼šå­æ•°ç»„ [4,3] æ˜¯è¯¥æ¡ä»¶ä¸‹çš„é•¿åº¦æœ€å°çš„å­æ•°ç»„ã€‚ æš´åŠ›ç ´è§£è¿™é“é¢˜ç›®æš´åŠ›è§£æ³•å½“ç„¶æ˜¯ ä¸¤ä¸ª for å¾ªç¯ï¼Œç„¶åä¸æ–­çš„å¯»æ‰¾ç¬¦åˆæ¡ä»¶çš„å­åºåˆ—ï¼Œæ—¶é—´å¤æ‚åº¦å¾ˆæ˜æ˜¾æ˜¯$O(n^2)$ã€‚ ä»£ç å¦‚ä¸‹ï¼š class Solution &#123;public: int minSubArrayLen(int s, vector&lt;int&gt;&amp; nums) &#123; int result = INT32_MAX; // æœ€ç»ˆçš„ç»“æœ int sum = 0; // å­åºåˆ—çš„æ•°å€¼ä¹‹å’Œ int subLength = 0; // å­åºåˆ—çš„é•¿åº¦ for (int i = 0; i &lt; nums.size(); i++) &#123; // è®¾ç½®å­åºåˆ—èµ·ç‚¹ä¸ºi sum = 0; for (int j = i; j &lt; nums.size(); j++) &#123; // è®¾ç½®å­åºåˆ—ç»ˆæ­¢ä½ç½®ä¸ºj sum += nums[j]; if (sum &gt;= s) &#123; // ä¸€æ—¦å‘ç°å­åºåˆ—å’Œè¶…è¿‡äº†sï¼Œæ›´æ–°result subLength = j - i + 1; // å–å­åºåˆ—çš„é•¿åº¦ result = result &lt; subLength ? result : subLength; break; // å› ä¸ºæˆ‘ä»¬æ˜¯æ‰¾ç¬¦åˆæ¡ä»¶æœ€çŸ­çš„å­åºåˆ—ï¼Œæ‰€ä»¥ä¸€æ—¦ç¬¦åˆæ¡ä»¶å°±break &#125; &#125; &#125; // å¦‚æœresultæ²¡æœ‰è¢«èµ‹å€¼çš„è¯ï¼Œå°±è¿”å›0ï¼Œè¯´æ˜æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„å­åºåˆ— return result == INT32_MAX ? 0 : result; &#125;&#125;; æ»‘åŠ¨çª—å£æ¥ä¸‹æ¥å°±å¼€å§‹ä»‹ç»æ•°ç»„æ“ä½œä¸­å¦ä¸€ä¸ªé‡è¦çš„æ–¹æ³•ï¼šæ»‘åŠ¨çª—å£ã€‚ æ‰€è°“æ»‘åŠ¨çª—å£ï¼Œå°±æ˜¯ä¸æ–­çš„è°ƒèŠ‚å­åºåˆ—çš„èµ·å§‹ä½ç½®å’Œç»ˆæ­¢ä½ç½®ï¼Œä»è€Œå¾—å‡ºæˆ‘ä»¬è¦æƒ³çš„ç»“æœã€‚ var minSubArrayLen = function (target, nums) &#123; // é•¿åº¦è®¡ç®—ä¸€æ¬¡ const len = nums.length; let l = (r = sum = 0), res = len + 1; // å­æ•°ç»„æœ€å¤§ä¸ä¼šè¶…è¿‡è‡ªèº« while (r &lt; len) &#123; sum += nums[r++]; // çª—å£æ»‘åŠ¨ while (sum &gt;= target) &#123; // rå§‹ç»ˆä¸ºå¼€åŒºé—´ [l, r) res = res &lt; r - l ? res : r - l; sum -= nums[l++]; &#125; &#125; return res &gt; len ? 0 : res;&#125;; æ—¶é—´å¤æ‚åº¦ï¼š$O(n)$ ç©ºé—´å¤æ‚åº¦ï¼š$O(1)$ ä¸ºä»€ä¹ˆæ—¶é—´å¤æ‚åº¦æ˜¯$O(n)$ã€‚ä¸è¦ä»¥ä¸º for é‡Œæ”¾ä¸€ä¸ª while å°±ä»¥ä¸ºæ˜¯$O(n^2)$å•Šï¼Œ ä¸»è¦æ˜¯çœ‹æ¯ä¸€ä¸ªå…ƒç´ è¢«æ“ä½œçš„æ¬¡æ•°ï¼Œæ¯ä¸ªå…ƒç´ åœ¨æ»‘åŠ¨çª—åè¿›æ¥æ“ä½œä¸€æ¬¡ï¼Œå‡ºå»æ“ä½œä¸€æ¬¡ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æ˜¯è¢«è¢«æ“ä½œä¸¤æ¬¡ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯ 2 Ã— n ä¹Ÿå°±æ˜¯$O(n)$ã€‚ è€Œæš´åŠ›ç ´è§£ï¼Œæœ€åçš„æƒ…å†µï¼Œæœ€åä¸€ä¸ªå…ƒç´ æ¯ä¸ªå¾ªç¯éƒ½è¦è¢«ç”¨åˆ°ï¼Œæ‰€ä»¥æ˜¯ $O(n^2)$","updated":"2025-08-02T05:46:04.179Z","tags":[]},{"title":"Viteä»‹ç»","date":"2022-02-26T02:42:45.000Z","path":"2022/02/26/2022-02-26-vite/","text":"Vite æ˜¯ä»€ä¹ˆï¼ŸViteæ˜¯æ–°ä¸€ä»£çš„å‰ç«¯æ„å»ºå·¥å…·ï¼Œåœ¨å°¤é›¨æºªå¼€å‘Vue3.0çš„æ—¶å€™è¯ç”Ÿã€‚ç±»ä¼¼äºWebpack+ Webpack-dev-serverã€‚å…¶ä¸»è¦åˆ©ç”¨æµè§ˆå™¨ESMç‰¹æ€§å¯¼å…¥ç»„ç»‡ä»£ç ï¼Œåœ¨æœåŠ¡å™¨ç«¯æŒ‰éœ€ç¼–è¯‘è¿”å›ï¼Œå®Œå…¨è·³è¿‡äº†æ‰“åŒ…è¿™ä¸ªæ¦‚å¿µï¼ŒæœåŠ¡å™¨éšèµ·éšç”¨ã€‚ç”Ÿäº§ä¸­åˆ©ç”¨Rollupä½œä¸ºæ‰“åŒ…å·¥å…·ï¼Œå·ç§°ä¸‹ä¸€ä»£çš„å‰ç«¯æ„å»ºå·¥å…·ã€‚ Viteæœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š å¿«é€Ÿçš„å†·å¯åŠ¨: No Bundle + esbuild é¢„æ„å»º å³æ—¶çš„æ¨¡å—çƒ­æ›´æ–°: åŸºäºESMçš„HMRï¼ŒåŒæ—¶åˆ©ç”¨æµè§ˆå™¨ç¼“å­˜ç­–ç•¥æå‡é€Ÿåº¦ çœŸæ­£çš„æŒ‰éœ€åŠ è½½: åˆ©ç”¨æµè§ˆå™¨ESMæ”¯æŒï¼Œå®ç°çœŸæ­£çš„æŒ‰éœ€åŠ è½½ Vite å’Œä¼ ç»Ÿæ‰“åŒ…æ–¹å¼çš„å¯¹æ¯” VS WebapckWebpackæ˜¯è¿‘å¹´æ¥ä½¿ç”¨é‡æœ€å¤§ï¼ŒåŒæ—¶ç¤¾åŒºæœ€å®Œå–„çš„å‰ç«¯æ‰“åŒ…æ„å»ºå·¥å…·ï¼Œæ–°å‡ºçš„5.xç‰ˆæœ¬å¯¹æ„å»ºç»†èŠ‚è¿›è¡Œäº†ä¼˜åŒ–ï¼Œåœ¨éƒ¨åˆ†åœºæ™¯ä¸‹æ‰“åŒ…é€Ÿåº¦æå‡æ˜æ˜¾ã€‚Webpackåœ¨å¯åŠ¨æ—¶ï¼Œä¼šå…ˆæ„å»ºé¡¹ç›®æ¨¡å—çš„ä¾èµ–å›¾ï¼Œå¦‚æœåœ¨é¡¹ç›®ä¸­çš„æŸä¸ªåœ°æ–¹æ”¹åŠ¨äº†ä»£ç ï¼ŒWebpackåˆ™ä¼šå¯¹ç›¸å…³çš„ä¾èµ–é‡æ–°æ‰“åŒ…ï¼Œéšç€é¡¹ç›®çš„å¢å¤§ï¼Œå…¶æ‰“åŒ…é€Ÿåº¦ä¹Ÿä¼šä¸‹é™ã€‚ Viteç›¸æ¯”äºWebpackè€Œè¨€ï¼Œæ²¡æœ‰æ‰“åŒ…çš„è¿‡ç¨‹ï¼Œè€Œæ˜¯ç›´æ¥å¯åŠ¨äº†ä¸€ä¸ªå¼€å‘æœåŠ¡å™¨ devServerã€‚ViteåŠ«æŒæµè§ˆå™¨çš„HTTPè¯·æ±‚ï¼Œåœ¨åç«¯è¿›è¡Œç›¸åº”çš„å¤„ç†å°†é¡¹ç›®ä¸­ä½¿ç”¨çš„æ–‡ä»¶é€šè¿‡ç®€å•çš„åˆ†è§£ä¸æ•´åˆï¼Œç„¶åå†è¿”å›ç»™æµè§ˆå™¨(æ•´ä¸ªè¿‡ç¨‹æ²¡æœ‰å¯¹æ–‡ä»¶è¿›è¡Œæ‰“åŒ…ç¼–è¯‘)ã€‚æ‰€ä»¥ç¼–è¯‘é€Ÿåº¦å¾ˆå¿«ã€‚ VS SnowPackSnowpack é¦–æ¬¡æå‡ºåˆ©ç”¨æµè§ˆå™¨åŸç”ŸESMèƒ½åŠ›çš„æ‰“åŒ…å·¥å…·ï¼Œå…¶ç†å¿µå°±æ˜¯å‡å°‘æˆ–é¿å…æ•´ä¸ªbundleçš„æ‰“åŒ…ã€‚é»˜è®¤åœ¨ dev å’Œ production ç¯å¢ƒéƒ½ä½¿ç”¨ unbundle çš„æ–¹å¼æ¥éƒ¨ç½²åº”ç”¨ã€‚ä½†æ˜¯å®ƒçš„æ„å»ºæ—¶å´æ˜¯äº¤ç»™ç”¨æˆ·è‡ªå·±é€‰æ‹©ï¼Œæ•´ä½“çš„æ‰“åŒ…ä½“éªŒæ˜¾å¾—æœ‰ç‚¹æ”¯ç¦»ç ´ç¢ã€‚ è€Œ Vite ç›´æ¥æ•´åˆäº† Rollupï¼Œä¸ºç”¨æˆ·æä¾›äº†å®Œå–„ã€å¼€ç®±å³ç”¨çš„è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”ç”±äºè¿™äº›é›†æˆï¼Œä¹Ÿæ–¹ä¾¿æ‰©å±•æ›´å¤šçš„é«˜çº§åŠŸèƒ½ã€‚ ä¸¤è€…è¾ƒå¤§çš„åŒºåˆ«æ˜¯åœ¨éœ€è¦bundleæ‰“åŒ…çš„æ—¶å€™Vite ä½¿ç”¨ Rollup å†…ç½®é…ç½®ï¼Œè€Œ Snowpack é€šè¿‡å…¶ä»–æ’ä»¶å°†å…¶å§”æ‰˜ç»™ Parcel/``webpackã€‚ å‰ç½®çŸ¥è¯†ESMåœ¨äº†è§£Viteä¹‹å‰ï¼Œéœ€è¦å…ˆäº†è§£ä¸‹ESM ESMæ˜¯JavaScriptæå‡ºçš„å®˜æ–¹æ ‡å‡†åŒ–æ¨¡å—ç³»ç»Ÿï¼Œä¸åŒäºä¹‹å‰çš„CJSï¼ŒAMDï¼ŒCMDç­‰ç­‰ï¼ŒESMæä¾›äº†æ›´åŸç”Ÿä»¥åŠæ›´åŠ¨æ€çš„æ¨¡å—åŠ è½½æ–¹æ¡ˆï¼Œæœ€é‡è¦çš„å°±æ˜¯å®ƒæ˜¯æµè§ˆå™¨åŸç”Ÿæ”¯æŒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­å»æ‰§è¡Œimportï¼ŒåŠ¨æ€å¼•å…¥æˆ‘ä»¬éœ€è¦çš„æ¨¡å—ï¼Œè€Œä¸æ˜¯æŠŠæ‰€æœ‰æ¨¡å—æ‰“åŒ…åœ¨ä¸€èµ·ã€‚ ç›®å‰ESMæ¨¡å—åŒ–å·²ç»æ”¯æŒ 92%ä»¥ä¸Šçš„æµè§ˆå™¨ï¼Œè€Œä¸”ä¸”ä½œä¸º ECMA æ ‡å‡†ï¼Œæœªæ¥ä¼šæœ‰æ›´å¤šæµè§ˆå™¨æ”¯æŒECMAè§„èŒƒ å½“æˆ‘ä»¬åœ¨ä½¿ç”¨æ¨¡å—å¼€å‘æ—¶ï¼Œå…¶å®å°±æ˜¯åœ¨æ„å»ºä¸€å¼ æ¨¡å—ä¾èµ–å…³ç³»å›¾ï¼Œå½“æ¨¡å—åŠ è½½æ—¶ï¼Œå°±ä¼šä»å…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæœ€ç»ˆç”Ÿæˆå®Œæ•´çš„æ¨¡å—å®ä¾‹å›¾ã€‚ ESMçš„æ‰§è¡Œå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š æ„å»º: ç¡®å®šä»å“ªé‡Œä¸‹è½½è¯¥æ¨¡å—æ–‡ä»¶ã€ä¸‹è½½å¹¶å°†æ‰€æœ‰çš„æ–‡ä»¶è§£æä¸ºæ¨¡å—è®°å½• å®ä¾‹åŒ–: å°†æ¨¡å—è®°å½•è½¬æ¢ä¸ºä¸€ä¸ªæ¨¡å—å®ä¾‹ï¼Œä¸ºæ‰€æœ‰çš„æ¨¡å—åˆ†é…å†…å­˜ç©ºé—´ï¼Œä¾ç…§å¯¼å‡ºã€å¯¼å…¥è¯­å¥æŠŠæ¨¡å—æŒ‡å‘å¯¹åº”çš„å†…å­˜åœ°å€ã€‚ è¿è¡Œï¼šè¿è¡Œä»£ç ï¼Œå°†å†…å­˜ç©ºé—´å¡«å…… ä»ä¸Šé¢å®ä¾‹åŒ–çš„è¿‡ç¨‹å¯ä»¥çœ‹å‡ºï¼ŒESMä½¿ç”¨å®æ—¶ç»‘å®šçš„æ¨¡å¼ï¼Œå¯¼å‡ºå’Œå¯¼å…¥çš„æ¨¡å—éƒ½æŒ‡å‘ç›¸åŒçš„å†…å­˜åœ°å€ï¼Œä¹Ÿå°±æ˜¯å€¼å¼•ç”¨ã€‚è€ŒCJSé‡‡ç”¨çš„æ˜¯å€¼æ‹·è´ï¼Œå³æ‰€æœ‰å¯¼å‡ºå€¼éƒ½æ˜¯æ‹·è´å€¼ã€‚ EsbuildViteåº•å±‚ä½¿ç”¨Esbuildå®ç°å¯¹.``tsã€jsxã€.``jsä»£ç æ–‡ä»¶çš„è½¬åŒ–ï¼Œæ‰€ä»¥å…ˆçœ‹ä¸‹ä»€ä¹ˆæ˜¯es-buildã€‚ Esbuildæ˜¯ä¸€ä¸ªJavaScript Bundler æ‰“åŒ…å’Œå‹ç¼©å·¥å…·ï¼Œå®ƒæä¾›äº†ä¸Webpackã€Rollupç­‰å·¥å…·ç›¸ä¼¼çš„èµ„æºæ‰“åŒ…èƒ½åŠ›ã€‚å¯ä»¥å°†JavaScript å’ŒTypeScriptä»£ç æ‰“åŒ…åˆ†å‘åœ¨ç½‘é¡µä¸Šè¿è¡Œã€‚ä½†å…¶æ‰“åŒ…é€Ÿåº¦å´æ˜¯å…¶ä»–å·¥å…·çš„ 10 ï½ 100 å€ã€‚ ç›®å‰ä»–æ”¯æŒä»¥ä¸‹çš„åŠŸèƒ½ï¼š åŠ è½½å™¨ å‹ç¼© æ‰“åŒ… Tree shaking Source mapç”Ÿæˆ esbuildæ€»å…±æä¾›äº†å››ä¸ªå‡½æ•°ï¼štransformã€buildã€buildSyncã€Serviceã€‚æœ‰å…´è¶£çš„å¯ä»¥ç§»æ­¥å®˜æ–¹æ–‡æ¡£äº†è§£ã€‚ Rollupåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼ŒViteä½¿ç”¨Rollupæ¥è¿›è¡Œæ‰“åŒ… Rollupæ˜¯åŸºäºESMçš„JavaScriptæ‰“åŒ…å·¥å…·ã€‚ç›¸æ¯”äºå…¶ä»–æ‰“åŒ…å·¥å…·å¦‚Webpackï¼Œä»–æ€»æ˜¯èƒ½æ‰“å‡ºæ›´å°ã€æ›´å¿«çš„åŒ…ã€‚å› ä¸º Rollup åŸºäº ESM æ¨¡å—ï¼Œæ¯” Webpack å’Œ Browserify ä½¿ç”¨çš„ CommonJSæ¨¡å—æœºåˆ¶æ›´é«˜æ•ˆã€‚Rollupçš„äº®ç‚¹åœ¨äºåŒä¸€ä¸ªåœ°æ–¹ï¼Œä¸€æ¬¡æ€§åŠ è½½ã€‚èƒ½é’ˆå¯¹æºç è¿›è¡Œ Tree Shaking(å»é™¤é‚£äº›å·²è¢«å®šä¹‰ä½†æ²¡è¢«ä½¿ç”¨çš„ä»£ç )ï¼Œä»¥åŠ Scope Hoisting ä»¥å‡å°è¾“å‡ºæ–‡ä»¶å¤§å°æå‡è¿è¡Œæ€§èƒ½ã€‚ Rollupåˆ†ä¸ºbuildï¼ˆæ„å»ºï¼‰é˜¶æ®µå’Œoutput generateï¼ˆè¾“å‡ºç”Ÿæˆï¼‰é˜¶æ®µã€‚ä¸»è¦è¿‡ç¨‹å¦‚ä¸‹ï¼š è·å–å…¥å£æ–‡ä»¶çš„å†…å®¹ï¼ŒåŒ…è£…æˆmoduleï¼Œç”ŸæˆæŠ½è±¡è¯­æ³•æ ‘ å¯¹å…¥å£æ–‡ä»¶æŠ½è±¡è¯­æ³•æ ‘è¿›è¡Œä¾èµ–è§£æ ç”Ÿæˆæœ€ç»ˆä»£ç  å†™å…¥ç›®æ ‡æ–‡ä»¶ å¦‚æœä½ çš„é¡¹ç›®ï¼ˆç‰¹åˆ«æ˜¯ç±»åº“ï¼‰åªæœ‰JavaScriptï¼Œè€Œæ²¡æœ‰å…¶ä»–çš„é™æ€èµ„æºæ–‡ä»¶ï¼Œä½¿ç”¨Webpackå°±æœ‰ç‚¹å¤§æ‰å°ç”¨äº†ã€‚å› ä¸ºWebpack æ‰“åŒ…çš„æ–‡ä»¶çš„ä½“ç§¯ç•¥å¤§ï¼Œè¿è¡Œç•¥æ…¢ï¼Œå¯è¯»æ€§ç•¥ä½ã€‚è¿™æ—¶å€™Rollupä¹Ÿä¸å¤±ä¸ºä¸€ä¸ªå¥½é€‰æ‹©ã€‚ è¿™é‡Œæƒ³å¯¹ Rollp è¿›è¡Œæ›´æ·±å…¥çš„å­¦ä¹ å¯ä»¥çœ‹çœ‹å®˜ç½‘çš„ä»‹ç»ã€‚ æ ¸å¿ƒåŸç†è¯¦ç»†é˜è¿°ä¸‹ï¼š å½“å£°æ˜ä¸€ä¸ª scriptæ ‡ç­¾ç±»å‹ä¸º module æ—¶,å¦‚ &lt;script type=&quot;module&quot; src=&quot;/src/main.js&quot;&gt;&lt;/script&gt;å¤åˆ¶ä»£ç  å½“æµè§ˆå™¨è§£æèµ„æºæ—¶ï¼Œä¼šå¾€å½“å‰åŸŸåå‘èµ·ä¸€ä¸ªGETè¯·æ±‚main.jsæ–‡ä»¶ // main.jsimport &#123; createApp &#125; from &#x27;vue&#x27;import App from &#x27;./App.vue&#x27;createApp(App).mount(&#x27;#app&#x27;)å¤åˆ¶ä»£ç  è¯·æ±‚åˆ°äº†main.jsæ–‡ä»¶ï¼Œä¼šæ£€æµ‹åˆ°å†…éƒ¨å«æœ‰importå¼•å…¥çš„åŒ…ï¼Œåˆä¼šimport å¼•ç”¨å‘èµ·HTTPè¯·æ±‚è·å–æ¨¡å—çš„å†…å®¹æ–‡ä»¶ï¼Œå¦‚App.vueã€vueæ–‡ä»¶ Viteå…¶æ ¸å¿ƒåŸç†æ˜¯åˆ©ç”¨æµè§ˆå™¨ç°åœ¨å·²ç»æ”¯æŒES6çš„import,ç¢°è§importå°±ä¼šå‘é€ä¸€ä¸ªHTTPè¯·æ±‚å»åŠ è½½æ–‡ä»¶ï¼ŒViteå¯åŠ¨ä¸€ä¸ª koa æœåŠ¡å™¨æ‹¦æˆªè¿™äº›è¯·æ±‚ï¼Œå¹¶åœ¨åç«¯è¿›è¡Œç›¸åº”çš„å¤„ç†å°†é¡¹ç›®ä¸­ä½¿ç”¨çš„æ–‡ä»¶é€šè¿‡ç®€å•çš„åˆ†è§£ä¸æ•´åˆï¼Œç„¶åå†ä»¥ESMæ ¼å¼è¿”å›è¿”å›ç»™æµè§ˆå™¨ã€‚Viteæ•´ä¸ªè¿‡ç¨‹ä¸­æ²¡æœ‰å¯¹æ–‡ä»¶è¿›è¡Œæ‰“åŒ…ç¼–è¯‘ï¼Œåšåˆ°äº†çœŸæ­£çš„æŒ‰éœ€åŠ è½½ï¼Œæ‰€ä»¥å…¶è¿è¡Œé€Ÿåº¦æ¯”åŸå§‹çš„webpackå¼€å‘ç¼–è¯‘é€Ÿåº¦å¿«å‡ºè®¸å¤šï¼ åŸºäº ESM çš„ Dev serveråœ¨Viteå‡ºæ¥ä¹‹å‰ï¼Œä¼ ç»Ÿçš„æ‰“åŒ…å·¥å…·å¦‚Webpackæ˜¯å…ˆè§£æä¾èµ–ã€æ‰“åŒ…æ„å»ºå†å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ŒDev Server å¿…é¡»ç­‰å¾…æ‰€æœ‰æ¨¡å—æ„å»ºå®Œæˆï¼Œå½“æˆ‘ä»¬ä¿®æ”¹äº† bundleæ¨¡å—ä¸­çš„ä¸€ä¸ªå­æ¨¡å—ï¼Œ æ•´ä¸ª bundle æ–‡ä»¶éƒ½ä¼šé‡æ–°æ‰“åŒ…ç„¶åè¾“å‡ºã€‚é¡¹ç›®åº”ç”¨è¶Šå¤§ï¼Œå¯åŠ¨æ—¶é—´è¶Šé•¿ã€‚ è€ŒViteåˆ©ç”¨æµè§ˆå™¨å¯¹ESMçš„æ”¯æŒï¼Œå½“ import æ¨¡å—æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šä¸‹è½½è¢«å¯¼å…¥çš„æ¨¡å—ã€‚å…ˆå¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œå½“ä»£ç æ‰§è¡Œåˆ°æ¨¡å—åŠ è½½æ—¶å†è¯·æ±‚å¯¹åº”æ¨¡å—çš„æ–‡ä»¶,æœ¬è´¨ä¸Šå®ç°äº†åŠ¨æ€åŠ è½½ã€‚ç°è‰²éƒ¨åˆ†æ˜¯æš‚æ—¶æ²¡æœ‰ç”¨åˆ°çš„è·¯ç”±ï¼Œæ‰€æœ‰è¿™éƒ¨åˆ†ä¸ä¼šå‚ä¸æ„å»ºè¿‡ç¨‹ã€‚éšç€é¡¹ç›®é‡Œçš„åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œå¢åŠ routeï¼Œä¹Ÿä¸ä¼šå½±å“å…¶æ„å»ºé€Ÿåº¦ã€‚ åŸºäº ESM çš„ HMR çƒ­æ›´æ–°ç›®å‰æ‰€æœ‰çš„æ‰“åŒ…å·¥å…·å®ç°çƒ­æ›´æ–°çš„æ€è·¯éƒ½å¤§åŒå°å¼‚ï¼šä¸»è¦æ˜¯é€šè¿‡WebSocketåˆ›å»ºæµè§ˆå™¨å’ŒæœåŠ¡å™¨çš„é€šä¿¡ç›‘å¬æ–‡ä»¶çš„æ”¹å˜ï¼Œå½“æ–‡ä»¶è¢«ä¿®æ”¹æ—¶ï¼ŒæœåŠ¡ç«¯å‘é€æ¶ˆæ¯é€šçŸ¥å®¢æˆ·ç«¯ä¿®æ”¹ç›¸åº”çš„ä»£ç ï¼Œå®¢æˆ·ç«¯å¯¹åº”ä¸åŒçš„æ–‡ä»¶è¿›è¡Œä¸åŒçš„æ“ä½œçš„æ›´æ–°ã€‚ VS WebpackWebpack: é‡æ–°ç¼–è¯‘ï¼Œè¯·æ±‚å˜æ›´åæ¨¡å—çš„ä»£ç ï¼Œå®¢æˆ·ç«¯é‡æ–°åŠ è½½ Vite: è¯·æ±‚å˜æ›´çš„æ¨¡å—ï¼Œå†é‡æ–°åŠ è½½ Vite é€šè¿‡ chokidar æ¥ç›‘å¬æ–‡ä»¶ç³»ç»Ÿçš„å˜æ›´ï¼Œåªç”¨å¯¹å‘ç”Ÿå˜æ›´çš„æ¨¡å—é‡æ–°åŠ è½½ï¼Œ åªéœ€è¦ç²¾ç¡®çš„ä½¿ç›¸å…³æ¨¡å—ä¸å…¶ä¸´è¿‘çš„ HMRè¾¹ç•Œè¿æ¥å¤±æ•ˆå³å¯ï¼Œè¿™æ ·HMR æ›´æ–°é€Ÿåº¦å°±ä¸ä¼šå› ä¸ºåº”ç”¨ä½“ç§¯çš„å¢åŠ è€Œå˜æ…¢è€Œ Webpack è¿˜è¦ç»å†ä¸€æ¬¡æ‰“åŒ…æ„å»ºã€‚æ‰€ä»¥ HMR åœºæ™¯ä¸‹ï¼ŒVite è¡¨ç°ä¹Ÿè¦å¥½äº Webpackã€‚ æ ¸å¿ƒæµç¨‹Viteæ•´ä¸ªçƒ­æ›´æ–°è¿‡ç¨‹å¯ä»¥åˆ†æˆå››æ­¥ åˆ›å»ºä¸€ä¸ªwebsocketæœåŠ¡ç«¯å’Œclientæ–‡ä»¶ï¼Œå¯åŠ¨æœåŠ¡ é€šè¿‡chokidarç›‘å¬æ–‡ä»¶å˜æ›´ å½“ä»£ç å˜æ›´åï¼ŒæœåŠ¡ç«¯è¿›è¡Œåˆ¤æ–­å¹¶æ¨é€åˆ°å®¢æˆ·ç«¯ å®¢æˆ·ç«¯æ ¹æ®æ¨é€çš„ä¿¡æ¯æ‰§è¡Œä¸åŒæ“ä½œçš„æ›´æ–° æ•´ä½“æµç¨‹å›¾ï¼š å¯åŠ¨çƒ­æ›´æ–°ï¼šcreateWebSocketServeråœ¨ Vite`` dev server å¯åŠ¨ä¹‹å‰ï¼ŒVite ä¼šä¸º HMR åšä¸€äº›å‡†å¤‡å·¥ä½œï¼šæ¯”å¦‚åˆ›å»ºwebsocketæœåŠ¡ï¼Œåˆ©ç”¨chokidaråˆ›å»ºä¸€ä¸ªç›‘å¬å¯¹è±¡ watcher ç”¨äºå¯¹æ–‡ä»¶ä¿®æ”¹è¿›è¡Œç›‘å¬ç­‰ç­‰ï¼Œå…·ä½“æ ¸å¿ƒä»£ç ï¼š æºç ä½ç½®ï¼špackages/vite/src/node/server/index.ts export async function createServer( inlineConfig: InlineConfig = &#123;&#125;): Promise&lt;ViteDevServer&gt; &#123; .... const ws = createWebSocketServer(httpServer, config, httpsOptions) const &#123; ignored = [], ...watchOptions &#125; = serverConfig.watch || &#123;&#125; const watcher = chokidar.watch(path.resolve(root), &#123; ignored: [ &#x27;**/node_modules/**&#x27;, &#x27;**/.git/**&#x27;, ...(Array.isArray(ignored) ? ignored : [ignored]) ], ignoreInitial: true, ignorePermissionErrors: true, disableGlobbing: true, ...watchOptions &#125;) as FSWatcher .... watcher.on(&#x27;change&#x27;, async (file) =&gt; &#123; &#125;) watcher.on(&#x27;add&#x27;, (file) =&gt; &#123; &#125;) watcher.on(&#x27;unlink&#x27;, (file) =&gt; &#123; &#125;) ... return server&#125;å¤åˆ¶ä»£ç  createWebSocketServerè¿™ä¸ªæ–¹æ³•ä¸»æ˜¯åˆ›å»ºWebSocketæœåŠ¡å¹¶å¯¹é”™è¯¯è¿›è¡Œä¸€äº›å¤„ç†ï¼Œæœ€åè¿”å›å°è£…å¥½çš„onã€offã€ send å’Œ close æ–¹æ³•ï¼Œç”¨äºåç»­æœåŠ¡ç«¯æ¨é€æ¶ˆæ¯å’Œå…³é—­æœåŠ¡ã€‚ æºç ä½ç½®ï¼špackages/vite/src/node/server/ws.ts export function createWebSocketServer( server: Server | null, config: ResolvedConfig, httpsOptions?: HttpsServerOptions): WebSocketServer &#123; let wss: WebSocket let httpsServer: Server | undefined = undefined // çƒ­æ›´æ–°é…ç½® const hmr = isObject(config.server.hmr) &amp;&amp; config.server.hmr const wsServer = (hmr &amp;&amp; hmr.server) || server // æ™®é€šæ¨¡å¼ if (wsServer) &#123; wss = new WebSocket(&#123; noServer: true &#125;) wsServer.on(&#x27;upgrade&#x27;, (req, socket, head) =&gt; &#123; // ç›‘å¬é€šè¿‡viteå®¢æˆ·ç«¯å‘é€çš„websocketæ¶ˆæ¯ï¼Œé€šè¿‡HMR_HEADERåŒºåˆ† if (req.headers[&#x27;sec-websocket-protocol&#x27;] === HMR_HEADER) &#123; wss.handleUpgrade(req, socket as Socket, head, (ws) =&gt; &#123; wss.emit(&#x27;connection&#x27;, ws, req) &#125;) &#125; &#125;) &#125; else &#123; // ä¸­é—´ä»¶æ¨¡å¼ // vite dev server in middleware mode wss = new WebSocket(websocketServerOptions) &#125; wss.on(&#x27;connection&#x27;, (socket) =&gt; &#123; ... &#125;) // é”™è¯¯å¤„ç† wss.on(&#x27;error&#x27;, (e: Error &amp; &#123; code: string &#125;) =&gt; &#123; ... &#125;) // è¿”å› return &#123; on: wss.on.bind(wss), off: wss.off.bind(wss), send(payload: HMRPayload) &#123; ... &#125;, close() &#123; ... &#125; &#125;&#125;å¤åˆ¶ä»£ç  æ‰§è¡Œçƒ­æ›´æ–°ï¼šmoduleGraph+handleHMRUpdate æ¨¡å—æ¥æ”¶åˆ°æ–‡ä»¶æ”¹åŠ¨æ‰§è¡Œçš„å›è°ƒï¼Œè¿™é‡Œä¸»è¦ä¸¤ä¸ªæ“ä½œï¼šmoduleGraph.onFileChangeä¿®æ”¹æ–‡ä»¶çš„ç¼“å­˜å’ŒhandleHMRUpdateæ‰§è¡Œçƒ­æ›´æ–° æºç ä½ç½®ï¼špackages/vite/src/node/server/index.ts watcher.on(&#x27;change&#x27;, async file =&gt; &#123; file = normalizePath(file); if (file.endsWith(&#x27;/package.json&#x27;)) &#123; return invalidatePackageData(packageCache, file); &#125; // invalidate module graph cache on file change moduleGraph.onFileChange(file); if (serverConfig.hmr !== false) &#123; try &#123; await handleHMRUpdate(file, server); &#125; catch (err) &#123; ws.send(&#123; type: &#x27;error&#x27;, err: prepareError(err), &#125;); &#125; &#125;&#125;);å¤åˆ¶ä»£ç ; 3.2.2.2.1 moduleGraph moduleGraph æ˜¯Viteå®šä¹‰çš„ç”¨æ¥è®°å½•æ•´ä¸ªåº”ç”¨çš„æ¨¡å—ä¾èµ–å›¾çš„ç±»ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰moduleNodeã€‚ æºç ä½ç½®ï¼špackages/vite/src/node/server/moduleGraph.ts moduleGraphæ˜¯ç”±ä¸€ç³»åˆ— map ç»„æˆï¼Œè€Œè¿™äº›mapåˆ†åˆ«æ˜¯urlã€idã€fileç­‰ä¸ModuleNodeçš„æ˜ å°„ï¼Œè€ŒModuleNode æ˜¯ Viteä¸­å®šä¹‰çš„æœ€å°æ¨¡å—å•ä½ã€‚é€šè¿‡è¿™ä¸¤ä¸ªç±»å¯ä»¥æ„å»ºä¸‹é¢çš„æ¨¡å—ä¾èµ–å›¾ï¼š å¯ä»¥çœ‹çœ‹moduleGraph.``onFileChangeè¿™ä¸ªå‡½æ•°ï¼šä¸»è¦æ˜¯ç”¨æ¥æ¸…ç©ºè¢«ä¿®æ”¹æ–‡ä»¶å¯¹åº”çš„ModuleNodeå¯¹è±¡çš„ transformResult å±æ€§ï¼Œä½¿ä¹‹å‰çš„æ¨¡å—å·²æœ‰çš„è½¬æ¢ç¼“å­˜å¤±æ•ˆã€‚è¿™å—ä¹Ÿå°±æ˜¯Viteåœ¨çƒ­æ›´æ–°é‡Œçš„ç¼“å­˜æœºåˆ¶ã€‚å¯ä»¥çœ‹çœ‹å®˜ç½‘çš„ä»‹ç»ã€‚ æºç ä½ç½®ï¼špackages/vite/src/node/server/moduleGraph.ts onFileChange(file: string): void &#123; const mods = this.getModulesByFile(file) if (mods) &#123; const seen = new Set&lt;ModuleNode&gt;() mods.forEach((mod) =&gt; &#123; this.invalidateModule(mod, seen) &#125;) &#125; &#125; invalidateModule(mod: ModuleNode, seen: Set&lt;ModuleNode&gt; = new Set()): void &#123; mod.info = undefined mod.transformResult = null mod.ssrTransformResult = null invalidateSSRModule(mod, seen) &#125; 3.2.2.2.2 handleHMRUpdate handleHMRUpdate æ¨¡å—ä¸»è¦æ˜¯ç›‘å¬æ–‡ä»¶çš„æ›´æ”¹ï¼Œè¿›è¡Œå¤„ç†å’Œåˆ¤æ–­é€šè¿‡WebSocketç»™å®¢æˆ·ç«¯å‘é€æ¶ˆæ¯é€šçŸ¥å®¢æˆ·ç«¯å»è¯·æ±‚æ–°çš„æ¨¡å—ä»£ç ã€‚ æºç ä½ç½®ï¼špackages/vite/packages/vite/src/node/server/hmr.ts å®¢æˆ·ç«¯ï¼šwebsocket é€šä¿¡å’Œæ›´æ–°å¤„ç†å®¢æˆ·ç«¯ï¼šå½“æˆ‘ä»¬é…ç½®äº†çƒ­æ›´æ–°ä¸”ä¸æ˜¯ssrçš„æ—¶å€™ï¼ŒViteåº•å±‚åœ¨å¤„ç† html çš„æ—¶å€™ä¼šæŠŠHMRç›¸å…³çš„å®¢æˆ·ç«¯ä»£ç å†™å…¥åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œå¦‚ä¸‹ï¼š å½“æ¥æ”¶åˆ°æœåŠ¡ç«¯æ¨é€çš„æ¶ˆæ¯ï¼Œé€šè¿‡ä¸åŒçš„æ¶ˆæ¯ç±»å‹åšç›¸åº”çš„å¤„ç†ï¼Œå¦‚(connectedã€updateã€customâ€¦)ï¼Œåœ¨å®é™…å¼€å‘çƒ­æ›´æ–°ä¸­ä½¿ç”¨æœ€é¢‘ç¹çš„æ˜¯update(åŠ¨æ€åŠ è½½çƒ­æ›´æ–°æ¨¡å—)å’Œfull-reload(åˆ·æ–°æ•´ä¸ªé¡µé¢)äº‹ä»¶ã€‚ æºç ä½ç½®ï¼špackages/vite/packages/vite/src/client/client.ts æ ¸å¿ƒä»£ç å®ç° ä¼˜åŒ–ï¼šæµè§ˆå™¨çš„ç¼“å­˜ç­–ç•¥æé«˜å“åº”é€Ÿåº¦åŒæ—¶ï¼ŒVite è¿˜åˆ©ç”¨HTTPåŠ é€Ÿæ•´ä¸ªé¡µé¢çš„é‡æ–°åŠ è½½ã€‚è®¾ç½®å“åº”å¤´ä½¿å¾—ä¾èµ–æ¨¡å—(dependency module)è¿›è¡Œå¼ºç¼“å­˜ï¼Œè€Œæºç æ–‡ä»¶é€šè¿‡è®¾ç½® 304 Not Modified è€Œå˜æˆå¯ä¾æ®æ¡ä»¶è€Œè¿›è¡Œæ›´æ–°ã€‚ è‹¥éœ€è¦å¯¹ä¾èµ–ä»£ç æ¨¡å—åšæ”¹åŠ¨å¯æ‰‹åŠ¨æ“ä½œä½¿ç¼“å­˜å¤±æ•ˆ: vite --forceå¤åˆ¶ä»£ç  æˆ–è€…æ‰‹åŠ¨åˆ é™¤ node_modules/.``vite ä¸­çš„ç¼“å­˜æ–‡ä»¶ã€‚ åŸºäº esbuild çš„ä¾èµ–é¢„ç¼–è¯‘ä¼˜åŒ–ä¸ºä»€ä¹ˆéœ€è¦é¢„æ„å»ºï¼Ÿ æ”¯æŒcommonJSä¾èµ– ä¸Šé¢æåˆ°Viteæ˜¯åŸºäºæµè§ˆå™¨åŸç”Ÿæ”¯æŒESMçš„èƒ½åŠ›å®ç°çš„ï¼Œä½†è¦æ±‚ç”¨æˆ·çš„ä»£ç æ¨¡å—å¿…é¡»æ˜¯ESMæ¨¡å—ï¼Œå› æ­¤å¿…é¡»å°†commonJsçš„æ–‡ä»¶æå‰å¤„ç†ï¼Œè½¬åŒ–æˆ ESM æ¨¡å—å¹¶ç¼“å­˜å…¥ node_modules/.vite å‡å°‘æ¨¡å—å’Œè¯·æ±‚æ•°é‡ é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„lodashå·¥å…·åº“ï¼Œé‡Œé¢æœ‰å¾ˆå¤šåŒ…é€šè¿‡å•ç‹¬çš„æ–‡ä»¶ç›¸äº’å¯¼å…¥ï¼Œè€Œ lodash-esè¿™ç§åŒ…ä¼šæœ‰å‡ ç™¾ä¸ªå­æ¨¡å—ï¼Œå½“ä»£ç ä¸­å‡ºç° import &#123; debounce &#125; from &#39;lodash-es&#39; ä¼šå‘å‡ºå‡ ç™¾ä¸ª HTTP è¯·æ±‚ï¼Œè¿™äº›è¯·æ±‚ä¼šé€ æˆç½‘ç»œå µå¡ï¼Œå½±å“é¡µé¢çš„åŠ è½½ã€‚ Vite å°†æœ‰è®¸å¤šå†…éƒ¨æ¨¡å—çš„ ESM ä¾èµ–å…³ç³»è½¬æ¢ä¸ºå•ä¸ªæ¨¡å—ï¼Œä»¥æé«˜åç»­é¡µé¢åŠ è½½æ€§èƒ½ã€‚ é€šè¿‡é¢„æ„å»º lodash-es æˆä¸ºä¸€ä¸ªæ¨¡å—ï¼Œä¹Ÿå°±åªéœ€è¦ä¸€ä¸ª HTTP è¯·æ±‚äº†ï¼ ä¸ºä»€ä¹ˆä½¿ç”¨Esbuild? å¼•ç”¨å°¤å¤§çš„ä¸€å¥è¯ï¼šâ€œå¿«â€å°±ä¸€ä¸ªå­— è¿™æ˜¯Esbuildé¦–é¡µçš„å›¾ã€‚æ–°ä¸€ä»£çš„æ‰“åŒ…å·¥å…·ï¼Œæä¾›äº†ä¸Webpackã€Rollupã€Parcel ç­‰å·¥å…·ç›¸ä¼¼çš„èµ„æºæ‰“åŒ…èƒ½åŠ›ï¼Œä½†åœ¨æ—¶é€Ÿä¸Šè¾¾åˆ° 10 ï½ 100 å€çš„å·®è·ï¼Œè€—æ—¶æ˜¯Webpack2%~3% ç¼–è¯‘è¿è¡Œ VS è§£é‡Šè¿è¡Œ å¤§å¤šæ•°å‰ç«¯æ‰“åŒ…å·¥å…·éƒ½æ˜¯åŸºäº JavaScript å®ç°çš„ï¼Œå¤§å®¶éƒ½çŸ¥é“JavaScriptæ˜¯è§£é‡Šå‹è¯­è¨€ï¼Œè¾¹è¿è¡Œè¾¹è§£é‡Šã€‚è€Œ Esbuild åˆ™é€‰æ‹©ä½¿ç”¨ Go è¯­è¨€ç¼–å†™ï¼Œè¯¥è¯­è¨€å¯ä»¥ç¼–è¯‘ä¸ºåŸç”Ÿä»£ç ,åœ¨ç¼–è¯‘çš„æ—¶å€™éƒ½å°†è¯­è¨€è½¬ä¸ºæœºå™¨è¯­è¨€ï¼Œåœ¨å¯åŠ¨çš„æ—¶å€™ç›´æ¥æ‰§è¡Œå³å¯ï¼Œåœ¨ CPU å¯†é›†åœºæ™¯ä¸‹ï¼ŒGo æ›´å…·æ€§èƒ½ä¼˜åŠ¿ã€‚ å¤šçº¿ç¨‹ VS å•çº¿ç¨‹ JavaScript æœ¬è´¨ä¸Šæ˜¯ä¸€é—¨å•çº¿ç¨‹è¯­è¨€ï¼Œç›´åˆ°å¼•å…¥ WebWorker ä¹‹åæ‰æœ‰å¯èƒ½åœ¨æµè§ˆå™¨ã€Node ä¸­å®ç°å¤šçº¿ç¨‹æ“ä½œã€‚å°±æˆ‘å¯¹Webpackçš„æºç ç†è§£ï¼Œå…¶æºç ä¹Ÿå¹¶æœªä½¿ç”¨ WebWorker æä¾›çš„å¤šçº¿ç¨‹èƒ½åŠ›ã€‚è€ŒGOå¤©ç”Ÿçš„å¤šçº¿ç¨‹ä¼˜åŠ¿ã€‚ å¯¹æ„å»ºæµç¨‹è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå……åˆ†åˆ©ç”¨ CPU èµ„æº å®ç°åŸç†ï¼ŸViteé¢„ç¼–è¯‘ä¹‹åï¼Œå°†æ–‡ä»¶ç¼“å­˜åœ¨node_modules/.vite/æ–‡ä»¶å¤¹ä¸‹ã€‚æ ¹æ®ä»¥ä¸‹åœ°æ–¹æ¥å†³å®šæ˜¯å¦éœ€è¦é‡æ–°æ‰§è¡Œé¢„æ„å»ºã€‚ package.jsonä¸­ï¼šdependencieså‘ç”Ÿå˜åŒ– åŒ…ç®¡ç†å™¨çš„lockfile å¦‚æœæƒ³å¼ºåˆ¶è®©Viteé‡æ–°é¢„æ„å»ºä¾èµ–ï¼Œå¯ä»¥ä½¿ç”¨--forceå¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œæˆ–è€…ç›´æ¥åˆ æ‰node_modules/.vite/æ–‡ä»¶å¤¹ã€‚ æ ¸å¿ƒä»£ç å®ç° é€šè¿‡createServeråˆ›å»ºserverå¯¹è±¡åï¼Œå½“æœåŠ¡å™¨å¯åŠ¨ä¼šæ‰§è¡ŒhttpServer.listenæ–¹æ³• åœ¨æ‰§è¡ŒcreateServeræ—¶ï¼ŒViteåº•å±‚ä¼šé‡å†™server.listenæ–¹æ³•:é¦–å…ˆè°ƒç”¨æ’ä»¶çš„buildStartå†æ‰§è¡ŒrunOptimize()æ–¹æ³• runOptimize()è°ƒç”¨optimizeDeps()å’ŒcreateMissingImporterRegisterFn()æ–¹æ³• const runOptimize = async () =&gt; &#123; if (config.cacheDir) &#123; server._isRunningOptimizer = true try &#123; server._optimizeDepsMetadata = await optimizeDeps( config, config.server.force || server._forceOptimizeOnRestart ) &#125; finally &#123; server._isRunningOptimizer = false &#125; server._registerMissingImport = createMissingImporterRegisterFn(server) &#125; &#125;if (!middlewareMode &amp;&amp; httpServer) &#123; let isOptimized = false // overwrite listen to run optimizer before server start const listen = httpServer.listen.bind(httpServer) httpServer.listen = (async (port: number, ...args: any[]) =&gt; &#123; if (!isOptimized) &#123; try &#123; await container.buildStart(&#123;&#125;) await runOptimize() isOptimized = true &#125; catch (e) &#123; httpServer.emit(&#x27;error&#x27;, e) return &#125; &#125; return listen(port, ...args) &#125;) as any&#125; else &#123; await container.buildStart(&#123;&#125;) await runOptimize()&#125;å¤åˆ¶ä»£ç  optimizeDeps()ä¸»è¦æ˜¯æ ¹æ®é…ç½®æ–‡ä»¶ç”Ÿæˆhashï¼Œè·å–ä¸Šæ¬¡é¢„è´­å»ºçš„å†…å®¹(å­˜æ”¾åœ¨_metadata.jsonæ–‡ä»¶)ã€‚å¦‚æœä¸æ˜¯å¼ºé¢„æ„å»ºå°±å¯¹æ¯”_metadata.jsonæ–‡ä»¶çš„hashå’Œæ–°ç”Ÿæˆçš„hashï¼šä¸€è‡´å°±è¿”å›_metadata.jsonæ–‡ä»¶çš„å†…å®¹ï¼Œå¦åˆ™æ¸…ç©ºç¼“å­˜æ–‡ä»¶è°ƒç”¨Esbuildæ„å»ºæ¨¡å—å†æ¬¡å­˜å…¥_metadata.jsonæ–‡ä»¶ æ•´ä½“çš„æµç¨‹å›¾æ ¸å¿ƒä»£ç éƒ½åœ¨packages/``vite``/``src``/``node``/optimizer/index.tsé‡Œé¢ è‡ªåŠ¨æœå¯»ä¾èµ–ä¸»è¦æ¨¡å—ï¼šesbuildScanPlugin é¢„æ„å»ºç¼–è¯‘ä¸»è¦æ¨¡å—ï¼šesbuildDepPlugin åŸºäº Rollup çš„ PluginsVite ä» preact çš„ WMR ä¸­å¾—åˆ°äº†å¯å‘ï¼Œå°†Vite Pluginsç»§æ‰¿Rollup`` Plugins `` ``APIï¼Œåœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œäº†ä¸€äº›æ‰©å±•(å¦‚Viteç‰¹æœ‰çš„é’©å­ç­‰)ï¼ŒåŒæ—¶Viteä¹ŸåŸºäºRollup pluginsæœºåˆ¶æä¾›äº†å¼ºå¤§çš„æ’ä»¶APIã€‚ç›®å‰å’Œ Vite å…¼å®¹æˆ–è€…å†…ç½®çš„æ’ä»¶ï¼Œå¯ä»¥æŸ¥çœ‹vite-rollup-plugins Vite æ’ä»¶æ˜¯ä»€ä¹ˆä½¿ç”¨Viteæ’ä»¶å¯ä»¥æ‰©å±•Viteèƒ½åŠ›ï¼Œé€šè¿‡æš´éœ²ä¸€äº›æ„å»ºæ‰“åŒ…è¿‡ç¨‹çš„ä¸€äº›æ—¶æœºé…åˆå·¥å…·å‡½æ•°ï¼Œè®©ç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰åœ°å†™ä¸€äº›é…ç½®ä»£ç ï¼Œæ‰§è¡Œåœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­ã€‚æ¯”å¦‚è§£æç”¨æˆ·è‡ªå®šä¹‰çš„æ–‡ä»¶è¾“å…¥ï¼Œåœ¨æ‰“åŒ…ä»£ç å‰è½¬è¯‘ä»£ç ï¼Œæˆ–è€…æŸ¥æ‰¾ã€‚ åœ¨å®é™…çš„å®ç°ä¸­ï¼ŒVite ä»…ä»…éœ€è¦åŸºäºRollupè®¾è®¡çš„æ¥å£è¿›è¡Œæ‰©å±•ï¼Œåœ¨ä¿è¯å…¼å®¹ Rollupæ’ä»¶çš„åŒæ—¶å†åŠ å…¥ä¸€äº›Viteç‰¹æœ‰çš„é’©å­å’Œå±æ€§æ¥è¿›è¡Œæ‰©å±•ã€‚ Vite ç‹¬æœ‰é’©å­å¯¹äºå„ä¸ªé’©å­çš„å…·ä½“ä½¿ç”¨å¯ä»¥ç§»æ­¥è¿™é‡Œ configï¼šå¯ä»¥åœ¨Viteè¢«è§£æä¹‹å‰ä¿®æ”¹Viteçš„ç›¸å…³é…ç½®ã€‚é’©å­æ¥æ”¶åŸå§‹ç”¨æˆ·é…ç½®configå’Œä¸€ä¸ªæè¿°é…ç½®ç¯å¢ƒçš„å˜é‡env configResolvedï¼šè§£æViteé…ç½®åè°ƒç”¨ï¼Œé…ç½®ç¡®è®¤ configureserverï¼šä¸»è¦ç”¨æ¥é…ç½®å¼€å‘æœåŠ¡å™¨ï¼Œä¸ºdev-serveræ·»åŠ è‡ªå®šä¹‰çš„ä¸­é—´ä»¶ transformindexhtmlï¼šä¸»è¦ç”¨æ¥è½¬æ¢index.htmlï¼Œé’©å­æ¥æ”¶å½“å‰çš„ HTML å­—ç¬¦ä¸²å’Œè½¬æ¢ä¸Šä¸‹æ–‡ handlehotupdateï¼šæ‰§è¡Œè‡ªå®šä¹‰HMRæ›´æ–°ï¼Œå¯ä»¥é€šè¿‡wså¾€å®¢æˆ·ç«¯å‘é€è‡ªå®šä¹‰çš„äº‹ä»¶ é€šç”¨é’©å­è¿™é‡Œä¸¾ä¸€äº›å¸¸ç”¨çš„é€šç”¨é’©å­ï¼Œå…¶ä½™çš„é€šç”¨é’©å­å¯ä»¥ç§»æ­¥è¿™é‡Œ æœåŠ¡å¯åŠ¨æ—¶è°ƒç”¨ä¸€æ¬¡ options: è·å–ã€æ“çºµRollupé€‰é¡¹ buildstartï¼šå¼€å§‹åˆ›å»º åœ¨æ¯ä¸ªä¼ å…¥æ¨¡å—è¯·æ±‚æ—¶è¢«è°ƒç”¨ resolveId: åˆ›å»ºè‡ªå®šä¹‰ç¡®è®¤å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥å®šä½ç¬¬ä¸‰æ–¹ä¾èµ– loadï¼šå¯ä»¥è‡ªå®šä¹‰åŠ è½½å™¨ï¼Œå¯ç”¨æ¥è¿”å›è‡ªå®šä¹‰çš„å†…å®¹ transformï¼šåœ¨æ¯ä¸ªä¼ å…¥æ¨¡å—è¯·æ±‚æ—¶è¢«è°ƒç”¨ï¼Œä¸»è¦æ˜¯ç”¨æ¥è½¬æ¢å•ä¸ªæ¨¡å— æœåŠ¡å…³é—­æ—¶è°ƒç”¨ä¸€æ¬¡ buildendï¼šåœ¨æœåŠ¡å™¨å…³é—­æ—¶è¢«è°ƒç”¨ closeBundle é’©å­çš„è°ƒç”¨é¡ºåºå¼•ç”¨@young æ‘é•¿çš„ä¸€ä¸ªå›¾: Viteçš„å®˜ç½‘å¯ä»¥çœ‹å‡ºï¼šViteæ’ä»¶å¯ä»¥ç”¨ä¸€ä¸ª enforce å±æ€§ï¼ˆç±»ä¼¼äº WebpackåŠ è½½å™¨ï¼‰æ¥è°ƒæ•´å®ƒçš„åº”ç”¨é¡ºåºã€‚enforce çš„å€¼å¯ä»¥æ˜¯pre æˆ– postã€‚è§£æåçš„æ’ä»¶å°†æŒ‰ç…§ä»¥ä¸‹é¡ºåºæ’åˆ—ï¼š Alias enforce:&#39;pre&#39;çš„è‡ªå®šä¹‰æ’ä»¶ Viteæ ¸å¿ƒæ’ä»¶ æ²¡æœ‰enforceçš„è‡ªå®šä¹‰æ’ä»¶ Viteæ„å»ºç”¨çš„æ’ä»¶ enforce:&#39;post&#39;çš„è‡ªå®šä¹‰æ’ä»¶ Viteåç½®æ„å»ºæ’ä»¶ è‡ªå®šä¹‰æ’ä»¶ ç¼–å†™æ’ä»¶ä»£ç  export default function myVitePlugin () &#123; // å®šä¹‰viteæ’ä»¶å”¯ä¸€id const virtualFileId = &#x27;@my-vite-plugin&#x27; // è¿”å›çš„æ•´ä¸ªæ’ä»¶å¯¹è±¡ return &#123; // å¿…é¡»çš„ï¼Œå°†ä¼šæ˜¾ç¤ºåœ¨ warning å’Œ error ä¸­ name: &#x27;vite-plugin&#x27;, // é’©å­ // config config: (config, env) =&gt; (&#123; console.log(&#x27;config&#x27;,config) return &#123;&#125; &#125;), // ç¡®è®¤config configResolved: config =&gt; (&#123;&#125;), options: options =&gt; (&#123;&#125;), buildStart: options =&gt; (&#123;&#125;), transformIndexHtml: (html, ctx) =&gt; (&#123; return html &#125;), //ç¡®è®¤ resolveId: (source, importer) =&gt; (&#123;&#125;), // è½¬æ¢ transform: (code, id) =&gt; (&#123;&#125;) &#125;&#125;å¤åˆ¶ä»£ç  å¼•å…¥æ’ä»¶ï¼švite.config.js/ts ä¸­å¼•ç”¨ // vite.config.js/tsimport myVitePlugin from &#x27;...&#x27;export default defineConfig&#123; plugins:[vue(),myVitePlugin()]&#125;å¤åˆ¶ä»£ç  æ€»ç»“æœ€åæ€»ç»“ä¸‹Viteç›¸å…³çš„ä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼š å¿«é€Ÿçš„å†·å¯åŠ¨: é‡‡ç”¨No Bundleå’Œesbuildé¢„æ„å»ºï¼Œé€Ÿåº¦è¿œå¿«äºWebpack é«˜æ•ˆçš„çƒ­æ›´æ–°ï¼šåŸºäºESMå®ç°ï¼ŒåŒæ—¶åˆ©ç”¨HTTPå¤´æ¥åŠ é€Ÿæ•´ä¸ªé¡µé¢çš„é‡æ–°åŠ è½½ï¼Œå¢åŠ ç¼“å­˜ç­–ç•¥ çœŸæ­£çš„æŒ‰éœ€åŠ è½½: åŸºäºæµè§ˆå™¨ESMçš„æ”¯æŒï¼Œå®ç°çœŸæ­£çš„æŒ‰éœ€åŠ è½½ ç¼ºç‚¹ ç”Ÿæ€ï¼šç›®å‰Viteçš„ç”Ÿæ€ä¸å¦‚Webapckï¼Œä¸è¿‡æˆ‘è§‰å¾—ç”Ÿæ€ä¹Ÿåªæ˜¯æ—¶é—´ä¸Šçš„é—®é¢˜ã€‚ ç”Ÿäº§ç¯å¢ƒç”±äºesbuildå¯¹csså’Œä»£ç åˆ†å‰²ä¸å‹å¥½ä½¿ç”¨Rollupè¿›è¡Œæ‰“åŒ… Vite.jsè™½ç„¶æ‰åœ¨æ„å»ºæ‰“åŒ…åœºæ™¯å…´èµ·ï¼Œä½†åœ¨å¾ˆå¤šåœºæ™¯ä¸‹åŸºæœ¬éƒ½ä¼šä¼˜äºç°æœ‰çš„è§£å†³æ–¹æ¡ˆã€‚å¦‚æœæœ‰ç”Ÿæ€ã€æƒ³è¦ä¸°å¯Œçš„loaderã€pluginsçš„è¦æ±‚å¯ä»¥è€ƒè™‘æˆç†Ÿçš„Webpackã€‚åœ¨å…¶ä½™æƒ…å†µä¸‹ï¼ŒVite.jsä¸å¤±ä¸ºä¸€ä¸ªæ‰“åŒ…æ„å»ºå·¥å…·çš„å¥½é€‰æ‹©ã€‚ é™„å½• å®˜æ–¹æ–‡æ¡£ Esbuildå®˜ç½‘ Vite æ’ä»¶ API Rollupå®˜æ–¹æ–‡æ¡£ Rollup - Next-generation ES6 module bundler - Interview with Rich Harris Viteæºç  Vite2 æ’ä»¶å¼€å‘æŒ‡å— è½¬è½½æ·±å…¥ç†è§£ Vite æ ¸å¿ƒåŸç†","updated":"2025-08-02T05:46:04.179Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼","date":"2022-02-23T15:02:24.000Z","path":"2022/02/23/2022-02-23-common-regex/","text":"æ ¡éªŒå­—ç¬¦çš„è¡¨è¾¾å¼ æ±‰å­—ï¼š^[\\u4e00-\\u9fa5]&#123;0,&#125;$ è‹±æ–‡å’Œæ•°å­—ï¼š^[A-Za-z0-9]+$ æˆ– ^[A-Za-z0-9]&#123;4,40&#125;$ é•¿åº¦ä¸º 3-20 çš„æ‰€æœ‰å­—ç¬¦ï¼š^.&#123;3,20&#125;$ ç”± 26 ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Za-z]+$ ç”± 26 ä¸ªå¤§å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Z]+$ ç”± 26 ä¸ªå°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[a-z]+$ ç”±æ•°å­—å’Œ 26 ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Za-z0-9]+$ ç”±æ•°å­—ã€26 ä¸ªè‹±æ–‡å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^\\w+$ æˆ– ^\\w&#123;3,20&#125;$ ä¸­æ–‡ã€è‹±æ–‡ã€æ•°å­—åŒ…æ‹¬ä¸‹åˆ’çº¿ï¼š^[\\u4E00-\\u9FA5A-Za-z0-9_]+$ ä¸­æ–‡ã€è‹±æ–‡ã€æ•°å­—ä½†ä¸åŒ…æ‹¬ä¸‹åˆ’çº¿ç­‰ç¬¦å·ï¼š^[\\u4E00-\\u9FA5A-Za-z0-9]+$ æˆ– ^[\\u4E00-\\u9FA5A-Za-z0-9]&#123;2,20&#125;$ å¯ä»¥è¾“å…¥å«æœ‰^%&amp;&#39;,;=?$\\&quot;ç­‰å­—ç¬¦ï¼š[^%&amp;&#39;,;=?$\\x22]+ ç¦æ­¢è¾“å…¥å«æœ‰~çš„å­—ç¬¦ï¼š[^~\\x22]+ æ ¡éªŒæ•°å­—çš„è¡¨è¾¾å¼ æ•°å­—ï¼š^[0-9]*$ n ä½çš„æ•°å­—ï¼š^\\d&#123;n&#125;$ è‡³å°‘ n ä½çš„æ•°å­—ï¼š^\\d&#123;n,&#125;$ m-n ä½çš„æ•°å­—ï¼š^\\d&#123;m,n&#125;$ é›¶å’Œéé›¶å¼€å¤´çš„æ•°å­—ï¼š^(0|[1-9][0-9]*)$ éé›¶å¼€å¤´çš„æœ€å¤šå¸¦ä¸¤ä½å°æ•°çš„æ•°å­—ï¼š^([1-9][0-9]*)+(\\.[0-9]&#123;1,2&#125;)?$ å¸¦ 1-2 ä½å°æ•°çš„æ­£æ•°æˆ–è´Ÿæ•°ï¼š^(\\-)?\\d+(\\.\\d&#123;1,2&#125;)$ æ­£æ•°ã€è´Ÿæ•°ã€å’Œå°æ•°ï¼š^(\\-|\\+)?\\d+(\\.\\d+)?$ æœ‰ä¸¤ä½å°æ•°çš„æ­£å®æ•°ï¼š^[0-9]+(\\.[0-9]&#123;2&#125;)?$ æœ‰ 1~3 ä½å°æ•°çš„æ­£å®æ•°ï¼š^[0-9]+(\\.[0-9]&#123;1,3&#125;)?$ éé›¶çš„æ­£æ•´æ•°ï¼š^[1-9]\\d*$ æˆ– ^([1-9][0-9]*)&#123;1,3&#125;$ æˆ– ^\\+?[1-9][0-9]*$ éé›¶çš„è´Ÿæ•´æ•°ï¼š^\\-[1-9][]0-9&quot;*$ æˆ– ^-[1-9]\\d*$ éè´Ÿæ•´æ•°ï¼š^\\d+$ æˆ– ^[1-9]\\d*|0$ éæ­£æ•´æ•°ï¼š^-[1-9]\\d*|0$ æˆ– ^((-\\d+)|(0+))$ éè´Ÿæµ®ç‚¹æ•°ï¼š^\\d+(\\.\\d+)?$ æˆ– ^[1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*|0?\\.0+|0$ éæ­£æµ®ç‚¹æ•°ï¼š^((-\\d+(\\.\\d+)?)|(0+(\\.0+)?))$ æˆ– ^(-([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*))|0?\\.0+|0$ æ­£æµ®ç‚¹æ•°ï¼š^[1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*$ æˆ– ^(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*))$ è´Ÿæµ®ç‚¹æ•°ï¼š^-([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*)$ æˆ– ^(-(([0-9]+\\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\\.[0-9]+)|([0-9]*[1-9][0-9]*)))$ æµ®ç‚¹æ•°ï¼š^(-?\\d+)(\\.\\d+)?$ æˆ– ^-?([1-9]\\d*\\.\\d*|0\\.\\d*[1-9]\\d*|0?\\.0+|0)$ ç‰¹æ®Šéœ€æ±‚è¡¨è¾¾å¼ Email åœ°å€ï¼š^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$ åŸŸåï¼š[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(\\.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+\\.? InternetURLï¼š[a-zA-z]+://[^\\s]* æˆ– ^http://([\\w-]+\\.)+[\\w-]+(/[\\w-./?%&amp;=]*)?$ æ‰‹æœºå·ç ï¼š^(13[0-9]|14[5|7]|15[0|1|2|3|4|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\d&#123;8&#125;$ ç”µè¯å·ç (â€œXXX-XXXXXXXâ€ã€â€XXXX-XXXXXXXXâ€ã€â€XXX-XXXXXXXâ€ã€â€XXX-XXXXXXXXâ€ã€â€XXXXXXXâ€å’Œâ€XXXXXXXX)ï¼š^(\\(\\d&#123;3,4&#125;-)|\\d&#123;3.4&#125;-)?\\d&#123;7,8&#125;$ å›½å†…ç”µè¯å·ç (0511-4405222ã€021-87888822)ï¼š\\d&#123;3&#125;-\\d&#123;8&#125;|\\d&#123;4&#125;-\\d&#123;7&#125; ç”µè¯å·ç æ­£åˆ™è¡¨è¾¾å¼ï¼ˆæ”¯æŒæ‰‹æœºå·ç ï¼Œ3-4 ä½åŒºå·ï¼Œ7-8 ä½ç›´æ’­å·ç ï¼Œ1ï¼4 ä½åˆ†æœºå·ï¼‰: ((\\d&#123;11&#125;)|^((\\d&#123;7,8&#125;)|(\\d&#123;4&#125;|\\d&#123;3&#125;)-(\\d&#123;7,8&#125;)|(\\d&#123;4&#125;|\\d&#123;3&#125;)-(\\d&#123;7,8&#125;)-(\\d&#123;4&#125;|\\d&#123;3&#125;|\\d&#123;2&#125;|\\d&#123;1&#125;)|(\\d&#123;7,8&#125;)-(\\d&#123;4&#125;|\\d&#123;3&#125;|\\d&#123;2&#125;|\\d&#123;1&#125;))$) èº«ä»½è¯å·(15 ä½ã€18 ä½æ•°å­—)ï¼Œæœ€åä¸€ä½æ˜¯æ ¡éªŒä½ï¼Œå¯èƒ½ä¸ºæ•°å­—æˆ–å­—ç¬¦ Xï¼š(^\\d&#123;15&#125;$)|(^\\d&#123;18&#125;$)|(^\\d&#123;17&#125;(\\d|X|x)$) å¸å·æ˜¯å¦åˆæ³•(å­—æ¯å¼€å¤´ï¼Œå…è®¸ 5-16 å­—èŠ‚ï¼Œå…è®¸å­—æ¯æ•°å­—ä¸‹åˆ’çº¿)ï¼š^[a-zA-Z][a-zA-Z0-9_]&#123;4,15&#125;$ å¯†ç (ä»¥å­—æ¯å¼€å¤´ï¼Œé•¿åº¦åœ¨ 6~18 ä¹‹é—´ï¼Œåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿)ï¼š^[a-zA-Z]\\w&#123;5,17&#125;$ å¼ºå¯†ç (å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—çš„ç»„åˆï¼Œä¸èƒ½ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦åœ¨ 8-10 ä¹‹é—´)ï¼š^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])[a-zA-Z0-9]&#123;8,10&#125;$ å¼ºå¯†ç (å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—çš„ç»„åˆï¼Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦åœ¨ 8-10 ä¹‹é—´)ï¼š^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).&#123;8,10&#125;$ æ—¥æœŸæ ¼å¼ï¼š^\\d&#123;4&#125;-\\d&#123;1,2&#125;-\\d&#123;1,2&#125; ä¸€å¹´çš„ 12 ä¸ªæœˆ(01 ï½ 09 å’Œ 1 ï½ 12)ï¼š^(0?[1-9]|1[0-2])$ ä¸€ä¸ªæœˆçš„ 31 å¤©(01 ï½ 09 å’Œ 1 ï½ 31)ï¼š^((0?[1-9])|((1|2)[0-9])|30|31)$ é’±çš„è¾“å…¥æ ¼å¼ï¼š æœ‰å››ç§é’±çš„è¡¨ç¤ºå½¢å¼æˆ‘ä»¬å¯ä»¥æ¥å—:â€10000.00â€ å’Œ â€œ10,000.00â€, å’Œæ²¡æœ‰ â€œåˆ†â€ çš„ â€œ10000â€ å’Œ â€œ10,000â€ï¼š^[1-9][0-9]*$ è¿™è¡¨ç¤ºä»»æ„ä¸€ä¸ªä¸ä»¥ 0 å¼€å¤´çš„æ•°å­—,ä½†æ˜¯,è¿™ä¹Ÿæ„å‘³ç€ä¸€ä¸ªå­—ç¬¦â€0â€ä¸é€šè¿‡,æ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨ä¸‹é¢çš„å½¢å¼ï¼š^(0|[1-9][0-9]*)$ ä¸€ä¸ª 0 æˆ–è€…ä¸€ä¸ªä¸ä»¥ 0 å¼€å¤´çš„æ•°å­—.æˆ‘ä»¬è¿˜å¯ä»¥å…è®¸å¼€å¤´æœ‰ä¸€ä¸ªè´Ÿå·ï¼š^(0|-?[1-9][0-9]*)$ è¿™è¡¨ç¤ºä¸€ä¸ª 0 æˆ–è€…ä¸€ä¸ªå¯èƒ½ä¸ºè´Ÿçš„å¼€å¤´ä¸ä¸º 0 çš„æ•°å­—.è®©ç”¨æˆ·ä»¥ 0 å¼€å¤´å¥½äº†.æŠŠè´Ÿå·çš„ä¹Ÿå»æ‰,å› ä¸ºé’±æ€»ä¸èƒ½æ˜¯è´Ÿçš„å§ã€‚ä¸‹é¢æˆ‘ä»¬è¦åŠ çš„æ˜¯è¯´æ˜å¯èƒ½çš„å°æ•°éƒ¨åˆ†ï¼š^[0-9]+(.[0-9]+)?$ å¿…é¡»è¯´æ˜çš„æ˜¯,å°æ•°ç‚¹åé¢è‡³å°‘åº”è¯¥æœ‰ 1 ä½æ•°,æ‰€ä»¥â€10.â€æ˜¯ä¸é€šè¿‡çš„,ä½†æ˜¯ â€œ10â€ å’Œ â€œ10.2â€ æ˜¯é€šè¿‡çš„ï¼š^[0-9]+(.[0-9]&#123;2&#125;)?$ è¿™æ ·æˆ‘ä»¬è§„å®šå°æ•°ç‚¹åé¢å¿…é¡»æœ‰ä¸¤ä½,å¦‚æœä½ è®¤ä¸ºå¤ªè‹›åˆ»äº†,å¯ä»¥è¿™æ ·ï¼š^[0-9]+(.[0-9]&#123;1,2&#125;)?$ è¿™æ ·å°±å…è®¸ç”¨æˆ·åªå†™ä¸€ä½å°æ•°.ä¸‹é¢æˆ‘ä»¬è¯¥è€ƒè™‘æ•°å­—ä¸­çš„é€—å·äº†,æˆ‘ä»¬å¯ä»¥è¿™æ ·ï¼š^[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*(.[0-9]&#123;1,2&#125;)?$ 1 åˆ° 3 ä¸ªæ•°å­—,åé¢è·Ÿç€ä»»æ„ä¸ª é€—å·+3 ä¸ªæ•°å­—,é€—å·æˆä¸ºå¯é€‰,è€Œä¸æ˜¯å¿…é¡»ï¼š^([0-9]+|[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*)(.[0-9]&#123;1,2&#125;)?$ å¤‡æ³¨ï¼šè¿™å°±æ˜¯æœ€ç»ˆç»“æœäº†,åˆ«å¿˜äº†â€+â€å¯ä»¥ç”¨â€*â€œæ›¿ä»£å¦‚æœä½ è§‰å¾—ç©ºå­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ¥å—çš„è¯(å¥‡æ€ª,ä¸ºä»€ä¹ˆ?)æœ€å,åˆ«å¿˜äº†åœ¨ç”¨å‡½æ•°æ—¶å»æ‰å»æ‰é‚£ä¸ªåæ–œæ ,ä¸€èˆ¬çš„é”™è¯¯éƒ½åœ¨è¿™é‡Œ xml æ–‡ä»¶ï¼š^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\\\.[x|X][m|M][l|L]$ ä¸­æ–‡å­—ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š[\\u4e00-\\u9fa5] åŒå­—èŠ‚å­—ç¬¦ï¼š[^\\x00-\\xff] (åŒ…æ‹¬æ±‰å­—åœ¨å†…ï¼Œå¯ä»¥ç”¨æ¥è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦(ä¸€ä¸ªåŒå­—èŠ‚å­—ç¬¦é•¿åº¦è®¡ 2ï¼ŒASCII å­—ç¬¦è®¡ 1)) ç©ºç™½è¡Œçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š\\n\\s*\\r (å¯ä»¥ç”¨æ¥åˆ é™¤ç©ºç™½è¡Œ) HTML æ ‡è®°çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š&lt;(\\S*?)[^&gt;]*&gt;.*?|&lt;.*? /&gt; ( é¦–å°¾ç©ºç™½å­—ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š^\\s*|\\s*$æˆ–(^\\s*)|(\\s*$) (å¯ä»¥ç”¨æ¥åˆ é™¤è¡Œé¦–è¡Œå°¾çš„ç©ºç™½å­—ç¬¦(åŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰)ï¼Œéå¸¸æœ‰ç”¨çš„è¡¨è¾¾å¼) è…¾è®¯ QQ å·ï¼š[1-9][0-9]&#123;4,&#125; (è…¾è®¯ QQ å·ä» 10000 å¼€å§‹) ä¸­å›½é‚®æ”¿ç¼–ç ï¼š[1-9]\\d&#123;5&#125;(?!\\d) (ä¸­å›½é‚®æ”¿ç¼–ç ä¸º 6 ä½æ•°å­—) IPv4 åœ°å€ï¼š((2(5[0-5]|[0-4]\\d))|[0-1]?\\d&#123;1,2&#125;)(\\.((2(5[0-5]|[0-4]\\d))|[0-1]?\\d&#123;1,2&#125;))&#123;3&#125;","updated":"2025-08-02T05:46:04.179Z","tags":[{"name":"regex","slug":"regex","permalink":"https://luckyship.github.io/tags/regex/"}]},{"title":"chromeæ’ä»¶å¼€å‘æŒ‡å—","date":"2022-02-20T14:54:27.000Z","path":"2022/02/20/2022-02-20-chrome-extend-develop/","text":"ä»€ä¹ˆæ˜¯ chrome extensionsChrome Extensionsï¼Œä¸­æ–‡åå« â€œChrome æµè§ˆå™¨æ‰©å±•ç¨‹åºâ€ã€‚å¼•ç”¨å®˜æ–¹æ–‡æ¡£çš„æè¿°ï¼Œç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ â€œå¯ä»¥ä¿®æ”¹å’Œå¢å¼ºæµè§ˆå™¨åŠŸèƒ½çš„ H5 å°ç¨‹åºâ€ã€‚å®ƒçš„å…¥å£åœ¨æµè§ˆå™¨çª—å£çš„å³ä¸Šè§’ï¼Œåœ°å€æ çš„æœ€å³è¾¹ å…¥é—¨manifest.jsonmanifest.json æ˜¯æ•´ä¸ªæ’ä»¶æ‰©å±•ç¨‹åºä¸­æœ€é‡è¦çš„ä¸€ä¸ªæè¿°æ–‡ä»¶ï¼Œè¿™ä¸ª json æ ¼å¼çš„æ–‡ä»¶åŒ…å«äº†ä½ æ•´ä¸ªæ‰©å±•ç¨‹åºçš„ä¸€äº›é‡è¦æè¿°ï¼Œæ¯”å¦‚ â€œæ‰©å±•ç¨‹åºåç§°â€ã€â€œæ‰©å±•ç¨‹åºå›¾æ ‡â€ã€â€œæƒé™ç”³è¯·â€ ç­‰ã€‚ &#123; // Required &quot;manifest_version&quot;: 2, // manifest ç‰ˆæœ¬å·ï¼Œè¿™é‡Œéƒ½å†™ 2 å°±å¥½äº†ï¼Œä» Google Chrome 18 å¼€å§‹ï¼Œå°±å¼€å§‹å‡çº§åˆ° 2 ç‰ˆæœ¬äº† &quot;name&quot;: &quot;My Extension&quot;, &quot;version&quot;: &quot;1.0.0&quot;, // æ‰©å±•ç¨‹åºç‰ˆæœ¬ï¼Œè¿™ä¸ªæ˜¯è‡ªå®šä¹‰çš„ï¼Œå»ºè®®å‚è€ƒ semver è§„èŒƒ(http://semver.org/) // Recommended &quot;default_locale&quot;: &quot;zh&quot;, // é»˜è®¤è¯­è¨€ï¼Œå…·ä½“å¯ä»¥çœ‹ i18n æ–‡æ¡£(https://developer.chrome.com/extensions/i18n) &quot;description&quot;: &quot;A plain text description&quot;, // é¡¹ç›®æè¿° &quot;icons&quot;: &#123; // iconï¼Œä¸åŒçš„ä½ç½®æ”¯æŒä¸åŒå¤§å°çš„ iconï¼Œå…·ä½“çœ‹æ–‡æ¡£(https://developer.chrome.com/extensions/manifest/icons) &quot;128&quot;: &quot;icons/icon_128.png&quot;, &quot;48&quot;: &quot;icons/icon_48.png&quot;, &quot;16&quot;: &quot;icons/icon_16.png&quot; &#125;, // Pick one (or none) &quot;browser_action&quot;: &#123; // å¤šæ•°éƒ½æ˜¯ä½¿ç”¨è¿™ä¸ªï¼Œæ’ä»¶æ‰©å±•ç¨‹åºé’ˆå¯¹çš„æ˜¯æµè§ˆå™¨è¡Œä¸ºï¼ˆå›¾æ ‡æ˜¯åœ¨åœ°å€æ å¤–é¢ï¼‰ &quot;default_icon&quot;: &quot;icons/24.png&quot;, // æœ€ä½³å¤§å°ä¸º19*19ï¼Œåœ°å€æ ä¸Šçš„æ’ä»¶æ‰©å±•ç¨‹åºçš„ iconï¼ˆä¸€èˆ¬ä½œä¸ºä¸»å…¥å£ï¼‰ &quot;default_popup&quot;: &quot;popup.html&quot;, // ç‚¹å‡»æ’ä»¶æ‰©å±•ç¨‹åº icon åå¼¹å‡ºæ¥çš„çª—å£çš„ä¸»é¡µé¢ html &quot;default_title&quot;: &quot;extentsions demo&quot; // å½“é¼ æ ‡æ”¾åˆ°æ‰©å±•ç¨‹åºå›¾æ ‡ä¸Šæ—¶æ˜¾ç¤ºçš„æ–‡å­— &#125;, &quot;page_action&quot;: &#123; // æ’ä»¶æ‰©å±•ç¨‹åºé’ˆå¯¹çš„æ˜¯é¡µé¢è¡Œä¸ºï¼ˆå›¾æ ‡æ˜¯åœ¨åœ°å€æ é‡Œé¢çš„ï¼‰ ... &#125;, // Optional &quot;author&quot;: ..., &quot;automation&quot;: ..., &quot;background&quot;: &#123; // Recommended &quot;persistent&quot;: false &#125;, &quot;background&quot;: &#123; &quot;scripts&quot;: [&quot;eventPage.js&quot;], &quot;persistent&quot;: false &#125;, &quot;chrome_settings_overrides&quot;: &#123;...&#125;, &quot;chrome_ui_overrides&quot;: &#123; &quot;bookmarks_ui&quot;: &#123; &quot;remove_bookmark_shortcut&quot;: true, &quot;remove_button&quot;: true &#125; &#125;, &quot;chrome_url_overrides&quot;: &#123;...&#125;, &quot;commands&quot;: &#123;...&#125;, &quot;content_capabilities&quot;: ..., &quot;content_scripts&quot;: [&#123;...&#125;], &quot;content_security_policy&quot;: &quot;policyString&quot;, &quot;converted_from_user_script&quot;: ..., &quot;current_locale&quot;: ..., &quot;declarative_net_request&quot;: ..., &quot;devtools_page&quot;: &quot;devtools.html&quot;, &quot;event_rules&quot;: [&#123;...&#125;], &quot;externally_connectable&quot;: &#123; &quot;matches&quot;: [&quot;*://*.example.com/*&quot;] &#125;, &quot;file_browser_handlers&quot;: [...], &quot;file_system_provider_capabilities&quot;: &#123; &quot;configurable&quot;: true, &quot;multiple_mounts&quot;: true, &quot;source&quot;: &quot;network&quot; &#125;, &quot;homepage_url&quot;: &quot;http://path/to/homepage&quot;, &quot;import&quot;: [&#123;&quot;id&quot;: &quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;&#125;], &quot;incognito&quot;: &quot;spanning, split, or not_allowed&quot;, &quot;input_components&quot;: ..., &quot;key&quot;: &quot;publicKey&quot;, &quot;minimum_chrome_version&quot;: &quot;versionString&quot;, &quot;nacl_modules&quot;: [...], &quot;oauth2&quot;: ..., &quot;offline_enabled&quot;: true, &quot;omnibox&quot;: &#123; &quot;keyword&quot;: &quot;aString&quot; &#125;, &quot;optional_permissions&quot;: [&quot;tabs&quot;], &quot;options_page&quot;: &quot;options.html&quot;, &quot;options_ui&quot;: &#123; &quot;chrome_style&quot;: true, &quot;page&quot;: &quot;options.html&quot; &#125;, &quot;permissions&quot;: [&quot;tabs&quot;], &quot;platforms&quot;: ..., &quot;plugins&quot;: [...], &quot;requirements&quot;: &#123;...&#125;, &quot;sandbox&quot;: [...], &quot;short_name&quot;: &quot;Short Name&quot;, &quot;signature&quot;: ..., &quot;spellcheck&quot;: ..., &quot;storage&quot;: &#123; &quot;managed_schema&quot;: &quot;schema.json&quot; &#125;, &quot;system_indicator&quot;: ..., &quot;tts_engine&quot;: &#123;...&#125;, &quot;update_url&quot;: &quot;http://path/to/updateInfo.xml&quot;, &quot;version_name&quot;: &quot;aString&quot;, &quot;web_accessible_resources&quot;: [...]&#125; å­¦åšä¸€ä¸ª demo manifestjson(è¯¥æ–‡æœ¬æ–‡ä»¶éœ€è¦ç”¨ UTF8 å­—ç¬¦é›†ä¿å­˜) &#123; &quot;name&quot;: &quot;ç¬¬ä¸€ä¸ªChromeæ’ä»¶&quot;, &quot;manifest_version&quot;: 2, &quot;version&quot;: &quot;1.0&quot;, &quot;description&quot;: &quot;æˆ‘çš„ç¬¬ä¸€ä¸ªChromeæ’ä»¶ï¼Œè¿˜ä¸é”™å§&quot;, &quot;browser_action&quot;: &#123; &quot;default_icon&quot;: &quot;1.png&quot; &#125;, &quot;content_scripts&quot;: [ &#123; &quot;matches&quot;: [&quot;https://www.baidu.com/&quot;], &quot;js&quot;: [&quot;test.js&quot;] &#125; ]&#125; test.js alert(&#x27;Hello World&#x27;);document.body.style.backgroundColor = &#x27;gray&#x27;; content_scripts æ˜¯è¿è¡Œåœ¨æ‰“å¼€é¡µé¢çš„è„šæœ¬ï¼Œå¯ä»¥æ‹¿åˆ°æ•´ä¸ªé¡µé¢çš„ DOM å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è¯¥è„šæœ¬å¯¹é¡µé¢è¿›è¡Œæ“ä½œã€‚ æ·»åŠ å›¾ç‰‡ 1.png æ‰“å¼€ chromeï¼Œæ‰“å¼€èœå•ï¼Œæ‰¾åˆ°æ‰©å±•ç¨‹åºé€‰é¡¹æ›´å¤šå·¥å…·&gt;æ‰©å±•ç¨‹åºè·¯å¾„ä¸‹ã€‚ç‚¹å‡»åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åºï¼Œæ·»åŠ æ–‡ä»¶å¤¹å°± OK å•¦ï¼ å¸¸ç”¨ api bookmarks: ä¹¦ç­¾ç®¡ç†æ¥å£ï¼Œå¯ä»¥å¯¹æµè§ˆå™¨çš„ä¹¦ç­¾è¿›è¡Œå¢åˆ æ”¹æŸ¥ç­‰ç®¡ç† tabs: æ ‡ç­¾ç®¡ç†æ¥å£ï¼Œå¯ä»¥å¯¹æµè§ˆå™¨çš„æ ‡ç­¾è¿›è¡Œå¢åˆ æ”¹æŸ¥ç­‰ç®¡ç† contextMenus: å³é”®èœå•ç®¡ç† cookies: æµè§ˆå™¨ cookie çš„ç®¡ç† notifications: æ¶ˆæ¯é€šçŸ¥ desktopCapture: å¯é’ˆå¯¹ â€œçª—å£â€ æˆ–è€… â€æ ‡ç­¾â€œ çš„æˆªå›¾æ¥å£ i18n: å›½é™…åŒ–ï¼ˆå¤šè¯­è¨€æ”¯æŒï¼‰ ç¨‹åºå‘å¸ƒå’Œåˆ†äº«æ‰“åŒ…æ‰©å±•ç¨‹åºï¼Œç¬¬ä¸€æ¬¡æ‰“åŒ…åªéœ€è¦è®¾ç½®æ ¹ç›®å½•ï¼Œæ‰“åŒ…å®Œæˆåä¼šç”Ÿæˆ.crx å’Œ.pem å¯†é’¥æ–‡ä»¶(ç‰ˆæœ¬çš„è¿­ä»£éœ€è¦æ­¤æ–‡ä»¶ï¼Œå¦åˆ™åˆ™ä¼šç”Ÿæˆæ–°çš„ç¨‹åºæ–‡ä»¶)ï¼Œå°†.crx æ–‡ä»¶å‘ç»™å…¶ä»–äººæ‹–å…¥æ‰©å±•ç¨‹åºé¡µé¢å³å¯å®‰è£…ã€‚ å‘å¸ƒåˆ° chrome å•†åº—å½“ä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼Œå°±å¯ä»¥å‡†å¤‡å‘å¸ƒä¸Šçº¿äº†ï¼ŒChrome æœ‰ä¸ªå®˜æ–¹çš„æ’ä»¶æ‰©å±•ç¨‹åºå¸‚åœºï¼Œè¿˜è‡ªå¸¦äº†å‘å¸ƒå’Œæ›´æ–°ç­‰ä¸€ä½“åŒ–ç®¡ç†çš„æµç¨‹ï¼Œéå¸¸æ–¹ä¾¿ã€‚ä¼ é€é—¨ï¼šChrome å•†åº— dashboard æ³¨æ„ï¼Œä¸Šä¼ çš„æ˜¯ zip è€Œä¸æ˜¯ç”Ÿæˆçš„ crx æ–‡ä»¶ï¼Œå…·ä½“å‚è€ƒï¼šhttps://developer.chrome.com/webstore/publish å¸¸è§é—®é¢˜ å¼•å…¥å¤–éƒ¨ js æ—¶æŠ¥ Refused to load the script çš„é—®é¢˜ &lt;script src=&quot;https://code.jquery.com/jquery-3.2.1.min.js&quot;&gt;&lt;/script&gt; è§£å†³æ–¹æ¡ˆï¼šä¿®æ”¹ content_security_policyï¼ŒæŠŠå¯¹åº”çš„åŸŸååŠ ä¸Šå»å³å¯ï¼Œæ¯”å¦‚ä»¥ä¸Šçš„é—®é¢˜å¯ä»¥è§£å†³ï¼š &#123; &quot;content_security_policy&quot;: &quot;https://code.jquery.com&quot;&#125; ä»¥ä¸Šè¡¨ç¤ºå…è®¸ https://code.jquery.com åŸŸåä¸‹çš„å¤–éƒ¨ js çš„å¼•å…¥ã€‚ 2. Chrome æ’ä»¶æ‰©å±•ç¨‹åºæ˜¯å¼€æºçš„æ–¹å¼å®‰è£…çš„ï¼Œå¯ä»¥å»å®‰è£…ç›®å½•é€šè¿‡æ‰©å±•ç¨‹åº ID æ¥æ‰¾åˆ°æºç ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼ŒChrome æ’ä»¶æ‰©å±•ç¨‹åºçš„é»˜è®¤å®‰è£…ç›®å½•å¦‚ä¸‹ï¼š Windows XPï¼šC:\\Documents and Settings\\ç”¨æˆ·å\\Local Settings\\Application Data\\Google\\Chrome\\User Data\\Default\\Extensions Windows7ï¼šC:\\Users\\ç”¨æˆ·å\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Extensions Macï¼š~/Library/Application Support/Google/Chrome/Default/Extensions Ubuntuï¼š~/.config/google-chrome/Default/Extensionså¦‚æœåœ¨è¿™äº›ä¸åŒæ“ä½œç³»ç»Ÿä¸­çš„é»˜è®¤å®‰è£…ä½ç½®æ²¡æ‰¾åˆ°æ’ä»¶ï¼Œé‚£ä¹ˆè¿˜æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥æŸ¥è¯¢åˆ°ã€‚ åœ°å€æ è®¿é—® chrome:versionæ‰¾åˆ° â€œä¸ªäººèµ„æ–™è·¯å¾„â€ï¼Œè¯¥è·¯å¾„ä¸‹çš„ extensions æ–‡ä»¶å¤¹å°±æ˜¯ Chrome æ’ä»¶æ‰©å±•ç¨‹åºçš„å®‰è£…è·¯å¾„äº†å®‰è£…è·¯å¾„ä¸‹çš„æ’ä»¶æ‰©å±•ç¨‹åºï¼Œæ˜¯ä»¥ ID ä¸ºç›®å½•åŒºåˆ†çš„åœ°å€æ è®¿é—® chrome://extensions/ï¼Œå¯ä»¥æŸ¥çœ‹æ¯ä¸ªæ’ä»¶æ‰©å±•ç¨‹åºçš„ ID é«˜çº§æ•™ç¨‹-chrome æ’ä»¶åˆé›†é¡¹ç›®åœ°å€ å‚è€ƒèµ„æ–™å®˜æ–¹æ–‡æ¡£","updated":"2025-08-02T05:46:04.179Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"nginx é—®ç­”","date":"2022-02-12T11:14:39.000Z","path":"2022/02/12/2022-02-12-nginx-question/","text":"ä»€ä¹ˆæ˜¯ Nginxï¼ŸNginx æ˜¯ä¸€ä¸ª è½»é‡çº§/é«˜æ€§èƒ½çš„åå‘ä»£ç† Web æœåŠ¡å™¨ï¼Œä»–å®ç°éå¸¸é«˜æ•ˆçš„åå‘ä»£ç†ã€è´Ÿè½½å¹³è¡¡ï¼Œä»–å¯ä»¥å¤„ç† 2-3 ä¸‡å¹¶å‘è¿æ¥æ•°ï¼Œå®˜æ–¹ç›‘æµ‹èƒ½æ”¯æŒ 5 ä¸‡å¹¶å‘ï¼Œç°åœ¨ä¸­å›½ä½¿ç”¨ nginx ç½‘ç«™ç”¨æˆ·æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ï¼šæ–°æµªã€ç½‘æ˜“ã€ è…¾è®¯ç­‰ã€‚ ä¸ºä»€ä¹ˆè¦ç”¨ Nginxï¼Ÿè·¨å¹³å°ã€é…ç½®ç®€å•ã€æ–¹å‘ä»£ç†ã€é«˜å¹¶å‘è¿æ¥ï¼šå¤„ç† 2-3 ä¸‡å¹¶å‘è¿æ¥æ•°ï¼Œå®˜æ–¹ç›‘æµ‹èƒ½æ”¯æŒ 5 ä¸‡å¹¶å‘ï¼Œå†…å­˜æ¶ˆè€—å°ï¼šå¼€å¯ 10 ä¸ª nginx æ‰å  150M å†…å­˜ ï¼Œnginx å¤„ç†é™æ€æ–‡ä»¶å¥½ï¼Œè€—è´¹å†…å­˜å°‘ï¼Œ è€Œä¸” Nginx å†…ç½®çš„å¥åº·æ£€æŸ¥åŠŸèƒ½ï¼šå¦‚æœæœ‰ä¸€ä¸ªæœåŠ¡å™¨å®•æœºï¼Œä¼šåšä¸€ä¸ªå¥åº·æ£€æŸ¥ï¼Œå†å‘é€çš„è¯·æ±‚å°±ä¸ä¼šå‘é€åˆ°å®•æœºçš„æœåŠ¡å™¨äº†ã€‚é‡æ–°å°†è¯·æ±‚æäº¤åˆ°å…¶ä»–çš„èŠ‚ç‚¹ä¸Šã€‚ ä½¿ç”¨ Nginx çš„è¯è¿˜èƒ½ï¼š èŠ‚çœå®½å¸¦ï¼šæ”¯æŒ GZIP å‹ç¼©ï¼Œå¯ä»¥æ·»åŠ æµè§ˆå™¨æœ¬åœ°ç¼“å­˜ ç¨³å®šæ€§é«˜ï¼šå®•æœºçš„æ¦‚ç‡éå¸¸å° æ¥æ”¶ç”¨æˆ·è¯·æ±‚æ˜¯å¼‚æ­¥çš„ ä¸ºä»€ä¹ˆ Nginx æ€§èƒ½è¿™ä¹ˆé«˜ï¼Ÿå› ä¸ºä»–çš„äº‹ä»¶å¤„ç†æœºåˆ¶ï¼šå¼‚æ­¥éé˜»å¡äº‹ä»¶å¤„ç†æœºåˆ¶ï¼šè¿ç”¨äº† epoll æ¨¡å‹ï¼Œæä¾›äº†ä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ’é˜Ÿè§£å†³ Nginx æ€ä¹ˆå¤„ç†è¯·æ±‚çš„ï¼Ÿnginx æ¥æ”¶ä¸€ä¸ªè¯·æ±‚åï¼Œé¦–å…ˆç”± listen å’Œ server_name æŒ‡ä»¤åŒ¹é… server æ¨¡å—ï¼Œå†åŒ¹é… server æ¨¡å—é‡Œçš„ locationï¼Œlocation å°±æ˜¯å®é™…åœ°å€ server &#123; # ç¬¬ä¸€ä¸ªServeråŒºå—å¼€å§‹ï¼Œè¡¨ç¤ºä¸€ä¸ªç‹¬ç«‹çš„è™šæ‹Ÿä¸»æœºç«™ç‚¹ listen 80ï¼› # æä¾›æœåŠ¡çš„ç«¯å£ï¼Œé»˜è®¤80 server_name localhostï¼› # æä¾›æœåŠ¡çš„åŸŸåä¸»æœºå location / &#123; # ç¬¬ä¸€ä¸ªlocationåŒºå—å¼€å§‹ root htmlï¼› # ç«™ç‚¹çš„æ ¹ç›®å½•ï¼Œç›¸å½“äºNginxçš„å®‰è£…ç›®å½• index index.html index.htmï¼› # é»˜è®¤çš„é¦–é¡µæ–‡ä»¶ï¼Œå¤šä¸ªç”¨ç©ºæ ¼åˆ†å¼€ &#125; # ç¬¬ä¸€ä¸ªlocationåŒºå—ç»“æœ &#125; ä»€ä¹ˆæ˜¯æ­£å‘ä»£ç†å’Œåå‘ä»£ç†ï¼Ÿ æ­£å‘ä»£ç†å°±æ˜¯ä¸€ä¸ªäººå‘é€ä¸€ä¸ªè¯·æ±‚ç›´æ¥å°±åˆ°è¾¾äº†ç›®æ ‡çš„æœåŠ¡å™¨ åæ–¹ä»£ç†å°±æ˜¯è¯·æ±‚ç»Ÿä¸€è¢« Nginx æ¥æ”¶ï¼Œnginx åå‘ä»£ç†æœåŠ¡å™¨æ¥æ”¶åˆ°ä¹‹åï¼ŒæŒ‰ç…§ä¸€å®šçš„è§„åˆ™åˆ†å‘ç»™äº†åç«¯çš„ä¸šåŠ¡å¤„ç†æœåŠ¡å™¨è¿›è¡Œå¤„ç†äº† ä½¿ç”¨â€œåå‘ä»£ç†æœåŠ¡å™¨çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆ?åå‘ä»£ç†æœåŠ¡å™¨å¯ä»¥éšè—æºæœåŠ¡å™¨çš„å­˜åœ¨å’Œç‰¹å¾ã€‚å®ƒå……å½“äº’è”ç½‘äº‘å’Œ web æœåŠ¡å™¨ä¹‹é—´çš„ä¸­é—´å±‚ã€‚è¿™å¯¹äºå®‰å…¨æ–¹é¢æ¥è¯´æ˜¯å¾ˆå¥½çš„ï¼Œç‰¹åˆ«æ˜¯å½“æ‚¨ä½¿ç”¨ web æ‰˜ç®¡æœåŠ¡æ—¶ã€‚ Nginx çš„ä¼˜ç¼ºç‚¹ï¼Ÿä¼˜ç‚¹ï¼š å å†…å­˜å°ï¼Œå¯å®ç°é«˜å¹¶å‘è¿æ¥ï¼Œå¤„ç†å“åº”å¿« å¯å®ç° http æœåŠ¡å™¨ã€è™šæ‹Ÿä¸»æœºã€æ–¹å‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ Nginx é…ç½®ç®€å• å¯ä»¥ä¸æš´éœ²æ­£å¼çš„æœåŠ¡å™¨ IP åœ°å€ ç¼ºç‚¹ï¼š åŠ¨æ€å¤„ç†å·®ï¼šnginx å¤„ç†é™æ€æ–‡ä»¶å¥½,è€—è´¹å†…å­˜å°‘ï¼Œä½†æ˜¯å¤„ç†åŠ¨æ€é¡µé¢åˆ™å¾ˆé¸¡è‚‹ï¼Œç°åœ¨ä¸€èˆ¬å‰ç«¯ç”¨ nginx ä½œä¸ºåå‘ä»£ç†æŠ—ä½å‹åŠ›ï¼Œ Nginx åº”ç”¨åœºæ™¯ï¼Ÿ http æœåŠ¡å™¨ã€‚Nginx æ˜¯ä¸€ä¸ª http æœåŠ¡å¯ä»¥ç‹¬ç«‹æä¾› http æœåŠ¡ã€‚å¯ä»¥åšç½‘é¡µé™æ€æœåŠ¡å™¨ã€‚ è™šæ‹Ÿä¸»æœºã€‚å¯ä»¥å®ç°åœ¨ä¸€å°æœåŠ¡å™¨è™šæ‹Ÿå‡ºå¤šä¸ªç½‘ç«™ï¼Œä¾‹å¦‚ä¸ªäººç½‘ç«™ä½¿ç”¨çš„è™šæ‹Ÿæœºã€‚ åå‘ä»£ç†ï¼Œè´Ÿè½½å‡è¡¡ã€‚å½“ç½‘ç«™çš„è®¿é—®é‡è¾¾åˆ°ä¸€å®šç¨‹åº¦åï¼Œå•å°æœåŠ¡å™¨ä¸èƒ½æ»¡è¶³ç”¨æˆ·çš„è¯·æ±‚æ—¶ï¼Œéœ€è¦ç”¨å¤šå°æœåŠ¡å™¨é›†ç¾¤å¯ä»¥ä½¿ç”¨ nginx åšåå‘ä»£ç†ã€‚å¹¶ä¸”å¤šå°æœåŠ¡å™¨å¯ä»¥å¹³å‡åˆ†æ‹…è´Ÿè½½ï¼Œä¸ä¼šåº”ä¸ºæŸå°æœåŠ¡å™¨è´Ÿè½½é«˜å®•æœºè€ŒæŸå°æœåŠ¡å™¨é—²ç½®çš„æƒ…å†µã€‚ nginz ä¸­ä¹Ÿå¯ä»¥é…ç½®å®‰å…¨ç®¡ç†ã€æ¯”å¦‚å¯ä»¥ä½¿ç”¨ Nginx æ­å»º API æ¥å£ç½‘å…³,å¯¹æ¯ä¸ªæ¥å£æœåŠ¡è¿›è¡Œæ‹¦æˆªã€‚ Nginx ç›®å½•ç»“æ„æœ‰å“ªäº›ï¼Ÿ[root@localhost ~]# tree /usr/local/nginx/usr/local/nginxâ”œâ”€â”€ client_body_tempâ”œâ”€â”€ conf # Nginxæ‰€æœ‰é…ç½®æ–‡ä»¶çš„ç›®å½•â”‚ â”œâ”€â”€ fastcgi.conf # fastcgiç›¸å…³å‚æ•°çš„é…ç½®æ–‡ä»¶â”‚ â”œâ”€â”€ fastcgi.conf.default # fastcgi.confçš„åŸå§‹å¤‡ä»½æ–‡ä»¶â”‚ â”œâ”€â”€ fastcgi_params # fastcgiçš„å‚æ•°æ–‡ä»¶â”‚ â”œâ”€â”€ fastcgi_params.defaultâ”‚ â”œâ”€â”€ koi-utfâ”‚ â”œâ”€â”€ koi-winâ”‚ â”œâ”€â”€ mime.types # åª’ä½“ç±»å‹â”‚ â”œâ”€â”€ mime.types.defaultâ”‚ â”œâ”€â”€ nginx.conf # Nginxä¸»é…ç½®æ–‡ä»¶â”‚ â”œâ”€â”€ nginx.conf.defaultâ”‚ â”œâ”€â”€ scgi_params # scgiç›¸å…³å‚æ•°æ–‡ä»¶â”‚ â”œâ”€â”€ scgi_params.defaultâ”‚ â”œâ”€â”€ uwsgi_params # uwsgiç›¸å…³å‚æ•°æ–‡ä»¶â”‚ â”œâ”€â”€ uwsgi_params.defaultâ”‚ â””â”€â”€ win-utfâ”œâ”€â”€ fastcgi_temp # fastcgiä¸´æ—¶æ•°æ®ç›®å½•â”œâ”€â”€ html # Nginxé»˜è®¤ç«™ç‚¹ç›®å½•â”‚ â”œâ”€â”€ 50x.html # é”™è¯¯é¡µé¢ä¼˜é›…æ›¿ä»£æ˜¾ç¤ºæ–‡ä»¶ï¼Œä¾‹å¦‚å½“å‡ºç°502é”™è¯¯æ—¶ä¼šè°ƒç”¨æ­¤é¡µé¢â”‚ â””â”€â”€ index.html # é»˜è®¤çš„é¦–é¡µæ–‡ä»¶â”œâ”€â”€ logs # Nginxæ—¥å¿—ç›®å½•â”‚ â”œâ”€â”€ access.log # è®¿é—®æ—¥å¿—æ–‡ä»¶â”‚ â”œâ”€â”€ error.log # é”™è¯¯æ—¥å¿—æ–‡ä»¶â”‚ â””â”€â”€ nginx.pid # pidæ–‡ä»¶ï¼ŒNginxè¿›ç¨‹å¯åŠ¨åï¼Œä¼šæŠŠæ‰€æœ‰è¿›ç¨‹çš„IDå·å†™åˆ°æ­¤æ–‡ä»¶â”œâ”€â”€ proxy_temp # ä¸´æ—¶ç›®å½•â”œâ”€â”€ sbin # Nginxå‘½ä»¤ç›®å½•â”‚ â””â”€â”€ nginx # Nginxçš„å¯åŠ¨å‘½ä»¤â”œâ”€â”€ scgi_temp # ä¸´æ—¶ç›®å½•â””â”€â”€ uwsgi_temp # ä¸´æ—¶ç›®å½• Nginx é…ç½®æ–‡ä»¶ nginx.conf æœ‰å“ªäº›å±æ€§æ¨¡å—?orker_processes 1ï¼› # workerè¿›ç¨‹çš„æ•°é‡events &#123; # äº‹ä»¶åŒºå—å¼€å§‹ worker_connections 1024ï¼› # æ¯ä¸ªworkerè¿›ç¨‹æ”¯æŒçš„æœ€å¤§è¿æ¥æ•°&#125; # äº‹ä»¶åŒºå—ç»“æŸhttp &#123; # HTTPåŒºå—å¼€å§‹ include mime.typesï¼› # Nginxæ”¯æŒçš„åª’ä½“ç±»å‹åº“æ–‡ä»¶ default_type application/octet-streamï¼› # é»˜è®¤çš„åª’ä½“ç±»å‹ sendfile onï¼› # å¼€å¯é«˜æ•ˆä¼ è¾“æ¨¡å¼ keepalive_timeout 65ï¼› # è¿æ¥è¶…æ—¶ server &#123; # ç¬¬ä¸€ä¸ªServeråŒºå—å¼€å§‹ï¼Œè¡¨ç¤ºä¸€ä¸ªç‹¬ç«‹çš„è™šæ‹Ÿä¸»æœºç«™ç‚¹ listen 80ï¼› # æä¾›æœåŠ¡çš„ç«¯å£ï¼Œé»˜è®¤80 server_name localhostï¼› # æä¾›æœåŠ¡çš„åŸŸåä¸»æœºå location / &#123; # ç¬¬ä¸€ä¸ªlocationåŒºå—å¼€å§‹ root htmlï¼› # ç«™ç‚¹çš„æ ¹ç›®å½•ï¼Œç›¸å½“äºNginxçš„å®‰è£…ç›®å½• index index.html index.htmï¼› # é»˜è®¤çš„é¦–é¡µæ–‡ä»¶ï¼Œå¤šä¸ªç”¨ç©ºæ ¼åˆ†å¼€ &#125; # ç¬¬ä¸€ä¸ªlocationåŒºå—ç»“æœ error_page 500502503504 /50x.htmlï¼› # å‡ºç°å¯¹åº”çš„httpçŠ¶æ€ç æ—¶ï¼Œä½¿ç”¨50x.htmlå›åº”å®¢æˆ· location = /50x.html &#123; # locationåŒºå—å¼€å§‹ï¼Œè®¿é—®50x.html root htmlï¼› # æŒ‡å®šå¯¹åº”çš„ç«™ç‚¹ç›®å½•ä¸ºhtml &#125; &#125; ...... Nginx é™æ€èµ„æº?é™æ€èµ„æºè®¿é—®ï¼Œå°±æ˜¯å­˜æ”¾åœ¨ nginx çš„ html é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±ç¼–å†™ å¦‚ä½•ç”¨ Nginx è§£å†³å‰ç«¯è·¨åŸŸé—®é¢˜ï¼Ÿä½¿ç”¨ Nginx è½¬å‘è¯·æ±‚ã€‚æŠŠè·¨åŸŸçš„æ¥å£å†™æˆè°ƒæœ¬åŸŸçš„æ¥å£ï¼Œç„¶åå°†è¿™äº›æ¥å£è½¬å‘åˆ°çœŸæ­£çš„è¯·æ±‚åœ°å€ã€‚ Nginx è™šæ‹Ÿä¸»æœºæ€ä¹ˆé…ç½®?1ã€åŸºäºåŸŸåçš„è™šæ‹Ÿä¸»æœºï¼Œé€šè¿‡åŸŸåæ¥åŒºåˆ†è™šæ‹Ÿä¸»æœºâ€”â€”åº”ç”¨ï¼šå¤–éƒ¨ç½‘ç«™ 2ã€åŸºäºç«¯å£çš„è™šæ‹Ÿä¸»æœºï¼Œé€šè¿‡ç«¯å£æ¥åŒºåˆ†è™šæ‹Ÿä¸»æœºâ€”â€”åº”ç”¨ï¼šå…¬å¸å†…éƒ¨ç½‘ç«™ï¼Œå¤–éƒ¨ç½‘ç«™çš„ç®¡ç†åå° 3ã€åŸºäº ip çš„è™šæ‹Ÿä¸»æœºã€‚ åŸºäºè™šæ‹Ÿä¸»æœºé…ç½®åŸŸå éœ€è¦å»ºç«‹/data/www /data/bbs ç›®å½•ï¼Œwindows æœ¬åœ° hosts æ·»åŠ è™šæ‹Ÿæœº ip åœ°å€å¯¹åº”çš„åŸŸåè§£æï¼›å¯¹åº”åŸŸåç½‘ç«™ç›®å½•ä¸‹æ–°å¢ index.html æ–‡ä»¶ï¼› #å½“å®¢æˆ·ç«¯è®¿é—®www.lijie.com,ç›‘å¬ç«¯å£å·ä¸º80,ç›´æ¥è·³è½¬åˆ°data/wwwç›®å½•ä¸‹æ–‡ä»¶server &#123; listen 80; server_name www.lijie.com; location / &#123; root data/www; index index.html index.htm; &#125;&#125;#å½“å®¢æˆ·ç«¯è®¿é—®www.lijie.com,ç›‘å¬ç«¯å£å·ä¸º80,ç›´æ¥è·³è½¬åˆ°data/bbsç›®å½•ä¸‹æ–‡ä»¶server &#123; listen 80; server_name bbs.lijie.com; location / &#123; root data/bbs; index index.html index.htm; &#125;&#125; åŸºäºç«¯å£çš„è™šæ‹Ÿä¸»æœº ä½¿ç”¨ç«¯å£æ¥åŒºåˆ†ï¼Œæµè§ˆå™¨ä½¿ç”¨åŸŸåæˆ– ip åœ°å€:ç«¯å£å· è®¿é—® #å½“å®¢æˆ·ç«¯è®¿é—®www.lijie.com,ç›‘å¬ç«¯å£å·ä¸º8080,ç›´æ¥è·³è½¬åˆ°data/wwwç›®å½•ä¸‹æ–‡ä»¶server &#123; listen 8080; server_name 8080.lijie.com; location / &#123; root data/www; index index.html index.htm; &#125;&#125;#å½“å®¢æˆ·ç«¯è®¿é—®www.lijie.com,ç›‘å¬ç«¯å£å·ä¸º80ç›´æ¥è·³è½¬åˆ°çœŸå®ipæœåŠ¡å™¨åœ°å€ 127.0.0.1:8080server &#123; listen 80; server_name www.lijie.com; location / &#123; proxy_pass http://127.0.0.1:8080; index index.html index.htm; &#125;&#125; location çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿlocation æŒ‡ä»¤çš„ä½œç”¨æ˜¯æ ¹æ®ç”¨æˆ·è¯·æ±‚çš„ URI æ¥æ‰§è¡Œä¸åŒçš„åº”ç”¨ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®ç”¨æˆ·è¯·æ±‚çš„ç½‘ç«™ URL è¿›è¡ŒåŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸå³è¿›è¡Œç›¸å…³çš„æ“ä½œã€‚æ›´å¤šé¢è¯•é¢˜ï¼Œæ¬¢è¿å…³æ³¨å…¬ä¼—å· Java é¢è¯•é¢˜ç²¾é€‰ location çš„è¯­æ³•èƒ½è¯´å‡ºæ¥å—ï¼Ÿ æ³¨æ„ï¼š~ ä»£è¡¨è‡ªå·±è¾“å…¥çš„è‹±æ–‡å­—æ¯ åŒ¹é…ç¬¦ åŒ¹é…è§„åˆ™ ä¼˜å…ˆçº§ = ç²¾ç¡®åŒ¹é… 1 ^~ ä»¥æŸä¸ªå­—ç¬¦ä¸²å¼€å¤´ 2 ~ åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é… 3 ~* ä¸åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é… 4 !~ åŒºåˆ†å¤§å°å†™ä¸åŒ¹é…çš„æ­£åˆ™ 5 !~* ä¸åŒºåˆ†å¤§å°å†™ä¸åŒ¹é…çš„æ­£åˆ™ 6 / é€šç”¨åŒ¹é…ï¼Œä»»ä½•è¯·æ±‚éƒ½ä¼šåŒ¹é…åˆ° 7 Location æ­£åˆ™æ¡ˆä¾‹ ç¤ºä¾‹ï¼š #ä¼˜å…ˆçº§1,ç²¾ç¡®åŒ¹é…ï¼Œæ ¹è·¯å¾„location =/ &#123; return 400;&#125;#ä¼˜å…ˆçº§2,ä»¥æŸä¸ªå­—ç¬¦ä¸²å¼€å¤´,ä»¥avå¼€å¤´çš„ï¼Œä¼˜å…ˆåŒ¹é…è¿™é‡Œï¼ŒåŒºåˆ†å¤§å°å†™location ^~ /av &#123; root /data/av/;&#125;#ä¼˜å…ˆçº§3ï¼ŒåŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…ï¼ŒåŒ¹é…/media*****è·¯å¾„location ~ /media &#123; alias /data/static/;&#125;#ä¼˜å…ˆçº§4 ï¼Œä¸åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…ï¼Œæ‰€æœ‰çš„****.jpg|gif|png éƒ½èµ°è¿™é‡Œlocation ~* .*\\.(jpg|gif|png|js|css)$ &#123; root /data/av/;&#125;#ä¼˜å…ˆ7ï¼Œé€šç”¨åŒ¹é…location / &#123; return 403;&#125; é™æµæ€ä¹ˆåšçš„ï¼ŸNginx é™æµå°±æ˜¯é™åˆ¶ç”¨æˆ·è¯·æ±‚é€Ÿåº¦ï¼Œé˜²æ­¢æœåŠ¡å™¨å—ä¸äº† é™æµæœ‰ 3 ç§ æ­£å¸¸é™åˆ¶è®¿é—®é¢‘ç‡ï¼ˆæ­£å¸¸æµé‡ï¼‰ çªå‘é™åˆ¶è®¿é—®é¢‘ç‡ï¼ˆçªå‘æµé‡ï¼‰ é™åˆ¶å¹¶å‘è¿æ¥æ•° Nginx çš„é™æµéƒ½æ˜¯åŸºäºæ¼æ¡¶æµç®—æ³•ï¼Œåº•ä¸‹ä¼šè¯´é“ä»€ä¹ˆæ˜¯æ¡¶é“œæµ å®ç°ä¸‰ç§é™æµç®—æ³•1ã€æ­£å¸¸é™åˆ¶è®¿é—®é¢‘ç‡ï¼ˆæ­£å¸¸æµé‡ï¼‰ï¼š é™åˆ¶ä¸€ä¸ªç”¨æˆ·å‘é€çš„è¯·æ±‚ï¼Œæˆ‘ Nginx å¤šä¹…æ¥æ”¶ä¸€ä¸ªè¯·æ±‚ã€‚ Nginx ä¸­ä½¿ç”¨ ngx_http_limit_req_module æ¨¡å—æ¥é™åˆ¶çš„è®¿é—®é¢‘ç‡ï¼Œé™åˆ¶çš„åŸç†å®è´¨æ˜¯åŸºäºæ¼æ¡¶ç®—æ³•åŸç†æ¥å®ç°çš„ã€‚åœ¨ nginx.conf é…ç½®æ–‡ä»¶ä¸­å¯ä»¥ä½¿ç”¨ limit_req_zone å‘½ä»¤åŠ limit_req å‘½ä»¤é™åˆ¶å•ä¸ª IP çš„è¯·æ±‚å¤„ç†é¢‘ç‡ã€‚ #å®šä¹‰é™æµç»´åº¦ï¼Œä¸€ä¸ªç”¨æˆ·ä¸€åˆ†é’Ÿä¸€ä¸ªè¯·æ±‚è¿›æ¥ï¼Œå¤šä½™çš„å…¨éƒ¨æ¼æ‰limit_req_zone $binary_remote_addr zone=one:10m rate=1r/m;#ç»‘å®šé™æµç»´åº¦server&#123; location/seckill.html&#123; limit_req zone=zone; proxy_pass http://lj_seckill; &#125;&#125; 1r/s ä»£è¡¨ 1 ç§’ä¸€ä¸ªè¯·æ±‚ï¼Œ1r/m ä¸€åˆ†é’Ÿæ¥æ”¶ä¸€ä¸ªè¯·æ±‚ï¼Œ å¦‚æœ Nginx è¿™æ—¶è¿˜æœ‰åˆ«äººçš„è¯·æ±‚æ²¡æœ‰å¤„ç†å®Œï¼ŒNginx å°±ä¼šæ‹’ç»å¤„ç†è¯¥ç”¨æˆ·è¯·æ±‚ã€‚ 2ã€çªå‘é™åˆ¶è®¿é—®é¢‘ç‡ï¼ˆçªå‘æµé‡ï¼‰ï¼š é™åˆ¶ä¸€ä¸ªç”¨æˆ·å‘é€çš„è¯·æ±‚ï¼Œæˆ‘ Nginx å¤šä¹…æ¥æ”¶ä¸€ä¸ªã€‚ ä¸Šé¢çš„é…ç½®ä¸€å®šç¨‹åº¦å¯ä»¥é™åˆ¶è®¿é—®é¢‘ç‡ï¼Œä½†æ˜¯ä¹Ÿå­˜åœ¨ç€ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœçªå‘æµé‡è¶…å‡ºè¯·æ±‚è¢«æ‹’ç»å¤„ç†ï¼Œæ— æ³•å¤„ç†æ´»åŠ¨æ—¶å€™çš„çªå‘æµé‡ï¼Œè¿™æ—¶å€™åº”è¯¥å¦‚ä½•è¿›ä¸€æ­¥å¤„ç†å‘¢ï¼Ÿ Nginx æä¾› burst å‚æ•°ç»“åˆ nodelay å‚æ•°å¯ä»¥è§£å†³æµé‡çªå‘çš„é—®é¢˜ï¼Œå¯ä»¥è®¾ç½®èƒ½å¤„ç†çš„è¶…è¿‡è®¾ç½®çš„è¯·æ±‚æ•°å¤–èƒ½é¢å¤–å¤„ç†çš„è¯·æ±‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥å°†ä¹‹å‰çš„ä¾‹å­æ·»åŠ  burst å‚æ•°ä»¥åŠ nodelay å‚æ•°ï¼š #å®šä¹‰é™æµç»´åº¦ï¼Œä¸€ä¸ªç”¨æˆ·ä¸€åˆ†é’Ÿä¸€ä¸ªè¯·æ±‚è¿›æ¥ï¼Œå¤šä½™çš„å…¨éƒ¨æ¼æ‰limit_req_zone $binary_remote_addr zone=one:10m rate=1r/m;#ç»‘å®šé™æµç»´åº¦server&#123; location/seckill.html&#123; limit_req zone=zone burst=5 nodelay; proxy_pass http://lj_seckill; &#125;&#125; ä¸ºä»€ä¹ˆå°±å¤šäº†ä¸€ä¸ª burst=5 nodelay; å‘¢ï¼Œå¤šäº†è¿™ä¸ªå¯ä»¥ä»£è¡¨ Nginx å¯¹äºä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚ä¼šç«‹å³å¤„ç†å‰äº”ä¸ªï¼Œå¤šä½™çš„å°±æ…¢æ…¢æ¥è½ï¼Œæ²¡æœ‰å…¶ä»–ç”¨æˆ·çš„è¯·æ±‚æˆ‘å°±å¤„ç†ä½ çš„ï¼Œæœ‰å…¶ä»–çš„è¯·æ±‚çš„è¯æˆ‘ Nginx å°±æ¼æ‰ä¸æ¥å—ä½ çš„è¯·æ±‚ 3ã€ é™åˆ¶å¹¶å‘è¿æ¥æ•° Nginx ä¸­çš„ ngx_http_limit_conn_module æ¨¡å—æä¾›äº†é™åˆ¶å¹¶å‘è¿æ¥æ•°çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨ limit_conn_zone æŒ‡ä»¤ä»¥åŠ limit_conn æ‰§è¡Œè¿›è¡Œé…ç½®ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥çœ‹ä¸‹ï¼š http &#123; limit_conn_zone $binary_remote_addr zone=myip:10m; limit_conn_zone $server_name zone=myServerName:10m;&#125;server &#123; location / &#123; limit_conn myip 10; limit_conn myServerName 100; rewrite / http://www.lijie.net permanent; &#125;&#125; ä¸Šé¢é…ç½®äº†å•ä¸ª IP åŒæ—¶å¹¶å‘è¿æ¥æ•°æœ€å¤šåªèƒ½ 10 ä¸ªè¿æ¥ï¼Œå¹¶ä¸”è®¾ç½®äº†æ•´ä¸ªè™šæ‹ŸæœåŠ¡å™¨åŒæ—¶æœ€å¤§å¹¶å‘æ•°æœ€å¤šåªèƒ½ 100 ä¸ªé“¾æ¥ã€‚å½“ç„¶ï¼Œåªæœ‰å½“è¯·æ±‚çš„ header è¢«æœåŠ¡å™¨å¤„ç†åï¼Œè™šæ‹ŸæœåŠ¡å™¨çš„è¿æ¥æ•°æ‰ä¼šè®¡æ•°ã€‚ åˆšæ‰æœ‰æåˆ°è¿‡ Nginx æ˜¯åŸºäºæ¼æ¡¶ç®—æ³•åŸç†å®ç°çš„ï¼Œå®é™…ä¸Šé™æµä¸€èˆ¬éƒ½æ˜¯åŸºäºæ¼æ¡¶ç®—æ³•å’Œä»¤ç‰Œæ¡¶ç®—æ³•å®ç°çš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹çœ‹ä¸¤ä¸ªç®—æ³•çš„ä»‹ç»ï¼š æ¼æ¡¶æµç®—æ³•å’Œä»¤ç‰Œæ¡¶ç®—æ³•çŸ¥é“ï¼Ÿæ¼æ¡¶ç®—æ³• æ¼æ¡¶ç®—æ³•æ˜¯ç½‘ç»œä¸–ç•Œä¸­æµé‡æ•´å½¢æˆ–é€Ÿç‡é™åˆ¶æ—¶ç»å¸¸ä½¿ç”¨çš„ä¸€ç§ç®—æ³•ï¼Œå®ƒçš„ä¸»è¦ç›®çš„æ˜¯æ§åˆ¶æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œçš„é€Ÿç‡ï¼Œå¹³æ»‘ç½‘ç»œä¸Šçš„çªå‘æµé‡ã€‚æ¼æ¡¶ç®—æ³•æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œé€šè¿‡å®ƒï¼Œçªå‘æµé‡å¯ä»¥è¢«æ•´å½¢ä»¥ä¾¿ä¸ºç½‘ç»œæä¾›ä¸€ä¸ªç¨³å®šçš„æµé‡ã€‚ ä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšæ‰æ‰€è®²çš„æƒ…å†µã€‚æ¼æ¡¶ç®—æ³•æä¾›çš„æœºåˆ¶å®é™…ä¸Šå°±æ˜¯åˆšæ‰çš„æ¡ˆä¾‹ï¼šçªå‘æµé‡ä¼šè¿›å…¥åˆ°ä¸€ä¸ªæ¼æ¡¶ï¼Œæ¼æ¡¶ä¼šæŒ‰ç…§æˆ‘ä»¬å®šä¹‰çš„é€Ÿç‡ä¾æ¬¡å¤„ç†è¯·æ±‚ï¼Œå¦‚æœæ°´æµè¿‡å¤§ä¹Ÿå°±æ˜¯çªå‘æµé‡è¿‡å¤§å°±ä¼šç›´æ¥æº¢å‡ºï¼Œåˆ™å¤šä½™çš„è¯·æ±‚ä¼šè¢«æ‹’ç»ã€‚æ‰€ä»¥æ¼æ¡¶ç®—æ³•èƒ½æ§åˆ¶æ•°æ®çš„ä¼ è¾“é€Ÿç‡ã€‚ ä»¤ç‰Œæ¡¶ç®—æ³• ä»¤ç‰Œæ¡¶ç®—æ³•æ˜¯ç½‘ç»œæµé‡æ•´å½¢å’Œé€Ÿç‡é™åˆ¶ä¸­æœ€å¸¸ä½¿ç”¨çš„ä¸€ç§ç®—æ³•ã€‚å…¸å‹æƒ…å†µä¸‹ï¼Œä»¤ç‰Œæ¡¶ç®—æ³•ç”¨æ¥æ§åˆ¶å‘é€åˆ°ç½‘ç»œä¸Šçš„æ•°æ®çš„æ•°ç›®ï¼Œå¹¶å…è®¸çªå‘æ•°æ®çš„å‘é€ã€‚Google å¼€æºé¡¹ç›® Guava ä¸­çš„ RateLimiter ä½¿ç”¨çš„å°±æ˜¯ä»¤ç‰Œæ¡¶æ§åˆ¶ç®—æ³•ã€‚ ä»¤ç‰Œæ¡¶ç®—æ³•çš„æœºåˆ¶å¦‚ä¸‹ï¼šå­˜åœ¨ä¸€ä¸ªå¤§å°å›ºå®šçš„ä»¤ç‰Œæ¡¶ï¼Œä¼šä»¥æ’å®šçš„é€Ÿç‡æºæºä¸æ–­äº§ç”Ÿä»¤ç‰Œã€‚å¦‚æœä»¤ç‰Œæ¶ˆè€—é€Ÿç‡å°äºç”Ÿäº§ä»¤ç‰Œçš„é€Ÿåº¦ï¼Œä»¤ç‰Œå°±ä¼šä¸€ç›´äº§ç”Ÿç›´è‡³è£…æ»¡æ•´ä¸ªä»¤ç‰Œæ¡¶ã€‚æ›´å¤šé¢è¯•é¢˜ï¼Œæ¬¢è¿å…³æ³¨å…¬ä¼—å· Java é¢è¯•é¢˜ç²¾é€‰ ä¸ºä»€ä¹ˆè¦åšåŠ¨é™åˆ†ç¦»ï¼Ÿ Nginx æ˜¯å½“ä¸‹æœ€çƒ­çš„ Web å®¹å™¨ï¼Œç½‘ç«™ä¼˜åŒ–çš„é‡è¦ç‚¹åœ¨äºé™æ€åŒ–ç½‘ç«™ï¼Œç½‘ç«™é™æ€åŒ–çš„å…³é”®ç‚¹åˆ™æ˜¯æ˜¯åŠ¨é™åˆ†ç¦»ï¼ŒåŠ¨é™åˆ†ç¦»æ˜¯è®©åŠ¨æ€ç½‘ç«™é‡Œçš„åŠ¨æ€ç½‘é¡µæ ¹æ®ä¸€å®šè§„åˆ™æŠŠä¸å˜çš„èµ„æºå’Œç»å¸¸å˜çš„èµ„æºåŒºåˆ†å¼€æ¥ï¼ŒåŠ¨é™èµ„æºåšå¥½äº†æ‹†åˆ†ä»¥åï¼Œæˆ‘ä»¬åˆ™æ ¹æ®é™æ€èµ„æºçš„ç‰¹ç‚¹å°†å…¶åšç¼“å­˜æ“ä½œã€‚ è®©é™æ€çš„èµ„æºåªèµ°é™æ€èµ„æºæœåŠ¡å™¨ï¼ŒåŠ¨æ€çš„èµ°åŠ¨æ€çš„æœåŠ¡å™¨ Nginx çš„é™æ€å¤„ç†èƒ½åŠ›å¾ˆå¼ºï¼Œä½†æ˜¯åŠ¨æ€å¤„ç†èƒ½åŠ›ä¸è¶³ï¼Œå› æ­¤ï¼Œåœ¨ä¼ä¸šä¸­å¸¸ç”¨åŠ¨é™åˆ†ç¦»æŠ€æœ¯ã€‚ å¯¹äºé™æ€èµ„æºæ¯”å¦‚å›¾ç‰‡ï¼Œjsï¼Œcss ç­‰æ–‡ä»¶ï¼Œæˆ‘ä»¬åˆ™åœ¨åå‘ä»£ç†æœåŠ¡å™¨ nginx ä¸­è¿›è¡Œç¼“å­˜ã€‚è¿™æ ·æµè§ˆå™¨åœ¨è¯·æ±‚ä¸€ä¸ªé™æ€èµ„æºæ—¶ï¼Œä»£ç†æœåŠ¡å™¨ nginx å°±å¯ä»¥ç›´æ¥å¤„ç†ï¼Œæ— éœ€å°†è¯·æ±‚è½¬å‘ç»™åç«¯æœåŠ¡å™¨ tomcatã€‚ è‹¥ç”¨æˆ·è¯·æ±‚çš„åŠ¨æ€æ–‡ä»¶ï¼Œæ¯”å¦‚ servlet,jsp åˆ™è½¬å‘ç»™ Tomcat æœåŠ¡å™¨å¤„ç†ï¼Œä»è€Œå®ç°åŠ¨é™åˆ†ç¦»ã€‚è¿™ä¹Ÿæ˜¯åå‘ä»£ç†æœåŠ¡å™¨çš„ä¸€ä¸ªé‡è¦çš„ä½œç”¨ã€‚ Nginx æ€ä¹ˆåšçš„åŠ¨é™åˆ†ç¦»ï¼Ÿåªéœ€è¦æŒ‡å®šè·¯å¾„å¯¹åº”çš„ç›®å½•ã€‚location/å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‚å¹¶æŒ‡å®šå¯¹åº”çš„ç¡¬ç›˜ä¸­çš„ç›®å½•ã€‚å¦‚ä¸‹ï¼šï¼ˆæ“ä½œéƒ½æ˜¯åœ¨ Linux ä¸Šï¼‰ location /image/ &#123; root /usr/local/static/; autoindex on;&#125; 1.åˆ›å»ºç›®å½• mkdir /usr/local/static/image 2.è¿›å…¥ç›®å½• cd /usr/local/static/image 3.æ”¾ä¸€å¼ ç…§ç‰‡ä¸Šå» 1.jpg 4.é‡å¯ nginx sudo nginx -s reload æ‰“å¼€æµè§ˆå™¨ è¾“å…¥ server_name/image/1.jpg å°±å¯ä»¥è®¿é—®è¯¥é™æ€å›¾ç‰‡äº† Nginx è´Ÿè½½å‡è¡¡çš„ç®—æ³•æ€ä¹ˆå®ç°çš„?ç­–ç•¥æœ‰å“ªäº›?ä¸ºäº†é¿å…æœåŠ¡å™¨å´©æºƒï¼Œå¤§å®¶ä¼šé€šè¿‡è´Ÿè½½å‡è¡¡çš„æ–¹å¼æ¥åˆ†æ‹…æœåŠ¡å™¨å‹åŠ›ã€‚å°†å¯¹å°æœåŠ¡å™¨ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œå½“ç”¨æˆ·è®¿é—®æ—¶ï¼Œå…ˆè®¿é—®åˆ°ä¸€ä¸ªè½¬å‘æœåŠ¡å™¨ï¼Œå†ç”±è½¬å‘æœåŠ¡å™¨å°†è®¿é—®åˆ†å‘åˆ°å‹åŠ›æ›´å°çš„æœåŠ¡å™¨ã€‚ Nginx è´Ÿè½½å‡è¡¡å®ç°çš„ç­–ç•¥æœ‰ä»¥ä¸‹äº”ç§ï¼š 1 è½®è¯¢(é»˜è®¤)æ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œå¦‚æœåç«¯æŸä¸ªæœåŠ¡å™¨å®•æœºï¼Œèƒ½è‡ªåŠ¨å‰”é™¤æ•…éšœç³»ç»Ÿã€‚ upstream backserver &#123; server 192.168.0.12; server 192.168.0.13; &#125; 2 æƒé‡ weightweight çš„å€¼è¶Šå¤§åˆ†é… åˆ°çš„è®¿é—®æ¦‚ç‡è¶Šé«˜ï¼Œä¸»è¦ç”¨äºåç«¯æ¯å°æœåŠ¡å™¨æ€§èƒ½ä¸å‡è¡¡çš„æƒ…å†µä¸‹ã€‚å…¶æ¬¡æ˜¯ä¸ºåœ¨ä¸»ä»çš„æƒ…å†µä¸‹è®¾ç½®ä¸åŒçš„æƒå€¼ï¼Œè¾¾åˆ°åˆç†æœ‰æ•ˆçš„åœ°åˆ©ç”¨ä¸»æœºèµ„æºã€‚ upstream backserver &#123; server 192.168.0.12 weight=2; server 192.168.0.13 weight=8; &#125; æƒé‡è¶Šé«˜ï¼Œåœ¨è¢«è®¿é—®çš„æ¦‚ç‡è¶Šå¤§ï¼Œå¦‚ä¸Šä¾‹ï¼Œåˆ†åˆ«æ˜¯ 20%ï¼Œ80%ã€‚ 3 ip_hash( IP ç»‘å®š)æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—® IP çš„å“ˆå¸Œç»“æœåˆ†é…ï¼Œä½¿æ¥è‡ªåŒä¸€ä¸ª IP çš„è®¿å®¢å›ºå®šè®¿é—®ä¸€å°åç«¯æœåŠ¡å™¨ï¼Œå¹¶ä¸”å¯ä»¥æœ‰æ•ˆè§£å†³åŠ¨æ€ç½‘é¡µå­˜åœ¨çš„ session å…±äº«é—®é¢˜ upstream backserver &#123; ip_hash; server 192.168.0.12:88; server 192.168.0.13:80; &#125; 4 fair(ç¬¬ä¸‰æ–¹æ’ä»¶)å¿…é¡»å®‰è£… upstream_fair æ¨¡å—ã€‚ å¯¹æ¯” weightã€ip_hash æ›´åŠ æ™ºèƒ½çš„è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œfair ç®—æ³•å¯ä»¥æ ¹æ®é¡µé¢å¤§å°å’ŒåŠ è½½æ—¶é—´é•¿çŸ­æ™ºèƒ½åœ°è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚ upstream backserver &#123; server server1; server server2; fair; &#125; å“ªä¸ªæœåŠ¡å™¨çš„å“åº”é€Ÿåº¦å¿«ï¼Œå°±å°†è¯·æ±‚åˆ†é…åˆ°é‚£ä¸ªæœåŠ¡å™¨ä¸Šã€‚ 5ã€url_hash(ç¬¬ä¸‰æ–¹æ’ä»¶)å¿…é¡»å®‰è£… Nginx çš„ hash è½¯ä»¶åŒ… æŒ‰è®¿é—® url çš„ hash ç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œä½¿æ¯ä¸ª url å®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è¿›ä¸€æ­¥æé«˜åç«¯ç¼“å­˜æœåŠ¡å™¨çš„æ•ˆç‡ã€‚ upstream backserver &#123; server squid1:3128; server squid2:3128; hash $request_uri; hash_method crc32; &#125; Nginx é…ç½®é«˜å¯ç”¨æ€§æ€ä¹ˆé…ç½®ï¼Ÿå½“ä¸Šæ¸¸æœåŠ¡å™¨(çœŸå®è®¿é—®æœåŠ¡å™¨)ï¼Œä¸€æ—¦å‡ºç°æ•…éšœæˆ–è€…æ˜¯æ²¡æœ‰åŠæ—¶ç›¸åº”çš„è¯ï¼Œåº”è¯¥ç›´æ¥è½®è®­åˆ°ä¸‹ä¸€å°æœåŠ¡å™¨ï¼Œä¿è¯æœåŠ¡å™¨çš„é«˜å¯ç”¨ Nginx é…ç½®ä»£ç ï¼š server &#123; listen 80; server_name www.lijie.com; location / &#123; ### æŒ‡å®šä¸Šæ¸¸æœåŠ¡å™¨è´Ÿè½½å‡è¡¡æœåŠ¡å™¨ proxy_pass http://backServer; ###nginxä¸ä¸Šæ¸¸æœåŠ¡å™¨(çœŸå®è®¿é—®çš„æœåŠ¡å™¨)è¶…æ—¶æ—¶é—´ åç«¯æœåŠ¡å™¨è¿æ¥çš„è¶…æ—¶æ—¶é—´_å‘èµ·æ¡æ‰‹ç­‰å€™å“åº”è¶…æ—¶æ—¶é—´ proxy_connect_timeout 1s; ###nginxå‘é€ç»™ä¸Šæ¸¸æœåŠ¡å™¨(çœŸå®è®¿é—®çš„æœåŠ¡å™¨)è¶…æ—¶æ—¶é—´ proxy_send_timeout 1s; ### nginxæ¥å—ä¸Šæ¸¸æœåŠ¡å™¨(çœŸå®è®¿é—®çš„æœåŠ¡å™¨)è¶…æ—¶æ—¶é—´ proxy_read_timeout 1s; index index.html index.htm; &#125; &#125; Nginx æ€ä¹ˆåˆ¤æ–­åˆ« IP ä¸å¯è®¿é—®ï¼Ÿ# å¦‚æœè®¿é—®çš„ipåœ°å€ä¸º192.168.9.115,åˆ™è¿”å›403if ($remote_addr = 192.168.9.115) &#123; return 403; &#125; æ€ä¹ˆé™åˆ¶æµè§ˆå™¨è®¿é—®ï¼Ÿ## ä¸å…è®¸è°·æ­Œæµè§ˆå™¨è®¿é—® å¦‚æœæ˜¯è°·æ­Œæµè§ˆå™¨è¿”å›500if ($http_user_agent ~ Chrome) &#123; return 500; &#125; Rewrite å…¨å±€å˜é‡æ˜¯ä»€ä¹ˆï¼Ÿ- $args ï¼š #è¿™ä¸ªå˜é‡ç­‰äºè¯·æ±‚è¡Œä¸­çš„å‚æ•°ï¼ŒåŒ$query_string- $content_length ï¼š è¯·æ±‚å¤´ä¸­çš„Content-lengthå­—æ®µã€‚- $content_type ï¼š è¯·æ±‚å¤´ä¸­çš„Content-Typeå­—æ®µã€‚- $document_root ï¼š å½“å‰è¯·æ±‚åœ¨rootæŒ‡ä»¤ä¸­æŒ‡å®šçš„å€¼ã€‚- $host ï¼š è¯·æ±‚ä¸»æœºå¤´å­—æ®µï¼Œå¦åˆ™ä¸ºæœåŠ¡å™¨åç§°ã€‚- $http_user_agent ï¼š å®¢æˆ·ç«¯agentä¿¡æ¯- $http_cookie ï¼š å®¢æˆ·ç«¯cookieä¿¡æ¯- $limit_rate ï¼š è¿™ä¸ªå˜é‡å¯ä»¥é™åˆ¶è¿æ¥é€Ÿç‡ã€‚- $request_method ï¼š å®¢æˆ·ç«¯è¯·æ±‚çš„åŠ¨ä½œï¼Œé€šå¸¸ä¸ºGETæˆ–POSTã€‚- $remote_addr ï¼š å®¢æˆ·ç«¯çš„IPåœ°å€ã€‚- $remote_port ï¼š å®¢æˆ·ç«¯çš„ç«¯å£ã€‚- $remote_user ï¼š å·²ç»ç»è¿‡Auth Basic ModuleéªŒè¯çš„ç”¨æˆ·åã€‚- $request_filename ï¼š å½“å‰è¯·æ±‚çš„æ–‡ä»¶è·¯å¾„ï¼Œç”±rootæˆ–aliasæŒ‡ä»¤ä¸URIè¯·æ±‚ç”Ÿæˆã€‚- $scheme ï¼š HTTPæ–¹æ³•ï¼ˆå¦‚httpï¼Œhttpsï¼‰ã€‚- $server_protocol ï¼š è¯·æ±‚ä½¿ç”¨çš„åè®®ï¼Œé€šå¸¸æ˜¯HTTP/1.0æˆ–HTTP/1.1ã€‚- $server_addr ï¼š æœåŠ¡å™¨åœ°å€ï¼Œåœ¨å®Œæˆä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨åå¯ä»¥ç¡®å®šè¿™ä¸ªå€¼ã€‚- $server_name ï¼š æœåŠ¡å™¨åç§°ã€‚- $server_port ï¼š è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨çš„ç«¯å£å·ã€‚- $request_uri ï¼š åŒ…å«è¯·æ±‚å‚æ•°çš„åŸå§‹URIï¼Œä¸åŒ…å«ä¸»æœºåï¼Œå¦‚ï¼šâ€/foo/bar.php?arg=bazâ€ã€‚- $uri ï¼š ä¸å¸¦è¯·æ±‚å‚æ•°çš„å½“å‰URIï¼Œ$uriä¸åŒ…å«ä¸»æœºåï¼Œå¦‚â€/foo/bar.htmlâ€ã€‚- $document_uri ï¼š ä¸$uriç›¸åŒ è½¬è½½ç›˜ç‚¹é‚£äº›å…³äº Nginx çš„å¸¸è€ƒé¢è¯•é¢˜","updated":"2025-08-02T05:46:04.179Z","tags":[{"name":"nginx","slug":"nginx","permalink":"https://luckyship.github.io/tags/nginx/"},{"name":"review","slug":"review","permalink":"https://luckyship.github.io/tags/review/"}]},{"title":"nginxä½¿ç”¨åœºæ™¯","date":"2022-02-12T10:06:38.000Z","path":"2022/02/12/2022-02-12-nginx-use/","text":"nginx ä½¿ç”¨åœºæ™¯åˆ†ä¸ºï¼š http æœåŠ¡å™¨ é™æ€æœåŠ¡å™¨ åå‘ä»£ç† è´Ÿè½½å‡è¡¡ åŠ¨é™åˆ†ç¦» ä¸€ï¼šHTTP æœåŠ¡å™¨Nginxæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªé™æ€èµ„æºçš„æœåŠ¡å™¨ï¼Œå½“åªæœ‰é™æ€èµ„æºçš„æ—¶å€™ï¼Œå°±å¯ä»¥ä½¿ç”¨ Nginx æ¥åšæœåŠ¡å™¨ï¼Œå¦‚æœä¸€ä¸ªç½‘ç«™åªæ˜¯é™æ€é¡µé¢çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼æ¥å®ç°éƒ¨ç½²ã€‚ 1ã€ é¦–å…ˆåœ¨æ–‡æ¡£æ ¹ç›®å½• Docroot(/usr/local/var/www)ä¸‹åˆ›å»º html ç›®å½•, ç„¶ååœ¨ html ä¸­æ”¾ä¸€ä¸ª test.html; 2ã€ é…ç½® nginx.conf ä¸­çš„ server user mengday staff;http &#123; server &#123; listen 80; server_name localhost; client_max_body_size 1024M; # é»˜è®¤location location / &#123; root /usr/local/var/www/html; index index.html index.htm; &#125; &#125;&#125; 3ã€è®¿é—®æµ‹è¯• http://localhost/ æŒ‡å‘/usr/local/var/www/index.html, index.html æ˜¯å®‰è£… nginx è‡ªå¸¦çš„ html http://localhost/test.html æŒ‡å‘/usr/local/var/www/html/test.html æ³¨æ„ï¼šå¦‚æœè®¿é—®å›¾ç‰‡å‡ºç° 403 Forbidden é”™è¯¯ï¼Œå¯èƒ½æ˜¯å› ä¸º nginx.conf çš„ç¬¬ä¸€è¡Œ user é…ç½®ä¸å¯¹ï¼Œé»˜è®¤æ˜¯#user nobody;æ˜¯æ³¨é‡Šçš„ï¼Œlinux ä¸‹æ”¹æˆ user root; macos ä¸‹æ”¹æˆ user ç”¨æˆ·å æ‰€åœ¨ç»„; ç„¶åé‡æ–°åŠ è½½é…ç½®æ–‡ä»¶æˆ–è€…é‡å¯ï¼Œå†è¯•ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œ ç”¨æˆ·åå¯ä»¥é€šè¿‡ who am i å‘½ä»¤æ¥æŸ¥çœ‹ã€‚ 4ã€æŒ‡ä»¤ç®€ä»‹ server : ç”¨äºå®šä¹‰æœåŠ¡ï¼Œhttp ä¸­å¯ä»¥æœ‰å¤šä¸ª server å— listen : æŒ‡å®šæœåŠ¡å™¨ä¾¦å¬è¯·æ±‚çš„ IP åœ°å€å’Œç«¯å£ï¼Œå¦‚æœçœç•¥åœ°å€ï¼ŒæœåŠ¡å™¨å°†ä¾¦å¬æ‰€æœ‰åœ°å€ï¼Œå¦‚æœçœç•¥ç«¯å£ï¼Œåˆ™ä½¿ç”¨æ ‡å‡†ç«¯å£ server_name : æœåŠ¡åç§°ï¼Œç”¨äºé…ç½®åŸŸå location : ç”¨äºé…ç½®æ˜ å°„è·¯å¾„ uri å¯¹åº”çš„é…ç½®ï¼Œä¸€ä¸ª server ä¸­å¯ä»¥æœ‰å¤šä¸ª location, location åé¢è·Ÿä¸€ä¸ª uri,å¯ä»¥æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼, / è¡¨ç¤ºåŒ¹é…ä»»æ„è·¯å¾„, å½“å®¢æˆ·ç«¯è®¿é—®çš„è·¯å¾„æ»¡è¶³è¿™ä¸ª uri æ—¶å°±ä¼šæ‰§è¡Œ location å—é‡Œé¢çš„ä»£ç  root : æ ¹è·¯å¾„ï¼Œå½“è®¿é—® http://localhost/test.htmlï¼Œâ€œ/test.htmlâ€ä¼šåŒ¹é…åˆ°â€/â€œuri, æ‰¾åˆ° root ä¸º/usr/local/var/www/htmlï¼Œç”¨æˆ·è®¿é—®çš„èµ„æºç‰©ç†åœ°å€=root + uri = /usr/local/var/www/html + /test.html=/usr/local/var/www/html/test.html index : è®¾ç½®é¦–é¡µï¼Œå½“åªè®¿é—® server_name æ—¶åé¢ä¸è·Ÿä»»ä½•è·¯å¾„æ˜¯ä¸èµ° root ç›´æ¥èµ° index æŒ‡ä»¤çš„ï¼›å¦‚æœè®¿é—®è·¯å¾„ä¸­æ²¡æœ‰æŒ‡å®šå…·ä½“çš„æ–‡ä»¶ï¼Œåˆ™è¿”å› index è®¾ç½®çš„èµ„æºï¼Œå¦‚æœè®¿é—® http://localhost/html/ åˆ™é»˜è®¤è¿”å› index.html 5ã€location uri æ­£åˆ™è¡¨è¾¾å¼ . ï¼š åŒ¹é…é™¤æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å­—ç¬¦? ï¼š é‡å¤0æ¬¡æˆ–1æ¬¡+ ï¼š é‡å¤1æ¬¡æˆ–æ›´å¤šæ¬¡* ï¼š é‡å¤0æ¬¡æˆ–æ›´å¤šæ¬¡\\d ï¼šåŒ¹é…æ•°å­—^ ï¼š åŒ¹é…å­—ç¬¦ä¸²çš„å¼€å§‹$ ï¼š åŒ¹é…å­—ç¬¦ä¸²çš„ç»“æŸ&#123;n&#125; ï¼š é‡å¤næ¬¡&#123;n,&#125; ï¼š é‡å¤næ¬¡æˆ–æ›´å¤šæ¬¡[c] ï¼š åŒ¹é…å•ä¸ªå­—ç¬¦c[a-z] ï¼š åŒ¹é…a-zå°å†™å­—æ¯çš„ä»»æ„ä¸€ä¸ª(a|b|c) : å±çº¿è¡¨ç¤ºåŒ¹é…ä»»æ„ä¸€ç§æƒ…å†µï¼Œæ¯ç§æƒ…å†µä½¿ç”¨ç«–çº¿åˆ†éš”ï¼Œä¸€èˆ¬ä½¿ç”¨å°æ‹¬å·æ‹¬æ‹¬ä½ï¼ŒåŒ¹é…ç¬¦åˆaå­—ç¬¦ æˆ–æ˜¯bå­—ç¬¦ æˆ–æ˜¯cå­—ç¬¦çš„å­—ç¬¦ä¸²\\ åæ–œæ ï¼šç”¨äºè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦å°æ‹¬å·()ä¹‹é—´åŒ¹é…çš„å†…å®¹ï¼Œå¯ä»¥åœ¨åé¢é€šè¿‡$1æ¥å¼•ç”¨ï¼Œ$2è¡¨ç¤ºçš„æ˜¯å‰é¢ç¬¬äºŒä¸ª()é‡Œçš„å†…å®¹ã€‚æ­£åˆ™é‡Œé¢å®¹æ˜“è®©äººå›°æƒ‘çš„æ˜¯\\è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ã€‚ äºŒï¼š é™æ€æœåŠ¡å™¨åœ¨å…¬å¸ä¸­ç»å¸¸ä¼šé‡åˆ°é™æ€æœåŠ¡å™¨ï¼Œé€šå¸¸ä¼šæä¾›ä¸€ä¸ªä¸Šä¼ çš„åŠŸèƒ½ï¼Œå…¶ä»–åº”ç”¨å¦‚æœéœ€è¦é™æ€èµ„æºå°±ä»è¯¥é™æ€æœåŠ¡å™¨ä¸­è·å–ã€‚ 1ã€åœ¨/usr/local/var/www ä¸‹åˆ†åˆ«åˆ›å»º images å’Œ img ç›®å½•ï¼Œåˆ†åˆ«åœ¨æ¯ä¸ªç›®å½•ä¸‹æ”¾ä¸€å¼  test.jpg http &#123; server &#123; listen 80; server_name localhost; set $doc_root /usr/local/var/www; # é»˜è®¤location location / &#123; root /usr/local/var/www/html; index index.html index.htm; &#125; location ^~ /images/ &#123; root $doc_root; &#125; location ~* \\.(gif|jpg|jpeg|png|bmp|ico|swf|css|js)$ &#123; root $doc_root/img; &#125; &#125;&#125; è‡ªå®šä¹‰å˜é‡ä½¿ç”¨ set æŒ‡ä»¤ï¼Œè¯­æ³• set å˜ é‡ å å€¼ ; å¼• ç”¨ ä½¿ ç”¨ å˜é‡å å€¼; å¼•ç”¨ä½¿ç”¨ å˜é‡åå€¼;å¼•ç”¨ä½¿ç”¨å˜é‡å; è¿™é‡Œè‡ªå®šä¹‰äº† doc_root å˜é‡ã€‚ é™æ€æœåŠ¡å™¨ location çš„æ˜ å°„ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼š ä½¿ç”¨è·¯å¾„ï¼Œå¦‚ /images/ ä¸€èˆ¬å›¾ç‰‡éƒ½ä¼šæ”¾åœ¨æŸä¸ªå›¾ç‰‡ç›®å½•ä¸‹ï¼Œ ä½¿ç”¨åç¼€ï¼Œå¦‚ .jpgã€.png ç­‰åç¼€åŒ¹é…æ¨¡å¼ è®¿é—® http://localhost/test.jpg ä¼šæ˜ å°„åˆ°$doc_root/img è®¿é—® http://localhost/images/test.jpg å½“åŒä¸€ä¸ªè·¯å¾„æ»¡è¶³å¤šä¸ª location æ—¶ï¼Œä¼˜å…ˆåŒ¹é…ä¼˜å…ˆçº§é«˜çš„ locationï¼Œç”±äº^~ çš„ä¼˜å…ˆçº§å¤§äº ~, æ‰€ä»¥ä¼šèµ°/images/å¯¹åº”çš„ location å¸¸è§çš„ location è·¯å¾„æ˜ å°„è·¯å¾„æœ‰ä»¥ä¸‹å‡ ç§ï¼š = è¿›è¡Œæ™®é€šå­—ç¬¦ç²¾ç¡®åŒ¹é…ã€‚ä¹Ÿå°±æ˜¯å®Œå…¨åŒ¹é…ã€‚^~ å‰ç¼€åŒ¹é…ã€‚å¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™ä¸å†åŒ¹é…å…¶ä»–locationã€‚~ è¡¨ç¤ºæ‰§è¡Œä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼ŒåŒºåˆ†å¤§å°å†™~* è¡¨ç¤ºæ‰§è¡Œä¸€ä¸ªæ­£åˆ™åŒ¹é…ï¼Œä¸åŒºåˆ†å¤§å°å†™/xxx/ å¸¸è§„å­—ç¬¦ä¸²è·¯å¾„åŒ¹é…/ é€šç”¨åŒ¹é…ï¼Œä»»ä½•è¯·æ±‚éƒ½ä¼šåŒ¹é…åˆ° location ä¼˜å…ˆçº§å½“ä¸€ä¸ªè·¯å¾„åŒ¹é…å¤šä¸ª location æ—¶ç©¶ç«Ÿå“ªä¸ª location èƒ½åŒ¹é…åˆ°æ—¶æœ‰ä¼˜å…ˆçº§é¡ºåºçš„ï¼Œè€Œä¼˜å…ˆçº§çš„é¡ºåºäº location å€¼çš„è¡¨è¾¾å¼ç±»å‹æœ‰å…³ï¼Œå’Œåœ¨é…ç½®æ–‡ä»¶ä¸­çš„å…ˆåé¡ºåºæ— å…³ã€‚ç›¸åŒç±»å‹çš„è¡¨è¾¾å¼ï¼Œå­—ç¬¦ä¸²é•¿çš„ä¼šä¼˜å…ˆåŒ¹é…ã€‚ ä»¥ä¸‹æ˜¯æŒ‰ä¼˜å…ˆçº§æ’åˆ—è¯´æ˜ï¼š ç­‰å·ç±»å‹ï¼ˆ=ï¼‰çš„ä¼˜å…ˆçº§æœ€é«˜ã€‚ä¸€æ—¦åŒ¹é…æˆåŠŸï¼Œåˆ™ä¸å†æŸ¥æ‰¾å…¶ä»–åŒ¹é…é¡¹ï¼Œåœæ­¢æœç´¢ã€‚ ^~ç±»å‹è¡¨è¾¾å¼ï¼Œä¸å±äºæ­£åˆ™è¡¨è¾¾å¼ã€‚ä¸€æ—¦åŒ¹é…æˆåŠŸï¼Œåˆ™ä¸å†æŸ¥æ‰¾å…¶ä»–åŒ¹é…é¡¹ï¼Œåœæ­¢æœç´¢ã€‚ æ­£åˆ™è¡¨è¾¾å¼ç±»å‹ï¼ˆ~ ~*ï¼‰çš„ä¼˜å…ˆçº§æ¬¡ä¹‹ã€‚å¦‚æœæœ‰å¤šä¸ª location çš„æ­£åˆ™èƒ½åŒ¹é…çš„è¯ï¼Œåˆ™ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æœ€é•¿çš„é‚£ä¸ªã€‚ å¸¸è§„å­—ç¬¦ä¸²åŒ¹é…ç±»å‹ã€‚æŒ‰å‰ç¼€åŒ¹é…ã€‚ / é€šç”¨åŒ¹é…ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ï¼Œå°±åŒ¹é…é€šç”¨çš„ ä¼˜å…ˆçº§æœç´¢é—®é¢˜ï¼šä¸åŒç±»å‹çš„ location æ˜ å°„å†³å®šæ˜¯å¦ç»§ç»­å‘ä¸‹æœç´¢ ç­‰å·ç±»å‹ã€^~ç±»å‹ï¼šä¸€æ—¦åŒ¹é…ä¸Šå°±åœæ­¢æœç´¢äº†ï¼Œä¸ä¼šå†åŒ¹é…å…¶ä»– location äº† æ­£åˆ™è¡¨è¾¾å¼ç±»å‹(~ ~*ï¼‰,å¸¸è§„å­—ç¬¦ä¸²åŒ¹é…ç±»å‹/xxx/ : åŒ¹é…åˆ°ä¹‹åï¼Œè¿˜ä¼šç»§ç»­æœç´¢å…¶ä»–å…¶å®ƒ locationï¼Œç›´åˆ°æ‰¾åˆ°ä¼˜å…ˆçº§æœ€é«˜çš„ï¼Œæˆ–è€…æ‰¾åˆ°ç¬¬ä¸€ç§æƒ…å†µè€Œåœæ­¢æœç´¢ location ä¼˜å…ˆçº§ä»é«˜åˆ°åº•ï¼š (location =) &gt; (location å®Œæ•´è·¯å¾„) &gt; (location ^~ è·¯å¾„) &gt; (location ,* æ­£åˆ™é¡ºåº) &gt; (location éƒ¨åˆ†èµ·å§‹è·¯å¾„) &gt; (/) location = / &#123; # ç²¾ç¡®åŒ¹é…/ï¼Œä¸»æœºååé¢ä¸èƒ½å¸¦ä»»ä½•å­—ç¬¦ä¸² / [ configuration A ]&#125;location / &#123; # åŒ¹é…æ‰€æœ‰ä»¥ / å¼€å¤´çš„è¯·æ±‚ã€‚ # ä½†æ˜¯å¦‚æœæœ‰æ›´é•¿çš„åŒç±»å‹çš„è¡¨è¾¾å¼ï¼Œåˆ™é€‰æ‹©æ›´é•¿çš„è¡¨è¾¾å¼ã€‚ # å¦‚æœæœ‰æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥åŒ¹é…ï¼Œåˆ™ä¼˜å…ˆåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ã€‚ [ configuration B ]&#125;location /documents/ &#123; # åŒ¹é…æ‰€æœ‰ä»¥ /documents/ å¼€å¤´çš„è¯·æ±‚ï¼ŒåŒ¹é…ç¬¦åˆä»¥åï¼Œè¿˜è¦ç»§ç»­å¾€ä¸‹æœç´¢ã€‚ # ä½†æ˜¯å¦‚æœæœ‰æ›´é•¿çš„åŒç±»å‹çš„è¡¨è¾¾å¼ï¼Œåˆ™é€‰æ‹©æ›´é•¿çš„è¡¨è¾¾å¼ã€‚ # å¦‚æœæœ‰æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥åŒ¹é…ï¼Œåˆ™ä¼˜å…ˆåŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ã€‚ [ configuration C ]&#125;location ^~ /images/ &#123; # åŒ¹é…æ‰€æœ‰ä»¥ /images/ å¼€å¤´çš„è¡¨è¾¾å¼ï¼Œå¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™åœæ­¢åŒ¹é…æŸ¥æ‰¾ï¼Œåœæ­¢æœç´¢ã€‚ # æ‰€ä»¥ï¼Œå³ä¾¿æœ‰ç¬¦åˆçš„æ­£åˆ™è¡¨è¾¾å¼locationï¼Œä¹Ÿä¸ä¼šè¢«ä½¿ç”¨ [ configuration D ]&#125;location ~* \\.(gif|jpg|jpeg)$ &#123; # åŒ¹é…æ‰€æœ‰ä»¥ gif jpg jpegç»“å°¾çš„è¯·æ±‚ã€‚ # ä½†æ˜¯ ä»¥ /images/å¼€å¤´çš„è¯·æ±‚ï¼Œå°†ä½¿ç”¨ Configuration Dï¼ŒDå…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ [ configuration E ]&#125;location /images/ &#123; # å­—ç¬¦åŒ¹é…åˆ° /images/ï¼Œè¿˜ä¼šç»§ç»­å¾€ä¸‹æœç´¢ [ configuration F ]&#125;location = /test.htm &#123; root /usr/local/var/www/htm; index index.htm;&#125;æ³¨æ„ï¼šlocationçš„ä¼˜å…ˆçº§ä¸locationé…ç½®çš„ä½ç½®æ— å…³ ä¸‰ï¼š åå‘ä»£ç†åå‘ä»£ç†åº”è¯¥æ˜¯ Nginx ä½¿ç”¨æœ€å¤šçš„åŠŸèƒ½äº†ï¼Œåå‘ä»£ç†(Reverse Proxy)æ–¹å¼æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥å— internet ä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™ internet ä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ã€‚ ç®€å•æ¥è¯´å°±æ˜¯çœŸå®çš„æœåŠ¡å™¨ä¸èƒ½ç›´æ¥è¢«å¤–éƒ¨ç½‘ç»œè®¿é—®ï¼Œæ‰€ä»¥éœ€è¦ä¸€å°ä»£ç†æœåŠ¡å™¨ï¼Œè€Œä»£ç†æœåŠ¡å™¨èƒ½è¢«å¤–éƒ¨ç½‘ç»œè®¿é—®çš„åŒæ—¶åˆè·ŸçœŸå®æœåŠ¡å™¨åœ¨åŒä¸€ä¸ªç½‘ç»œç¯å¢ƒï¼Œå½“ç„¶ä¹Ÿå¯èƒ½æ˜¯åŒä¸€å°æœåŠ¡å™¨ï¼Œç«¯å£ä¸åŒè€Œå·²ã€‚åå‘ä»£ç†é€šè¿‡ proxy_pass æŒ‡ä»¤æ¥å®ç°ã€‚ å¯åŠ¨ä¸€ä¸ª Java Web é¡¹ç›®ï¼Œç«¯å£å·ä¸º 8081 server &#123; listen 80; server_name localhost; location / &#123; proxy_pass http://localhost:8081; proxy_set_header Host $host:$server_port; # è®¾ç½®ç”¨æˆ·ipåœ°å€ proxy_set_header X-Forwarded-For $remote_addr; # å½“è¯·æ±‚æœåŠ¡å™¨å‡ºé”™å»å¯»æ‰¾å…¶ä»–æœåŠ¡å™¨ proxy_next_upstream error timeout invalid_header http_500 http_502 http_503; &#125;&#125; å½“æˆ‘ä»¬è®¿é—® localhost çš„æ—¶å€™ï¼Œå°±ç›¸å½“äºè®¿é—® localhost:8081 äº† å››ï¼šè´Ÿè½½å‡è¡¡è´Ÿè½½å‡è¡¡ä¹Ÿæ˜¯ Nginx å¸¸ç”¨çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œè´Ÿè½½å‡è¡¡å…¶æ„æ€å°±æ˜¯åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šè¿›è¡Œæ‰§è¡Œï¼Œä¾‹å¦‚ Web æœåŠ¡å™¨ã€FTP æœåŠ¡å™¨ã€ä¼ä¸šå…³é”®åº”ç”¨æœåŠ¡å™¨å’Œå…¶å®ƒå…³é”®ä»»åŠ¡æœåŠ¡å™¨ç­‰ï¼Œä»è€Œå…±åŒå®Œæˆå·¥ä½œä»»åŠ¡ã€‚ç®€å•è€Œè¨€å°±æ˜¯å½“æœ‰ 2 å°æˆ–ä»¥ä¸ŠæœåŠ¡å™¨æ—¶ï¼Œæ ¹æ®è§„åˆ™éšæœºçš„å°†è¯·æ±‚åˆ†å‘åˆ°æŒ‡å®šçš„æœåŠ¡å™¨ä¸Šå¤„ç†ï¼Œè´Ÿè½½å‡è¡¡é…ç½®ä¸€èˆ¬éƒ½éœ€è¦åŒæ—¶é…ç½®åå‘ä»£ç†ï¼Œé€šè¿‡åå‘ä»£ç†è·³è½¬åˆ°è´Ÿè½½å‡è¡¡ã€‚è€Œ Nginx ç›®å‰æ”¯æŒè‡ªå¸¦ 3 ç§è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œè¿˜æœ‰ 2 ç§å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹ç­–ç•¥ã€‚ è´Ÿè½½å‡è¡¡é€šè¿‡ upstream æŒ‡ä»¤æ¥å®ç°ã€‚ 1 RR(round robin :è½®è¯¢ é»˜è®¤)ï¼šæ¯ä¸ªè¯·æ±‚æŒ‰æ—¶é—´é¡ºåºé€ä¸€åˆ†é…åˆ°ä¸åŒçš„åç«¯æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ˜¯è¯´ç¬¬ä¸€æ¬¡è¯·æ±‚åˆ†é…åˆ°ç¬¬ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œç¬¬äºŒæ¬¡è¯·æ±‚åˆ†é…åˆ°ç¬¬äºŒå°æœåŠ¡å™¨ä¸Šï¼Œå¦‚æœåªæœ‰ä¸¤å°æœåŠ¡å™¨ï¼Œç¬¬ä¸‰æ¬¡è¯·æ±‚ç»§ç»­åˆ†é…åˆ°ç¬¬ä¸€å°ä¸Šï¼Œè¿™æ ·å¾ªç¯è½®è¯¢ä¸‹å»ï¼Œä¹Ÿå°±æ˜¯æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚çš„æ¯”ä¾‹æ˜¯ 1:1ï¼Œ å¦‚æœåç«¯æœåŠ¡å™¨ down æ‰ï¼Œèƒ½è‡ªåŠ¨å‰”é™¤ã€‚è½®è¯¢æ˜¯é»˜è®¤é…ç½®ï¼Œä¸éœ€è¦å¤ªå¤šçš„é…ç½® åŒä¸€ä¸ªé¡¹ç›®åˆ†åˆ«ä½¿ç”¨ 8081 å’Œ 8082 ç«¯å£å¯åŠ¨é¡¹ç›® upstream web_servers &#123; server localhost:8081; server localhost:8082;&#125;server &#123; listen 80; server_name localhost; #access_log logs/host.access.log main; location / &#123; proxy_pass http://web_servers; # å¿…é¡»æŒ‡å®šHeader Host proxy_set_header Host $host:$server_port; &#125; &#125; è®¿é—®åœ°å€ä»ç„¶å¯ä»¥è·å¾—å“åº” http://localhost/api/user/login?username=zhangsan&amp;password=111111 ï¼Œè¿™ç§æ–¹å¼æ˜¯è½®è¯¢çš„ 2 æƒé‡æŒ‡å®šè½®è¯¢å‡ ç‡ï¼Œweight å’Œè®¿é—®æ¯”ç‡æˆæ­£æ¯”, ä¹Ÿå°±æ˜¯æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚çš„æ¯”ä¾‹å°±æ˜¯å„è‡ªé…ç½®çš„ weight çš„æ¯”ä¾‹ï¼Œç”¨äºåç«¯æœåŠ¡å™¨æ€§èƒ½ä¸å‡çš„æƒ…å†µ,æ¯”å¦‚æœåŠ¡å™¨æ€§èƒ½å·®ç‚¹å°±å°‘æ¥æ”¶ç‚¹è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ€§èƒ½å¥½ç‚¹å°±å¤šå¤„ç†ç‚¹è¯·æ±‚ã€‚ upstream test &#123; server localhost:8081 weight=1; server localhost:8082 weight=3; server localhost:8083 weight=4 backup;&#125; ç¤ºä¾‹æ˜¯ 4 æ¬¡è¯·æ±‚åªæœ‰ä¸€æ¬¡è¢«åˆ†é…åˆ° 8081 ä¸Šï¼Œå…¶ä»– 3 æ¬¡åˆ†é…åˆ° 8082 ä¸Šã€‚backup æ˜¯æŒ‡çƒ­å¤‡ï¼Œåªæœ‰å½“ 8081 å’Œ 8082 éƒ½å®•æœºçš„æƒ…å†µä¸‹æ‰èµ° 8083 3 ip_hashä¸Šé¢çš„ 2 ç§æ–¹å¼éƒ½æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ä¸‹ä¸€ä¸ªè¯·æ±‚æ¥çš„æ—¶å€™è¯·æ±‚å¯èƒ½åˆ†å‘åˆ°å¦å¤–ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå½“æˆ‘ä»¬çš„ç¨‹åºä¸æ˜¯æ— çŠ¶æ€çš„æ—¶å€™(é‡‡ç”¨äº† session ä¿å­˜æ•°æ®)ï¼Œè¿™æ—¶å€™å°±æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¾ˆé—®é¢˜äº†ï¼Œæ¯”å¦‚æŠŠç™»å½•ä¿¡æ¯ä¿å­˜åˆ°äº† session ä¸­ï¼Œé‚£ä¹ˆè·³è½¬åˆ°å¦å¤–ä¸€å°æœåŠ¡å™¨çš„æ—¶å€™å°±éœ€è¦é‡æ–°ç™»å½•äº†ï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå®¢æˆ·åªè®¿é—®ä¸€ä¸ªæœåŠ¡å™¨ï¼Œé‚£ä¹ˆå°±éœ€è¦ç”¨ iphash äº†ï¼Œiphash çš„æ¯ä¸ªè¯·æ±‚æŒ‰è®¿é—® ip çš„ hash ç»“æœåˆ†é…ï¼Œè¿™æ ·æ¯ä¸ªè®¿å®¢å›ºå®šè®¿é—®ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œå¯ä»¥è§£å†³ session çš„é—®é¢˜ã€‚ upstream test &#123; ip_hash; server localhost:8080; server localhost:8081;&#125; 4 fair(ç¬¬ä¸‰æ–¹)æŒ‰åç«¯æœåŠ¡å™¨çš„å“åº”æ—¶é—´æ¥åˆ†é…è¯·æ±‚ï¼Œå“åº”æ—¶é—´çŸ­çš„ä¼˜å…ˆåˆ†é…ã€‚è¿™ä¸ªé…ç½®æ˜¯ä¸ºäº†æ›´å¿«çš„ç»™ç”¨æˆ·å“åº” upstream backend &#123; fair; server localhost:8080; server localhost:8081;&#125; 5 url_hash(ç¬¬ä¸‰æ–¹)æŒ‰è®¿é—® url çš„ hash ç»“æœæ¥åˆ†é…è¯·æ±‚ï¼Œä½¿æ¯ä¸ª url å®šå‘åˆ°åŒä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨ä¸ºç¼“å­˜æ—¶æ¯”è¾ƒæœ‰æ•ˆã€‚ åœ¨ upstream ä¸­åŠ å…¥ hash è¯­å¥ï¼Œserver è¯­å¥ä¸­ä¸èƒ½å†™å…¥ weight ç­‰å…¶ä»–çš„å‚æ•°ï¼Œhash_method æ˜¯ä½¿ç”¨çš„ hash ç®—æ³• upstream backend &#123; hash $request_uri; hash_method crc32; server localhost:8080; server localhost:8081;&#125; ä»¥ä¸Š 5 ç§è´Ÿè½½å‡è¡¡å„è‡ªé€‚ç”¨ä¸åŒæƒ…å†µä¸‹ä½¿ç”¨ï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©ä½¿ç”¨å“ªç§ç­–ç•¥æ¨¡å¼,ä¸è¿‡ fair å’Œ url_hash éœ€è¦å®‰è£…ç¬¬ä¸‰æ–¹æ¨¡å—æ‰èƒ½ä½¿ç”¨ã€‚ äº”ï¼šåŠ¨é™åˆ†ç¦»åŠ¨é™åˆ†ç¦»æ˜¯è®©åŠ¨æ€ç½‘ç«™é‡Œçš„åŠ¨æ€ç½‘é¡µæ ¹æ®ä¸€å®šè§„åˆ™æŠŠä¸å˜çš„èµ„æºå’Œç»å¸¸å˜çš„èµ„æºåŒºåˆ†å¼€æ¥ï¼ŒåŠ¨é™èµ„æºåšå¥½äº†æ‹†åˆ†ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®é™æ€èµ„æºçš„ç‰¹ç‚¹å°†å…¶åšç¼“å­˜æ“ä½œï¼Œè¿™å°±æ˜¯ç½‘ç«™é™æ€åŒ–å¤„ç†çš„æ ¸å¿ƒæ€è·¯ã€‚ upstream web_servers &#123; server localhost:8081; server localhost:8082;&#125;server &#123; listen 80; server_name localhost; set $doc_root /usr/local/var/www; location ~* \\.(gif|jpg|jpeg|png|bmp|ico|swf|css|js)$ &#123; root $doc_root/img; &#125; location / &#123; proxy_pass http://web_servers; # å¿…é¡»æŒ‡å®šHeader Host proxy_set_header Host $host:$server_port; &#125; error_page 500 502 503 504 /50x.html; location = /50x.html &#123; root $doc_root; &#125; &#125; å…­ï¼šå…¶ä»–1.return æŒ‡ä»¤è¿”å› http çŠ¶æ€ç  å’Œ å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æ˜¯é‡å®šå‘çš„ URL location /permanently/moved/url &#123; return 301 http://www.example.com/moved/here;&#125; 2 rewrite æŒ‡ä»¤é‡å†™ URI è¯·æ±‚ rewriteï¼Œé€šè¿‡ä½¿ç”¨ rewrite æŒ‡ä»¤åœ¨è¯·æ±‚å¤„ç†æœŸé—´å¤šæ¬¡ä¿®æ”¹è¯·æ±‚ URIï¼Œè¯¥æŒ‡ä»¤å…·æœ‰ä¸€ä¸ªå¯é€‰å‚æ•°å’Œä¸¤ä¸ªå¿…éœ€å‚æ•°ã€‚ ç¬¬ä¸€ä¸ª(å¿…éœ€)å‚æ•°æ˜¯è¯·æ±‚ URI å¿…é¡»åŒ¹é…çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚ ç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨äºæ›¿æ¢åŒ¹é… URI çš„ URIã€‚ å¯é€‰çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å¯ä»¥åœæ­¢è¿›ä¸€æ­¥é‡å†™æŒ‡ä»¤çš„å¤„ç†æˆ–å‘é€é‡å®šå‘(ä»£ç  301 æˆ– 302)çš„æ ‡å¿— location /users/ &#123; rewrite ^/users/(.*)$ /show?user=$1 break;&#125; 3 error_page æŒ‡ä»¤ä½¿ç”¨ error_page æŒ‡ä»¤ï¼Œæ‚¨å¯ä»¥é…ç½® NGINX è¿”å›è‡ªå®šä¹‰é¡µé¢ä»¥åŠé”™è¯¯ä»£ç ï¼Œæ›¿æ¢å“åº”ä¸­çš„å…¶ä»–é”™è¯¯ä»£ç ï¼Œæˆ–å°†æµè§ˆå™¨é‡å®šå‘åˆ°å…¶ä»– URIã€‚ åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ï¼Œerror_page æŒ‡ä»¤æŒ‡å®šè¦è¿”å› 404 é¡µé¢é”™è¯¯ä»£ç çš„é¡µé¢(/404.html)ã€‚ error_page 404 /404.html; 4 æ—¥å¿—è®¿é—®æ—¥å¿—ï¼šéœ€è¦å¼€å¯å‹ç¼© gzip on; å¦åˆ™ä¸ç”Ÿæˆæ—¥å¿—æ–‡ä»¶ï¼Œæ‰“å¼€ log_formatã€access_log æ³¨é‡Š log_format main &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27; &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27; &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;access_log /usr/local/etc/nginx/logs/host.access.log main;gzip on; 5 deny æŒ‡ä»¤# ç¦æ­¢è®¿é—®æŸä¸ªç›®å½•location ~* \\.(txt|doc)$&#123; root $doc_root; deny all;&#125; 6 å†…ç½®å˜é‡nginx çš„é…ç½®æ–‡ä»¶ä¸­å¯ä»¥ä½¿ç”¨çš„å†…ç½®å˜é‡ä»¥ç¾å…ƒç¬¦$å¼€å§‹ï¼Œä¹Ÿæœ‰äººå«å…¨å±€å˜é‡ã€‚å…¶ä¸­ï¼Œéƒ¨åˆ†é¢„å®šä¹‰çš„å˜é‡çš„å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚ - $args ï¼š #è¿™ä¸ªå˜é‡ç­‰äºè¯·æ±‚è¡Œä¸­çš„å‚æ•°ï¼ŒåŒ$query_string- $content_length ï¼š è¯·æ±‚å¤´ä¸­çš„Content-lengthå­—æ®µã€‚- $content_type ï¼š è¯·æ±‚å¤´ä¸­çš„Content-Typeå­—æ®µã€‚- $document_root ï¼š å½“å‰è¯·æ±‚åœ¨rootæŒ‡ä»¤ä¸­æŒ‡å®šçš„å€¼ã€‚- $host ï¼š è¯·æ±‚ä¸»æœºå¤´å­—æ®µï¼Œå¦åˆ™ä¸ºæœåŠ¡å™¨åç§°ã€‚- $http_user_agent ï¼š å®¢æˆ·ç«¯agentä¿¡æ¯- $http_cookie ï¼š å®¢æˆ·ç«¯cookieä¿¡æ¯- $limit_rate ï¼š è¿™ä¸ªå˜é‡å¯ä»¥é™åˆ¶è¿æ¥é€Ÿç‡ã€‚- $request_method ï¼š å®¢æˆ·ç«¯è¯·æ±‚çš„åŠ¨ä½œï¼Œé€šå¸¸ä¸ºGETæˆ–POSTã€‚- $remote_addr ï¼š å®¢æˆ·ç«¯çš„IPåœ°å€ã€‚- $remote_port ï¼š å®¢æˆ·ç«¯çš„ç«¯å£ã€‚- $remote_user ï¼š å·²ç»ç»è¿‡Auth Basic ModuleéªŒè¯çš„ç”¨æˆ·åã€‚- $request_filename ï¼š å½“å‰è¯·æ±‚çš„æ–‡ä»¶è·¯å¾„ï¼Œç”±rootæˆ–aliasæŒ‡ä»¤ä¸URIè¯·æ±‚ç”Ÿæˆã€‚- $scheme ï¼š HTTPæ–¹æ³•ï¼ˆå¦‚httpï¼Œhttpsï¼‰ã€‚- $server_protocol ï¼š è¯·æ±‚ä½¿ç”¨çš„åè®®ï¼Œé€šå¸¸æ˜¯HTTP/1.0æˆ–HTTP/1.1ã€‚- $server_addr ï¼š æœåŠ¡å™¨åœ°å€ï¼Œåœ¨å®Œæˆä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨åå¯ä»¥ç¡®å®šè¿™ä¸ªå€¼ã€‚- $server_name ï¼š æœåŠ¡å™¨åç§°ã€‚- $server_port ï¼š è¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨çš„ç«¯å£å·ã€‚- $request_uri ï¼š åŒ…å«è¯·æ±‚å‚æ•°çš„åŸå§‹URIï¼Œä¸åŒ…å«ä¸»æœºåï¼Œå¦‚ï¼šâ€/foo/bar.php?arg=bazâ€ã€‚- $uri ï¼š ä¸å¸¦è¯·æ±‚å‚æ•°çš„å½“å‰URIï¼Œ$uriä¸åŒ…å«ä¸»æœºåï¼Œå¦‚â€/foo/bar.htmlâ€ã€‚- $document_uri ï¼š ä¸$uriç›¸åŒ è½¬è½½nginx åº”ç”¨åœºæ™¯","updated":"2025-08-02T05:46:04.179Z","tags":[{"name":"nginx","slug":"nginx","permalink":"https://luckyship.github.io/tags/nginx/"}]},{"title":"httpè¯·æ±‚å¤´-ä»€ä¹ˆæ˜¯CSP","date":"2022-02-11T13:30:32.000Z","path":"2022/02/11/2022-02-11-CSP/","text":"ä¸€ã€ç®€ä»‹CSP çš„å®è´¨å°±æ˜¯ç™½åå•åˆ¶åº¦ï¼Œå¼€å‘è€…æ˜ç¡®å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå“ªäº›å¤–éƒ¨èµ„æºå¯ä»¥åŠ è½½å’Œæ‰§è¡Œï¼Œç­‰åŒäºæä¾›ç™½åå•ã€‚å®ƒçš„å®ç°å’Œæ‰§è¡Œå…¨éƒ¨ç”±æµè§ˆå™¨å®Œæˆï¼Œå¼€å‘è€…åªéœ€æä¾›é…ç½®ã€‚ CSP å¤§å¤§å¢å¼ºäº†ç½‘é¡µçš„å®‰å…¨æ€§ã€‚æ”»å‡»è€…å³ä½¿å‘ç°äº†æ¼æ´ï¼Œä¹Ÿæ²¡æ³•æ³¨å…¥è„šæœ¬ï¼Œé™¤éè¿˜æ§åˆ¶äº†ä¸€å°åˆ—å…¥äº†ç™½åå•çš„å¯ä¿¡ä¸»æœºã€‚ ä¸¤ç§æ–¹æ³•å¯ä»¥å¯ç”¨ CSPã€‚ä¸€ç§æ˜¯é€šè¿‡ HTTP å¤´ä¿¡æ¯çš„Content-Security-Policyçš„å­—æ®µã€‚ Content-Security-Policy: script-src &#x27;self&#x27;; object-src &#x27;none&#x27;;style-src cdn.example.org third-party.org; child-src https: å¦ä¸€ç§æ˜¯é€šè¿‡ç½‘é¡µçš„&lt;meta&gt;æ ‡ç­¾ã€‚ &lt;meta http-equiv=&quot;Content-Security-Policy&quot; content=&quot;script-src &#x27;self&#x27;; object-src &#x27;none&#x27;; style-src cdn.example.org third-party.org; child-src https:&quot;/&gt; ä¸Šé¢ä»£ç ä¸­ï¼ŒCSP åšäº†å¦‚ä¸‹é…ç½®ã€‚ è„šæœ¬ï¼šåªä¿¡ä»»å½“å‰åŸŸå &lt;object&gt;æ ‡ç­¾ï¼šä¸ä¿¡ä»»ä»»ä½• URLï¼Œå³ä¸åŠ è½½ä»»ä½•èµ„æº æ ·å¼è¡¨ï¼šåªä¿¡ä»»cdn.example.orgå’Œthird-party.org æ¡†æ¶ï¼ˆframeï¼‰ï¼šå¿…é¡»ä½¿ç”¨ HTTPS åè®®åŠ è½½ å…¶ä»–èµ„æºï¼šæ²¡æœ‰é™åˆ¶ å¯ç”¨åï¼Œä¸ç¬¦åˆ CSP çš„å¤–éƒ¨èµ„æºå°±ä¼šè¢«é˜»æ­¢åŠ è½½ã€‚ Chrome çš„æŠ¥é”™ä¿¡æ¯ã€‚ Firefox çš„æŠ¥é”™ä¿¡æ¯ã€‚ äºŒã€é™åˆ¶é€‰é¡¹CSP æä¾›äº†å¾ˆå¤šé™åˆ¶é€‰é¡¹ï¼Œæ¶‰åŠå®‰å…¨çš„å„ä¸ªæ–¹é¢ã€‚ 2.1 èµ„æºåŠ è½½é™åˆ¶ä»¥ä¸‹é€‰é¡¹é™åˆ¶å„ç±»èµ„æºçš„åŠ è½½ã€‚ **script-src**ï¼šå¤–éƒ¨è„šæœ¬ **style-src**ï¼šæ ·å¼è¡¨ **img-src**ï¼šå›¾åƒ **media-src**ï¼šåª’ä½“æ–‡ä»¶ï¼ˆéŸ³é¢‘å’Œè§†é¢‘ï¼‰ **font-src**ï¼šå­—ä½“æ–‡ä»¶ **object-src**ï¼šæ’ä»¶ï¼ˆæ¯”å¦‚ Flashï¼‰ **child-src**ï¼šæ¡†æ¶ **frame-ancestors**ï¼šåµŒå…¥çš„å¤–éƒ¨èµ„æºï¼ˆæ¯”å¦‚&lt;frame&gt;ã€&lt;iframe&gt;ã€&lt;embed&gt;å’Œ&lt;applet&gt;ï¼‰ **connect-src**ï¼šHTTP è¿æ¥ï¼ˆé€šè¿‡ XHRã€WebSocketsã€EventSource ç­‰ï¼‰ **worker-src**ï¼šworkerè„šæœ¬ **manifest-src**ï¼šmanifest æ–‡ä»¶ 2.2 default-srcdefault-srcç”¨æ¥è®¾ç½®ä¸Šé¢å„ä¸ªé€‰é¡¹çš„é»˜è®¤å€¼ã€‚ Content-Security-Policy: default-src &#x27;self&#x27; ä¸Šé¢ä»£ç é™åˆ¶æ‰€æœ‰çš„å¤–éƒ¨èµ„æºï¼Œéƒ½åªèƒ½ä»å½“å‰åŸŸååŠ è½½ã€‚ å¦‚æœåŒæ—¶è®¾ç½®æŸä¸ªå•é¡¹é™åˆ¶ï¼ˆæ¯”å¦‚font-srcï¼‰å’Œdefault-srcï¼Œå‰è€…ä¼šè¦†ç›–åè€…ï¼Œå³å­—ä½“æ–‡ä»¶ä¼šé‡‡ç”¨font-srcçš„å€¼ï¼Œå…¶ä»–èµ„æºä¾ç„¶é‡‡ç”¨default-srcçš„å€¼ã€‚ 2.3 URL é™åˆ¶æœ‰æ—¶ï¼Œç½‘é¡µä¼šè·Ÿå…¶ä»– URL å‘ç”Ÿè”ç³»ï¼Œè¿™æ—¶ä¹Ÿå¯ä»¥åŠ ä»¥é™åˆ¶ã€‚ **frame-ancestors**ï¼šé™åˆ¶åµŒå…¥æ¡†æ¶çš„ç½‘é¡µ **base-uri**ï¼šé™åˆ¶&lt;base#href&gt; **form-action**ï¼šé™åˆ¶&lt;form#action&gt; 2.4 å…¶ä»–é™åˆ¶å…¶ä»–ä¸€äº›å®‰å…¨ç›¸å…³çš„åŠŸèƒ½ï¼Œä¹Ÿæ”¾åœ¨äº† CSP é‡Œé¢ã€‚ **block-all-mixed-content**ï¼šHTTPS ç½‘é¡µä¸å¾—åŠ è½½ HTTP èµ„æºï¼ˆæµè§ˆå™¨å·²ç»é»˜è®¤å¼€å¯ï¼‰ **upgrade-insecure-requests**ï¼šè‡ªåŠ¨å°†ç½‘é¡µä¸Šæ‰€æœ‰åŠ è½½å¤–éƒ¨èµ„æºçš„ HTTP é“¾æ¥æ¢æˆ HTTPS åè®® **plugin-types**ï¼šé™åˆ¶å¯ä»¥ä½¿ç”¨çš„æ’ä»¶æ ¼å¼ **sandbox**ï¼šæµè§ˆå™¨è¡Œä¸ºçš„é™åˆ¶ï¼Œæ¯”å¦‚ä¸èƒ½æœ‰å¼¹å‡ºçª—å£ç­‰ã€‚ 2.5 report-uriæœ‰æ—¶ï¼Œæˆ‘ä»¬ä¸ä»…å¸Œæœ›é˜²æ­¢ XSSï¼Œè¿˜å¸Œæœ›è®°å½•æ­¤ç±»è¡Œä¸ºã€‚report-uriå°±ç”¨æ¥å‘Šè¯‰æµè§ˆå™¨ï¼Œåº”è¯¥æŠŠæ³¨å…¥è¡Œä¸ºæŠ¥å‘Šç»™å“ªä¸ªç½‘å€ã€‚ Content-Security-Policy: default-src &#x27;self&#x27;; ...; report-uri /my_amazing_csp_report_parser; ä¸Šé¢ä»£ç æŒ‡å®šï¼Œå°†æ³¨å…¥è¡Œä¸ºæŠ¥å‘Šç»™/my_amazing_csp_report_parserè¿™ä¸ª URLã€‚ æµè§ˆå™¨ä¼šä½¿ç”¨POSTæ–¹æ³•ï¼Œå‘é€ä¸€ä¸ª JSON å¯¹è±¡ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚ &#123; &quot;csp-report&quot;: &#123; &quot;document-uri&quot;: &quot;http://example.org/page.html&quot;, &quot;referrer&quot;: &quot;http://evil.example.com/&quot;, &quot;blocked-uri&quot;: &quot;http://evil.example.com/evil.js&quot;, &quot;violated-directive&quot;: &quot;script-src &#x27;self&#x27; https://apis.google.com&quot;, &quot;original-policy&quot;: &quot;script-src &#x27;self&#x27; https://apis.google.com; report-uri http://example.org/my_amazing_csp_report_parser&quot; &#125;&#125; ä¸‰ã€Content-Security-Policy-Report-Onlyé™¤äº†Content-Security-Policyï¼Œè¿˜æœ‰ä¸€ä¸ªContent-Security-Policy-Report-Onlyå­—æ®µï¼Œè¡¨ç¤ºä¸æ‰§è¡Œé™åˆ¶é€‰é¡¹ï¼Œåªæ˜¯è®°å½•è¿åé™åˆ¶çš„è¡Œä¸ºã€‚ å®ƒå¿…é¡»ä¸report-urié€‰é¡¹é…åˆä½¿ç”¨ã€‚ Content-Security-Policy-Report-Only: default-src &#x27;self&#x27;; ...; report-uri /my_amazing_csp_report_parser; å››ã€é€‰é¡¹å€¼æ¯ä¸ªé™åˆ¶é€‰é¡¹å¯ä»¥è®¾ç½®ä»¥ä¸‹å‡ ç§å€¼ï¼Œè¿™äº›å€¼å°±æ„æˆäº†ç™½åå•ã€‚ ä¸»æœºåï¼šexample.orgï¼Œhttps://example.com:443 è·¯å¾„åï¼šexample.org/resources/js/ é€šé…ç¬¦ï¼š*.example.orgï¼Œ*://*.example.com:*ï¼ˆè¡¨ç¤ºä»»æ„åè®®ã€ä»»æ„å­åŸŸåã€ä»»æ„ç«¯å£ï¼‰ åè®®åï¼šhttps:ã€data: å…³é”®å­—&#39;self&#39;ï¼šå½“å‰åŸŸåï¼Œéœ€è¦åŠ å¼•å· å…³é”®å­—&#39;none&#39;ï¼šç¦æ­¢åŠ è½½ä»»ä½•å¤–éƒ¨èµ„æºï¼Œéœ€è¦åŠ å¼•å· å¤šä¸ªå€¼ä¹Ÿå¯ä»¥å¹¶åˆ—ï¼Œç”¨ç©ºæ ¼åˆ†éš”ã€‚ Content-Security-Policy: script-src &#x27;self&#x27; https://apis.google.com å¦‚æœåŒä¸€ä¸ªé™åˆ¶é€‰é¡¹ä½¿ç”¨å¤šæ¬¡ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡ä¼šç”Ÿæ•ˆã€‚ # é”™è¯¯çš„å†™æ³•script-src https://host1.com; script-src https://host2.com# æ­£ç¡®çš„å†™æ³•script-src https://host1.com https://host2.com å¦‚æœä¸è®¾ç½®æŸä¸ªé™åˆ¶é€‰é¡¹ï¼Œå°±æ˜¯é»˜è®¤å…è®¸ä»»ä½•å€¼ã€‚ äº”ã€script-src çš„ç‰¹æ®Šå€¼é™¤äº†å¸¸è§„å€¼ï¼Œscript-srcè¿˜å¯ä»¥è®¾ç½®ä¸€äº›ç‰¹æ®Šå€¼ã€‚æ³¨æ„ï¼Œä¸‹é¢è¿™äº›å€¼éƒ½å¿…é¡»æ”¾åœ¨å•å¼•å·é‡Œé¢ã€‚ **&#39;unsafe-inline&#39;**ï¼šå…è®¸æ‰§è¡Œé¡µé¢å†…åµŒçš„&amp;lt;script&gt;æ ‡ç­¾å’Œäº‹ä»¶ç›‘å¬å‡½æ•° **unsafe-eval**ï¼šå…è®¸å°†å­—ç¬¦ä¸²å½“ä½œä»£ç æ‰§è¡Œï¼Œæ¯”å¦‚ä½¿ç”¨evalã€setTimeoutã€setIntervalå’ŒFunctionç­‰å‡½æ•°ã€‚ nonce å€¼ï¼šæ¯æ¬¡ HTTP å›åº”ç»™å‡ºä¸€ä¸ªæˆæƒ tokenï¼Œé¡µé¢å†…åµŒè„šæœ¬å¿…é¡»æœ‰è¿™ä¸ª tokenï¼Œæ‰ä¼šæ‰§è¡Œ hash å€¼ï¼šåˆ—å‡ºå…è®¸æ‰§è¡Œçš„è„šæœ¬ä»£ç çš„ Hash å€¼ï¼Œé¡µé¢å†…åµŒè„šæœ¬çš„å“ˆå¸Œå€¼åªæœ‰å»åˆçš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½æ‰§è¡Œã€‚ nonce å€¼çš„ä¾‹å­å¦‚ä¸‹ï¼ŒæœåŠ¡å™¨å‘é€ç½‘é¡µçš„æ—¶å€™ï¼Œå‘Šè¯‰æµè§ˆå™¨ä¸€ä¸ªéšæœºç”Ÿæˆçš„ tokenã€‚ Content-Security-Policy: script-src &#x27;nonce-EDNnf03nceIOfn39fn3e9h3sdfa&#x27; é¡µé¢å†…åµŒè„šæœ¬ï¼Œå¿…é¡»æœ‰è¿™ä¸ª token æ‰èƒ½æ‰§è¡Œã€‚ &lt;script nonce=&quot;EDNnf03nceIOfn39fn3e9h3sdfa&quot;&gt; // some code&lt;/script&gt; hash å€¼çš„ä¾‹å­å¦‚ä¸‹ï¼ŒæœåŠ¡å™¨ç»™å‡ºä¸€ä¸ªå…è®¸æ‰§è¡Œçš„ä»£ç çš„ hash å€¼ã€‚ Content-Security-Policy: script-src &#x27;sha256-qznLcsROx4GACP2dm0UCKCzCG-HiZ1guq6ZZDob_Tng=&#x27; ä¸‹é¢çš„ä»£ç å°±ä¼šå…è®¸æ‰§è¡Œï¼Œå› ä¸º hash å€¼ç›¸ç¬¦ã€‚ &lt;script&gt; alert(&#x27;Hello, world.&#x27;);&lt;/script&gt; æ³¨æ„ï¼Œè®¡ç®— hash å€¼çš„æ—¶å€™ï¼Œ&lt;script&gt;æ ‡ç­¾ä¸ç®—åœ¨å†…ã€‚ é™¤äº†script-srcé€‰é¡¹ï¼Œnonce å€¼å’Œ hash å€¼è¿˜å¯ä»¥ç”¨åœ¨style-srcé€‰é¡¹ï¼Œæ§åˆ¶é¡µé¢å†…åµŒçš„æ ·å¼è¡¨ã€‚ å…­ã€æ³¨æ„ç‚¹ï¼ˆ1ï¼‰script-srcå’Œobject-srcæ˜¯å¿…è®¾çš„ï¼Œé™¤éè®¾ç½®äº†default-srcã€‚ å› ä¸ºæ”»å‡»è€…åªè¦èƒ½æ³¨å…¥è„šæœ¬ï¼Œå…¶ä»–é™åˆ¶éƒ½å¯ä»¥è§„é¿ã€‚è€Œobject-srcå¿…è®¾æ˜¯å› ä¸º Flash é‡Œé¢å¯ä»¥æ‰§è¡Œå¤–éƒ¨è„šæœ¬ã€‚ ï¼ˆ2ï¼‰script-srcä¸èƒ½ä½¿ç”¨unsafe-inlineå…³é”®å­—ï¼ˆé™¤éä¼´éšä¸€ä¸ª nonce å€¼ï¼‰ï¼Œä¹Ÿä¸èƒ½å…è®¸è®¾ç½®data:URLã€‚ ä¸‹é¢æ˜¯ä¸¤ä¸ªæ¶æ„æ”»å‡»çš„ä¾‹å­ã€‚ &lt;img src=&quot;x&quot; onerror=&quot;evil()&quot; /&gt;&lt;script src=&quot;data:text/javascript,evil()&quot;&gt;&lt;/script&gt; ï¼ˆ3ï¼‰å¿…é¡»ç‰¹åˆ«æ³¨æ„ JSONP çš„å›è°ƒå‡½æ•°ã€‚ &lt;script src=&quot;/path/jsonp?callback=alert(document.domain)&quot;&gt;&lt;/script&gt; ä¸Šé¢çš„ä»£ç ä¸­ï¼Œè™½ç„¶åŠ è½½çš„è„šæœ¬æ¥è‡ªå½“å‰åŸŸåï¼Œä½†æ˜¯é€šè¿‡æ”¹å†™å›è°ƒå‡½æ•°ï¼Œæ”»å‡»è€…ä¾ç„¶å¯ä»¥æ‰§è¡Œæ¶æ„ä»£ç ã€‚ å‚è€ƒContent Security Policy å…¥é—¨","updated":"2025-08-02T05:46:04.179Z","tags":[{"name":"html","slug":"html","permalink":"https://luckyship.github.io/tags/html/"}]},{"title":"å‰ç«¯æ¨¡æ‹Ÿæ¥å£è¿”å›æ•°æ®","date":"2021-11-30T09:01:46.000Z","path":"2021/11/30/2021-11-30-mock/","text":"Mock.js æ˜¯ä¸€ä¸ªç”¨äºæ¨¡æ‹Ÿæ•°æ®çš„ JavaScript åº“ï¼Œå¸¸å¸¸è¢«ç”¨äºå‰ç«¯å¼€å‘å’Œå•å…ƒæµ‹è¯•ã€‚ åœ¨è¿›è¡Œ Angular é¡¹ç›®å¼€å‘æ—¶ï¼Œç»å¸¸éœ€è¦ä¸åç«¯ API è¿›è¡Œäº¤äº’ï¼Œä½†æ˜¯ç”±äºåç«¯å¼€å‘è¿›åº¦å¯èƒ½ä¸åŒæ­¥ï¼Œæˆ–è€…æ¥å£è¿˜æœªå®Œæˆï¼Œéœ€è¦æ¨¡æ‹Ÿæ•°æ®æ¥è¿›è¡Œå‰ç«¯å¼€å‘æˆ–è€…æµ‹è¯•ã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Mock.js æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ ä¸ºä»€ä¹ˆä½¿ç”¨ Mock.js è§£è€¦ï¼šåœ¨å‰ç«¯å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦ä¾èµ–åç«¯æ¥å£è¿›è¡Œå¼€å‘ï¼Œä½†æ˜¯åç«¯æ¥å£å¯èƒ½è¿˜æ²¡æœ‰å¼€å‘å®Œæˆï¼Œæˆ–è€…æœ‰ä¸€äº›çŠ¶æ€ç ï¼ˆå¦‚ 404ã€500ï¼‰æ— æ³•é€šè¿‡æ­£å¸¸è®¿é—®ã€‚å¦‚æœä¸ä½¿ç”¨ Mock.js æ¨¡æ‹Ÿæ•°æ®ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°å¾ˆå¤šé—®é¢˜ï¼Œå¼€å‘å·¥ä½œé‡ä¹Ÿä¼šå¢åŠ ã€‚ä½¿ç”¨ Mock.js å¯ä»¥è§£è€¦å‰åç«¯ï¼Œå³ä½¿åç«¯æ¥å£è¿˜æ²¡æœ‰å¼€å‘å®Œæˆï¼Œä¹Ÿå¯ä»¥ç»§ç»­è¿›è¡Œå‰ç«¯å¼€å‘ã€‚ çœæ—¶é—´ï¼šä½¿ç”¨ Mock.js å¯ä»¥å¿«é€Ÿç”Ÿæˆæ•°æ®ï¼Œæé«˜å‰ç«¯å¼€å‘æ•ˆç‡ã€‚ æµ‹è¯•ï¼šä½¿ç”¨ Mock.js å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œå•å…ƒæµ‹è¯•å’ŒåŠŸèƒ½æµ‹è¯•ã€‚ å¦‚ä½•ä½¿ç”¨ Mock.js æ¨¡æ‹Ÿ API è¯·æ±‚å®‰è£… Mock.js$ npm install mockjs# ä¸å®‰è£…tsä¸­ä¼šæŠ¥é”™$ npm install @types/mockjs åˆ›å»º mock æ•°æ®æ–‡ä»¶åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºmockæ–‡ä»¶å¤¹ï¼Œåœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºdata.jsæ–‡ä»¶ï¼š import Mock from &quot;mockjs&quot;;// GETè¯·æ±‚Mock.mock(&quot;/api/getData&quot;, &quot;get&quot;, () =&gt; &#123; return Mock.mock(&#123; &quot;data|10&quot;: [ &#123; name: &quot;@cname&quot;, &quot;age|20-30&quot;: 1, &quot;id|+1&quot;: 1, &#125;, ], &#125;);&#125;);// POSTè¯·æ±‚Mock.mock(&quot;/api/postData&quot;, &quot;post&quot;, (options) =&gt; &#123; const &#123; body &#125; = options; return Mock.mock(&#123; data: `hello, $&#123;JSON.parse(body).name&#125;!`, &#125;);&#125;); åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«å¯¹/api/getDataå’Œ/api/postDataè¿›è¡Œäº† GET å’Œ POST è¯·æ±‚çš„æ¨¡æ‹Ÿã€‚å…¶ä¸­ï¼ŒMock.mockæ–¹æ³•å¯ä»¥ç”¨æ¥ç”Ÿæˆç¬¦åˆæŒ‡å®šæ ¼å¼çš„éšæœºæ•°æ®ã€‚ åœ¨ Angular ä¸­ä½¿ç”¨ Mock.jsæˆ‘ä»¬å¯ä»¥åœ¨app.module.tsæ–‡ä»¶ä¸­åˆ›å»ºä¸€ä¸ªHttpInterceptoræ¥æ‹¦æˆª API è¯·æ±‚ï¼Œå¹¶é€šè¿‡ Mock.js è¿”å›æ¨¡æ‹Ÿæ•°æ®ã€‚ import &#123; Injectable &#125; from &quot;@angular/core&quot;;import &#123; HttpEvent, HttpHandler, HttpInterceptor, HttpRequest &#125; from &quot;@angular/common/http&quot;;import &#123; Observable &#125; from &quot;rxjs&quot;;import &#123; environment &#125; from &quot;../environments/environment&quot;;import &#123; MockService &#125; from &quot;./mock.service&quot;;@Injectable()export class MockInterceptor implements HttpInterceptor &#123; constructor(private mockService: MockService) &#123;&#125; intercept(req: HttpRequest&lt;any&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;any&gt;&gt; &#123; if (environment.useMock) &#123; // åˆ¤æ–­æ˜¯å¦å¼€å¯Mock.js const mockData = this.mockService.getMockData(req); if (mockData) &#123; const response = new ResponseOptions(&#123; body: mockData &#125;); return Observable.of(new HttpResponse(response)); &#125; &#125; return next.handle(req); &#125;&#125; åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡MockServiceæ¥è·å– Mock.js è¿”å›çš„æ•°æ®ï¼Œå¹¶å°†å…¶è¿”å›ç»™å‰ç«¯ã€‚ æ¥ä¸‹æ¥ï¼Œåœ¨app.module.tsæ–‡ä»¶ä¸­å¼•å…¥è¯¥HttpInterceptorï¼š import &#123; NgModule &#125; from &quot;@angular/core&quot;;import &#123; BrowserModule &#125; from &quot;@angular/platform-browser&quot;;import &#123; HttpClientModule, HTTP_INTERCEPTORS &#125; from &quot;@angular/common/http&quot;;import &#123; AppComponent &#125; from &quot;./app.component&quot;;import &#123; MockService &#125; from &quot;./mock.service&quot;;import &#123; MockInterceptor &#125; from &quot;./mock.interceptor&quot;;@NgModule(&#123; declarations: [AppComponent], imports: [BrowserModule, HttpClientModule], providers: [ MockService, &#123; provide: HTTP_INTERCEPTORS, useClass: MockInterceptor, multi: true, &#125;, ], bootstrap: [AppComponent],&#125;)export class AppModule &#123;&#125; åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬å°†MockServiceå’ŒMockInterceptorä½œä¸ºæä¾›è€…ï¼Œå¹¶å°†MockInterceptoræ³¨å†Œä¸ºå…¨å±€çš„æ‹¦æˆªå™¨ã€‚ ç¤ºä¾‹æˆ‘ä»¬å¯ä»¥åœ¨app.component.tsæ–‡ä»¶ä¸­è¿›è¡Œ API è¯·æ±‚çš„æµ‹è¯•ï¼š import &#123; Component, OnInit &#125; from &quot;@angular/core&quot;;import &#123; HttpClient &#125; from &quot;@angular/common/http&quot;;@Component(&#123; selector: &quot;app-root&quot;, templateUrl: &quot;./app.component.html&quot;, styleUrls: [&quot;./app.component.css&quot;],&#125;)export class AppComponent implements OnInit &#123; title = &quot;Mock.js Demo&quot;; data: any; name: string; constructor(private http: HttpClient) &#123;&#125; ngOnInit(): void &#123; this.http.get(&quot;/api/getData&quot;).subscribe((res) =&gt; &#123; this.data = res[&quot;data&quot;]; &#125;); &#125; postData() &#123; this.http.post(&quot;/api/postData&quot;, &#123; name: this.name &#125;).subscribe((res) =&gt; &#123; alert(res[&quot;data&quot;]); &#125;); &#125;&#125; åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡HttpClientè¿›è¡Œ API è¯·æ±‚ï¼Œåˆ†åˆ«è¯·æ±‚äº†/api/getDataå’Œ/api/postDataã€‚å…¶ä¸­ï¼ŒGET è¯·æ±‚ä¼šåœ¨é¡µé¢åˆå§‹åŒ–æ—¶è‡ªåŠ¨å‘é€ï¼Œè€Œ POST è¯·æ±‚åˆ™éœ€è¦æ‰‹åŠ¨è°ƒç”¨ã€‚ æ€»ç»“é€šè¿‡å¼•å…¥ Mock.jsï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°æ¨¡æ‹Ÿåç«¯ API æ¥å£çš„è¯·æ±‚ä¸å“åº”ï¼Œä»è€Œæé«˜å‰ç«¯å¼€å‘æ•ˆç‡ã€‚åœ¨ä½¿ç”¨ Angular å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºHttpInterceptoræ‹¦æˆª API è¯·æ±‚ï¼Œå¹¶ä½¿ç”¨ Mock.js è¿”å›æ¨¡æ‹Ÿæ•°æ®çš„æ–¹å¼æ¥å®ç°è¯¥åŠŸèƒ½ã€‚","updated":"2025-08-02T05:46:04.179Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"ng-templateã€ng-containerã€ng-content çš„ç”¨æ³•","date":"2021-11-30T08:51:34.000Z","path":"2021/11/30/2021-11-30-angular-container-template-content/","text":"ng-containerng-containerï¼šæ­¤æ ‡ç­¾ä¸æ¸²æŸ“æˆ DOMï¼›é»˜è®¤æ˜¾ç¤ºæ ‡ç­¾å†…éƒ¨å†…å®¹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç»“æ„å‹æŒ‡ä»¤ï¼ˆngIfã€ngForâ€¦ï¼‰ å®˜ç½‘è¯¦ç»†ä»‹ç»ï¼šhttps://angular.cn/guide/structural-directives egï¼šä»£ç å— &lt;ng-container&gt; &lt;p&gt;Hello World !!!&lt;/p&gt;&lt;/ng-container&gt; ç½‘é¡µæ¸²æŸ“ç»“æœ &lt;p _ngcontent-vkg-c0=&quot;&quot;&gt;Hello World !!!&lt;/p&gt; ng-contentng-contentï¼šçˆ¶ç»„ä»¶è°ƒç”¨å­ç»„ä»¶æ—¶ï¼Œå°†çˆ¶ç»„ä»¶å†…å®¹æŠ•å°„åˆ°å­ç»„ä»¶æŒ‡å®šä½ç½®ï¼ˆå­ç»„ä»¶ä¸­ ng-content æ‰€åœ¨ä½ç½®ï¼‰ï¼›ç±»ä¼¼ VUE ä¸­çš„æ’æ§½ã€‚åˆ†ä¸ºé»˜è®¤æŠ•å°„ï¼Œå…·åæŠ•å°„ã€‚ 1ï¼‰é»˜è®¤æŠ•å°„ - å­ç»„ä»¶ä¸­åªæœ‰ä¸€ä¸ª ng-content æ—¶ï¼šeg çˆ¶ç»„ä»¶ä¸­å¼•å…¥å­ç»„ä»¶ &lt;app-child-com&gt; &lt;p&gt;- parent component content !!! -&lt;/p&gt;&lt;/app-child-com&gt; å­ç»„ä»¶ &lt;p&gt;child component content - begin&lt;/p&gt;&lt;ng-content&gt;&lt;/ng-content&gt;&lt;p&gt;child component content - end&lt;/p&gt; æ˜¾ç¤ºæ•ˆæœ child component content - begin- parent component content !!!- child component content - end 2ï¼‰å…·åæŠ•å°„ - å­ç»„ä»¶æœ‰å¤šä¸ª ng-contentï¼Œéœ€è¦æŒ‡å®šåå­—è¿›è¡ŒæŒ‡å®šä½ç½®æŠ•å°„ï¼šeg çˆ¶ç»„ä»¶å†…å®¹ &lt;app-child-com&gt; &lt;header&gt;header - parent component content !!! -&lt;/header&gt; &lt;div id=&quot;demo&quot;&gt;id selector - parent component content !!! -&lt;/div&gt; &lt;div name=&quot;demo&quot;&gt;name - parent component content !!! -&lt;/div&gt;&lt;/app-child-com&gt; å­ç»„ä»¶å†…å®¹ &lt;p&gt;child component content&lt;/p&gt;&lt;ng-content select=&quot;header&quot;&gt;&lt;/ng-content&gt;&lt;p&gt;child component content&lt;/p&gt;&lt;ng-content select=&quot;#demo&quot;&gt;&lt;/ng-content&gt;&lt;p&gt;child component content&lt;/p&gt;&lt;ng-content select=&quot;[name=demo]&quot;&gt;&lt;/ng-content&gt; ä½¿ç”¨ select å±æ€§ï¼Œæ”¯æŒ CSS é€‰æ‹©å™¨ ng-templateng-templateï¼šæ¨¡æ¿å…ƒç´ ï¼Œé»˜è®¤æƒ…å†µå†…éƒ¨å…ƒç´ ä¸å¯è§ã€‚ä½¿ç”¨æ–¹æ³•ï¼š æ–¹æ³•ä¸€ï¼šä½¿ç”¨ ngIf å±æ€§ï¼Œå€¼ä¸º true æ˜¾ç¤ºå†…å®¹&lt;ng-template [ngIf]=&quot;condition&quot;&gt; &lt;p&gt;Hello World !!!&lt;/p&gt;&lt;/ng-template&gt; æ‰©å±•ï¼šä»¥ä¸‹ä»£ç ä¼šè½¬æ¢ä¸ºä»¥ä¸Šä»£ç æ˜¾ç¤º &lt;p *ngIf=&quot;condition&quot;&gt;Hello World !!!&lt;/p&gt; æ–¹æ³•äºŒï¼š ä½¿ç”¨ ViewContainerRefï¼ŒTemplateRefï¼ŒViewChildï¼šegç»„ä»¶ HTML &lt;!-- myTplï¼šæ¨¡æ¿å¼•ç”¨å˜é‡ï¼›name1ï¼šæ¨¡æ¿è¾“å…¥å˜é‡ï¼›nameï¼šè¾“å…¥å˜é‡å€¼ï¼›fooï¼šé»˜è®¤è¾“å…¥å˜é‡ --&gt;&lt;ng-template #myTpl let-name1=&quot;name&quot; let-foo&gt; &lt;p&gt;è°ƒç”¨çš„æ¨¡æ¿æ•°æ®ï¼š&#123;&#123; name1 &#125;&#125; -- &#123;&#123; foo &#125;&#125;&lt;/p&gt;&lt;/ng-template&gt; ç»„ä»¶ TSï¼Œä»¥ä¸Šä»£ç é»˜è®¤ä¸èµ·ä»»ä½•ä½œç”¨ï¼Œä¸ä¼šæ¸²æŸ“ DOM // Angular8 å¿…å¡« &#123;static: boolean&#125; å±æ€§trueï¼šå˜æ›´æ£€æµ‹ä¹‹å‰è§£ææŸ¥è¯¢ç»“æœï¼›åä¹‹ // è·å–æŒ‡å®šæ¨¡æ¿ï¼ˆmyTplï¼‰å¼•ç”¨ tpl@ViewChild(&#x27;myTpl&#x27;, &#123;static: true&#125;) tpl: TemplateRef&lt;any&gt;;constructor( private viewContainer: ViewContainerRef) &#123; &#125;// $implicitï¼šé»˜è®¤è¾“å…¥å˜é‡å–å€¼ngOnInit() &#123; this.viewContainer.createEmbeddedView(this.tpl, &#123; $implicit: &quot;Hello&quot;, name: &#x27;World&#x27; &#125;);&#125; æ•ˆæœï¼Œæ˜¾ç¤ºæ¨¡æ¿å†…å®¹ æ–¹æ³•ä¸‰ï¼šä½¿ç”¨ ngTemplateOutlet ç»“æ„å‹æŒ‡ä»¤ï¼šegç»„ä»¶ HTML &lt;!-- myTplï¼šæ¨¡æ¿å¼•ç”¨å˜é‡ï¼›contextï¼šè¾“å…¥å¯¹è±¡æ•°æ® --&gt;&lt;div&gt;&lt;ng-container *ngTemplateOutlet=&quot;myTpl; context: context&quot;&gt;&lt;/ng-container&gt;&lt;/div&gt;&lt;!-- myTplï¼šæ¨¡æ¿å¼•ç”¨å˜é‡ï¼›name1ï¼šæ¨¡æ¿è¾“å…¥å˜é‡ï¼›nameï¼šè¾“å…¥å˜é‡å€¼ï¼›fooï¼šé»˜è®¤è¾“å…¥å˜é‡ --&gt;&lt;ng-template #myTpl let-name1=&quot;name&quot; let-foo&gt; &lt;p&gt;è°ƒç”¨çš„æ¨¡æ¿æ•°æ®ï¼š&#123;&#123; name1 &#125;&#125; -- &#123;&#123; foo &#125;&#125;&lt;/p&gt;&lt;/ng-template&gt; ç»„ä»¶ TS context = &#123; $implicit: &quot;World&quot;, name: &quot;liyq&quot; &#125;; å¯ä»¥å°†æŒ‡å®šæ¨¡æ¿æ’å…¥åˆ°æŒ‡å®šä½ç½®ï¼ŒTS ä¸­åªéœ€è¦å®šä¹‰æ•°æ® æ–¹æ³•å››ï¼šä½¿ç”¨è‡ªå®šä¹‰ç»“æ„å‹æŒ‡ä»¤ï¼Œå’Œ ngIf ç±»ä¼¼ï¼šeg1ï¼‰ng g d unless åˆ›å»ºä¸€ä¸ªåä¸º unless çš„ç»“æ„å‹æŒ‡ä»¤ unless.directive.ts import &#123; Directive, TemplateRef, ViewContainerRef, Input &#125; from &#x27;@angular/core&#x27;;@Directive(&#123; selector: &#x27;[appUnless]&#x27;&#125;)export class UnlessDirective &#123; constructor( private templateRef: TemplateRef&lt;any&gt;, private viewContainer: ViewContainerRef ) &#123; &#125; // å¿…é¡»ä½¿ç”¨ set æ–¹æ³• @Input() set appUnless(condition: boolean) &#123; if(!condition) &#123; // ä¸‹é¢æ˜¯æ¸²æŸ“æ¨¡æ¿æ•°æ®çš„æ ¸å¿ƒ this.viewContainer.createEmbeddedView(this.templateRef); &#125; &#125;&#125; ç»„ä»¶ HTML &lt;!-- æ¨¡æ¿æ¸²æŸ“ç»“æœå’Œ condition çš„ Boolean å€¼æ²¡æœ‰å…³ç³»ï¼Œä¸»è¦çš„ä½œç”¨ä¸ºä½œä¸ºå‚æ•°ä¼ é€’ç»™è‡ªå®šä¹‰çš„ç»“æ„æŒ‡ä»¤ --&gt;&lt;ng-template [appUnless]=&quot;condition&quot;&gt; &lt;p&gt;ä½¿ç”¨ç»“æ„å‹æŒ‡ä»¤è°ƒç”¨æ¨¡æ¿&lt;/p&gt;&lt;/ng-template&gt;","updated":"2025-08-02T05:46:04.179Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"angular","slug":"angular","permalink":"https://luckyship.github.io/tags/angular/"}]},{"title":"webpacké…ç½®","date":"2021-10-26T07:15:01.000Z","path":"2021/10/26/2021-10-26-webpack-interview/","text":"éšç€ç°ä»£å‰ç«¯å¼€å‘çš„å¤æ‚åº¦å’Œè§„æ¨¡è¶Šæ¥è¶Šåºå¤§ï¼Œå·²ç»ä¸èƒ½æŠ›å¼€å·¥ç¨‹åŒ–æ¥ç‹¬ç«‹å¼€å‘äº†ï¼Œå¦‚ react çš„ jsx ä»£ç å¿…é¡»ç¼–è¯‘åæ‰èƒ½åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼›åˆå¦‚ sass å’Œ less çš„ä»£ç æµè§ˆå™¨ä¹Ÿæ˜¯ä¸æ”¯æŒçš„ã€‚ è€Œå¦‚æœæ‘’å¼ƒäº†è¿™äº›å¼€å‘æ¡†æ¶ï¼Œé‚£ä¹ˆå¼€å‘çš„æ•ˆç‡å°†å¤§å¹…ä¸‹é™ã€‚åœ¨ä¼—å¤šå‰ç«¯å·¥ç¨‹åŒ–å·¥å…·ä¸­ï¼Œwebpack è„±é¢–è€Œå‡ºæˆä¸ºäº†å½“ä»Šæœ€æµè¡Œçš„å‰ç«¯æ„å»ºå·¥å…·ã€‚ ç„¶è€Œå¤§å¤šæ•°çš„ä½¿ç”¨è€…éƒ½åªæ˜¯å•çº¯çš„ä¼šä½¿ç”¨ï¼Œè€Œå¹¶ä¸çŸ¥é“å…¶æ·±å±‚çš„åŸç†ã€‚å¸Œæœ›é€šè¿‡ä»¥ä¸‹çš„é¢è¯•é¢˜æ€»ç»“å¯ä»¥å¸®åŠ©å¤§å®¶æ¸©æ•…çŸ¥æ–°ã€æŸ¥ç¼ºè¡¥æ¼ï¼ŒçŸ¥å…¶ç„¶è€ŒåˆçŸ¥å…¶æ‰€ä»¥ç„¶ã€‚ é—®é¢˜ä¸€è§ˆ webpack ä¸ gruntã€gulp çš„ä¸åŒï¼Ÿ ä¸ webpack ç±»ä¼¼çš„å·¥å…·è¿˜æœ‰å“ªäº›ï¼Ÿè°ˆè°ˆä½ ä¸ºä»€ä¹ˆæœ€ç»ˆé€‰æ‹©ï¼ˆæˆ–æ”¾å¼ƒï¼‰ä½¿ç”¨ webpackï¼Ÿ æœ‰å“ªäº›å¸¸è§çš„ Loaderï¼Ÿä»–ä»¬æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ æœ‰å“ªäº›å¸¸è§çš„ Pluginï¼Ÿä»–ä»¬æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ Loader å’Œ Plugin çš„ä¸åŒï¼Ÿ webpack çš„æ„å»ºæµç¨‹æ˜¯ä»€ä¹ˆ?ä»è¯»å–é…ç½®åˆ°è¾“å‡ºæ–‡ä»¶è¿™ä¸ªè¿‡ç¨‹å°½é‡è¯´å…¨ æ˜¯å¦å†™è¿‡ Loader å’Œ Pluginï¼Ÿæè¿°ä¸€ä¸‹ç¼–å†™ loader æˆ– plugin çš„æ€è·¯ï¼Ÿ webpack çš„çƒ­æ›´æ–°æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Ÿè¯´æ˜å…¶åŸç†ï¼Ÿ å¦‚ä½•åˆ©ç”¨ webpack æ¥ä¼˜åŒ–å‰ç«¯æ€§èƒ½ï¼Ÿï¼ˆæé«˜æ€§èƒ½å’Œä½“éªŒï¼‰ å¦‚ä½•æé«˜ webpack çš„æ„å»ºé€Ÿåº¦ï¼Ÿ æ€ä¹ˆé…ç½®å•é¡µåº”ç”¨ï¼Ÿæ€ä¹ˆé…ç½®å¤šé¡µåº”ç”¨ï¼Ÿ npm æ‰“åŒ…æ—¶éœ€è¦æ³¨æ„å“ªäº›ï¼Ÿå¦‚ä½•åˆ©ç”¨ webpack æ¥æ›´å¥½çš„æ„å»ºï¼Ÿ å¦‚ä½•åœ¨ vue é¡¹ç›®ä¸­å®ç°æŒ‰éœ€åŠ è½½ï¼Ÿ é—®é¢˜è§£ç­”1. webpack ä¸ gruntã€gulp çš„ä¸åŒï¼Ÿä¸‰è€…éƒ½æ˜¯å‰ç«¯æ„å»ºå·¥å…·ï¼Œgrunt å’Œ gulp åœ¨æ—©æœŸæ¯”è¾ƒæµè¡Œï¼Œç°åœ¨ webpack ç›¸å¯¹æ¥è¯´æ¯”è¾ƒä¸»æµï¼Œä¸è¿‡ä¸€äº›è½»é‡åŒ–çš„ä»»åŠ¡è¿˜æ˜¯ä¼šç”¨ gulp æ¥å¤„ç†ï¼Œæ¯”å¦‚å•ç‹¬æ‰“åŒ… CSS æ–‡ä»¶ç­‰ã€‚ grunt å’Œ gulp æ˜¯åŸºäºä»»åŠ¡å’Œæµï¼ˆTaskã€Streamï¼‰çš„ã€‚ç±»ä¼¼ jQueryï¼Œæ‰¾åˆ°ä¸€ä¸ªï¼ˆæˆ–ä¸€ç±»ï¼‰æ–‡ä»¶ï¼Œå¯¹å…¶åšä¸€ç³»åˆ—é“¾å¼æ“ä½œï¼Œæ›´æ–°æµä¸Šçš„æ•°æ®ï¼Œ æ•´æ¡é“¾å¼æ“ä½œæ„æˆäº†ä¸€ä¸ªä»»åŠ¡ï¼Œå¤šä¸ªä»»åŠ¡å°±æ„æˆäº†æ•´ä¸ª web çš„æ„å»ºæµç¨‹ã€‚ webpack æ˜¯åŸºäºå…¥å£çš„ã€‚webpack ä¼šè‡ªåŠ¨åœ°é€’å½’è§£æå…¥å£æ‰€éœ€è¦åŠ è½½çš„æ‰€æœ‰èµ„æºæ–‡ä»¶ï¼Œç„¶åç”¨ä¸åŒçš„ Loader æ¥å¤„ç†ä¸åŒçš„æ–‡ä»¶ï¼Œç”¨ Plugin æ¥æ‰©å±• webpack åŠŸèƒ½ã€‚ æ‰€ä»¥æ€»ç»“ä¸€ä¸‹ï¼š ä»æ„å»ºæ€è·¯æ¥è¯´ gulp å’Œ grunt éœ€è¦å¼€å‘è€…å°†æ•´ä¸ªå‰ç«¯æ„å»ºè¿‡ç¨‹æ‹†åˆ†æˆå¤šä¸ªTaskï¼Œå¹¶åˆç†æ§åˆ¶æ‰€æœ‰Taskçš„è°ƒç”¨å…³ç³» webpack éœ€è¦å¼€å‘è€…æ‰¾åˆ°å…¥å£ï¼Œå¹¶éœ€è¦æ¸…æ¥šå¯¹äºä¸åŒçš„èµ„æºåº”è¯¥ä½¿ç”¨ä»€ä¹ˆ Loader åšä½•ç§è§£æå’ŒåŠ å·¥ å¯¹äºçŸ¥è¯†èƒŒæ™¯æ¥è¯´ gulp æ›´åƒåç«¯å¼€å‘è€…çš„æ€è·¯ï¼Œéœ€è¦å¯¹äºæ•´ä¸ªæµç¨‹äº†å¦‚æŒ‡æŒ webpack æ›´å€¾å‘äºå‰ç«¯å¼€å‘è€…çš„æ€è·¯ 2. ä¸ webpack ç±»ä¼¼çš„å·¥å…·è¿˜æœ‰å“ªäº›ï¼Ÿè°ˆè°ˆä½ ä¸ºä»€ä¹ˆæœ€ç»ˆé€‰æ‹©ï¼ˆæˆ–æ”¾å¼ƒï¼‰ä½¿ç”¨ webpackï¼ŸåŒæ ·æ˜¯åŸºäºå…¥å£çš„æ‰“åŒ…å·¥å…·è¿˜æœ‰ä»¥ä¸‹å‡ ä¸ªä¸»æµçš„ï¼š webpack rollup parcel ä»åº”ç”¨åœºæ™¯ä¸Šæ¥çœ‹ï¼š webpack é€‚ç”¨äºå¤§å‹å¤æ‚çš„å‰ç«¯ç«™ç‚¹æ„å»º rollup é€‚ç”¨äºåŸºç¡€åº“çš„æ‰“åŒ…ï¼Œå¦‚ vueã€react parcel é€‚ç”¨äºç®€å•çš„å®éªŒæ€§é¡¹ç›®ï¼Œä»–å¯ä»¥æ»¡è¶³ä½é—¨æ§›çš„å¿«é€Ÿçœ‹åˆ°æ•ˆæœ ç”±äº parcel åœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­ç»™å‡ºçš„è°ƒè¯•ä¿¡æ¯ååˆ†æœ‰é™ï¼Œæ‰€ä»¥ä¸€æ—¦æ‰“åŒ…å‡ºé”™éš¾ä»¥è°ƒè¯•ï¼Œæ‰€ä»¥ä¸å»ºè®®å¤æ‚çš„é¡¹ç›®ä½¿ç”¨ parcel 3.æœ‰å“ªäº›å¸¸è§çš„ Loaderï¼Ÿä»–ä»¬æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ file-loaderï¼šæŠŠæ–‡ä»¶è¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼Œåœ¨ä»£ç ä¸­é€šè¿‡ç›¸å¯¹ URL å»å¼•ç”¨è¾“å‡ºçš„æ–‡ä»¶ url-loaderï¼šå’Œ file-loader ç±»ä¼¼ï¼Œä½†æ˜¯èƒ½åœ¨æ–‡ä»¶å¾ˆå°çš„æƒ…å†µä¸‹ä»¥ base64 çš„æ–¹å¼æŠŠæ–‡ä»¶å†…å®¹æ³¨å…¥åˆ°ä»£ç ä¸­å» source-map-loaderï¼šåŠ è½½é¢å¤–çš„ Source Map æ–‡ä»¶ï¼Œä»¥æ–¹ä¾¿æ–­ç‚¹è°ƒè¯• image-loaderï¼šåŠ è½½å¹¶ä¸”å‹ç¼©å›¾ç‰‡æ–‡ä»¶ babel-loaderï¼šæŠŠ ES6 è½¬æ¢æˆ ES5 css-loaderï¼šåŠ è½½ CSSï¼Œæ”¯æŒæ¨¡å—åŒ–ã€å‹ç¼©ã€æ–‡ä»¶å¯¼å…¥ç­‰ç‰¹æ€§ style-loaderï¼šæŠŠ CSS ä»£ç æ³¨å…¥åˆ° JavaScript ä¸­ï¼Œé€šè¿‡ DOM æ“ä½œå»åŠ è½½ CSSã€‚ eslint-loaderï¼šé€šè¿‡ ESLint æ£€æŸ¥ JavaScript ä»£ç  4.æœ‰å“ªäº›å¸¸è§çš„ Pluginï¼Ÿä»–ä»¬æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜çš„ï¼Ÿ define-pluginï¼šå®šä¹‰ç¯å¢ƒå˜é‡ commons-chunk-pluginï¼šæå–å…¬å…±ä»£ç  uglifyjs-webpack-pluginï¼šé€šè¿‡ UglifyES å‹ç¼© ES6 ä»£ç  5.Loader å’Œ Plugin çš„ä¸åŒï¼Ÿä¸åŒçš„ä½œç”¨ Loaderç›´è¯‘ä¸ºâ€åŠ è½½å™¨â€ã€‚Webpack å°†ä¸€åˆ‡æ–‡ä»¶è§†ä¸ºæ¨¡å—ï¼Œä½†æ˜¯ webpack åŸç”Ÿæ˜¯åªèƒ½è§£æ js æ–‡ä»¶ï¼Œå¦‚æœæƒ³å°†å…¶ä»–æ–‡ä»¶ä¹Ÿæ‰“åŒ…çš„è¯ï¼Œå°±ä¼šç”¨åˆ° loaderã€‚ æ‰€ä»¥ Loader çš„ä½œç”¨æ˜¯è®© webpack æ‹¥æœ‰äº†åŠ è½½å’Œè§£æé JavaScript æ–‡ä»¶çš„èƒ½åŠ›ã€‚ Pluginç›´è¯‘ä¸ºâ€æ’ä»¶â€ã€‚Plugin å¯ä»¥æ‰©å±• webpack çš„åŠŸèƒ½ï¼Œè®© webpack å…·æœ‰æ›´å¤šçš„çµæ´»æ€§ã€‚ åœ¨ Webpack è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¼šå¹¿æ’­å‡ºè®¸å¤šäº‹ä»¶ï¼ŒPlugin å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡ Webpack æä¾›çš„ API æ”¹å˜è¾“å‡ºç»“æœã€‚ ä¸åŒçš„ç”¨æ³• Loaderåœ¨ module.rules ä¸­é…ç½®ï¼Œä¹Ÿå°±æ˜¯è¯´ä»–ä½œä¸ºæ¨¡å—çš„è§£æè§„åˆ™è€Œå­˜åœ¨ã€‚ ç±»å‹ä¸ºæ•°ç»„ï¼Œæ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ª Objectï¼Œé‡Œé¢æè¿°äº†å¯¹äºä»€ä¹ˆç±»å‹çš„æ–‡ä»¶ï¼ˆtestï¼‰ï¼Œä½¿ç”¨ä»€ä¹ˆåŠ è½½(loader)å’Œä½¿ç”¨çš„å‚æ•°ï¼ˆoptionsï¼‰ Pluginåœ¨ plugins ä¸­å•ç‹¬é…ç½®ã€‚ ç±»å‹ä¸ºæ•°ç»„ï¼Œæ¯ä¸€é¡¹æ˜¯ä¸€ä¸ª plugin çš„å®ä¾‹ï¼Œå‚æ•°éƒ½é€šè¿‡æ„é€ å‡½æ•°ä¼ å…¥ã€‚ 6.webpack çš„æ„å»ºæµç¨‹æ˜¯ä»€ä¹ˆ?ä»è¯»å–é…ç½®åˆ°è¾“å‡ºæ–‡ä»¶è¿™ä¸ªè¿‡ç¨‹å°½é‡è¯´å…¨Webpack çš„è¿è¡Œæµç¨‹æ˜¯ä¸€ä¸ªä¸²è¡Œçš„è¿‡ç¨‹ï¼Œä»å¯åŠ¨åˆ°ç»“æŸä¼šä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æµç¨‹ï¼š åˆå§‹åŒ–å‚æ•°ï¼šä»é…ç½®æ–‡ä»¶å’Œ Shell è¯­å¥ä¸­è¯»å–ä¸åˆå¹¶å‚æ•°ï¼Œå¾—å‡ºæœ€ç»ˆçš„å‚æ•°ï¼› å¼€å§‹ç¼–è¯‘ï¼šç”¨ä¸Šä¸€æ­¥å¾—åˆ°çš„å‚æ•°åˆå§‹åŒ– Compiler å¯¹è±¡ï¼ŒåŠ è½½æ‰€æœ‰é…ç½®çš„æ’ä»¶ï¼Œæ‰§è¡Œå¯¹è±¡çš„ run æ–¹æ³•å¼€å§‹æ‰§è¡Œç¼–è¯‘ï¼› ç¡®å®šå…¥å£ï¼šæ ¹æ®é…ç½®ä¸­çš„ entry æ‰¾å‡ºæ‰€æœ‰çš„å…¥å£æ–‡ä»¶ï¼› ç¼–è¯‘æ¨¡å—ï¼šä»å…¥å£æ–‡ä»¶å‡ºå‘ï¼Œè°ƒç”¨æ‰€æœ‰é…ç½®çš„ Loader å¯¹æ¨¡å—è¿›è¡Œç¿»è¯‘ï¼Œå†æ‰¾å‡ºè¯¥æ¨¡å—ä¾èµ–çš„æ¨¡å—ï¼Œå†é€’å½’æœ¬æ­¥éª¤ç›´åˆ°æ‰€æœ‰å…¥å£ä¾èµ–çš„æ–‡ä»¶éƒ½ç»è¿‡äº†æœ¬æ­¥éª¤çš„å¤„ç†ï¼› å®Œæˆæ¨¡å—ç¼–è¯‘ï¼šåœ¨ç»è¿‡ç¬¬ 4 æ­¥ä½¿ç”¨ Loader ç¿»è¯‘å®Œæ‰€æœ‰æ¨¡å—åï¼Œå¾—åˆ°äº†æ¯ä¸ªæ¨¡å—è¢«ç¿»è¯‘åçš„æœ€ç»ˆå†…å®¹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼› è¾“å‡ºèµ„æºï¼šæ ¹æ®å…¥å£å’Œæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œç»„è£…æˆä¸€ä¸ªä¸ªåŒ…å«å¤šä¸ªæ¨¡å—çš„ Chunkï¼Œå†æŠŠæ¯ä¸ª Chunk è½¬æ¢æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶åŠ å…¥åˆ°è¾“å‡ºåˆ—è¡¨ï¼Œè¿™æ­¥æ˜¯å¯ä»¥ä¿®æ”¹è¾“å‡ºå†…å®¹çš„æœ€åæœºä¼šï¼› è¾“å‡ºå®Œæˆï¼šåœ¨ç¡®å®šå¥½è¾“å‡ºå†…å®¹åï¼Œæ ¹æ®é…ç½®ç¡®å®šè¾“å‡ºçš„è·¯å¾„å’Œæ–‡ä»¶åï¼ŒæŠŠæ–‡ä»¶å†…å®¹å†™å…¥åˆ°æ–‡ä»¶ç³»ç»Ÿã€‚ åœ¨ä»¥ä¸Šè¿‡ç¨‹ä¸­ï¼ŒWebpack ä¼šåœ¨ç‰¹å®šçš„æ—¶é—´ç‚¹å¹¿æ’­å‡ºç‰¹å®šçš„äº‹ä»¶ï¼Œæ’ä»¶åœ¨ç›‘å¬åˆ°æ„Ÿå…´è¶£çš„äº‹ä»¶åä¼šæ‰§è¡Œç‰¹å®šçš„é€»è¾‘ï¼Œå¹¶ä¸”æ’ä»¶å¯ä»¥è°ƒç”¨ Webpack æä¾›çš„ API æ”¹å˜ Webpack çš„è¿è¡Œç»“æœã€‚ 7.æ˜¯å¦å†™è¿‡ Loader å’Œ Pluginï¼Ÿæè¿°ä¸€ä¸‹ç¼–å†™ loader æˆ– plugin çš„æ€è·¯ï¼ŸLoader åƒä¸€ä¸ªâ€ç¿»è¯‘å®˜â€æŠŠè¯»åˆ°çš„æºæ–‡ä»¶å†…å®¹è½¬ä¹‰æˆæ–°çš„æ–‡ä»¶å†…å®¹ï¼Œå¹¶ä¸”æ¯ä¸ª Loader é€šè¿‡é“¾å¼æ“ä½œï¼Œå°†æºæ–‡ä»¶ä¸€æ­¥æ­¥ç¿»è¯‘æˆæƒ³è¦çš„æ ·å­ã€‚ ç¼–å†™ Loader æ—¶è¦éµå¾ªå•ä¸€åŸåˆ™ï¼Œæ¯ä¸ª Loader åªåšä¸€ç§â€è½¬ä¹‰â€å·¥ä½œã€‚ æ¯ä¸ª Loader çš„æ‹¿åˆ°çš„æ˜¯æºæ–‡ä»¶å†…å®¹ï¼ˆsourceï¼‰ï¼Œå¯ä»¥é€šè¿‡è¿”å›å€¼çš„æ–¹å¼å°†å¤„ç†åçš„å†…å®¹è¾“å‡ºï¼Œä¹Ÿå¯ä»¥è°ƒç”¨ this.callback()æ–¹æ³•ï¼Œå°†å†…å®¹è¿”å›ç»™ webpackã€‚ è¿˜å¯ä»¥é€šè¿‡ this.async()ç”Ÿæˆä¸€ä¸ª callback å‡½æ•°ï¼Œå†ç”¨è¿™ä¸ª callback å°†å¤„ç†åçš„å†…å®¹è¾“å‡ºå‡ºå»ã€‚ æ­¤å¤– webpack è¿˜ä¸ºå¼€å‘è€…å‡†å¤‡äº†å¼€å‘ loader çš„å·¥å…·å‡½æ•°é›†â€”â€”loader-utilsã€‚ ç›¸å¯¹äº Loader è€Œè¨€ï¼ŒPlugin çš„ç¼–å†™å°±çµæ´»äº†è®¸å¤šã€‚ webpack åœ¨è¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¼šå¹¿æ’­å‡ºè®¸å¤šäº‹ä»¶ï¼ŒPlugin å¯ä»¥ç›‘å¬è¿™äº›äº‹ä»¶ï¼Œåœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡ Webpack æä¾›çš„ API æ”¹å˜è¾“å‡ºç»“æœã€‚ 8.webpack çš„çƒ­æ›´æ–°æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Ÿè¯´æ˜å…¶åŸç†ï¼Ÿwebpack çš„çƒ­æ›´æ–°åˆç§°çƒ­æ›¿æ¢ï¼ˆHot Module Replacementï¼‰ï¼Œç¼©å†™ä¸º HMRã€‚ è¿™ä¸ªæœºåˆ¶å¯ä»¥åšåˆ°ä¸ç”¨åˆ·æ–°æµè§ˆå™¨è€Œå°†æ–°å˜æ›´çš„æ¨¡å—æ›¿æ¢æ‰æ—§çš„æ¨¡å—ã€‚ åŸç†ï¼š é¦–å…ˆè¦çŸ¥é“ server ç«¯å’Œ client ç«¯éƒ½åšäº†å¤„ç†å·¥ä½œ ç¬¬ä¸€æ­¥ï¼Œåœ¨ webpack çš„ watch æ¨¡å¼ä¸‹ï¼Œæ–‡ä»¶ç³»ç»Ÿä¸­æŸä¸€ä¸ªæ–‡ä»¶å‘ç”Ÿä¿®æ”¹ï¼Œwebpack ç›‘å¬åˆ°æ–‡ä»¶å˜åŒ–ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶å¯¹æ¨¡å—é‡æ–°ç¼–è¯‘æ‰“åŒ…ï¼Œå¹¶å°†æ‰“åŒ…åçš„ä»£ç é€šè¿‡ç®€å•çš„ JavaScript å¯¹è±¡ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚ ç¬¬äºŒæ­¥æ˜¯ webpack-dev-server å’Œ webpack ä¹‹é—´çš„æ¥å£äº¤äº’ï¼Œè€Œåœ¨è¿™ä¸€æ­¥ï¼Œä¸»è¦æ˜¯ dev-server çš„ä¸­é—´ä»¶ webpack-dev-middleware å’Œ webpack ä¹‹é—´çš„äº¤äº’ï¼Œwebpack-dev-middleware è°ƒç”¨ webpack æš´éœ²çš„ API å¯¹ä»£ç å˜åŒ–è¿›è¡Œç›‘æ§ï¼Œå¹¶ä¸”å‘Šè¯‰ webpackï¼Œå°†ä»£ç æ‰“åŒ…åˆ°å†…å­˜ä¸­ã€‚ ç¬¬ä¸‰æ­¥æ˜¯ webpack-dev-server å¯¹æ–‡ä»¶å˜åŒ–çš„ä¸€ä¸ªç›‘æ§ï¼Œè¿™ä¸€æ­¥ä¸åŒäºç¬¬ä¸€æ­¥ï¼Œå¹¶ä¸æ˜¯ç›‘æ§ä»£ç å˜åŒ–é‡æ–°æ‰“åŒ…ã€‚å½“æˆ‘ä»¬åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®äº† devServer.watchContentBase ä¸º true çš„æ—¶å€™ï¼ŒServer ä¼šç›‘å¬è¿™äº›é…ç½®æ–‡ä»¶å¤¹ä¸­é™æ€æ–‡ä»¶çš„å˜åŒ–ï¼Œå˜åŒ–åä¼šé€šçŸ¥æµè§ˆå™¨ç«¯å¯¹åº”ç”¨è¿›è¡Œ live reloadã€‚æ³¨æ„ï¼Œè¿™å„¿æ˜¯æµè§ˆå™¨åˆ·æ–°ï¼Œå’Œ HMR æ˜¯ä¸¤ä¸ªæ¦‚å¿µã€‚ ç¬¬å››æ­¥ä¹Ÿæ˜¯ webpack-dev-server ä»£ç çš„å·¥ä½œï¼Œè¯¥æ­¥éª¤ä¸»è¦æ˜¯é€šè¿‡ sockjsï¼ˆwebpack-dev-server çš„ä¾èµ–ï¼‰åœ¨æµè§ˆå™¨ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´å»ºç«‹ä¸€ä¸ª websocket é•¿è¿æ¥ï¼Œå°† webpack ç¼–è¯‘æ‰“åŒ…çš„å„ä¸ªé˜¶æ®µçš„çŠ¶æ€ä¿¡æ¯å‘ŠçŸ¥æµè§ˆå™¨ç«¯ï¼ŒåŒæ—¶ä¹ŸåŒ…æ‹¬ç¬¬ä¸‰æ­¥ä¸­ Server ç›‘å¬é™æ€æ–‡ä»¶å˜åŒ–çš„ä¿¡æ¯ã€‚æµè§ˆå™¨ç«¯æ ¹æ®è¿™äº› socket æ¶ˆæ¯è¿›è¡Œä¸åŒçš„æ“ä½œã€‚å½“ç„¶æœåŠ¡ç«¯ä¼ é€’çš„æœ€ä¸»è¦ä¿¡æ¯è¿˜æ˜¯æ–°æ¨¡å—çš„ hash å€¼ï¼Œåé¢çš„æ­¥éª¤æ ¹æ®è¿™ä¸€ hash å€¼æ¥è¿›è¡Œæ¨¡å—çƒ­æ›¿æ¢ã€‚ webpack-dev-server/client ç«¯å¹¶ä¸èƒ½å¤Ÿè¯·æ±‚æ›´æ–°çš„ä»£ç ï¼Œä¹Ÿä¸ä¼šæ‰§è¡Œçƒ­æ›´æ¨¡å—æ“ä½œï¼Œè€ŒæŠŠè¿™äº›å·¥ä½œåˆäº¤å›ç»™äº† webpackï¼Œwebpack/hot/dev-server çš„å·¥ä½œå°±æ˜¯æ ¹æ® webpack-dev-server/client ä¼ ç»™å®ƒçš„ä¿¡æ¯ä»¥åŠ dev-server çš„é…ç½®å†³å®šæ˜¯åˆ·æ–°æµè§ˆå™¨å‘¢è¿˜æ˜¯è¿›è¡Œæ¨¡å—çƒ­æ›´æ–°ã€‚å½“ç„¶å¦‚æœä»…ä»…æ˜¯åˆ·æ–°æµè§ˆå™¨ï¼Œä¹Ÿå°±æ²¡æœ‰åé¢é‚£äº›æ­¥éª¤äº†ã€‚ HotModuleReplacement.runtime æ˜¯å®¢æˆ·ç«¯ HMR çš„ä¸­æ¢ï¼Œå®ƒæ¥æ”¶åˆ°ä¸Šä¸€æ­¥ä¼ é€’ç»™ä»–çš„æ–°æ¨¡å—çš„ hash å€¼ï¼Œå®ƒé€šè¿‡ JsonpMainTemplate.runtime å‘ server ç«¯å‘é€ Ajax è¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å›ä¸€ä¸ª jsonï¼Œè¯¥ json åŒ…å«äº†æ‰€æœ‰è¦æ›´æ–°çš„æ¨¡å—çš„ hash å€¼ï¼Œè·å–åˆ°æ›´æ–°åˆ—è¡¨åï¼Œè¯¥æ¨¡å—å†æ¬¡é€šè¿‡ jsonp è¯·æ±‚ï¼Œè·å–åˆ°æœ€æ–°çš„æ¨¡å—ä»£ç ã€‚è¿™å°±æ˜¯ä¸Šå›¾ä¸­ 7ã€8ã€9 æ­¥éª¤ã€‚ è€Œç¬¬ 10 æ­¥æ˜¯å†³å®š HMR æˆåŠŸä¸å¦çš„å…³é”®æ­¥éª¤ï¼Œåœ¨è¯¥æ­¥éª¤ä¸­ï¼ŒHotModulePlugin å°†ä¼šå¯¹æ–°æ—§æ¨¡å—è¿›è¡Œå¯¹æ¯”ï¼Œå†³å®šæ˜¯å¦æ›´æ–°æ¨¡å—ï¼Œåœ¨å†³å®šæ›´æ–°æ¨¡å—åï¼Œæ£€æŸ¥æ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæ›´æ–°æ¨¡å—çš„åŒæ—¶æ›´æ–°æ¨¡å—é—´çš„ä¾èµ–å¼•ç”¨ã€‚ æœ€åä¸€æ­¥ï¼Œå½“ HMR å¤±è´¥åï¼Œå›é€€åˆ° live reload æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œæµè§ˆå™¨åˆ·æ–°æ¥è·å–æœ€æ–°æ‰“åŒ…ä»£ç ã€‚ 9.å¦‚ä½•åˆ©ç”¨ webpack æ¥ä¼˜åŒ–å‰ç«¯æ€§èƒ½ï¼Ÿï¼ˆæé«˜æ€§èƒ½å’Œä½“éªŒï¼‰ç”¨ webpack ä¼˜åŒ–å‰ç«¯æ€§èƒ½æ˜¯æŒ‡ä¼˜åŒ– webpack çš„è¾“å‡ºç»“æœï¼Œè®©æ‰“åŒ…çš„æœ€ç»ˆç»“æœåœ¨æµè§ˆå™¨è¿è¡Œå¿«é€Ÿé«˜æ•ˆã€‚ å‹ç¼©ä»£ç ã€‚åˆ é™¤å¤šä½™çš„ä»£ç ã€æ³¨é‡Šã€ç®€åŒ–ä»£ç çš„å†™æ³•ç­‰ç­‰æ–¹å¼ã€‚å¯ä»¥åˆ©ç”¨ webpack çš„ UglifyJsPlugin å’Œ ParallelUglifyPlugin æ¥å‹ç¼© JS æ–‡ä»¶ï¼Œ åˆ©ç”¨ cssnanoï¼ˆcss-loader?minimizeï¼‰æ¥å‹ç¼© css åˆ©ç”¨CDNåŠ é€Ÿã€‚åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå°†å¼•ç”¨çš„é™æ€èµ„æºè·¯å¾„ä¿®æ”¹ä¸º CDN ä¸Šå¯¹åº”çš„è·¯å¾„ã€‚å¯ä»¥åˆ©ç”¨ webpack å¯¹äº output å‚æ•°å’Œå„ loader çš„ publicPath å‚æ•°æ¥ä¿®æ”¹èµ„æºè·¯å¾„ åˆ é™¤æ­»ä»£ç ï¼ˆTree Shakingï¼‰ã€‚å°†ä»£ç ä¸­æ°¸è¿œä¸ä¼šèµ°åˆ°çš„ç‰‡æ®µåˆ é™¤æ‰ã€‚å¯ä»¥é€šè¿‡åœ¨å¯åŠ¨ webpack æ—¶è¿½åŠ å‚æ•°â€“optimize-minimize æ¥å®ç° æå–å…¬å…±ä»£ç ã€‚ 10.å¦‚ä½•æé«˜ webpack çš„æ„å»ºé€Ÿåº¦ï¼Ÿ å¤šå…¥å£æƒ…å†µä¸‹ï¼Œä½¿ç”¨ CommonsChunkPlugin æ¥æå–å…¬å…±ä»£ç  é€šè¿‡ externals é…ç½®æ¥æå–å¸¸ç”¨åº“ åˆ©ç”¨ DllPlugin å’Œ DllReferencePlugin é¢„ç¼–è¯‘èµ„æºæ¨¡å— é€šè¿‡ DllPlugin æ¥å¯¹é‚£äº›æˆ‘ä»¬å¼•ç”¨ä½†æ˜¯ç»å¯¹ä¸ä¼šä¿®æ”¹çš„ npm åŒ…æ¥è¿›è¡Œé¢„ç¼–è¯‘ï¼Œå†é€šè¿‡ DllReferencePlugin å°†é¢„ç¼–è¯‘çš„æ¨¡å—åŠ è½½è¿›æ¥ã€‚ ä½¿ç”¨ Happypack å®ç°å¤šçº¿ç¨‹åŠ é€Ÿç¼–è¯‘ ä½¿ç”¨ webpack-uglify-parallel æ¥æå‡ uglifyPlugin çš„å‹ç¼©é€Ÿåº¦ã€‚ åŸç†ä¸Š webpack-uglify-parallel é‡‡ç”¨äº†å¤šæ ¸å¹¶è¡Œå‹ç¼©æ¥æå‡å‹ç¼©é€Ÿåº¦ ä½¿ç”¨ Tree-shaking å’Œ Scope Hoisting æ¥å‰”é™¤å¤šä½™ä»£ç  11.æ€ä¹ˆé…ç½®å•é¡µåº”ç”¨ï¼Ÿæ€ä¹ˆé…ç½®å¤šé¡µåº”ç”¨ï¼Ÿå•é¡µåº”ç”¨å¯ä»¥ç†è§£ä¸º webpack çš„æ ‡å‡†æ¨¡å¼ï¼Œç›´æ¥åœ¨ entry ä¸­æŒ‡å®šå•é¡µåº”ç”¨çš„å…¥å£å³å¯ï¼Œè¿™é‡Œä¸å†èµ˜è¿° å¤šé¡µåº”ç”¨çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ webpack çš„ AutoWebPlugin æ¥å®Œæˆç®€å•è‡ªåŠ¨åŒ–çš„æ„å»ºï¼Œä½†æ˜¯å‰ææ˜¯é¡¹ç›®çš„ç›®å½•ç»“æ„å¿…é¡»éµå®ˆä»–é¢„è®¾çš„è§„èŒƒã€‚ å¤šé¡µåº”ç”¨ä¸­è¦æ³¨æ„çš„æ˜¯ï¼š æ¯ä¸ªé¡µé¢éƒ½æœ‰å…¬å…±çš„ä»£ç ï¼Œå¯ä»¥å°†è¿™äº›ä»£ç æŠ½ç¦»å‡ºæ¥ï¼Œé¿å…é‡å¤çš„åŠ è½½ã€‚æ¯”å¦‚ï¼Œæ¯ä¸ªé¡µé¢éƒ½å¼•ç”¨äº†åŒä¸€å¥— css æ ·å¼è¡¨ éšç€ä¸šåŠ¡çš„ä¸æ–­æ‰©å±•ï¼Œé¡µé¢å¯èƒ½ä¼šä¸æ–­çš„è¿½åŠ ï¼Œæ‰€ä»¥ä¸€å®šè¦è®©å…¥å£çš„é…ç½®è¶³å¤Ÿçµæ´»ï¼Œé¿å…æ¯æ¬¡æ·»åŠ æ–°é¡µé¢è¿˜éœ€è¦ä¿®æ”¹æ„å»ºé…ç½® 12.npm æ‰“åŒ…æ—¶éœ€è¦æ³¨æ„å“ªäº›ï¼Ÿå¦‚ä½•åˆ©ç”¨ webpack æ¥æ›´å¥½çš„æ„å»ºï¼ŸNpm æ˜¯ç›®å‰æœ€å¤§çš„ JavaScript æ¨¡å—ä»“åº“ï¼Œé‡Œé¢æœ‰æ¥è‡ªå…¨ä¸–ç•Œå¼€å‘è€…ä¸Šä¼ çš„å¯å¤ç”¨æ¨¡å—ã€‚ä½ å¯èƒ½åªæ˜¯ JS æ¨¡å—çš„ä½¿ç”¨è€…ï¼Œä½†æ˜¯æœ‰äº›æƒ…å†µä½ ä¹Ÿä¼šå»é€‰æ‹©ä¸Šä¼ è‡ªå·±å¼€å‘çš„æ¨¡å—ã€‚ å…³äº NPM æ¨¡å—ä¸Šä¼ çš„æ–¹æ³•å¯ä»¥å»å®˜ç½‘ä¸Šè¿›è¡Œå­¦ä¹ ï¼Œè¿™é‡Œåªè®²è§£å¦‚ä½•åˆ©ç”¨ webpack æ¥æ„å»ºã€‚ NPM æ¨¡å—éœ€è¦æ³¨æ„ä»¥ä¸‹é—®é¢˜ï¼š è¦æ”¯æŒ CommonJS æ¨¡å—åŒ–è§„èŒƒï¼Œæ‰€ä»¥è¦æ±‚æ‰“åŒ…åçš„æœ€åç»“æœä¹Ÿéµå®ˆè¯¥è§„åˆ™ã€‚ Npm æ¨¡å—ä½¿ç”¨è€…çš„ç¯å¢ƒæ˜¯ä¸ç¡®å®šçš„ï¼Œå¾ˆæœ‰å¯èƒ½å¹¶ä¸æ”¯æŒ ES6ï¼Œæ‰€ä»¥æ‰“åŒ…çš„æœ€åç»“æœåº”è¯¥æ˜¯é‡‡ç”¨ ES5 ç¼–å†™çš„ã€‚å¹¶ä¸”å¦‚æœ ES5 æ˜¯ç»è¿‡è½¬æ¢çš„ï¼Œè¯·æœ€å¥½è¿åŒ SourceMap ä¸€åŒä¸Šä¼ ã€‚ Npm åŒ…å¤§å°åº”è¯¥æ˜¯å°½é‡å°ï¼ˆæœ‰äº›ä»“åº“ä¼šé™åˆ¶åŒ…å¤§å°ï¼‰ å‘å¸ƒçš„æ¨¡å—ä¸èƒ½å°†ä¾èµ–çš„æ¨¡å—ä¹Ÿä¸€åŒæ‰“åŒ…ï¼Œåº”è¯¥è®©ç”¨æˆ·é€‰æ‹©æ€§çš„å»è‡ªè¡Œå®‰è£…ã€‚è¿™æ ·å¯ä»¥é¿å…æ¨¡å—åº”ç”¨è€…å†æ¬¡æ‰“åŒ…æ—¶å‡ºç°åº•å±‚æ¨¡å—è¢«é‡å¤æ‰“åŒ…çš„æƒ…å†µã€‚ UI ç»„ä»¶ç±»çš„æ¨¡å—åº”è¯¥å°†ä¾èµ–çš„å…¶å®ƒèµ„æºæ–‡ä»¶ï¼Œä¾‹å¦‚.css æ–‡ä»¶ä¹Ÿéœ€è¦åŒ…å«åœ¨å‘å¸ƒçš„æ¨¡å—é‡Œã€‚ åŸºäºä»¥ä¸Šéœ€è¦æ³¨æ„çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹äº webpack é…ç½®åšä»¥ä¸‹æ‰©å±•å’Œä¼˜åŒ–ï¼š CommonJS æ¨¡å—åŒ–è§„èŒƒçš„è§£å†³æ–¹æ¡ˆï¼š è®¾ç½® output.libraryTarget=â€™commonjs2â€™ä½¿è¾“å‡ºçš„ä»£ç ç¬¦åˆ CommonJS2 æ¨¡å—åŒ–è§„èŒƒï¼Œä»¥ä¾›ç»™å…¶å®ƒæ¨¡å—å¯¼å…¥ä½¿ç”¨ è¾“å‡º ES5 ä»£ç çš„è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ babel-loader æŠŠ ES6 ä»£ç è½¬æ¢æˆ ES5 çš„ä»£ç ã€‚å†é€šè¿‡å¼€å¯ devtool: â€˜source-mapâ€™è¾“å‡º SourceMap ä»¥å‘å¸ƒè°ƒè¯•ã€‚ Npm åŒ…å¤§å°å°½é‡å°çš„è§£å†³æ–¹æ¡ˆï¼šBabel åœ¨æŠŠ ES6 ä»£ç è½¬æ¢æˆ ES5 ä»£ç æ—¶ä¼šæ³¨å…¥ä¸€äº›è¾…åŠ©å‡½æ•°ï¼Œæœ€ç»ˆå¯¼è‡´æ¯ä¸ªè¾“å‡ºçš„æ–‡ä»¶ä¸­éƒ½åŒ…å«è¿™æ®µè¾…åŠ©å‡½æ•°çš„ä»£ç ï¼Œé€ æˆäº†ä»£ç çš„å†—ä½™ã€‚è§£å†³æ–¹æ³•æ˜¯ä¿®æ”¹.babelrc æ–‡ä»¶ï¼Œä¸ºå…¶åŠ å…¥ transform-runtime æ’ä»¶ ä¸èƒ½å°†ä¾èµ–æ¨¡å—æ‰“åŒ…åˆ° NPM æ¨¡å—ä¸­çš„è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨ externals é…ç½®é¡¹æ¥å‘Šè¯‰ webpack å“ªäº›æ¨¡å—ä¸éœ€è¦æ‰“åŒ…ã€‚ å¯¹äºä¾èµ–çš„èµ„æºæ–‡ä»¶æ‰“åŒ…çš„è§£å†³æ–¹æ¡ˆï¼šé€šè¿‡ css-loader å’Œ extract-text-webpack-plugin æ¥å®ç°ï¼Œé…ç½®å¦‚ä¸‹ï¼š 13.å¦‚ä½•åœ¨ vue é¡¹ç›®ä¸­å®ç°æŒ‰éœ€åŠ è½½ï¼ŸVue UI ç»„ä»¶åº“çš„æŒ‰éœ€åŠ è½½ ä¸ºäº†å¿«é€Ÿå¼€å‘å‰ç«¯é¡¹ç›®ï¼Œç»å¸¸ä¼šå¼•å…¥ç°æˆçš„ UI ç»„ä»¶åº“å¦‚ ElementUIã€iView ç­‰ï¼Œä½†æ˜¯ä»–ä»¬çš„ä½“ç§¯å’Œä»–ä»¬æ‰€æä¾›çš„åŠŸèƒ½ä¸€æ ·ï¼Œæ˜¯å¾ˆåºå¤§çš„ã€‚ è€Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä»…ä»…éœ€è¦å°‘é‡çš„å‡ ä¸ªç»„ä»¶å°±è¶³å¤Ÿäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å´å°†åºå¤§çš„ç»„ä»¶åº“æ‰“åŒ…åˆ°æˆ‘ä»¬çš„æºç ä¸­ï¼Œé€ æˆäº†ä¸å¿…è¦çš„å¼€é”€ã€‚ ä¸è¿‡å¾ˆå¤šç»„ä»¶åº“å·²ç»æä¾›äº†ç°æˆçš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚ Element å‡ºå“çš„ babel-plugin-component å’Œ AntDesign å‡ºå“çš„ babel-plugin-import å®‰è£…ä»¥ä¸Šæ’ä»¶åï¼Œåœ¨.babelrc é…ç½®ä¸­æˆ– babel-loader çš„å‚æ•°ä¸­è¿›è¡Œè®¾ç½®ï¼Œå³å¯å®ç°ç»„ä»¶æŒ‰éœ€åŠ è½½äº†ã€‚ å•é¡µåº”ç”¨çš„æŒ‰éœ€åŠ è½½ ç°åœ¨å¾ˆå¤šå‰ç«¯é¡¹ç›®éƒ½æ˜¯é€šè¿‡å•é¡µåº”ç”¨çš„æ–¹å¼å¼€å‘çš„ï¼Œä½†æ˜¯éšç€ä¸šåŠ¡çš„ä¸æ–­æ‰©å±•ï¼Œä¼šé¢ä¸´ä¸€ä¸ªä¸¥å³»çš„é—®é¢˜â€”â€”é¦–æ¬¡åŠ è½½çš„ä»£ç é‡ä¼šè¶Šæ¥è¶Šå¤šï¼Œå½±å“ç”¨æˆ·çš„ä½“éªŒã€‚ é€šè¿‡ import(*)è¯­å¥æ¥æ§åˆ¶åŠ è½½æ—¶æœºï¼Œwebpack å†…ç½®äº†å¯¹äº import(*)çš„è§£æï¼Œä¼šå°† import(*)ä¸­å¼•å…¥çš„æ¨¡å—ä½œä¸ºä¸€ä¸ªæ–°çš„å…¥å£åœ¨ç”Ÿæˆä¸€ä¸ª chunkã€‚ å½“ä»£ç æ‰§è¡Œåˆ° import(*)è¯­å¥æ—¶ï¼Œä¼šå»åŠ è½½ Chunk å¯¹åº”ç”Ÿæˆçš„æ–‡ä»¶ã€‚import()ä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œæ‰€ä»¥ä¸ºäº†è®©æµè§ˆå™¨æ”¯æŒï¼Œéœ€è¦äº‹å…ˆæ³¨å…¥ Promise polyfill webpack ç¤ºä¾‹const path = require(&quot;path&quot;);const webpack = require(&quot;webpack&quot;);const HtmlWebpackPlugin = require(&quot;html-webpack-plugin&quot;);const MiniCssExtractPlugin = require(&quot;mini-css-extract-plugin&quot;);const OptimizeCssAssetsPlugin = require(&quot;optimize-css-assets-webpack-plugin&quot;);const AddAssetHtmlWebpackPlugin = require(&quot;add-asset-html-webpack-plugin&quot;);const TerserWebpackPlugin = require(&quot;terser-webpack-plugin&quot;); // ç”¨terser-webpack-pluginæ›¿æ¢æ‰uglifyjs-webpack-pluginè§£å†³uglifyjsä¸æ”¯æŒes6è¯­æ³•é—®é¢˜const WorkboxWebpackPlugin = require(&quot;workbox-webpack-plugin&quot;);process.env.NODE_ENV = &quot;production&quot;; // å®šä¹‰nodejsç¯å¢ƒå˜é‡ï¼Œè®¾ç½®browserslistä½¿ç”¨å“ªä¸ªå‚æ•°/** * å¼€å‘ç¯å¢ƒæ€§èƒ½ä¼˜åŒ–ï¼š * ä¼˜åŒ–æ‰“åŒ…é€Ÿåº¦ï¼š * # HMR * ä¼˜åŒ–ä»£ç è°ƒè¯•ï¼š * # source-map * * ç”Ÿäº§ç¯å¢ƒæ€§èƒ½ä¼˜åŒ–ï¼š * 1. ä¼˜åŒ–æ‰“åŒ…æ„å»ºé€Ÿåº¦ * # oneOf * # babelç¼“å­˜ * # å¤šè¿›ç¨‹æ‰“åŒ… * # externals (CDNé“¾æ¥) * # dll * * * 2. ä¼˜åŒ–ä»£ç è¿è¡Œæ—¶çš„æ€§èƒ½ * # ç¼“å­˜ï¼ˆhash/chunkhash/contenthashï¼‰ * # tree shaking å»é™¤ä»£ç ä¸­æ²¡æœ‰ç”¨çš„ä»£ç ï¼Œå‡å°‘æ‰“åŒ…ä½“ç§¯ * # ä»£ç åˆ†å‰² * # æ‡’åŠ è½½ã€é¢„åŠ è½½ * # pwa * # *//** * ç¼“å­˜ï¼šæœ€ç»ˆç¡®å®šä½¿ç”¨contenthash * 1. babelç¼“å­˜ï¼š--&gt; è®©ç¬¬äºŒæ¬¡æ‰“åŒ…æ„å»ºé€Ÿåº¦æ›´å¿« * cacheDirectory: true * 2. æ–‡ä»¶èµ„æºç¼“å­˜ï¼š--&gt; è®©ä»£ç ä¸Šçº¿è¿è¡Œç¼“å­˜ä½¿ç”¨ * hash ä½¿ç”¨hashå€¼åšç¼“å­˜ï¼Œæ–‡ä»¶èµ„æºç¼“å­˜ï¼Œæ¯æ¬¡webpackæ„å»ºæ‰“åŒ…ç”Ÿæˆçš„hashå€¼ * é—®é¢˜ï¼š é‡æ–°æ‰“åŒ…æ‰€æœ‰ç¼“å­˜å¤±æ•ˆï¼Œcsså’ŒjsåŒæ—¶ä½¿ç”¨ä¸€ä¸ªhash * chunkhash: æ ¹æ®chunkç”Ÿæˆçš„hashå€¼ï¼Œå¦‚æœæ‰“åŒ…æ¥æºä¸€ä¸ªchunkï¼Œåˆ™hashå€¼ä¸€æ · * é—®é¢˜ï¼šcssæ˜¯jsä¸­è¢«å¼•å…¥çš„ï¼Œæ‰€ä»¥åŒå±äºä¸€ä¸ªchunk * contenthash: æ ¹æ®æ–‡ä»¶çš„å†…å®¹ç”Ÿæˆhashï¼Œä¸åŒçš„æ–‡ä»¶hashå€¼ä¸ä¸€æ · *//** * tree shaking: å»é™¤æ— ç”¨ä»£ç ï¼Œå‡å°‘æ‰“åŒ…ä½“ç§¯ * å‰æï¼š1. å¿…é¡»ä½¿ç”¨ES6æ¨¡å—åŒ–ï¼›2. å¼€å¯productionæ¨¡å¼ * åœ¨package.jsonä¸­é…ç½® * &quot;sideEffects&quot;: false, // æ‰€æœ‰ä»£ç éƒ½æ²¡æœ‰å‰¯ä½œç”¨ï¼ˆéƒ½å¯ä»¥è¿›è¡Œtree shaking) * é—®é¢˜ï¼šå¯èƒ½æŠŠcss/@babel/polyfill ï¼ˆå‰¯ä½œç”¨ï¼‰æ–‡ä»¶å¹²æ‰ * &quot;sideEffects&quot;: [&quot;*.css&quot;, &quot;*.less&quot;] // ä¸ä¼šæŠŠcssæ–‡ä»¶å½“å‰¯ä½œç”¨æ–‡ä»¶ *//** * PWA: æ¸è¿›å¼ç½‘ç»œå¼€å‘åº”ç”¨ç¨‹åºï¼ˆç¦»çº¿å¯è®¿é—®ï¼‰ * workbox --&gt; workbox-webpack-plugin *//** * å¤šè¿›ç¨‹ * è¿›ç¨‹å¯åŠ¨å¤§æ¦‚600ms,è¿›ç¨‹é€šä¿¡ä¹Ÿæœ‰å¼€é”€ï¼Œåªæœ‰å·¥ä½œé”€æ¯æ—¶é—´æ¯”è¾ƒé•¿æ‰éœ€è¦å¤šè¿›ç¨‹æ‰“åŒ… * jsä»£ç ï¼š ä½¿ç”¨ thread-loader åœ¨æœ€åä½¿ç”¨è¯¥loader *//** * DLL: å¯¹æŸäº›ç¬¬ä¸‰æ–¹çš„åº“ï¼ˆjQuery, react, vue...ï¼‰è¿›è¡Œå•ç‹¬æ‰“åŒ… * éœ€è¦æ–°åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶webpack.dll.js * è¿è¡Œwebpack é»˜è®¤æŸ¥æ‰¾webpack.config.jsæ–‡ä»¶ * è¿è¡Œwebpack.dll.jséœ€è¦åˆ¶å®šé…ç½®æ–‡ä»¶ --&gt; webpack --config webpack.dll.js * module.exports = &#123; entry: &#123; // æœ€ç»ˆæ‰“åŒ…ç”Ÿæˆçš„[name] jquery: [&#x27;jquery&#x27;] &#125;, output: &#123; path: path.join(__dirname, &#x27;dll&#x27;), filename: &#x27;[name].js&#x27;, library: &#x27;[name]_[hash]&#x27; &#125;, plugins: &#123; // æ‰“åŒ…ç”Ÿæˆä¸€ä¸ªmanifest.jsonæ–‡ä»¶--&gt;æä¾›å’Œjqueryçš„æ˜ å°„ new webpack.DllPlugin(&#123; name: &#x27;[name]_[hash]&#x27;, // æ˜ å°„åº“çš„æš´éœ²çš„å†…å®¹çš„åç§° path: path.join(__dirname, &#x27;dll/manifest.json&#x27;) // è¾“å‡ºæ–‡ä»¶è·¯å¾„ &#125;) &#125;&#125;; */// å¤ç”¨cssloaderconst commonCssLoader = [ // &#x27;style-loader&#x27;, // åˆ›å»ºstyleæ ‡ç­¾ï¼Œå°†jsä¸­çš„æ ·å¼èµ„æºè¿›è¡Œæ’å…¥ï¼Œæ·»åŠ åˆ°headä¸­ç”Ÿæ•ˆ MiniCssExtractPlugin.loader, // æ›¿æ¢&#x27;style-loader&#x27;ï¼Œæå–jsä¸­çš„cssæˆå•ç‹¬æ–‡ä»¶ &quot;css-loader&quot;, // å°†cssæ–‡ä»¶å˜æˆcommonjsæ¨¡å—åŠ è½½åˆ°jsä¸­ï¼Œé‡Œé¢å†…å®¹æ˜¯æ ·å¼å­—ç¬¦ä¸² &#123; /**è¿˜éœ€è¦å†package.jsonè¿™ä¸¤å¹´ä¸ªå®šä¹‰ browserslist * &quot;browserslist&quot;: &#123; * &quot;development&quot;: [ * &quot;last 1 chrome version&quot;, * &quot;last 1 firefox version&quot;, * &quot;last 1 safari version&quot;, * ], * &quot;production&quot;: [ * &quot;&gt;0.2%&quot;, * &quot;not dead&quot;, * &quot;not op_mini all&quot; * ] * &#125; * */ loader: &quot;postcss-loader&quot;, options: &#123; ident: &quot;postcss&quot;, plugins: () =&gt; &#123; require(&quot;postcss-preset-env&quot;)(); &#125;, &#125;, &#125;,];module.exports = &#123; // å…¥å£èµ·ç‚¹ entry: path.join(__dirname, &quot;src/index.js&quot;), // å•å…¥å£ // entry: &#123; // å¤šå…¥å£ï¼šå‡ ä¸ªå…¥å£å°±æœ‰å‡ ä¸ªbundle // app: path.join(__dirname, &#x27;src/index.js&#x27;), // &#125;, // è¾“å‡º output: &#123; // è¾“å‡ºæ–‡ä»¶ç›®å½• path: path.join(__dirname, &quot;dist&quot;), // æ–‡ä»¶åç§° filename: &quot;js/[name].[contenthash:10].js&quot;, // æ‰€æœ‰èµ„æºå¼•å…¥å…¬å…±è·¯å¾„å‰ç¼€--&gt; ç”¨äºç”Ÿäº§ç¯å¢ƒ publicPath: &quot;/&quot;, chunkFilename: &quot;js/[name].[contenthash:10]_chunk.js&quot;, // éå…¥å£chunkçš„åç§° library: &quot;[name]&quot;, // æ•´ä¸ªåº“å‘å¤–æš´éœ²çš„å˜é‡å libraryTarget: &quot;window&quot;, // å˜é‡åæ·»åŠ åˆ°å“ªä¸€ä¸ªä¸Š browser; &#x27;global&#x27;(node)/&#x27;commonjs&#x27; &#125;, /** * ä»£ç åˆ†å‰²ï¼šchunkè¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶ chunkè¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶ * 1. å°†node_modulesä¸­çš„ä»£ç å•ç‹¬æ‰“åŒ…æˆä¸€ä¸ªchunkæœ€ç»ˆè¾“å‡º * 2. è‡ªåŠ¨åˆ†æå¤šå…¥å£chunkä¸­ï¼Œæœ‰æ²¡æœ‰å…¬å…±çš„æ–‡ä»¶ï¼Œå¦‚æœæœ‰ä¼šæ‰“åŒ…æˆå•ç‹¬çš„ä¸€ä¸ªchunk */ optimization: &#123; // é…ç½®ç”Ÿäº§ç¯å¢ƒçš„ minimizer: [ // é…ç½®ç”Ÿäº§ç¯å¢ƒçš„å‹ç¼©æ–¹æ¡ˆï¼šjså’Œcss new TerserWebpackPlugin(&#123; cache: true, // å¼€å¯ç¼“å­˜ parallel: true, // å¼€å¯å¤šè¿›ç¨‹æ‰“åŒ… sourceMap: true, &#125;), ], // ä¸€å®šè¦åŠ : å°†å½“å‰æ¨¡å—çš„è®°å½•å…¶ä»–æ¨¡å—çš„hashå•ç‹¬æ‰“åŒ…æˆä¸ºä¸€ä¸ªruntime // è§£å†³ï¼šä¿®æ”¹aæ–‡ä»¶å¯¼è‡´bæ–‡ä»¶çš„contenthashå˜åŒ– runtimeChunk: &#123; name: entrypoint =&gt; `runtime-$&#123;entrypoint.name&#125;`, &#125;, splitChunks: &#123; chunks: &quot;all&quot;, minSize: 30 * 1024, // åˆ†å‰²çš„chunkæœ€å°ä¸º30kbï¼Œå°äº30kbä¸æå– maxSize: 0, // æ— æœ€å¤§çš„é™åˆ¶ minChunks: 1, // è¦æå–çš„chunkæœ€å°‘è¢«å¼•ç”¨ä¸€æ¬¡ maxAsyncRequests: 5, // æŒ‰éœ€åŠ è½½æ—¶å¹¶è¡ŒåŠ è½½çš„æ–‡ä»¶çš„æœ€å¤§æ•°é‡ maxInitialRequests: 3, // å…¥å£jsæ–‡ä»¶æœ€å¤§å¹¶è¡Œè¯·æ±‚æ•°é‡ automaticNameDelimiter: &quot;~&quot;, // åç§°è¿æ¥ç¬¦ name: true, // å¯ä»¥ä½¿ç”¨å‘½åè§„åˆ™ cacheGroups: &#123; // åˆ†å‰²chunkçš„ç»„ // node_modulesæ–‡ä»¶ä¼šè¢«æ‰“åŒ…åˆ°vendorsç»„çš„chunkä¸­ // æ»¡è¶³ä¸Šé¢çš„å…¬å…±è§„åˆ™ vendors: &#123; test: /[\\\\/]node_modules[\\\\/]/, priority: -10, // ä¼˜å…ˆçº§ &#125;, default: &#123; minChunks: 2, // è¦æå–çš„chunkè‡³å°‘è¢«å¼•ç”¨2æ¬¡ prority: -20, reuseExistingChunk: true, // å¦‚æœå½“å‰è¦æ‰“åŒ…çš„æ¨¡å—å’Œä¹‹å‰å·²ç»è¢«æå–çš„æ¨¡å—æ˜¯ç”¨ä¸€ä¸ªå°±ä¼šå¤ç”¨ï¼Œä¸ä¼šé‡æ–°æ‰“åŒ…æ¨¡å— &#125;, &#125;, &#125;, &#125;, externals: &#123; // ä½¿ç”¨CDN: æ‹’ç»jQueryè¢«æ‰“åŒ…è¿›æ¥ï¼ˆå¿½ç•¥çš„åº“åï¼ŒnpmåŒ…åï¼‰ï¼Œéœ€è¦æ‰‹åŠ¨å¼•å…¥è¿›æ¥ä½¿ç”¨CDNï¼Œé€Ÿåº¦æ›´å¿« // ä¸é€‚ç”¨CDNå¯ä»¥ä½¿ç”¨DLL jquery: &quot;jquery&quot;, &#125;, // è§£ææ¨¡å—çš„è§„åˆ™ resolve: &#123; // é…ç½®è§£ææ¨¡å—çš„è·¯å¾„åˆ«å: ç®€å†™è·¯å¾„ï¼Œç¼ºç‚¹æ˜¯è·¯å¾„æ²¡æœ‰æç¤º alias: &#123; $css: path.join(__dirname, &quot;src/css&quot;), &#125;, // é…ç½®çœç•¥æ–‡ä»¶è·¯å¾„çš„åç¼€å extensions: [&quot;.js&quot;, &quot;.json&quot;, &quot;.jsx&quot;], // å‘Šè¯‰webpack è§£ææ¨¡å—å»å“ªä¸ªç›®å½•æ‰¾ modules: [&quot;node_modules&quot;], &#125;, module: &#123; rules: [ &#123; /** è¯­æ³•æ£€æŸ¥ï¼š--&gt;eslint-loader eslint * åªæ£€æŸ¥æºä»£ç , è®¾ç½®æ£€æŸ¥è§„åˆ™package.json ä¸­çš„ eslintConfig * &quot;eslintConfig&quot;: &#123; * &quot;extends&quot;: &quot;airbnb-base&quot; * &#125; * airbnb--&gt; eslint eslint-config-airbnb-base eslint-plugin-import */ test: &quot;/.js$/&quot;, loader: &quot;eslint-loader&quot;, enforce: &quot;pre&quot;, // pre: ä¼˜å…ˆæ‰§è¡Œ; post: æ¨è¿Ÿæ‰§è¡Œ exculde: /node_modules/, // æ’é™¤ä¸€äº›æ–‡ä»¶ include: path.join(__dirname, &quot;src&quot;), // åªæ£€æŸ¥srcç›®å½•ä¸‹çš„ options: &#123; fix: true, &#125;, &#125;, // ä»¥ä¸‹loaderåªä¼šåŒ¹é…ä¸€ä¸ªï¼Œæ³¨æ„ä¸èƒ½æœ‰ä¸¤ä¸ªé…ç½®å¤„ç†åŒä¸€ç§ç±»å‹çš„æ–‡ä»¶ &#123; oneOf: [ &#123; /** jså…¼å®¹æ€§å¤„ç†ï¼š * 1. åŸºæœ¬jså…¼å®¹æ€§: --&gt; babel-loader @babel/core @babel/preset-env * é—®é¢˜ï¼šåªèƒ½è½¬æ¢åŸºæœ¬è¯­æ³•ï¼Œå¦‚promiseä¸èƒ½è½¬æ¢ * 2. å…¨éƒ¨jså…¼å®¹æ€§å¤„ç†ï¼š--&gt; @babel/polyfill * åœ¨index.js ä¸­ import &#x27;@babel/polyfill&#x27;æ—¢å¯ * é—®é¢˜ï¼šå°†æ‰€æœ‰å…¼å®¹æ€§ä»£ç å…¨éƒ¨å¼•å…¥ï¼Œä½“ç§¯å¤ªå¤§ * 3. éœ€è¦åšå…¼å®¹æ€§å¤„ç†çš„å°±åšï¼šæŒ‰éœ€åŠ è½½ --&gt; core-js * */ test: &quot;/.js$/&quot;, exclude: &quot;/node_modules/&quot;, use: [ &#123; loader: &quot;thread-loader&quot;, // å¼€å¯å¤šè¿›ç¨‹æ‰“åŒ… options: &#123; workers: 2, &#125;, &#125;, &#123; loader: &quot;babel-loader&quot;, options: &#123; // é¢„è®¾ï¼šæŒ‡ç¤ºbabelåšæ€ä¹ˆæ ·çš„å…¼å®¹æ€§å¤„ç† presets: [ &quot;@babel/preset-env&quot;, // æ–¹æ³•1 &#123; // æ–¹æ³•3-æŒ‰éœ€åŠ è½½ï¼ˆä¸èƒ½ä½¿ç”¨æ–¹æ³•2 @babel/polyfillï¼‰ useBuiltIns: &quot;usage&quot;, corejs: &#123; // æŒ‡å®šcore-jsç‰ˆæœ¬ version: 3, &#125;, // å…¼å®¹çš„æµè§ˆå™¨ç‰ˆæœ¬ targets: &#123; chrome: &quot;60&quot;, firefox: &quot;60&quot;, ie: &quot;9&quot;, safari: &quot;10&quot;, egde: &quot;17&quot;, &#125;, &#125;, ], // å¼€å¯babelç¼“å­˜ï¼Œç¬¬äºŒæ¬¡æ„å»ºæ—¶ä¼šè¯»å–ä¹‹å‰çš„ç¼“å­˜ cacheDirectory: true, &#125;, &#125;, ], &#125;, &#123; // å¤„ç†cssèµ„æº test: &quot;/.css$/&quot;, use: [ // useæ•°ç»„ä¸­loader æ‰§è¡Œé¡ºåºï¼šä»å³å‘å·¦ï¼Œä»ä¸‹å‘ä¸Šä¾æ¬¡æ‰§è¡Œ ...commonCssLoader, ], &#125;, &#123; // å¤„ç†lessèµ„æº test: &quot;/.less$/&quot;, use: [ // éœ€è¦ä¸‹è½½ --&gt; less-loader less ...commonCssLoader, &quot;less-loader&quot;, // å°†lessæ–‡ä»¶ç¼–è¯‘æˆcssæ–‡ä»¶ ], &#125;, &#123; // å¤„ç†å›¾ç‰‡èµ„æº test: /\\.(png|jpg|jpeg|gif|svg)$/, // é»˜è®¤å¤„ç†ä¸äº†htmlä¸­çš„imgå›¾ç‰‡ // ä¸‹è½½-- &gt; url-loader file-loader loader: &quot;url-loader&quot;, options: &#123; outputPath: &quot;img/&quot;, // å›¾ç‰‡è¾“å‡ºçš„è·¯å¾„ limit: 5 * 1024, // å›¾ç‰‡å¤§å°å°äº5kbï¼Œå°±ä¼šè¢«base64å¤„ç†ï¼Œä¼˜ç‚¹ï¼šå‡å°‘è¯·æ±‚æ•°é‡ï¼›ç¼ºç‚¹ï¼šå›¾ç‰‡ä½“ç§¯ä¼šæ›´å¤§ // url-loaderé»˜è®¤ä½¿ç”¨es6æ¨¡å—åŒ–è§£æï¼Œhtml-loaderå¼•å…¥å›¾ç‰‡æ˜¯commonjsï¼Œè§£æä¼šå‡ºé—®é¢˜ esModule: false, &#125;, &#125;, &#123; test: &quot;/.html$/&quot;, // å¤„ç†htmlä¸­çš„umgå›¾ç‰‡ï¼ˆè´Ÿè´£å¼•å…¥imgï¼Œä»è€Œè¢«url-loaderå¤„ç†ï¼‰ // ä¸‹è½½ --&gt; html-loader loader: &quot;html-loader&quot;, &#125;, &#123; // æ‰“åŒ…å…¶ä»–èµ„æºï¼ˆé™¤äº†html/js/cssä»¥å¤–èµ„æº) exclude: /\\.(css|js|html|less)$/, loader: &quot;file-loader&quot;, options: &#123; name: &quot;[name].[contenthash:10].[ext]&quot;, &#125;, &#125;, ], &#125;, ], &#125;, plugins: [ // é»˜è®¤åˆ›å»ºç©ºçš„HTMLï¼Œè‡ªåŠ¨å¼•å…¥æ‰“åŒ…è¾“å‡ºçš„æ‰€æœ‰èµ„æº new HtmlWebpackPlugin(&#123; // å¤åˆ¶templateçš„htmlæ–‡ä»¶ï¼Œè‡ªåŠ¨å¼•å…¥æ‰“åŒ…è¾“å‡ºçš„æ‰€æœ‰èµ„æº template: &quot;src/index.html&quot;, // htmlå‹ç¼© minify: &#123; collapseWhitespace: true, // ç§»é™¤ç©ºæ ¼ removeComments: true, //ç§»é™¤æ³¨é‡Š &#125;, &#125;), // cssæå–æˆå•ç‹¬æ–‡ä»¶ new MiniCssExtractPlugin(&#123; filename: &quot;css/[name].[contenthash:10].css&quot;, &#125;), // å‹ç¼©css new OptimizeCssAssetsPlugin(), new WorkboxWebpackPlugin(&#123; /** * 1. å¸®åŠ©serviceworkerå¿«é€Ÿå¯åŠ¨ * 2. åˆ é™¤æ—§çš„ serviceworker * ç”Ÿäº§ä¸€ä¸ªserviceworkeré…ç½®æ–‡ä»¶ */ clientClaim: true, skipWaiting: true, &#125;), // å‘Šè¯‰webpack å“ªäº›åº“ä¸å‚ä¸æ‰“åŒ…, åŒæ—¶ä½¿ç”¨æ—¶çš„åç§°ä¹Ÿå¾—æ”¹å˜ new webpack.DllReferencePlugin(&#123; manifest: path.join(__dirname, &quot;dll/manifest.json&quot;), &#125;), // å°†æŸä¸ªæ–‡ä»¶æ‰“åŒ…è¾“å‡ºå‡ºå»ï¼Œå¹¶åœ¨htmlä¸­è‡ªåŠ¨å¼•å…¥è¯¥èµ„æº new AddAssetHtmlWebpackPlugin(&#123; filename: path.join(__dirname, &quot;dll/jquery.js&quot;), &#125;), ], mode: &quot;development&quot;, // &#x27;production&#x27;, // ç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨å‹ç¼©jsä»£ç  devServer: &#123; // å¼€å‘æœåŠ¡å™¨ï¼šè‡ªåŠ¨åŒ–ç¼–è¯‘ï¼Œè‡ªåŠ¨åŒ–åˆ·æ–°æµè§ˆå™¨ç­‰ contentBase: path.join(__dirname, &quot;dist&quot;), watchContentBase: true, // æ£€è§†contentBaseç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¸€ç‚¹æ–‡ä»¶å˜åŒ–å°±reload watchOptions: &#123; // å¿½ç•¥ç›‘è§†æ–‡ä»¶ ignored: /node_modules/, &#125;, compress: true, // å¯åŠ¨gzipå‹ç¼© port: 3000, // æŒ‡å®šç«¯å£å· host: &quot;0.0.0.0&quot;, // æŒ‡å®šåŸŸå localhost open: true, hot: true, // çƒ­æ›¿æ¢ å¼€å¯HMRåŠŸèƒ½ stats: &#123; colors: true &#125;, clientLogLevel: &quot;none&quot;, // ä¸è¦æ˜¾ç¤ºå¯åŠ¨æœåŠ¡å™¨æ—¥å¿—ä¿¡æ¯ quiet: true, // é™¤ä¸€äº›åŸºæœ¬å¯åŠ¨ä¿¡æ¯ä»¥å¤–ï¼Œå…¶ä»–å†…å®¹ä¸è¦å±•ç¤º overlay: false, //å¦‚æœå‡ºé”™ä¸è¦å…¨å±æç¤º // æœåŠ¡å™¨ä»£ç†ï¼Œè§£å†³å¼€å‘ç¯å¢ƒçš„è·¨åŸŸé—®é¢˜ prxoy: &#123; // ä¸€æ—¦æ¥å—åˆ°/api/xxx ç©·å¥‡å°±ä¼šè½¬å‘åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨3000 &quot;/api&quot;: &#123; target: &quot;http://localhost:3000&quot;, // å‘ç”Ÿè¯·æ±‚æ—¶ï¼Œè¯·æ±‚è·¯å¾„é‡å†™ï¼Œå»æ‰api pathRewrite: &#123; &quot;^api&quot;: &quot;&quot;, &#125;, &#125;, &#125;, &#125;, devtool: &quot;source-map&quot;, // &#x27;eval-source-map&#x27;&#125;; å‚è€ƒå…³äº webpack çš„é¢è¯•é¢˜","updated":"2025-08-02T05:46:04.178Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"ReDosæ”»å‡»","date":"2021-10-25T09:52:43.000Z","path":"2021/10/25/2021-10-25-ReDos/","text":"ReDoS åŸç†æ¦‚è¿°DFAå¯¹äºæ–‡æœ¬ä¸²é‡Œçš„æ¯ä¸€ä¸ªå­—ç¬¦åªéœ€æ‰«æä¸€æ¬¡ï¼Œæ¯”è¾ƒå¿«ï¼Œä½†ç‰¹æ€§è¾ƒå°‘ï¼›NFAè¦ç¿»æ¥è¦†å»åƒå­—ç¬¦ã€åå­—ç¬¦ï¼Œé€Ÿåº¦æ…¢ï¼Œä½†æ˜¯ç‰¹æ€§(å¦‚:åˆ†ç»„ã€æ›¿æ¢ã€åˆ†å‰²)ä¸°å¯Œã€‚NFAæ”¯æŒ æƒ°æ€§(lazy)ã€å›æº¯(backtracking)ã€åå‘å¼•ç”¨(backreference)ï¼ŒNFAç¼ºçœåº”ç”¨greedyæ¨¡å¼ï¼ŒNFAå¯èƒ½ä¼šé™·å…¥é€’å½’é™©å¢ƒå¯¼è‡´æ€§èƒ½æå·®ã€‚ è¯´æ˜æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼^(a+)+$æ¥å¯¹å­—ç¬¦ä¸²aaaaXåŒ¹é…ã€‚ä½¿ç”¨NFAçš„æ­£åˆ™å¼•æ“ï¼Œå¿…é¡»ç»å†2^4=16æ¬¡å°è¯•å¤±è´¥åæ‰èƒ½å¦å®šè¿™ä¸ªåŒ¹é…ã€‚åŒç†å­—ç¬¦ä¸²ä¸ºaaaaaaaaaaXå°±è¦ç»å†2^10=1024æ¬¡å°è¯•ã€‚å¦‚æœæˆ‘ä»¬ç»§ç»­å¢åŠ açš„ä¸ªæ•°ä¸º 20 ä¸ªã€30 ä¸ªæˆ–è€…æ›´å¤šï¼Œé‚£ä¹ˆè¿™é‡Œçš„åŒ¹é…ä¼šå˜æˆæŒ‡æ•°å¢é•¿ã€‚ ä¸‹é¢æˆ‘ä»¬ä»¥pythonè¯­è¨€ä¸ºä¾‹å­æ¥è¿›è¡Œä»£ç çš„æ¼”ç¤º: #!/usr/bin/env python# coding: utf-8import reimport timedef exp(target_str): &quot;&quot;&quot; &quot;&quot;&quot; s1 = time.time() flaw_regex = re.compile(&#x27;^(a+)+$&#x27;) flaw_regex.match(target_str) s2 = time.time() print(&quot;Consuming time: %.4f&quot; % (s2-s1))if __name__ == &#x27;__main__&#x27;: str_list = ( &#x27;aaaaaaaaaaaaaaaaX&#x27;, # 2^16 &#x27;aaaaaaaaaaaaaaaaaaX&#x27;, # 2^18 &#x27;aaaaaaaaaaaaaaaaaaaaX&#x27;, # 2^20 &#x27;aaaaaaaaaaaaaaaaaaaaaaX&#x27;, # 2^22 &#x27;aaaaaaaaaaaaaaaaaaaaaaaaX&#x27;, # 2^24 &#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaX&#x27;, # 2^26 &#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaX&#x27;, # 2^36 ) for evil_str in str_list: print(&#x27;Current: %s&#x27; % evil_str) exp(evil_str) print(&#x27;--&#x27;*40) æŠŠä¸Šé¢çš„ä»£ç ä¿å­˜æˆredos.pyæ–‡ä»¶å¹¶æ‰§è¡Œè¿™ä¸ª py è„šæœ¬æ–‡ä»¶: $ python redos.pyCurrent: aaaaaaaaaaaaaaaaXConsuming time: 0.0043--------------------------------------------------------------------------------Current: aaaaaaaaaaaaaaaaaaXConsuming time: 0.0175--------------------------------------------------------------------------------Current: aaaaaaaaaaaaaaaaaaaaXConsuming time: 0.0678--------------------------------------------------------------------------------Current: aaaaaaaaaaaaaaaaaaaaaaXConsuming time: 0.2370--------------------------------------------------------------------------------Current: aaaaaaaaaaaaaaaaaaaaaaaaXConsuming time: 0.9842--------------------------------------------------------------------------------Current: aaaaaaaaaaaaaaaaaaaaaaaaaaXConsuming time: 4.1069--------------------------------------------------------------------------------Current: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaX è¾“å‡ºåˆ°æœ€åä¸€è¡Œè²Œä¼¼ç¨‹åºå¡ä½äº† æ€»ç»“æ¯ä¸ªæ¶æ„çš„æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åº”è¯¥åŒ…å«ï¼š ä½¿ç”¨é‡å¤åˆ†ç»„æ„é€  åœ¨é‡å¤ç»„å†…ä¼šå‡ºç° é‡å¤ äº¤æ›¿é‡å  æœ‰ç¼ºé™·çš„æ­£åˆ™è¡¨è¾¾å¼ä¼šåŒ…å«å¦‚ä¸‹éƒ¨åˆ†ï¼š (a+)+ ([a-zA-Z]+)* (a|aa)+ (a|a?)+ (.*a)&#123;x&#125; | for x &gt; 10 æ³¨æ„: è¿™é‡Œçš„aæ˜¯ä¸ªæ³›æŒ‡ å®ä¾‹ä¸‹é¢æˆ‘ä»¬æ¥å±•ç¤ºä¸€äº›å®é™…ä¸šåŠ¡åœºæ™¯ä¸­ä¼šç”¨åˆ°çš„ç¼ºé™·æ­£åˆ™ã€‚ è‹±æ–‡çš„ä¸ªäººåå­—: Regex: ^[a-zA-Z]+(([\\&#39;\\,\\.\\-][a-zA-Z ])?[a-zA-Z]*)*$ Payload: aaaaaaaaaaaaaaaaaaaaaaaaaaaa! Java Classname Regex: ^(([a-z])+.)+[A-Z]([a-z])+$ Payload: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa! Email æ ¼å¼éªŒè¯ Regex: ^([0-9a-zA-Z]([-.\\w]*[0-9a-zA-Z])*@(([0-9a-zA-Z])+([-\\w]*[0-9a-zA-Z])*\\.)+[a-zA-Z]&#123;2,9&#125;)$ Payload: a@aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa! å¤šä¸ªé‚®ç®±åœ°å€éªŒè¯ Regex: ^[a-zA-Z]+(([\\&#39;\\,\\.\\-][a-zA-Z ])?[a-zA-Z]*)*\\s+&amp;lt;(\\w[-._\\w]*\\w@\\w[-._\\w]*\\w\\.\\w&#123;2,3&#125;)&amp;gt;$|^(\\w[-._\\w]*\\w@\\w[-._\\w]*\\w\\.\\w&#123;2,3&#125;)$ Payload: aaaaaaaaaaaaaaaaaaaaaaaa! å¤æ•°éªŒè¯ Regex: ^\\d*[0-9](|.\\d*[0-9]|)*$ Payload: 1111111111111111111111111! æ¨¡å¼åŒ¹é… Regex: ^([a-z0-9]+([\\-a-z0-9]*[a-z0-9]+)?\\.)&#123;0,&#125;([a-z0-9]+([\\-a-z0-9]*[a-z0-9]+)?)&#123;1,63&#125;(\\.[a-z0-9]&#123;2,7&#125;)+$ Payload: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa! ä½¿ç”¨pythonæ¥è¿›è¡Œæµ‹è¯•æœ‰ç¼ºé™·çš„æ­£åˆ™ç¤ºä¾‹: $ python -c &quot;import re;re.match(&#39;^[a-zA-Z]+(([\\&#39;\\,\\.\\-][a-zA-Z ])?[a-zA-Z]*)*$&#39;, &#39;aaaaaaaaaaaaaaaaaaaaaaaaaaaa!&#39;)&quot; ReDoS é˜²èŒƒå“ªé‡Œä¼šç”¨åˆ°Regex, å‡ ä¹åœ¨æˆ‘ä»¬çš„ç½‘ç»œç¨‹åºä¸è®¾å¤‡èµ„æºçš„ä»»ä½•ä½ç½®éƒ½ä¼šç”¨åˆ°ã€‚å¦‚: WAFã€Webå‰ç«¯ã€Webåç«¯ã€DBæ•°æ®åº“ç­‰ã€‚ å¸¸è§ä½ç½®å®¢æˆ·ç«¯ æµè§ˆå™¨ ç§»åŠ¨è®¾å¤‡ æœåŠ¡å™¨ç«¯ é˜²èŒƒæ‰‹æ®µé˜²èŒƒæ‰‹æ®µåªæ˜¯ä¸ºäº†é™ä½é£é™©è€Œä¸èƒ½ç™¾åˆ†ç™¾æ¶ˆé™¤ ReDoS è¿™ç§å¨èƒã€‚å½“ç„¶ä¸ºäº†é¿å…è¿™ç§å¨èƒçš„æœ€å¥½æ‰‹æ®µæ˜¯å°½é‡å‡å°‘æ­£åˆ™åœ¨ä¸šåŠ¡ä¸­çš„ä½¿ç”¨åœºæ™¯æˆ–è€…å¤šåšæµ‹è¯•, å¢åŠ æœåŠ¡å™¨çš„æ€§èƒ½ç›‘æ§ç­‰ã€‚ é™ä½æ­£åˆ™è¡¨è¾¾å¼çš„å¤æ‚åº¦, å°½é‡å°‘ç”¨åˆ†ç»„ ä¸¥æ ¼é™åˆ¶ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²é•¿åº¦(ç‰¹å®šæƒ…å†µä¸‹) ä½¿ç”¨å•å…ƒæµ‹è¯•ã€fuzzing æµ‹è¯•ä¿è¯å®‰å…¨ ä½¿ç”¨é™æ€ä»£ç åˆ†æå·¥å…·, å¦‚: sonar æ·»åŠ æœåŠ¡å™¨æ€§èƒ½ç›‘æ§ç³»ç»Ÿ, å¦‚: zabbix å‚è€ƒæµ…æ ReDoSå‰ç«¯ ReDOS æ”»å‡»","updated":"2025-08-02T05:46:04.178Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"regex","slug":"regex","permalink":"https://luckyship.github.io/tags/regex/"}]},{"title":"commonJSã€AMDã€CMDã€UMDã€ES6 module","date":"2021-10-25T08:04:18.000Z","path":"2021/10/25/2021-10-25-moudle/","text":"commonJS ç‰¹ç‚¹ï¼š 1ã€æ¨¡å—å¯ä»¥å¤šæ¬¡åŠ è½½ï¼Œä½†æ˜¯åªä¼šåœ¨ç¬¬ä¸€æ¬¡åŠ è½½æ—¶è¿è¡Œä¸€æ¬¡ï¼Œç„¶åè¿è¡Œç»“æœå°±è¢«ç¼“å­˜äº†ï¼Œä»¥åå†åŠ è½½ï¼Œå°±ç›´æ¥è¯»å–ç¼“å­˜ç»“æœã€‚è¦æƒ³è®©æ¨¡å—å†æ¬¡è¿è¡Œï¼Œå¿…é¡»æ¸…é™¤ç¼“å­˜ã€‚2ã€æ¨¡å—åŠ è½½ä¼šé˜»å¡æ¥ä¸‹æ¥ä»£ç çš„æ‰§è¡Œï¼Œéœ€è¦ç­‰åˆ°æ¨¡å—åŠ è½½å®Œæˆæ‰èƒ½ç»§ç»­æ‰§è¡Œâ€”â€”åŒæ­¥åŠ è½½ã€‚ ç¯å¢ƒï¼šæœåŠ¡å™¨ç¯å¢ƒ åº”ç”¨ï¼šnodejs çš„æ¨¡å—è§„èŒƒæ˜¯å‚ç…§ commonJS å®ç°çš„ã€‚ è¯­æ³•ï¼š 1ã€å¯¼å…¥ï¼šrequire(â€˜è·¯å¾„â€™)2ã€å¯¼å‡ºï¼šmodule.exports å’Œ exports æ³¨æ„ï¼šmodule.exports å’Œ exports çš„çš„åŒºåˆ«æ˜¯ exports åªæ˜¯å¯¹ module.exports çš„ä¸€ä¸ªå¼•ç”¨ï¼Œç›¸å½“äº Node ä¸ºæ¯ä¸ªæ¨¡å—æä¾›ä¸€ä¸ª exports å˜é‡ï¼ŒæŒ‡å‘ module.exportsã€‚è¿™ç­‰åŒåœ¨æ¯ä¸ªæ¨¡å—å¤´éƒ¨ï¼Œæœ‰ä¸€è¡Œvar exports = module.exports;è¿™æ ·çš„å‘½ä»¤ã€‚ demo // a.js// ç›¸å½“äºè¿™é‡Œè¿˜æœ‰ä¸€è¡Œï¼švar exports = module.exports;ä»£ç exports.a = &#x27;Hello world&#x27;; // ç›¸å½“äºï¼šmodule.exports.a = &#x27;Hello world&#x27;;// b.jsvar moduleA = require(&#x27;./a.js&#x27;);console.log(moduleA.a); // æ‰“å°å‡ºhello world AMD ç‰¹ç‚¹ï¼š 1ã€å¼‚æ­¥åŠ è½½2ã€ç®¡ç†æ¨¡å—ä¹‹é—´çš„ä¾èµ–æ€§ï¼Œä¾¿äºä»£ç çš„ç¼–å†™å’Œç»´æŠ¤ã€‚ ç¯å¢ƒï¼šæµè§ˆå™¨ç¯å¢ƒ åº”ç”¨ï¼šrequireJS æ˜¯å‚ç…§ AMD è§„èŒƒå®ç°çš„ è¯­æ³•ï¼š 1ã€å¯¼å…¥ï¼šrequire([â€˜æ¨¡å—åç§°â€™], function (â€˜æ¨¡å—å˜é‡å¼•ç”¨â€™){// ä»£ç });3ã€å¯¼å‡ºï¼šdefine(function (){return â€˜å€¼â€™); demo // a.jsdefine(function () &#123; return &#123; a: &#x27;hello world&#x27;, &#125;;&#125;);// b.jsrequire([&#x27;./a.js&#x27;], function (moduleA) &#123; console.log(moduleA.a); // æ‰“å°å‡ºï¼šhello world&#125;); CMD ç‰¹ç‚¹ 1ã€CMD æ˜¯åœ¨ AMD åŸºç¡€ä¸Šæ”¹è¿›çš„ä¸€ç§è§„èŒƒï¼Œå’Œ AMD ä¸åŒåœ¨äºå¯¹ä¾èµ–æ¨¡å—çš„æ‰§è¡Œæ—¶æœºå¤„ç†ä¸åŒï¼ŒCMD æ˜¯å°±è¿‘ä¾èµ–ï¼Œè€Œ AMD æ˜¯å‰ç½®ä¾èµ–ã€‚ ç¯å¢ƒï¼šæµè§ˆå™¨ç¯å¢ƒ åº”ç”¨ï¼šseajs æ˜¯å‚ç…§ UMD è§„èŒƒå®ç°çš„ï¼ŒrequireJS çš„æœ€æ–°çš„å‡ ä¸ªç‰ˆæœ¬ä¹Ÿæ˜¯éƒ¨åˆ†å‚ç…§äº† UMD è§„èŒƒçš„å®ç° è¯­æ³•ï¼š 1ã€å¯¼å…¥ï¼šdefine(function(require, exports, module) {});2ã€å¯¼å‡ºï¼šdefine(function (){return â€˜å€¼â€™); demo // a.jsdefine(function (require, exports, module) &#123; exports.a = &#x27;hello world&#x27;;&#125;);// b.jsdefine(function (require, exports, module) &#123; var moduleA = require(&#x27;./a.js&#x27;); console.log(moduleA.a); // æ‰“å°å‡ºï¼šhello world&#125;); UMD ç‰¹ç‚¹ï¼š 1ã€å…¼å®¹ AMD å’Œ commonJS è§„èŒƒçš„åŒæ—¶ï¼Œè¿˜å…¼å®¹å…¨å±€å¼•ç”¨çš„æ–¹å¼ ç¯å¢ƒï¼šæµè§ˆå™¨æˆ–æœåŠ¡å™¨ç¯å¢ƒ åº”ç”¨ï¼šæ—  è¯­æ³•ï¼š 1ã€æ— å¯¼å…¥å¯¼å‡ºè§„èŒƒï¼Œåªæœ‰å¦‚ä¸‹çš„ä¸€ä¸ªå¸¸è§„å†™æ³•ï¼š å¸¸è§„å†™æ³•ï¼š (function (root, factory) &#123;if (typeof define === &#x27;function&#x27; &amp;&amp; define.amd) &#123;//AMDdefine([&#x27;jquery&#x27;], factory);&#125; else if (typeof exports === &#x27;object&#x27;) &#123;//Node, CommonJS ä¹‹ç±»çš„module.exports = factory(require(&#x27;jquery&#x27;));&#125; else &#123;//æµè§ˆå™¨å…¨å±€å˜é‡(root å³ window)root.returnExports = factory(root.jQuery);&#125;&#125;(this, function ($) &#123;//æ–¹æ³•function myFunc()&#123;&#125;;//æš´éœ²å…¬å…±æ–¹æ³•return myFunc;&#125;)); ES6 module ç‰¹ç‚¹ï¼š 1ã€æŒ‰éœ€åŠ è½½ï¼ˆç¼–è¯‘æ—¶åŠ è½½ï¼‰2ã€import å’Œ export å‘½ä»¤åªèƒ½åœ¨æ¨¡å—çš„é¡¶å±‚ï¼Œä¸èƒ½åœ¨ä»£ç å—ä¹‹ä¸­ï¼ˆå¦‚ï¼šif è¯­å¥ä¸­ï¼‰,import()è¯­å¥å¯ä»¥åœ¨ä»£ç å—ä¸­å®ç°å¼‚æ­¥åŠ¨æ€æŒ‰éœ€åŠ¨æ€åŠ è½½ ç¯å¢ƒï¼šæµè§ˆå™¨æˆ–æœåŠ¡å™¨ç¯å¢ƒï¼ˆä»¥åå¯èƒ½æ”¯æŒï¼‰ åº”ç”¨ï¼šES6 çš„æœ€æ–°è¯­æ³•æ”¯æŒè§„èŒƒ è¯­æ³•ï¼š 1ã€å¯¼å…¥ï¼šimport {æ¨¡å—å Aï¼Œæ¨¡å—å Bâ€¦} from â€˜æ¨¡å—è·¯å¾„â€™2ã€å¯¼å‡ºï¼šexport å’Œ export default3ã€import(â€˜æ¨¡å—è·¯å¾„â€™).then()æ–¹æ³• æ³¨æ„ï¼šexport åªæ”¯æŒå¯¹è±¡å½¢å¼å¯¼å‡ºï¼Œä¸æ”¯æŒå€¼çš„å¯¼å‡ºï¼Œexport default å‘½ä»¤ç”¨äºæŒ‡å®šæ¨¡å—çš„é»˜è®¤è¾“å‡ºï¼Œåªæ”¯æŒå€¼å¯¼å‡ºï¼Œä½†æ˜¯åªèƒ½æŒ‡å®šä¸€ä¸ªï¼Œæœ¬è´¨ä¸Šå®ƒå°±æ˜¯è¾“å‡ºä¸€ä¸ªå«åš default çš„å˜é‡æˆ–æ–¹æ³•ã€‚ è§„èŒƒï¼š /*é”™è¯¯çš„å†™æ³•*/// å†™æ³•ä¸€export 1;// å†™æ³•äºŒvar m = 1;export m;// å†™æ³•ä¸‰if (x === 2) &#123;import MyModual from &#x27;./myModual&#x27;;&#125;/*æ­£ç¡®çš„ä¸‰ç§å†™æ³•*/// å†™æ³•ä¸€export var m = 1;// å†™æ³•äºŒvar m = 1;export &#123;m&#125;;// å†™æ³•ä¸‰var n = 1;export &#123;n as m&#125;;// å†™æ³•å››var n = 1;export default n;// å†™æ³•äº”if (true) &#123;import(&#x27;./myModule.js&#x27;).then((&#123;export1, export2&#125;) =&gt; &#123;// ...Â·&#125;);&#125;// å†™æ³•å…­Promise.all([import(&#x27;./module1.js&#x27;),import(&#x27;./module2.js&#x27;),import(&#x27;./module3.js&#x27;),]).then(([module1, module2, module3]) =&gt; &#123;Â·Â·Â·&#125;); è½¬è½½JS æ¨¡å—è§„èŒƒï¼šAMDã€UMDã€CMDã€commonJSã€ES6 module","updated":"2025-08-02T05:46:04.178Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"httpå’Œhttps","date":"2021-10-16T08:26:06.000Z","path":"2021/10/16/2021-10-16-http-and-https/","text":"HTTP çš„ç‰¹ç‚¹å’Œç¼ºç‚¹ç‰¹ç‚¹ï¼šæ— è¿æ¥ã€æ— çŠ¶æ€ã€çµæ´»ã€ç®€å•å¿«é€Ÿ æ— è¿æ¥ï¼šæ¯ä¸€æ¬¡è¯·æ±‚éƒ½è¦è¿æ¥ä¸€æ¬¡ï¼Œè¯·æ±‚ç»“æŸå°±ä¼šæ–­æ‰ï¼Œä¸ä¼šä¿æŒè¿æ¥ æ— çŠ¶æ€ï¼šæ¯ä¸€æ¬¡è¯·æ±‚éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œè¯·æ±‚ç»“æŸä¸ä¼šè®°å½•è¿æ¥çš„ä»»ä½•ä¿¡æ¯(æèµ·è£¤å­å°±ä¸è®¤äººçš„æ„æ€)ï¼Œå‡å°‘äº†ç½‘ç»œå¼€é”€ï¼Œè¿™æ˜¯ä¼˜ç‚¹ä¹Ÿæ˜¯ç¼ºç‚¹ çµæ´»ï¼šé€šè¿‡ http åè®®ä¸­å¤´éƒ¨çš„Content-Typeæ ‡è®°ï¼Œå¯ä»¥ä¼ è¾“ä»»æ„æ•°æ®ç±»å‹çš„æ•°æ®å¯¹è±¡(æ–‡æœ¬ã€å›¾ç‰‡ã€è§†é¢‘ç­‰ç­‰)ï¼Œéå¸¸çµæ´» ç®€å•å¿«é€Ÿï¼šå‘é€è¯·æ±‚è®¿é—®æŸä¸ªèµ„æºæ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œ URL å°±å¯ä»¥äº†ï¼Œä½¿ç”¨ç®€å•ï¼Œæ­£ç”±äº http åè®®ç®€å•ï¼Œä½¿å¾— http æœåŠ¡å™¨çš„ç¨‹åºè§„æ¨¡å°ï¼Œå› è€Œé€šä¿¡é€Ÿåº¦å¾ˆå¿« ç¼ºç‚¹ï¼šæ— çŠ¶æ€ã€ä¸å®‰å…¨ã€æ˜æ–‡ä¼ è¾“ã€é˜Ÿå¤´é˜»å¡ æ— çŠ¶æ€ï¼šè¯·æ±‚ä¸ä¼šè®°å½•ä»»ä½•è¿æ¥ä¿¡æ¯ï¼Œæ²¡æœ‰è®°å¿†ï¼Œå°±æ— æ³•åŒºåˆ†å¤šä¸ªè¯·æ±‚å‘èµ·è€…èº«ä»½æ˜¯ä¸æ˜¯åŒä¸€ä¸ªå®¢æˆ·ç«¯çš„ï¼Œæ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ ä¸å®‰å…¨ï¼šæ˜æ–‡ä¼ è¾“å¯èƒ½è¢«çªƒå¬ä¸å®‰å…¨ï¼Œç¼ºå°‘èº«ä»½è®¤è¯ä¹Ÿå¯èƒ½é­é‡ä¼ªè£…ï¼Œè¿˜æœ‰ç¼ºå°‘æŠ¥æ–‡å®Œæ•´æ€§éªŒè¯å¯èƒ½é­åˆ°ç¯¡æ”¹ æ˜æ–‡ä¼ è¾“ï¼šæŠ¥æ–‡(header éƒ¨åˆ†)ä½¿ç”¨çš„æ˜¯æ˜æ–‡ï¼Œç›´æ¥å°†ä¿¡æ¯æš´éœ²ç»™äº†å¤–ç•Œï¼ŒWIFIé™·é˜±å°±æ˜¯å¤ç”¨æ˜æ–‡ä¼ è¾“çš„ç‰¹ç‚¹ï¼Œè¯±å¯¼ä½ è¿ä¸Šçƒ­ç‚¹ï¼Œç„¶åç–¯ç‹‚æŠ“å–ä½ çš„æµé‡ï¼Œä»è€Œæ‹¿åˆ°ä½ çš„æ•æ„Ÿä¿¡æ¯ é˜Ÿå¤´é˜»å¡ï¼šå¼€å¯é•¿è¿æ¥(ä¸‹é¢æœ‰è®²)æ—¶ï¼Œåªå»ºç«‹ä¸€ä¸ª TCP è¿æ¥ï¼ŒåŒä¸€æ—¶åˆ»åªèƒ½å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œé‚£ä¹ˆå½“è¯·æ±‚è€—æ—¶è¿‡é•¿æ—¶ï¼Œå…¶ä»–è¯·æ±‚å°±åªèƒ½é˜»å¡çŠ¶æ€(å¦‚ä½•è§£å†³ä¸‹é¢æœ‰è®²) HTTP æŠ¥æ–‡ç»„æˆéƒ¨åˆ†http æŠ¥æ–‡ï¼šç”±è¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡ç»„æˆ è¯·æ±‚æŠ¥æ–‡ï¼šç”±è¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€ç©ºè¡Œã€è¯·æ±‚ä½“å››éƒ¨åˆ†ç»„æˆ å“åº”æŠ¥æ–‡ï¼šç”±çŠ¶æ€è¡Œã€å“åº”å¤´ã€ç©ºè¡Œã€å“åº”ä½“å››éƒ¨åˆ†ç»„æˆ è¯·æ±‚è¡Œï¼šåŒ…å« http æ–¹æ³•ï¼Œè¯·æ±‚åœ°å€ï¼Œhttp åè®®ä»¥åŠç‰ˆæœ¬ è¯·æ±‚å¤´/å“åº”å¤´ï¼šå°±æ˜¯ä¸€äº› key:value æ¥å‘Šè¯‰æœåŠ¡ç«¯æˆ‘è¦å“ªäº›å†…å®¹ï¼Œè¦æ³¨æ„ä»€ä¹ˆç±»å‹ç­‰ï¼Œè¯·æ±‚å¤´/å“åº”å¤´æ¯ä¸€ä¸ªå­—æ®µè¯¦è§£ ç©ºè¡Œï¼šç”¨æ¥åŒºåˆ†é¦–éƒ¨ä¸å®ä½“ï¼Œå› ä¸ºè¯·æ±‚å¤´éƒ½æ˜¯ key:value çš„æ ¼å¼ï¼Œå½“è§£æé‡åˆ°ç©ºè¡Œæ—¶ï¼ŒæœåŠ¡ç«¯å°±çŸ¥é“ä¸‹ä¸€ä¸ªä¸å†æ˜¯è¯·æ±‚å¤´éƒ¨åˆ†ï¼Œå°±è¯¥å½“ä½œè¯·æ±‚ä½“æ¥è§£æäº† è¯·æ±‚ä½“ï¼šè¯·æ±‚çš„å‚æ•° çŠ¶æ€è¡Œï¼šåŒ…å« http åè®®åŠç‰ˆæœ¬ã€æ•°å­—çŠ¶æ€ç ã€çŠ¶æ€ç è‹±æ–‡åç§° å“åº”ä½“ï¼šæœåŠ¡ç«¯è¿”å›çš„æ•°æ® HTTP è¯·æ±‚æ–¹æ³•(9 ç§)HTTP1.0ï¼š GETã€POSTã€HEAD HTTP1.1ï¼š PUTã€PATCHã€DELETEã€OPTIONSã€TRACEã€CONNECT æ–¹æ³• æè¿° GET è·å–èµ„æº POST ä¼ è¾“èµ„æºï¼Œé€šå¸¸ä¼šé€ æˆæœåŠ¡å™¨èµ„æºçš„ä¿®æ”¹ HEAD è·å¾—æŠ¥æ–‡é¦–éƒ¨ PUT æ›´æ–°èµ„æº PATCH å¯¹ PUT çš„è¡¥å……ï¼Œå¯¹å·²çŸ¥èµ„æºéƒ¨åˆ†æ›´æ–° èœé¸Ÿ DELETE åˆ é™¤èµ„æº OPTIONS åˆ—å‡ºè¯·æ±‚èµ„æºæ”¯æŒçš„è¯·æ±‚æ–¹æ³•ï¼Œç”¨æ¥è·¨åŸŸè¯·æ±‚ TRACE è¿½è¸ªè¯·æ±‚/å“åº”è·¯å¾„ï¼Œç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ CONNECT å°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼ç”¨äºä»£ç†æœåŠ¡å™¨(éš§é“ä»£ç†ä¸‹é¢æœ‰è®²) GET å’Œ POST çš„åŒºåˆ« GETåœ¨æµè§ˆå™¨å›é€€æ—¶æ˜¯æ— å®³çš„ï¼Œè€ŒPOSTä¼šå†æ¬¡å‘èµ·è¯·æ±‚ GETè¯·æ±‚ä¼šè¢«æµè§ˆå™¨ä¸»åŠ¨ç¼“å­˜ï¼Œè€ŒPOSTä¸ä¼šï¼Œé™¤éæ‰‹åŠ¨è®¾ç½® GETè¯·æ±‚å‚æ•°ä¼šè¢«å®‰é€—ä¿ç•™åœ¨æµè§ˆå™¨å†å²è®°å½•é‡Œï¼Œè€ŒPOSTä¸­çš„å‚æ•°ä¸ä¼šè¢«ä¿ç•™ GETè¯·æ±‚åœ¨URLä¸­ä¼ é€’çš„å‚æ•°æœ‰é•¿åº¦é™åˆ¶(æµè§ˆå™¨é™åˆ¶å¤§å°ä¸åŒ)ï¼Œè€ŒPOSTæ²¡æœ‰é™åˆ¶ GETå‚æ•°é€šè¿‡URLä¼ é€’ï¼ŒPOSTæ”¾åœ¨Request bodyä¸­ GETäº§ç”Ÿçš„ URL åœ°å€å¯ä»¥è¢«æ”¶è—ï¼Œè€ŒPOSTä¸å¯ä»¥ GETæ²¡æœ‰POSTå®‰å…¨ï¼Œå› ä¸ºGETè¯·æ±‚å‚æ•°ç›´æ¥æš´éœ²åœ¨URLä¸Šï¼Œæ‰€ä»¥ä¸èƒ½ç”¨æ¥ä¼ é€’æ•æ„Ÿä¿¡æ¯ GETè¯·æ±‚åªèƒ½è¿›è¡ŒURLç¼–ç ï¼Œè€ŒPOSTæ”¯æŒå¤šç§ç¼–ç æ–¹å¼ å¯¹å‚æ•°çš„æ•°æ®ç±»å‹ï¼ŒGETåªæ¥å—ASCIIå­—ç¬¦ï¼Œè€ŒPOSTæ²¡æœ‰é™åˆ¶ GETäº§ç”Ÿä¸€ä¸ª TCP æ•°æ®åŒ…ï¼ŒPOSTäº§ç”Ÿä¸¤ä¸ªæ•°æ®åŒ…(Firefox åªå‘ä¸€æ¬¡)ã€‚GET æµè§ˆå™¨æŠŠ http header å’Œ data ä¸€èµ·å‘å‡ºå»ï¼Œå“åº”æˆåŠŸ 200ï¼ŒPOST å…ˆå‘é€ headerï¼Œå“åº” 100 continueï¼Œå†å‘é€ dataï¼Œå“åº”æˆåŠŸ 200 å¸¸è§ HTTP çŠ¶æ€ç 1xx: æŒ‡ç¤ºä¿¡æ¯â€”â€”è¡¨ç¤ºè¯·æ±‚å·²æ¥æ”¶ï¼Œç»§ç»­å¤„ç† 2xx: æˆåŠŸâ€”â€”è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæ¥æ”¶ 3xx: é‡å®šå‘â€”â€”è¡¨ç¤ºè¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œè¿›ä¸€æ­¥æ“ä½œ 4xx: å®¢æˆ·ç«¯é”™è¯¯â€”â€”è¡¨ç¤ºè¯·æ±‚æœ‰è¯­æ³•é”™è¯¯æˆ–è¯·æ±‚æ— æ³•å®ç° 5xx: æœåŠ¡ç«¯é”™è¯¯â€”â€”è¡¨ç¤ºæœåŠ¡å™¨æœªèƒ½å®ç°åˆæ³•çš„è¯·æ±‚ çŠ¶æ€ç  æè¿° 200 è¯·æ±‚æˆåŠŸ 206 å·²å®ŒæˆæŒ‡å®šèŒƒå›´çš„è¯·æ±‚(å¸¦ Range å¤´çš„ GET è¯·æ±‚),åœºæ™¯å¦‚ video,audio æ’­æ”¾æ–‡ä»¶è¾ƒå¤§,æ–‡ä»¶åˆ†ç‰‡æ—¶ 301 æ°¸ä¹…é‡å®šå‘ 302 ä¸´æ—¶é‡å®šå‘ 304 è¯·æ±‚èµ„æºæœªä¿®æ”¹ï¼Œå¯ä»¥ä½¿ç”¨ç¼“å­˜çš„èµ„æºï¼Œä¸ç”¨åœ¨æœåŠ¡å™¨å– 400 è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ 401 æ²¡æœ‰æƒé™è®¿é—® 403 æœåŠ¡å™¨æ‹’ç»æ‰§è¡Œè¯·æ±‚ï¼Œåœºæ™¯å¦‚ä¸å…è®¸ç›´æ¥è®¿é—®ï¼Œåªèƒ½é€šè¿‡æœåŠ¡å™¨è®¿é—®æ—¶ 404 è¯·æ±‚èµ„æºä¸å­˜åœ¨ 500 æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚ 503 è¯·æ±‚æœªå®Œæˆï¼Œå› æœåŠ¡å™¨è¿‡è½½ã€å®•æœºæˆ–ç»´æŠ¤ç­‰ ä»€ä¹ˆæ˜¯æŒä¹…è¿æ¥/é•¿è¿æ¥http1.0åè®®é‡‡ç”¨çš„æ˜¯â€è¯·æ±‚-åº”ç­”â€æ¨¡å¼ï¼Œå½“ä½¿ç”¨æ™®é€šæ¨¡å¼ï¼Œæ¯ä¸ªè¯·æ±‚/åº”ç­”å®¢æˆ·ä¸æœåŠ¡å™¨éƒ½è¦æ–°å»ºä¸€ä¸ªè¿æ¥ï¼Œå®Œæˆä¹‹åç«‹å³æ–­å¼€è¿æ¥(httpåè®®ä¸ºæ— è¿æ¥çš„åè®®) http1.1ç‰ˆæœ¬æ”¯æŒé•¿è¿æ¥ï¼Œå³è¯·æ±‚å¤´æ·»åŠ Connection: Keep-Aliveï¼Œä½¿ç”¨ Keep-Alive æ¨¡å¼(åˆç§°æŒä¹…è¿æ¥ï¼Œè¿æ¥å¤ç”¨)å»ºç«‹ä¸€ä¸ªTCPè¿æ¥åä½¿å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„è¿æ¥æŒç»­æœ‰æ•ˆï¼Œå¯ä»¥å‘é€/æ¥å—å¤šä¸ªhttpè¯·æ±‚/å“åº”ï¼Œå½“å‡ºç°å¯¹æœåŠ¡å™¨çš„åç»­è¯·æ±‚æ—¶ï¼ŒKeep-Alive åŠŸèƒ½é¿å…äº†å»ºç«‹æˆ–è€…é‡æ–°å»ºç«‹è¿æ¥ å¦‚å›¾ï¼šçŸ­è¿æ¥æå¤§çš„é™ä½äº†ä¼ è¾“æ•ˆç‡ é•¿è¿æ¥ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ å‡å°‘CPUåŠå†…å­˜çš„ä½¿ç”¨ï¼Œå› ä¸ºä¸éœ€è¦ç»å¸¸å»ºç«‹å’Œå…³é—­è¿æ¥ æ”¯æŒç®¡é“åŒ–çš„è¯·æ±‚åŠå“åº”æ¨¡å¼ å‡å°‘ç½‘ç»œå µå¡ï¼Œå› ä¸ºå‡å°‘äº† TCP è¯·æ±‚ å‡å°‘äº†åç»­è¯·æ±‚çš„å“åº”æ—¶é—´ï¼Œå› ä¸ºä¸éœ€è¦ç­‰å¾…å»ºç«‹ TCPã€æ¡æ‰‹ã€æŒ¥æ‰‹ã€å…³é—­ TCP çš„è¿‡ç¨‹ å‘ç”Ÿé”™è¯¯æ—¶ï¼Œä¹Ÿå¯åœ¨ä¸å…³é—­è¿æ¥çš„æƒ…å†µä¸‹è¿›è¡Œé”™è¯¯æç¤º ç¼ºç‚¹ ä¸€ä¸ªé•¿è¿æ¥å»ºç«‹åï¼Œå¦‚æœä¸€ç›´ä¿æŒè¿æ¥ï¼Œå¯¹æœåŠ¡å™¨æ¥è¯´æ˜¯å¤šä¹ˆçš„æµªè´¹èµ„æºå‘€ï¼Œè€Œä¸”é•¿è¿æ¥æ—¶é—´çš„é•¿çŸ­ï¼Œç›´æ¥å½±å“åˆ°æœåŠ¡å™¨çš„å¹¶å‘æ•° è¿˜æœ‰å°±æ˜¯å¯èƒ½é€ æˆé˜Ÿå¤´å µå¡(ä¸‹é¢æœ‰è®²)ï¼Œé€ æˆä¿¡æ¯å»¶è¿Ÿ å¦‚ä½•é¿å…é•¿è¿æ¥èµ„æºæµªè´¹ï¼Ÿ å®¢æˆ·ç«¯è¯·æ±‚å¤´å£°æ˜ï¼šConnection: closeï¼Œæœ¬æ¬¡é€šä¿¡åå°±å…³é—­è¿æ¥ æœåŠ¡ç«¯é…ç½®ï¼šå¦‚ Nginxï¼Œè®¾ç½®keepalive_timeoutè®¾ç½®é•¿è¿æ¥è¶…æ—¶æ—¶é—´ï¼Œkeepalive_requestsè®¾ç½®é•¿è¿æ¥è¯·æ±‚æ¬¡æ•°ä¸Šé™ ç³»ç»Ÿå†…æ ¸å‚æ•°è®¾ç½®ï¼š net.ipv4.tcp_keepalive_time = 60ï¼Œè¿æ¥é—²ç½® 60 ç§’åï¼ŒæœåŠ¡ç«¯å°è¯•å‘å®¢æˆ·ç«¯å‘é€ä¾¦æµ‹åŒ…ï¼Œåˆ¤æ–­ TCP è¿æ¥çŠ¶æ€ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ° ack åé¦ˆå°±åœ¨ net.ipv4.tcp_keepalive_intvl = 10ï¼Œå°±åœ¨ 10 ç§’åå†æ¬¡å°è¯•å‘é€ä¾¦æµ‹åŒ…ï¼Œç›´åˆ°æ”¶åˆ° ack åé¦ˆï¼Œä¸€å…±ä¼š net.ipv4.tcp_keepalive_probes = 5ï¼Œä¸€å…±ä¼šå°è¯• 5 æ¬¡ï¼Œè¦æ˜¯éƒ½æ²¡æœ‰æ”¶åˆ°å°±å…³é—­è¿™ä¸ª TCP è¿æ¥äº† ä»€ä¹ˆæ˜¯ç®¡çº¿åŒ–(ç®¡é“åŒ–)http1.1åœ¨ä½¿ç”¨é•¿è¿æ¥çš„æƒ…å†µä¸‹ï¼Œå»ºç«‹ä¸€ä¸ªè¿æ¥é€šé“åï¼Œè¿æ¥ä¸Šæ¶ˆæ¯çš„ä¼ é€’ç±»ä¼¼äº è¯·æ±‚ 1 -&gt; å“åº” 1 -&gt; è¯·æ±‚ 2 -&gt; å“åº” 2 -&gt; è¯·æ±‚ 3 -&gt; å“åº” 3 ç®¡ç†åŒ–è¿æ¥çš„æ¶ˆæ¯å°±å˜æˆäº†ç±»ä¼¼è¿™æ · è¯·æ±‚ 1 -&gt; è¯·æ±‚ 2 -&gt; è¯·æ±‚ 3 -&gt; å“åº” 1 -&gt; å“åº” 2 -&gt; å“åº” 3 ç®¡çº¿åŒ–æ˜¯åœ¨åŒä¸€ä¸ª TCP è¿æ¥é‡Œå‘ä¸€ä¸ªè¯·æ±‚åä¸å¿…ç­‰å…¶å›æ¥å°±å¯ä»¥ç»§ç»­å‘è¯·æ±‚å‡ºå»ï¼Œè¿™å¯ä»¥å‡å°‘æ•´ä½“çš„å“åº”æ—¶é—´ï¼Œä½†æ˜¯æœåŠ¡å™¨è¿˜æ˜¯ä¼šæŒ‰ç…§è¯·æ±‚çš„é¡ºåºå“åº”è¯·æ±‚ï¼Œæ‰€ä»¥å¦‚æœæœ‰è®¸å¤šè¯·æ±‚ï¼Œè€Œå‰é¢çš„è¯·æ±‚å“åº”å¾ˆæ…¢ï¼Œå°±äº§ç”Ÿä¸€ä¸ªè‘—åçš„é—®é¢˜é˜Ÿå¤´å µå¡(ä¸‹é¢æœ‰è®²è§£å†³æ–¹æ³•) ç®¡çº¿åŒ–çš„ç‰¹ç‚¹ï¼š ç®¡çº¿åŒ–æœºåˆ¶é€šè¿‡æŒä¹…è¿æ¥å®Œæˆï¼Œåœ¨http1.1ç‰ˆæœ¬æ‰æ”¯æŒ åªæœ‰GETè¯·æ±‚å’ŒHEADè¯·æ±‚æ‰å¯ä»¥è¿›è¡Œç®¡çº¿åŒ–ï¼Œè€ŒPOSTæœ‰æ‰€é™åˆ¶ åˆæ¬¡åˆ›å»ºè¿æ¥æ—¶ä¸åº”å¯åŠ¨ç®¡çº¿åŒ–æœºåˆ¶ï¼Œå› ä¸ºæœåŠ¡å™¨ä¸ä¸€å®šæ”¯æŒ http1.1 ç‰ˆæœ¬çš„åè®® ç®¡çº¿åŒ–ä¸ä¼šå½±å“å“åº”åˆ°æ¥çš„é¡ºåºï¼Œå¦‚ä¸Šé¢çš„ä¾‹å­æ‰€ç¤ºï¼Œå“åº”è¿”å›çš„é¡ºåºå°±æ˜¯è¯·æ±‚çš„é¡ºåº è¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ”¯æŒç®¡çº¿åŒ–ï¼Œä½†å¹¶ä¸è¦æ±‚æœåŠ¡ç«¯ä¹Ÿå¯¹å“åº”è¿›è¡Œç®¡çº¿åŒ–å¤„ç†ï¼Œåªæ˜¯è¦æ±‚å¯¹äºç®¡çº¿åŒ–çš„è¯·æ±‚ä¸å¤±è´¥å³å¯ ç”±äºä¸Šé¢æåˆ°çš„æœåŠ¡ç«¯é—®é¢˜ï¼Œå¼€æˆ·ç®¡çº¿åŒ–å¾ˆå¯èƒ½å¹¶ä¸ä¼šå¸¦æ¥å¤§å¹…åº¦çš„æ€§èƒ½æå‡ï¼Œè€Œä¸”å¾ˆå¤šæœåŠ¡ç«¯å’Œä»£ç†ç¨‹åºå¯¹ç®¡çº¿åŒ–çš„æ”¯æŒå¹¶ä¸å¥½ï¼Œå› ä¸ºæµè§ˆå™¨(Chrome/Firefox)é»˜è®¤å¹¶æœªå¼€å¯ç®¡çº¿åŒ–æ”¯æŒ å¦‚ä½•è§£å†³ HTTP çš„é˜Ÿå¤´é˜»å¡é—®é¢˜http1.0åè®®é‡‡ç”¨çš„æ˜¯è¯·æ±‚-åº”ç­”æ¨¡å¼ï¼ŒæŠ¥æ–‡å¿…é¡»æ˜¯ä¸€å‘ä¸€æ”¶ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„ä¸²è¡Œé˜Ÿåˆ—ï¼Œæ²¡æœ‰è½»é‡ç¼“æ€¥çš„ä¼˜å…ˆçº§ï¼Œåªæœ‰å…¥é˜Ÿçš„å…ˆåé¡ºåºï¼Œæ’åœ¨æœ€å‰é¢çš„è¯·æ±‚æœ€å…ˆå¤„ç†ï¼Œå°±å¯¼è‡´å¦‚æœé˜Ÿé¦–çš„è¯·æ±‚è€—æ—¶è¿‡é•¿ï¼Œåé¢çš„è¯·æ±‚å°±åªèƒ½å¤„äºé˜»å¡çŠ¶æ€ï¼Œè¿™å°±æ˜¯è‘—åçš„é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚è§£å†³å¦‚ä¸‹ï¼š å¹¶å‘è¿æ¥å› ä¸ºä¸€ä¸ªåŸŸåå…è®¸åˆ†é…å¤šä¸ªé•¿è¿æ¥ï¼Œå°±ç›¸å½“äºå¢åŠ äº†ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸è‡³äºä¸€ä¸ªé˜Ÿåˆ—é‡Œçš„ä»»åŠ¡é˜»å¡äº†å…¶ä»–å…¨éƒ¨ä»»åŠ¡ã€‚ä»¥å‰åœ¨ RFC2616 ä¸­è§„å®šè¿‡å®¢æˆ·ç«¯æœ€å¤šåªèƒ½å¹¶å‘ 2 ä¸ªè¿æ¥ï¼Œä½†æ˜¯ç°å®æ˜¯å¾ˆå¤šæµè§ˆå™¨ä¸æŒ‰å¥—è·¯å‡ºç‰Œï¼Œå°±æ˜¯éµå®ˆè¿™ä¸ªæ ‡å‡† T_Tï¼Œæ‰€ä»¥åœ¨ RFC7230 æŠŠè¿™ä¸ªè§„å®šå–æ¶ˆæ‰äº†ï¼Œç°åœ¨çš„æµè§ˆå™¨æ ‡å‡†ä¸­ä¸€ä¸ªåŸŸåå¹¶å‘è¿æ¥å¯ä»¥æœ‰6~8ä¸ªï¼Œè®°ä½æ˜¯ 6~8 ä¸ªï¼Œä¸æ˜¯ 6 ä¸ª(Chrome6 ä¸ª/Firefox8 ä¸ª) å¦‚æœè¿™ä¸ªè¿˜ä¸èƒ½æ»¡è¶³ä½  ç»§ç»­ï¼Œä¸è¦åœâ€¦ åŸŸååˆ†ç‰‡ä¸€ä¸ªåŸŸåæœ€å¤šå¯ä»¥å¹¶å‘ 6~8 ä¸ªï¼Œé‚£å’±å°±å¤šæ¥å‡ ä¸ªåŸŸå æ¯”å¦‚ a.baidu.comï¼Œb.baidu.comï¼Œc.baidu.comï¼Œå¤šå‡†å¤‡å‡ ä¸ªäºŒçº§åŸŸåï¼Œå½“æˆ‘ä»¬è®¿é—® baidu.com æ—¶ï¼Œå¯ä»¥è®©ä¸åŒçš„èµ„æºä»ä¸åŒçš„äºŒåŸŸåä¸­è·å–ï¼Œè€Œå®ƒä»¬éƒ½æŒ‡å‘åŒä¸€å°æœåŠ¡å™¨ï¼Œè¿™æ ·èƒ½å¤Ÿå¹¶å‘æ›´å¤šçš„é•¿è¿æ¥äº† è€Œåœ¨HTTP2.0ä¸‹ï¼Œå¯ä»¥ä¸€ç¬é—´åŠ è½½å‡ºæ¥å¾ˆå¤šèµ„æºï¼Œå› ä¸ºæ”¯æŒå¤šè·¯å¤ç”¨ï¼Œå¯ä»¥åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸­å‘é€å¤šä¸ªè¯·æ±‚ è¯´ä¸€ä¸‹ HTTP ä»£ç†å¸¸è§çš„ä»£ç†æœ‰ä¸¤ç§ï¼šæ™®é€šä»£ç†(ä¸­é—´äººä»£ç†)ï¼Œéš§é“ä»£ç† æ™®é€šä»£ç†(ä¸­é—´äººä»£ç†) å¦‚å›¾ï¼šä»£ç†æœåŠ¡å™¨ç›¸å½“äºä¸€ä¸ªä¸­é—´äººï¼Œä¸€ç›´å¸®ä¸¤è¾¹ä¼ é€’ä¸œè¥¿ï¼Œå¥½å¯æ€œ~~ ä¸è¿‡å®ƒå¯ä»¥åœ¨ä¸­é—´å¯ä»¥å¸®æˆ‘ä»¬è¿‡æ»¤ã€ç¼“å­˜ã€è´Ÿè½½å‡è¡¡(å¤šå°æœåŠ¡å™¨å…±ç”¨ä¸€å°ä»£ç†æƒ…å†µä¸‹)ç­‰ä¸€äº›å¤„ç† æ³¨æ„ï¼Œå®é™…åœºæ™¯ä¸­å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å¯èƒ½æœ‰å¤šä¸ªä»£ç†æœåŠ¡å™¨ éš§é“ä»£ç†å®¢æˆ·ç«¯é€šè¿‡CONNECTæ–¹æ³•è¯·æ±‚éš§é“ä»£ç†åˆ›å»ºä¸€ä¸ªå¯ä»¥åˆ°ä»»æ„ç›®æ ‡æœåŠ¡å™¨å’Œç«¯å£å·çš„ TCP è¿æ¥ï¼Œåˆ›å»ºæˆåŠŸä¹‹åéš§é“ä»£ç†åªåšè¯·æ±‚å’Œå“åº”æ•°æ®çš„è½¬å‘ï¼Œä¸­é—´å®ƒä¸ä¼šåšä»»ä½•å¤„ç† ä¸ºä»€ä¹ˆéœ€è¦éš§é“ä»£ç†å‘¢ï¼Ÿ æˆ‘ä»¬éƒ½çŸ¥é“httpsæœåŠ¡æ˜¯éœ€è¦ç½‘ç«™æœ‰è¯ä¹¦çš„ï¼Œè€Œä»£ç†æœåŠ¡å™¨æ˜¾ç„¶æ²¡æœ‰ï¼Œæ‰€ä»¥æµè§ˆå™¨å’Œä»£ç†ä¹‹é—´æ— æ³•åˆ›å»ºTLSï¼Œæ‰€ä»¥å°±æœ‰äº†éš§é“ä»£ç†ï¼Œå®ƒæŠŠæµè§ˆå™¨çš„æ•°æ®åŸæ ·é€ä¼ ï¼Œè¿™æ ·å°±å®ç°äº†é€šè¿‡ä¸­é—´ä»£ç†å’ŒæœåŠ¡ç«¯è¿›è¡Œ TLS æ¡æ‰‹ï¼Œç„¶åè¿›è¡ŒåŠ å¯†ä¼ è¾“ å¯èƒ½æœ‰äººä¼šé—®ï¼Œé‚£è¿˜è¦ä»£ç†å¹²å˜›ï¼Œç›´æ¥è¯·æ±‚æœåŠ¡å™¨ä¸æ˜¯æ›´å¥½å— ä»£ç†æœåŠ¡å™¨ï¼Œåˆ°åº•æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿ çªç ´è®¿é—®é™åˆ¶ï¼šå¦‚è®¿é—®ä¸€äº›å•ä½æˆ–é›†å›¢å†…éƒ¨èµ„æºï¼Œæˆ–ç”¨å›½å¤–ä»£ç†æœåŠ¡å™¨(ç¿»å¢™)ï¼Œå°±å¯ä»¥ä¸Šå›½å¤–ç½‘ç«™çœ‹ç‰‡ç­‰ å®‰å…¨æ€§æ›´é«˜ï¼šä¸Šç½‘è€…å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼éšè—è‡ªå·±çš„ IPï¼Œå…å—æ”»å‡»ã€‚è¿˜å¯ä»¥å¯¹æ•°æ®è¿‡æ»¤ï¼Œå¯¹éæ³• IP é™æµç­‰ è´Ÿè½½å‡è¡¡ï¼šå®¢æˆ·ç«¯è¯·æ±‚å…ˆåˆ°ä»£ç†æœåŠ¡å™¨ï¼Œè€Œä»£ç†æœåŠ¡å™¨åé¢æœ‰å¤šå°‘æºæœåŠ¡å™¨ï¼ŒIP æ˜¯å¤šå°‘ï¼Œå®¢æˆ·ç«¯æ˜¯ä¸çŸ¥é“çš„ã€‚å› æ­¤ï¼Œä»£ç†æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œé€šè¿‡ç‰¹å®šçš„ç®—æ³•(éšæœºç®—æ³•ã€è½®è¯¢ã€ä¸€è‡´æ€§ hashã€LUR(æœ€è¿‘æœ€å°‘ä½¿ç”¨) ç®—æ³•è¿™é‡Œä¸ç»†è¯´äº†)æŠŠè¯·æ±‚åˆ†å‘ç»™ä¸åŒçš„æºæœåŠ¡å™¨ï¼Œè®©å„ä¸ªæºæœåŠ¡å™¨è´Ÿè½½å°½é‡å‡è¡¡ ç¼“å­˜ä»£ç†ï¼šå°†å†…å®¹ç¼“å­˜åˆ°ä»£ç†æœåŠ¡å™¨(è¿™ä¸ªä¸‹é¢ä¸€èŠ‚è¯¦ç»†è¯´) ä»£ç†æœ€å¸¸è§çš„è¯·æ±‚å¤´Via æ˜¯ä¸€ä¸ªèƒ½ç”¨é¦–éƒ¨ï¼Œç”±ä»£ç†æœåŠ¡å™¨æ·»åŠ ï¼Œé€‚ç”¨äºæ­£å‘å’Œåå‘ä»£ç†ï¼Œåœ¨è¯·æ±‚å’Œå“åº”é¦–éƒ¨å‡å¯å‡ºç°ï¼Œè¿™ä¸ªæ¶ˆæ¯é¦–éƒ¨å¯ä»¥ç”¨æ¥è¿½è¸ªæ¶ˆæ¯è½¬å‘æƒ…å†µï¼Œé˜²æ­¢å¾ªç¯è¯·æ±‚ï¼Œè¿˜å¯ä»¥è¯†åˆ«åœ¨è¯·æ±‚æˆ–å“åº”ä¼ é€’é“¾ä¸­æ¶ˆæ¯å‘é€è€…å¯¹äºåè®®çš„æ”¯æŒèƒ½åŠ›ï¼Œè¯¦æƒ…è¯·çœ‹ MDN Via: 1.1 vegurVia: HTTP/1.1 GWAVia: 1.0 fred, 1.1 p.example.net X-Forwarded-For è®°å½•å®¢æˆ·ç«¯è¯·æ±‚çš„æ¥æº IPï¼Œæ¯ç»è¿‡ä¸€çº§ä»£ç†(åŒ¿åä»£ç†é™¤å¤–)ï¼Œä»£ç†æœåŠ¡å™¨éƒ½ä¼šæŠŠè¿™æ¬¡è¯·æ±‚çš„æ¥æº IP è¿½åŠ è¿›å» X-Forwarded-For: client,proxy1,proxy2 æ³¨æ„ï¼šä¸æœåŠ¡å™¨ç›´è¿çš„ä»£ç†æœåŠ¡å™¨çš„ IP ä¸ä¼šè¢«è¿½åŠ è¿›å»ï¼Œè¯¥ä»£ç†å¯èƒ½è¿‡ TCP è¿æ¥çš„Remote Addresså­—æ®µè·å–åˆ°ä¸æœåŠ¡å™¨ç›´è¿çš„ä»£ç†æœåŠ¡å™¨ IP X-Real-IP ä¸€èˆ¬è®°å½•çœŸå®å‘å‡ºè¯·æ±‚çš„å®¢æˆ·ç«¯çš„ IPï¼Œè¿˜æœ‰X-Forwarded-Hostå’ŒX-Forwarded-Protoåˆ†åˆ«è®°å½•çœŸå®å‘å‡ºè¯·æ±‚çš„å®¢æˆ·ç«¯çš„åŸŸåå’Œåè®®å ä»£ç†ä¸­å®¢æˆ·ç«¯ IP ä¼ªé€ é—®é¢˜ä»¥åŠå¦‚ä½•é¢„é˜²ï¼ŸX-Forwarded-Foræ˜¯å¯ä»¥ä¼ªé€ çš„ï¼Œæ¯”å¦‚ä¸€äº›é€šè¿‡ X-Forwarded-For è·å–åˆ°å®¢æˆ·ç«¯ IP æ¥é™åˆ¶åˆ·ç¥¨çš„ç³»ç»Ÿå°±å¯ä»¥é€šè¿‡ä¼ªé€ è¯¥è¯·æ±‚å¤´è¾¾åˆ°åˆ·ç¥¨çš„ç›®çš„ï¼Œå¦‚æœå®¢æˆ·ç«¯è¯·æ±‚æ˜¾ç¤ºæŒ‡å®šäº† X-Forwarded-Forï¼š192.168.1.108 é‚£ä¹ˆæœåŠ¡ç«¯æ”¶åˆ°çš„è¿™ä¸ªè¯·æ±‚å¤´ï¼Œç¬¬ä¸€ä¸ª IP å°±æ˜¯ä¼ªé€ çš„ é¢„é˜² åœ¨å¯¹å¤– Nginx æœåŠ¡å™¨ä¸Šé…ç½® location / &#123; proxy_set_header X-Forwarded-For $remote_addr&#125; è¿™æ ·ç¬¬ä¸€ä¸ª IP å°±æ˜¯ä»TCPè¿æ¥å®¢æˆ·ç«¯çš„ IPï¼Œä¸ä¼šè¯»å–ä¼ªé€ çš„ ä»å³åˆ°å·¦éå†X-Forwarded-Forçš„ IPï¼Œæ’é™¤å·²çŸ¥ä»£ç†æœåŠ¡å™¨ IP å’Œå†…ç½‘ IPï¼Œè·å–åˆ°ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„ IP å°±å¯ä»¥äº† æ­£å‘ä»£ç†å’Œåå‘ä»£ç†æ­£å‘ä»£ç†å·¥ä½œåœ¨å®¢æˆ·ç«¯çš„ä»£ç†ä¸ºæ­£å‘ä»£ç†ã€‚ä½¿ç”¨æ­£å‘ä»£ç†çš„æ—¶å€™ï¼Œéœ€è¦åœ¨å®¢æˆ·ç«¯é…ç½®éœ€è¦ä½¿ç”¨çš„ä»£ç†æœåŠ¡å™¨ï¼Œæ­£å‘ä»£ç†å¯¹æœåŠ¡ç«¯é€æ˜ã€‚æ¯”å¦‚æŠ“åŒ…å·¥å…· Fiddlerã€Charles ä»¥åŠè®¿é—®ä¸€äº›å¤–ç½‘ç½‘ç«™çš„ä»£ç†å·¥å…·éƒ½æ˜¯æ­£å‘ä»£ç† æ­£å‘ä»£ç†é€šå¸¸ç”¨äº ç¼“å­˜ å±è”½æŸäº›ä¸å¥åº·çš„ç½‘ç«™ é€šè¿‡ä»£ç†è®¿é—®åŸæœ¬æ— æ³•è®¿é—®çš„ç½‘ç«™ ä¸Šç½‘è®¤è¯ï¼Œå¯¹ç”¨æˆ·è®¿é—®è¿›è¡Œæˆæƒ åå‘ä»£ç†å·¥ä½œåœ¨æœåŠ¡ç«¯çš„ä»£ç†ç§°ä¸ºåå‘ä»£ç†ã€‚ä½¿ç”¨åå‘ä»£ç†çš„æ—¶å€™ï¼Œä¸éœ€è¦åœ¨å®¢æˆ·ç«¯è¿›è¡Œè®¾ç½®ï¼Œåå‘ä»£ç†å¯¹å®¢æˆ·ç«¯é€æ˜ã€‚å¦‚ Nginx å°±æ˜¯åå‘ä»£ç† åå‘ä»£ç†é€šå¸¸ç”¨äºï¼šè´Ÿè½½å‡è¡¡ã€æœåŠ¡ç«¯ç¼“å­˜ã€æµé‡éš”ç¦»ã€æ—¥å¿—ã€é‡‘ä¸é›€å‘å¸ƒ ä»£ç†ä¸­çš„é•¿è¿æ¥åœ¨å„ä¸ªä»£ç†å’ŒæœåŠ¡å™¨ã€å®¢æˆ·ç«¯èŠ‚ç‚¹ä¹‹é—´æ˜¯ä¸€æ®µä¸€æ®µçš„ TCP è¿æ¥ï¼Œå®¢æˆ·ç«¯é€šè¿‡ä»£ç†è®¿é—®ç›®æ ‡æœåŠ¡å™¨ä¹Ÿå«é€æ®µä¼ è¾“ï¼Œç”¨äºé€æ®µä¼ è¾“çš„è¯·æ±‚å¤´å«é€æ®µä¼ è¾“å¤´ã€‚ é€æ®µä¼ è¾“å¤´ä¼šåœ¨æ¯ä¸€æ®µä¼ è¾“çš„ä¸­é—´ä»£ç†ä¸­å¤„ç†æ‰ï¼Œä¸ä¼šä¼ ç»™ä¸‹ä¸€ä¸ªä»£ç† æ ‡å‡†çš„é€æ®µä¼ è¾“å¤´æœ‰ï¼šKeep-Aliveã€Transfer-Encodingã€TEã€Connectionã€Trailerã€Upgradeã€Proxy-Authorizationã€Proxy-Authenticateã€‚ Connection å¤´å†³å®šå½“å‰äº‹åŠ¡å®Œæˆåæ˜¯å¦å…³é—­è¿æ¥ï¼Œå¦‚æœè¯¥å€¼ä¸º keep-aliveï¼Œåˆ™è¿æ¥æ˜¯æŒä¹…è¿æ¥ä¸ä¼šå…³é—­ï¼Œä½¿å¾—å¯¹åŒä¸€æœåŠ¡å™¨çš„è¯·æ±‚å¯ä»¥ç»§ç»­åœ¨è¯¥è¿æ¥ä¸Šå®Œæˆ è¯´ä¸€ä¸‹ HTTP ç¼“å­˜åŠç¼“å­˜ä»£ç†å…³äº http ç¼“å­˜åœ¨ä¸Šä¸€ç¯‡æ–‡ç« é‡Œæœ‰äº†è¯¦ç»†ä»‹ç» (å»ºè®®æ”¶è—)ä¸ºä»€ä¹ˆç¬¬äºŒæ¬¡æ‰“å¼€é¡µé¢å¿«ï¼Ÿäº”æ­¥åƒé€å‰ç«¯ç¼“å­˜ï¼Œè®©é¡µé¢é£èµ· ç¼“å­˜ä»£ç†å°±æ˜¯è®©ä»£ç†æœåŠ¡å™¨æ¥ç®¡ä¸€éƒ¨åˆ†çš„æœåŠ¡ç«¯çš„ http ç¼“å­˜ï¼Œå®¢æˆ·ç«¯ç¼“å­˜è¿‡æœŸä¹‹åå°±è¿‘åˆ°ä»£ç†æœåŠ¡å™¨çš„ç¼“å­˜ä¸­è·å–ï¼Œä»£ç†ç¼“å­˜è¿‡æœŸäº†æ‰è¯·æ±‚æºæœåŠ¡å™¨ï¼Œè¿™æ ·æµé‡å¤§çš„æ—¶å€™èƒ½æ˜æ˜¾é™ä½æºæœåŠ¡å™¨çš„å‹åŠ› æ³¨æ„å“åº”å¤´å­—æ®µ Cache-Controlï¼š å€¼æœ‰publicæ—¶ï¼Œè¡¨ç¤ºå¯ä»¥è¢«æ‰€æœ‰ç»ˆç«¯ç¼“å­˜ï¼ŒåŒ…æ‹¬ä»£ç†æœåŠ¡å™¨ã€CDNã€‚å€¼æœ‰privateæ—¶ï¼Œåªèƒ½è¢«ç»ˆç«¯æµè§ˆå™¨ç¼“å­˜ï¼ŒCDNã€ä»£ç†ç­‰ä¸­ç»§æœåŠ¡å™¨éƒ½ä¸å¯ä»¥ç¼“å­˜ã€‚ HTTPSHTTPS æ˜¯è¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®ï¼Œå³HTTP + SSL/TLSã€‚è¯´ç™½äº†ï¼Œå°±æ˜¯ä¸€ä¸ªåŠ å¼ºç‰ˆçš„ HTTP HTTP æœ¬æ–‡å¼€å§‹è®²äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç†è§£ HTTPS çš„ç²¾åï¼Œå°±è¦å…ˆå¼„æ¸…æ¥šè¿™ä¸ªSSL/TLSäº† SSL/TLSä¸€å¼ å›¾è®©ä½ ç†è§£ SSL å’Œ TLS çš„å…³ç³» å¦‚å›¾ï¼ŒTLS æ˜¯ SSL çš„å‡çº§ç‰ˆï¼Œè€Œä¸” TLS1.2 ç‰ˆæœ¬ä»¥ä¸‹éƒ½å·²åºŸå¼ƒï¼Œç›®å‰ä¸»è¦ç”¨çš„æ˜¯TLS 1.2å’ŒTLS 1.3ã€‚è€ŒOpenSSLåˆ™æ˜¯å¼€æºç‰ˆæœ¬çš„ é‚£ä¹ˆå®ƒåˆ°åº•æ˜¯ä¸ªå•¥å‘¢ï¼Ÿ æµè§ˆå™¨å’ŒæœåŠ¡å™¨é€šä¿¡ä¹‹å‰ä¼šå…ˆåå•†ï¼Œé€‰å‡ºå®ƒä»¬éƒ½æ”¯æŒçš„åŠ å¯†å¥—ä»¶ï¼Œç”¨æ¥å®ç°å®‰å…¨çš„é€šä¿¡ã€‚å¸¸è§åŠ å¯†å¥—ä»¶ éšä¾¿æ‹¿å‡ºä¸€ä¸ªåŠ å¯†å¥—ä»¶ä¸¾ä¾‹ï¼Œå¦‚ï¼šRSA-PSK-AES128-GCM-SHA256ï¼Œå°±æ˜¯é•¿è¿™æ ·ï¼Œä»£è¡¨ä»€ä¹ˆæ„æ€å‘¢ï¼Œæˆ‘ä»¬çœ‹å›¾ **RSA**ï¼šè¡¨ç¤ºæ¡æ‰‹æ—¶ç”¨ RSA ç®—æ³•äº¤æ¢å¯†é’¥ **PSK**ï¼šè¡¨ç¤ºä½¿ç”¨ PSK ç®—æ³•ç­¾å AES128-GCM**ï¼šè¡¨ç¤ºä½¿ç”¨ AES256 å¯¹ç§°åŠ å¯†ç®—æ³•é€šä¿¡ï¼Œå¯†é’¥é•¿åº¦ 128ï¼Œåˆ†ç»„æ¨¡å¼ GCMã€‚TLS 1.3 ä¸­åªå‰©ä¸‹ç§°åŠ å¯†ç®—æ³•æœ‰AESå’ŒCHACHA20ï¼Œåˆ†ç»„æ¨¡å¼åªå‰©ä¸‹GCMå’ŒPOLY1305** SHA256**ï¼šè¡¨ç¤ºä½¿ç”¨ SHA256 ç®—æ³•éªŒè¯ä¿¡æ¯å®Œæ•´æ€§å¹¶ç”Ÿæˆéšæœºæ•°ã€‚TLS 1.3 ä¸­å“ˆå¸Œæ‘˜è¦ç®—æ³•åªå‰©ä¸‹SHA256å’ŒSHA384**äº† ä¸ºä»€ä¹ˆéœ€è¦ç”¨åˆ°è¿™ä¹ˆå¤šç®—æ³•å‘¢ï¼Ÿ ä¸ºäº†ä¿è¯å®‰å…¨ï¼ŒTLS éœ€è¦ä¿è¯ä¿¡æ¯çš„ï¼šæœºå¯†æ€§ã€å¯ç”¨æ€§ã€å®Œæ•´æ€§ã€è®¤è¯æ€§ã€ä¸å¯å¦è®¤æ€§ï¼Œæ¯ä¸€ç§ç®—æ³•éƒ½æœ‰å…¶ç‰¹å®šçš„ç”¨å¤„ HTTPS ä¸­ TLS çš„åŠ å¯†ç®—æ³•ä¸ºä»€ä¹ˆè¯´ https æ˜¯å®‰å…¨çš„ï¼Ÿ https ä¸€å®šæ˜¯å®‰å…¨çš„å—ï¼Ÿï¼ˆè€ƒå¯Ÿ https ä¸­é—´äººåŠ«æŒï¼Œæˆ‘å¦ä¸€ç¯‡æœ‰å…³äºè¯¦ç»†ä»‹ç»ç½‘ç»œå®‰å…¨ï¼‰ æœ‰ä»€ä¹ˆè§£å†³åŠæ³•ï¼Ÿ https çš„è¯ä¹¦æ ¡éªŒè¿‡ç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ è¯ä¹¦æ ¡éªŒç”¨åˆ°äº†å“ªäº›ç®—æ³•ï¼Ÿ å¯¹ç§°åŠ å¯†ç®—æ³• å°±æ˜¯åŠ å¯†å’Œè§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥ã€‚å¦‚AESã€DESã€‚åŠ è§£å¯†è¿‡ç¨‹ï¼š æµè§ˆå™¨ç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªéšæœºæ•°client-randomå’Œä¸€ä¸ªæ”¯æŒçš„åŠ å¯†æ–¹æ³•åˆ—è¡¨ æœåŠ¡å™¨ç»™æµè§ˆå™¨è¿”å›å¦ä¸€ä¸ªéšæœºæ•°server-randomå’ŒåŒæ–¹éƒ½æ”¯æŒçš„åŠ å¯†æ–¹æ³• ç„¶åä¸¤è€…ç”¨åŠ å¯†æ–¹æ³•å°†ä¸¤ä¸ªéšæœºæ•°æ··åˆç”Ÿæˆå¯†é’¥ï¼Œè¿™å°±æ˜¯é€šä¿¡åŒä¸ŠåŠ è§£å¯†çš„å¯†é’¥ é—®é¢˜æ˜¯åŒæ–¹å¦‚ä½•å®‰å…¨çš„ä¼ é€’ä¸¤ä¸ªéšæœºæ•°å’ŒåŠ å¯†æ–¹æ³•ï¼Œç›´æ¥ä¼ ç»™å®¢æˆ·ç«¯ï¼Œé‚£è¿‡ç¨‹ä¸­å°±å¾ˆå¯èƒ½è¢«çªƒå–ï¼Œåˆ«äººå°±èƒ½æˆåŠŸè§£å¯†æ‹¿åˆ°æ•°æ®ï¼Œå¾€ä¸‹çœ‹ ä¸å¯¹ç§°åŠ å¯†ç®—æ³• å°±æ˜¯ä¸€å¯¹å¯†é’¥ï¼Œæœ‰å…¬é’¥(public key)å’Œç§é’¥(private key)ï¼Œå…¶ä¸­ä¸€ä¸ªå¯†é’¥åŠ å¯†åçš„æ•°æ®ï¼Œåªèƒ½è®©å¦ä¸€ä¸ªå¯†é’¥è¿›è¡Œè§£å¯†ã€‚å¦‚RSAã€ECDHEã€‚åŠ è§£å¯†è¿‡ç¨‹ï¼š æµè§ˆå™¨ç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªéšæœºæ•°client-randomå’Œä¸€ä¸ªæ”¯æŒçš„åŠ å¯†æ–¹æ³•åˆ—è¡¨ æœåŠ¡å™¨æŠŠå¦ä¸€ä¸ªéšæœºæ•°server-randomã€åŠ å¯†æ–¹æ³•ã€å…¬é’¥ä¼ ç»™æµè§ˆå™¨ ç„¶åæµè§ˆå™¨ç”¨å…¬é’¥å°†ä¸¤ä¸ªéšæœºæ•°åŠ å¯†ï¼Œç”Ÿæˆå¯†é’¥ï¼Œè¿™ä¸ªå¯†é’¥åªèƒ½ç”¨ç§é’¥è§£å¯† ä½¿ç”¨å…¬é’¥åæ¨å‡ºç§é’¥æ˜¯éå¸¸å›°éš¾ï¼Œä½†ä¸æ˜¯åšä¸åˆ°ï¼Œéšç€è®¡ç®—æœºè¿ç®—èƒ½åŠ›æé«˜ï¼Œéå¯¹ç§°å¯†é’¥è‡³å°‘è¦2048ä½æ‰èƒ½ä¿è¯å®‰å…¨æ€§ï¼Œè¿™å°±å¯¼è‡´æ€§èƒ½ä¸Šè¦æ¯”å¯¹ç§°åŠ å¯†è¦å·®å¾ˆå¤š æ‰€ä»¥ï¼ TLS å®é™…ç”¨çš„æ˜¯ä¸¤ç§ç®—æ³•çš„æ··åˆåŠ å¯†ã€‚é€šè¿‡ éå¯¹ç§°åŠ å¯†ç®—æ³• äº¤æ¢ å¯¹ç§°åŠ å¯†ç®—æ³• çš„å¯†é’¥ï¼Œäº¤æ¢å®Œæˆåï¼Œå†ä½¿ç”¨å¯¹ç§°åŠ å¯†è¿›è¡ŒåŠ è§£å¯†ä¼ è¾“æ•°æ®ã€‚è¿™æ ·å°±ä¿è¯äº†ä¼šè¯çš„æœºå¯†æ€§ã€‚è¿‡ç¨‹å¦‚ä¸‹ æµè§ˆå™¨ç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªéšæœºæ•°client-randomå’Œä¸€ä¸ªæ”¯æŒçš„åŠ å¯†æ–¹æ³•åˆ—è¡¨ æœåŠ¡å™¨æŠŠå¦ä¸€ä¸ªéšæœºæ•°server-randomã€åŠ å¯†æ–¹æ³•ã€å…¬é’¥ä¼ ç»™æµè§ˆå™¨ æµè§ˆå™¨åˆç”Ÿæˆå¦ä¸€ä¸ªéšæœºæ•°pre-randomï¼Œå¹¶ç”¨å…¬é’¥åŠ å¯†åä¼ ç»™æœåŠ¡å™¨ æœåŠ¡å™¨å†ç”¨ç§é’¥è§£å¯†ï¼Œå¾—åˆ°pre-random æµè§ˆå™¨å’ŒæœåŠ¡å™¨éƒ½å°†ä¸‰ä¸ªéšæœºæ•°ç”¨åŠ å¯†æ–¹æ³•æ··åˆç”Ÿæˆæœ€ç»ˆå¯†é’¥ è¿™æ ·å³ä¾¿è¢«æˆªæŒï¼Œä¸­é—´äººæ²¡æœ‰ç§é’¥å°±æ‹¿ä¸åˆ°pre-randomï¼Œå°±æ— æ³•ç”Ÿæˆæœ€ç»ˆå¯†é’¥ã€‚ å¯åˆæœ‰é—®é¢˜æ¥äº†ï¼Œå¦‚æœä¸€å¼€å§‹å°±è¢« DNS æˆªæŒï¼Œæˆ‘ä»¬æ‹¿åˆ°çš„å…¬é’¥æ˜¯ä¸­é—´äººçš„ï¼Œè€Œä¸æ˜¯æœåŠ¡å™¨çš„ï¼Œæ•°æ®è¿˜æ˜¯ä¼šè¢«çªƒå–ï¼Œæ‰€ä»¥æ•°å­—è¯ä¹¦æ¥äº†ï¼Œå¾€ä¸‹çœ‹ï¼Œå…ˆç®€å•è¯´ä¸€ä¸‹æ‘˜è¦ç®—æ³• æ‘˜è¦ç®—æ³• ä¸»è¦ç”¨äºä¿è¯ä¿¡æ¯çš„å®Œæ•´æ€§ã€‚å¸¸è§çš„MD5 ç®—æ³•ã€æ•£åˆ—å‡½æ•°ã€å“ˆå¸Œå‡½æ•°éƒ½å±äºè¿™ç±»ç®—æ³•ï¼Œå…¶ç‰¹ç‚¹å°±æ˜¯å•å‘æ€§ã€æ— æ³•åæ¨åŸæ–‡ å‡å¦‚ä¿¡æ¯è¢«æˆªå–ï¼Œå¹¶é‡æ–°ç”Ÿæˆäº†æ‘˜è¦ï¼Œè¿™æ—¶å€™å°±åˆ¤æ–­ä¸å‡ºæ¥æ˜¯å¦è¢«ç¯¡æ”¹äº†ï¼Œæ‰€ä»¥éœ€è¦ç»™æ‘˜è¦ä¹Ÿé€šè¿‡ä¼šè¯å¯†é’¥è¿›è¡ŒåŠ å¯†ï¼Œè¿™æ ·å°±çœ‹ä¸åˆ°æ˜æ–‡ä¿¡æ¯ï¼Œä¿è¯äº†å®‰å…¨æ€§ï¼ŒåŒæ—¶ä¹Ÿä¿è¯äº†å®Œæ•´æ€§ å¦‚ä½•ä¿è¯æ•°æ®ä¸è¢«ç¯¡æ”¹ï¼Ÿç­¾ååŸç†å’Œè¯ä¹¦?æ•°å­—è¯ä¹¦(æ•°å­—ç­¾å) å®ƒå¯ä»¥å¸®æˆ‘ä»¬éªŒè¯æœåŠ¡å™¨èº«ä»½ã€‚å› ä¸ºå¦‚æœæ²¡æœ‰éªŒè¯çš„è¯ï¼Œå°±å¯èƒ½è¢«ä¸­é—´äººåŠ«æŒï¼Œå‡å¦‚è¯·æ±‚è¢«ä¸­é—´äººæˆªè·ï¼Œä¸­é—´äººæŠŠä»–è‡ªå·±çš„å…¬é’¥ç»™äº†å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°å…¬é’¥å°±æŠŠä¿¡æ¯å‘ç»™ä¸­é—´äººäº†ï¼Œä¸­é—´äººè§£å¯†æ‹¿åˆ°æ•°æ®åï¼Œå†è¯·æ±‚å®é™…æœåŠ¡å™¨ï¼Œæ‹¿åˆ°æœåŠ¡å™¨å…¬é’¥ï¼Œå†æŠŠä¿¡æ¯å‘ç»™æœåŠ¡å™¨ è¿™æ ·ä¸çŸ¥ä¸è§‰é—´ä¿¡æ¯å°±è¢«äººçªƒå–äº†ï¼Œæ‰€ä»¥åœ¨ç»“åˆå¯¹ç§°å’Œéå¯¹ç§°åŠ å¯†çš„åŸºç¡€ä¸Šï¼Œåˆæ·»åŠ äº†æ•°å­—è¯ä¹¦è®¤è¯çš„æ­¥éª¤ï¼Œè®©æœåŠ¡å™¨è¯æ˜è‡ªå·±çš„èº«ä»½ æ•°å­—è¯ä¹¦éœ€è¦å‘æœ‰æƒå¨çš„è®¤è¯æœºæ„(CA)è·å–æˆæƒç»™æœåŠ¡å™¨ã€‚é¦–å…ˆï¼ŒæœåŠ¡å™¨å’ŒCAæœºæ„åˆ†åˆ«æœ‰ä¸€å¯¹å¯†é’¥(å…¬é’¥å’Œç§é’¥)ï¼Œç„¶åæ˜¯å¦‚ä½•ç”Ÿæˆæ•°å­—è¯ä¹¦çš„å‘¢ï¼Ÿ CA æœºæ„é€šè¿‡æ‘˜è¦ç®—æ³•ç”ŸæˆæœåŠ¡å™¨å…¬é’¥çš„æ‘˜è¦(å“ˆå¸Œæ‘˜è¦) CA æœºæ„é€šè¿‡CA ç§é’¥åŠç‰¹å®šçš„ç­¾åç®—æ³•åŠ å¯†æ‘˜è¦ï¼Œç”Ÿæˆç­¾å æŠŠç­¾åã€æœåŠ¡å™¨å…¬é’¥ç­‰ä¿¡æ¯æ‰“åŒ…æ”¾å…¥æ•°å­—è¯ä¹¦ï¼Œå¹¶è¿”å›ç»™æœåŠ¡å™¨ æœåŠ¡å™¨é…ç½®å¥½è¯ä¹¦ï¼Œä»¥åå®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨ï¼Œéƒ½å…ˆæŠŠè¯ä¹¦å‘ç»™å®¢æˆ·ç«¯éªŒè¯å¹¶è·å–æœåŠ¡å™¨çš„å…¬é’¥ã€‚ è¯ä¹¦éªŒè¯æµç¨‹ï¼š ä½¿ç”¨CA å…¬é’¥å’Œå£°æ˜çš„ç­¾åç®—æ³•å¯¹ CA ä¸­çš„ç­¾åè¿›è¡Œè§£å¯†ï¼Œå¾—åˆ°æœåŠ¡å™¨å…¬é’¥çš„æ‘˜è¦å†…å®¹ å†ç”¨æ‘˜è¦ç®—æ³•å¯¹è¯ä¹¦é‡Œçš„æœåŠ¡å™¨å…¬é’¥ç”Ÿæˆæ‘˜è¦ï¼Œå†æŠŠè¿™ä¸ªæ‘˜è¦å’Œä¸Šä¸€æ­¥å¾—åˆ°çš„æ‘˜è¦å¯¹æ¯”ï¼Œå¦‚æœä¸€è‡´è¯´æ˜è¯ä¹¦åˆæ³•ï¼Œé‡Œé¢çš„å…¬é’¥ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œå¦åˆ™å°±æ˜¯éæ³•çš„ è¯ä¹¦è®¤è¯åˆåˆ†ä¸ºå•å‘è®¤è¯å’ŒåŒå‘è®¤è¯ å•å‘è®¤è¯ï¼šæœåŠ¡å™¨å‘é€è¯ä¹¦ï¼Œå®¢æˆ·ç«¯éªŒè¯è¯ä¹¦ åŒå‘è®¤è¯ï¼šæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯åˆ†åˆ«æä¾›è¯ä¹¦ç»™å¯¹æ–¹ï¼Œå¹¶äº’ç›¸éªŒè¯å¯¹æ–¹çš„è¯ä¹¦ ä¸è¿‡å¤§å¤šæ•° https æœåŠ¡å™¨éƒ½æ˜¯å•å‘è®¤è¯ï¼Œå¦‚æœæœåŠ¡å™¨éœ€è¦éªŒè¯å®¢æˆ·ç«¯çš„èº«ä»½ï¼Œä¸€èˆ¬é€šè¿‡ç”¨æˆ·åã€å¯†ç ã€æ‰‹æœºéªŒè¯ç ç­‰ä¹‹ç±»çš„å‡­è¯æ¥éªŒè¯ã€‚åªæœ‰æ›´é«˜çº§åˆ«çš„è¦æ±‚çš„ç³»ç»Ÿï¼Œæ¯”å¦‚å¤§é¢ç½‘é“¶è½¬è´¦ç­‰ï¼Œå°±ä¼šæä¾›åŒå‘è®¤è¯çš„åœºæ™¯ï¼Œæ¥ç¡®ä¿å¯¹å®¢æˆ·èº«ä»½æä¾›è®¤è¯æ€§ HTTPS è¿æ¥è¿‡ç¨‹å’Œä¼˜åŒ–æˆ‘ä»¬çŸ¥é“äº† https å°±åªæ˜¯æ¯” http å¤šäº†ä¸€æ­¥ TLS è¿æ¥ TLS è¿æ¥æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Œæ ¹æ® TLS ç‰ˆæœ¬å’Œå¯†é’¥äº¤æ¢æ³•ä¸åŒï¼Œè¿‡ç¨‹ä¹Ÿä¸ä¸€æ ·ï¼Œæœ‰ä¸‰ç§æ–¹å¼ RSA æ¡æ‰‹æ—©æœŸçš„ TLS å¯†é’¥äº¤æ¢æ³•éƒ½æ˜¯ä½¿ç”¨ RSA ç®—æ³•ï¼Œå®ƒçš„æ¡æ‰‹æµç¨‹æ˜¯è¿™æ ·å­çš„ æµè§ˆå™¨ç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªéšæœºæ•°client-randomå’Œä¸€ä¸ªæ”¯æŒçš„åŠ å¯†æ–¹æ³•åˆ—è¡¨ æœåŠ¡å™¨æŠŠå¦ä¸€ä¸ªéšæœºæ•°server-randomã€åŠ å¯†æ–¹æ³•ã€å…¬é’¥ä¼ ç»™æµè§ˆå™¨ æµè§ˆå™¨åˆç”Ÿæˆå¦ä¸€ä¸ªéšæœºæ•°pre-randomï¼Œå¹¶ç”¨å…¬é’¥åŠ å¯†åä¼ ç»™æœåŠ¡å™¨ æœåŠ¡å™¨å†ç”¨ç§é’¥è§£å¯†ï¼Œå¾—åˆ°pre-randomï¼Œæ­¤æ—¶æµè§ˆå™¨å’ŒæœåŠ¡å™¨éƒ½å¾—åˆ°ä¸‰ä¸ªéšæœºæ•°äº†ï¼Œå„è‡ªå°†ä¸‰ä¸ªéšæœºæ•°ç”¨åŠ å¯†æ–¹æ³•æ··åˆç”Ÿæˆæœ€ç»ˆå¯†é’¥ ç„¶åå¼€å§‹é€šä¿¡ TLS 1.2 ç‰ˆTLS 1.2ç‰ˆçš„ç”¨çš„æ˜¯ECDHEå¯†é’¥äº¤æ¢æ³•ï¼Œçœ‹å›¾ æµè§ˆå™¨ç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªéšæœºæ•°client-randomã€TLS ç‰ˆæœ¬å’Œä¸€ä¸ªæ”¯æŒçš„åŠ å¯†æ–¹æ³•åˆ—è¡¨ æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªæ¤­åœ†æ›²çº¿å‚æ•°server-paramsã€éšæœºæ•°server-randomã€åŠ å¯†æ–¹æ³•ã€è¯ä¹¦ç­‰ä¼ ç»™æµè§ˆå™¨ æµè§ˆå™¨åˆç”Ÿæˆæ¤­åœ†æ›²çº¿å‚æ•°client-paramsï¼Œæ¡æ‰‹æ•°æ®æ‘˜è¦ç­‰ä¿¡æ¯ä¼ ç»™æœåŠ¡å™¨ æœåŠ¡å™¨å†è¿”å›æ‘˜è¦ç»™æµè§ˆå™¨ç¡®è®¤åº”ç­” è¿™ä¸ªç‰ˆæœ¬ä¸å†ç”Ÿæˆæ¤­åœ†æ›²çº¿å‚æ•°cliend-paramså’Œserver-paramsï¼Œè€Œæ˜¯åœ¨æœåŠ¡å™¨å’Œæµè§ˆå™¨ä¸¤è¾¹éƒ½å¾—åˆ°server-paramså’Œclient-paramsä¹‹åï¼Œå°±ç”¨ ECDHE ç®—æ³•ç›´æ¥ç®—å‡ºpre-randomï¼Œè¿™å°±ä¸¤è¾¹éƒ½æœ‰äº†ä¸‰ä¸ªéšæœºæ•°ï¼Œç„¶åå„è‡ªå†å°†ä¸‰ä¸ªéšæœºåŠ å¯†æ··åˆç”Ÿæˆæœ€ç»ˆå¯†é’¥ TLS 1.3 ç‰ˆåœ¨ TLS1.3 ç‰ˆæœ¬ä¸­åºŸå¼ƒäº† RSA ç®—æ³•ï¼Œå› ä¸º RSA ç®—æ³•å¯èƒ½æ³„éœ²ç§é’¥å¯¼è‡´å†å²æŠ¥æ–‡å…¨éƒ¨è¢«ç ´è§£ï¼Œè€Œ ECDHE ç®—æ³•æ¯æ¬¡æ¡æ‰‹éƒ½ä¼šç”Ÿæˆä¸´æ—¶çš„å¯†é’¥ï¼Œæ‰€ä»¥å°±ç®—ç§é’¥è¢«ç ´è§£ï¼Œä¹Ÿåªèƒ½ç ´è§£ä¸€æ¡æŠ¥æ–‡ï¼Œè€Œä¸ä¼šå¯¹ä¹‹å‰çš„å†å²ä¿¡æ¯äº§ç”Ÿå½±å“ï¼Œï¼Œæ‰€ä»¥åœ¨ TLS 1.3 ä¸­å½»åº•å–ä»£äº† RSAã€‚ç›®å‰ä¸»æµéƒ½æ˜¯ç”¨ECDHEç®—æ³•æ¥åšå¯†é’¥äº¤æ¢çš„ TLS1.3 ç‰ˆæœ¬ä¸­æ¡æ‰‹è¿‡ç¨‹æ˜¯è¿™æ ·å­çš„ æµè§ˆå™¨ç”Ÿæˆclient-paramsã€å’Œclient-randomã€TLS ç‰ˆæœ¬å’ŒåŠ å¯†æ–¹æ³•åˆ—è¡¨å‘é€ç»™æœåŠ¡å™¨ æœåŠ¡å™¨è¿”å›server-paramsã€server-randomã€åŠ å¯†æ–¹æ³•ã€è¯ä¹¦ã€æ‘˜è¦ç­‰ä¼ ç»™æµè§ˆå™¨ æµè§ˆå™¨ç¡®è®¤åº”ç­”ï¼Œè¿”å›æ¡æ‰‹æ•°æ®æ‘˜è¦ç­‰ä¿¡æ¯ä¼ ç»™æœåŠ¡å™¨ ç®€å•è¯´å°±æ˜¯ç®€åŒ–äº†æ¡æ‰‹è¿‡ç¨‹ï¼Œåªæœ‰ä¸‰æ­¥ï¼ŒæŠŠåŸæ¥çš„ä¸¤ä¸ª RTT æ‰“åŒ…æˆä¸€ä¸ªå‘é€äº†ï¼Œæ‰€ä»¥å‡å°‘äº†ä¼ è¾“æ¬¡æ•°ã€‚è¿™ç§æ¡æ‰‹æ–¹å¼ä¹Ÿå«1-RTTæ¡æ‰‹ è¿™ç§æ¡æ‰‹æ–¹è¿˜æœ‰ä¼˜åŒ–ç©ºé—´å—ï¼Ÿ æœ‰çš„ï¼Œç”¨ä¼šè¯å¤ç”¨ ä¼šè¯å¤ç”¨ä¼šè¯å¤ç”¨æœ‰ä¸¤ç§æ–¹å¼ï¼šSession ID å’Œ Session Ticket **Session ID**ï¼šå°±æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨é¦–æ¬¡è¿æ¥æ‰‹å„è‡ªä¿å­˜ä¼šè¯ IDï¼Œå¹¶å­˜å‚¨ä¼šè¯å¯†é’¥ï¼Œä¸‹æ¬¡å†è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å‘é€ ID è¿‡æ¥ï¼ŒæœåŠ¡å™¨è¿™è¾¹å†æŸ¥æ‰¾ IDï¼Œå¦‚æœæ‰¾åˆ°äº†å°±ç›´æ¥å¤ç”¨ä¼šè¯ï¼Œå¯†é’¥ä¹Ÿä¸ç”¨é‡æ–°ç”Ÿæˆ å¯æ˜¯è¿™æ ·çš„è¯ï¼Œåœ¨å®¢æˆ·ç«¯æ•°é‡åºå¤§çš„æ—¶å€™ï¼Œå¯¹æœåŠ¡å™¨çš„å­˜å‚¨å‹åŠ›å¯å°±å¤§äº† æ‰€ä»¥å‡ºæ¥äº†ç¬¬äºŒç§æ–¹å¼ **Session Ticket**ï¼šå°±æ˜¯åŒæ–¹è¿æ¥æˆåŠŸåæœåŠ¡å™¨åŠ å¯†ä¼šè¯ä¿¡æ¯ï¼Œç”¨ Session Ticket æ¶ˆæ¯å‘ç»™å®¢æˆ·ç«¯å­˜å‚¨èµ·æ¥ï¼Œä¸‹æ¬¡å†è¿æ¥æ—¶å°±æŠŠè¿™ä¸ª Session Ticket è§£å¯†ï¼ŒéªŒè¯æœ‰æ²¡æœ‰è¿‡æœŸï¼Œå¦‚æœæ²¡æœ‰è¿‡æœŸå°±å¤ç”¨ä¼šè¯ã€‚åŸç†å°±æ˜¯æŠŠå­˜å‚¨å‹åŠ›åˆ†ç»™å®¢æˆ·ç«¯ã€‚ è¿™æ ·å°±ä¸‡æ— ä¸€å¤±äº†å—ï¼Ÿ Noï¼Œè¿™æ ·ä¹Ÿå­˜åœ¨å®‰å…¨é—®é¢˜ã€‚å› ä¸ºæ¯æ¬¡è¦ç”¨ä¸€ä¸ªå›ºå®šçš„å¯†é’¥æ¥è§£å¯† Session Ticketï¼Œä¸€æ—¦å¯†é’¥è¢«çªƒå–ï¼Œé‚£æ‰€æœ‰å†å²è®°å½•ä¹Ÿå°±è¢«ç ´è§£äº†ï¼Œæ‰€ä»¥åªèƒ½å°½é‡é¿å…è¿™ç§é—®é¢˜å®šæœŸæ›´æ¢å¯†é’¥ã€‚æ¯•ç«ŸèŠ‚çœäº†ä¸å°‘ç”Ÿæˆä¼šè¯å¯†é’¥å’Œè¿™äº›ç®—æ³•çš„è€—æ—¶ï¼Œæ€§èƒ½è¿˜æ˜¯æå‡äº†å˜› é‚£åˆšè¯´äº†1-RTTï¼Œé‚£èƒ½ä¸èƒ½ä¼˜åŒ–åˆ°0-RTTå‘¢ è¿˜çœŸå¯ä»¥ï¼Œåšæ³•å°±æ˜¯å‘é€ Session Ticket çš„æ—¶å€™å¸¦ä¸Šåº”ç”¨æ•°æ®ï¼Œä¸ç”¨ç­‰æœåŠ¡ç«¯ç¡®è®¤ã€‚è¿™ç§æ–¹å¼è¢«ç§°ä¸ºPSK(Pre-Shared Key) è¿™æ ·ä¸‡æ— ä¸€å¤±äº†å—ï¼Ÿ å°´äº†ä¸ªå°¬ï¼Œè¿˜æ˜¯ä¸è¡Œã€‚è¿™ PSK è¦æ˜¯è¢«çªƒå–ï¼Œäººå®¶ä¸æ–­å‘æœåŠ¡å™¨é‡å‘ï¼Œå°±ç›´æ¥å¢åŠ äº†æœåŠ¡å™¨è¢«æ”»å‡»çš„é£é™© è™½ç„¶ä¸æ˜¯ç»å¯¹å®‰å…¨ï¼Œä½†æ˜¯ç°è¡Œæ¶æ„ä¸‹æœ€å®‰å…¨çš„è§£å†³æ–‡æ¡ˆäº†ï¼Œå¤§å¤§å¢åŠ äº†ä¸­é—´äººçš„æ”»å‡»æˆæœ¬ HTTPS ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ å†…å®¹åŠ å¯†ï¼Œä¸­é—´æ— æ³•æŸ¥çœ‹åŸå§‹å†…å®¹ èº«ä»½è®¤è¯ï¼Œä¿è¯ç”¨æˆ·è®¿é—®æ­£ç¡®ã€‚å¦‚è®¿é—®ç™¾åº¦ï¼Œå³ä½¿ DNS è¢«åŠ«æŒåˆ°ç¬¬ä¸‰æ–¹ç«™ç‚¹ï¼Œä¹Ÿä¼šæé†’ç”¨æˆ·æ²¡æœ‰è®¿é—®ç™¾åº¦æœåŠ¡ï¼Œå¯èƒ½è¢«åŠ«æŒ æ•°æ®å®Œæ•´æ€§ï¼Œé˜²æ­¢å†…å®¹è¢«ç¬¬ä¸‰æ–¹å†’å……æˆ–ç¯¡æ”¹ è™½ç„¶ä¸æ˜¯ç»å¯¹å®‰å…¨ï¼Œä½†æ˜¯ç°è¡Œæ¶æ„ä¸‹æœ€å®‰å…¨çš„è§£å†³æ–‡æ¡ˆäº†ï¼Œå¤§å¤§å¢åŠ äº†ä¸­é—´äººçš„æ”»å‡»æˆæœ¬ ç¼ºç‚¹ è¦é’±ï¼ŒåŠŸèƒ½è¶Šå¼ºå¤§çš„è¯ä¹¦è´¹ç”¨è¶Šè´µ è¯ä¹¦éœ€è¦ç»‘å®š IPï¼Œä¸èƒ½åœ¨åŒä¸€ä¸ª IP ä¸Šç»‘å®šå¤šä¸ªåŸŸå https åŒæ–¹åŠ è§£å¯†ï¼Œè€—è´¹æ›´å¤šæœåŠ¡å™¨èµ„æº https æ¡æ‰‹æ›´è€—æ—¶ï¼Œé™ä½ä¸€å®šç”¨æˆ·è®¿é—®é€Ÿåº¦(ä¼˜åŒ–å¥½å°±ä¸æ˜¯ç¼ºç‚¹äº†) HTTP å’Œ HTTPS çš„åŒºåˆ« HTTP æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œä¸å®‰å…¨çš„ï¼ŒHTTPS æ˜¯åŠ å¯†ä¼ è¾“ï¼Œå®‰å…¨çš„å¤š HTTP æ ‡å‡†ç«¯å£æ˜¯80ï¼ŒHTTPS æ ‡å‡†ç«¯å£æ˜¯443 HTTP ä¸ç”¨è®¤è¯è¯ä¹¦å…è´¹ï¼ŒHTTPS éœ€è¦è®¤è¯è¯ä¹¦è¦é’± è¿æ¥æ–¹å¼ä¸åŒï¼ŒHTTP ä¸‰æ¬¡æ¡æ‰‹ï¼ŒHTTPS ä¸­ TLS1.2 ç‰ˆæœ¬ 7 æ¬¡ï¼ŒTLS1.3 ç‰ˆæœ¬ 6 æ¬¡ HTTP åœ¨ OSI ç½‘ç»œæ¨¡å‹ä¸­æ˜¯åœ¨åº”ç”¨å±‚ï¼Œè€Œ HTTPS çš„ TLS æ˜¯åœ¨ä¼ è¾“å±‚ HTTP æ˜¯æ— çŠ¶æ€çš„ï¼ŒHTTPS æ˜¯æœ‰çŠ¶æ€çš„ HTTPS çš„æ€§èƒ½ä¼˜åŒ–è®¿é—®é€Ÿåº¦ä¼˜åŒ– ä¼šè¯å¤ç”¨ï¼Œä¸Šé¢è¯´äº†ï¼Œå¤ç”¨ session å¯ä»¥å‡å°‘ CPU æ¶ˆè€—ï¼Œå› ä¸ºä¸éœ€è¦è¿›è¡Œéå¯¹ç§°å¯†é’¥äº¤æ¢çš„è®¡ç®—ã€‚å¯ä»¥æå‡è®¿é—®é€Ÿåº¦ï¼Œä¸éœ€è¦è¿›è¡Œå®Œå…¨æ¡æ‰‹é˜¶æ®µäºŒï¼ŒèŠ‚çœäº†ä¸€ä¸ª RTT å’Œè®¡ç®—è€—æ—¶ã€‚ ä½¿ç”¨ SPDY æˆ–è€… HTTP2ã€‚SPDY æœ€å¤§çš„ç‰¹æ€§å°±æ˜¯å¤šè·¯å¤ç”¨ï¼Œèƒ½å°†å¤šä¸ª HTTP è¯·æ±‚åœ¨åŒä¸€ä¸ªè¿æ¥ä¸Šä¸€èµ·å‘å‡ºå»ï¼Œä¸åƒç›®å‰çš„ HTTP åè®®ä¸€æ ·ï¼Œåªèƒ½ä¸²è¡Œåœ°é€ä¸ªå‘é€è¯·æ±‚ã€‚Pipeline è™½ç„¶æ”¯æŒå¤šä¸ªè¯·æ±‚ä¸€èµ·å‘é€ï¼Œä½†æ˜¯æ¥æ”¶æ—¶ä¾ç„¶å¾—æŒ‰ç…§é¡ºåºæ¥æ”¶ï¼Œæœ¬è´¨ä¸Šæ— æ³•è§£å†³å¹¶å‘çš„é—®é¢˜ã€‚HTTP2 æ”¯æŒå¤šè·¯å¤ç”¨ï¼Œæœ‰åŒæ ·çš„æ•ˆæœã€‚ è®¾ç½®HSTSï¼ŒæœåŠ¡ç«¯è¿”å›ä¸€ä¸ª HSTS çš„ http headerï¼Œæµè§ˆå™¨è·å–åˆ° HSTS å¤´éƒ¨ä¹‹åï¼Œåœ¨ä¸€æ®µæ—¶é—´å†…ï¼Œä¸ç®¡ç”¨æˆ·è¾“å…¥www.baidu.comè¿˜æ˜¯http://www.baidu.com ï¼Œéƒ½ä¼šé»˜è®¤å°†è¯·æ±‚å†…éƒ¨è·³è½¬æˆ https://www.baidu.comã€‚Chrome, firefox, ie éƒ½æ”¯æŒäº† HSTSã€‚ Nginxè®¾ç½®Ocsp staplingã€‚Ocsp å…¨ç§°åœ¨çº¿è¯ä¹¦çŠ¶æ€æ£€æŸ¥åè®® (rfc6960)ï¼Œç”¨æ¥å‘ CA ç«™ç‚¹æŸ¥è¯¢è¯ä¹¦çŠ¶æ€ï¼Œæ¯”å¦‚æ˜¯å¦æ’¤é”€ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä½¿ç”¨ OCSP åè®®å‘èµ·æŸ¥è¯¢è¯·æ±‚ï¼ŒCA è¿”å›è¯ä¹¦çŠ¶æ€å†…å®¹ï¼Œç„¶åæµè§ˆå™¨æ¥å—è¯ä¹¦æ˜¯å¦å¯ä¿¡çš„çŠ¶æ€ã€‚è¿™ä¸ªè¿‡ç¨‹éå¸¸æ¶ˆè€—æ—¶é—´ï¼Œå› ä¸º CA ç«™ç‚¹æœ‰å¯èƒ½åœ¨å›½å¤–ï¼Œç½‘ç»œä¸ç¨³å®šï¼ŒRTT ä¹Ÿæ¯”è¾ƒå¤§ã€‚å¦‚æœä¸éœ€è¦æŸ¥è¯¢åˆ™å¯èŠ‚çº¦æ—¶é—´ã€‚ False startã€‚ç®€å•æ¦‚æ‹¬ False start çš„åŸç†å°±æ˜¯åœ¨ clientkeyexchange å‘å‡ºæ—¶å°†åº”ç”¨å±‚æ•°æ®ä¸€èµ·å‘å‡ºæ¥ï¼Œèƒ½å¤ŸèŠ‚çœä¸€ä¸ª RTTã€‚ è®¡ç®—æ€§èƒ½ä¼˜åŒ– ä¼˜å…ˆä½¿ç”¨ ECC æ¤­åœ†åŠ å¯†ç®—æœ¯ ä½¿ç”¨æœ€æ–°ç‰ˆçš„ OpenSSL TLS è¿œç¨‹ä»£ç†è®¡ç®— ç¡¬ä»¶åŠ é€Ÿæ–¹æ¡ˆ HTTP ç‰ˆæœ¬1991 å¹´ HTTP 0.9 ç‰ˆï¼Œåªæœ‰ä¸€ä¸ª GETï¼Œè€Œä¸”åªæ”¯æŒçº¯æ–‡æœ¬å†…å®¹ï¼Œæ—©å·²è¿‡æ—¶å°±ä¸è®²äº† HTTP 1.0(1996 å¹´) ä»»æ„æ•°æ®ç±»å‹éƒ½å¯ä»¥å‘é€ æœ‰ GETã€POSTã€HEAD ä¸‰ç§æ–¹æ³• æ— æ³•å¤ç”¨ TCP è¿æ¥(é•¿è¿æ¥) æœ‰ä¸°å¯Œçš„è¯·æ±‚å“åº”å¤´ä¿¡æ¯ã€‚ä»¥ header ä¸­çš„Last-Modified/If-Modified-Sinceå’ŒExpiresä½œä¸ºç¼“å­˜æ ‡è¯† HTTP 1.1(1997 å¹´) å¼•å…¥æ›´å¤šçš„è¯·æ±‚æ–¹æ³•ç±»å‹PUTã€PATCHã€DELETEã€OPTIONSã€TRACEã€CONNECT å¼•å…¥é•¿è¿æ¥ï¼Œå°±æ˜¯ TCP è¿æ¥é»˜è®¤ä¸å…³é—­ï¼Œå¯ä»¥è¢«å¤šä¸ªè¯·æ±‚å¤ç”¨ï¼Œé€šè¿‡è¯·æ±‚å¤´ connection:keep-alive è®¾ç½® å¼•å…¥ç®¡é“è¿æ¥æœºåˆ¶ï¼Œå¯ä»¥åœ¨åŒä¸€ TCP è¿æ¥é‡Œï¼ŒåŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚ å¼ºåŒ–äº†ç¼“å­˜ç®¡ç†å’Œæ§åˆ¶Cache-Controlã€ETag/If-None-Match æ”¯æŒåˆ†å—å“åº”ï¼Œæ–­ç‚¹ç»­ä¼ ï¼Œåˆ©äºå¤§æ–‡ä»¶ä¼ è¾“ï¼Œèƒ½è¿‡è¯·æ±‚å¤´ä¸­çš„Rangeå®ç° ä½¿ç”¨äº†è™šæ‹Ÿç½‘ç»œï¼Œåœ¨ä¸€å°ç‰©ç†æœåŠ¡å™¨ä¸Šå¯ä»¥å­˜åœ¨å¤šä¸ªè™šæ‹Ÿä¸»æœºï¼Œå¹¶ä¸”å…±äº«ä¸€ä¸ª IP åœ°å€ ç¼ºç‚¹ï¼šä¸»è¦æ˜¯è¿æ¥ç¼“æ…¢ï¼ŒæœåŠ¡å™¨åªèƒ½æŒ‰é¡ºåºå“åº”ï¼Œå¦‚æœæŸä¸ªè¯·æ±‚èŠ±äº†å¾ˆé•¿æ—¶é—´ï¼Œå°±ä¼šå‡ºç°è¯·æ±‚é˜Ÿå¤´é˜»å¡ è™½ç„¶å‡ºäº†å¾ˆå¤šä¼˜åŒ–æŠ€å·§ï¼šä¸ºäº†å¢åŠ å¹¶å‘è¯·æ±‚ï¼ŒåšåŸŸåæ‹†åˆ†ã€èµ„æºåˆå¹¶ã€ç²¾çµå›¾ã€èµ„æºé¢„å–â€¦ç­‰ç­‰ æœ€ç»ˆä¸ºäº†æ¨è¿›ä»åè®®ä¸Šè¿›è¡Œä¼˜åŒ–ï¼ŒGoogle è·³å‡ºæ¥ï¼Œæ¨å‡ºSPDYåè®® SPDY(2009 å¹´)SPDYï¼ˆè¯»ä½œâ€œSPeeDYâ€ï¼‰æ˜¯ Google å¼€å‘çš„åŸºäº TCP çš„ä¼šè¯å±‚åè®® ä¸»è¦é€šè¿‡å¸§ã€å¤šè·¯å¤ç”¨ã€è¯·æ±‚ä¼˜å…ˆçº§ã€HTTP æŠ¥å¤´å‹ç¼©ã€æœåŠ¡å™¨æ¨é€ä»¥æœ€å°åŒ–ç½‘ç»œå»¶è¿Ÿï¼Œæå‡ç½‘ç»œé€Ÿåº¦ï¼Œä¼˜åŒ–ç”¨æˆ·çš„ç½‘ç»œä½¿ç”¨ä½“éªŒ åŸç†æ˜¯åœ¨ SSL å±‚ä¸Šå¢åŠ ä¸€ä¸ª SPDY ä¼šè¯å±‚ï¼Œä»¥åœ¨ä¸€ä¸ª TCP è¿æ¥ä¸­å®ç°å¹¶å‘æµã€‚é€šå¸¸çš„ HTTP GET å’Œ POST æ ¼å¼ä»ç„¶æ˜¯ä¸€æ ·çš„ï¼Œç„¶è€Œ SPDY ä¸ºç¼–ç å’Œä¼ è¾“æ•°æ®è®¾è®¡äº†ä¸€ä¸ªæ–°çš„å¸§æ ¼å¼ã€‚å› ä¸ºæµæ˜¯åŒå‘çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯åŠ¨ è™½ç„¶è¯ç”Ÿåå¾ˆå¿«è¢«æ‰€æœ‰ä¸»æµæµè§ˆå™¨æ‰€é‡‡ç”¨ï¼Œå¹¶ä¸”æœåŠ¡å™¨å’Œä»£ç†ä¹Ÿæä¾›äº†æ”¯æŒï¼Œä½†æ˜¯ SPDY æ ¸å¿ƒäººå‘˜åæ¥éƒ½å‚åŠ åˆ° HTTP 2.0 å¼€å‘ä¸­å»äº†ï¼Œè‡ª HTTP2.0 å¼€å‘å®Œæˆå°±ä¸å†æ”¯æŒ SPDY åè®®äº†ï¼Œå¹¶åœ¨ Chrome 51 ä¸­åˆ æ‰äº† SPDY çš„æ”¯æŒ HTTP 2.0(2015 å¹´)è¯´å‡º http2 ä¸­è‡³å°‘ä¸‰ä¸ªæ–°ç‰¹æ€§ï¼Ÿ ä½¿ç”¨æ–°çš„äºŒè¿›åˆ¶åè®®ï¼Œä¸å†æ˜¯çº¯æ–‡æœ¬ï¼Œé¿å…æ–‡æœ¬æ­§ä¹‰ï¼Œç¼©å°äº†è¯·æ±‚ä½“ç§¯ å¤šè·¯å¤ç”¨ï¼ŒåŒåŸŸåä¸‹æ‰€æœ‰é€šä¿¡éƒ½æ˜¯åœ¨å•é“¾æ¥(åŒå‘æ•°æ®æµ)å®Œæˆï¼Œæé«˜è¿æ¥çš„å¤ç”¨ç‡ï¼Œåœ¨æ‹¥å¡æ§åˆ¶æ–¹é¢æœ‰æ›´å¥½çš„èƒ½åŠ›æå‡ ä½¿ç”¨HPACKç®—æ³•å°†å¤´éƒ¨å‹ç¼©ï¼Œç”¨å“ˆå¤«æ›¼ç¼–ç å»ºç«‹ç´¢è¡¨ï¼Œä¼ é€ç´¢å¼•å¤§å¤§èŠ‚çº¦äº†å¸¦å®½ å…è®¸æœåŠ¡ç«¯ä¸»åŠ¨æ¨é€æ•°æ®ç»™å®¢æˆ·ç«¯ å¢åŠ äº†å®‰å…¨æ€§ï¼Œä½¿ç”¨ HTTP 2.0ï¼Œè¦æ±‚å¿…é¡»è‡³å°‘ TLS 1.2 ä½¿ç”¨è™šæ‹Ÿçš„æµä¼ è¾“æ¶ˆæ¯ï¼Œè§£å†³äº†åº”ç”¨å±‚çš„é˜Ÿå¤´é˜»å¡é—®é¢˜ ç¼ºç‚¹ TCP ä»¥åŠ TCP+TLS å»ºç«‹è¿æ¥çš„å»¶æ—¶ï¼ŒHTTP2 ä½¿ç”¨ TCP åè®®æ¥ä¼ è¾“çš„ï¼Œè€Œå¦‚æœä½¿ç”¨ HTTPS çš„è¯ï¼Œè¿˜éœ€è¦ TLS åè®®è¿›è¡Œå®‰å…¨ä¼ è¾“ï¼Œè€Œä½¿ç”¨ TLS ä¹Ÿéœ€è¦ä¸€ä¸ªæ¡æ‰‹è¿‡ç¨‹ï¼Œåœ¨ä¼ è¾“æ•°æ®ä¹‹å‰ï¼Œå¯¼è‡´æˆ‘ä»¬èŠ±æ‰ 3~4 ä¸ª RTT TCP çš„é˜Ÿå¤´é˜»å¡å¹¶æ²¡æœ‰å½»åº•è§£å†³ã€‚åœ¨ HTTP2 ä¸­ï¼Œå¤šä¸ªè¯·æ±‚è·‘åœ¨ä¸€ä¸ª TCP ç®¡é“ä¸­ï¼Œä½†å½“ HTTP2 å‡ºç°ä¸¢åŒ…æ—¶ï¼Œæ•´ä¸ª TCP éƒ½è¦å¼€å§‹ç­‰å¾…é‡ä¼ ï¼Œé‚£ä¹ˆå°±ä¼šé˜»å¡è¯¥ TCP è¿æ¥ä¸­çš„æ‰€æœ‰è¯·æ±‚ SPDY å’Œ HTTP2 çš„åŒºåˆ« å¤´éƒ¨å‹ç¼©ç®—æ³•ï¼ŒSPDY æ˜¯é€šç”¨çš„deflateç®—æ³•ï¼ŒHTTP2 æ˜¯ä¸“é—¨ä¸ºå‹ç¼©å¤´éƒ¨è®¾è®¡çš„HPACKç®—æ³• SPDY å¿…é¡»åœ¨TLSä¸Šè¿è¡Œï¼ŒHTTP2 å¯åœ¨TCPä¸Šç›´æ¥ä½¿ç”¨ï¼Œå› ä¸ºå¢åŠ äº† HTTP1.1 çš„ Upgrade æœºåˆ¶ SPDY æ›´åŠ å®Œå–„çš„åè®®å•†è®¨å’Œç¡®è®¤æµç¨‹ SPDY æ›´åŠ å®Œå–„çš„ Server Push æµç¨‹ SPDY å¢åŠ æ§åˆ¶å¸§çš„ç§ç±»ï¼Œå¹¶å¯¹å¸§çš„æ ¼å¼è€ƒè™‘çš„æ›´ç»†è‡´ HTTP1 å’Œ HTTP2 HTTP2 æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶åè®®ï¼ŒHTTP1 æ˜¯è¶…æ–‡æœ¬åè®®ï¼Œä¼ è¾“çš„å†…å®¹éƒ½ä¸æ˜¯ä¸€æ ·çš„ HTTP2 æŠ¥å¤´å‹ç¼©ï¼Œå¯ä»¥ä½¿ç”¨ HPACK è¿›è¡Œå¤´éƒ¨å‹ç¼©ï¼ŒHTTP1 åˆ™ä¸è®ºä»€ä¹ˆè¯·æ±‚éƒ½ä¼šå‘é€ HTTP2æœåŠ¡ç«¯æ¨é€(Server push)ï¼Œå…è®¸æœåŠ¡å™¨é¢„å…ˆå°†ç½‘é¡µæ‰€éœ€è¦çš„èµ„æº push åˆ°æµè§ˆå™¨çš„å†…å­˜å½“ä¸­ HTTP2 éµå¾ªå¤šè·¯å¤ç”¨ï¼Œä»£æ›¿åŒä¸€åŸŸåä¸‹çš„å†…å®¹ï¼Œåªå»ºç«‹ä¸€æ¬¡è¿æ¥ï¼ŒHTTP1.x ä¸æ˜¯ï¼Œå¯¹åŸŸåæœ‰ 6~8 ä¸ªè¿æ¥é™åˆ¶ HTTP2 å¼•å…¥äºŒè¿›åˆ¶æ•°æ®å¸§å’Œæµçš„æ¦‚å¿µï¼Œå…¶ä¸­å¸§å¯¹æ•°æ®è¿›è¡Œé¡ºåºæ ‡è¯†ï¼Œè¿™æ ·æµè§ˆå™¨æ”¶åˆ°æ•°æ®ä¹‹åï¼Œå°±å¯ä»¥æŒ‰ç…§åºåˆ—å¯¹æ•°æ®è¿›è¡Œåˆå¹¶ï¼Œè€Œä¸ä¼šå‡ºç°åˆå¹¶åæ•°æ®é”™ä¹±çš„æƒ…å†µï¼ŒåŒæ ·æ˜¯å› ä¸ºæœ‰äº†åºåˆ—ï¼ŒæœåŠ¡å™¨å°±å¯ä»¥å¹¶è¡Œçš„ä¼ è¾“æ•°æ®ï¼Œè¿™å°±æ˜¯æµæ‰€åšçš„äº‹æƒ…ã€‚HTTP2 å¯¹åŒä¸€åŸŸåä¸‹æ‰€æœ‰è¯·æ±‚éƒ½æ˜¯åŸºäºæµçš„ï¼Œä¹Ÿå°±æ˜¯è¯´åŒä¸€åŸŸåä¸‹ä¸ç®¡è®¿é—®å¤šå°‘æ–‡ä»¶ï¼Œåªå»ºç«‹ä¸€æ¬¡è¿æ¥ HTTP 3.0/QUICç”±äº HTTP 2.0 ä¾èµ–äº TCPï¼ŒTCP æœ‰ä»€ä¹ˆé—®é¢˜é‚£ HTTP2 å°±ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ã€‚æœ€ä¸»è¦çš„è¿˜æ˜¯é˜Ÿå¤´é˜»å¡ï¼Œåœ¨åº”ç”¨å±‚çš„é—®é¢˜è§£å†³äº†ï¼Œå¯æ˜¯åœ¨ TCP åè®®å±‚çš„é˜Ÿå¤´é˜»å¡è¿˜æ²¡æœ‰è§£å†³ã€‚ TCP åœ¨ä¸¢åŒ…çš„æ—¶å€™ä¼šè¿›è¡Œé‡ä¼ ï¼Œå‰é¢æœ‰ä¸€ä¸ªåŒ…æ²¡æ”¶åˆ°ï¼Œå°±åªèƒ½æŠŠåé¢çš„åŒ…æ”¾åˆ°ç¼“å†²åŒºï¼Œåº”ç”¨å±‚æ˜¯æ— æ³•å–æ•°æ®çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ HTTP2 çš„å¤šè·¯å¤ç”¨å¹¶è¡Œæ€§å¯¹äº TCP çš„ä¸¢å¤±æ¢å¤æœºåˆ¶ä¸ç®¡ç”¨ï¼Œå› æ­¤ä¸¢å¤±æˆ–é‡æ–°æ’åºçš„æ•°æ®éƒ½ä¼šå¯¼è‡´äº¤äº’æŒ‚æ‰ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒGoogle åˆå‘æ˜äº†QUICåè®® å¹¶åœ¨ 2018 å¹´ 11 æœˆå°† QUIC æ­£å¼æ”¹åä¸ºHTTP 3.0 ç‰¹ç‚¹ï¼š åœ¨ä¼ è¾“å±‚ç›´æ¥å¹²æ‰ TCPï¼Œç”¨UDPæ›¿ä»£ å®ç°äº†ä¸€å¥—æ–°çš„æ‹¥å¡æ§åˆ¶ç®—æ³•ï¼Œå½»åº•è§£å†³ TCP ä¸­é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ å®ç°äº†ç±»ä¼¼ TCP çš„æµé‡æ§åˆ¶ã€ä¼ è¾“å¯é æ€§çš„åŠŸèƒ½ã€‚è™½ç„¶ UDP ä¸æä¾›å¯é æ€§çš„ä¼ è¾“ï¼Œä½† QUIC åœ¨ UDP çš„åŸºç¡€ä¹‹ä¸Šå¢åŠ äº†ä¸€å±‚æ¥ä¿è¯æ•°æ®å¯é æ€§ä¼ è¾“ã€‚å®ƒæä¾›äº†æ•°æ®åŒ…é‡ä¼ ã€æ‹¥å¡æ§åˆ¶ä»¥åŠå…¶ä»–ä¸€äº› TCP ä¸­å­˜åœ¨çš„ç‰¹æ€§ å®ç°äº†å¿«é€Ÿæ¡æ‰‹åŠŸèƒ½ã€‚ç”±äº QUIC æ˜¯åŸºäº UDP çš„ï¼Œæ‰€ä»¥ QUIC å¯ä»¥å®ç°ä½¿ç”¨ 0-RTT æˆ–è€… 1-RTT æ¥å»ºç«‹è¿æ¥ï¼Œè¿™æ„å‘³ç€ QUIC å¯ä»¥ç”¨æœ€å¿«çš„é€Ÿåº¦æ¥å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚ é›†æˆäº† TLS åŠ å¯†åŠŸèƒ½ã€‚ç›®å‰ QUIC ä½¿ç”¨çš„æ˜¯ TLS1.3 è½¬è½½çœŸï¼ä¸€æ–‡æå®š HTTP å’Œ HTTPS","updated":"2025-08-02T05:46:04.178Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"}]},{"title":"vscodeé¡¹ç›®å›½é™…åŒ–æ’ä»¶","date":"2021-10-13T08:29:10.000Z","path":"2021/10/13/2021-10-13-vscode-i18n/","text":"èƒŒæ™¯ï¼šç”±äºç»å¸¸é‡åˆ°éœ€è¦å›½é™…åŒ–çš„é¡¹ç›®ï¼Œæ¯æ¬¡è¦äº†è§£å­—ä¸²æ˜¯ä»€ä¹ˆæ„æ€ï¼Œéƒ½è¦å»æœç´¢å¯¹åº”çš„å­—ä¸²æ˜¯ä»€ä¹ˆæ„æ€ï¼Œæ¯”è¾ƒæ¶ˆè€—æ—¶é—´ i18n-allysettings.json ä¸­é…ç½® &#123; // èµ„æºæ–‡ä»¶è·¯å¾„ &quot;i18n-ally.localesPaths&quot;: [&quot;src/locale&quot;, &quot;src/common/lang&quot;], // èµ„æºæ–‡ä»¶çš„æ–‡ä»¶ç§ç±»ï¼Œé»˜è®¤ä¸ºjson &quot;i18n-ally.enabledParsers&quot;: [&quot;js&quot;, &quot;ts&quot;], // èµ„æºæ–‡ä»¶çš„æ–‡ä»¶åä½œä¸ºç¬¬ä¸€ä¸ªkey &quot;i18n-ally.namespace&quot;: true, // èµ„æºçš„key &quot;i18n-ally.pathMatcher&quot;: &quot;&#123;namespaces&#125;/&#123;locale&#125;.js&quot;, // é»˜è®¤å±•ç¤ºè¯­è¨€ &quot;i18n-ally.displayLanguage&quot;: &quot;zh&quot;, // flat(&#123;&quot;a.b.c&quot;: &quot;...&quot;&#125;) or nested(&#123;&quot;a&quot;: &#123;&quot;b&quot;: &#123;&quot;c&quot;: &quot;...&quot;&#125;&#125;&#125;) &quot;i18n-ally.keystyle&quot;: &quot;nested&quot;&#125; é»˜è®¤æ”¯æŒçš„æ¡†æ¶åŒ…æ‹¬ vueã€angularã€react ç­‰åŸç”Ÿçš„ i18n å·¥å…· å¦‚æœä¸åœ¨å…¶ä¸­éœ€è¦è‡ªå®šä¹‰ # åœ¨å“ªäº›æ–‡ä»¶ä¸­æ˜¾ç¤ºç¿»è¯‘languageIds: - html - javascript - typescript - javascriptreact - typescriptreactusageMatchRegex: # The following example shows how to detect `t(&quot;your.i18n.keys&quot;)` # the `&#123;key&#125;` will be placed by a proper keypath matching regex, # you can ignore it and use your own matching rules as well - &quot;\\\\s?[&#x27;\\&quot;`](&#123;key&#125;)[&#x27;\\&quot;`]\\\\s?\\\\|\\\\s?i18n&quot; - &quot;[^\\\\w\\\\d]t\\\\([&#x27;\\&quot;`](&#123;key&#125;)[&#x27;\\&quot;`]&quot; - &quot;[^\\\\w\\\\d]transform\\\\([&#x27;\\&quot;`](&#123;key&#125;)[&#x27;\\&quot;`]&quot;monopoly: true i18n-ally æ–‡æ¡£","updated":"2025-08-02T05:46:04.178Z","tags":[{"name":"vscode","slug":"vscode","permalink":"https://luckyship.github.io/tags/vscode/"}]},{"title":"csså±‚å ä¸Šä¸‹æ–‡","date":"2021-10-12T03:06:48.000Z","path":"2021/10/12/2021-10-12-css-stacking-context/","text":"å¯¹äº css çš„å±‚å é¡ºåºä¸€ç›´ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œä½¿ç”¨ z-index çš„æ—¶å€™æœ‰çš„æ—¶å€™ä¸ç”Ÿæ•ˆï¼Œä¸ºå•¥ä¼šäº§ç”Ÿè¿™æ ·çš„åœºæ™¯å‘¢ï¼Œcss çš„å±‚å é¡ºåºåˆ°åº•æ˜¯æ€æ ·çš„ ä»¥å¾€ï¼Œç”±äºè‡ªå·±ä½¿ç”¨ z-index çš„é¢‘ç‡ä¸å¤§ï¼Œæ‰€ä»¥å¯¹è¿™ä¸ª CSS å±æ€§å­˜åœ¨æ¯”è¾ƒç‰‡é¢çš„è®¤è¯†ã€‚ä¸€ç›´è®¤ä¸º z-index å°±æ˜¯ç”¨æ¥æè¿°å®šä¹‰ä¸€ä¸ªå…ƒç´ åœ¨å±å¹• Z è½´ä¸Šçš„å †å é¡ºåºã€‚z-index å€¼è¶Šå¤§åœ¨ Z è½´ä¸Šå°±è¶Šé ä¸Šï¼Œä¹Ÿå°±æ˜¯ç¦»å±å¹•è§‚å¯Ÿè€…è¶Šè¿‘ã€‚æœ€åæ‰å‘ç°è¿™ä¸ªè®¤è¯†å­˜åœ¨å¾ˆå¤§çš„é—®é¢˜ï¼š é¦–å…ˆï¼Œz-index å±æ€§å€¼å¹¶ä¸æ˜¯åœ¨ä»»ä½•å…ƒç´ ä¸Šéƒ½æœ‰æ•ˆæœã€‚å®ƒä»…åœ¨å®šä½å…ƒç´ ï¼ˆå®šä¹‰äº† position å±æ€§ï¼Œä¸”å±æ€§å€¼ä¸ºé static å€¼çš„å…ƒç´ ï¼‰ä¸Šæœ‰æ•ˆæœã€‚ åˆ¤æ–­å…ƒç´ åœ¨ Z è½´ä¸Šçš„å †å é¡ºåºï¼Œä¸ä»…ä»…æ˜¯ç›´æ¥æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ çš„ z-index å€¼çš„å¤§å°ï¼Œè¿™ä¸ªå †å é¡ºåºå®é™…ç”±å…ƒç´ çš„å±‚å ä¸Šä¸‹æ–‡ã€å±‚å ç­‰çº§å…±åŒå†³å®šã€‚ è¦æƒ³å®Œå…¨ç†è§£ä¸€ä¸ªä¸œè¥¿ï¼Œé¦–å…ˆè¦æ˜ç™½å®ƒæ˜¯ä»€ä¹ˆï¼Œä¹Ÿå°±æ˜¯å®ƒçš„å®šä¹‰ã€‚æˆ‘ä»¬å…ˆçœ‹çœ‹ä¸Šé¢æåˆ°çš„å±‚å ä¸Šä¸‹æ–‡ã€å±‚å ç­‰çº§ã€å±‚å é¡ºåºéƒ½æ˜¯ä»€ä¹ˆï¼Ÿå®šä¹‰åˆå¤ªè¿‡æŠ½è±¡ï¼Œåé¢ä¼šå†ç”¨ä¸€ä¸ªå…·è±¡çš„æ¯”å–»æ¥è®©ä½ å½»åº•æ˜ç™½å®ƒä»¬åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆè”ç³»ã€‚ ä»€ä¹ˆæ˜¯å±‚å ä¸Šä¸‹æ–‡å±‚å ä¸Šä¸‹æ–‡(stacking context)ï¼Œæ˜¯ HTML ä¸­ä¸€ä¸ªä¸‰ç»´çš„æ¦‚å¿µã€‚åœ¨ CSS2.1 è§„èŒƒä¸­ï¼Œæ¯ä¸ªç›’æ¨¡å‹çš„ä½ç½®æ˜¯ä¸‰ç»´çš„ï¼Œåˆ†åˆ«æ˜¯å¹³é¢ç”»å¸ƒä¸Šçš„Xè½´ï¼ŒY è½´ä»¥åŠè¡¨ç¤ºå±‚å çš„ Z è½´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå…ƒç´ åœ¨é¡µé¢ä¸Šæ²¿Xè½´ Y è½´å¹³é“ºï¼Œæˆ‘ä»¬å¯Ÿè§‰ä¸åˆ°å®ƒä»¬åœ¨ Z è½´ä¸Šçš„å±‚å å…³ç³»ã€‚è€Œä¸€æ—¦å…ƒç´ å‘ç”Ÿå †å ï¼Œè¿™æ—¶å°±èƒ½å‘ç°æŸä¸ªå…ƒç´ å¯èƒ½è¦†ç›–äº†å¦ä¸€ä¸ªå…ƒç´ æˆ–è€…è¢«å¦ä¸€ä¸ªå…ƒç´ è¦†ç›–ã€‚ å¦‚æœä¸€ä¸ªå…ƒç´ å«æœ‰å±‚å ä¸Šä¸‹æ–‡ï¼Œ(ä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯å±‚å ä¸Šä¸‹æ–‡å…ƒç´ )ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºè¿™ä¸ªå…ƒç´ åœ¨ Z è½´ä¸Šå°±â€œé«˜äººä¸€ç­‰â€ï¼Œæœ€ç»ˆè¡¨ç°å°±æ˜¯å®ƒç¦»å±å¹•è§‚å¯Ÿè€…æ›´è¿‘ã€‚ å…·è±¡çš„æ¯”å–»ï¼šä½ å¯ä»¥æŠŠå±‚å ä¸Šä¸‹æ–‡å…ƒç´ ç†è§£ä¸ºç†è§£ä¸ºè¯¥å…ƒç´ å½“äº†å®˜ï¼Œè€Œå…¶ä»–éå±‚å ä¸Šä¸‹æ–‡å…ƒç´ åˆ™å¯ä»¥ç†è§£ä¸ºæ™®é€šç¾¤ä¼—ã€‚å‡¡æ˜¯â€œå½“äº†å®˜çš„å…ƒç´ â€å°±æ¯”æ™®é€šå…ƒç´ ç­‰çº§è¦é«˜ï¼Œä¹Ÿå°±æ˜¯è¯´å…ƒç´ åœ¨ Z è½´ä¸Šæ›´é ä¸Šï¼Œæ›´é è¿‘è§‚å¯Ÿè€…ã€‚ ä»€ä¹ˆæ˜¯â€œå±‚å ç­‰çº§â€é‚£ä¹ˆï¼Œå±‚å ç­‰çº§æŒ‡çš„åˆæ˜¯ä»€ä¹ˆï¼Ÿå±‚å ç­‰çº§(stacking levelï¼Œå«â€œå±‚å çº§åˆ«â€/â€œå±‚å æ°´å¹³â€ä¹Ÿè¡Œ) åœ¨åŒä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œå®ƒæè¿°å®šä¹‰çš„æ˜¯è¯¥å±‚å ä¸Šä¸‹æ–‡ä¸­çš„å±‚å ä¸Šä¸‹æ–‡å…ƒç´ åœ¨Zè½´ä¸Šçš„ä¸Šä¸‹é¡ºåºã€‚åœ¨å…¶ä»–æ™®é€šå…ƒç´ ä¸­ï¼Œå®ƒæè¿°å®šä¹‰çš„æ˜¯è¿™äº›æ™®é€šå…ƒç´ åœ¨Zè½´ä¸Šçš„ä¸Šä¸‹é¡ºåºã€‚è¯´åˆ°è¿™ï¼Œå¯èƒ½å¾ˆå¤šäººç–‘é—®äº†ï¼Œä¸è®ºåœ¨å±‚å ä¸Šä¸‹æ–‡ä¸­è¿˜æ˜¯åœ¨æ™®é€šå…ƒç´ ä¸­ï¼Œå±‚å ç­‰çº§éƒ½è¡¨ç¤ºå…ƒç´ åœ¨Zè½´ä¸Šçš„ä¸Šä¸‹é¡ºåºï¼Œé‚£å°±ç›´æ¥è¯´å®ƒæè¿°å®šä¹‰äº†æ‰€æœ‰å…ƒç´ åœ¨Zè½´ä¸Šçš„ä¸Šä¸‹é¡ºåºå°± OK å•Šï¼ä¸ºä»€ä¹ˆè¦åˆ†å¼€æè¿°ï¼Ÿ ä¸ºäº†è¯´æ˜åŸå› ï¼Œå…ˆä¸¾ä¸ªæ —å­ï¼š å…·è±¡çš„æ¯”å–»ï¼šæˆ‘ä»¬ä¹‹å‰è¯´åˆ°ï¼Œå¤„äºå±‚å ä¸Šä¸‹æ–‡ä¸­çš„å…ƒç´ ï¼Œå°±åƒæ˜¯å…ƒç´ å½“äº†å®˜ï¼Œç­‰çº§è‡ªç„¶æ¯”æ™®é€šå…ƒç´ é«˜ã€‚å†æƒ³è±¡ä¸€ä¸‹ï¼Œå‡è®¾ä¸€ä¸ªå®˜å‘˜ A æ˜¯ä¸ªçœçº§é¢†å¯¼ï¼Œä»–ä¸‹å±æœ‰ä¸€ä¸ªç§˜ä¹¦ a-1ï¼Œå®¶é‡Œæœ‰ä¸€ä¸ªä¿å§† a-2ã€‚å¦ä¸€ä¸ªå®˜å‘˜ B æ˜¯ä¸€ä¸ªå¿çº§é¢†å¯¼ï¼Œä»–ä¸‹å±æœ‰ä¸€ä¸ªç§˜ä¹¦ b-1ï¼Œå®¶é‡Œæœ‰ä¸€ä¸ªä¿å§† b-2ã€‚a-1 å’Œ b-1 è™½ç„¶éƒ½æ˜¯ç§˜ä¹¦ï¼Œä½†æ˜¯ä½ æƒ³ä¸€ä¸ªçœçº§é¢†å¯¼çš„ç§˜ä¹¦å’Œä¸€ä¸ªå¿çº§é¢†å¯¼çš„ç§˜ä¹¦ä¹‹é—´æœ‰å¯æ¯”æ€§ä¹ˆï¼Ÿç”šè‡³ä¿å§† a-2 éƒ½è¦æ¯”ç§˜ä¹¦ b-1 çš„ç­‰çº§é«˜å¾—å¤šã€‚è°å¤§è°å°ï¼Œè°é«˜è°ä½ä¸€ç›®äº†ç„¶ï¼Œæ‰€ä»¥æ ¹æœ¬æ²¡æœ‰æ¯”è¾ƒçš„æ„ä¹‰ã€‚åªæœ‰åœ¨ A ä¸‹å±çš„ a-1ã€a-2 ä»¥åŠ B ä¸‹å±çš„ b-1ã€b-2 ä¸­ç›¸äº’æ¯”è¾ƒå¤§å°é«˜ä½æ‰æœ‰æ„ä¹‰ å†ç±»æ¯”å›â€œå±‚å ä¸Šä¸‹æ–‡â€å’Œâ€œå±‚å ç­‰çº§â€ï¼Œå°±å¾—å‡ºä¸€ä¸ªç»“è®ºï¼š æ™®é€šå…ƒç´ çš„å±‚å ç­‰çº§ä¼˜å…ˆç”±å…¶æ‰€åœ¨çš„å±‚å ä¸Šä¸‹æ–‡å†³å®šã€‚ å±‚å ç­‰çº§çš„æ¯”è¾ƒåªæœ‰åœ¨å½“å‰å±‚å ä¸Šä¸‹æ–‡å…ƒç´ ä¸­æ‰æœ‰æ„ä¹‰ã€‚ä¸åŒå±‚å ä¸Šä¸‹æ–‡ä¸­æ¯”è¾ƒå±‚å ç­‰çº§æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ å¦‚ä½•äº§ç”Ÿâ€œå±‚å ä¸Šä¸‹æ–‡â€å‰é¢è¯´äº†é‚£ä¹ˆå¤šï¼ŒçŸ¥é“äº†â€œå±‚å ä¸Šä¸‹æ–‡â€å’Œâ€œå±‚å ç­‰çº§â€ï¼Œå…¶ä¸­è¿˜æœ‰ä¸€ä¸ªæœ€å…³é”®çš„é—®é¢˜ï¼šåˆ°åº•å¦‚ä½•äº§ç”Ÿå±‚å ä¸Šä¸‹æ–‡å‘¢ï¼Ÿå¦‚ä½•è®©ä¸€ä¸ªå…ƒç´ å˜æˆå±‚å ä¸Šä¸‹æ–‡å…ƒç´ å‘¢ï¼Ÿ å…¶å®ï¼Œå±‚å ä¸Šä¸‹æ–‡ä¹ŸåŸºæœ¬ä¸Šæ˜¯æœ‰ä¸€äº›ç‰¹å®šçš„ CSS å±æ€§åˆ›å»ºçš„ï¼Œä¸€èˆ¬æœ‰ 3 ç§æ–¹æ³•ï¼š HTML ä¸­çš„æ ¹å…ƒç´ &lt;html&gt;&lt;/html&gt;æœ¬èº« j å°±å…·æœ‰å±‚å ä¸Šä¸‹æ–‡ï¼Œç§°ä¸ºâ€œæ ¹å±‚å ä¸Šä¸‹æ–‡â€ã€‚ æ™®é€šå…ƒç´ è®¾ç½® position å±æ€§ä¸ºé static å€¼å¹¶è®¾ç½® z-index å±æ€§ä¸ºå…·ä½“æ•°å€¼ï¼Œäº§ç”Ÿå±‚å ä¸Šä¸‹æ–‡ã€‚ CSS3 ä¸­çš„æ–°å±æ€§ä¹Ÿå¯ä»¥äº§ç”Ÿå±‚å ä¸Šä¸‹æ–‡ã€‚ ä»€ä¹ˆæ˜¯â€œå±‚å é¡ºåºâ€è¯´å®Œâ€œå±‚å ä¸Šä¸‹æ–‡â€å’Œâ€œå±‚å ç­‰çº§â€ï¼Œæˆ‘ä»¬å†æ¥è¯´è¯´â€œå±‚å é¡ºåºâ€ã€‚â€œå±‚å é¡ºåºâ€(stacking order)è¡¨ç¤ºå…ƒç´ å‘ç”Ÿå±‚å æ—¶æŒ‰ç…§ç‰¹å®šçš„é¡ºåºè§„åˆ™åœ¨ Z è½´ä¸Šå‚ç›´æ˜¾ç¤ºã€‚ç”±æ­¤å¯è§ï¼Œå‰é¢æ‰€è¯´çš„â€œå±‚å ä¸Šä¸‹æ–‡â€å’Œâ€œå±‚å ç­‰çº§â€æ˜¯ä¸€ç§æ¦‚å¿µï¼Œè€Œè¿™é‡Œçš„â€œå±‚å é¡ºåºâ€æ˜¯ä¸€ç§è§„åˆ™ã€‚ ä¸Šå›¾çš„ä»£ç  &lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width&quot; /&gt; &lt;title&gt;JS Bin&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;style type=&quot;text/css&quot;&gt; .z-index div &#123; width: 200px; height: 100px; color: white; border: 1px solid white; &#125; &lt;/style&gt; &lt;body&gt; &lt;div class=&quot;z-index&quot;&gt; &lt;div id=&quot;background&quot; style=&quot;background-color:violet; transform: translate(0px, 0px);&quot;&gt; &lt;span style=&quot;position: absolute;&quot;&gt;å±‚å ä¸Šä¸‹æ–‡background/border&lt;/span&gt; &lt;div style=&quot;background-color:blueviolet; z-index: -1; margin-left: 50px; margin-top: 50px;&quot;&gt;è´Ÿindex&lt;/div&gt; &lt;div style=&quot;background-color:steelblue; margin: -50px 0 0 100px;&quot;&gt;blockå—çŠ¶ç›’å­&lt;/div&gt; &lt;div style=&quot;background-color:springgreen; float: left; margin: -50px 0 -50px 150px&quot;&gt;floatæµ®åŠ¨ç›’å­&lt;/div&gt; &lt;div style=&quot;background-color:greenyellow; display: inline-block; margin: -50px 0 0 200px;&quot;&gt; inline/inline-blockç›’å­ &lt;/div&gt; &lt;div style=&quot;background-color:orange; position: relative; z-index: auto; margin: -50px 0 0 250px;&quot;&gt; z-index:auto/z-index:0 &lt;/div&gt; &lt;div style=&quot;background-color:red; position: relative; z-index: 1; margin: -50px 0 0 300px;&quot;&gt;æ­£z-index&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/body&gt;&lt;/html&gt; åœ¨ä¸è€ƒè™‘ CSS3 çš„æƒ…å†µä¸‹ï¼Œå½“å…ƒç´ å‘ç”Ÿå±‚å æ—¶ï¼Œå±‚å é¡ºè®¯éµå¾ªä¸Šé¢é€”ä¸­çš„è§„åˆ™ã€‚ è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼š å·¦ä¸Šè§’â€å±‚å ä¸Šä¸‹æ–‡ background/borderâ€œæŒ‡çš„æ˜¯å±‚å ä¸Šä¸‹æ–‡å…ƒç´ çš„èƒŒæ™¯å’Œè¾¹æ¡†ã€‚ inline/inline-block å…ƒç´ çš„å±‚å é¡ºåºè¦é«˜äº block(å—çº§)/float(æµ®åŠ¨)å…ƒç´ ã€‚ å•çº¯è€ƒè™‘å±‚å é¡ºåºï¼Œz-index: auto å’Œ z-index: 0 åœ¨åŒä¸€å±‚çº§ï¼Œä½†è¿™ä¸¤ä¸ªå±æ€§å€¼æœ¬èº«æ˜¯æœ‰æ ¹æœ¬åŒºåˆ«çš„ã€‚ åˆ¤æ–­æ–¹æ³• 1ã€é¦–å…ˆå…ˆçœ‹è¦æ¯”è¾ƒçš„ä¸¤ä¸ªå…ƒç´ æ˜¯å¦å¤„äºåŒä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ä¸­ï¼š 1.1 å¦‚æœæ˜¯ï¼Œè°çš„å±‚å ç­‰çº§å¤§ï¼Œè°åœ¨ä¸Šé¢ï¼ˆæ€ä¹ˆåˆ¤æ–­å±‚å ç­‰çº§å¤§å°å‘¢ï¼Ÿâ€”â€”çœ‹â€œå±‚å é¡ºåºâ€å›¾ï¼‰ã€‚ 1.2 å¦‚æœä¸¤ä¸ªå…ƒç´ ä¸åœ¨ç»Ÿä¸€å±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œè¯·å…ˆæ¯”è¾ƒä»–ä»¬æ‰€å¤„çš„å±‚å ä¸Šä¸‹æ–‡çš„å±‚å ç­‰çº§ã€‚ 2ã€å½“ä¸¤ä¸ªå…ƒç´ å±‚å ç­‰çº§ç›¸åŒã€å±‚å é¡ºåºç›¸åŒæ—¶ï¼Œåœ¨ DOM ç»“æ„ä¸­åé¢çš„å…ƒç´ å±‚å ç­‰çº§åœ¨å‰é¢å…ƒç´ ä¹‹ä¸Šã€‚ å®ä¾‹&lt;style type=&quot;text/css&quot;&gt; div &#123; width: 200px; height: 100px; color: white; border: 1px solid white; &#125;&lt;/style&gt;&lt;body&gt; &lt;div class=&quot;box1&quot; style=&quot;position: relative; z-index: auto;&quot;&gt; &lt;div class=&quot;child1&quot; style=&quot;background-color:red; position: relative; z-index: 2;&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;box2&quot; style=&quot;position: relative; z-index: auto;&quot;&gt; &lt;div class=&quot;child2&quot; style=&quot;background-color:blue; position: relative; z-index: 1; margin: -50px 0 0 50px;&quot;&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt; .box1/.box2è™½ç„¶è®¾ç½®äº† position: relativeï¼Œä½†æ˜¯ z-index: auto çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸¤ä¸ª div è¿˜æ˜¯æ™®é€šå…ƒç´ ï¼Œå¹¶æ²¡æœ‰äº§ç”Ÿå±‚å ä¸Šä¸‹æ–‡ã€‚æ‰€ä»¥ï¼Œchild1/.child2 å±äº&lt;html&gt;&lt;/html&gt;å…ƒç´ çš„â€œæ ¹å±‚å ä¸Šä¸‹æ–‡â€ä¸­ï¼Œæ­¤æ—¶ï¼Œè°çš„ z-index å€¼å¤§ï¼Œè°åœ¨ä¸Šé¢ã€‚ å¯¹äºä¸Šé¢ä¸­çš„ CSS ä»£ç ï¼Œæˆ‘ä»¬åªæŠŠ.box1/.box2 çš„ z-index å±æ€§å€¼æ”¹ä¸ºæ•°å€¼ 0ï¼Œå…¶ä½™ä¸å˜ã€‚ &lt;div class=&quot;box1&quot; style=&quot;position: relative; z-index: 0;&quot;&gt; &lt;div class=&quot;child1&quot; style=&quot;background-color:red; position: relative; z-index: 2;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;box2&quot; style=&quot;position: relative; z-index: 0;&quot;&gt; &lt;div class=&quot;child2&quot; style=&quot;background-color:blue; position: relative; z-index: 1; margin: -50px 0 0 50px;&quot;&gt;&lt;/div&gt;&lt;/div&gt; æ­¤æ—¶ï¼Œæˆ‘ä»¬å‘ç°ï¼Œä»…ä»…ä¿®æ”¹äº†.box1/.box2çš„ z-index å±æ€§å€¼æ”¹ä¸ºæ•°å€¼ 0ï¼Œæœ€ç»ˆç»“æœå®Œå…¨ç›¸åã€‚è¿™æ—¶.child2 è¦†ç›–åœ¨äº†.child1 ä¸Šé¢ã€‚åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¾ˆç®€å•ï¼šå› ä¸ºè®¾ç½® z-index: 0 åï¼Œ.box1/.box2äº§ç”Ÿäº†å„è‡ªçš„å±‚å ä¸Šä¸‹æ–‡ï¼Œè¿™æ—¶å€™è¦æ¯”è¾ƒ.child1/.child2 çš„å±‚å å…³ç³»å®Œå…¨ç”±çˆ¶å…ƒç´ .box1/.box2çš„å±‚å å…³ç³»å†³å®šã€‚ä½†æ˜¯.box1/.box2çš„ z-index å€¼éƒ½ä¸º 0ï¼Œéƒ½æ˜¯å—çº§å…ƒç´ ï¼ˆæ‰€ä»¥å®ƒä»¬çš„å±‚å ç­‰çº§ï¼Œå±‚å é¡ºåºæ˜¯ç›¸åŒçš„ï¼‰ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨ DOM ç»“æ„ä¸­åé¢çš„è¦†ç›–å‰é¢çš„ï¼Œæ‰€ä»¥.child2 å°±åœ¨ä¸Šé¢ã€‚ CSS3 ä¸­çš„å±æ€§å¯¹å±‚å ä¸Šä¸‹æ–‡çš„å½±å“ CSS3 ä¸­å‡ºç°äº†å¾ˆå¤šæ–°å±æ€§ï¼Œå…¶ä¸­ä¸€äº›å±æ€§å¯¹å±‚å ä¸Šä¸‹æ–‡ä¹Ÿäº§ç”Ÿäº†å¾ˆå¤§çš„å½±å“ã€‚å¦‚ä¸‹ï¼š çˆ¶å…ƒç´ çš„ display å±æ€§å€¼ä¸º flex|inline-flexï¼Œå­å…ƒç´  z-index å±æ€§å€¼ä¸ä¸º auto çš„æ—¶å€™ï¼Œå­å…ƒç´ ä¸ºå±‚å ä¸Šä¸‹æ–‡å…ƒç´ ï¼› å…ƒç´ çš„ opacity å±æ€§å€¼ä¸æ˜¯ 1ï¼› å…ƒç´ çš„ transform å±æ€§å€¼ä¸æ˜¯ noneï¼› å…ƒç´  mix-blend-mode å±æ€§å€¼ä¸æ˜¯ normalï¼› å…ƒç´ çš„ filter å±æ€§å€¼ä¸æ˜¯ noneï¼› å…ƒç´ çš„ isolation å±æ€§å€¼æ˜¯ isolateï¼› will-change æŒ‡å®šçš„å±æ€§å€¼ä¸ºä¸Šé¢ä»»æ„ä¸€ä¸ªï¼› å…ƒç´ çš„-webkit-overflow-scrolling å±æ€§å€¼è®¾ç½®ä¸º touchã€‚ CSS3 ä¸­ï¼Œå…ƒç´ å±æ€§æ»¡è¶³ä»¥ä¸Šæ¡ä»¶ä¹‹ä¸€ï¼Œå°±ä¼šäº§ç”Ÿå±‚å ä¸Šä¸‹æ–‡ã€‚æˆ‘ä»¬ç”¨ç¬¬ 1 æ¡æ¥åšä¸€ä¸ªç®€å•çš„è§£é‡Šè¯´æ˜ã€‚ &lt;style type=&quot;text/css&quot;&gt; div &#123; width: 200px; height: 100px; color: white; border: 1px solid white; &#125;&lt;/style&gt;&lt;body&gt; &lt;div class=&quot;parent&quot; style=&quot;background-color:blue;&quot;&gt; &lt;div class=&quot;child&quot; style=&quot;background-color:red; position: relative; z-index: -1; margin: 50px 0 0 50px;&quot;&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt; æˆ‘ä»¬å‘ç°ï¼Œ.child è¢«.parent è¦†ç›–äº†ã€‚åˆ†æä¸€ä¸‹ï¼š è™½ç„¶.parent è®¾ç½®äº† z-index å±æ€§å€¼ï¼Œä½†æ˜¯æ²¡æœ‰è®¾ç½® position å±æ€§ï¼Œz-index æ— æ•ˆï¼Œæ‰€ä»¥æ²¡æœ‰äº§ç”Ÿå±‚å ä¸Šä¸‹æ–‡ï¼Œ.parent è¿˜æ˜¯æ™®é€šçš„å—çº§å…ƒç´ ã€‚æ­¤æ—¶ï¼Œåœ¨å±‚å é¡ºåºè§„åˆ™ä¸­ï¼Œz-index å€¼å°äº 0 çš„.child ä¼šè¢«æ™®é€šçš„ block å—çº§å…ƒç´ .parent è¦†ç›–ã€‚ å¯¹äºä¸Šé¢çš„æ —å­ï¼Œæˆ‘ä»¬åªä¿®æ”¹ body çš„å±æ€§ï¼Œè®¾ç½® display: flexï¼Œå…¶ä½™å±æ€§å’Œ DOM ç»“æ„ä¸å˜ã€‚ å½“ç»™ body è®¾ç½® display: flex æ—¶ï¼Œ.parent å°±å˜æˆå±‚å ä¸Šä¸‹æ–‡å…ƒç´ ï¼Œæ ¹æ®å±‚å é¡ºåºè§„åˆ™ï¼Œå±‚å ä¸Šä¸‹æ–‡å…ƒç´ çš„ background/border çš„å±‚å ç­‰çº§å°äº z-index å€¼å°äº 0 çš„å…ƒç´ çš„å±‚å ç­‰çº§ï¼Œæ‰€ä»¥ z-index å€¼ä¸º-1 çš„.child åœ¨.parent ä¸Šé¢ã€‚ è¿™é‡Œæ³¨æ„ï¼ŒèƒŒæ™¯background/borderå’Œ.childå…ƒç´ å¤„åœ¨åŒä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ï¼ˆ.parentï¼‰ä¸‹ï¼Œæ‰€ä»¥æ‰ä¼šæ¯”è¾ƒä»–ä»¬çš„å±‚å é¡ºåº æˆ–è€…ç›´æ¥åœ¨ .parent ä¸Šå¢åŠ  css å±æ€§ transform: translate(0, 0)ï¼Œä¹Ÿå¯ä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœ å‚è€ƒå½»åº•ææ‡‚ CSS å±‚å ä¸Šä¸‹æ–‡ã€å±‚å ç­‰çº§ã€å±‚å é¡ºåºã€z-indexæ·±å…¥ç†è§£ CSS ä¸­çš„å±‚å ä¸Šä¸‹æ–‡å’Œå±‚å é¡ºåº","updated":"2025-08-02T05:46:04.178Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"}]},{"title":"å‰ç«¯3å¤§æ¡†æ¶åŸç†æ¯”è¾ƒåˆ†æ","date":"2021-09-20T02:35:14.000Z","path":"2021/09/20/2021-09-20-web-framed-diff/","text":"é¦–å…ˆäº†è§£ä¸€ä¸‹æµè§ˆå™¨çš„æ¸²æŸ“åŸç†ã€ŠHow Browsers Workã€‹è¯‘æ–‡ç”±äºæœ€è¿‘åœ¨æ¢ç´¢æ¡†æ¶æ€§èƒ½ï¼Œå„æ¡†æ¶çš„æ­£ç¡®ä½¿ç”¨åœºæ™¯ï¼Œå¯¹æ¡†æ¶çš„æ•°æ®ç»‘å®šåŸç†åšäº†å¦‚ä¸‹çš„æ€»ç»“ï¼š 1ã€AngularAngular çš„æ•°æ®è§‚æµ‹é‡‡ç”¨çš„æ˜¯è„æ£€æŸ¥ï¼ˆdirty checkingï¼‰æœºåˆ¶ã€‚æ¯ä¸€ä¸ªæŒ‡ä»¤éƒ½ä¼šæœ‰ä¸€ä¸ªå¯¹åº”çš„ç”¨æ¥è§‚æµ‹æ•°æ®çš„å¯¹è±¡ï¼Œå«åš watcherï¼›ä¸€ä¸ªä½œç”¨åŸŸä¸­ä¼šæœ‰å¾ˆå¤šä¸ª watcherã€‚æ¯å½“ç•Œé¢éœ€è¦æ›´æ–°æ—¶ï¼ŒAngular ä¼šéå†å½“å‰ä½œç”¨åŸŸé‡Œçš„æ‰€æœ‰ watcherï¼Œå¯¹å®ƒä»¬ä¸€ä¸€æ±‚å€¼ï¼Œç„¶åå’Œä¹‹å‰ä¿å­˜çš„æ—§å€¼è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ±‚å€¼çš„ç»“æœå˜åŒ–äº†ï¼Œå°±è§¦å‘å¯¹åº”çš„æ›´æ–°ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åš digest cycleã€‚è„æ£€æŸ¥æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š 1ï¼‰ä»»ä½•æ•°æ®å˜åŠ¨éƒ½æ„å‘³ç€å½“å‰ä½œç”¨åŸŸçš„æ¯ä¸€ä¸ª watcher éœ€è¦è¢«é‡æ–°æ±‚å€¼ï¼Œå› æ­¤å½“ watcher çš„æ•°é‡åºå¤§æ—¶ï¼Œåº”ç”¨çš„æ€§èƒ½å°±ä¸å¯é¿å…åœ°å—åˆ°å½±å“ï¼Œå¹¶ä¸”å¾ˆéš¾ä¼˜åŒ–ï¼›2ï¼‰å½“æ•°æ®å˜åŠ¨æ—¶ï¼Œæ¡†æ¶å¹¶ä¸èƒ½ä¸»åŠ¨ä¾¦æµ‹åˆ°å˜åŒ–çš„å‘ç”Ÿï¼Œéœ€è¦æ‰‹åŠ¨è§¦å‘ digest cycle æ‰èƒ½è§¦å‘ç›¸åº”çš„ DOM æ›´æ–°ã€‚Angular é€šè¿‡åœ¨ DOM äº‹ä»¶å¤„ç†å‡½æ•°ä¸­è‡ªåŠ¨è§¦å‘ digest cycle éƒ¨åˆ†è§„é¿äº†è¿™ä¸ªé—®é¢˜ï¼Œä½†è¿˜æ˜¯æœ‰å¾ˆå¤šæƒ…å†µéœ€è¦ç”¨æˆ·æ‰‹åŠ¨è¿›è¡Œè§¦å‘ã€‚è„æ£€æŸ¥å³ä¸€ç§ä¸å…³å¿ƒä½ å¦‚ä½•ä»¥åŠä½•æ—¶æ”¹å˜çš„æ•°æ®ï¼Œåªå…³å¿ƒåœ¨ç‰¹å®šçš„æ£€æŸ¥é˜¶æ®µæ•°æ®æ˜¯å¦æ”¹å˜çš„æ•°æ®ç›‘å¬æŠ€æœ¯ã€‚è€Œå¸¸è§„çš„ set, get çš„æ–¹å¼åˆ™ä¼šå¼ºåŠ è®¸å¤šé™åˆ¶ï¼›è„æ£€æŸ¥å¯ä»¥å®ç°æ‰¹å¤„ç†å®Œæ•°æ®ä¹‹åï¼Œå†å»ç»Ÿä¸€æ›´æ–° viewï¼›è„æ£€æŸ¥å…¶å®æ¯” GET/SET æ›´å®¹æ˜“å®ç°ã€‚è„æ£€æŸ¥æ˜¯ä¸ªå•å‘çš„æ£€æŸ¥æµç¨‹(è¯·ä¸è¦å’ŒåŒå‘ç»‘å®šå‘ç”Ÿæ··æ·†)ï¼Œå¯ä»¥å®ç°_ä»»æ„å¤æ‚åº¦çš„è¡¨è¾¾å¼æ”¯æŒã€‚è€Œ get/ set çš„æ–¹å¼åˆ™éœ€è¦å¤„ç†å¤æ‚ä¾èµ–é“¾ï¼ŒåŸºæœ¬ä¸Šè¡¨è¾¾å¼æ”¯æŒéƒ½æ˜¯é˜‰å‰²çš„. å¾ˆæ˜¾ç„¶ï¼Œè„æ£€æŸ¥æ˜¯ä½æ•ˆçš„ï¼Œå®ƒçš„æ•ˆç‡åŸºæœ¬ä¸Šå–å†³äºä½ ç»‘å®šçš„è§‚å¯Ÿè€…æ•°é‡ã€‚ç„¶è€Œç»“åˆè¿™ç§ç±» mvvm ç³»ç»Ÿä¸­ï¼Œä»–åˆæ˜¯é«˜æ•ˆçš„ã€‚å› ä¸ºç›‘å¬æ¨¡å¼å¸¦æ¥äº† dom çš„å±€éƒ¨æ›´æ–°ï¼Œè€Œ dom æ“ä½œæ°æ°åˆæ˜¯éšè—çš„æ€§èƒ½ç“¶é¢ˆæ‰€åœ¨ã€‚ 2ã€VueJS å°†åŸç”Ÿçš„æ•°æ®æ”¹é€ æˆ â€œå¯è§‚å¯Ÿå¯¹è±¡â€ã€‚ä¸€ä¸ªå¯è§‚å¯Ÿå¯¹è±¡å¯ä»¥è¢«å–å€¼ï¼Œä¹Ÿå¯ä»¥è¢«èµ‹å€¼, åœ¨ watcher çš„æ±‚å€¼è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€ä¸ªè¢«å–å€¼çš„å¯è§‚å¯Ÿå¯¹è±¡éƒ½ä¼šå°†å½“å‰çš„ watcher æ³¨å†Œä¸ºè‡ªå·±çš„ä¸€ä¸ªè®¢é˜…è€…ï¼Œå¹¶æˆä¸ºå½“å‰ watcher çš„ä¸€ä¸ªä¾èµ–ã€‚ å½“ä¸€ä¸ªè¢«ä¾èµ–çš„å¯è§‚å¯Ÿå¯¹è±¡è¢«èµ‹å€¼æ—¶ï¼Œå®ƒä¼šé€šçŸ¥æ‰€æœ‰è®¢é˜…è‡ªå·±çš„ watcher é‡æ–°æ±‚å€¼ï¼Œå¹¶è§¦å‘ç›¸åº”çš„æ›´æ–°ã€‚ä¾èµ–æ”¶é›†çš„ä¼˜ç‚¹åœ¨äºå¯ä»¥ç²¾ç¡®ã€ä¸»åŠ¨åœ°è¿½è¸ªæ•°æ®çš„å˜åŒ–ï¼Œä¸å­˜åœ¨ä¸Šè¿°æåˆ°çš„è„æ£€æŸ¥çš„ä¸¤ä¸ªé—®é¢˜ã€‚ä½†ä¼ ç»Ÿçš„ä¾èµ–æ”¶é›†å®ç°ï¼Œæ¯”å¦‚ Knockoutï¼Œé€šå¸¸éœ€è¦åŒ…è£¹åŸç”Ÿæ•°æ®æ¥åˆ¶é€ å¯è§‚å¯Ÿå¯¹è±¡ï¼Œåœ¨å–å€¼å’Œèµ‹å€¼æ—¶éœ€è¦é‡‡ç”¨å‡½æ•°è°ƒç”¨çš„å½¢å¼ï¼Œåœ¨è¿›è¡Œæ•°æ®æ“ä½œæ—¶å†™æ³•ç¹çï¼Œä¸å¤Ÿç›´è§‚ï¼›åŒæ—¶ï¼Œå¯¹å¤æ‚åµŒå¥—ç»“æ„çš„å¯¹è±¡æ”¯æŒä¹Ÿä¸ç†æƒ³ã€‚Vue.js åˆ©ç”¨äº† ES5 çš„ Object.defineProperty æ–¹æ³•ï¼Œç›´æ¥å°†åŸç”Ÿæ•°æ®å¯¹è±¡çš„å±æ€§æ”¹é€ ä¸º getter å’Œ setterï¼Œåœ¨è¿™ä¸¤ä¸ªå‡½æ•°å†…éƒ¨å®ç°ä¾èµ–çš„æ”¶é›†å’Œè§¦å‘ï¼Œè€Œä¸”å®Œç¾æ”¯æŒåµŒå¥—çš„å¯¹è±¡ç»“æ„ã€‚å¯¹äºæ•°ç»„ï¼Œåˆ™é€šè¿‡åŒ…è£¹æ•°ç»„çš„å¯å˜æ–¹æ³•ï¼ˆæ¯”å¦‚ pushï¼‰æ¥ç›‘å¬æ•°ç»„çš„å˜åŒ–ã€‚è¿™ä½¿å¾—æ“ä½œ Vue. js çš„æ•°æ®å’Œæ“ä½œåŸç”Ÿå¯¹è±¡å‡ ä¹æ²¡æœ‰å·®åˆ«[æ³¨:åœ¨æ·»åŠ /åˆ é™¤å±æ€§ï¼Œæˆ–æ˜¯ä¿®æ”¹æ•°ç»„ç‰¹å®šä½ç½®å…ƒç´ æ—¶ï¼Œéœ€è¦è°ƒç”¨ç‰¹å®šçš„å‡½æ•°ï¼Œå¦‚ obj.$add(key, value) æ‰èƒ½è§¦å‘æ›´æ–°ã€‚è¿™æ˜¯å— ES5 çš„è¯­è¨€ç‰¹æ€§æ‰€é™ã€‚]ï¼Œæ•°æ®æ“ä½œçš„é€»è¾‘æ›´ä¸ºæ¸…æ™°æµç•…ï¼Œå’Œç¬¬ä¸‰æ–¹æ•°æ®åŒæ­¥æ–¹æ¡ˆçš„æ•´åˆä¹Ÿæ›´ä¸ºæ–¹ä¾¿ã€‚å¼‚æ­¥æ‰¹é‡ DOM æ›´æ–°ï¼šå½“å¤§é‡æ•°æ®å˜åŠ¨æ—¶ï¼Œæ‰€æœ‰å—åˆ°å½±å“çš„ watcher ä¼šè¢«æ¨é€åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå¹¶ä¸”æ¯ä¸ª watcher åªä¼šæ¨è¿›é˜Ÿåˆ—ä¸€æ¬¡ã€‚è¿™ä¸ªé˜Ÿåˆ—ä¼šåœ¨è¿›ç¨‹ çš„ä¸‹ä¸€ä¸ª â€œtickâ€ å¼‚æ­¥æ‰§è¡Œã€‚è¿™ä¸ªæœºåˆ¶å¯ä»¥é¿å…åŒä¸€ä¸ªæ•°æ®å¤šæ¬¡å˜åŠ¨äº§ç”Ÿçš„å¤šä½™ DOM æ“ä½œï¼Œä¹Ÿå¯ä»¥ä¿è¯æ‰€æœ‰çš„ DOM å†™æ“ä½œåœ¨ä¸€èµ·æ‰§è¡Œï¼Œé¿å… DOM è¯»å†™åˆ‡æ¢å¯èƒ½å¯¼è‡´çš„ layoutã€‚ åŠ¨ç”»ç³»ç»Ÿï¼šVue.js æä¾›äº†ç®€å•å´å¼ºå¤§çš„åŠ¨ç”»ç³»ç»Ÿï¼Œå½“ä¸€ä¸ªå…ƒç´ çš„å¯è§æ€§å˜åŒ–æ—¶ï¼Œç”¨æˆ·ä¸ä»…å¯ä»¥å¾ˆç®€å•åœ°å®šä¹‰å¯¹åº”çš„ CSS Transition æˆ– Animation æ•ˆæœï¼Œè¿˜å¯ä»¥åˆ©ç”¨ä¸°å¯Œçš„ JavaScript é’©å­å‡½æ•°è¿›è¡Œæ›´åº•å±‚çš„åŠ¨ç”»å¤„ç†ã€‚ å¯æ‰©å±•æ€§ï¼šé™¤äº†è‡ªå®šä¹‰æŒ‡ä»¤ã€è¿‡æ»¤å™¨å’Œç»„ä»¶ï¼ŒVue.js è¿˜æä¾›äº†çµæ´»çš„ mixin æœºåˆ¶ï¼Œè®©ç”¨æˆ·å¯ä»¥åœ¨å¤šä¸ªç»„ä»¶ä¸­å¤ç”¨å…±åŒçš„ç‰¹æ€§ã€‚ åœ¨å¤§å‹çš„åº”ç”¨ä¸­ï¼Œä¸ºäº†åˆ†å·¥ã€å¤ç”¨å’Œå¯ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬ä¸å¯é¿å…åœ°éœ€è¦å°†åº”ç”¨æŠ½è±¡ä¸ºå¤šä¸ªç›¸å¯¹ç‹¬ç«‹çš„æ¨¡å—ã€‚åœ¨è¾ƒä¸ºä¼ ç»Ÿçš„å¼€å‘æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åªæœ‰åœ¨è€ƒè™‘å¤ç”¨æ—¶æ‰ä¼šå°†æŸä¸€éƒ¨åˆ†åšæˆç»„ä»¶ï¼›ä½†å®é™…ä¸Šï¼Œåº”ç”¨ç±» UI å®Œå…¨å¯ä»¥çœ‹ä½œæ˜¯å…¨éƒ¨ç”±ç»„ä»¶æ ‘æ„æˆçš„ 3ã€ReactJS Web ç•Œé¢ç”± DOM æ ‘æ¥æ„æˆï¼Œå½“å…¶ä¸­æŸä¸€éƒ¨åˆ†å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå…¶å®å°±æ˜¯å¯¹åº”çš„æŸä¸ª DOM èŠ‚ç‚¹å‘ç”Ÿäº†å˜åŒ–ã€‚åœ¨ React ä¸­ï¼Œæ„å»º UI ç•Œé¢çš„æ€è·¯æ˜¯ç”±å½“å‰çŠ¶æ€å†³å®šç•Œé¢ã€‚å‰åä¸¤ä¸ªçŠ¶æ€å°±å¯¹åº”ä¸¤å¥—ç•Œé¢ï¼Œç„¶åç”± React æ¥æ¯”è¾ƒä¸¤ä¸ªç•Œé¢çš„åŒºåˆ«ï¼Œè¿™å°±éœ€è¦å¯¹ DOM æ ‘è¿›è¡Œ Diff ç®—æ³•åˆ†æã€‚ å³ç»™å®šä»»æ„ä¸¤æ£µæ ‘ï¼Œæ‰¾åˆ°æœ€å°‘çš„è½¬æ¢æ­¥éª¤ã€‚ä½†æ˜¯æ ‡å‡†çš„ Diff ç®—æ³•å¤æ‚åº¦éœ€è¦ O(n^3)ï¼Œè¿™æ˜¾ç„¶æ— æ³•æ»¡è¶³æ€§èƒ½è¦æ±‚ã€‚è¦è¾¾åˆ°æ¯æ¬¡ç•Œé¢éƒ½å¯ä»¥æ•´ä½“åˆ·æ–°ç•Œé¢çš„ç›®çš„ï¼ŒåŠ¿å¿…éœ€è¦å¯¹ç®—æ³•è¿›è¡Œä¼˜åŒ–ã€‚è¿™çœ‹ä¸Šå»éå¸¸æœ‰éš¾åº¦ï¼Œç„¶è€Œ Facebook å·¥ç¨‹å¸ˆå´åšåˆ°äº†ï¼Œä»–ä»¬ç»“åˆ Web ç•Œé¢çš„ç‰¹ç‚¹åšå‡ºäº†ä¸¤ä¸ªç®€å•çš„å‡è®¾ï¼Œä½¿å¾— Diff ç®—æ³•å¤æ‚åº¦ç›´æ¥é™ä½åˆ° O(n)ï¼Œä¸¤ä¸ªç›¸åŒç»„ä»¶äº§ç”Ÿç±»ä¼¼çš„ DOM ç»“æ„ï¼Œä¸åŒçš„ç»„ä»¶äº§ç”Ÿä¸åŒçš„ DOM ç»“æ„ï¼› ç®—æ³•ä¸Šçš„ä¼˜åŒ–æ˜¯ React æ•´ä¸ªç•Œé¢ Render çš„åŸºç¡€ï¼Œäº‹å®ä¹Ÿè¯æ˜è¿™ä¸¤ä¸ªå‡è®¾æ˜¯åˆç†è€Œç²¾ç¡®çš„ï¼Œä¿è¯äº†æ•´ä½“ç•Œé¢æ„å»ºçš„æ€§èƒ½ï¼Œå¯¹äºåŒä¸€å±‚æ¬¡çš„ä¸€ç»„å­èŠ‚ç‚¹ï¼Œå®ƒä»¬å¯ä»¥é€šè¿‡å”¯ä¸€çš„ id è¿›è¡ŒåŒºåˆ†ã€‚ React çš„åŸºæœ¬æ€ç»´æ¨¡å¼æ˜¯æ¯æ¬¡æœ‰å˜åŠ¨å°±æ•´ä¸ªé‡æ–°æ¸²æŸ“æ•´ä¸ªåº”ç”¨ã€‚å¦‚æœæ²¡æœ‰ Virtual DOMï¼Œç®€å•æ¥æƒ³å°±æ˜¯ç›´æ¥é‡ç½® innerHTMLã€‚å¾ˆå¤šäººéƒ½æ²¡æœ‰æ„è¯†åˆ°ï¼Œåœ¨ä¸€ä¸ªå¤§å‹åˆ—è¡¨æ‰€æœ‰æ•°æ®éƒ½å˜äº†çš„æƒ…å†µä¸‹ï¼Œé‡ç½® innerHTML å…¶å®æ˜¯ä¸€ä¸ªè¿˜ç®—åˆç†çš„æ“ä½œâ€¦ çœŸæ­£çš„é—®é¢˜æ˜¯åœ¨ â€œå…¨éƒ¨é‡æ–°æ¸²æŸ“â€ çš„æ€ç»´æ¨¡å¼ä¸‹ï¼Œå³ä½¿åªæœ‰ä¸€è¡Œæ•°æ®å˜äº†ï¼Œå®ƒä¹Ÿéœ€è¦é‡ç½®æ•´ä¸ª innerHTMLï¼Œè¿™æ—¶å€™æ˜¾ç„¶å°±æœ‰å¤§é‡çš„æµªè´¹ã€‚ æˆ‘ä»¬å¯ä»¥æ¯”è¾ƒä¸€ä¸‹ innerHTML vs. Virtual DOM çš„é‡ç»˜æ€§èƒ½æ¶ˆè€—ï¼š innerHTML: render html string O(template size) + é‡æ–°åˆ›å»ºæ‰€æœ‰ DOM å…ƒç´  O(DOM size) Virtual DOM: render Virtual DOM + diff O(template size) + å¿…è¦çš„ DOM æ›´æ–° O(DOM change) Virtual DOM render + diff æ˜¾ç„¶æ¯”æ¸²æŸ“ html å­—ç¬¦ä¸²è¦æ…¢ï¼Œä½†æ˜¯ï¼å®ƒä¾ç„¶æ˜¯çº¯ js å±‚é¢çš„è®¡ç®—ï¼Œæ¯”èµ·åé¢çš„ DOM æ“ä½œæ¥è¯´ï¼Œä¾ç„¶ä¾¿å®œäº†å¤ªå¤šã€‚å¯ä»¥çœ‹åˆ°ï¼ŒinnerHTML çš„æ€»è®¡ç®—é‡ä¸ç®¡æ˜¯ js è®¡ç®—è¿˜æ˜¯ DOM æ“ä½œéƒ½æ˜¯å’Œæ•´ä¸ªç•Œé¢çš„å¤§å°ç›¸å…³ï¼Œä½† Virtual DOM çš„è®¡ç®—é‡é‡Œé¢ï¼Œåªæœ‰ js è®¡ç®—å’Œç•Œé¢å¤§å°ç›¸å…³ï¼ŒDOM æ“ä½œæ˜¯å’Œæ•°æ®çš„å˜åŠ¨é‡ç›¸å…³çš„ã€‚å‰é¢è¯´äº†ï¼Œå’Œ DOM æ“ä½œæ¯”èµ·æ¥ï¼Œjs è®¡ç®—æ˜¯æå…¶ä¾¿å®œçš„ã€‚è¿™æ‰æ˜¯ä¸ºä»€ä¹ˆè¦æœ‰ Virtual DOMï¼šå®ƒä¿è¯äº† 1ï¼‰ä¸ç®¡ä½ çš„æ•°æ®å˜åŒ–å¤šå°‘ï¼Œæ¯æ¬¡é‡ç»˜çš„æ€§èƒ½éƒ½å¯ä»¥æ¥å—ï¼›2) ä½ ä¾ç„¶å¯ä»¥ç”¨ç±»ä¼¼ innerHTML çš„æ€è·¯å»å†™ä½ çš„åº”ç”¨ã€‚ æ€»ç»“ï¼š Virtual DOMã€è„æ£€æŸ¥ MVVMã€æ•°æ®æ”¶é›† MVVM åœ¨ä¸åŒåœºåˆå„æœ‰ä¸åŒçš„è¡¨ç°å’Œä¸åŒçš„ä¼˜åŒ–éœ€æ±‚ï¼Œæ€§èƒ½æ¯”è¾ƒä¹Ÿè¦çœ‹åœºåˆ åœ¨æ¯”è¾ƒæ€§èƒ½çš„æ—¶å€™ï¼Œè¦åˆ†æ¸…æ¥šåˆå§‹æ¸²æŸ“ã€å°é‡æ•°æ®æ›´æ–°ã€å¤§é‡æ•°æ®æ›´æ–°è¿™äº›ä¸åŒçš„åœºåˆã€‚Virtual DOMã€è„æ£€æŸ¥ MVVMã€æ•°æ®æ”¶é›† MVVM åœ¨ä¸åŒåœºåˆå„æœ‰ä¸åŒçš„è¡¨ç°å’Œä¸åŒçš„ä¼˜åŒ–éœ€æ±‚ã€‚Virtual DOM ä¸ºäº†æå‡å°é‡æ•°æ®æ›´æ–°æ—¶çš„æ€§èƒ½ï¼Œä¹Ÿéœ€è¦é’ˆå¯¹æ€§çš„ä¼˜åŒ–ï¼Œæ¯”å¦‚ shouldComponentUpdate æˆ–æ˜¯ immutable dataã€‚ åˆå§‹æ¸²æŸ“ï¼šVirtual DOM &gt; è„æ£€æŸ¥ &gt;= ä¾èµ–æ”¶é›†å°é‡æ•°æ®æ›´æ–°ï¼šä¾èµ–æ”¶é›† &gt;&gt; Virtual DOM + ä¼˜åŒ– &gt; è„æ£€æŸ¥ï¼ˆæ— æ³•ä¼˜åŒ–ï¼‰ &gt; Virtual DOM æ— ä¼˜åŒ–å¤§é‡æ•°æ®æ›´æ–°ï¼šè„æ£€æŸ¥ + ä¼˜åŒ– &gt;= ä¾èµ–æ”¶é›† + ä¼˜åŒ– &gt; Virtual DOMï¼ˆæ— æ³•/æ— éœ€ä¼˜åŒ–ï¼‰&gt;&gt; MVVM æ— ä¼˜åŒ– .","updated":"2025-08-02T05:46:04.178Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"vue","slug":"vue","permalink":"https://luckyship.github.io/tags/vue/"},{"name":"angular","slug":"angular","permalink":"https://luckyship.github.io/tags/angular/"},{"name":"react","slug":"react","permalink":"https://luckyship.github.io/tags/react/"}]},{"title":"Vueä½ äº†è§£å“ªäº›","date":"2021-09-12T08:26:18.000Z","path":"2021/09/12/2021-09-12-vue-knowledge/","text":"ä¸€ã€vuevue ä¼˜ç‚¹ è½»é‡çº§æ¡†æ¶ï¼šåªå…³æ³¨è§†å›¾å±‚ï¼Œæ˜¯ä¸€ä¸ªæ„å»ºæ•°æ®çš„è§†å›¾é›†åˆï¼Œå¤§å°åªæœ‰å‡ å kbï¼› ç®€å•æ˜“å­¦ï¼šå›½äººå¼€å‘ï¼Œä¸­æ–‡æ–‡æ¡£ï¼Œä¸å­˜åœ¨è¯­è¨€éšœç¢ ï¼Œæ˜“äºç†è§£å’Œå­¦ä¹ ï¼› åŒå‘æ•°æ®ç»‘å®šï¼šä¿ç•™äº† angular çš„ç‰¹ç‚¹ï¼Œåœ¨æ•°æ®æ“ä½œæ–¹é¢æ›´ä¸ºç®€å•ï¼› ç»„ä»¶åŒ–ï¼šä¿ç•™äº† react çš„ä¼˜ç‚¹ï¼Œå®ç°äº† html çš„å°è£…å’Œé‡ç”¨ï¼Œåœ¨æ„å»ºå•é¡µé¢åº”ç”¨æ–¹é¢æœ‰ç€ç‹¬ç‰¹çš„ä¼˜åŠ¿ï¼› è§†å›¾ï¼Œæ•°æ®ï¼Œç»“æ„åˆ†ç¦»ï¼šä½¿æ•°æ®çš„æ›´æ”¹æ›´ä¸ºç®€å•ï¼Œä¸éœ€è¦è¿›è¡Œé€»è¾‘ä»£ç çš„ä¿®æ”¹ï¼Œåªéœ€è¦æ“ä½œæ•°æ®å°±èƒ½å®Œæˆç›¸å…³æ“ä½œï¼› è™šæ‹Ÿ DOMï¼šdom æ“ä½œæ˜¯éå¸¸è€—è´¹æ€§èƒ½çš„ï¼Œ ä¸å†ä½¿ç”¨åŸç”Ÿçš„ dom æ“ä½œèŠ‚ç‚¹ï¼Œæå¤§è§£æ”¾ dom æ“ä½œï¼Œä½†å…·ä½“æ“ä½œçš„è¿˜æ˜¯ dom ä¸è¿‡æ˜¯æ¢äº†å¦ä¸€ç§æ–¹å¼ï¼› è¿è¡Œé€Ÿåº¦æ›´å¿«:ç›¸æ¯”è¾ƒä¸ react è€Œè¨€ï¼ŒåŒæ ·æ˜¯æ“ä½œè™šæ‹Ÿ domï¼Œå°±æ€§èƒ½è€Œè¨€ï¼Œvue å­˜åœ¨å¾ˆå¤§çš„ä¼˜åŠ¿ã€‚ è°ˆè°ˆå¯¹ vue æ¸è¿›å¼çš„ç†è§£ ä»€ä¹ˆæ˜¯ MVVMï¼ŸMVVM æ˜¯æ˜¯ Model-View-ViewModel çš„ç¼©å†™ï¼ŒModel ä»£è¡¨æ•°æ®æ¨¡å‹ï¼Œå®šä¹‰æ•°æ®æ“ä½œçš„ä¸šåŠ¡é€»è¾‘ï¼ŒView ä»£è¡¨è§†å›¾å±‚ï¼Œè´Ÿè´£å°†æ•°æ®æ¨¡å‹æ¸²æŸ“åˆ°é¡µé¢ä¸Šï¼ŒViewModel é€šè¿‡åŒå‘ç»‘å®šæŠŠ View å’Œ Model è¿›è¡ŒåŒæ­¥äº¤äº’ï¼Œä¸éœ€è¦æ‰‹åŠ¨æ“ä½œ DOM çš„ä¸€ç§è®¾è®¡æ€æƒ³ã€‚ MVVM å’Œ MVC åŒºåˆ«ï¼Ÿå’Œå…¶ä»–æ¡†æ¶(jquery)åŒºåˆ«ï¼Ÿé‚£äº›åœºæ™¯é€‚ç”¨ï¼ŸMVVM å’Œ MVC éƒ½æ˜¯ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œä¸»è¦å°±æ˜¯ MVC ä¸­çš„ Controller æ¼”å˜æˆ ViewModel,ï¼ŒMVVM ä¸»è¦é€šè¿‡æ•°æ®æ¥æ˜¾ç¤ºè§†å›¾å±‚è€Œä¸æ˜¯æ“ä½œèŠ‚ç‚¹ï¼Œè§£å†³äº† MVC ä¸­å¤§é‡çš„ DOM æ“ä½œä½¿é¡µé¢æ¸²æŸ“æ€§èƒ½é™ä½ï¼ŒåŠ è½½é€Ÿåº¦æ…¢ï¼Œå½±å“ç”¨æˆ·ä½“éªŒé—®é¢˜ã€‚ä¸»è¦ç”¨äºæ•°æ®æ“ä½œæ¯”è¾ƒå¤šçš„åœºæ™¯ã€‚åœºæ™¯ï¼šæ•°æ®æ“ä½œæ¯”è¾ƒå¤šçš„åœºæ™¯ï¼Œæ›´åŠ ä¾¿æ· v-show å’Œ v-if æŒ‡ä»¤çš„å…±åŒç‚¹å’Œä¸åŒç‚¹? v-show æŒ‡ä»¤æ˜¯é€šè¿‡ä¿®æ”¹å…ƒç´ çš„ displayCSS å±æ€§è®©å…¶æ˜¾ç¤ºæˆ–è€…éšè—ã€‚ ã€CSS æ§åˆ¶èŠ‚ç‚¹æ˜¯å¦æ˜¾ç¤ºï¼ŒèŠ‚ç‚¹ä¸€ç›´å­˜åœ¨ã€‘ v-if æŒ‡ä»¤æ˜¯ç›´æ¥é”€æ¯å’Œé‡å»º DOM è¾¾åˆ°è®©å…ƒç´ æ˜¾ç¤ºå’Œéšè—çš„æ•ˆæœã€‚ ã€DOM èŠ‚ç‚¹æ˜¯å¦å­˜åœ¨ã€‘ ä½¿ç”¨åœºæ™¯ï¼šéœ€è¦åå¤å±•ç¤ºå°±ç”¨v-showï¼Œå¦‚æœä¸€æ¬¡å†³å®šä¸åŒæ¨¡æ¿å†…å®¹å°±ç”¨v-if vue ä¸­ key å€¼çš„ä½œç”¨å½“ Vue.js ç”¨ v-for æ­£åœ¨æ›´æ–°å·²æ¸²æŸ“è¿‡çš„å…ƒç´ åˆ—è¡¨æ—¶ï¼Œå®ƒé»˜è®¤ç”¨â€œå°±åœ°å¤ç”¨â€ç­–ç•¥ã€‚å¦‚æœæ•°æ®é¡¹çš„é¡ºåºè¢«æ”¹å˜ï¼ŒVue å°†ä¸ä¼šç§»åŠ¨ DOM å…ƒç´ æ¥åŒ¹é…æ•°æ®é¡¹çš„é¡ºåºï¼Œ è€Œæ˜¯ç®€å•å¤ç”¨æ­¤å¤„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”ç¡®ä¿å®ƒåœ¨ç‰¹å®šç´¢å¼•ä¸‹æ˜¾ç¤ºå·²è¢«æ¸²æŸ“è¿‡çš„æ¯ä¸ªå…ƒç´ ã€‚key çš„ä½œç”¨ä¸»è¦æ˜¯ä¸ºäº†é«˜æ•ˆçš„æ›´æ–°è™šæ‹Ÿ DOM ã€é˜²æ­¢é‡‡ç”¨å°±åœ°å¤ç”¨ç­–ç•¥è¿›è¡Œæ”¹å˜ã€‘ å¦‚ä½•åœ¨ç»„ä»¶å†…éƒ¨å®ç°ä¸€ä¸ªåŒå‘æ•°æ®ç»‘å®šï¼Ÿ è¯¥é¢˜ç›®åˆå¯èƒ½ç§°ä¹‹ä¸º ï¼šå¦‚ä½•åœ¨ç»„ä»¶ä¸Šé¢ä½¿ç”¨ v-model è€ƒå¯Ÿç»„ä»¶çš„ v-model æ–‡æ¡£åœ°å€ï¼š https://cn.vuejs.org/v2/guide/components-custom-events.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E7%9A%84-v-model https://cn.vuejs.org/v2/guide/components.html#%E5%9C%A8%E7%BB%84%E4%BB%B6%E4%B8%8A%E4%BD%BF%E7%94%A8-v-model import Vue from &#x27;vue&#x27;;const component = &#123; props: [&#x27;value&#x27;], // é»˜è®¤propsæ¥æ”¶valueå±æ€§ template: ``, data() &#123; return &#123;&#125;; &#125;, methods: &#123; handleInput(e) &#123; this.$emit(&#x27;input&#x27;, e.target.value); // é»˜è®¤è§¦å‘è‡ªå®šä¹‰äº‹ä»¶input &#125;, &#125;,&#125;;new Vue(&#123; components: &#123; CompOne: component, &#125;, el: &#x27;#root&#x27;, template: ``, data() &#123; return &#123; value: &#x27;123&#x27;, &#125;; &#125;,&#125;); å¸¸ç”¨æŒ‡ä»¤ v-model åŒå‘æ•°æ®ç»‘å®šï¼Œä¸€èˆ¬ç”¨äºè¡¨å•å…ƒç´ ã€‚ v-for å¯¹æ•°ç»„æˆ–å¯¹è±¡è¿›è¡Œå¾ªç¯æ“ä½œï¼Œä½¿ç”¨æ˜¯ v-for ä¸æ˜¯ v-repeat v-on ç”¨æ¥ç»‘å®šäº‹ä»¶ï¼Œç”¨æ³•ï¼šv-on:äº‹ä»¶ = â€˜å‡½æ•°â€™ v-show/v-if ç”¨æ¥æ˜¾ç¤ºæˆ–éšè—å…ƒç´ ï¼Œv-show æ˜¯é€šè¿‡ display å®ç°ï¼Œv-if æ˜¯æ¯æ¬¡åˆ é™¤ååœ¨åˆ›å»º v-bind å±æ€§ç»‘å®š v-html æ¸²æŸ“æ–‡æ¡£ï¼Œå¯ä»¥ç¼–è¯‘ HTML å­—ç¬¦ä¸² v-text æ¸²æŸ“æ–‡æœ¬ï¼Œä¸å¯ä»¥ç¼–è¯‘ HTML å­—ç¬¦ä¸² computed å’Œ method åŒºåˆ« computed ä¾èµ–äºç¼“å­˜ï¼Œä¾èµ–çš„å˜é‡å˜åŒ–äº†æ‰ä¼šå˜åŒ–ï¼Œæ¨¡æ¿å˜åŒ–äº†ï¼Œå³ä½¿ä¾èµ–å˜é‡æ²¡æœ‰å˜åŒ–ä¹Ÿä¸ä¼šé‡æ–°è®¡ç®—ï¼› method æ˜¯äº‹ä»¶ï¼Œmethod é‡Œé¢çš„äº‹ä»¶æ¯æ¬¡éƒ½ä¼šæ‰§è¡Œï¼Œåªè¦æ¨¡æ¿æ›´æ–°éƒ½ä¼šå†æ¬¡æ‰§è¡Œã€‚ ä»€ä¹ˆæ˜¯ vue çš„å•å‘æ•°æ®æµ æ–‡æ¡£åœ°å€ï¼šhttps://cn.vuejs.org/v2/guide/components-props.html#%E5%8D%95%E5%90%91%E6%95%B0%E6%8D%AE%E6%B5%81 vue çš„å•å‘æ•°æ®æµæŒ‡çš„æ˜¯ vue ç»„ä»¶é€šä¿¡é‡Œé¢çˆ¶å­é€šä¿¡æ˜¯è‡ªä¸Šè€Œä¸‹çš„ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥ä¿®æ”¹ props é‡Œé¢å±æ€§ã€‚ vue é‡Œé¢å¦‚ä½•æ“ä½œæ ·å¼ æ“ä½œ style å¯¹è±¡è¯­æ³• :style=&quot;&#123;CSSå±æ€§å:å˜é‡&#125;&quot; æ•°ç»„è¯­æ³• :style=&quot;[æ ·å¼æè¿°å˜é‡1ï¼Œæ ·å¼æè¿°å˜é‡2]&quot; ç›´æ¥å­—ç¬¦ä¸² style=&#39;csså±æ€§å:csså±æ€§å€¼;csså±æ€§å2:csså±æ€§å€¼2;...&#39; æ“ä½œ class å¯¹è±¡è¯­æ³• :class=&quot;&#123;classå:å¸ƒå°”å˜é‡&#125;&quot; æ•°ç»„è¯­æ³• :class=&quot;[å˜é‡1,å˜é‡2,...]&quot; ä¸‰æœ¨è¯­æ³•ï¼š :class = &quot;æ¡ä»¶ ? &#39;classå1&#39;:&#39;classå2&#39;&quot; v-if å’Œ v-for ä¸ºä»€ä¹ˆä¸æ¨èä¸€èµ·ç”¨å½“ v-if ä¸ v-for ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œv-for å…·æœ‰æ¯” v-if æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚ æ‰€ä»¥ä¼šå¯¼è‡´æ¯ä¸ªåˆ—è¡¨é¡¹æ¸²æŸ“çš„æ—¶å€™éƒ½ä¼šè¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œä»è€Œè®©æ€§èƒ½æ¯”è¾ƒä½ã€‚ æ•°ç»„æ›´æ–°æ£€æµ‹æœ‰å“ªäº›æ–¹æ³• å˜æ›´æ–¹æ³• ã€ä¿®æ”¹åŸæ•°ç»„ã€‘ Vue å°†è¢«ä¾¦å¬çš„æ•°ç»„çš„å˜æ›´æ–¹æ³•è¿›è¡Œäº†åŒ…è£¹ï¼Œæ‰€ä»¥å®ƒä»¬ä¹Ÿå°†ä¼šè§¦å‘è§†å›¾æ›´æ–°ã€‚è¿™äº›è¢«åŒ…è£¹è¿‡çš„æ–¹æ³•åŒ…æ‹¬ï¼š push();pop();shift();unshift();splice();sort();reverse(); æ›¿æ¢æ•°ç»„ å˜æ›´æ–¹æ³•ï¼Œé¡¾åæ€ä¹‰ï¼Œä¼šå˜æ›´è°ƒç”¨äº†è¿™äº›æ–¹æ³•çš„åŸå§‹æ•°ç»„ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¹Ÿæœ‰éå˜æ›´æ–¹æ³•ï¼Œä¾‹å¦‚ filter()ã€concat() å’Œ slice()ã€‚å®ƒä»¬ä¸ä¼šå˜æ›´åŸå§‹æ•°ç»„ï¼Œè€Œæ€»æ˜¯è¿”å›ä¸€ä¸ªæ–°æ•°ç»„ã€‚ å¦‚æœè·å–äº‹ä»¶å¯¹è±¡ åœ¨ä¹¦å†™äº‹ä»¶å‡½æ•°çš„æ—¶å€™ç›´æ¥å†™ä¸Šå½¢å‚å°±è¡¨ç¤ºäº‹ä»¶å¯¹è±¡ methods:&#123; fn(ev)&#123; // evå°±æ˜¯äº‹ä»¶å¯¹è±¡ &#125;&#125; å¦‚æœæ—¢è¦ä¼ å‚åˆè¦è·å–äº‹ä»¶å¯¹è±¡ï¼Œé‚£ä¹ˆä¼ å…¥å®å‚çš„æ—¶å€™ä¼ å…¥ä¸€ä¸ª$eventè¡¨ç¤ºäº‹ä»¶å¯¹è±¡ï¼Œ$eventè¿™ä¸ªå•è¯ä¸èƒ½å†™é”™ &lt;button @click=&quot;run(10,$event)&quot;&gt;ç‚¹å‡»&lt;/button&gt;&lt;script&gt; methods:&#123; run(num,ev)&#123; // å½¢å‚å®å‚ä¸€ä¸€å¯¹åº”ï¼Œevå’Œ$eventå¯¹åº”æ‰€ä»¥ å°±æ˜¯äº‹ä»¶å¯¹è±¡ &#125; &#125;&lt;/script&gt; å“ªäº›å¸¸è§äº‹ä»¶ä¿®é¥°ç¬¦ï¼Œæœ‰ä½•ä½œç”¨ .stop é˜»æ­¢å†’æ³¡ .prevent é˜»æ­¢é»˜è®¤è¡Œä¸º .capture æ•è·é˜¶æ®µè§¦å‘ .self è‡ªå·±æœ¬èº«ä¸Šé¢è§¦å‘ .once ä¸€æ¬¡æ€§ç»‘å®š .passive ä¸€èˆ¬ç»™ scroll æˆ–è€… resize äº‹ä»¶ç»‘å®šï¼Œç­‰åˆ°è°ƒæ•´å®Œæˆä¹‹åè§¦å‘ã€‚ æœ‰å“ªäº›å¸¸è§æŒ‰é”®ä¿®é¥°ç¬¦ï¼Œä»¥åŠå¦‚ä½•å®šä¹‰æŒ‰é”®ä¿®é¥°ç¬¦ .enter .tab .delete (æ•è·â€œåˆ é™¤â€å’Œâ€œé€€æ ¼â€é”®) .esc .space .up .down .left .right æ‰€æœ‰å­—æ¯éƒ½ä¹Ÿæ˜¯æŒ‰é”®ä¿®é¥°ç¬¦ è‡ªå®šä¹‰æŒ‰é”®ä¿®é¥°ç¬¦ï¼šVue.config.keyCodes.æŒ‰é”®ä¿®é¥°ç¬¦å = æŒ‰é”®ç  å¦‚ä½•å®ç°ä¸€ä¸ª v-model æŒ‡ä»¤ v-model å…¶å®æ˜¯ å±æ€§ç»‘å®šå’Œäº‹ä»¶ç»¼åˆä½¿ç”¨çš„è¯­æ³•ç³–ã€‚ &lt;input type=&quot;text&quot; :value=&quot;msg&quot; @input=&quot;msg=$event.target.value&quot; /&gt;// å…ˆç»™è¾“å…¥æ¡†çš„valueç»‘å®šå˜é‡ï¼Œè¿™å«åšå±æ€§ç»‘å®š// å†ç»™è¾“å…¥æ¡†ç»‘å®šinputäº‹ä»¶ï¼Œä¸€æ—¦è¾“å…¥ï¼Œå°±å°†è¾“å…¥æ¡†çš„å€¼èµ‹ç»™msgå˜é‡ï¼Œä»è€Œå®ç°åŒå‘ç»‘å®š è¡¨å•æ§ä»¶ç»‘å®šéœ€è¦ä»€ä¹ˆï¼Ÿ ç»™ä¸€ç»„å•é€‰æ§ä»¶ç»‘å®šç»™åŒä¸€ä¸ªå˜é‡ï¼Œä¸”æ¯ä¸ªå•é€‰æ§ä»¶éƒ½è¦æœ‰ä¸ªä¸€ä¸ª value ç»™ä¸€ç»„å¤šé€‰æ§ä»¶ç»‘å®šåŒä¸€ä¸ªå˜é‡ï¼Œä¸”è¿™ä¸ªå˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸”æ¯ä¸ªå¤šé€‰é¡¹éƒ½è¦æœ‰ä¸€ä¸ª value å¦‚æœ input çš„ type ä¸º checkboxï¼Œæˆ‘ä»¬ç”¨æ¥åšå‹¾é€‰çš„æ—¶å€™ï¼Œ åº”è¯¥ç»‘å®šä¸€ä¸ªå¸ƒå°”å€¼ç±»å‹çš„å˜é‡ textarea ç»‘å®šæ•°æ®ï¼ŒåŒæ ·åº”è¯¥ä½¿ç”¨ v-model ç›´æ¥ç»™åˆ°æ ‡ç­¾ï¼Œè€Œä¸æ˜¯æ’å€¼è¡¨è¾¾å¼ æœ‰å“ªäº›å¸¸è§çš„è¡¨å•ä¿®é¥°ç¬¦ .lazy åœ¨â€œchangeâ€æ—¶è€Œéâ€œinputâ€æ—¶æ›´æ–° .number å°†ç”¨æˆ·çš„è¾“å…¥å€¼è½¬ä¸ºæ•°å€¼ç±»å‹ .trim è‡ªåŠ¨è¿‡æ»¤ç”¨æˆ·è¾“å…¥çš„é¦–å°¾ç©ºç™½å­—ç¬¦ å¦‚ä½•å®šä¹‰ä¸€ä¸ªç»„ä»¶ å…¨å±€æ³¨å†Œ Vue.component(ç»„ä»¶å, &#123; ç»„ä»¶é…ç½®é€‰é¡¹ &#125;); å±€éƒ¨æ³¨å†Œ // ç»„ä»¶æˆ–è€…vueå®ä¾‹çš„é…ç½®é€‰é¡¹é‡Œé¢å¢åŠ componentså±æ€§ã€‚&#123; ..., components:&#123; ç»„ä»¶å:&#123; ç»„ä»¶é…ç½®å¯¹è±¡ &#125; &#125;&#125; ç»„ä»¶ data ä¸ºå•¥æ˜¯ä¸€ä¸ªå‡½æ•°å› ä¸ºç»„ä»¶æ˜¯å¯ä»¥å¤ç”¨çš„,JS é‡Œå¯¹è±¡æ˜¯å¼•ç”¨å…³ç³»,å¦‚æœç»„ä»¶ data æ˜¯ä¸€ä¸ªå¯¹è±¡,é‚£ä¹ˆå­ç»„ä»¶ä¸­çš„ data å±æ€§å€¼ä¼šäº’ç›¸æ±¡æŸ“,äº§ç”Ÿå‰¯ä½œç”¨ã€‚ ç®€è€Œè¨€ä¹‹ï¼šç»„ä»¶çš„æ•°æ®åº”è¯¥æ˜¯å„è‡ªç‹¬ç«‹çš„ï¼Œäº’ä¸å¹²æ‰°ï¼Œæ‰€ä»¥ data æ˜¯å‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ ·å„è‡ªå°±ç‹¬ç«‹äº†ã€‚ ç»„ä»¶çš„ props æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•å®šä¹‰ props æ˜¯ç»„ä»¶å‘å¤–æä¾›çš„ä¸€ä¸ªæ¥å£ï¼Œç”¨æ¥æ¥æ”¶å¤–éƒ¨æ•°æ®ï¼Œä¹Ÿæ˜¯çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶çš„ä¸»è¦æ–¹å¼ å¦‚ä½•å®šä¹‰ // æ–¹å¼1ï¼š æ•°ç»„è¯­æ³•props:[&#x27;è‡ªå®šä¹‰å±æ€§å1&#x27;,&#x27;è‡ªå®šä¹‰å±æ€§å2&#x27;,...]// æ–¹å¼2ï¼š å¯¹è±¡è¯­æ³•props:&#123; è‡ªå®šä¹‰å±æ€§å1:&#123; type:ç±»å‹ æˆ– [ç±»å‹1ï¼Œç±»å‹2,...], // ç±»å‹æœ‰ Object,Array,String,Boolean,Number,Date,Function ï¼Œ default:é»˜è®¤å€¼ï¼Œ // åŸºæœ¬æ•°æ®ç±»å‹ default()&#123; // å¦‚æœpropsçš„å€¼æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆè®¾ç½®é»˜è®¤å€¼çš„æ—¶å€™åº”è¯¥æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›æ•°ç»„æˆ–å¯¹è±¡ return []/&#123;&#125; &#125;, required:true/false, validator:function(val)&#123; // valå°±æ˜¯è¯¥å±æ€§å¯¹åº”çš„å€¼ï¼Œç”¨äºå†…éƒ¨åšåˆ¤æ–­ä½¿ç”¨ return true/false // trueè¡¨ç¤ºéªŒè¯é€šè¿‡ï¼Œfalseè¡¨ç¤ºéªŒè¯ä¸é€šè¿‡ï¼Œæ§åˆ¶å°ä¼šæœ‰è­¦å‘Š &#125; &#125;&#125; å¦‚ä½•è‡ªå®šä¹‰ç»„ä»¶çš„ v-modelä¸€ä¸ªç»„ä»¶ä¸Šçš„ v-model é»˜è®¤ä¼šåˆ©ç”¨åä¸º value çš„ prop å’Œåä¸º input çš„äº‹ä»¶ï¼Œä½†æ˜¯åƒå•é€‰æ¡†ã€å¤é€‰æ¡†ç­‰ç±»å‹çš„è¾“å…¥æ§ä»¶å¯èƒ½ä¼šå°† value attribute ç”¨äºä¸åŒçš„ç›®çš„ã€‚model é€‰é¡¹å¯ä»¥ç”¨æ¥é¿å…è¿™æ ·çš„å†²çªï¼š Vue.component(&#x27;base-checkbox&#x27;, &#123; model: &#123; prop: &#x27;checked&#x27;, event: &#x27;change&#x27;, &#125;, props: &#123; checked: Boolean, &#125;, template: ` &lt;input type=&quot;checkbox&quot; v-bind:checked=&quot;checked&quot; v-on:change=&quot;$emit(&#x27;change&#x27;, $event.target.checked)&quot; &gt; `,&#125;); ç°åœ¨åœ¨è¿™ä¸ªç»„ä»¶ä¸Šä½¿ç”¨ v-model çš„æ—¶å€™ï¼š &lt;base-checkbox v-model=&quot;lovingVue&quot;&gt;&lt;/base-checkbox&gt; è¿™é‡Œçš„ lovingVue çš„å€¼å°†ä¼šä¼ å…¥è¿™ä¸ªåä¸º checked çš„ propã€‚åŒæ—¶å½“ &lt;base-checkbox&gt; è§¦å‘ä¸€ä¸ª change äº‹ä»¶å¹¶é™„å¸¦ä¸€ä¸ªæ–°çš„å€¼çš„æ—¶å€™ï¼Œè¿™ä¸ª lovingVue çš„ property å°†ä¼šè¢«æ›´æ–°ã€‚ æ³¨æ„ä½ ä»ç„¶éœ€è¦åœ¨ç»„ä»¶çš„ props é€‰é¡¹é‡Œå£°æ˜ checked è¿™ä¸ª propã€‚ .nativeä¿®é¥°ç¬¦æœ‰ä½•ç”¨ å½“æˆ‘ä»¬ç»™ç»„ä»¶ç»‘å®šåŸç”Ÿäº‹ä»¶æ— æ•ˆçš„æ—¶å€™ï¼Œå¯ä»¥åŠ ä¸Š.nativeä¿®é¥°ç¬¦å°±å¯ä»¥è®©ç»„ä»¶ä¸Šé¢çš„åŸç”Ÿäº‹ä»¶æœ‰æ•ˆã€‚ .syncä¿®é¥°ç¬¦æœ‰ä½•ä½œç”¨.syncçš„ç”¨æ³•å¦‚ä¸‹ï¼š &lt;ç»„ä»¶ :å±æ€§å.sync=&quot;å˜é‡&quot; /&gt; å…¶å®ä»–æœ¬è´¨æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼š &lt;ç»„ä»¶ :å±æ€§å=&quot;å˜é‡&quot; @update:å±æ€§å = &quot;å˜é‡=$event&quot; /&gt; å…¶å®æ˜¯ v-model çš„å¦å¤–ä¸€ç§ä½¿ç”¨å±•ç¤ºã€‚ è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æ¨èä»¥ update:myPropName çš„æ¨¡å¼è§¦å‘äº‹ä»¶å–è€Œä»£ä¹‹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ä¸€ä¸ªåŒ…å« title prop çš„å‡è®¾çš„ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•è¡¨è¾¾å¯¹å…¶èµ‹æ–°å€¼çš„æ„å›¾ï¼š this.$emit(&#x27;update:title&#x27;, newTitle) ç„¶åçˆ¶ç»„ä»¶å¯ä»¥ç›‘å¬é‚£ä¸ªäº‹ä»¶å¹¶æ ¹æ®éœ€è¦æ›´æ–°ä¸€ä¸ªæœ¬åœ°çš„æ•°æ® propertyã€‚ä¾‹å¦‚ï¼š &lt;text-document v-bind:title=&quot;doc.title&quot; v-on:update:title=&quot;doc.title = $event&quot;&gt;&lt;/text-document&gt; ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬ä¸ºè¿™ç§æ¨¡å¼æä¾›ä¸€ä¸ªç¼©å†™ï¼Œå³ .sync ä¿®é¥°ç¬¦ï¼š &lt;text-document v-bind:title.sync=&quot;doc.title&quot;&gt;&lt;/text-document&gt; æ³¨æ„å¸¦æœ‰ .sync ä¿®é¥°ç¬¦çš„ v-bind **ä¸èƒ½å’Œè¡¨è¾¾å¼ä¸€èµ·ä½¿ç”¨** æ’æ§½æ˜¯ä»€ä¹ˆï¼Ÿ æœ‰å“ªäº›åˆ†ç±»ï¼Ÿ æ’æ§½æ˜¯ç”¨æ¥è‡ªå®šä¹‰ç»„ä»¶å†…éƒ¨æ¨¡æ¿å†…å®¹çš„ä¸€ç§æ–¹å¼ï¼› åˆ†ç±»ï¼š é»˜è®¤æ’æ§½ å…·åæ’æ§½ ä½œç”¨åŸŸæ’æ§½ å†™ä¸€ä¸ªå…·åæ’æ§½æ–¹å¼ 1ï¼š(è€å†™æ³•) &lt;!--ç»„ä»¶å¤–éƒ¨--&gt;&lt;ç»„ä»¶å&gt; &lt;template slot=&quot;åç§°&quot;&gt; è‡ªå®šä¹‰HTMLå†…å®¹ &lt;/template&gt;&lt;/ç»„ä»¶å&gt;&lt;!--ç»„ä»¶å†…éƒ¨--&gt;&lt;slot name=&quot;åç§°&quot;&gt;&lt;/slot&gt; æ–¹å¼ 2ï¼š &lt;!--ç»„ä»¶å¤–éƒ¨--&gt;&lt;ç»„ä»¶å&gt; &lt;template v-slot:åç§°&gt; è‡ªå®šä¹‰HTMLå†…å®¹ &lt;/template&gt;&lt;/ç»„ä»¶å&gt;&lt;!--ç»„ä»¶å†…éƒ¨--&gt;&lt;slot name=&quot;åç§°&quot;&gt;&lt;/slot&gt; æ–¹å¼ 3ï¼šå…¶å®æ˜¯æ–¹å¼ 2 çš„ç®€å†™ &lt;!--ç»„ä»¶å¤–éƒ¨--&gt;&lt;ç»„ä»¶å&gt; &lt;template #åç§°&gt; è‡ªå®šä¹‰HTMLå†…å®¹ &lt;/template&gt;&lt;/ç»„ä»¶å&gt;&lt;!--ç»„ä»¶å†…éƒ¨--&gt;&lt;slot name=&quot;åç§°&quot;&gt;&lt;/slot&gt; ä½œç”¨åŸŸæ’æ§½å¦‚ä½•å†™æ–¹å¼ 1ï¼š(è€å†™æ³•) &lt;!--ç»„ä»¶å¤–éƒ¨--&gt;&lt;ç»„ä»¶å&gt; &lt;template slot=&quot;åç§°&quot; slot-scope=&quot;ä½œç”¨åŸŸå&quot;&gt; è‡ªå®šä¹‰HTMLå†…å®¹ &lt;/template&gt;&lt;/ç»„ä»¶å&gt; æ–¹å¼ 2ï¼š &lt;!--ç»„ä»¶å¤–éƒ¨--&gt;&lt;ç»„ä»¶å&gt; &lt;template v-slot:åç§°=&quot;ä½œç”¨åŸŸå&quot;&gt; è‡ªå®šä¹‰HTMLå†…å®¹ &lt;/template&gt;&lt;/ç»„ä»¶å&gt; æ–¹å¼ 3ï¼šå…¶å®æ˜¯æ–¹å¼ 2 çš„ç®€å†™ &lt;!--ç»„ä»¶å¤–éƒ¨--&gt;&lt;ç»„ä»¶å&gt; &lt;template #åç§°=&quot;ä½œç”¨åŸŸå&quot;&gt; è‡ªå®šä¹‰HTMLå†…å®¹ &lt;/template&gt;&lt;/ç»„ä»¶å&gt; å¦‚ä½•å®ç°åŠ¨æ€ç»„ä»¶&lt;component :is=&quot;å˜é‡&quot;&gt;&lt;/component&gt;&lt;!--å˜é‡çš„å€¼å°±æ˜¯ç»„ä»¶åï¼Œè¿™é‡Œå°±ä¼šå±•ç¤ºä»€ä¹ˆç»„ä»¶--&gt; å¦‚ä½•å®ç°ç¼“å­˜ç»„ä»¶&lt;keep-alive&gt; &lt;ç»„ä»¶å&gt;&lt;/ç»„ä»¶å&gt;&lt;/keep-alive&gt; ç¼“å­˜ç»„ä»¶è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ ç¼“å­˜ç»„ä»¶æŠ±èµ·æ¥çš„ç»„ä»¶å°†ä¼šè¢«ç¼“å­˜ï¼Œä¸‹ä¸€æ¬¡æ‰“å¼€çš„æ—¶å€™ä¸ä¼šè¢«å†æ¬¡åˆ›å»ºï¼ˆæ‰€ä»¥å‰å››ä¸ªç”Ÿå‘½å‘¨æœŸä¸ä¼šå†æ¬¡è¢«åˆ›å»ºï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æŠŠç»„ä»¶ä¸€æ‰“å¼€å°±è¦åšçš„æ”¾åœ¨ created æˆ– mounted é‡Œé¢ï¼Œå› ä¸ºç»„ä»¶ä¸ä¼šå†æ¬¡åˆ›å»ºã€‚æˆ‘ä»¬éœ€è¦æ”¾åœ¨activatedé’©å­é‡Œé¢ã€‚å…·ä½“å¯å‚è§æ–‡æ¡£ï¼šhttps://cn.vuejs.org/v2/api/#activated å¦‚ä½•å®šä¹‰ä¸€ä¸ªé€’å½’ç»„ä»¶ æ‰€è°“çš„é€’å½’ç»„ä»¶å°±æ˜¯å†…éƒ¨ä¸æ–­è°ƒç”¨è‡ªå·±ï¼Œåœ¨æˆ‘ä»¬çš„æ ‘å½¢ç»“æ„ä¸­éå¸¸å¸¸è§ï¼Œå¦‚æ— é™æåˆ†ç±»ï¼›æ— é™æèœå•éƒ½å¸¸ç”¨ï¼› é€’å½’ç»„ä»¶æœ€æ ¸å¿ƒçš„å°±æ˜¯ç»„ä»¶ä¸€å®šè¦å®šä¹‰å¥½ name åæ¬¡ï¼Œå¦åˆ™æ— æ³•èµ·ä½œç”¨ã€‚ é€’å½’ç»„ä»¶ä¸€å®šè¦æœ‰ä¸æˆç«‹çš„æ—¶å€™ï¼Œå¦åˆ™æ— é™é€’å½’ï¼Œå°±ä¼šå‡ºé”™ã€‚ - æ•°æ®å¦‚ä¸‹ var data = [ &#123; id: &#x27;1&#x27;, data: &#123; menuName: &#x27;é¡¹ç›®ç®¡ç†&#x27;, menuCode: &#x27;&#x27;, &#125;, childTreeNode: [ &#123; data: &#123; menuName: &#x27;é¡¹ç›®&#x27;, menuCode: &#x27;BusProject&#x27;, &#125;, childTreeNode: [], &#125;, &#123; data: &#123; menuName: &#x27;æˆ‘çš„ä»»åŠ¡&#x27;, menuCode: &#x27;BusProject&#x27;, &#125;, childTreeNode: [], &#125;, &#123; data: &#123; menuName: &#x27;äººå‘˜å‘¨æŠ¥&#x27;, menuCode: &#x27;BusProject&#x27;, &#125;, childTreeNode: [], &#125;, ], &#125;, &#123; id: &#x27;2&#x27;, data: &#123; menuName: &#x27;æ•°æ®ç»Ÿè®¡&#x27;, menuCode: &#x27;BusClock&#x27;, &#125;, childTreeNode: [], &#125;, &#123; id: &#x27;3&#x27;, data: &#123; menuName: &#x27;äººäº‹ç®¡ç†&#x27;, menuCode: &#x27;&#x27;, &#125;, childTreeNode: [], &#125;, &#123; id: &#x27;4&#x27;, data: &#123; menuName: &#x27;åŸºç¡€ç®¡ç†&#x27;, menuCode: &#x27;&#x27;, &#125;, childTreeNode: [], &#125;,]; é€’å½’ç»„ä»¶ &lt;!-- çˆ¶ç»„ä»¶ä¸­å¼•å…¥items --&gt;&lt;items :model=&quot;model&quot; v-for=&quot;model in data&quot;&gt;&lt;/items&gt;&lt;template&gt; &lt;li&gt; &lt;div @click=&quot;toggle&quot;&gt; &lt;i v-if=&quot;isFolder&quot; class=&quot;fa &quot; :class=&quot;[open ? &#x27;fa-folder-open&#x27; : &#x27;fa-folder&#x27;]&quot;&gt;&lt;/i&gt; &lt;!--isFolderåˆ¤æ–­æ˜¯å¦å­˜åœ¨å­çº§æ”¹å˜å›¾æ ‡--&gt; &lt;i v-if=&quot;!isFolder&quot; class=&quot;fa fa-file-text&quot;&gt;&lt;/i&gt; &#123;&#123; model.data.menuName &#125;&#125; &lt;/div&gt; &lt;ul v-show=&quot;open&quot; v-if=&quot;isFolder&quot;&gt; &lt;items v-for=&quot;cel in model.childTreeNode&quot; :model=&quot;cel&quot;&gt;&lt;/items&gt; &lt;/ul&gt; &lt;/li&gt;&lt;/template&gt;&lt;script type=&quot;text/javascript&quot;&gt; export default &#123; name: &#x27;items&#x27;, props: [&#x27;model&#x27;], components: &#123;&#125;, data() &#123; return &#123; open: false, isFolder: true, &#125;; &#125;, computed: &#123; isFolder: function () &#123; return this.model.childTreeNode &amp;&amp; this.model.childTreeNode.length; &#125;, &#125;, methods: &#123; toggle: function () &#123; if (this.isFolder) &#123; this.open = !this.open; &#125; &#125;, &#125;, &#125;;&lt;/script&gt; vue å¦‚ä½•å¼ºåˆ¶åˆ·æ–°ç»„ä»¶1.ä½¿ç”¨ this.$forceUpdate å¼ºåˆ¶é‡æ–°æ¸²æŸ“ å¦‚æœè¦åœ¨ç»„ä»¶å†…éƒ¨ä¸­è¿›è¡Œå¼ºåˆ¶åˆ·æ–°ï¼Œåˆ™å¯ä»¥è°ƒç”¨**this.$forceUpdate()**å¼ºåˆ¶é‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Œä»è€Œè¾¾åˆ°æ›´æ–°ç›®çš„ã€‚ &lt;template&gt;&lt;button @click=&quot;reload()&quot;&gt;åˆ·æ–°å½“å‰ç»„ä»¶&lt;/button&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: &#x27;comp&#x27;, methods: &#123; reload() &#123; this.$forceUpdate() &#125; &#125;&#125;&lt;/script&gt; 2.ä½¿ç”¨ v-if æŒ‡ä»¤ å¦‚æœæ˜¯åˆ·æ–°æŸä¸ªå­ç»„ä»¶ï¼Œåˆ™å¯ä»¥é€šè¿‡ v-if æŒ‡ä»¤å®ç°ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå½“ v-if çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç»„ä»¶éƒ½ä¼šè¢«é‡æ–°æ¸²æŸ“ä¸€éã€‚å› æ­¤ï¼Œåˆ©ç”¨ v-if æŒ‡ä»¤çš„ç‰¹æ€§ï¼Œå¯ä»¥è¾¾åˆ°å¼ºåˆ¶åˆ·æ–°ç»„ä»¶çš„ç›®çš„ã€‚ &lt;template&gt; &lt;comp v-if=&quot;update&quot;&gt;&lt;/comp&gt; &lt;button @click=&quot;reload()&quot;&gt;åˆ·æ–°compç»„ä»¶&lt;/button&gt;&lt;/template&gt;&lt;script&gt; import comp from &#x27;@/views/comp.vue&#x27;; export default &#123; name: &#x27;parentComp&#x27;, data() &#123; return &#123; update: true, &#125;; &#125;, methods: &#123; reload() &#123; // ç§»é™¤ç»„ä»¶ this.update = false; // åœ¨ç»„ä»¶ç§»é™¤åï¼Œé‡æ–°æ¸²æŸ“ç»„ä»¶ // this.$nextTickå¯å®ç°åœ¨DOM çŠ¶æ€æ›´æ–°åï¼Œæ‰§è¡Œä¼ å…¥çš„æ–¹æ³•ã€‚ this.$nextTick(() =&gt; &#123; this.update = true; &#125;); &#125;, &#125;, &#125;;&lt;/script&gt; ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ vue åŠ¨ç”» æ¡ä»¶æ¸²æŸ“ (ä½¿ç”¨ v-if) æ¡ä»¶å±•ç¤º (ä½¿ç”¨ v-show) åŠ¨æ€ç»„ä»¶ ç»„ä»¶æ ¹èŠ‚ç‚¹ vue åŠ¨ç”»æœ‰å“ªäº›ç±»å v-enterï¼šå®šä¹‰è¿›å…¥è¿‡æ¸¡çš„å¼€å§‹çŠ¶æ€ã€‚åœ¨å…ƒç´ è¢«æ’å…¥ä¹‹å‰ç”Ÿæ•ˆï¼Œåœ¨å…ƒç´ è¢«æ’å…¥ä¹‹åçš„ä¸‹ä¸€å¸§ç§»é™¤ã€‚ v-enter-activeï¼šå®šä¹‰è¿›å…¥è¿‡æ¸¡ç”Ÿæ•ˆæ—¶çš„çŠ¶æ€ã€‚åœ¨æ•´ä¸ªè¿›å…¥è¿‡æ¸¡çš„é˜¶æ®µä¸­åº”ç”¨ï¼Œåœ¨å…ƒç´ è¢«æ’å…¥ä¹‹å‰ç”Ÿæ•ˆï¼Œåœ¨è¿‡æ¸¡/åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚è¿™ä¸ªç±»å¯ä»¥è¢«ç”¨æ¥å®šä¹‰è¿›å…¥è¿‡æ¸¡çš„è¿‡ç¨‹æ—¶é—´ï¼Œå»¶è¿Ÿå’Œæ›²çº¿å‡½æ•°ã€‚ v-enter-toï¼š2.1.8 ç‰ˆåŠä»¥ä¸Šå®šä¹‰è¿›å…¥è¿‡æ¸¡çš„ç»“æŸçŠ¶æ€ã€‚åœ¨å…ƒç´ è¢«æ’å…¥ä¹‹åä¸‹ä¸€å¸§ç”Ÿæ•ˆ (ä¸æ­¤åŒæ—¶ v-enter è¢«ç§»é™¤)ï¼Œåœ¨è¿‡æ¸¡/åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚ v-leaveï¼šå®šä¹‰ç¦»å¼€è¿‡æ¸¡çš„å¼€å§‹çŠ¶æ€ã€‚åœ¨ç¦»å¼€è¿‡æ¸¡è¢«è§¦å‘æ—¶ç«‹åˆ»ç”Ÿæ•ˆï¼Œä¸‹ä¸€å¸§è¢«ç§»é™¤ã€‚ v-leave-activeï¼šå®šä¹‰ç¦»å¼€è¿‡æ¸¡ç”Ÿæ•ˆæ—¶çš„çŠ¶æ€ã€‚åœ¨æ•´ä¸ªç¦»å¼€è¿‡æ¸¡çš„é˜¶æ®µä¸­åº”ç”¨ï¼Œåœ¨ç¦»å¼€è¿‡æ¸¡è¢«è§¦å‘æ—¶ç«‹åˆ»ç”Ÿæ•ˆï¼Œåœ¨è¿‡æ¸¡/åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚è¿™ä¸ªç±»å¯ä»¥è¢«ç”¨æ¥å®šä¹‰ç¦»å¼€è¿‡æ¸¡çš„è¿‡ç¨‹æ—¶é—´ï¼Œå»¶è¿Ÿå’Œæ›²çº¿å‡½æ•°ã€‚ v-leave-toï¼š2.1.8 ç‰ˆåŠä»¥ä¸Šå®šä¹‰ç¦»å¼€è¿‡æ¸¡çš„ç»“æŸçŠ¶æ€ã€‚åœ¨ç¦»å¼€è¿‡æ¸¡è¢«è§¦å‘ä¹‹åä¸‹ä¸€å¸§ç”Ÿæ•ˆ (ä¸æ­¤åŒæ—¶ v-leave è¢«åˆ é™¤)ï¼Œåœ¨è¿‡æ¸¡/åŠ¨ç”»å®Œæˆä¹‹åç§»é™¤ã€‚ æœ‰å“ªäº›è‡ªå®šä¹‰è¿‡æ¸¡ç±»å enter-class enter-active-class enter-to-class (2.1.8+) leave-class leave-active-class leave-to-class (2.1.8+) vue ä¸­ mixins é…ç½®é€‰é¡¹æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä½•ä½œç”¨ mixins æ˜¯æ··å…¥ï¼Œç”¨äºå®ç°å¤ç”¨ç»„ä»¶æ‰€éœ€è¦çš„é…ç½®é€‰é¡¹ï¼Œå¯ä»¥å®ç°å¾ˆå¤šåŠŸèƒ½çš„å¤ç”¨ã€‚ æ–‡æ¡£åœ°å€ï¼šhttps://cn.vuejs.org/v2/guide/mixins.html ä½¿ç”¨ï¼š // å®šä¹‰ä¸€ä¸ªæ··å…¥å¯¹è±¡var myMixin = &#123; created: function () &#123; this.hello(); &#125;, methods: &#123; hello: function () &#123; console.log(&#x27;hello from mixin!&#x27;); &#125;, &#125;,&#125;;// å®šä¹‰ä¸€ä¸ªä½¿ç”¨æ··å…¥å¯¹è±¡çš„ç»„ä»¶var Component = Vue.extend(&#123; mixins: [myMixin],&#125;); mixin æ··å…¥å¯¹è±¡å’Œ Vuex çš„åŒºåˆ«ï¼š Vuex æ˜¯çŠ¶æ€å…±äº«ç®¡ç†ï¼Œæ‰€ä»¥ Vuex ä¸­çš„æ‰€æœ‰å˜é‡å’Œæ–¹æ³•éƒ½æ˜¯å¯ä»¥è¯»å–å’Œæ›´æ”¹å¹¶ç›¸äº’å½±å“çš„ï¼› mixin å¯ä»¥å®šä¹‰å…¬ç”¨çš„å˜é‡æˆ–æ–¹æ³•ï¼Œä½†æ˜¯ mixin ä¸­çš„æ•°æ®æ˜¯ä¸å…±äº«çš„ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªç»„ä»¶ä¸­çš„ mixin å®ä¾‹éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å•ç‹¬å­˜åœ¨çš„ä¸ªä½“ï¼Œä¸å­˜åœ¨ç›¸äº’å½±å“çš„ï¼› mixin æ··å…¥å¯¹è±¡å€¼ä¸ºå‡½æ•°çš„åŒåå‡½æ•°é€‰é¡¹å°†ä¼šè¿›è¡Œé€’å½’åˆå¹¶ä¸ºæ•°ç»„ï¼Œä¸¤ä¸ªå‡½æ•°éƒ½ä¼šæ‰§è¡Œï¼Œåªä¸è¿‡å…ˆæ‰§è¡Œ mixin ä¸­çš„åŒåå‡½æ•°ï¼›ï¼ˆç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ã€methods ç­‰ï¼‰ mixin æ··å…¥å¯¹è±¡å€¼ä¸ºå¯¹è±¡çš„åŒåå¯¹è±¡å°†ä¼šè¿›è¡Œæ›¿æ¢ï¼Œéƒ½ä¼˜å…ˆæ‰§è¡Œç»„ä»¶å†…çš„åŒåå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ç»„ä»¶å†…çš„åŒåå¯¹è±¡å°† mixin æ··å…¥å¯¹è±¡çš„åŒåå¯¹è±¡è¿›è¡Œè¦†ç›–ï¼›(watchã€methods ä¸­å®šä¹‰çš„æ–¹æ³•ç­‰) å¦‚ä½•å®ç°ä¸€ä¸ªè‡ªå®šä¹‰æŒ‡ä»¤// å…¨å±€æ³¨å†ŒæŒ‡ä»¤Vue.directive(&#x27;æŒ‡ä»¤å&#x27;, &#123; é…ç½®é€‰é¡¹,&#125;);// å±€éƒ¨æ³¨å†Œ&#123; directives: &#123; æŒ‡ä»¤å: &#123; é…ç½®é€‰é¡¹; &#125; &#125;&#125; è‡ªå®šä¹‰æŒ‡ä»¤æœ‰ä½•ä½œç”¨ï¼Ÿ æœ‰å“ªäº›é’©å­ ä½œç”¨ï¼šå½“æˆ‘ä»¬å¸Œæœ›å¯¹åŸç”Ÿçš„ DOM èŠ‚ç‚¹ï¼Œæˆ–è€…ç»„ä»¶ éƒ½åš æŸä¸€ç±»å‹çš„æ“ä½œçš„æ—¶å€™ï¼ˆå¦‚ï¼šé¡µé¢å·²è¿›å…¥è¾“å…¥æ¡†å°±è·å–ç„¦ç‚¹ï¼›å¦‚è¾“å…¥æ¡†ä¸€æ—¦åŠ ä¸ŠæŸä¸ªæŒ‡ä»¤å°±å¯ä»¥å®ç°è‡ªåŠ¨éªŒè¯ï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨è‡ªå®šä¹‰æŒ‡ä»¤æ¥å¼€å‘æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½ã€‚ é’©å­ï¼š bindï¼šåªè°ƒç”¨ä¸€æ¬¡ï¼ŒæŒ‡ä»¤ç¬¬ä¸€æ¬¡ç»‘å®šåˆ°å…ƒç´ æ—¶è°ƒç”¨ã€‚åœ¨è¿™é‡Œå¯ä»¥è¿›è¡Œä¸€æ¬¡æ€§çš„åˆå§‹åŒ–è®¾ç½®ã€‚insertedï¼šè¢«ç»‘å®šå…ƒç´ æ’å…¥çˆ¶èŠ‚ç‚¹æ—¶è°ƒç”¨ (ä»…ä¿è¯çˆ¶èŠ‚ç‚¹å­˜åœ¨ï¼Œä½†ä¸ä¸€å®šå·²è¢«æ’å…¥æ–‡æ¡£ä¸­)ã€‚updateï¼šæ‰€åœ¨ç»„ä»¶çš„ VNode æ›´æ–°æ—¶è°ƒç”¨ï¼Œä½†æ˜¯å¯èƒ½å‘ç”Ÿåœ¨å…¶å­ VNode æ›´æ–°ä¹‹å‰æˆ‘ä»¬ä¼šåœ¨ç¨åè®¨è®ºæ¸²æŸ“å‡½æ•°æ—¶ä»‹ç»æ›´å¤š VNodes çš„ç»†èŠ‚ã€‚componentUpdatedï¼šæŒ‡ä»¤æ‰€åœ¨ç»„ä»¶çš„ VNode åŠå…¶å­ VNode å…¨éƒ¨æ›´æ–°åè°ƒç”¨ã€‚unbindï¼šåªè°ƒç”¨ä¸€æ¬¡ï¼ŒæŒ‡ä»¤ä¸å…ƒç´ è§£ç»‘æ—¶è°ƒç”¨ã€‚ æŒ‡ä»¤é’©å­å‡½æ•°ä¼šè¢«ä¼ å…¥ä»¥ä¸‹å‚æ•°ï¼š elï¼šæŒ‡ä»¤æ‰€ç»‘å®šçš„å…ƒç´ ï¼Œå¯ä»¥ç”¨æ¥ç›´æ¥æ“ä½œ DOMã€‚ bindingï¼šä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹ propertyï¼š nameï¼šæŒ‡ä»¤åï¼Œä¸åŒ…æ‹¬ v- å‰ç¼€ã€‚ valueï¼šæŒ‡ä»¤çš„ç»‘å®šå€¼ï¼Œä¾‹å¦‚ï¼šv-my-directive=&quot;1 + 1&quot; ä¸­ï¼Œç»‘å®šå€¼ä¸º 2ã€‚ oldValueï¼šæŒ‡ä»¤ç»‘å®šçš„å‰ä¸€ä¸ªå€¼ï¼Œä»…åœ¨ update å’Œ componentUpdated é’©å­ä¸­å¯ç”¨ã€‚æ— è®ºå€¼æ˜¯å¦æ”¹å˜éƒ½å¯ç”¨ã€‚ expressionï¼šå­—ç¬¦ä¸²å½¢å¼çš„æŒ‡ä»¤è¡¨è¾¾å¼ã€‚ä¾‹å¦‚ v-my-directive=&quot;1 + 1&quot; ä¸­ï¼Œè¡¨è¾¾å¼ä¸º &quot;1 + 1&quot;ã€‚ argï¼šä¼ ç»™æŒ‡ä»¤çš„å‚æ•°ï¼Œå¯é€‰ã€‚ä¾‹å¦‚ v-my-directive:foo ä¸­ï¼Œå‚æ•°ä¸º &quot;foo&quot;ã€‚ modifiersï¼šä¸€ä¸ªåŒ…å«ä¿®é¥°ç¬¦çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼šv-my-directive.foo.bar ä¸­ï¼Œä¿®é¥°ç¬¦å¯¹è±¡ä¸º &#123; foo: true, bar: true &#125;ã€‚ vnodeï¼šVue ç¼–è¯‘ç”Ÿæˆçš„è™šæ‹ŸèŠ‚ç‚¹ã€‚ç§»æ­¥ VNode API æ¥äº†è§£æ›´å¤šè¯¦æƒ…ã€‚ oldVnodeï¼šä¸Šä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œä»…åœ¨ update å’Œ componentUpdated é’©å­ä¸­å¯ç”¨ã€‚ è¿‡æ»¤å™¨æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•å®šä¹‰ï¼Ÿå¦‚ä½•ä½¿ç”¨ï¼Ÿ æ˜¯ä»€ä¹ˆï¼š æ˜¯å¯¹æ¨¡æ¿é‡Œé¢çš„æ•°æ®è¿›è¡ŒæŸä¸€ç±»çš„æ“ä½œï¼Œå¯ä»¥ç†è§£ä¸ºæ¨¡æ¿çš„å·¥å…·å‡½æ•°ï¼ˆå¦‚ï¼šç›´æ¥åœ¨æ¨¡æ¿é‡Œé¢ä½¿ç”¨å®šä¹‰å¥½çš„è¿‡æ»¤å™¨å®ç°æ—¶é—´æˆ³å˜æ ¼å¼åŒ–çš„æ—¶é—´ï¼›ä»·æ ¼ä¿ç•™å°æ•°ä½ç­‰ç­‰å¤„ç†ï¼‰ å¦‚ä½•å®šä¹‰ï¼š // å…¨å±€æ³¨å†ŒVue.filter(&#x27;è¿‡æ»¤å™¨å&#x27;,(val,å½¢å‚)=&gt;&#123; // valè¡¨ç¤ºä¼ å…¥çš„å€¼ï¼Œ ç¬¬äºŒä¸ªå‚æ•°å¼€å§‹æ‰æ˜¯ä¼ å…¥çš„å®å‚ è¿™ä¸ªå‡½æ•°ä¸€å®šè¦æœ‰è¿”å›å€¼ // å¤„ç† return ç»“æœ&#125;)// å±€éƒ¨æ³¨å†Œ&#123; filters:&#123; è¿‡æ»¤å™¨å(val,å½¢å‚)&#123; return ç»“æœ &#125;, è¿‡æ»¤å™¨å2(val,å½¢å‚)&#123; return ç»“æœ &#125;, ... &#125;&#125; å¦‚ä½•ä½¿ç”¨ï¼š &#123;&#123; å˜é‡ | è¿‡æ»¤å™¨ &#125;&#125; // å•ä¸ªä½¿ç”¨&#123;&#123; å˜é‡ | è¿‡æ»¤å™¨1 | è¿‡æ»¤å™¨2 | ... &#125;&#125; // ä¸²è”ä½¿ç”¨ï¼Œä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨å‡½æ•°æ¥æ”¶çš„æ˜¯ä¸Šä¸€ä¸ªè¿‡æ»¤å™¨å¤„ç†çš„ç»“æœ&#123;&#123; å˜é‡ | è¿‡æ»¤å™¨(å®å‚) &#125;&#125; // è¿‡æ»¤å™¨ä¼ å‚ Vue.use æ˜¯ä»€ä¹ˆ? å¦‚ä½•ä½¿ç”¨ï¼Ÿ æ˜¯ä»€ä¹ˆï¼š vue.use æ˜¯ vue çš„æ’ä»¶å®‰è£…å‡½æ•°ã€‚è°ƒç”¨ use æˆ‘ä»¬å¯ä»¥å®‰è£…å¾ˆå¤šç¬¬ä¸‰æ–¹çš„æ’ä»¶ï¼Œå¦‚ vue-router,vuex, element-ui,vant ç­‰ç­‰ï¼Œå½“ç„¶æœ€é‡è¦çš„æ˜¯å¯ä»¥å®‰è£…æˆ‘ä»¬è‡ªå·±å¼€å‘çš„æ’ä»¶ã€‚ å¼€å‘æ’ä»¶ Vue.js çš„æ’ä»¶åº”è¯¥æš´éœ²ä¸€ä¸ª install æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ Vue æ„é€ å™¨ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯é€‰çš„é€‰é¡¹å¯¹è±¡ï¼š MyPlugin.install = function (Vue, options) &#123; // 1. æ·»åŠ å…¨å±€æ–¹æ³•æˆ– property Vue.myGlobalMethod = function () &#123; // é€»è¾‘... &#125; // 2. æ·»åŠ å…¨å±€èµ„æº Vue.directive(&#x27;my-directive&#x27;, &#123; bind (el, binding, vnode, oldVnode) &#123; // é€»è¾‘... &#125; ... &#125;) // 3. æ³¨å…¥ç»„ä»¶é€‰é¡¹ Vue.mixin(&#123; created: function () &#123; // é€»è¾‘... &#125; ... &#125;) // 4. æ·»åŠ å®ä¾‹æ–¹æ³• Vue.prototype.$myMethod = function (methodOptions) &#123; // é€»è¾‘... &#125;&#125; ä½¿ç”¨æ’ä»¶ Vue.use(MyPlugin, &#123; someOption: true &#125;); vue-loader æ˜¯ä»€ä¹ˆï¼Ÿä½¿ç”¨å®ƒçš„ç”¨é€”æœ‰å“ªäº›ï¼Ÿè§£æ.vue æ–‡ä»¶çš„ä¸€ä¸ªåŠ è½½å™¨ï¼Œè·Ÿ template/js/style è½¬æ¢æˆ js æ¨¡å—ã€‚ ç”¨é€”ï¼šjs å¯ä»¥å†™ esstyle æ ·å¼å¯ä»¥ scss æˆ– lessã€template å¯ä»¥åŠ  jade ç­‰ èŠèŠä½ å¯¹ Vue.js çš„ template ç¼–è¯‘çš„ç†è§£ï¼Ÿç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯å…ˆè½¬åŒ–æˆ AST æ ‘ï¼Œå†å¾—åˆ°çš„ render å‡½æ•°è¿”å› VNodeï¼ˆVue çš„è™šæ‹Ÿ DOM èŠ‚ç‚¹ï¼‰ è¯¦æƒ…æ­¥éª¤ï¼š é¦–å…ˆï¼Œé€šè¿‡ compile ç¼–è¯‘å™¨æŠŠ template ç¼–è¯‘æˆ AST è¯­æ³•æ ‘ï¼ˆabstract syntax tree å³ æºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æ„çš„æ ‘çŠ¶è¡¨ç°å½¢å¼ï¼‰ï¼Œcompile æ˜¯ createCompiler çš„è¿”å›å€¼ï¼ŒcreateCompiler æ˜¯ç”¨ä»¥åˆ›å»ºç¼–è¯‘å™¨çš„ã€‚å¦å¤– compile è¿˜è´Ÿè´£åˆå¹¶ optionã€‚ ç„¶åï¼ŒAST ä¼šç»è¿‡ generateï¼ˆå°† AST è¯­æ³•æ ‘è½¬åŒ–æˆ render funtion å­—ç¬¦ä¸²çš„è¿‡ç¨‹ï¼‰å¾—åˆ° render å‡½æ•°ï¼Œrender çš„è¿”å›å€¼æ˜¯ VNodeï¼ŒVNode æ˜¯ Vue çš„è™šæ‹Ÿ DOM èŠ‚ç‚¹ï¼Œé‡Œé¢æœ‰ï¼ˆæ ‡ç­¾åã€å­èŠ‚ç‚¹ã€æ–‡æœ¬ç­‰ç­‰ï¼‰ ä»€ä¹ˆæ˜¯ vue ç”Ÿå‘½å‘¨æœŸï¼ŸVue å®ä¾‹ä»åˆ›å»ºåˆ°é”€æ¯çš„è¿‡ç¨‹ï¼Œå°±æ˜¯ç”Ÿå‘½å‘¨æœŸã€‚ä¹Ÿå°±æ˜¯ä»å¼€å§‹åˆ›å»ºã€åˆå§‹åŒ–æ•°æ®ã€ç¼–è¯‘æ¨¡æ¿ã€æŒ‚è½½ Domâ†’ æ¸²æŸ“ã€æ›´æ–° â†’ æ¸²æŸ“ã€å¸è½½ç­‰ä¸€ç³»åˆ—è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°è¿™æ˜¯ Vue çš„ç”Ÿå‘½å‘¨æœŸã€‚ vue ç”Ÿå‘½å‘¨æœŸçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸­æœ‰å¤šä¸ªäº‹ä»¶é’©å­ï¼Œè®©æˆ‘ä»¬åœ¨æ§åˆ¶æ•´ä¸ª Vue å®ä¾‹çš„è¿‡ç¨‹æ—¶æ›´å®¹æ˜“å½¢æˆå¥½çš„é€»è¾‘ã€‚ vue ç”Ÿå‘½å‘¨æœŸæ€»å…±æœ‰å‡ ä¸ªé˜¶æ®µï¼Ÿå®ƒå¯ä»¥æ€»å…±åˆ†ä¸º 8 ä¸ªé˜¶æ®µï¼šåˆ›å»ºå‰/å, è½½å…¥å‰/å,æ›´æ–°å‰/å,é”€æ¯å‰/é”€æ¯å ç¬¬ä¸€æ¬¡é¡µé¢åŠ è½½ä¼šè§¦å‘å“ªå‡ ä¸ªé’©å­ï¼Ÿç¬¬ä¸€æ¬¡é¡µé¢åŠ è½½æ—¶ä¼šè§¦å‘ beforeCreate, created, beforeMount, mounted è¿™å‡ ä¸ªé’©å­ DOM æ¸²æŸ“åœ¨ å“ªä¸ªå‘¨æœŸä¸­å°±å·²ç»å®Œæˆï¼ŸDOM æ¸²æŸ“åœ¨ mounted ä¸­å°±å·²ç»å®Œæˆäº† ç®€å•æè¿°æ¯ä¸ªå‘¨æœŸå…·ä½“é€‚åˆå“ªäº›åœºæ™¯ï¼Ÿbeforecreate : å¯ä»¥åœ¨è¿™åŠ ä¸ª loading äº‹ä»¶ï¼Œå‡ºç°åŠ è½½æ¡†æ•ˆæœ åœ¨åŠ è½½å®ä¾‹æ—¶è§¦å‘ created : åˆå§‹åŒ–å®Œæˆæ—¶çš„äº‹ä»¶å†™åœ¨è¿™é‡Œï¼Œå¦‚åœ¨è¿™ç»“æŸ loading äº‹ä»¶ï¼Œå¼‚æ­¥è¯·æ±‚ä¹Ÿé€‚å®œåœ¨è¿™é‡Œè°ƒç”¨ mounted : æŒ‚è½½å…ƒç´ ï¼Œè·å–åˆ° DOM èŠ‚ç‚¹ updated : å¦‚æœå¯¹æ•°æ®ç»Ÿä¸€å¤„ç†ï¼Œåœ¨è¿™é‡Œå†™ä¸Šç›¸åº”å‡½æ•° beforeDestroy : å¯ä»¥åšä¸€ä¸ªç¡®è®¤åœæ­¢äº‹ä»¶çš„ç¡®è®¤æ¡† nextTick : æ›´æ–°æ•°æ®åç«‹å³æ“ä½œ dom vue ç»„ä»¶å¦‚ä½•é€šä¿¡ æ–¹å¼ 1ï¼šçˆ¶å­é€šä¿¡ çˆ¶ä¼ å­ ï¼šè‡ªå®šä¹‰å±æ€§ props å­ä¼ çˆ¶ ï¼šè‡ªå®šä¹‰äº‹ä»¶ $emit æ–¹å¼ 2ï¼šçˆ¶å­å…³ç³» $parent,$root ç­‰æ–¹å¼æ‰¾åˆ°çˆ¶ç»„ä»¶æˆ–æ ¹èŠ‚ç‚¹å»å¯¹åº”è°ƒç”¨å®ƒçš„æ–¹æ³•æˆ–è€…è®¾ç½®ä»–çš„å±æ€§ $children,$refs æ‰¾åˆ°æŸä¸ªå­ç»„ä»¶ç›´æ¥è°ƒç”¨ä»–çš„æ–¹æ³•æˆ–è€…è®¾ç½®ä»–çš„å±æ€§ æ–¹å¼ 3ï¼š ç¥–å…ˆåä»£ ç¥–å…ˆç»„ä»¶å®šä¹‰ provide æ‰€æœ‰çš„åä»£ç»„ä»¶å®šä¹‰ inject å°±å¯æ¥æ”¶ä¼ é€’è¿‡æ¥çš„æ•°æ® æ–¹å¼ 4ï¼š ä»»æ„ä¸¤ä¸ªç»„ä»¶ï¼ˆå…„å¼Ÿç»„ä»¶ï¼‰ é€šè¿‡äº‹ä»¶ä¸»çº¿ï¼š vue æœ¬èº«å°±æœ‰ $on å’Œ $emit æ–¹æ³•ã€‚ A ç»„ä»¶ä¸­ä½¿ç”¨$onç›‘å¬äº‹ä»¶ï¼ŒBç»„ä»¶ä¸­é€šè¿‡$emit è§¦å‘äº‹ä»¶ æ–¹å¼ 5ï¼š vuex æ–¹å¼ 6ï¼š æœ¬åœ°å­˜å‚¨ è¯´å‡º$mountã€$watchã€$deleteã€$refsã€$slotsã€$forceUpdateã€$nextTickã€$destroy è¿™äº› API æ–¹æ³•æˆ–å±æ€§çš„çš„ä½œç”¨ $mount ï¼šç”¨äºæŒ‚è½½ vue å®ä¾‹åˆ°æŸä¸ªèŠ‚ç‚¹ä¸Šé¢ï¼ŒåŠŸèƒ½ç±»ä¼¼ el é€‰é¡¹ï¼Œ æœ‰äº†å®ƒå¯ä»¥ä¸é…ç½® el; $watchï¼šç”¨äºç›‘å¬æ•°æ®çš„å˜åŒ–ï¼ŒåŠŸèƒ½ç±»ä¼¼å†…éƒ¨é…ç½®é€‰é¡¹ watch ä¸€æ ·çš„æ•ˆæœã€‚ $deleteï¼šç”¨äºåˆ é™¤ data é‡Œé¢æ•°æ®é‡Œé¢çš„å¯¹è±¡çš„å±æ€§ï¼Œå¯ä»¥å®ç°å“åº”å¼æ•ˆæœã€‚ åŠŸèƒ½å’Œ$set ä¸€è‡´ï¼Œåªä¸è¿‡ä»–æ˜¯åˆ é™¤å±æ€§ $refsï¼šç”¨äºè·å–åŸç”Ÿ DOM èŠ‚ç‚¹ï¼Œæˆ–è€…æŸä¸ªç»„ä»¶å¯¹è±¡ $slotï¼š ç”¨äºè·å–å½“å‰ç»„ä»¶ä¼ å…¥çš„æ‰€æœ‰æ’æ§½å†…å®¹ $forceUpdateï¼š ç”¨äºåˆ·æ–°å½“å‰ç»„ä»¶æˆ– vue å®ä¾‹ï¼Œå®ƒä»…ä»…å½±å“å®ä¾‹æœ¬èº«å’Œæ’å…¥æ’æ§½å†…å®¹çš„å­ç»„ä»¶ï¼Œè€Œä¸æ˜¯æ‰€æœ‰å­ç»„ä»¶ã€‚ $nextTickï¼šå°†å›è°ƒå»¶è¿Ÿåˆ°ä¸‹æ¬¡ DOM æ›´æ–°å¾ªç¯ä¹‹åæ‰§è¡Œã€‚åœ¨ä¿®æ”¹æ•°æ®ä¹‹åç«‹å³ä½¿ç”¨å®ƒï¼Œç„¶åç­‰å¾… DOM æ›´æ–°ã€‚ã€ç®€å•ç†è§£å³ä½¿ç­‰åˆ° DOM æ¸²æŸ“å®Œæˆå†åšåº”è¯¥çš„é€»è¾‘æ“ä½œã€‘ $destroy()ï¼šåªæ˜¯å®Œå…¨é”€æ¯ä¸€ä¸ªå®ä¾‹ã€‚æ¸…ç†å®ƒä¸å…¶å®ƒå®ä¾‹çš„è¿æ¥ï¼Œè§£ç»‘å®ƒçš„å…¨éƒ¨æŒ‡ä»¤åŠäº‹ä»¶ç›‘å¬å™¨ã€‚ is çš„ç”¨æ³•ï¼ˆç”¨äºåŠ¨æ€ç»„ä»¶ä¸”åŸºäº DOM å†…æ¨¡æ¿çš„é™åˆ¶æ¥å·¥ä½œã€‚ï¼‰is ç”¨æ¥åŠ¨æ€åˆ‡æ¢ç»„ä»¶ï¼ŒDOM æ¨¡æ¿è§£æ &lt;table&gt; &#123;&#x27; &#x27;&#125; &lt;tr is=&quot;my-row&quot;&gt;&lt;/tr&gt;&#123;&#x27; &#x27;&#125;&lt;/table&gt; vue çš„ä¸¤ä¸ªæ ¸å¿ƒæ˜¯ä»€ä¹ˆæ•°æ®é©±åŠ¨ã€ç»„ä»¶ç³»ç»Ÿã€‚ æ•°æ®é©±åŠ¨:Object.defineProperty å’Œå­˜å‚¨å™¨å±æ€§: getter å’Œ setterï¼ˆæ‰€ä»¥åªå…¼å®¹ IE9 åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰ï¼Œå¯ç§°ä¸ºåŸºäºä¾èµ–æ”¶é›†çš„è§‚æµ‹æœºåˆ¶,æ ¸å¿ƒæ˜¯ VMï¼Œå³ ViewModelï¼Œä¿è¯æ•°æ®å’Œè§†å›¾çš„ä¸€è‡´æ€§ã€‚ç»„ä»¶ç³»ç»Ÿ:ç‚¹æ­¤æŸ¥çœ‹ vue çš„ render å‡½æ•°å¼ä»€ä¹ˆï¼Ÿå¦‚ä½•ä½¿ç”¨Vue æ¨èåœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨æ¨¡æ¿æ¥åˆ›å»ºä½ çš„ HTMLã€‚ç„¶è€Œåœ¨ä¸€äº›åœºæ™¯ä¸­ï¼Œä½ çœŸçš„éœ€è¦ JavaScript çš„å®Œå…¨ç¼–ç¨‹çš„èƒ½åŠ›ã€‚è¿™æ—¶ä½ å¯ä»¥ç”¨æ¸²æŸ“å‡½æ•°ï¼Œå®ƒæ¯”æ¨¡æ¿æ›´æ¥è¿‘ç¼–è¯‘å™¨ã€‚ æ— è®º el ä¹Ÿå¥½ï¼Œtemplate æœ€ç»ˆéƒ½æ˜¯é€šè¿‡ render å‡½æ•°æ¸²æŸ“ï¼Œè€Œä¸”å¦‚æœåŒæ—¶å­˜åœ¨ä¸‰è€…ï¼Œrender å‡½æ•°æƒé‡æœ€å¤§ï¼ render: function (createElement) &#123; return createElement(&#x27;æ ‡ç­¾å&#x27;,&#123; å±æ€§æè¿° &#125;,å­å…ƒç´ )&#125;// createElement è¡¨ç¤ºåˆ›å»ºè™šæ‹Ÿå…ƒç´ // createElement(&#x27;æ ‡ç­¾å&#x27;,&#123; å±æ€§æè¿° &#125;,å­å…ƒç´ )å±æ€§æè¿°åŒ…æ‹¬ï¼š// ä¸ `v-bind:class` çš„ API ç›¸åŒï¼Œ // æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ã€å¯¹è±¡æˆ–å­—ç¬¦ä¸²å’Œå¯¹è±¡ç»„æˆçš„æ•°ç»„ &#x27;class&#x27;: &#123; foo: true, bar: false &#125;, // ä¸ `v-bind:style` çš„ API ç›¸åŒï¼Œ // æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ã€å¯¹è±¡ï¼Œæˆ–å¯¹è±¡ç»„æˆçš„æ•°ç»„ style: &#123; color: &#x27;red&#x27;, fontSize: &#x27;14px&#x27; &#125;, // æ™®é€šçš„ HTML attribute attrs: &#123; id: &#x27;foo&#x27; &#125;, // ç»„ä»¶ prop props: &#123; myProp: &#x27;bar&#x27; &#125;, // DOM property domProps: &#123; innerHTML: &#x27;baz&#x27; &#125;, // äº‹ä»¶ç›‘å¬å™¨åœ¨ `on` å†…ï¼Œ // ä½†ä¸å†æ”¯æŒå¦‚ `v-on:keyup.enter` è¿™æ ·çš„ä¿®é¥°å™¨ã€‚ // éœ€è¦åœ¨å¤„ç†å‡½æ•°ä¸­æ‰‹åŠ¨æ£€æŸ¥ keyCodeã€‚ on: &#123; click: this.clickHandler &#125;, // ä»…ç”¨äºç»„ä»¶ï¼Œç”¨äºç›‘å¬åŸç”Ÿäº‹ä»¶ï¼Œè€Œä¸æ˜¯ç»„ä»¶å†…éƒ¨ä½¿ç”¨ // `vm.$emit` è§¦å‘çš„äº‹ä»¶ã€‚ nativeOn: &#123; click: this.nativeClickHandler&#125; æ¡ˆä¾‹ Vue.component(&#x27;box&#x27;,&#123; template:` &lt;div class=&quot;width:200px;height:200px;background-color:red&quot;&gt; &lt;h2 class=&#x27;title&#x27; id=&#x27;tit&#x27;&gt;æˆ‘æ˜¯æ ‡é¢˜&lt;/h2&gt; &lt;p&gt; &lt;button @click=&#x27;del&#x27;&gt;å‡å°‘&lt;/button&gt; &lt;span&gt;&#123;&#123;msg&#125;&#125;&lt;/span&gt; &lt;button @click=&#x27;add(2)&#x27;&gt;å¢åŠ &lt;/button&gt; &lt;/p&gt; &lt;/div&gt; ` data()&#123; return &#123; msg:1 &#125; &#125;, methods:&#123; add(val)&#123; this.msg+=val &#125;, del()&#123; this.msg-- &#125; &#125;&#125;) é€šè¿‡ render å®ç° Vue.component(&#x27;box&#x27;, &#123; data() &#123; return &#123; msg: 1, &#125;; &#125;, methods: &#123; add(val) &#123; this.msg += val; &#125;, del() &#123; this.msg--; &#125;, &#125;, render(h) &#123; // åˆ›å»ºdivï¼Œä¸”è¿”å› return h( &#x27;div&#x27;, &#123; style: &#123; width: &#x27;200px&#x27;, height: &#x27;200px&#x27;, backgroundColor: &#x27;red&#x27;, &#125;, &#125;, [ // åˆ›å»ºh2 h( &#x27;h2&#x27;, &#123; class: &#x27;title&#x27;, attrs: &#123; id: &#x27;tit&#x27;, &#125;, &#125;, &#x27;æˆ‘æ˜¯æ ‡é¢˜&#x27; ), // åˆ›å»ºp h(&#x27;p&#x27;, &#123;&#125;, [ // åˆ›å»ºbutton h( &#x27;button&#x27;, &#123; on: &#123; click: this.del, &#125;, &#125;, &#x27;å‡å°‘&#x27; ), // åˆ›å»ºspan h(&#x27;span&#x27;, &#123;&#125;, this.msg), // åˆ›å»ºbutton h( &#x27;button&#x27;, &#123; on: &#123; click: () =&gt; &#123; this.add(2); &#125;, &#125;, &#125;, &#x27;å¢åŠ &#x27; ), ]), ] ); &#125;,&#125;); å‚è€ƒï¼šhttps://www.jianshu.com/p/7508d2a114d3 ä½¿ç”¨ key è¦ä»€ä¹ˆè¦æ³¨æ„çš„å—ï¼Ÿ ä¸è¦ä½¿ç”¨å¯¹è±¡æˆ–æ•°ç»„ä¹‹ç±»çš„éåŸºæœ¬ç±»å‹å€¼ä½œä¸º keyï¼Œè¯·ç”¨å­—ç¬¦ä¸²æˆ–æ•°å€¼ç±»å‹çš„å€¼ï¼› ä¸è¦ä½¿ç”¨æ•°ç»„çš„ index ä½œä¸º key å€¼ï¼Œå› ä¸ºåœ¨åˆ é™¤æ•°ç»„æŸä¸€é¡¹ï¼Œindex ä¹Ÿä¼šéšä¹‹å˜åŒ–ï¼Œå¯¼è‡´ key å˜åŒ–ï¼Œæ¸²æŸ“ä¼šå‡ºé”™ã€‚ ä¾‹ï¼šåœ¨æ¸²æŸ“[a,b,c]ç”¨ index ä½œä¸º keyï¼Œé‚£ä¹ˆåœ¨åˆ é™¤ç¬¬äºŒé¡¹çš„æ—¶å€™ï¼Œindex å°±ä¼šä» 0 1 2 å˜æˆ 0 1ï¼ˆè€Œä¸æ˜¯ 0 2)ï¼Œéšä¹‹ç¬¬ä¸‰é¡¹çš„ key å˜æˆ 1 äº†ï¼Œå°±ä¼šè¯¯æŠŠç¬¬ä¸‰é¡¹åˆ é™¤äº†ã€‚ ç»„ä»¶çš„ name é€‰é¡¹æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ é€’å½’ç»„ä»¶æ—¶ï¼Œç»„ä»¶è°ƒç”¨è‡ªèº«ä½¿ç”¨ï¼› ç”¨isç‰¹æ®Šç‰¹æ€§å’Œcomponentå†…ç½®ç»„ä»¶æ ‡ç­¾æ—¶ä½¿ç”¨ï¼› keep-aliveå†…ç½®ç»„ä»¶æ ‡ç­¾ä¸­include å’Œexcludeå±æ€§ä¸­ä½¿ç”¨ã€‚ ä»€ä¹ˆæ˜¯é€’å½’ç»„ä»¶ï¼Ÿä¸¾ä¸ªä¾‹å­è¯´æ˜ä¸‹ï¼Ÿé€’å½’å¼•ç”¨å¯ä»¥ç†è§£ä¸ºç»„ä»¶è°ƒç”¨è‡ªèº«ï¼Œåœ¨å¼€å‘å¤šçº§èœå•ç»„ä»¶æ—¶å°±ä¼šç”¨åˆ°ï¼Œè°ƒç”¨å‰è¦å…ˆè®¾ç½®ç»„ä»¶çš„ name é€‰é¡¹ï¼Œ æ³¨æ„ä¸€å®šè¦é…åˆ v-if ä½¿ç”¨ï¼Œé¿å…å½¢æˆæ­»å¾ªç¯ï¼Œç”¨ element-vue ç»„ä»¶åº“ä¸­ NavMenu å¯¼èˆªèœå•ç»„ä»¶å¼€å‘å¤šçº§èœå•ä¸ºä¾‹ï¼š &lt;template&gt; &lt;el-submenu :index=&quot;menu.id&quot; popper-class=&quot;layout-sider-submenu&quot; :key=&quot;menu.id&quot;&gt; &lt;template slot=&quot;title&quot;&gt; &lt;Icon :type=&quot;menu.icon&quot; v-if=&quot;menu.icon&quot; /&gt; &lt;span&gt;&#123;&#123; menu.title &#125;&#125;&lt;/span&gt; &lt;/template&gt; &lt;template v-for=&quot;(child, i) in menu.menus&quot;&gt; &lt;side-menu-item v-if=&quot;Array.isArray(child.menus) &amp;&amp; child.menus.length&quot; :menu=&quot;child&quot;&gt;&lt;/side-menu-item&gt; &lt;el-menu-item :index=&quot;child.id&quot; :key=&quot;child.id&quot; v-else&gt; &lt;Icon :type=&quot;child.icon&quot; v-if=&quot;child.icon&quot; /&gt; &lt;span&gt;&#123;&#123; child.title &#125;&#125;&lt;/span&gt; &lt;/el-menu-item&gt; &lt;/template&gt; &lt;/el-submenu&gt;&lt;/template&gt;&lt;script&gt; export default &#123; name: &#x27;sideMenuItem&#x27;, props: &#123; menu: &#123; type: Object, default() &#123; return &#123;&#125;; &#125;, &#125;, &#125;, &#125;;&lt;/script&gt; è¯´ä¸‹$attrså’Œ$listenersçš„ä½¿ç”¨åœºæ™¯ï¼Ÿ$attrs: åŒ…å«äº†çˆ¶ä½œç”¨åŸŸä¸­ï¼ˆç»„ä»¶æ ‡ç­¾ï¼‰ä¸ä½œä¸º prop è¢«è¯†åˆ« (ä¸”è·å–) çš„ç‰¹æ€§ç»‘å®š (class å’Œ style é™¤å¤–)ã€‚ åœ¨åˆ›å»ºåŸºç¡€ç»„ä»¶æ—¶å€™ç»å¸¸ä½¿ç”¨ï¼Œå¯ä»¥å’Œç»„ä»¶é€‰é¡¹inheritAttrs:falseå’Œé…åˆä½¿ç”¨åœ¨ç»„ä»¶å†…éƒ¨æ ‡ç­¾ä¸Šç”¨v-bind=&quot;$attrs&quot;å°†é prop ç‰¹æ€§ç»‘å®šä¸Šå»ï¼› $listeners: åŒ…å«äº†çˆ¶ä½œç”¨åŸŸä¸­ï¼ˆç»„ä»¶æ ‡ç­¾ï¼‰çš„ (ä¸å«.native) v-on äº‹ä»¶ç›‘å¬å™¨ã€‚ åœ¨ç»„ä»¶ä¸Šç›‘å¬ä¸€äº›ç‰¹å®šçš„äº‹ä»¶ï¼Œæ¯”å¦‚ focus äº‹ä»¶æ—¶ï¼Œå¦‚æœç»„ä»¶çš„æ ¹å…ƒç´ ä¸æ˜¯è¡¨å•å…ƒç´ çš„ï¼Œåˆ™ç›‘å¬ä¸åˆ°ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨v-on=&quot;$listeners&quot;ç»‘å®šåˆ°è¡¨å•å…ƒç´ æ ‡ç­¾ä¸Šè§£å†³ã€‚ EventBus æ³¨å†Œåœ¨å…¨å±€ä¸Šæ—¶ï¼Œè·¯ç”±åˆ‡æ¢æ—¶ä¼šé‡å¤è§¦å‘äº‹ä»¶ï¼Œå¦‚ä½•è§£å†³å‘¢ï¼Ÿåœ¨æœ‰ä½¿ç”¨$onçš„ç»„ä»¶ä¸­è¦åœ¨beforeDestroyé’©å­å‡½æ•°ä¸­ç”¨$offé”€æ¯ã€‚ Vue æ€ä¹ˆæ”¹å˜æ’å…¥æ¨¡æ¿çš„åˆ†éš”ç¬¦ï¼Ÿç”¨delimitersé€‰é¡¹,å…¶é»˜è®¤æ˜¯[&quot;&#123;&#123;\", \"&#125;&#125;&quot;] // å°†åˆ†éš”ç¬¦å˜æˆES6æ¨¡æ¿å­—ç¬¦ä¸²çš„é£æ ¼new Vue(&#123; delimiters: [&#x27;$&#123;&#x27;, &#x27;&#125;&#x27;]&#125;) Vue å˜é‡åå¦‚æœä»¥_ã€$å¼€å¤´çš„å±æ€§ä¼šå‘ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Ÿæ€ä¹ˆè®¿é—®åˆ°å®ƒä»¬çš„å€¼ï¼Ÿä»¥ _ æˆ– $ å¼€å¤´çš„å±æ€§ ä¸ä¼š è¢« Vue å®ä¾‹ä»£ç†ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½å’Œ Vue å†…ç½®çš„å±æ€§ã€API æ–¹æ³•å†²çªï¼Œä½ å¯ä»¥ä½¿ç”¨ä¾‹å¦‚ vm.$data._property çš„æ–¹å¼è®¿é—®è¿™äº›å±æ€§ã€‚ æ€ä¹ˆæ•è· Vue ç»„ä»¶çš„é”™è¯¯ä¿¡æ¯ï¼Ÿ errorCapturedæ˜¯ç»„ä»¶å†…éƒ¨é’©å­ï¼Œå½“æ•è·ä¸€ä¸ªæ¥è‡ªå­å­™ç»„ä»¶çš„é”™è¯¯æ—¶è¢«è°ƒç”¨ï¼Œæ¥æ”¶errorã€vmã€infoä¸‰ä¸ªå‚æ•°ï¼Œreturn falseåå¯ä»¥é˜»æ­¢é”™è¯¯ç»§ç»­å‘ä¸ŠæŠ›å‡ºã€‚ errorHandlerä¸ºå…¨å±€é’©å­ï¼Œä½¿ç”¨Vue.config.errorHandleré…ç½®ï¼Œæ¥æ”¶å‚æ•°ä¸errorCapturedä¸€è‡´ï¼Œ2.6 åå¯æ•æ‰v-onä¸promiseé“¾çš„é”™è¯¯ï¼Œå¯ç”¨äºç»Ÿä¸€é”™è¯¯å¤„ç†ä¸é”™è¯¯å…œåº•ã€‚ Vue é¡¹ç›®ä¸­å¦‚ä½•é…ç½® faviconï¼Ÿ é™æ€é…ç½® &lt;link rel=&quot;icon&quot; href=&quot;&lt;%= BASE_URL %&gt;favicon.ico&quot;&gt;, å…¶ä¸­&lt;%= BASE_URL %&gt;ç­‰åŒ vue.config.js ä¸­publicPathçš„é…ç½®; åŠ¨æ€é…ç½® &lt;link rel=&quot;icon&quot; type=&quot;image/png&quot; href=&quot;&quot;&gt; import browserImg from &#x27;images/kong.png&#x27;; //ä¸ºfaviconçš„é»˜è®¤å›¾ç‰‡const imgurl = &#x27;åç«¯ä¼ å›æ¥çš„favicon.icoçš„çº¿ä¸Šåœ°å€&#x27;;let link = document.querySelector(&#x27;link[type=&quot;image/png&quot;]&#x27;);if (imgurl) &#123; link.setAttribute(&#x27;href&#x27;, imgurl);&#125; else &#123; link.setAttribute(&#x27;href&#x27;, browserImg);&#125; Vue ä¸ºä»€ä¹ˆè¦æ±‚ç»„ä»¶æ¨¡æ¿åªèƒ½æœ‰ä¸€ä¸ªæ ¹å…ƒç´ ï¼Ÿå½“å‰çš„ virtualDOM å·®å¼‚å’Œ diff ç®—æ³•åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºæ¯ä¸ªå­ç»„ä»¶æ€»æ˜¯åªæœ‰ä¸€ä¸ªæ ¹å…ƒç´ ã€‚ è¯´è¯´ä½ å¯¹å•å‘æ•°æ®æµå’ŒåŒå‘æ•°æ®æµçš„ç†è§£å•å‘æ•°æ®æµæ˜¯æŒ‡æ•°æ®åªèƒ½ä»çˆ¶çº§å‘å­çº§ä¼ é€’æ•°æ®ï¼Œå­çº§ä¸èƒ½æ”¹å˜çˆ¶çº§å‘å­çº§ä¼ é€’çš„æ•°æ®ã€‚ åŒå‘æ•°æ®æµæ˜¯æŒ‡æ•°æ®ä»çˆ¶çº§å‘å­çº§ä¼ é€’æ•°æ®ï¼Œå­çº§å¯ä»¥é€šè¿‡ä¸€äº›æ‰‹æ®µæ”¹å˜çˆ¶çº§å‘å­çº§ä¼ é€’çš„æ•°æ®ã€‚ æ¯”å¦‚ç”¨v-modelã€.syncæ¥å®ç°åŒå‘æ•°æ®æµã€‚ äºŒã€vue-routervue-route å¦‚ä½•ä½¿ç”¨ï¼Ÿ// ã€å®‰è£… ã€‘npm i vue-router// ã€é…ç½®ã€‘// src/router/index.js åˆ›å»ºé…ç½®æ–‡ä»¶import Vue from &#x27;vuex&#x27;import Router from &quot;vue-router&quot;// å®‰è£…Vue.use(Router)// å®šä¹‰è·¯ç”±æ˜ å°„const routes = [ &#123; path:&quot;/åœ°å€&quot;,component:()=&gt;import(&#x27;ç»„ä»¶ä½ç½®è·¯å¾„&#x27;) &#125;]// åˆ›å»ºè·¯ç”±å®ä¾‹const router = new Router(&#123; routes,&#125;)// æš´éœ²export default router// ã€æ³¨å…¥vueå®ä¾‹ã€‘// main.jsä¸­æ“ä½œ...import router from &#x27;./router&#x27;...new Vue(&#123; ..., router, // ä¸€æ—¦æ³¨å…¥ï¼Œæ‰€æœ‰ç»„ä»¶ä¸­éƒ½æœ‰$routerå’Œ$route; $routerè¡¨ç¤ºè·¯ç”±å¯¹è±¡å®ä¾‹ï¼› $routeè¡¨ç¤ºå½“å‰é¡µé¢è·¯ç”±ä¿¡æ¯ ...&#125;)// ã€å®šä¹‰è·¯ç”±å‡ºå£ã€‘// App.vueä¸­æ“ä½œ&lt;router-view&gt;&lt;/router-view&gt;// ã€ä½¿ç”¨router-linkè·³è½¬ã€‘&lt;router-link to=&quot;/åœ°å€&quot;&gt;&lt;/router-link&gt; ä½•ä¸ºå‘½åè·¯ç”±ï¼Ÿ å…¶å®å°±æ˜¯ç»™è·¯ç”±å–ä¸€ä¸ªåå­—,å¢åŠ ä¸€ä¸ª name å±æ€§ã€‚ // æ˜ å°„å…³ç³»const routes = [&#123; name: &#x27;åç§°&#x27;, path: &#x27;/åœ°å€&#x27;, component: ç»„ä»¶ &#125;]; å®šä¹‰äº†å‘½åè·¯ç”±ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è·¯ç”±åç§°å®ç°è·³è½¬ // åŸæ¥å†™æ³•&lt;router-link to=&quot;/åœ°å€&quot;&gt;&lt;/router-link&gt;// æ–°å†™æ³•&lt;router-link :to=&quot;&#123;name:&#x27;åç§°&#x27;&#125;&quot;&gt;&lt;/router-link&gt;// ç¼–ç¨‹å¼å¯¼èˆª router.push(&#x27;/åœ°å€&#x27;) router.push(&#123;name:&#x27;åç§°&#x27;&#125;) å¦‚ä½•å®šä¹‰åŠ¨æ€è·¯ç”±ï¼Œè·å–åŠ¨æ€å‚æ•°// æ˜ å°„å…³ç³»const routes = [&#123; name: &#x27;åç§°&#x27;, path: &#x27;/åœ°å€/:æ ‡è¯†ç¬¦&#x27;, component: ç»„ä»¶ &#125;]; &lt;router-link to=&quot;/åœ°å€/æ•°æ®&quot;&gt;&lt;/router-link&gt;&lt;router-link :to=&quot;&#123; name: &#x27;åç§°&#x27;, params: &#123; æ ‡è¯†ç¬¦: æ•°æ® &#125; &#125;&quot;&gt;&lt;/router-link&gt;// ç¼–ç¨‹å¼å¯¼èˆª router.push(&#x27;/åœ°å€/æ•°æ®&#x27;) router.push(&#123;name:&#x27;åç§°&#x27;,params:&#123;æ ‡è¯†ç¬¦:æ•°æ®&#125;&#125;) è·å–åŠ¨æ€å‚æ•° this.$route.params.æ ‡è¯†ç¬¦ å¾—åˆ° æ•°æ® ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬æœ‰æ›´åŠ é«˜çº§çš„ç”¨æ³•ï¼Œä½¿ç”¨ props å°†ç»„ä»¶è§£è€¦ // æ˜ å°„å…³ç³»const routes = [ &#123; name: &#x27;åç§°&#x27;, path: &#x27;/åœ°å€/:æ ‡è¯†ç¬¦&#x27;, component: ç»„ä»¶, props: true &#125;, // // å¼€å¯propsä¼ å‚ï¼Œè¯´ç™½äº†å°†è·¯ç”±å‚æ•°ä¼ é€’åˆ°ç»„ä»¶çš„propsä¸­]; // ç»„ä»¶ä¸­ï¼Œä¸‹é¢æ˜¯ç»„ä»¶çš„é…ç½®é€‰å‹ export default &#123; ..., props:[&#x27;æ ‡è¯†ç¬¦&#x27;] //propså®šä¹‰å’ŒåŠ¨æ€è·¯ç”±åé¢æ ‡è¯†ç¬¦ä¸€è‡´çš„å®šä¹‰å±æ€§ã€‚ ... &#125; // ç»„ä»¶ä¸­å¯ä»¥ç›´æ¥é€šè¿‡this.æ ‡è¯†ç¬¦ ç›´æ¥è·å¾—è·¯ç”±å‚æ•°æ•°æ®ã€‚ å¦‚æ¡ˆä¾‹ï¼š // è·¯ç”±é…ç½®const router = new VueRouter(&#123; routes: [ &#123; path: &#x27;/user/:id&#x27;, component: User, props: true, &#125;, ],&#125;); // Aé¡µé¢this.$router.push(&#x27;/user/123&#x27;)æˆ–è€…&lt;router-link to=&#x27;/user&#x27;&gt;å»useré¡µé¢&lt;/router-link&gt; // Useré¡µé¢const User = &#123; props: [&#x27;id&#x27;], // this.id å°±æ˜¯åŠ¨æ€è·¯ç”±æ•°æ®å€¼ä¸º 123 template: &#x27;&lt;div&gt;User &#123;&#123; id &#125;&#125;&lt;/div&gt;&#x27;, // è¿™é‡Œå°±æ˜¯ä¼šæ¸²æŸ“123&#125;; æœ‰å“ªäº›ç¼–ç¨‹å¼å¯¼èˆªæ–¹æ³• ç¼–ç¨‹å¼å¯¼èˆªæ–¹æ³•éƒ½å­˜åœ¨ è·¯ç”±å®ä¾‹é‡Œé¢ã€‚ ç»„ä»¶ä¸­å¯ä»¥ä½¿ç”¨this.$routerè®¿é—®ï¼Œå…¶ä»– JS æ–‡ä»¶ä¸­å¯ä»¥é€šè¿‡å¯¼å…¥è·¯ç”±å®ä¾‹è°ƒç”¨ this.$router.push(&#39;/åœ°å€&#39;) è·³è½¬åˆ°æŸä¸ªæ–°åœ°å€ï¼Œå†å²è®°å½•æ ˆä¸­å¢åŠ ä¸€ä¸ª this.$router.replace(&#39;/åœ°å€&#39;) è·³è½¬åˆ°æŸä¸ªåœ°å€ï¼Œæ–°åœ°å€æ›¿æ¢å½“å‰åœ°å€åœ¨å†å²è®°å½•ä¸­çš„ä½ç½® this.$router.go(æ•°å­—) æ­£æ•°å‰è¿›å‡ æ­¥ï¼›è´Ÿæ•°åé€€å‡ æ­¥ï¼›0 è¡¨ç¤ºåˆ·æ–° this.$router.back() åé€€ this.$router.forward() å‰è¿› ä½•ä¸ºå‘½åè§†å›¾ï¼Ÿå¦‚ä½•ä½¿ç”¨ æ‰€è°“çš„å‘½åè§†å›¾çš„æ„æ€æ˜¯é»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬ä¸€ä¸ªè·¯ç”±åœ°å€æ¸²æŸ“ä¸€ä¸ªç»„ä»¶åˆ°ä¸€ä¸ª router-view é‡Œé¢å»ï¼›è€Œå‘½åè§†å›¾çš„ç›®çš„æ˜¯ å¯ä»¥å®ç°ä¸€ä¸ªè·¯ç”±åœ°å€ï¼Œæ¸²æŸ“å¤šä¸ªç»„ä»¶åˆ°ä¸åŒçš„ router-view é‡Œå»è¿›è¡Œå±•ç¤º ä½¿ç”¨ï¼š // æ˜ å°„å…³ç³»const routes = [ &#123; name:&#x27;åç§°&#x27; , path:&#x27;/åœ°å€&#x27;, //component:ç»„ä»¶ //åªèƒ½æ¸²æŸ“ä¸€ä¸ªç»„ä»¶ components:&#123; default:ç»„ä»¶X è§†å›¾åA:ç»„ä»¶A, è§†å›¾åB:ç»„ä»¶B &#125; &#125;] &lt;router-view&gt;&lt;/router-view&gt;&lt;!--é»˜è®¤è§†å›¾ï¼Œæ¸²æŸ“ç»„ä»¶X--&gt;ä¸Šé¢è¿™å¥å…¶å®æ˜¯ï¼š&lt;router-view name=&quot;default&quot;&gt;&lt;/router-view&gt;&lt;router-view name=&quot;è§†å›¾åA&quot;&gt;&lt;/router-view&gt;&lt;!--æ¸²æŸ“ç»„ä»¶A--&gt;&lt;router-view name=&quot;è§†å›¾åB&quot;&gt;&lt;/router-view&gt;&lt;!--æ¸²æŸ“ç»„ä»¶B--&gt; ä½•ä¸ºåµŒå¥—è·¯ç”±ï¼Ÿ å¦‚ä½•ä½¿ç”¨ï¼Ÿä½•æ—¶ä½¿ç”¨ï¼Ÿ å®šä¹‰ï¼šæ‰€è°“çš„åµŒå¥—è·¯ç”±ï¼ŒæŒ‡çš„çš„æ˜¯åœ¨ä¸€ä¸ªè·¯ç”±ç»„ä»¶é‡Œé¢è¿˜æœ‰ä¼šæœ‰ router-view å±•ç¤ºä¸‹ä¸€çº§çš„è·¯ç”±ç»„ä»¶ä¿¡æ¯ã€‚ ä½•æ—¶ä½¿ç”¨ï¼šæˆ‘ä»¬å¼€å‘ä¸€äº›ç‰¹å®šåŠŸèƒ½æ¨¡å—çš„æ—¶å€™ï¼ŒåŒ…å«æœ‰å­æ¨¡å—é¡µé¢ï¼Œå°±å¯ä»¥é‡‡ç”¨åµŒå¥—è·¯ç”±ã€‚ å¦‚ï¼šç”¨æˆ·ä¸­å¿ƒæ˜¯ä¸€ä¸ªå¤§æ¨¡å—é¡µé¢ï¼Œç”¨æˆ·è®¢å•ã€ç”¨æˆ·èµ„æ–™ã€æ”¶è´§åœ°å€ç­‰ç­‰éƒ½ä¼šæœ‰ä¾§è¾¹æ ä¿¡æ¯ï¼Œè¯¸å¦‚æ­¤ç±»æœ‰å…±åŒæ¨¡å—å¸ƒå±€ï¼Œä¸”å†…å®¹ä¸åŒçš„ï¼Œåˆ™å¯ä»¥ä½¿ç”¨åµŒå¥—è·¯ç”±ã€‚ å¦‚ä½•ä½¿ç”¨ï¼š // æ˜ å°„å…³ç³»const routes = [ &#123; name:&#x27;åç§°&#x27; , path:&#x27;/åœ°å€&#x27;, component:ç»„ä»¶ children:[ // å­çº§è·¯ç”±ä¼šæ¸²æŸ“ä¸Šçº§è·¯ç”±çš„ç»„ä»¶é‡Œé¢çš„router-viewé‡Œé¢è¿›è¡Œå±•ç¤º &#123; name:&#x27;åç§°1&#x27;, path:&quot;/åœ°å€/å­åœ°å€1&quot;, component: ()=&gt;import(ç»„ä»¶åœ°å€) &#125;, &#123; name:&#x27;åç§°2&#x27;, path:&quot;/åœ°å€/å­åœ°å€2&quot;, component: ()=&gt;import(ç»„ä»¶åœ°å€) &#125;, // å­çº§çš„åœ°å€ä¹Ÿå¯ä»¥ä¸åŠ  /åœ°å€ï¼Œ è¿™æ ·ä¼šè‡ªåŠ¨æ‹¼æ¥ ä¸Šä¸€çº§çš„å‰ç¼€ã€‚ æ³¨æ„ä¸èƒ½åŠ  / &#123; name:&#x27;åç§°3&#x27;, path:&quot;å­åœ°å€3&quot;, component: ()=&gt;import(ç»„ä»¶åœ°å€) &#125; // ä¸Šè¿° pathå°±å•ç‹¬å†™ä¸€ä¸ª å­åœ°å€3 å°±è¡¨ç¤º /åœ°å€/å­åœ°å€3 ] &#125;] æ€ä¹ˆé€šè¿‡è·¯ç”±å®ç°é¢åŒ…å±‘ è®¤è¯†é¢åŒ…å±‘ å‰åç«¯åˆ†ç¦»å®ç°é¢åŒ…å±‘æœ‰ 2 ä¸­æ–¹å¼ï¼š æ–¹å¼ 1ï¼š æ¯ä¸ªé¡µé¢ç›´æ¥å†™æ­» æ–¹å¼ 2ï¼š é€šè¿‡$route.matched å±æ€§ å»éå† ç”Ÿæˆã€‚ æ–¹å¼ 2 å®ç°æ€è·¯ï¼š è¦æœ‰é¢åŒ…å±‘ä¸€èˆ¬è‚¯å®šè¦æ˜¯ä¸€ä¸ªåµŒå¥—è·¯ç”±ï¼Œå¦åˆ™ä¸€èˆ¬å°±åªèƒ½å±•ç¤º 2 çº§ã€‚ æ¯ä¸ªè·¯ç”±éƒ½è¦æœ‰ meta å…ƒä¿¡æ¯ï¼Œ ç„¶åé‡Œé¢è®¾ç½®ä¸€ä¸ª tilteï¼Œè®¾ç½®ä¸ºæ ‡é¢˜ã€‚ æˆ‘ä»¬çš„$route è¡¨ç¤ºå½“å‰é¡µé¢è·¯ç”±ä¿¡æ¯ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªåµŒå¥—è·¯ç”±ï¼Œé‚£ä¹ˆ$route.matched å±æ€§æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢çš„å†…å®¹å°±æ˜¯ä¸€ä¸ªä¸Šä¸Šçº§åˆ°ä¸‹ä¸€çº§çš„è·¯ç”±ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡éå†æ•°ç»„ï¼Œå–å‡ºæ¯ä¸ªé‡Œé¢çš„ path åœ°å€å’Œ meta é‡Œé¢çš„ title æ¥è¿›è¡Œè®¾ç½®å³å¯ã€‚ é¡µé¢ä¹‹é—´å¦‚ä½•ä¼ å‚ æœ¬åœ°å­˜å‚¨ï¼Œä¸€ä¸ªé¡µé¢è®¾ç½®ï¼Œä¸€ä¸ªé¡µé¢è¯»å– åŠ¨æ€è·¯ç”± /åœ°å€/æ•°æ® ã€A é¡µé¢ã€‘ this.$route.params.æ ‡è¯†ç¬¦ è·å–æ•°æ® ã€B é¡µé¢ã€‘ query ä¼ å‚ /åœ°å€?å±æ€§å=å€¼ ã€A é¡µé¢ã€‘ this.$route.query.å±æ€§å ã€B é¡µé¢ã€‘ hash ä¼ å‚ /åœ°å€#å±æ€§å=å€¼ ã€A é¡µé¢ã€‘ this.$route.hash ç„¶åå†å¤„ç†å¾—åˆ°ä¿¡æ¯ ã€B é¡µé¢ã€‘ vue å­˜å‚¨å’Œè¯»å– vue-router æœ‰å“ªå‡ ç§å¯¼èˆªé’©å­ï¼Ÿä¸‰ç§ ç¬¬ä¸€ç§æ˜¯å…¨å±€å¯¼èˆªé’©å­ï¼š router.beforeEach( (to,from,next)=&gt;&#123; ... &#125; ) router.afterEach((to, from) =&gt; &#123; ... &#125;) ç¬¬äºŒç§ï¼šç»„ä»¶å†…çš„é’©å­ beforeRouteEnter(to, from, next) &#123; ... &#125; beforeRouteUpdate (to, from, next) &#123;...&#125; beforeRouteLeave (to, from, next) &#123;...&#125; ç¬¬ä¸‰ç§ï¼šå•ç‹¬è·¯ç”±ç‹¬äº«ç»„ä»¶ const router = new VueRouter(&#123; routes: [ &#123; path: &#x27;/foo&#x27;, component: Foo, beforeEnter: (to, from, next) =&gt; &#123; // é…ç½®åœ¨è·¯ç”±æ˜ å°„é‡Œé¢ // ... &#125;, &#125;, ],&#125;); $routeå’Œ$router çš„åŒºåˆ« $route æ˜¯â€œè·¯ç”±ä¿¡æ¯å¯¹è±¡â€ path è·¯å¾„åœ°å€ params åŠ¨æ€è·¯ç”±æ•°æ® hash hash æ•°æ® query search æ•°æ® fullPath å®Œæ•´åœ°å€ matched è·¯ç”±åŒ¹é… ï¼ˆå¯ç”¨äºåˆ¶ä½œé¢åŒ…å±‘ï¼‰ name è·¯ç”±åç§° $router æ˜¯â€œè·¯ç”±å®ä¾‹â€å¯¹è±¡åŒ…æ‹¬äº†è·¯ç”±çš„è·³è½¬æ–¹æ³•ï¼Œé’©å­å‡½æ•°ç­‰ push/replace/go/back/forward beforeEach/afterEach/â€¦ addRoutes æ–¹æ³•ï¼Œå¢åŠ æ˜ å°„ è·¯ç”±å…ƒä¿¡æ¯æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä½•ä½œç”¨ï¼Ÿ è®¾ç½®æ¯ä¸ªè·¯ç”±æ˜ å¯¹è±¡çš„æ—¶å€™ï¼Œå¯ä»¥å¢åŠ ä¸€ä¸ª meta å±æ€§ï¼Œé‡Œé¢å¯ä»¥è‡ªå®šä¹‰ç›¸å…³æ•°æ® // è·¯ç”±æ˜ å°„&#123; path:&#x27;/åœ°å€&#x27;, component: ()=&gt;import(ç»„ä»¶åœ°å€), meta:&#123; å±æ€§å:&quot;å±æ€§å€¼&quot;, .... &#125;&#125; ç»„ä»¶ä¸­è¯»å–ï¼š this.$route.meta.å±æ€§å ä½œç”¨ï¼š å¯ä»¥é€šè¿‡è¿™ä¸ªè®¾ç½®æ ‡é¢˜ï¼Œåœ¨æ‹¦æˆªå™¨é‡Œé¢è¿›è¡Œè®¾ç½®ï¼› meta é‡Œé¢æ”¾å…¥æƒé™éªŒè¯å­—æ®µï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æƒé™è®¿é—®é¡µé¢ â€¦ å¦‚ä½•å®ç°é¡µé¢çš„è¿‡æ¸¡æ•ˆæœ&lt;transition&gt; &lt;router-view&gt;&lt;/router-view&gt;&lt;/transition&gt; å¦‚ä½•å®ç°è·¯ç”±é‡å®šå‘// è·¯ç”±æ˜ å°„&#123; path:&#x27;/åœ°å€A&#x27;, component: ()=&gt;import(ç»„ä»¶åœ°å€), redirect:&#x27;/åœ°å€B&#x27; // è®¿é—®åœ°å€Açš„æ—¶å€™å°†ä¼šè·³è½¬åˆ°åœ°å€B&#125; è·¯ç”±æ‡’åŠ è½½æ˜¯ä»€ä¹ˆï¼Ÿ å¦‚ä½•å®ç°ï¼Ÿä¸ºä»€ä¹ˆè¦æ‡’åŠ è½½ï¼Ÿ ä¸ºä»€ä¹ˆï¼š å½“æ‰“åŒ…æ„å»ºåº”ç”¨æ—¶ï¼ŒJavaScript åŒ…ä¼šå˜å¾—éå¸¸å¤§ï¼Œå½±å“é¡µé¢åŠ è½½ã€‚å¦‚æœæˆ‘ä»¬èƒ½æŠŠä¸åŒè·¯ç”±å¯¹åº”çš„ç»„ä»¶åˆ†å‰²æˆä¸åŒçš„ä»£ç å—ï¼Œç„¶åå½“è·¯ç”±è¢«è®¿é—®çš„æ—¶å€™æ‰åŠ è½½å¯¹åº”ç»„ä»¶ï¼Œè¿™æ ·å°±æ›´åŠ é«˜æ•ˆäº†ã€‚ æ˜¯ä»€ä¹ˆï¼šè·¯ç”±è¢«è®¿é—®çš„æ—¶å€™æ‰åŠ è½½å¯¹åº”ç»„ä»¶ å¦‚ä½•å®ç°ï¼š // è·¯ç”±æ˜ å°„&#123; path:&#x27;/åœ°å€A&#x27;, component: ()=&gt;import(ç»„ä»¶åœ°å€) // æ‡’åŠ è½½&#125; å¯¼èˆªé’©å­æœ‰ä½•ä½œç”¨ï¼Ÿ å¯¼èˆªé’©å­ç±»ä¼¼ä¸­é—´ä»¶çš„å‘³é“ï¼Œå¯¹å¯¼èˆªçš„å‘ç”Ÿè¿‡ç¨‹è¿›è¡Œæ‹¦æˆªï¼Œæ»¡è¶³æ¡ä»¶æ‰å¯ä»¥ç»§ç»­å‘ä¸‹èµ°ï¼Œå¦åˆ™è·¯ç”±å°±ä¼šè¢«æŒ‚èµ·æ¥ã€‚ æ‰€ä»¥æˆ‘ä»¬å¾ˆå¤šæ—¶å€™éœ€è¦æ³¨æ„æ˜¯å¦éœ€è¦åœ¨å¯¼èˆªå®ˆå«é‡Œé¢è°ƒç”¨ next å…¨å±€å‰ç½®å®ˆå«ï¼šï¼ˆrouter.beforeEach((to, from, next) =&gt; &#123; ... &#125;ï¼‰ æƒé™åˆ¤æ–­ã€æ ‡é¢˜è®¾ç½®ã€è¿›åº¦æ¡å¼€å§‹ ç­‰ï¼Œéœ€è¦æ‰€æœ‰è·¯ç”±éƒ½åšçš„äº‹æƒ… å…¨å±€å®ˆåç½®å®ˆå«ï¼šï¼ˆrouter.afterEach((to, from) =&gt; &#123;...&#125;ï¼‰ è¿›åº¦æ¡ç»“æŸç­‰ è·¯ç”±ç‹¬äº«å®ˆå«ï¼šï¼ˆ beforeEnter: (to, from, next) =&gt; &#123; ... &#125;ï¼‰ æƒé™åˆ¤æ–­ã€é’ˆå¯¹æŸä¸€ä¸ªè·¯ç”±è¦åšçš„äº‹æƒ…éƒ½æ”¾åœ¨è¿™é‡Œã€‚ å±€éƒ¨å‰ç½®å®ˆå«: ï¼ˆbeforeRouteEnter (to, from, next) &#123; ... &#125;ï¼‰ è¿›å…¥é¡µé¢ä¹‹å‰è¦åšçš„äº‹æƒ…ï¼Œæ³¨æ„è¿™é‡Œä¸èƒ½ä½¿ç”¨ thisï¼Œå› ä¸ºç»„ä»¶è¿˜æ²¡æœ‰åˆå§‹åŒ– å±€éƒ¨æ›´æ–°å®ˆå«ï¼š ï¼ˆbeforeRouteUpdate (to, from, next) &#123; ... &#125;ï¼‰ åŒè·¯ç”±è·³è½¬åŒè·¯ç”±çš„æ›´æ–°ç›‘æµ‹ï¼Œå¦‚è¯¦æƒ…é¡µè·³è½¬åˆ°è¯¦æƒ…é¡µï¼Œå¯ä»¥æ”¾åœ¨è¿™é‡Œç›‘å¬ å±€éƒ¨åç½®å®ˆå«ï¼š ï¼ˆbeforeRouteLeave (to, from, next) &#123; ... &#125;ï¼‰ æŸä¸ªé¡µé¢è¦æ¶ˆå¤±çš„æ—¶å€™åšçš„äº‹æƒ…ï¼Œå¦‚åˆ¤æ–­æ˜¯å¦è¦ç¦»å¼€ï¼Œæ˜¯å¦ä¿å­˜äº†æ•°æ®ç­‰ã€‚ å¦‚ä½•å®ç°æ¿€æ´»å¯¼èˆª é»˜è®¤å¦‚æœrouter-linkç»„ä»¶çš„åœ°å€å’Œå½“å‰è·¯ç”±åœ°å€ä¸€è‡´ï¼Œä¼šåŠ ä¸Šrouter-link-activeçš„ class åï¼ˆè¿™æ˜¯æ¨¡ç³ŠåŒ¹é…ï¼‰æˆ–è€… router-link-exact-activeçš„ class åï¼ˆè¿™æ˜¯ä¸¥æ ¼åŒ¹é…ï¼‰ ä¿®æ”¹æ¿€æ´» class åï¼š // è·¯ç”±ä¸­é…ç½®new VueRouter(&#123; linkActiveClass:&#x27;classå&#x27;, // éä¸¥æ ¼æ¨¡å¼ä¸‹çš„æ¿€æ´»classå linkExactActiveClass:&#x27;classå&#x27;, // ä¸¥æ ¼æ¨¡å¼çš„æ¿€æ´»çš„æ—¶å€™classå routes:[...] // æ˜ å°„&#125;) æœ‰å“ªäº›è·¯ç”±æ¨¡å¼ï¼Ÿ å®ç°çš„å…·ä½“åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ è·¯ç”±æ¨¡å¼ 2 ä¸­ï¼š history æ¨¡å¼ åŸç†ï¼š html5 çš„ history é‡Œé¢çš„ apiï¼Œ å¦‚ pushState,replaceState è¿™ 2 ä¸ªå‡½æ•°å¯ä»¥æ›¿æ¢ç½‘é¡µä¸­çš„ urlï¼Œä½†æ˜¯é¡µé¢ä¸ä¼šé‡æ–°åŠ è½½ hash æ¨¡å¼ åŸç†ï¼š ç›‘å¬ window çš„ hashchange äº‹ä»¶ï¼Œå±•ç¤ºä¸åŒç»„ä»¶ ç›‘å¬ popstateï¼ŒpushStateå’ŒreplaceStateä¸ä¼šè§¦å‘popStateäº‹ä»¶ï¼Œåªæœ‰æµè§ˆå™¨çš„è¿”å›æŒ‰é’®ï¼Œgoã€backå‡½æ•°ä¼šè§¦å‘ history æ¨¡å¼è·¯ç”±è¦æ³¨æ„ä»€ä¹ˆï¼Ÿ å¦‚æœä¸æƒ³è¦å¾ˆä¸‘çš„ hashï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è·¯ç”±çš„ history æ¨¡å¼ï¼Œè¿™ç§æ¨¡å¼å……åˆ†åˆ©ç”¨ history.pushState API æ¥å®Œæˆ URL è·³è½¬è€Œæ— é¡»é‡æ–°åŠ è½½é¡µé¢ã€‚ æ³¨æ„ç‚¹ï¼šä¸è¿‡è¿™ç§æ¨¡å¼è¦ç©å¥½ï¼Œè¿˜éœ€è¦åå°é…ç½®æ”¯æŒã€‚å› ä¸ºæˆ‘ä»¬çš„åº”ç”¨æ˜¯ä¸ªå•é¡µå®¢æˆ·ç«¯åº”ç”¨ï¼Œå¦‚æœåå°æ²¡æœ‰æ­£ç¡®çš„é…ç½®ï¼Œå½“ç”¨æˆ·åœ¨æµè§ˆå™¨ç›´æ¥è®¿é—® http://oursite.com/user/id å°±ä¼šè¿”å› 404ï¼Œè¿™å°±ä¸å¥½çœ‹äº†ã€‚ æ‰€ä»¥å‘¢ï¼Œä½ è¦åœ¨æœåŠ¡ç«¯å¢åŠ ä¸€ä¸ªè¦†ç›–æ‰€æœ‰æƒ…å†µçš„å€™é€‰èµ„æºï¼šå¦‚æœ URL åŒ¹é…ä¸åˆ°ä»»ä½•é™æ€èµ„æºï¼Œåˆ™åº”è¯¥è¿”å›åŒä¸€ä¸ª index.html é¡µé¢ï¼Œè¿™ä¸ªé¡µé¢å°±æ˜¯ä½  app ä¾èµ–çš„é¡µé¢ ç®€è€Œè¨€ä¹‹ï¼š history æ¨¡å¼éœ€è¦åå°é…ç½®ï¼Œå¦åˆ™ä¼šå’ŒçœŸæ­£çš„æœåŠ¡å™¨ç«¯è·¯ç”±åœ°å€å†²çªã€‚ addRoutes æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä½•ä½œç”¨ï¼Ÿ æ˜¯ä»€ä¹ˆï¼šåŠ¨æ€æ·»åŠ æ›´å¤šçš„è·¯ç”±è§„åˆ™ã€‚å‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªç¬¦åˆ routes é€‰é¡¹è¦æ±‚çš„æ•°ç»„ã€‚ ä½œç”¨ï¼š å¯ä»¥å®ç°æ ¹æ®éœ€æ±‚åŠ¨æ€åŠ è½½è·¯ç”±é…ç½®æ˜ å°„å…³ç³»æ•°æ®ä¿¡æ¯ï¼Œæˆ‘ä»¬ä¸€èˆ¬åœ¨ç®¡ç†ç³»ç»Ÿä¸­ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥å®ç° æŒ‰éœ€åŠ è½½è·¯ç”±æ˜ å°„ï¼Œä»è€Œå®ç°ä¸åŒçš„è§’è‰²çœ‹åˆ°ä¸åŒçš„èœå•ã€‚ base é…ç½®é¡¹çš„ä½œç”¨ é…ç½®è·¯ç”±åœ°å€çš„åŸºå‡†å‰ç¼€åœ°å€ï¼Œå¢åŠ è¿™ä¸ªé€‰é¡¹ä¹‹åæ‰€æœ‰çš„è·¯ç”±åœ°å€ä¼šå…¨éƒ¨è‡ªåŠ¨å¢åŠ ä¸Šè¿™ä¸ªå‰ç¼€ï¼Œä½†æ˜¯æˆ‘ä»¬å†™router-link çš„æ—¶å€™ä¸éœ€è¦åŠ è¿™ä¸ªå‰ç¼€ã€‚ ä½¿ç”¨ï¼š // è·¯ç”±ä¸­é…ç½®new VueRouter(&#123; base:&quot;/å‰ç¼€åœ°å€&quot; routes:[...] // æ˜ å°„&#125;) å¦‚ä½•å¤„ç†æ»šåŠ¨è¡Œä¸º history æ¨¡å¼ä¸‹ new VueRouter(&#123; ..., // savedPosition è¿™ä¸ªå‚æ•°å½“ä¸”ä»…å½“å¯¼èˆª (é€šè¿‡æµè§ˆå™¨çš„ å‰è¿›/åé€€ æŒ‰é’®è§¦å‘) æ—¶æ‰å¯ç”¨ æ•ˆæœå’Œ router.go() æˆ– router.back() scrollBehavior (to, from, savedPosition) &#123; // è¿”å›savedPosition å…¶å®å°±æ˜¯ å½“ç”¨æˆ·ç‚¹å‡» è¿”å›çš„è¯ï¼Œä¿æŒä¹‹å‰æ¸¸è§ˆçš„é«˜åº¦ if (savedPosition) &#123; return savedPosition &#125; else &#123; return &#123; x: 0, y: 0 &#125; &#125; &#125;, ...&#125;) æ³¨æ„ï¼šscrollBehavior å±æ€§ä»…åœ¨ history æ¨¡å¼ä¸‹æ‰å¯ä»¥ä½¿ç”¨ã€‚ hash æ¨¡å¼ä¸‹ router.beforeEach((to, from, next) =&gt; &#123; // ç›´æ¥ä½¿ç”¨windowçš„scrollæ–¹æ³•æ»šåŠ¨å›é¡¶éƒ¨ window.scrollTo(0, 0); next();&#125;); è·¯ç”±é‡Œé¢æœ‰å“ªäº›å¸¸ç”¨ç»„ä»¶ router-link router-view è·¯ç”±é‡Œé¢è¯¦æƒ…é¡µè·³è½¬è¯¦æƒ…é¡µï¼Œç»„ä»¶ä¸é‡æ–°åˆ›å»ºå¦‚ä½•å¤„ç†ï¼Ÿ æˆ‘ä»¬çš„vue-routeråŒè·¯ç”±è·³è½¬åˆ°åŒè·¯ç”±ï¼Œç»„ä»¶æ˜¯ä¸ä¼šæ›´æ–°çš„ã€‚ å¦‚ï¼šæ–‡ç« è¯¦æƒ…è·¯ç”±/article/11 é¡µé¢é‡Œé¢æœ‰ä¸ªé“¾æ¥è·³è½¬åˆ°/article/22 è¿™ç¯‡æ–‡ç« ï¼Œå…¶å®å°±æ˜¯åŒè·¯ç”±ç»„ä»¶è·³è½¬ã€‚è¿™ä¸ªæ—¶å€™æ–‡ç« è¯¦æƒ…ç»„ä»¶æ˜¯ä¸ä¼šå†æ¬¡è¢«åˆ›å»ºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æŠŠè·å–æ•°æ®è¯·æ±‚çš„æ–¹æ³•å†™åœ¨ createdæˆ–è€… mountedé‡Œé¢æˆ–è€…åœ¨é‡Œé¢å»è°ƒç”¨ï¼Œå› ä¸ºç»„ä»¶ä¸ä¼šè¢«å†æ¬¡åˆ›å»ºï¼Œå¦‚æœå†™åœ¨ç”Ÿå‘½å‘¨æœŸé‡Œé¢å»è°ƒç”¨ï¼Œä»è€Œå¯¼è‡´è·³è½¬åˆ°/article/22çš„æ—¶å€™æ— æ³•è¯·æ±‚æ•°æ®ï¼Œ å¦‚ä½•è§£å†³ï¼š æ–¹å¼ 1ï¼šä½¿ç”¨ beforeRouteUpdateï¼Œå› ä¸º/article/11è·³è½¬åˆ°/article/22 è¿™ä¸ªè·³è½¬å±äºåŒè·¯ç”±ç»„ä»¶æ›´æ–°ï¼ŒbeforeRouteUpdateä¼šè¢«è§¦å‘ æ–¹å¼ 2ï¼š ä½¿ç”¨watchå»ç›‘å¬$routeçš„å˜åŒ–ï¼Œåœ¨ç›‘å¬çš„å‡½æ•°é‡Œé¢å»å‘é€è¯·æ±‚ã€‚ å¦‚ä½•å®ç°é¡µé¢åŠ è½½è¿›åº¦æ¡æ ¸å¿ƒä½¿ç”¨ï¼šnprogressæ’ä»¶ ç¬¬ä¸€æ­¥ï¼Œ å®‰è£… npm install --save nprogress ç¬¬äºŒæ­¥ï¼Œ main.js ä¸­å¼•å…¥æ’ä»¶ import NProgress from &#x27;nprogress&#x27;;import &#x27;nprogress/nprogress.css&#x27;; ç¬¬ä¸‰æ­¥ï¼Œåœ¨ main.js æ–‡ä»¶é…ç½®æ’ä»¶çš„åŠŸèƒ½ NProgress.configure(&#123; easing: &#x27;ease&#x27;, // åŠ¨ç”»æ–¹å¼ speed: 500, // é€’å¢è¿›åº¦æ¡çš„é€Ÿåº¦ showSpinner: false, // æ˜¯å¦æ˜¾ç¤ºåŠ è½½ico trickleSpeed: 200, // è‡ªåŠ¨é€’å¢é—´éš” minimum: 0.3, // åˆå§‹åŒ–æ—¶çš„æœ€å°ç™¾åˆ†æ¯”&#125;); ç¬¬å››æ­¥ï¼Œç›‘å¬è·¯ç”±è·³è½¬ï¼Œè¿›å…¥é¡µé¢æ‰§è¡Œæ’ä»¶åŠ¨ç”»ã€‚ è·¯ç”±è·³è½¬ä¸­ // router.js// å¯¼èˆªå…¨å±€å‰ç½®å®ˆå«router.beforeEach((to, from, next) =&gt; &#123; // æ¯æ¬¡åˆ‡æ¢é¡µé¢æ—¶ï¼Œè°ƒç”¨è¿›åº¦æ¡ NProgress.start(); // è¿™ä¸ªä¸€å®šè¦åŠ ï¼Œæ²¡æœ‰next()é¡µé¢ä¸ä¼šè·³è½¬çš„ã€‚è¿™éƒ¨åˆ†è¿˜ä¸æ¸…æ¥šçš„å»ç¿»ä¸€ä¸‹å®˜ç½‘å°±æ˜ç™½äº† next();&#125;); è·³è½¬ç»“æŸäº† // router.jsrouter.afterEach(() =&gt; &#123; // åœ¨å³å°†è¿›å…¥æ–°çš„é¡µé¢ç»„ä»¶å‰ï¼Œå…³é—­æ‰è¿›åº¦æ¡ NProgress.done();&#125;); å¦‚ä½•å®ç°åˆ·æ–°é¡µé¢ å®ç°æ€è·¯æœ‰ 3 ç§ æ–¹å¼ 1ï¼š é€šè¿‡ç»™router-viewæ·»åŠ v-ifæŒ‡ä»¤ï¼Œæ§åˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œä»è€Œå®ç°åˆ·æ–°ã€‚ æ–¹å¼ 2ï¼š é‡‡ç”¨window.reload()ï¼Œæˆ–è€…router.go(0)åˆ·æ–°æ—¶ï¼Œæ•´ä¸ªæµè§ˆå™¨è¿›è¡Œäº†é‡æ–°åŠ è½½ï¼Œé—ªçƒï¼Œä½“éªŒä¸å¥½ æ–¹å¼ 3ï¼š ä¸ºäº†å®ç°åˆ·æ–°é¡µé¢ï¼Œå¯ä»¥å…ˆè·³è½¬åˆ°ä¸€ä¸ªç©ºé¡µé¢ï¼Œç„¶åé©¬ä¸Šè·³å›æ¥ï¼Œä»è€Œå®ç°è¿™ä¸ªåŠŸèƒ½ æ–¹å¼ 1 å®ç°æ–¹å¼ provide / inject ç»„åˆ ä½œç”¨ï¼šå…è®¸ä¸€ä¸ªç¥–å…ˆç»„ä»¶å‘å…¶æ‰€æœ‰å­å­™åä»£æ³¨å…¥ä¸€ä¸ªä¾èµ–ï¼Œä¸è®ºç»„ä»¶å±‚æ¬¡æœ‰å¤šæ·±ï¼Œå¹¶åœ¨èµ·ä¸Šä¸‹æ¸¸å…³ç³»æˆç«‹çš„æ—¶é—´é‡Œå§‹ç»ˆç”Ÿæ•ˆã€‚ App.vue: å£°æ˜ reload æ–¹æ³•ï¼Œæ§åˆ¶ router-view çš„æ˜¾ç¤ºæˆ–éšè—ï¼Œä»è€Œæ§åˆ¶é¡µé¢çš„å†æ¬¡åŠ è½½ æŸä¸ªç»„ä»¶ä¸­ï¼šåœ¨é¡µé¢æ³¨å…¥ App.vue ç»„ä»¶æä¾›ï¼ˆprovideï¼‰çš„ reload ä¾èµ–ï¼Œåœ¨é€»è¾‘å®Œæˆä¹‹åï¼ˆåˆ é™¤æˆ–æ·»åŠ â€¦ï¼‰,ç›´æ¥ this.reload()è°ƒç”¨ï¼Œå³å¯åˆ·æ–°å½“å‰é¡µé¢ã€‚ éœ€è¦ç†è§£ provide/inject çš„ä½¿ç”¨ï¼Œä¸ç†Ÿæ‚‰çœ‹æ–‡æ¡£åœ°å€ï¼šhttps://cn.vuejs.org/v2/api/#provide-inject æ–¹å¼ 3 çš„å®ç°æ–¹æ³• ä¸€ã€åŸç† å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬éœ€è¦ä¸ºè¦åˆ·æ–°çš„é¡µé¢ A ç¼–å†™ä¸€ä¸ªè‡ªåŠ¨è·³å›çš„ç©ºé¡µé¢ï¼Œå½“ç”¨æˆ·æ“ä½œäº† A é¡µé¢åï¼ŒA é¡µé¢å…ˆè·³è½¬åˆ°ç©ºé¡µé¢ï¼Œç„¶åç©ºé¡µé¢é©¬ä¸Šè·³å› A é¡µé¢ï¼Œè¿™æ—¶å€™ vue ä¼šå»é‡æ–°åŠ è½½ A é¡µé¢ã€‚è¿™ç§æ–¹æ³•å¯ä»¥å˜ç›¸å®ç°è‡ªæˆ‘åˆ·æ–°ï¼Œç¼ºç‚¹æ˜¯å½“éœ€è¦åˆ·æ–°çš„é¡µé¢è¾ƒå¤šæ—¶ï¼Œç©ºé¡µé¢ä¹Ÿä¼šéšä¹‹å˜å¤šã€‚ äºŒã€å½“å‰é¡µé¢äº‹ä»¶ç›‘å¬ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å®šä¹‰äº† refreshPage æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¯¹ç‰¹å®šäº‹ä»¶çš„å›è°ƒï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¼šå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œç„¶ååœ¨æœ€åä½¿ç”¨ vue çš„ router è·³è½¬åˆ°ä¸€ä¸ªç©ºé¡µé¢ï¼Œè¿™ä¸ªç©ºé¡µé¢è·¯ç”±è·¯å¾„æ˜¯/user/backï¼Œè¿™ä¸ªè·¯å¾„æ˜¯éšä¾¿å–çš„ï¼Œå¤§å®¶å¯ä»¥é€‰æ‹©è‡ªå·±çš„è·¯å¾„ ä¸‰ã€ç©ºé¡µé¢çš„ç¼–å†™ å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œåœ¨ç©ºé¡µé¢ä¸­ç«‹å³æ‰§è¡Œè·¯ç”±ï¼Œè·³å›åŸæ¥çš„é¡µé¢ï¼Œè¿™æ—¶å€™åŸæ¥çš„é¡µé¢ä¼šè¿›è¡Œé‡æ–°åŠ è½½ï¼Œä»è€Œå®ç°äº†åˆ·æ–°ã€‚è¿™é‡Œçš„/user/index å°±æ˜¯è·³å›åŸæ¥é¡µé¢çš„è·¯ç”±è·¯å¾„ï¼Œå¤§å®¶éœ€è¦æ ¹æ®è‡ªå·±çš„é¡¹ç›®æƒ…å†µå†™ã€‚ å››ã€æ³¨æ„äº‹é¡¹ æœ¬æ–‡æ‰€ä½¿ç”¨çš„æ–¹æ³•ï¼Œå…¶å®æ˜¯ä¸€ç§ hack æ–¹æ³•ï¼Œåœ¨æç«¯æƒ…å†µä¸‹ï¼Œæ¯”å¦‚ç½‘ç»œæç«¯æ¶åŠ£ï¼Œé‚£ä¹ˆå¯èƒ½å‡ºç°è·³åˆ°ç©ºé¡µé¢åè·³ä¸ä¼šæ¥ï¼Œæˆ–è€…å¹²è„†è·³ä¸åˆ°ç©ºé¡µé¢çš„æƒ…å†µï¼Œå¤§å®¶éœ€è¦æ ¹æ®è‡ªå·±çš„é¡¹ç›®æƒ…å†µé…Œæƒ…é€‰æ‹©ã€‚ å¦‚ä½•ä½¿ç”¨è·¯ç”±å®ç°æ ‡ç­¾é¡µ &lt;template&gt; &lt;ul class=&quot;tag-list&quot;&gt; &lt;!-- å¾ªç¯è¿™ä¸ªli --&gt; &lt;li :class=&quot;$route.fullPath === item.path ? &#x27;on&#x27; : &#x27;&#x27;&quot; v-for=&quot;(item, index) in list&quot; :key=&quot;index&quot;&gt; &lt;router-link :to=&quot;item.path&quot;&gt; &#123;&#123; item.name &#125;&#125; &lt;/router-link&gt; &lt;i @click=&quot;del(item, index)&quot;&gt;X&lt;/i&gt; &lt;/li&gt; &lt;li @click=&quot;delOther&quot;&gt;å…³é—­å…¶ä»–&lt;/li&gt; &lt;li @click=&quot;delAll&quot;&gt;å…³é—­æ‰€æœ‰&lt;/li&gt; &lt;/ul&gt;&lt;/template&gt;&lt;script&gt; export default &#123; name: &#x27;TagsList&#x27;, data() &#123; // ä»æœ¬åœ°å­˜å‚¨è¯»å–æ˜¯å¦æœ‰ï¼ let list = localStorage.getItem(&#x27;taglist&#x27;); return &#123; list: list ? JSON.parse(list) : [], // èœå•åœ°å€æ±  &#125;; &#125;, watch: &#123; // ç›‘å¬$routeçš„å˜åŒ–ï¼Œä»è€Œå®ç°å¢åŠ æ ‡ç­¾é¡µä¿¡æ¯ $route: &#123; immediate: true, // ä¸€å¼€å§‹å°±è¦åšä¸€æ¬¡ç›‘å¬ handler() &#123; // åˆ¤æ–­æ˜¯å¦å·²ç»æœ‰ const hasPath = this.list.some(val =&gt; val.path === this.$route.fullPath); // å¦‚æœæ²¡æœ‰å°±å†™å…¥ !hasPath &amp;&amp; this.list.push(&#123; name: this.$route.meta.title, path: this.$route.fullPath, &#125;); // å†™å…¥æœ¬åœ°å­˜å‚¨æŒä¹…åŒ– localStorage.setItem(&#x27;taglist&#x27;, JSON.stringify(this.list)); &#125;, &#125;, &#125;, methods: &#123; // åˆ é™¤å•ä¸ªæ ‡ç­¾é¡µ del(val, index) &#123; //åˆ é™¤çš„å…ƒç´ ï¼Œåˆ é™¤å…ƒç´ çš„ä¸‹æ ‡ // åˆ é™¤çš„æ˜¯å¦ä¸ºæ¿€æ´»å…ƒç´  if (val.path === this.$route.fullPath) &#123; // æ˜¯æ¿€æ´» // è·³è½¬åˆ°index-1çš„é‚£ä¸ªè·¯ç”±åœ°å€å»ï¼ å·¦è¾¹æ¿€æ´» this.list.splice(index, 1); // åˆ é™¤å¯¹åº”å…ƒç´ ï¼ if (this.list.length) &#123; // è¿˜æœ‰å€¼ï¼ if (index == 0) &#123; // åˆ é™¤ç¬¬æ˜¯ç¬¬ä¸€ä¸ªï¼Œè¯´æ˜å³è¾¹è¿˜æœ‰ï¼Œé‚£ä¹ˆå°±å‘åèµ°ï¼Œä½†æ˜¯å…¶å®è¿˜æ˜¯indexä¸‹æ ‡è¿™ä¸ªï¼Œå› ä¸ºæ•°ç»„å·²ç»å‘ç”Ÿå˜åŒ–äº† this.$router.push(this.list[index].path); &#125; else &#123; // åˆ é™¤çš„ä¸æ˜¯ç¬¬ä¸€ä¸ªï¼ˆè¯´æ˜å·¦è¾¹è¿˜æœ‰ï¼‰ï¼Œé‚£ä¹ˆå°±å±•ç¤ºå·¦è¾¹çš„ä¸€ä¸ª this.$router.push(this.list[index - 1].path); &#125; &#125; else &#123; // æœ€ä¸€ä¸ªå…ƒç´ ï¼Œè·³è½¬åˆ°åˆ¶å®šåœ°å€å» this.$router.push(&#x27;/welcome&#x27;); &#125; &#125; else &#123; // ä¸æ˜¯æ¿€æ´» this.list.splice(index, 1); &#125; // æŒä¹…åŒ–å­˜å‚¨ localStorage.setItem(&#x27;taglist&#x27;, JSON.stringify(this.list)); &#125;, // åˆ é™¤å…¶ä»–æ ‡ç­¾é¡µ delOther() &#123; // ç›´æ¥èµ‹å€¼ä¸ºå½“å‰é¡µé¢å…ƒç´  this.list = [&#123; name: this.$route.meta.title, path: this.$route.fullPath &#125;]; // æŒä¹…åŒ–å­˜å‚¨ localStorage.setItem(&#x27;taglist&#x27;, JSON.stringify(this.list)); &#125;, // åˆ é™¤æ‰€æœ‰æ ‡ç­¾ delAll() &#123; this.list = []; // æŒä¹…åŒ–å­˜å‚¨ localStorage.setItem(&#x27;taglist&#x27;, JSON.stringify(this.list)); // è·³è½¬åœ°å€ this.$router.push(&#x27;/welcome&#x27;); &#125;, &#125;, &#125;; /*æ€è·¯ï¼š æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œç”¨äºå­˜å‚¨æ‰“å¼€è¿‡çš„æ ‡ç­¾ä¿¡æ¯ // æ•°ç»„æ ¼å¼ï¼š [&#123; name:&#x27;åç§°&#x27;,path:&#x27;/åœ°å€&#x27; &#125;,...] å¢åŠ ï¼š // ç”¨watchç›‘å¬$routeçš„å˜åŒ– // æœ‰å˜åŒ–ï¼Œæ’å…¥åˆ°æ•°ç»„ä¸­å»ï¼ˆåˆ¤æ–­ä¸€ä¸‹æ•°ç»„ä¸­æ˜¯å¦å·²ç»å­˜åœ¨ï¼‰ åˆ é™¤ï¼š åˆ é™¤æ‰€æœ‰ï¼š ç›´æ¥èµ‹å€¼ä¸ºç©ºæ•°ç»„ï¼Œç„¶åè·³è½¬åˆ°é»˜è®¤åœ°å€ åˆ é™¤å…¶ä»–ï¼š ç›´æ¥èµ‹å€¼ä¸ºä¸€ä¸ªå…ƒç´ ï¼Œå°±æ˜¯å½“å‰è·¯ç”±çš„ä¿¡æ¯ åˆ é™¤å•ä¸ªï¼š // æ˜¯å¦ä¸ºæ¿€æ´» // ä¸æ˜¯æ¿€æ´»é¡¹ ç›´æ¥åˆ é™¤ // æ˜¯æ¿€æ´»é¡¹ï¼š // é¦–å…ˆåˆ é™¤å…ƒç´  // åˆ é™¤å®Œä¹‹åæ•°ç»„æ˜¯å¦è¿˜æœ‰é•¿åº¦ï¼š // æ²¡æœ‰é•¿åº¦ï¼Œè¯´æ˜åˆ é™¤çš„æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ä¸”è¿˜æ˜¯æ¿€æ´»é¡¹ï¼Œé‚£ä¹ˆè·³è½¬åˆ°é»˜è®¤åœ°å€ // æœ‰é•¿åº¦ï¼Œå°±åˆ¤æ–­åˆ é™¤çš„å…ƒç´ ä¸‹æ ‡æ˜¯å¦ä¸º0ï¼Œä¹Ÿå°±æ˜¯åˆ¤æ–­æ˜¯å¦ä¸ºé¦–ä½ // å¦‚æœæ˜¯0ï¼Œã€åˆ å®Œåè¿˜æœ‰é•¿åº¦ï¼Œä¸”åˆ é™¤çš„é‚£ä¸ªæ˜¯é¦–ä½ï¼Œè¯´æ˜å³è¾¹è¿˜æœ‰å†…å®¹ã€‘ï¼Œæ‰€ä»¥å±•ç¤ºå³è¾¹çš„å†…å®¹ã€‚è€Œå³è¾¹é‚£ä¸ªå…ƒç´ çš„ä¸‹æ ‡å°±æ˜¯index // å¦‚æœä¸æ˜¯0 ã€åˆ å®Œåè¿˜æœ‰é•¿åº¦ï¼Œä¸”åˆ é™¤çš„ä¸æ˜¯é¦–ä½ï¼Œè¯´æ˜å·¦è¾¹è¿˜æœ‰å†…å®¹ã€‘ï¼Œæ‰€ä»¥å±•ç¤ºå·¦è¾¹çš„å†…å®¹ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°å·¦è¾¹æ²¡æœ‰äº†ï¼Œå°±ä¼šå»åˆ¤æ–­å³è¾¹æ˜¯å¦è¿˜æœ‰ã€‚*/&lt;/script&gt;&lt;style scoped&gt; .tag-list &#123; position: absolute; left: 0; top: 0; width: 100%; background-color: #eee; border-bottom: 1px solid #aaa; height: 50px; &#125; .tag-list li &#123; display: inline-block; list-style: none; padding-left: 10px; padding-right: 30px; line-height: 30px; border: 1px solid blue; color: blue; margin: 10px; position: relative; &#125; .tag-list li a &#123; text-decoration: none; color: inherit; &#125; .tag-list li i &#123; position: absolute; right: 5px; top: 5px; width: 20px; height: 20px; display: inline-block; text-align: center; line-height: 20px; font-style: normal; border-radius: 50%; cursor: pointer; &#125; .tag-list li i:hover &#123; background-color: blue; color: #fff; &#125; .tag-list li.on &#123; background-color: blue; color: #fff; &#125; .tag-list li.on i:hover &#123; background-color: #fff; color: #000; &#125;&lt;/style&gt; è¯´ä¸€ä¸‹è·¯ç”±å®ç°çš„åŸç† hash æ¨¡å¼ï¼šç›‘å¬ window çš„ hashchange äº‹ä»¶ï¼Œä»è€Œå®ç°æ›´æ¢å±•ç¤ºä¸åŒçš„ç»„ä»¶ history æ¨¡å¼ï¼š ä» HTML5 å¼€å§‹ï¼ŒHistory interface æä¾›äº† 2 ä¸ªæ–°çš„æ–¹æ³•ï¼špushState()**ã€replaceState()** ä½¿å¾—æˆ‘ä»¬å¯ä»¥å¯¹æµè§ˆå™¨å†å²è®°å½•æ ˆè¿›è¡Œä¿®æ”¹ å‚è€ƒæ–‡æ¡£åœ°å€ï¼šhttps://www.cnblogs.com/gaosirs/p/10606266.html vue-router åŸç†æ–‡æ¡£ï¼šhttps://blog.csdn.net/derivation/article/details/105085951 å®Œæ•´çš„ vue-router å¯¼èˆªè§£ææµç¨‹ 1.å¯¼èˆªè¢«è§¦å‘ï¼› 2.åœ¨å¤±æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteLeave å®ˆå«ï¼› 3.è°ƒç”¨å…¨å±€ beforeEach å®ˆå«ï¼› 4.åœ¨å¤ç”¨ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteUpdate å®ˆå«ï¼› 5.è°ƒç”¨è·¯ç”±é…ç½®é‡Œçš„ beforeEnter å®ˆå«ï¼› 6.è§£æå¼‚æ­¥è·¯ç”±ç»„ä»¶ï¼› 7.åœ¨è¢«æ¿€æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteEnter å®ˆå«ï¼› 8.è°ƒç”¨å…¨å±€ beforeResolve å®ˆå«ï¼› 9.å¯¼èˆªè¢«ç¡®è®¤ï¼›10..è°ƒç”¨å…¨å±€çš„ afterEach é’©å­ï¼›11.DOM æ›´æ–°ï¼› 12.ç”¨åˆ›å»ºå¥½çš„å®ä¾‹è°ƒç”¨ beforeRouteEnter å®ˆå«ä¸­ä¼ ç»™ next çš„å›è°ƒå‡½æ•°ã€‚ åˆ‡æ¢è·¯ç”±æ—¶ï¼Œéœ€è¦ä¿å­˜è‰ç¨¿çš„åŠŸèƒ½ï¼Œæ€ä¹ˆå®ç°å‘¢ï¼Ÿ&lt;keep-alive :include=&quot;include&quot;&gt; &lt;router-view&gt;&lt;/router-view&gt;&lt;/keep-alive&gt; å…¶ä¸­ include å¯ä»¥æ˜¯ä¸ªæ•°ç»„ï¼Œæ•°ç»„å†…å®¹ä¸ºè·¯ç”±çš„ name é€‰é¡¹çš„å€¼ã€‚ è¯´è¯´ä½ å¯¹ router-link çš„äº†è§£&lt;router-link&gt;æ˜¯ Vue-Router çš„å†…ç½®ç»„ä»¶ï¼Œåœ¨å…·æœ‰è·¯ç”±åŠŸèƒ½çš„åº”ç”¨ä¸­ä½œä¸ºå£°æ˜å¼çš„å¯¼èˆªä½¿ç”¨ã€‚ &lt;router-link&gt;æœ‰ 8 ä¸ª propsï¼Œå…¶ä½œç”¨æ˜¯ï¼š toï¼šå¿…å¡«ï¼Œè¡¨ç¤ºç›®æ ‡è·¯ç”±çš„é“¾æ¥ã€‚å½“è¢«ç‚¹å‡»åï¼Œå†…éƒ¨ä¼šç«‹åˆ»æŠŠtoçš„å€¼ä¼ åˆ°router.push()ï¼Œæ‰€ä»¥è¿™ä¸ªå€¼å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ˜¯æè¿°ç›®æ ‡ä½ç½®çš„å¯¹è±¡ã€‚ &lt;router-link to=&quot;home&quot;&gt;Home&lt;/router-link&gt;&lt;router-link :to=&quot;&#x27;home&#x27;&quot;&gt;Home&lt;/router-link&gt;&lt;router-link :to=&quot;&#123; path: &#x27;home&#x27; &#125;&quot;&gt;Home&lt;/router-link&gt;&lt;router-link :to=&quot;&#123; name: &#x27;user&#x27;, params: &#123; userId: 123 &#125;&#125;&quot;&gt;User&lt;/router-link&gt;&lt;router-link :to=&quot;&#123; path: &#x27;user&#x27;, query: &#123; userId: 123 &#125;&#125;&quot;&gt;User&lt;/router-link&gt; æ³¨æ„ path å­˜åœ¨æ—¶ params ä¸èµ·ä½œç”¨ï¼Œåªèƒ½ç”¨ query replaceï¼šé»˜è®¤å€¼ä¸º falseï¼Œè‹¥è®¾ç½®çš„è¯ï¼Œå½“ç‚¹å‡»æ—¶ï¼Œä¼šè°ƒç”¨router.replace()è€Œä¸æ˜¯router.push()ï¼Œäºæ˜¯å¯¼èˆªåä¸ä¼šç•™ä¸‹ history è®°å½•ã€‚ appendï¼šè®¾ç½® append å±æ€§åï¼Œåˆ™åœ¨å½“å‰ (ç›¸å¯¹) è·¯å¾„å‰æ·»åŠ åŸºè·¯å¾„ã€‚ tagï¼šè®©&lt;router-link&gt;æ¸²æŸ“æˆtagè®¾ç½®çš„æ ‡ç­¾ï¼Œå¦‚tag:&#39;li,æ¸²æŸ“ç»“æœä¸º&lt;li&gt;foo&lt;/li&gt;ã€‚ active-classï¼šé»˜è®¤å€¼ä¸ºrouter-link-active,è®¾ç½®é“¾æ¥æ¿€æ´»æ—¶ä½¿ç”¨çš„ CSS ç±»åã€‚é»˜è®¤å€¼å¯ä»¥é€šè¿‡è·¯ç”±çš„æ„é€ é€‰é¡¹ linkActiveClass æ¥å…¨å±€é…ç½®ã€‚ exact-active-classï¼šé»˜è®¤å€¼ä¸ºrouter-link-exact-active,è®¾ç½®é“¾æ¥è¢«ç²¾ç¡®åŒ¹é…çš„æ—¶å€™åº”è¯¥æ¿€æ´»çš„ classã€‚é»˜è®¤å€¼å¯ä»¥é€šè¿‡è·¯ç”±æ„é€ å‡½æ•°é€‰é¡¹ linkExactActiveClass è¿›è¡Œå…¨å±€é…ç½®çš„ã€‚ exact ï¼šæ˜¯å¦ç²¾ç¡®åŒ¹é…ï¼Œé»˜è®¤ä¸º falseã€‚```html&lt;!-- è¿™ä¸ªé“¾æ¥åªä¼šåœ¨åœ°å€ä¸º / çš„æ—¶å€™è¢«æ¿€æ´» --&gt;&lt;router-link to=&quot;/&quot; exact&gt;&lt;/router-link&gt; eventï¼šå£°æ˜å¯ä»¥ç”¨æ¥è§¦å‘å¯¼èˆªçš„äº‹ä»¶ã€‚å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–æ˜¯ä¸€ä¸ªåŒ…å«å­—ç¬¦ä¸²çš„æ•°ç»„ï¼Œé»˜è®¤æ˜¯clickã€‚ Vue è·¯ç”±æ€ä¹ˆè·³è½¬æ‰“å¼€æ–°çª—å£ï¼Ÿconst obj = &#123; path: xxx, //è·¯ç”±åœ°å€ query: &#123; mid: data.id, //å¯ä»¥å¸¦å‚æ•° &#125;,&#125;;const &#123; href &#125; = this.$router.resolve(obj);window.open(href, &#x27;_blank&#x27;); ä¸‰ã€vuexvuex å’Œæœ¬åœ°å­˜å‚¨çš„åŒºåˆ« vuex åˆ·æ–°å°±ä¸¢å¤±ï¼Œæœ¬åœ°å­˜å‚¨ä¸€ç›´åœ¨ vuex å®ƒå¯ä»¥å®æ—¶æ›´æ–°ï¼Œæœ¬åœ°å­˜å‚¨ä¸èƒ½ ä»€ä¹ˆæ˜¯ Vuexï¼ŸVuex æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ’ä»¶ã€‚å®ƒé‡‡ç”¨é›†ä¸­å¼å­˜å‚¨ç®¡ç†åº”ç”¨çš„æ‰€æœ‰ç»„ä»¶çš„çŠ¶æ€ï¼Œè€Œæ›´æ”¹çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯æäº¤ mutationï¼Œä¾‹this.$store.commit(&#39;SET_VIDEO_PAUSE&#39;, video_pause)ï¼ŒSET_VIDEO_PAUSE ä¸º mutations å±æ€§ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚ Vuex è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ å¤šä¸ªç»„ä»¶ä¾èµ–äºåŒä¸€çŠ¶æ€æ—¶ï¼Œå¯¹äºå¤šå±‚åµŒå¥—çš„ç»„ä»¶çš„ä¼ å‚å°†ä¼šéå¸¸ç¹çï¼Œå¹¶ä¸”å¯¹äºå…„å¼Ÿç»„ä»¶é—´çš„çŠ¶æ€ä¼ é€’æ— èƒ½ä¸ºåŠ›ã€‚ æ¥è‡ªä¸åŒç»„ä»¶çš„è¡Œä¸ºéœ€è¦å˜æ›´åŒä¸€çŠ¶æ€ã€‚ä»¥å¾€é‡‡ç”¨çˆ¶å­ç»„ä»¶ç›´æ¥å¼•ç”¨æˆ–è€…é€šè¿‡äº‹ä»¶æ¥å˜æ›´å’ŒåŒæ­¥çŠ¶æ€çš„å¤šä»½æ‹·è´ã€‚ä»¥ä¸Šçš„è¿™äº›æ¨¡å¼éå¸¸è„†å¼±ï¼Œé€šå¸¸ä¼šå¯¼è‡´æ— æ³•ç»´æŠ¤çš„ä»£ç ã€‚ æ€ä¹ˆå¼•ç”¨ Vuexï¼Ÿ å…ˆå®‰è£…ä¾èµ–nnpm install vuex --save åœ¨é¡¹ç›®ç›®å½• src ä¸­å»ºç«‹ store æ–‡ä»¶å¤¹ åœ¨ store æ–‡ä»¶å¤¹ä¸‹æ–°å»º index.js æ–‡ä»¶,å†™å…¥ import Vue from &#x27;vue&#x27;;import Vuex from &#x27;vuex&#x27;;Vue.use(Vuex);//ä¸æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒdebugä¸ºtrueconst debug = process.env.NODE_ENV !== &#x27;production&#x27;;//åˆ›å»ºVuexå®ä¾‹å¯¹è±¡const store = new Vuex.Store(&#123; strict: debug, //åœ¨ä¸æ˜¯ç”Ÿäº§ç¯å¢ƒä¸‹éƒ½å¼€å¯ä¸¥æ ¼æ¨¡å¼ state: &#123;&#125;, getters: &#123;&#125;, mutations: &#123;&#125;, actions: &#123;&#125;,&#125;);export default store;å¤åˆ¶ä»£ç ; ç„¶åå† main.js æ–‡ä»¶ä¸­å¼•å…¥ Vuex,è¿™ä¹ˆå†™ import Vue from &#x27;vue&#x27;;import App from &#x27;./App.vue&#x27;;import store from &#x27;./store&#x27;;const vm = new Vue(&#123; store: store, // ä¸€æ—¦æŒ‚è½½ï¼Œç»„ä»¶ä¸­this.$storeå°±å¯ä»¥å¾—åˆ°ä»“åº“å®ä¾‹ render: h =&gt; h(App),&#125;).$mount(&#x27;#app&#x27;); Vuex çš„ 5 ä¸ªæ ¸å¿ƒå±æ€§æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«æ˜¯ stateã€gettersã€mutationsã€actionsã€modules ã€‚ Vuex ä¸­çŠ¶æ€å‚¨å­˜åœ¨å“ªé‡Œï¼Œæ€ä¹ˆæ”¹å˜å®ƒï¼Ÿå­˜å‚¨åœ¨ state ä¸­ï¼Œæ”¹å˜ Vuex ä¸­çš„çŠ¶æ€çš„å”¯ä¸€é€”å¾„å°±æ˜¯æ˜¾å¼åœ°æäº¤ (commit) mutationã€‚ Vuex ä¸­çŠ¶æ€æ˜¯å¯¹è±¡æ—¶ï¼Œä½¿ç”¨æ—¶è¦æ³¨æ„ä»€ä¹ˆï¼Ÿå› ä¸ºå¯¹è±¡æ˜¯å¼•ç”¨ç±»å‹ï¼Œå¤åˆ¶åæ”¹å˜å±æ€§è¿˜æ˜¯ä¼šå½±å“åŸå§‹æ•°æ®ï¼Œè¿™æ ·ä¼šæ”¹å˜ state é‡Œé¢çš„çŠ¶æ€ï¼Œæ˜¯ä¸å…è®¸ï¼Œæ‰€ä»¥å…ˆç”¨æ·±åº¦å…‹éš†å¤åˆ¶å¯¹è±¡ï¼Œå†ä¿®æ”¹ã€‚ æ€ä¹ˆåœ¨ç»„ä»¶ä¸­æ‰¹é‡ä½¿ç”¨ Vuex çš„ state çŠ¶æ€ï¼Ÿä½¿ç”¨ mapState è¾…åŠ©å‡½æ•°, åˆ©ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°† state æ··å…¥ computed å¯¹è±¡ä¸­ import &#123; mapState &#125; from &#x27;vuex&#x27;;export default &#123; computed: &#123; ...mapState([&#x27;price&#x27;, &#x27;number&#x27;]), &#125;,&#125;; Vuex ä¸­è¦ä» state æ´¾ç”Ÿä¸€äº›çŠ¶æ€å‡ºæ¥ï¼Œä¸”å¤šä¸ªç»„ä»¶ä½¿ç”¨å®ƒï¼Œè¯¥æ€ä¹ˆåšï¼Œï¼Ÿä½¿ç”¨ getter å±æ€§ï¼Œç›¸å½“ Vue ä¸­çš„è®¡ç®—å±æ€§ computedï¼Œåªæœ‰åŸçŠ¶æ€æ”¹å˜æ´¾ç”ŸçŠ¶æ€æ‰ä¼šæ”¹å˜ã€‚ getter æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ stateï¼Œç¬¬äºŒä¸ªæ˜¯ getters(å¯ä»¥ç”¨æ¥è®¿é—®å…¶ä»– getter)ã€‚ const store = new Vuex.Store(&#123; state: &#123; price: 10, number: 10, discount: 0.7, &#125;, getters: &#123; total: state =&gt; &#123; return state.price * state.number; &#125;, discountTotal: (state, getters) =&gt; &#123; return state.discount * getters.total; &#125;, &#125;,&#125;); ç„¶ååœ¨ç»„ä»¶ä¸­å¯ä»¥ç”¨è®¡ç®—å±æ€§ computed é€šè¿‡this.$store.getters.totalè¿™æ ·æ¥è®¿é—®è¿™äº›æ´¾ç”Ÿè½¬æ€ã€‚ computed: &#123; total() &#123; return this.$store.getters.total &#125;, discountTotal() &#123; return this.$store.getters.discountTotal &#125; // æˆ–è€…ç›´æ¥è®¡ç®—å±æ€§ï¼Œä¸Šè¿°ä»£ç å¯ä»¥ç®€å†™ä¸º ...mapGetters([&#x27;total&#x27;,&#x27;discountTotal&#x27;])&#125; æ€ä¹ˆé€šè¿‡ getter æ¥å®ç°åœ¨ç»„ä»¶å†…å¯ä»¥é€šè¿‡ç‰¹å®šæ¡ä»¶æ¥è·å– state çš„çŠ¶æ€ï¼Ÿé€šè¿‡è®© getter è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å®ç°ç»™ getter ä¼ å‚ã€‚ç„¶åé€šè¿‡å‚æ•°æ¥è¿›è¡Œåˆ¤æ–­ä»è€Œè·å– state ä¸­æ»¡è¶³è¦æ±‚çš„çŠ¶æ€ const store = new Vuex.Store(&#123; state: &#123; todos: [ &#123; id: 1, text: &#x27;...&#x27;, done: true &#125;, &#123; id: 2, text: &#x27;...&#x27;, done: false &#125;, ], &#125;, getters: &#123; getTodoById: state =&gt; id =&gt; &#123; return state.todos.find(todo =&gt; todo.id === id); &#125;, &#125;,&#125;); ç„¶ååœ¨ç»„ä»¶ä¸­å¯ä»¥ç”¨è®¡ç®—å±æ€§ computed é€šè¿‡this.$store.getters.getTodoById(2)è¿™æ ·æ¥è®¿é—®è¿™äº›æ´¾ç”Ÿè½¬æ€ã€‚ computed: &#123; getTodoById() &#123; return this.$store.getters.getTodoById &#125;,&#125;mounted()&#123; console.log(this.getTodoById(2).done)//false&#125; æ€ä¹ˆåœ¨ç»„ä»¶ä¸­æ‰¹é‡ä½¿ç”¨ Vuex çš„ getter å±æ€§ä½¿ç”¨ mapGetters è¾…åŠ©å‡½æ•°, åˆ©ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°† getter æ··å…¥ computed å¯¹è±¡ä¸­ import &#123; mapGetters &#125; from &#x27;vuex&#x27;;export default &#123; computed: &#123; ...mapGetters([&#x27;total&#x27;, &#x27;discountTotal&#x27;]), &#125;,&#125;; æ€ä¹ˆåœ¨ç»„ä»¶ä¸­æ‰¹é‡ç»™ Vuex çš„ getter å±æ€§å–åˆ«åå¹¶ä½¿ç”¨ä½¿ç”¨ mapGetters è¾…åŠ©å‡½æ•°, åˆ©ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°† getter æ··å…¥ computed å¯¹è±¡ä¸­ import &#123; mapGetters &#125; from &#x27;vuex&#x27;;export default &#123; computed: &#123; ...mapGetters(&#123; myTotal: &#x27;total&#x27;, myDiscountTotal: &#x27;discountTotal&#x27;, &#125;), &#125;,&#125;; åœ¨ Vuex çš„ state ä¸­æœ‰ä¸ªçŠ¶æ€ number è¡¨ç¤ºè´§ç‰©æ•°é‡ï¼Œåœ¨ç»„ä»¶æ€ä¹ˆæ”¹å˜å®ƒã€‚é¦–å…ˆè¦åœ¨ mutations ä¸­æ³¨å†Œä¸€ä¸ª mutation const store = new Vuex.Store(&#123; state: &#123; number: 10, &#125;, mutations: &#123; SET_NUMBER(state, data) &#123; state.number = data; &#125;, &#125;,&#125;); åœ¨ç»„ä»¶ä¸­ä½¿ç”¨this.$store.commitæäº¤ mutationï¼Œæ”¹å˜ number this.$store.commit(&#x27;SET_NUMBER&#x27;, 10); åœ¨ Vuex ä¸­ä½¿ç”¨ mutation è¦æ³¨æ„ä»€ä¹ˆã€‚mutation å¿…é¡»æ˜¯åŒæ­¥å‡½æ•° åœ¨ç»„ä»¶ä¸­å¤šæ¬¡æäº¤åŒä¸€ä¸ª mutationï¼Œæ€ä¹ˆå†™ä½¿ç”¨æ›´æ–¹ä¾¿ã€‚ä½¿ç”¨ mapMutations è¾…åŠ©å‡½æ•°,åœ¨ç»„ä»¶ä¸­è¿™ä¹ˆä½¿ç”¨ import &#123; mapMutations &#125; from &#x27;vuex&#x27;methods:&#123; ...mapMutations(&#123; setNumber:&#x27;SET_NUMBER&#x27;, &#125;)&#125; ç„¶åè°ƒç”¨this.setNumber(10)ç›¸å½“è°ƒç”¨this.$store.commit(&#39;SET_NUMBER&#39;,10) Vuex ä¸­ action å’Œ mutation æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ action æäº¤çš„æ˜¯ mutationï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ã€‚mutation å¯ä»¥ç›´æ¥å˜æ›´çŠ¶æ€ã€‚ action å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œã€‚mutation åªèƒ½æ˜¯åŒæ­¥æ“ä½œã€‚ æäº¤æ–¹å¼ä¸åŒï¼Œaction æ˜¯ç”¨this.$store.dispatch(&#39;ACTION_NAME&#39;,data)æ¥æäº¤ã€‚mutation æ˜¯ç”¨this.$store.commit(&#39;SET_NUMBER&#39;,10)æ¥æäº¤ã€‚ æ¥æ”¶å‚æ•°ä¸åŒï¼Œmutation ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ stateï¼Œè€Œ action ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ contextï¼Œå…¶åŒ…å«äº† &#123; state, // ç­‰åŒäº `store.state`ï¼Œè‹¥åœ¨æ¨¡å—ä¸­åˆ™ä¸ºå±€éƒ¨çŠ¶æ€ rootState, // ç­‰åŒäº `store.state`ï¼Œåªå­˜åœ¨äºæ¨¡å—ä¸­ commit, // ç­‰åŒäº `store.commit` dispatch, // ç­‰åŒäº `store.dispatch` getters, // ç­‰åŒäº `store.getters` rootGetters; // ç­‰åŒäº `store.getters`ï¼Œåªå­˜åœ¨äºæ¨¡å—ä¸­&#125; Vuex ä¸­ action å’Œ mutation æœ‰ä»€ä¹ˆç›¸åŒç‚¹ï¼Ÿç¬¬äºŒå‚æ•°éƒ½å¯ä»¥æ¥æ”¶å¤–éƒ¨æäº¤æ—¶ä¼ æ¥çš„å‚æ•°ã€‚ this.$store.dispatch(&#39;ACTION_NAME&#39;,data)å’Œthis.$store.commit(&#39;SET_NUMBER&#39;,10) åœ¨ç»„ä»¶ä¸­å¤šæ¬¡æäº¤åŒä¸€ä¸ª actionï¼Œæ€ä¹ˆå†™ä½¿ç”¨æ›´æ–¹ä¾¿ã€‚ä½¿ç”¨ mapActions è¾…åŠ©å‡½æ•°,åœ¨ç»„ä»¶ä¸­è¿™ä¹ˆä½¿ç”¨ methods:&#123; ...mapActions(&#123; setNumber:&#x27;SET_NUMBER&#x27;, &#125;)&#125; ç„¶åè°ƒç”¨this.setNumber(10)ç›¸å½“è°ƒç”¨this.$store.dispatch(&#39;SET_NUMBER&#39;,10) Vuex ä¸­ action é€šå¸¸æ˜¯å¼‚æ­¥çš„ï¼Œé‚£ä¹ˆå¦‚ä½•çŸ¥é“ action ä»€ä¹ˆæ—¶å€™ç»“æŸå‘¢ï¼Ÿåœ¨ action å‡½æ•°ä¸­è¿”å› Promiseï¼Œç„¶åå†æäº¤æ—¶å€™ç”¨ then å¤„ç† actions:&#123; SET_NUMBER_A(&#123;commit&#125;,data)&#123; return new Promise((resolve,reject) =&gt;&#123; setTimeout(() =&gt;&#123; commit(&#x27;SET_NUMBER&#x27;,10); resolve(); &#125;,2000) &#125;) &#125;&#125;this.$store.dispatch(&#x27;SET_NUMBER_A&#x27;).then(() =&gt; &#123; // ...&#125;) Vuex ä¸­æœ‰ä¸¤ä¸ª actionï¼Œåˆ†åˆ«æ˜¯ actionA å’Œ actionBï¼Œå…¶å†…éƒ½æ˜¯å¼‚æ­¥æ“ä½œï¼Œåœ¨ actionB è¦æäº¤ actionAï¼Œéœ€åœ¨ actionA å¤„ç†ç»“æŸå†å¤„ç†å…¶å®ƒæ“ä½œï¼Œæ€ä¹ˆå®ç°ï¼Ÿåˆ©ç”¨ ES6 çš„asyncå’Œawaitæ¥å®ç°ã€‚ actions:&#123; async actionA(&#123;commit&#125;)&#123; //... &#125;, async actionB(&#123;dispatch&#125;)&#123; await dispatch (&#x27;actionA&#x27;)//ç­‰å¾…actionAå®Œæˆ // ... &#125;&#125; æœ‰ç”¨è¿‡ Vuex æ¨¡å—å—ï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨ï¼Œæ€ä¹ˆä½¿ç”¨ã€‚æœ‰ï¼Œå› ä¸ºä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ä¼šé›†ä¸­åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¯¹è±¡ã€‚å½“åº”ç”¨å˜å¾—éå¸¸å¤æ‚æ—¶ï¼Œstore å¯¹è±¡å°±æœ‰å¯èƒ½å˜å¾—ç›¸å½“è‡ƒè‚¿ã€‚æ‰€ä»¥å°† store åˆ†å‰²æˆæ¨¡å—ï¼ˆmoduleï¼‰ã€‚æ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„ stateã€mutationsã€actionsã€gettersï¼Œç”šè‡³æ˜¯åµŒå¥—å­æ¨¡å—ï¼Œä»ä¸Šè‡³ä¸‹è¿›è¡ŒåŒæ ·æ–¹å¼çš„åˆ†å‰²ã€‚ åœ¨ module æ–‡ä»¶æ–°å»º moduleA.js å’Œ moduleB.js æ–‡ä»¶ã€‚åœ¨æ–‡ä»¶ä¸­å†™å…¥ const state = &#123; //...&#125;;const getters = &#123; //...&#125;;const mutations = &#123; //...&#125;;const actions = &#123; //...&#125;;export default &#123; state, getters, mutations, actions,&#125;; ç„¶åå† index.js å¼•å…¥æ¨¡å— import Vue from &#x27;vue&#x27;;import Vuex from &#x27;vuex&#x27;;Vue.use(Vuex);import moduleA from &#x27;./module/moduleA&#x27;;import moduleB from &#x27;./module/moduleB&#x27;;const store = new Vuex.Store(&#123; modules: &#123; moduleA, moduleB, &#125;,&#125;);export default store; åœ¨æ¨¡å—ä¸­ï¼Œgetter å’Œ mutation æ¥æ”¶çš„ç¬¬ä¸€ä¸ªå‚æ•° stateï¼Œæ˜¯å…¨å±€çš„è¿˜æ˜¯æ¨¡å—çš„ï¼Ÿç¬¬ä¸€ä¸ªå‚æ•° state æ˜¯æ¨¡å—çš„ stateï¼Œä¹Ÿå°±æ˜¯å±€éƒ¨çš„ stateã€‚ åœ¨æ¨¡å—ä¸­ï¼Œgetter å’Œ mutation å’Œ action ä¸­æ€ä¹ˆè®¿é—®å…¨å±€çš„ state å’Œ getterï¼Ÿ åœ¨ getter ä¸­å¯ä»¥é€šè¿‡ç¬¬ä¸‰ä¸ªå‚æ•° rootState è®¿é—®åˆ°å…¨å±€çš„ state,å¯ä»¥é€šè¿‡ç¬¬å››ä¸ªå‚æ•° rootGetters è®¿é—®åˆ°å…¨å±€çš„ getterã€‚ åœ¨ mutation ä¸­ä¸å¯ä»¥è®¿é—®å…¨å±€çš„ satat å’Œ getterï¼Œåªèƒ½è®¿é—®åˆ°å±€éƒ¨çš„ stateã€‚ åœ¨ action ä¸­ç¬¬ä¸€ä¸ªå‚æ•° context ä¸­çš„context.rootStateè®¿é—®åˆ°å…¨å±€çš„ stateï¼Œcontext.rootGettersè®¿é—®åˆ°å…¨å±€çš„ getterã€‚ åœ¨ç»„ä»¶ä¸­æ€ä¹ˆè®¿é—® Vuex æ¨¡å—ä¸­çš„ getter å’Œ state,æ€ä¹ˆæäº¤ mutation å’Œ actionï¼Ÿ ç›´æ¥é€šè¿‡this.$store.getters.xxxå’Œthis.$store.æ¨¡å—å.xxxæ¥è®¿é—®æ¨¡å—ä¸­çš„ getter å’Œ stateã€‚ ç›´æ¥é€šè¿‡this.$store.commit(&#39;mutationA&#39;,data)æäº¤æ¨¡å—ä¸­çš„ mutationã€‚ ç›´æ¥é€šè¿‡this.$store.dispatch(&#39;actionA&#39;,data)æäº¤æ¨¡å—ä¸­çš„ actionã€‚ ä»¥ä¸Šæ˜¯æ²¡æœ‰å‘½åç©ºé—´çš„ï¼Œå¦‚æœæœ‰å‘½åç©ºé—´é‚£ä¹ˆå°±æ˜¯ä¸‹é¢è¿™æ · ç›´æ¥é€šè¿‡this.$store.getters[&#39;æ¨¡å—å/xxx&#39;]å’Œthis.$store.æ¨¡å—å.xxxæ¥è®¿é—®æ¨¡å—ä¸­çš„ getter å’Œ stateã€‚ ç›´æ¥é€šè¿‡this.$store.commit(&#39;æ¨¡å—å/mutationA&#39;,data)æäº¤æ¨¡å—ä¸­çš„ mutationã€‚ ç›´æ¥é€šè¿‡this.$store.dispatch(&#39;æ¨¡å—å/actionA&#39;,data)æäº¤æ¨¡å—ä¸­çš„ actionã€‚ ç”¨è¿‡ Vuex æ¨¡å—çš„å‘½åç©ºé—´å—ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨ï¼Œæ€ä¹ˆä½¿ç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¨¡å—å†…éƒ¨çš„ actionã€mutation å’Œ getter æ˜¯æ³¨å†Œåœ¨å…¨å±€å‘½åç©ºé—´ï¼Œå¦‚æœå¤šä¸ªæ¨¡å—ä¸­ actionã€mutation çš„å‘½åæ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆæäº¤ mutationã€action æ—¶ï¼Œå°†ä¼šè§¦å‘æ‰€æœ‰æ¨¡å—ä¸­å‘½åç›¸åŒçš„ mutationã€actionã€‚ è¿™æ ·æœ‰å¤ªå¤šçš„è€¦åˆï¼Œå¦‚æœè¦ä½¿ä½ çš„æ¨¡å—å…·æœ‰æ›´é«˜çš„å°è£…åº¦å’Œå¤ç”¨æ€§ï¼Œä½ å¯ä»¥é€šè¿‡æ·»åŠ namespaced: true çš„æ–¹å¼ä½¿å…¶æˆä¸ºå¸¦å‘½åç©ºé—´çš„æ¨¡å—ã€‚ export default &#123; namespaced: true, state, getters, mutations, actions,&#125;; æ€ä¹ˆåœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…æäº¤å…¨å±€çš„ mutation å’Œ actionï¼Ÿå°† &#123; root: true &#125; ä½œä¸ºç¬¬ä¸‰å‚æ•°ä¼ ç»™ dispatch æˆ– commit å³å¯ã€‚ this.$store.dispatch(&#x27;actionA&#x27;, null, &#123; root: true &#125;);this.$store.commit(&#x27;mutationA&#x27;, null, &#123; root: true &#125;); æ€ä¹ˆåœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…æ³¨å†Œå…¨å±€çš„ actionï¼Ÿactions: &#123; actionA: &#123; root: true, // å¸¦ä¸Šrootä¸ºtrueè¡¨ç¤ºå°±æ˜¯æ ¹çš„actionäº† handler (context, data) &#123; ... &#125; &#125; &#125; ç»„ä»¶ä¸­æ€ä¹ˆæäº¤ modules ä¸­çš„å¸¦å‘½åç©ºé—´çš„ moduleA ä¸­çš„ mutationAï¼Ÿthis.$store.commit(&#x27;moduleA/mutationA&#x27;, data); æ€ä¹ˆä½¿ç”¨ mapStateï¼ŒmapGettersï¼ŒmapActions å’Œ mapMutations è¿™äº›å‡½æ•°æ¥ç»‘å®šå¸¦å‘½åç©ºé—´çš„æ¨¡å—ï¼Ÿä½¿ç”¨createNamespacedHelpersåˆ›å»ºåŸºäºæŸä¸ªå‘½åç©ºé—´è¾…åŠ©å‡½æ•° import &#123; createNamespacedHelpers &#125; from &#x27;vuex&#x27;;const &#123; mapState, mapActions,mapGetters,mapMutations &#125; = createNamespacedHelpers(&#x27;moduleA&#x27;);export default &#123; computed: &#123; // åœ¨ `module/moduleA` ä¸­æŸ¥æ‰¾ ...mapState(&#123; a: state =&gt; state.a, b: state =&gt; state.b &#125;), ...mapGetters([&#x27;getterA&#x27;,&#x27;getterB&#x27;]) &#125;, methods: &#123; // åœ¨ `module/moduleA` ä¸­æŸ¥æ‰¾ ...mapActions([ &#x27;actionA&#x27;, &#x27;actionB&#x27; ])ï¼Œ ...mapMutations([ &#x27;mutationA&#x27;, &#x27;mutationB&#x27; ]) &#125;&#125; å¦‚æœä¸ä½¿ç”¨createNamespacedHelperså°±éœ€è¦æ³¨æ„ï¼Œä¸èƒ½ç›´æ¥ç”¨æ•°ç»„è¯­å»è·å– import &#123; mapState, mapActions &#125; from &#x27;vuex&#x27;;export default &#123; computed: &#123; // åœ¨ `module/moduleA` ä¸­æŸ¥æ‰¾ ...mapState(&#123; a: state =&gt; state.æ¨¡å—å.a, b: state =&gt; state.æ¨¡å—å.b &#125;), ...mapGetters(&#123; gettersA:&#x27;æ¨¡å—å/gettersA&#x27; gettersB:&#x27;æ¨¡å—å/gettersB&#x27; &#125;) &#125;, methods: &#123; // åœ¨ `module/moduleA` ä¸­æŸ¥æ‰¾ ...mapActions(&#123; actionA:&#x27;æ¨¡å—å/actionA&#x27;, actionB:&#x27;æ¨¡å—å/actionB&#x27; &#125;), ...mapMutations(&#123; mutationA:&#x27;æ¨¡å—å/mutationA&#x27;, mutationB:&#x27;æ¨¡å—å/mutationB&#x27; &#125;) &#125;&#125; Vuex æ’ä»¶æœ‰ç”¨è¿‡å—ï¼Ÿæ€ä¹ˆç”¨ç®€å•ä»‹ç»ä¸€ä¸‹ï¼ŸVuex æ’ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥æ”¶ store ä½œä¸ºå”¯ä¸€å‚æ•°ã€‚åœ¨ Vuex.Store æ„é€ å™¨é€‰é¡¹ plugins å¼•å…¥ã€‚ åœ¨ store/plugin.js æ–‡ä»¶ä¸­å†™å…¥ export default function createPlugin(param) &#123; return store =&gt; &#123; //... &#125;;&#125; ç„¶ååœ¨ store/index.js æ–‡ä»¶ä¸­å†™å…¥ import createPlugin from &#x27;./plugin.js&#x27;;const myPlugin = createPlugin();const store = new Vuex.Store(&#123; // ... plugins: [myPlugin],&#125;); åœ¨ Vuex æ’ä»¶ä¸­æ€ä¹ˆç›‘å¬ç»„ä»¶ä¸­æäº¤ mutation å’Œ actionï¼Ÿ ç”¨ Vuex.Store çš„å®ä¾‹æ–¹æ³•subscribeç›‘å¬ç»„ä»¶ä¸­æäº¤ mutation ç”¨ Vuex.Store çš„å®ä¾‹æ–¹æ³•subscribeActionç›‘å¬ç»„ä»¶ä¸­æäº¤ action åœ¨ store/plugin.js æ–‡ä»¶ä¸­å†™å…¥ export default function createPlugin(param) &#123; return store =&gt; &#123; store.subscribe((mutation, state) =&gt; &#123; console.log(mutation.type); //æ˜¯é‚£ä¸ªmutation console.log(mutation.payload); console.log(state); &#125;); // store.subscribeAction((action, state) =&gt; &#123; // console.log(action.type)//æ˜¯é‚£ä¸ªaction // console.log(action.payload)//æäº¤actionçš„å‚æ•° // &#125;) store.subscribeAction(&#123; before: (action, state) =&gt; &#123; //æäº¤actionä¹‹å‰ console.log(`before action $&#123;action.type&#125;`); &#125;, after: (action, state) =&gt; &#123; //æäº¤actionä¹‹å console.log(`after action $&#123;action.type&#125;`); &#125;, &#125;); &#125;;&#125; import createPlugin from &#x27;./plugin.js&#x27;;const myPlugin = createPlugin();const store = new Vuex.Store(&#123; // ... plugins: [myPlugin],&#125;); åœ¨ v-model ä¸Šæ€ä¹ˆç”¨ Vuex ä¸­ state çš„å€¼ï¼Ÿéœ€è¦é€šè¿‡ computed è®¡ç®—å±æ€§æ¥è½¬æ¢ã€‚ &lt;input v-model=&quot;message&quot;&gt;// ...computed: &#123; message: &#123; get () &#123; return this.$store.state.message &#125;, set (value) &#123; this.$store.commit(&#x27;updateMessage&#x27;, value) &#125; &#125;&#125; Vuex çš„ä¸¥æ ¼æ¨¡å¼æ˜¯ä»€ä¹ˆ,æœ‰ä»€ä¹ˆä½œç”¨,æ€ä¹ˆå¼€å¯ï¼Ÿåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œæ— è®ºä½•æ—¶å‘ç”Ÿäº†çŠ¶æ€å˜æ›´ä¸”ä¸æ˜¯ç”± mutation å‡½æ•°å¼•èµ·çš„ï¼Œå°†ä¼šæŠ›å‡ºé”™è¯¯ã€‚è¿™èƒ½ä¿è¯æ‰€æœ‰çš„çŠ¶æ€å˜æ›´éƒ½èƒ½è¢«è°ƒè¯•å·¥å…·è·Ÿè¸ªåˆ°ã€‚ï¼ˆæœ‰æ•ˆé˜²æ­¢äº†ç›´æ¥èµ‹å€¼ state é‡Œé¢çš„å†…å®¹è¿›è¡Œä¿®æ”¹ï¼‰ åœ¨ Vuex.Store æ„é€ å™¨é€‰é¡¹ä¸­å¼€å¯,å¦‚ä¸‹ const store = new Vuex.Store(&#123; strict: true,&#125;); ä¸ºä»€ä¹ˆä¸æ¨èç›´æ¥èµ‹å€¼ä¿®æ”¹ stateç»„ä»¶é‡Œç›´æ¥ä¿®æ”¹ state ä¹Ÿæ˜¯ç”Ÿæ•ˆçš„,ä½†æ˜¯ä¸æ¨èè¿™ç§ç›´æ¥ä¿®æ”¹ state çš„æ–¹å¼ï¼Œå› ä¸ºè¿™æ ·ä¸èƒ½ä½¿ç”¨ vuex çš„æµè§ˆå™¨æ’ä»¶æ¥è·Ÿè¸ªçŠ¶æ€çš„å˜åŒ–ï¼Œä¸åˆ©äºè°ƒè¯•ã€‚å¦‚æœæ˜¯ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œç›´æ¥ä¼šæŠ›å‡ºé”™è¯¯ã€‚ å››ã€axiosaxios æ˜¯ä»€ä¹ˆ Axios æ˜¯ä¸€ä¸ªåŸºäº promise çš„ HTTP åº“ï¼Œå¯ä»¥ç”¨åœ¨æµè§ˆå™¨å’Œ node.js ä¸­ã€‚å‰ç«¯æœ€æµè¡Œçš„ ajax è¯·æ±‚åº“ï¼Œ react/vue å®˜æ–¹éƒ½æ¨èä½¿ç”¨ axios å‘ ajax è¯·æ±‚ axios ç‰¹ç‚¹ åŸºäº promise çš„å¼‚æ­¥ ajax è¯·æ±‚åº“ï¼Œæ”¯æŒ promise æ‰€æœ‰çš„ API æµè§ˆå™¨ç«¯/node ç«¯éƒ½å¯ä»¥ä½¿ç”¨ï¼Œæµè§ˆå™¨ä¸­åˆ›å»º XMLHttpRequests æ”¯æŒè¯·æ±‚ï¼å“åº”æ‹¦æˆªå™¨ æ”¯æŒè¯·æ±‚å–æ¶ˆ å¯ä»¥è½¬æ¢è¯·æ±‚æ•°æ®å’Œå“åº”æ•°æ®ï¼Œå¹¶å¯¹å“åº”å›æ¥çš„å†…å®¹è‡ªåŠ¨è½¬æ¢æˆ JSON ç±»å‹çš„æ•°æ® æ‰¹é‡å‘é€å¤šä¸ªè¯·æ±‚ å®‰å…¨æ€§æ›´é«˜ï¼Œå®¢æˆ·ç«¯æ”¯æŒé˜²å¾¡ XSRFï¼Œå°±æ˜¯è®©ä½ çš„æ¯ä¸ªè¯·æ±‚éƒ½å¸¦ä¸€ä¸ªä» cookie ä¸­æ‹¿åˆ°çš„ key, æ ¹æ®æµè§ˆå™¨åŒæºç­–ç•¥ï¼Œå‡å†’çš„ç½‘ç«™æ˜¯æ‹¿ä¸åˆ°ä½  cookie ä¸­å¾— key çš„ï¼Œè¿™æ ·ï¼Œåå°å°±å¯ä»¥è½»æ¾è¾¨åˆ«å‡ºè¿™ä¸ªè¯·æ±‚æ˜¯å¦æ˜¯ç”¨æˆ·åœ¨å‡å†’ç½‘ç«™ä¸Šçš„è¯¯å¯¼è¾“å…¥ï¼Œä»è€Œé‡‡å–æ­£ç¡®çš„ç­–ç•¥ã€‚ axios å¸¸ç”¨è¯­æ³• axios(config): é€šç”¨/æœ€æœ¬è´¨çš„å‘ä»»æ„ç±»å‹è¯·æ±‚çš„æ–¹å¼ axios(url[, config]): å¯ä»¥åªæŒ‡å®š url å‘ get è¯·æ±‚ axios.request(config): ç­‰åŒäº axios(config) axios.get(url[, config]): å‘ get è¯·æ±‚ axios.delete(url[, config]): å‘ delete è¯·æ±‚ axios.post(url[, data, config]): å‘ post è¯·æ±‚ axios.put(url[, data, config]): å‘ put è¯·æ±‚ axios.defaults.xxx: è¯·æ±‚çš„é»˜è®¤å…¨å±€é…ç½® axios.interceptors.request.use(): æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨ axios.interceptors.response.use(): æ·»åŠ å“åº”æ‹¦æˆªå™¨ axios.create([config]): åˆ›å»ºä¸€ä¸ªæ–°çš„ axios(å®ƒæ²¡æœ‰ä¸‹é¢çš„åŠŸèƒ½) axios.Cancel(): ç”¨äºåˆ›å»ºå–æ¶ˆè¯·æ±‚çš„é”™è¯¯å¯¹è±¡ axios.CancelToken(): ç”¨äºåˆ›å»ºå–æ¶ˆè¯·æ±‚çš„ token å¯¹è±¡ axios.isCancel(): æ˜¯å¦æ˜¯ä¸€ä¸ªå–æ¶ˆè¯·æ±‚çš„é”™è¯¯ axios.all(promises): ç”¨äºæ‰¹é‡æ‰§è¡Œå¤šä¸ªå¼‚æ­¥è¯·æ±‚ axios.spread(): ç”¨æ¥æŒ‡å®šæ¥æ”¶æ‰€æœ‰æˆåŠŸæ•°æ®çš„å›è°ƒå‡½æ•°çš„æ–¹æ³• axios ä¸ºä»€ä¹ˆæ—¢èƒ½åœ¨æµè§ˆå™¨ç¯å¢ƒè¿è¡Œåˆèƒ½åœ¨æœåŠ¡å™¨(node)ç¯å¢ƒè¿è¡Œï¼Ÿaxios åœ¨æµè§ˆå™¨ç«¯ä½¿ç”¨XMLHttpRequestå¯¹è±¡å‘é€ ajax è¯·æ±‚ï¼›åœ¨ node ç¯å¢ƒä½¿ç”¨httpå¯¹è±¡å‘é€ ajax è¯·æ±‚ã€‚ var defaults.adapter = getDefaultAdapter();function getDefaultAdapter () &#123; var adapter; if (typeof XMLHttpRequest !== &#x27;undefined&#x27;) &#123; // æµè§ˆå™¨ç¯å¢ƒ adapter = require(&#x27;./adapter/xhr&#x27;); &#125; else if (typeof process !== &#x27;undefined&#x27;) &#123; // nodeç¯å¢ƒ adapter = require(&#x27;./adapter/http&#x27;); &#125; return adapter;&#125; ä¸Šé¢å‡ è¡Œä»£ç ï¼Œå¯ä»¥çœ‹å‡ºï¼šXMLHttpRequest æ˜¯ä¸€ä¸ª APIï¼Œå®ƒä¸ºå®¢æˆ·ç«¯æä¾›äº†åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ è¾“æ•°æ®çš„åŠŸèƒ½ï¼›process å¯¹è±¡æ˜¯ä¸€ä¸ª global ï¼ˆå…¨å±€å˜é‡ï¼‰ï¼Œæä¾›æœ‰å…³ä¿¡æ¯ï¼Œæ§åˆ¶å½“å‰ Node.js è¿›ç¨‹ã€‚åŸæ¥ä½œè€…æ˜¯é€šè¿‡åˆ¤æ–­ XMLHttpRequest å’Œ process è¿™ä¸¤ä¸ªå…¨å±€å˜é‡æ¥åˆ¤æ–­ç¨‹åºçš„è¿è¡Œç¯å¢ƒçš„ï¼Œä»è€Œåœ¨ä¸åŒçš„ç¯å¢ƒæä¾›ä¸åŒçš„ http è¯·æ±‚æ¨¡å—ï¼Œå®ç°å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ç¨‹åºçš„å…¼å®¹ã€‚ axios ç›¸æ¯”åŸç”Ÿ ajax çš„ä¼˜ç‚¹ajax çš„ç¼ºç‚¹ æœ¬èº«æ˜¯é’ˆå¯¹ MVC çš„ç¼–ç¨‹,ä¸ç¬¦åˆç°åœ¨å‰ç«¯ MVVM çš„æµªæ½® åŸºäºåŸç”Ÿçš„ XHR å¼€å‘ï¼ŒXHR æœ¬èº«çš„æ¶æ„ä¸æ¸…æ™°ã€‚ JQuery æ•´ä¸ªé¡¹ç›®å¤ªå¤§ï¼Œå•çº¯ä½¿ç”¨ ajax å´è¦å¼•å…¥æ•´ä¸ª JQuery éå¸¸çš„ä¸åˆç†ï¼ˆé‡‡å–ä¸ªæ€§åŒ–æ‰“åŒ…çš„æ–¹æ¡ˆåˆä¸èƒ½äº«å— CDN æœåŠ¡ï¼‰ ä¸ç¬¦åˆå…³æ³¨åˆ†ç¦»ï¼ˆSeparation of Concernsï¼‰çš„åŸåˆ™ é…ç½®å’Œè°ƒç”¨æ–¹å¼éå¸¸æ··ä¹±ï¼Œè€Œä¸”åŸºäºäº‹ä»¶çš„å¼‚æ­¥æ¨¡å‹ä¸å‹å¥½ã€‚ è¯´ä¸‹ä½ äº†è§£çš„ axios ç›¸å…³é…ç½®å±æ€§ï¼Ÿ urlæ˜¯ç”¨äºè¯·æ±‚çš„æœåŠ¡å™¨ URL methodæ˜¯åˆ›å»ºè¯·æ±‚æ—¶ä½¿ç”¨çš„æ–¹æ³•,é»˜è®¤æ˜¯ get baseURLå°†è‡ªåŠ¨åŠ åœ¨urlå‰é¢ï¼Œé™¤éurlæ˜¯ä¸€ä¸ªç»å¯¹ URLã€‚å®ƒå¯ä»¥é€šè¿‡è®¾ç½®ä¸€ä¸ªbaseURLä¾¿äºä¸º axios å®ä¾‹çš„æ–¹æ³•ä¼ é€’ç›¸å¯¹ URL transformRequestå…è®¸åœ¨å‘æœåŠ¡å™¨å‘é€å‰ï¼Œä¿®æ”¹è¯·æ±‚æ•°æ®ï¼Œåªèƒ½ç”¨åœ¨â€™PUTâ€™,â€™POSTâ€™å’Œâ€™PATCHâ€™è¿™å‡ ä¸ªè¯·æ±‚æ–¹æ³• headersæ˜¯å³å°†è¢«å‘é€çš„è‡ªå®šä¹‰è¯·æ±‚å¤´headers:{â€˜X-Requested-Withâ€™:â€™XMLHttpRequestâ€™}, paramsæ˜¯å³å°†ä¸è¯·æ±‚ä¸€èµ·å‘é€çš„ URL å‚æ•°ï¼Œå¿…é¡»æ˜¯ä¸€ä¸ªæ— æ ¼å¼å¯¹è±¡(plainobject)æˆ– URLSearchParams å¯¹è±¡ params: &#123; ID: 12345;&#125; authè¡¨ç¤ºåº”è¯¥ä½¿ç”¨ HTTP åŸºç¡€éªŒè¯ï¼Œå¹¶æä¾›å‡­æ®è¿™å°†è®¾ç½®ä¸€ä¸ªAuthorizationå¤´ï¼Œè¦†å†™æ‰ç°æœ‰çš„ä»»æ„ä½¿ç”¨headersè®¾ç½®çš„è‡ªå®šä¹‰Authorizationå¤´ auth:&#123;username:&#x27;janedoe&#x27;,password:&#x27;s00pers3cret&#x27;&#125; â€˜proxyâ€™å®šä¹‰ä»£ç†æœåŠ¡å™¨çš„ä¸»æœºåç§°å’Œç«¯å£ï¼Œè¿™é‡Œçš„authè¡¨ç¤º HTTP åŸºç¡€éªŒè¯åº”å½“ç”¨äºè¿æ¥ä»£ç†ï¼Œå¹¶æä¾›å‡­æ®è¿™å°†ä¼šè®¾ç½®ä¸€ä¸ªProxy-Authorizationå¤´ï¼Œè¦†å†™æ‰å·²æœ‰çš„é€šè¿‡ä½¿ç”¨headerè®¾ç½®çš„è‡ªå®šä¹‰Proxy-Authorizationå¤´ã€‚ proxy:&#123; host:&#x27;127.0.0.1&#x27;, port:9000, auth::&#123; username:&#x27;mikeymike&#x27;, password:&#x27;rapunz3l&#x27; &#125;&#125; ä»€ä¹ˆæ˜¯ axios æ‹¦æˆªå™¨ ä»€ä¹ˆæ˜¯æ‹¦æˆªå™¨ï¼š åœ¨æˆ‘ä»¬å®é™…å‘é€è¯·æ±‚åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ä¹‹å‰è¿›è¡Œæ‹¦æˆªå¤„ç†ï¼›åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ç«¯æ­£å¼è¿”å›æ•°æ®ç»™å…·ä½“è¯·æ±‚æ–¹æ³•å‰è¿›è¡Œæ‹¦æˆªã€‚ æ•ˆæœå›¾ è¯·æ±‚æ‹¦æˆªå™¨çš„ä½œç”¨æ˜¯åœ¨è¯·æ±‚å‘é€å‰è¿›è¡Œä¸€äº›æ“ä½œï¼Œä¾‹å¦‚åœ¨æ¯ä¸ªè¯·æ±‚ä½“é‡ŒåŠ ä¸Š tokenï¼Œç»Ÿä¸€åšäº†å¤„ç†å¦‚æœä»¥åè¦æ”¹ä¹Ÿéå¸¸å®¹æ˜“ã€‚ å“åº”æ‹¦æˆªå™¨çš„ä½œç”¨æ˜¯åœ¨æ¥æ”¶åˆ°å“åº”åè¿›è¡Œä¸€äº›æ“ä½œï¼Œä¾‹å¦‚åœ¨æœåŠ¡å™¨è¿”å›ç™»å½•çŠ¶æ€å¤±æ•ˆï¼Œéœ€è¦é‡æ–°ç™»å½•çš„æ—¶å€™ï¼Œè·³è½¬åˆ°ç™»å½•é¡µç­‰ã€‚ æ‹¦æˆªå™¨å¦‚ä½•ä½¿ç”¨// æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨axios.interceptors.request.use( function (config) &#123; // åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ return config; &#125;, function (error) &#123; // å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆ return Promise.reject(error); &#125;);// æ·»åŠ å“åº”æ‹¦æˆªå™¨axios.interceptors.response.use( function (response) &#123; // å¯¹å“åº”æ•°æ®åšç‚¹ä»€ä¹ˆ return response; &#125;, function (error) &#123; // å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ return Promise.reject(error); &#125;); å¦‚ä½•åˆ›å»ºä¸€ä¸ª axios å®ä¾‹const $axios = axios.create(&#123; é…ç½®ä¿¡æ¯,&#125;);// æ³¨æ„åˆ›å»ºçš„axioså®ä¾‹å¯¹è±¡æ˜¯æ²¡æœ‰allæ–¹æ³•çš„ã€‚ axios å¤„ç† token è¿‡æœŸåå¦‚ä½•ç»§ç»­ä¹‹å‰çš„è¯·æ±‚/** * å°è£… axios è¯·æ±‚æ¨¡å— */import axios from &#x27;axios&#x27;;import store from &#x27;@/store&#x27;;import router from &#x27;@/router&#x27;;// axios.create æ–¹æ³•ï¼šå¤åˆ¶ä¸€ä¸ª axiosconst request = axios.create(&#123; baseURL: &#x27;http://xxxx.cn/&#x27;, // åŸºç¡€è·¯å¾„&#125;);// è¯·æ±‚æ‹¦æˆªå™¨ ã€æºå¸¦tokenã€‘request.interceptors.request.use( function (config) &#123; const user = store.state.user; if (user) &#123; config.headers.Authorization = `Bearer $&#123;user.token&#125;`; &#125; // Do something before request is sent return config; &#125;, function (error) &#123; // Do something with request error return Promise.reject(error); &#125;);// å“åº”æ‹¦æˆªå™¨request.interceptors.response.use( // å“åº”æˆåŠŸè¿›å…¥ç¬¬1ä¸ªå‡½æ•° // è¯¥å‡½æ•°çš„å‚æ•°æ˜¯å“åº”å¯¹è±¡ function (response) &#123; // Any status code that lie within the range of 2xx cause this function to trigger // Do something with response data return response; &#125;, // å“åº”å¤±è´¥è¿›å…¥ç¬¬2ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„å‚æ•°æ˜¯é”™è¯¯å¯¹è±¡ async function (error) &#123; // Any status codes that falls outside the range of 2xx cause this function to trigger // Do something with response error // å¦‚æœå“åº”ç æ˜¯ 401 ï¼Œåˆ™è¯·æ±‚è·å–æ–°çš„ token // å“åº”æ‹¦æˆªå™¨ä¸­çš„ error å°±æ˜¯é‚£ä¸ªå“åº”çš„é”™è¯¯å¯¹è±¡ console.dir(error); if (error.response &amp;&amp; error.response.status === 401) &#123; // æ ¡éªŒæ˜¯å¦æœ‰ refresh_token const user = store.state.user; if (!user || !user.refresh_token) &#123; router.push(&#x27;/login&#x27;); // ä»£ç ä¸è¦å¾€åæ‰§è¡Œäº† return; &#125; // å¦‚æœæœ‰refresh_tokenï¼Œåˆ™è¯·æ±‚è·å–æ–°çš„ token try &#123; const res = await axios(&#123; method: &#x27;PUT&#x27;, url: &#x27;http://xxxx/authorizations&#x27;, // æ›´æ–°tokençš„åœ°å€ headers: &#123; Authorization: `Bearer $&#123;user.refresh_token&#125;`, &#125;, &#125;); // å¦‚æœè·å–æˆåŠŸï¼Œåˆ™æŠŠæ–°çš„ token æ›´æ–°åˆ°å®¹å™¨ä¸­ console.log(&#x27;åˆ·æ–° token æˆåŠŸ&#x27;, res); store.commit(&#x27;setUser&#x27;, &#123; token: res.data.data.token, // æœ€æ–°è·å–çš„å¯ç”¨ token refresh_token: user.refresh_token, // è¿˜æ˜¯åŸæ¥çš„ refresh_token &#125;); // æŠŠä¹‹å‰å¤±è´¥çš„ç”¨æˆ·è¯·æ±‚ç»§ç»­å‘å‡ºå» // config æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«æœ¬æ¬¡å¤±è´¥è¯·æ±‚ç›¸å…³çš„é‚£äº›é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚ urlã€method éƒ½æœ‰ // return æŠŠ request çš„è¯·æ±‚ç»“æœç»§ç»­è¿”å›ç»™å‘è¯·æ±‚çš„å…·ä½“ä½ç½® return request(error.config); // ã€æ ¸å¿ƒï¼šç»§ç»­ä¹‹å‰çš„ä¸Šä¸€æ¬¡è¯·æ±‚ã€‘ &#125; catch (err) &#123; // å¦‚æœè·å–å¤±è´¥ï¼Œç›´æ¥è·³è½¬ ç™»å½•é¡µ console.log(&#x27;è¯·æ±‚åˆ·çº¿ token å¤±è´¥&#x27;, err); router.push(&#x27;/login&#x27;); &#125; &#125; return Promise.reject(error); &#125;);export default request; vue ä¸­å¦‚ä½•ä½¿ç”¨ axios å®‰è£… axios npm i axios -S vue ä¸­ä½¿ç”¨ axios ä¸€èˆ¬ä¸»è¦æ˜¯ 2 ä¸­æ–¹æ³• æ–¹æ³• 1ï¼šç›´æ¥å°† axios æˆ–è€… axios çš„å®ä¾‹æŒ‚è½½åˆ° vue çš„åŸå‹ä¸Šé¢ï¼Œè¿™æ ·åœ¨æ‰€æœ‰çš„ç»„ä»¶é‡Œé¢éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼› // main.jsä¸­æ­¤å¤„å¾ˆå¤šå…¶ä»–ä»£ç ...,import axios from &quot;axios&quot; // å¯¼å…¥const $axios = axios.create(&#123; // åˆ›å»ºaxioså®ä¾‹ baseUrl:&quot;åŸºå‡†åœ°å€&quot;, timeout:3000&#125;)Vue.prototype.$axios = $axios // æŒ‚è½½åˆ°vueåŸå‹ä¸Šé¢æ­¤å¤„å¾ˆå¤šå…¶ä»–ä»£ç ..., // ä»»æ„ç»„ä»¶ä¸­ é€šè¿‡this.$axios ç›´æ¥è·å–å®ä¾‹ç„¶åè°ƒç”¨å³å¯this.$axios.get/post(...) æ–¹æ³• 2ï¼šå°è£…å•ç‹¬çš„ axiosï¼Œä¸”å°†æ‰€æœ‰çš„æ•°æ®è¯·æ±‚ç‹¬ç«‹åˆ° api ç›®å½•ï¼Œç„¶åå°†è¯·æ±‚æ–¹æ³•ä¼ é€’åˆ°é¡µé¢ä½¿ç”¨ï¼Œå®é™…å·¥ä½œé‡Œé¢è¿™ç§ç”¨çš„æœ€å¤š åˆ›å»ºä¸€ä¸ª axios å®ä¾‹ï¼Œé…ç½®åŸºæœ¬ä¿¡æ¯ï¼Œå’Œæ‹¦æˆªå™¨ æ”¾åœ¨utils/http.js import axios from &#x27;axios&#x27;;// åˆ›å»ºä¸€ä¸ªaxioså®ä¾‹let $axios = axios.create(&#123; baseURL: &#x27;http://122.51.249.55:3000/index.php/Api/&#x27;, // åŸºå‡†å‰ç¼€åœ°å€ï¼ timeout: 3000, // è¯·æ±‚æ—¶é•¿ï¼&#125;);// æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨$axios.interceptors.request.use( function (config) &#123; return config; &#125;, function (error) &#123; // å¯¹è¯·æ±‚é”™è¯¯åšäº›ä»€ä¹ˆ return Promise.reject(error); &#125;);// æ·»åŠ å“åº”æ‹¦æˆªå™¨$axios.interceptors.response.use( function (response) &#123; // å¯¹æ•°æ®è¿›è¡Œå¤„ç† if (response.data.status == 1) &#123; return response.data.result; &#125; else &#123; alert(response.data.msg); &#125; &#125;, function (error) &#123; // å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ return Promise.reject(error); &#125;);// æš´éœ²axioså®ä¾‹ï¼export default $axios; åˆ›å»ºapi/index.js æ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œé¢çš„ä¸ºè¯·æ±‚æ•°æ®çš„æ–¹æ³•ï¼Œè¿”å› promise å¯¹è±¡ï¼Œå¯ä»¥è®©æ¨¡æ¿é‡Œé¢ç›´æ¥è¯»å–æ•°æ® // å¯¼å…¥axioså®ä¾‹import $axios from &#x27;@/utils/http&#x27;;import axios from &#x27;axios&#x27;; // å› ä¸ºaxioså®ä¾‹æ²¡æœ‰allæ–¹æ³•ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦å¯¼å…¥axios// è·å–é¦–é¡µç›¸å…³æ•°æ®export async function getIndex() &#123; let p1 = $axios.get(&#x27;/Index/favourite&#x27;); let p2 = $axios.get(&#x27;/Index/home&#x27;); return await axios.all([p1, p2]); // è¿”å›promiseå¯¹è±¡&#125;// è·å–å•†å“åˆ—è¡¨export async function getList(data) &#123; return $axios.get(&#x27;Good/list&#x27;, &#123; params: data &#125;);&#125; åœ¨ç»„ä»¶ä¸­è°ƒç”¨å°è£…çš„ä¸šåŠ¡è¯·æ±‚æ–¹æ³• import &#123; getIndex, getList &#125; from &#x27;@/common/request&#x27;; // å¯¼å…¥æ•°æ®è¯·æ±‚æ–¹æ³•export default &#123; // è¦åŠ ä¸Šasync ä¿®é¥°ç¬¦ async mounted() &#123; try &#123; this.indexdata = await getIndex(); this.list = await getList(&#123; page: 1, size: 10 &#125;); &#125; catch (err) &#123; console.log(&#x27;æ•°æ®è¯·æ±‚å‡ºé”™&#x27;); &#125; &#125;,&#125;; äº”ã€vue-clivue ç­‰å•é¡µé¢åº”ç”¨åŠå…¶ä¼˜ç¼ºç‚¹ç¼ºç‚¹ï¼š ä¸æ”¯æŒä½ç‰ˆæœ¬çš„æµè§ˆå™¨ï¼Œæœ€ä½åªæ”¯æŒåˆ° IE9ï¼›ä¸åˆ©äº SEO çš„ä¼˜åŒ–ï¼ˆå¦‚æœè¦æ”¯æŒ SEOï¼Œå»ºè®®é€šè¿‡æœåŠ¡ç«¯æ¥è¿›è¡Œæ¸²æŸ“ç»„ä»¶ï¼‰ï¼›ç¬¬ä¸€æ¬¡åŠ è½½é¦–é¡µè€—æ—¶ç›¸å¯¹é•¿ä¸€äº›ï¼›ä¸å¯ä»¥ä½¿ç”¨æµè§ˆå™¨çš„å¯¼èˆªæŒ‰é’®éœ€è¦è‡ªè¡Œå®ç°å‰è¿›ã€åé€€ã€‚ ä¼˜ç‚¹ï¼š æ— åˆ·æ–°ä½“éªŒ,æå‡äº†ç”¨æˆ·ä½“éªŒï¼›å‰ç«¯å¼€å‘ä¸å†ä»¥é¡µé¢ä¸ºå•ä½ï¼Œæ›´å¤šåœ°é‡‡ç”¨ç»„ä»¶åŒ–çš„æ€æƒ³ï¼Œä»£ç ç»“æ„å’Œç»„ç»‡æ–¹å¼æ›´åŠ è§„èŒƒåŒ–ï¼Œä¾¿äºä¿®æ”¹å’Œè°ƒæ•´ï¼›API å…±äº«ï¼ŒåŒä¸€å¥—åç«¯ç¨‹åºä»£ç ä¸ç”¨ä¿®æ”¹å°±å¯ä»¥ç”¨äº Web ç•Œé¢ã€æ‰‹æœºã€å¹³æ¿ç­‰å¤šç§å®¢æˆ·ç«¯ç”¨æˆ·ä½“éªŒå¥½ã€å¿«ï¼Œå†…å®¹çš„æ”¹å˜ä¸éœ€è¦é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ã€‚ vue-cli å¦‚ä½•å®‰è£… 2.x ç‰ˆæœ¬æ¨¡æ¿ æŸ¥çœ‹ vue-cli ç‰ˆæœ¬å· vue -Væˆ–è€…vue --versionå¦‚æœæ˜¯vueä¸æ˜¯å†…éƒ¨æ´»å¤–éƒ¨å‘½ä»¤è¯´æ˜æ ¹æœ¬æ²¡æœ‰è£…è„šæ‰‹æ¶ å®‰è£… vue-cli æœ€æ–°è„šæ‰‹æ¶ npm i @vue/cli -g // å…¨å±€å®‰è£…è„šæ‰‹æ¶ æ–°è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›® vue create é¡¹ç›®å å¦‚ä½•ç”¨æ–°è„šæ‰‹æ¶æ‹‰å–è€è„šæ‰‹æ¶æ¨¡æ¿ å®‰è£… npm install -g @vue/cli-init åˆå§‹åŒ–é¡¹ç›® // vue-cli 2.x åˆå§‹åŒ–é¡¹ç›®å‘½ä»¤vue init webpack é¡¹ç›®å å¯åŠ¨é¡¹ç›® npm run devnpm start// æ‰“åŒ…npm run build vue-cli2.x å¦‚ä½•é…ç½® lesså®‰è£…æ¨¡å— npm install less@3.9 less-loader@5.0.0 --save-dev // æ³¨æ„ç‰ˆæœ¬å·ï¼Œè¿™é‡Œå†™çš„ç‰ˆæœ¬å·å®æµ‹è¿‡æ²¡æœ‰é—®é¢˜ï¼Œç‰ˆæœ¬å¤ªé«˜å¯èƒ½ç¼–è¯‘å‡ºé”™ vue-cli2.x å¦‚ä½•é…ç½®è·¨åŸŸç„¶åconfig/index.jsé‡Œ dev: &#123; ..., proxyTable: &#123; &#x27;/api&#x27;: &#123; //ä½¿ç”¨&quot;/api&quot;æ¥ä»£æ›¿ target: &#x27;http://xxxx:xx/xx&#x27;, //æ¥å£åŸŸå changeOrigin:true, //æ”¹å˜æº pathRewrite: &#123; &#x27;^/api&#x27;: &#x27;&#x27; //è·¯å¾„é‡å†™ &#125; &#125;&#125; vue-cli2.x å¦‚ä½•è¿›è¡Œæ‰“åŒ…é…ç½® é»˜è®¤æ‰“åŒ…å‡ºæ¥çš„ index.html å’Œé™æ€èµ„æºæ–‡ä»¶æ˜¯ç»å¯¹è·¯å¾„å…³ç³»ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦ä½¿ç”¨ç›¸å¯¹è·¯å¾„å…³ç³»ï¼Œæ–¹ä¾¿éƒ¨ç½²ï¼ æ“ä½œ config/index.js build/webpack.prod.conf.js build/utils.js å…­ã€SSRä¸ƒã€å…¶ä»–vue å¸¸ç”¨ UI åº“æœ‰å“ªäº›vue å¸¸ç”¨æ’ä»¶vue é¡¹ç›®å¦‚ä½•å®ç°æƒé™ç®¡ç† æƒé™ç®¡ç†æ˜¯åŸºäº RBAC å®Œæˆçš„ï¼Œ å°±æ˜¯ä¸åŒç”¨æˆ·ä¼šæœ‰ä¸åŒçš„è§’è‰²ï¼Œæ¯ä¸ªè§’è‰²ä¼šæœ‰ä¸åŒçš„èœå•ä¿¡æ¯ï¼Œä»è€Œå†³å®šäº†æˆ‘ä»¬çš„ç”¨æˆ·èƒ½çœ‹åˆ°ä¸åŒçš„èœå•é¡µé¢ã€‚ æƒé™å‰åç«¯éƒ½è¦åšï¼šåç«¯æ˜¯åšæ¥å£è®¿é—®æƒé™ï¼Œä¿è¯æ•°æ®å®‰å…¨ï¼›å‰ç«¯åšæƒé™æ˜¯ä¿è¯ç”¨æˆ·è®¿é—®åˆ°ä¸åŒçš„é¡µé¢ï¼Œæ“ä½œä¸åŒçš„åŠŸèƒ½ã€‚ å‰ç«¯å¦‚ä½•åšï¼š æœ€æ ¸å¿ƒçš„æ˜¯è®©ä¸åŒçš„ç”¨æˆ·æœ‰ä¸åŒçš„è·¯ç”±æ˜ å°„è¡¨ï¼Œä¹Ÿå°±è§‰å¾—äº†ä»–å¯ä»¥çœ‹åˆ°ä¸åŒçš„é¡µé¢ï¼Œä¸”ä¸èƒ½è®¿é—®ä»–æ²¡æœ‰è·¯ç”±æ˜ å°„çš„é¡µé¢ã€‚ ä»£ç é€»è¾‘ï¼š ç™»å½•æˆåŠŸä¹‹åï¼Œè·å–åˆ° tokenï¼Œè·³è½¬åˆ°ç³»ç»Ÿé¦–é¡µ å¯¼èˆªå®ˆå«é‡Œé¢åˆ¤æ–­æ˜¯å¦æœ‰è§’è‰²ä¿¡æ¯ï¼Œ å¦‚æœæ²¡æœ‰å°±æ‹‰å–ç”¨æˆ·ä¿¡æ¯ï¼Œè·å–ç”¨æˆ·èµ„æ–™ï¼Œ ç»“æŸä¹‹åå†å»è¯·æ±‚è¯¥ç”¨æˆ·æ‰€å¯¹åº”çš„çš„è§’è‰²çš„ èœå•ï¼ˆè·¯ç”±ï¼‰åˆ—è¡¨ä¿¡æ¯ã€‚ æœ‰æ—¶å€™å¯èƒ½éœ€è¦å¤„ç†æˆè·¯ç”±æ˜ å°„çš„æ ¼å¼ï¼Œ å¤„ç†å®Œæˆä¹‹åï¼Œé€šè¿‡ router.addRoutesæ–¹æ³•æ·»åŠ åˆ°è·¯ç”±æ˜ å°„è¡¨é‡Œé¢ã€‚ è¿™æ ·å°±å†³å®šäº†ä¸åŒçš„ç”¨æˆ·æœ‰ä¸åŒçš„æ˜ å°„è¡¨ï¼Œè®¿é—®ä¸åŒçš„é¡µé¢ã€‚ å¦‚æœæ˜¯èŠ‚ç‚¹çº§åˆ«çš„æƒé™ç®¡ç†ï¼Œåç«¯è¿”å›è¯¥ç”¨æˆ·æ‰€å¯¹åº”è§’è‰²çš„æ‰€æœ‰å¯ä»¥æ“ä½œçš„èŠ‚ç‚¹æ ‡è¯†ç¬¦ï¼Œæˆ‘ä»¬é€šè¿‡è‡ªå®šä¹‰æŒ‡ä»¤å®ç°åˆ¤æ–­è¿™äº›æ ‡è¯†ç¬¦æ‰€å¯¹åº”çš„æŒ‰é’®æ˜¯å¦å¯ä»¥æ˜¾ç¤ºã€‚ è¯´è¯´ä½ å¯¹ SPA å•é¡µé¢çš„ç†è§£ï¼Œå®ƒçš„ä¼˜ç¼ºç‚¹åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯ä¸€ç§åªéœ€è¦å°†å•ä¸ªé¡µé¢åŠ è½½åˆ°æœåŠ¡å™¨ä¹‹ä¸­çš„ web åº”ç”¨ç¨‹åºã€‚å½“æµè§ˆå™¨å‘æœåŠ¡å™¨å‘å‡ºç¬¬ä¸€ä¸ªè¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ª index.html æ–‡ä»¶ï¼Œå®ƒæ‰€éœ€çš„ jsï¼Œcss ç­‰ä¼šåœ¨æ˜¾ç¤ºæ—¶ç»Ÿä¸€åŠ è½½ï¼Œéƒ¨åˆ†é¡µé¢æŒ‰éœ€åŠ è½½ã€‚url åœ°å€å˜åŒ–æ—¶ä¸ä¼šå‘æœåŠ¡å™¨åœ¨è¯·æ±‚é¡µé¢ï¼Œé€šè¿‡è·¯ç”±æ‰å®ç°é¡µé¢åˆ‡æ¢ã€‚ ä¼˜ç‚¹ï¼š è‰¯å¥½çš„äº¤äº’ä½“éªŒï¼Œç”¨æˆ·ä¸éœ€è¦é‡æ–°åˆ·æ–°é¡µé¢ï¼Œè·å–æ•°æ®ä¹Ÿæ˜¯é€šè¿‡ Ajax å¼‚æ­¥è·å–ï¼Œé¡µé¢æ˜¾ç¤ºæµç•…ï¼› è‰¯å¥½çš„å‰åç«¯å·¥ä½œåˆ†ç¦»æ¨¡å¼ã€‚ ç¼ºç‚¹ï¼š SEO éš¾åº¦è¾ƒé«˜ï¼Œç”±äºæ‰€æœ‰çš„å†…å®¹éƒ½åœ¨ä¸€ä¸ªé¡µé¢ä¸­åŠ¨æ€æ›¿æ¢æ˜¾ç¤ºï¼Œæ‰€ä»¥åœ¨ SEO ä¸Šå…¶æœ‰ç€å¤©ç„¶çš„å¼±åŠ¿ã€‚ é¦–å±åŠ è½½è¿‡æ…¢ï¼ˆåˆæ¬¡åŠ è½½è€—æ—¶å¤šï¼‰ SPA å•é¡µé¢çš„å®ç°æ–¹å¼æœ‰å“ªäº›ï¼Ÿ åœ¨ hash æ¨¡å¼ä¸­ï¼Œåœ¨ window ä¸Šç›‘å¬ hashchange(onhashChange) äº‹ä»¶ï¼ˆåœ°å€æ ä¸­ hash å˜åŒ–è§¦å‘ï¼‰é©±åŠ¨ç•Œé¢å˜åŒ–ï¼› åœ¨ history æ¨¡å¼ä¸­ï¼Œåœ¨ window ä¸Šç›‘å¬ popstate(onpopstate) äº‹ä»¶ï¼ˆæµè§ˆå™¨çš„å‰è¿›æˆ–åé€€æŒ‰é’®çš„ç‚¹å‡»è§¦å‘ï¼‰é©±åŠ¨ç•Œé¢å˜åŒ–ï¼Œç›‘å¬ a é“¾æ¥ç‚¹å‡»äº‹ä»¶ç”¨ history.pushStateã€history.replaceState æ–¹æ³•é©±åŠ¨ç•Œé¢å˜åŒ–ï¼›pushStateã€replaceStateä¸ä¼šè§¦å‘ popState äº‹ä»¶ ç›´æ¥åœ¨ç•Œé¢ç”¨æ˜¾ç¤ºéšè—äº‹ä»¶é©±åŠ¨ç•Œé¢å˜åŒ–ã€‚ Vue å¦‚ä½•ä¼˜åŒ–é¦–é¡µåŠ è½½é€Ÿåº¦å‡å°‘è¯·æ±‚çš„æ¬¡æ•° 1.è¯·æ±‚åˆå¹¶ï¼šå°†åŒä¸€æ—¶é—´éœ€è¦çš„ js åˆå¹¶ï¼Œç›®çš„æ˜¯èŠ‚çœ dns æŸ¥æ‰¾çš„æ—¶é—´ 2.æŒ‰éœ€åŠ è½½ 1.å•é¡µåº”ç”¨ä¸‹çš„æŒ‰ç…§è·¯ç”±çš„éœ€è¦åŠ è½½ 2.ç¼“å­˜ 3.css sprite base64 iconfont 4.cdn æ‰˜ç®¡ 5.å»¶è¿ŸåŠ è½½ï¼šå›¾ç‰‡çš„å»¶è¿ŸåŠ è½½ï¼šï¼ˆå°±æ˜¯å…ˆä¸è®¾ç½® img çš„ src å±æ€§ï¼Œç­‰åˆé€‚çš„æ—¶æœºï¼ˆæ¯”å¦‚æ»šåŠ¨ã€æ»‘åŠ¨ã€å‡ºç°åœ¨è§†çª—å†…ç­‰ï¼‰å†æŠŠå›¾ç‰‡çœŸå® url æ”¾åˆ° img çš„ src å±æ€§ä¸Šã€‚ï¼‰ js çš„å»¶è¿ŸåŠ è½½ï¼š å‡å°‘é‡ 1.ç²¾ç®€ä»£ç ï¼ˆtree-shakingï¼‰ (1)å»é™¤æ— ç”¨çš„ä»£ç  (2)è§„èŒƒäº›ä»£ç çš„æ–¹å¼ (3)å¤–éƒ¨ cdn çš„å¼•å…¥ 2.æ‡’åŠ è½½ â€”è·¯ç”±çš„æ‡’åŠ è½½ 3.å‹ç¼© â€” ï¼ˆ1ï¼‰webpack å‹ç¼© UglifyJsPlugin ï¼ˆ2ï¼‰gzip å‹ç¼© (3)å›¾ç‰‡å‹ç¼©ã€JPG ä¼˜åŒ– 4.ç¼“å­˜ http ä»£ç ï¼šâ€”æµè§ˆå™¨çš„å¼ºç¼“å­˜ï¼ˆmax-age Etagï¼‰å’Œåå•†(å¼±)ç¼“å­˜ï¼ˆlast-modifiedï¼‰ 5.ç¬¬ä¸‰æ–¹ç»„ä»¶â€”ç¬¬ä¸‰æ–¹ç»„ä»¶ä½œä¸ºå¤–éƒ¨ä¾èµ–ä½¿ç”¨ï¼Œä¼šè¢«æ‰“çˆ†è¿›ä¸šåŠ¡ä»£ç ã€‚ 6.æŒ‰éœ€åŠ è½½ â€” ï¼ˆ1ï¼‰ç¬¬ä¸‰æ–¹åº“å’Œå·¥å…·çš„æŒ‰éœ€åŠ è½½ï¼Œå¦‚ echarts ï¼ˆ2ï¼‰é€‰æ‹©æ›´ä¼˜çš„å·¥å…· day.js ä»£æ›¿ moment ï¼ˆ3ï¼‰å¯ç”¨ä»£ç æ‹†åˆ†ï¼ˆCode-splittingï¼‰åªä¼ é€ç”¨æˆ·éœ€è¦çš„ä»£ç  å‡å°‘å†…å­˜çš„æ¶ˆè€— 1.å‡å°‘å…¨å±€å˜é‡ï¼› 2.å‡å°‘å…¨å±€ç»„ä»¶ï¼› 3.å‡å°‘ dom æ“ä½œï¼Œ å‡å°‘ DOM è®¿é—®ï¼Œä½¿ç”¨äº‹ä»¶ä»£ç† css æ ·å¼æ”¾åœ¨é¡µé¢å‰é¢ å»¶è¿Ÿ js åŠ è½½ é¿å… CSS è¡¨è¾¾å¼ï¼Œé¿å…@import","updated":"2025-08-02T05:46:04.178Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"vue","slug":"vue","permalink":"https://luckyship.github.io/tags/vue/"}]},{"title":"diffç®—æ³•","date":"2021-09-12T08:18:15.000Z","path":"2021/09/12/2021-09-12-diff-calculate/","text":"Diff ç®—æ³•æ ¸å¿ƒåŸç†1ã€è®¤è¯†è™šæ‹Ÿ DOMï¼ˆVirtual DOMï¼‰æ²¡æœ‰ vue ä¹‹å‰æˆ‘ä»¬éƒ½æ˜¯ç”¨ js å’Œ jqï¼Œæ“ä½œ DOMâ€”&gt;è§†å›¾æ›´æ–° æœ‰äº† vueï¼Œæ•°æ®æ”¹å˜â€”&gt;ç”Ÿæˆè™šæ‹Ÿ DOMï¼ˆè®¡ç®—å˜æ›´ï¼‰â€”&gt;æ“ä½œçœŸå®çš„ DOMâ€”&gt;è§†å›¾æ›´æ–° çœŸå® DOMï¼š &lt;ul id=&quot;list&quot;&gt; &lt;li class=&quot;item&quot;&gt;å“ˆå“ˆ&lt;/li&gt; &lt;li class=&quot;item&quot;&gt;å‘µå‘µ&lt;/li&gt; &lt;li class=&quot;item&quot;&gt;å˜¿å˜¿&lt;/li&gt;&lt;/ul&gt; å¯¹åº”çš„è™šæ‹Ÿ DOM ä¸ºï¼š let oldVDOM = &#123; // æ—§è™šæ‹ŸDOM tagName: &#x27;ul&#x27;, // æ ‡ç­¾å props: &#123; // æ ‡ç­¾å±æ€§ id: &#x27;list&#x27; &#125;, children: [ // æ ‡ç­¾å­èŠ‚ç‚¹ &#123; tagName: &#x27;li&#x27;, props: &#123; class: &#x27;item&#x27; &#125;, children: [&#x27;å“ˆå“ˆ&#x27;] &#125;, &#123; tagName: &#x27;li&#x27;, props: &#123; class: &#x27;item&#x27; &#125;, children: [&#x27;å‘µå‘µ&#x27;] &#125;, &#123; tagName: &#x27;li&#x27;, props: &#123; class: &#x27;item&#x27; &#125;, children: [&#x27;å˜¿å˜¿&#x27;] &#125;, ]&#125; è™šæ‹Ÿ DOM ç®—æ³• = è™šæ‹Ÿ DOM + Diff ç®—æ³• å¥½å¤„ï¼šè™šæ‹Ÿ DOM ç®—æ³•æ“ä½œçœŸå® DOMï¼Œæ€§èƒ½é«˜äºç›´æ¥æ“ä½œçœŸå® DOM 2ã€ä»€ä¹ˆæ˜¯ Diff ç®—æ³• ä¸Šå›¾ä¸­ï¼Œå…¶å®åªæœ‰ä¸€ä¸ª li æ ‡ç­¾ä¿®æ”¹äº†æ–‡æœ¬ï¼Œå…¶ä»–éƒ½æ˜¯ä¸å˜çš„ï¼Œæ‰€ä»¥æ²¡å¿…è¦æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½è¦æ›´æ–°ï¼Œåªæ›´æ–°è¿™ä¸ª li æ ‡ç­¾å°±è¡Œï¼ŒDiff ç®—æ³•å°±æ˜¯æŸ¥å‡ºè¿™ä¸ª li æ ‡ç­¾çš„ç®—æ³•ã€‚ æ€»ç»“ï¼šDiff ç®—æ³•æ˜¯ä¸€ç§å¯¹æ¯”ç®—æ³•ã€‚å¯¹æ¯”ä¸¤è€…æ˜¯æ—§è™šæ‹ŸDOMå’Œæ–°è™šæ‹ŸDOMï¼Œå¯¹æ¯”å‡ºæ˜¯å“ªä¸ªè™šæ‹ŸèŠ‚ç‚¹æ›´æ”¹äº†ï¼Œæ‰¾å‡ºè¿™ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹¶åªæ›´æ–°è¿™ä¸ªè™šæ‹ŸèŠ‚ç‚¹æ‰€å¯¹åº”çš„çœŸå®èŠ‚ç‚¹ï¼Œè€Œä¸ç”¨æ›´æ–°å…¶ä»–æ•°æ®æ²¡å‘ç”Ÿæ”¹å˜çš„èŠ‚ç‚¹ï¼Œå®ç°ç²¾å‡†åœ°æ›´æ–°çœŸå® DOMï¼Œè¿›è€Œæé«˜æ•ˆç‡ã€‚ 3ã€Diff ç®—æ³•çš„åŸç†æ–°æ—§è™šæ‹Ÿ DOM å¯¹æ¯”çš„æ—¶å€™ï¼ŒDiff ç®—æ³•æ¯”è¾ƒåªä¼šåœ¨åŒå±‚çº§è¿›è¡Œ, ä¸ä¼šè·¨å±‚çº§æ¯”è¾ƒã€‚ 4ã€Diff å¯¹æ¯”æµç¨‹ å½“æ•°æ®æ”¹å˜æ—¶ï¼Œä¼šè§¦å‘setterï¼Œå¹¶ä¸”é€šè¿‡Dep.notifyå»é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…Watcherï¼Œè®¢é˜…è€…ä»¬å°±ä¼šè°ƒç”¨patchæ–¹æ³• 1ã€Data é€šè¿‡ Observer è½¬æ¢æˆäº† getter/setter çš„å½¢å¼æ¥è¿½è¸ªå˜åŒ–ã€‚ 2ã€å½“å¤–ç•Œé€šè¿‡ Watcher è¯»å–æ•°æ®æ—¶ï¼Œä¼šè§¦å‘ getter ä»è€Œå°† Watcher æ·»åŠ åˆ°ä¾èµ–ä¸­ã€‚ 3ã€å½“æ•°æ®å‘ç”Ÿäº†å˜åŒ–æ—¶ï¼Œä¼šè§¦å‘ setterï¼Œä»è€Œ Dep ä¸­çš„ä¾èµ–ï¼ˆWatcherï¼‰å‘é€é€šçŸ¥ã€‚ 4ã€Watcher æ¥æ”¶åˆ°é€šçŸ¥åï¼Œä¼šå‘å¤–ç•Œå‘é€é€šçŸ¥ï¼Œå˜åŒ–é€šçŸ¥åˆ°å¤–ç•Œåå¯èƒ½ä¼šè§¦å‘è§†å›¾æ›´æ–°ï¼Œä¹Ÿæœ‰å¯èƒ½ä¼šè§¦å‘ç”¨æˆ·è¿”å›çš„æŸä¸ªå›è°ƒå‡½æ•°ã€‚ patch æ–¹æ³•å¯¹æ¯”å½“å‰åŒå±‚çš„è™šæ‹ŸèŠ‚ç‚¹æ˜¯å¦ä¸ºåŒä¸€ç§ç±»å‹çš„æ ‡ç­¾ï¼š æ˜¯ï¼šç»§ç»­æ‰§è¡ŒpatchVnodeæ–¹æ³•è¿›è¡Œæ·±å±‚æ¯”å¯¹ å¦ï¼šæ²¡å¿…è¦æ¯”å¯¹äº†ï¼Œç›´æ¥æ•´ä¸ªèŠ‚ç‚¹æ›¿æ¢æˆæ–°è™šæ‹ŸèŠ‚ç‚¹ patchçš„æ ¸å¿ƒåŸç†ä»£ç ï¼š function patch(oldVnode, newVnode) &#123; // æ¯”è¾ƒæ˜¯å¦ä¸ºä¸€ä¸ªç±»å‹çš„èŠ‚ç‚¹ if (sameVnode(oldVnode, newVnode)) &#123; // æ˜¯ï¼šç»§ç»­è¿›è¡Œæ·±å±‚æ¯”è¾ƒ patchVnode(oldVnode, newVnode) &#125; else &#123; // å¦ const oldEl = oldVnode.el // æ—§è™šæ‹ŸèŠ‚ç‚¹çš„çœŸå®DOMèŠ‚ç‚¹ const parentEle = api.parentNode(oldEl) // è·å–çˆ¶èŠ‚ç‚¹ createEle(newVnode) // åˆ›å»ºæ–°è™šæ‹ŸèŠ‚ç‚¹å¯¹åº”çš„çœŸå®DOMèŠ‚ç‚¹ if (parentEle !== null) &#123; api.insertBefore(parentEle, vnode.el, api.nextSibling(oEl)) // å°†æ–°å…ƒç´ æ·»åŠ è¿›çˆ¶å…ƒç´  api.removeChild(parentEle, oldVnode.el) // ç§»é™¤ä»¥å‰çš„æ—§å…ƒç´ èŠ‚ç‚¹ // è®¾ç½®nullï¼Œé‡Šæ”¾å†…å­˜ oldVnode = null &#125; &#125; return newVnode&#125; sameVnode æ–¹æ³•patch å…³é”®çš„ä¸€æ­¥å°±æ˜¯sameVnodeæ–¹æ³•åˆ¤æ–­æ˜¯å¦ä¸ºåŒä¸€ç±»å‹èŠ‚ç‚¹ï¼Œ sameVnode æ–¹æ³•çš„æ ¸å¿ƒåŸç†ä»£ç ï¼š function sameVnode(oldVnode, newVnode) &#123; return ( oldVnode.key === newVnode.key &amp;&amp; // keyå€¼æ˜¯å¦ä¸€æ · oldVnode.tagName === newVnode.tagName &amp;&amp; // æ ‡ç­¾åæ˜¯å¦ä¸€æ · oldVnode.isComment === newVnode.isComment &amp;&amp; // æ˜¯å¦éƒ½ä¸ºæ³¨é‡ŠèŠ‚ç‚¹ isDef(oldVnode.data) === isDef(newVnode.data) &amp;&amp; // æ˜¯å¦éƒ½å®šä¹‰äº†data sameInputType(oldVnode, newVnode) // å½“æ ‡ç­¾ä¸ºinputæ—¶ï¼Œtypeå¿…é¡»æ˜¯å¦ç›¸åŒ )&#125; patchVnode æ–¹æ³•è¿™ä¸ªå‡½æ•°åšäº†ä»¥ä¸‹äº‹æƒ…ï¼š æ‰¾åˆ°å¯¹åº”çš„çœŸå®DOMï¼Œç§°ä¸ºel åˆ¤æ–­newVnodeå’ŒoldVnodeæ˜¯å¦æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæ˜¯ï¼Œé‚£ä¹ˆç›´æ¥return å¦‚æœä»–ä»¬éƒ½æœ‰æ–‡æœ¬èŠ‚ç‚¹å¹¶ä¸”ä¸ç›¸ç­‰ï¼Œé‚£ä¹ˆå°†elçš„æ–‡æœ¬èŠ‚ç‚¹è®¾ç½®ä¸ºnewVnodeçš„æ–‡æœ¬èŠ‚ç‚¹ã€‚ å¦‚æœoldVnodeæœ‰å­èŠ‚ç‚¹è€ŒnewVnodeæ²¡æœ‰ï¼Œåˆ™åˆ é™¤elçš„å­èŠ‚ç‚¹ å¦‚æœoldVnodeæ²¡æœ‰å­èŠ‚ç‚¹è€ŒnewVnodeæœ‰ï¼Œåˆ™å°†newVnodeçš„å­èŠ‚ç‚¹çœŸå®åŒ–ä¹‹åæ·»åŠ åˆ°el å¦‚æœä¸¤è€…éƒ½æœ‰å­èŠ‚ç‚¹ï¼Œåˆ™æ‰§è¡ŒupdateChildrenå‡½æ•°æ¯”è¾ƒå­èŠ‚ç‚¹ï¼Œè¿™ä¸€æ­¥å¾ˆé‡è¦ function patchVnode(oldVnode, newVnode) &#123; const el = newVnode.el = oldVnode.el // è·å–çœŸå®DOMå¯¹è±¡ // è·å–æ–°æ—§è™šæ‹ŸèŠ‚ç‚¹çš„å­èŠ‚ç‚¹æ•°ç»„ const oldCh = oldVnode.children, newCh = newVnode.children // å¦‚æœæ–°æ—§è™šæ‹ŸèŠ‚ç‚¹æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™ç»ˆæ­¢ if (oldVnode === newVnode) return // å¦‚æœæ–°æ—§è™šæ‹ŸèŠ‚ç‚¹æ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼Œä¸”æ–‡æœ¬ä¸ä¸€æ · if (oldVnode.text !== null &amp;&amp; newVnode.text !== null &amp;&amp; oldVnode.text !== newVnode.text) &#123; // åˆ™ç›´æ¥å°†çœŸå®DOMä¸­æ–‡æœ¬æ›´æ–°ä¸ºæ–°è™šæ‹ŸèŠ‚ç‚¹çš„æ–‡æœ¬ api.setTextContent(el, newVnode.text) &#125; else &#123; // å¦åˆ™ if (oldCh &amp;&amp; newCh &amp;&amp; oldCh !== newCh) &#123; // æ–°æ—§è™šæ‹ŸèŠ‚ç‚¹éƒ½æœ‰å­èŠ‚ç‚¹ï¼Œä¸”å­èŠ‚ç‚¹ä¸ä¸€æ · // å¯¹æ¯”å­èŠ‚ç‚¹ï¼Œå¹¶æ›´æ–° updateChildren(el, oldCh, newCh) &#125; else if (newCh) &#123; // æ–°è™šæ‹ŸèŠ‚ç‚¹æœ‰å­èŠ‚ç‚¹ï¼Œæ—§è™šæ‹ŸèŠ‚ç‚¹æ²¡æœ‰ // åˆ›å»ºæ–°è™šæ‹ŸèŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼Œå¹¶æ›´æ–°åˆ°çœŸå®DOMä¸Šå» createEle(newVnode) &#125; else if (oldCh) &#123; // æ—§è™šæ‹ŸèŠ‚ç‚¹æœ‰å­èŠ‚ç‚¹ï¼Œæ–°è™šæ‹ŸèŠ‚ç‚¹æ²¡æœ‰ //ç›´æ¥åˆ é™¤çœŸå®DOMé‡Œå¯¹åº”çš„å­èŠ‚ç‚¹ api.removeChild(el) &#125; &#125;&#125; updateChildren æ–¹æ³•updateChildren çš„æ ¸å¿ƒåŸç†ä»£ç ï¼š function updateChildren(parentElm, oldCh, newCh) &#123; let oldStartIdx = 0, newStartIdx = 0 let oldEndIdx = oldCh.length - 1 let oldStartVnode = oldCh[0] let oldEndVnode = oldCh[oldEndIdx] let newEndIdx = newCh.length - 1 let newStartVnode = newCh[0] let newEndVnode = newCh[newEndIdx] let oldKeyToIdx let idxInOld let elmToMove let before while (oldStartIdx &lt;= oldEndIdx &amp;&amp; newStartIdx &lt;= newEndIdx) &#123; if (oldStartVnode == null) &#123; oldStartVnode = oldCh[++oldStartIdx] &#125; else if (oldEndVnode == null) &#123; oldEndVnode = oldCh[--oldEndIdx] &#125; else if (newStartVnode == null) &#123; newStartVnode = newCh[++newStartIdx] &#125; else if (newEndVnode == null) &#123; newEndVnode = newCh[--newEndIdx] &#125; else if (sameVnode(oldStartVnode, newStartVnode)) &#123; patchVnode(oldStartVnode, newStartVnode) oldStartVnode = oldCh[++oldStartIdx] newStartVnode = newCh[++newStartIdx] &#125; else if (sameVnode(oldEndVnode, newEndVnode)) &#123; patchVnode(oldEndVnode, newEndVnode) oldEndVnode = oldCh[--oldEndIdx] newEndVnode = newCh[--newEndIdx] &#125; else if (sameVnode(oldStartVnode, newEndVnode)) &#123; patchVnode(oldStartVnode, newEndVnode) api.insertBefore(parentElm, oldStartVnode.el, api.nextSibling(oldEndVnode.el)) oldStartVnode = oldCh[++oldStartIdx] newEndVnode = newCh[--newEndIdx] &#125; else if (sameVnode(oldEndVnode, newStartVnode)) &#123; patchVnode(oldEndVnode, newStartVnode) api.insertBefore(parentElm, oldEndVnode.el, oldStartVnode.el) oldEndVnode = oldCh[--oldEndIdx] newStartVnode = newCh[++newStartIdx] &#125; else &#123; // ä½¿ç”¨keyæ—¶çš„æ¯”è¾ƒ if (oldKeyToIdx === undefined) &#123; oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx) // æœ‰keyç”Ÿæˆindexè¡¨ &#125; idxInOld = oldKeyToIdx[newStartVnode.key] if (!idxInOld) &#123; api.insertBefore(parentElm, createEle(newStartVnode).el, oldStartVnode.el) newStartVnode = newCh[++newStartIdx] &#125; else &#123; elmToMove = oldCh[idxInOld] if (elmToMove.sel !== newStartVnode.sel) &#123; api.insertBefore(parentElm, createEle(newStartVnode).el, oldStartVnode.el) &#125; else &#123; patchVnode(elmToMove, newStartVnode) oldCh[idxInOld] = null api.insertBefore(parentElm, elmToMove.el, oldStartVnode.el) &#125; newStartVnode = newCh[++newStartIdx] &#125; &#125; &#125; if (oldStartIdx &gt; oldEndIdx) &#123; before = newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].el addVnodes(parentElm, before, newCh, newStartIdx, newEndIdx) &#125; else if (newStartIdx &gt; newEndIdx) &#123; removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx) &#125;&#125; é¦–å°¾æŒ‡é’ˆæ³•ï¼š ä¼šè¿›è¡Œäº’ç›¸è¿›è¡Œæ¯”è¾ƒï¼Œæ€»å…±æœ‰äº”ç§æ¯”è¾ƒæƒ…å†µï¼š 1ã€oldS å’Œ newS ä½¿ç”¨sameVnodeæ–¹æ³•è¿›è¡Œæ¯”è¾ƒï¼ŒsameVnode(oldS, newS) 2ã€oldS å’Œ newE ä½¿ç”¨sameVnodeæ–¹æ³•è¿›è¡Œæ¯”è¾ƒï¼ŒsameVnode(oldS, newE) 3ã€oldE å’Œ newS ä½¿ç”¨sameVnodeæ–¹æ³•è¿›è¡Œæ¯”è¾ƒï¼ŒsameVnode(oldE, newS) 4ã€oldE å’Œ newE ä½¿ç”¨sameVnodeæ–¹æ³•è¿›è¡Œæ¯”è¾ƒï¼ŒsameVnode(oldE, newE) 5ã€å¦‚æœä»¥ä¸Šé€»è¾‘éƒ½åŒ¹é…ä¸åˆ°ï¼Œå†æŠŠæ‰€æœ‰æ—§å­èŠ‚ç‚¹çš„ key åšä¸€ä¸ªæ˜ å°„åˆ°æ—§èŠ‚ç‚¹ä¸‹æ ‡çš„ key -&gt; index è¡¨ï¼Œç„¶åç”¨æ–° vnode çš„ key å»æ‰¾å‡ºåœ¨æ—§èŠ‚ç‚¹ä¸­å¯ä»¥å¤ç”¨çš„ä½ç½®ã€‚ å›¾ä¾‹æ¯”è¾ƒï¼š ç¬¬ä¸€æ­¥ï¼šoldS å’Œ newE ç›¸ç­‰ï¼Œéœ€è¦æŠŠèŠ‚ç‚¹aç§»åŠ¨åˆ°newEæ‰€å¯¹åº”çš„ä½ç½®ï¼Œä¹Ÿå°±æ˜¯æœ«å°¾ ç¬¬äºŒæ­¥ï¼šoldS å’Œ newSç›¸ç­‰ï¼Œéœ€è¦æŠŠèŠ‚ç‚¹bç§»åŠ¨åˆ°newSæ‰€å¯¹åº”çš„ä½ç½® ç¬¬ä¸‰æ­¥ï¼šoldSã€oldE å’Œ newSç›¸ç­‰ï¼Œéœ€è¦æŠŠèŠ‚ç‚¹cç§»åŠ¨åˆ°newSæ‰€å¯¹åº”çš„ä½ç½® ç¬¬å››æ­¥ï¼šoldChå…ˆéå†å®Œæˆäº†ï¼Œè€ŒnewChè¿˜æ²¡éå†å®Œï¼Œè¯´æ˜newChæ¯”oldChå¤šï¼Œæ‰€ä»¥éœ€è¦å°†å¤šå‡ºæ¥çš„èŠ‚ç‚¹ï¼Œæ’å…¥åˆ°çœŸå® DOM ä¸Šå¯¹åº”çš„ä½ç½®ä¸Š å¦‚æœoldChæ¯”newChå¤šçš„è¯ï¼Œé‚£å°±æ˜¯newChå…ˆèµ°å®Œå¾ªç¯ï¼Œç„¶åoldChä¼šæœ‰å¤šå‡ºçš„èŠ‚ç‚¹ï¼Œç»“æœä¼šåœ¨çœŸå® DOM é‡Œè¿›è¡Œåˆ é™¤è¿™äº›æ—§èŠ‚ç‚¹ã€‚5ã€ä¸ºä»€ä¹ˆä¸å»ºè®®ç”¨ index ä½œä¸ºå¾ªç¯é¡¹çš„ key aï¼Œbï¼Œcä¸‰ä¸ªliæ ‡ç­¾éƒ½æ˜¯å¤ç”¨ä¹‹å‰çš„ï¼Œå› ä¸ºä»–ä»¬ä¸‰ä¸ªæ ¹æœ¬æ²¡æ”¹å˜ï¼Œæ”¹å˜çš„åªæ˜¯å‰é¢æ–°å¢äº†ä¸€ä¸ªæ—ä¸‰å¿ƒ åœ¨è¿›è¡Œå­èŠ‚ç‚¹çš„ diffç®—æ³• è¿‡ç¨‹ä¸­ï¼Œä¼šè¿›è¡Œ æ—§é¦–èŠ‚ç‚¹å’Œæ–°é¦–èŠ‚ç‚¹çš„sameNodeå¯¹æ¯”ï¼Œè¿™ä¸€æ­¥å‘½ä¸­äº†é€»è¾‘ï¼Œå› ä¸ºç°åœ¨æ–°æ—§ä¸¤æ¬¡é¦–éƒ¨èŠ‚ç‚¹ çš„ key éƒ½æ˜¯ 0äº†ï¼ŒåŒç†ï¼Œkey ä¸º 1 å’Œ 2 çš„ä¹Ÿæ˜¯å‘½ä¸­äº†é€»è¾‘ï¼Œå¯¼è‡´ç›¸åŒkeyçš„èŠ‚ç‚¹ä¼šå»è¿›è¡ŒpatchVnodeæ›´æ–°æ–‡æœ¬ï¼Œè€ŒåŸæœ¬å°±æœ‰çš„cèŠ‚ç‚¹ï¼Œå´å› ä¸ºä¹‹å‰æ²¡æœ‰ key ä¸º 4 çš„èŠ‚ç‚¹ï¼Œè€Œè¢«å½“åšäº†æ–°èŠ‚ç‚¹ï¼Œæ‰€ä»¥ä½¿ç”¨ index åš keyï¼Œæœ€åæ–°å¢çš„å±…ç„¶æ˜¯æœ¬æ¥å°±å·²æœ‰çš„ c èŠ‚ç‚¹ã€‚æ‰€ä»¥å‰ä¸‰ä¸ªéƒ½è¿›è¡ŒpatchVnodeæ›´æ–°æ–‡æœ¬ï¼Œæœ€åä¸€ä¸ªè¿›è¡Œäº†æ–°å¢ï¼Œé‚£å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆæ‰€æœ‰ li æ ‡ç­¾éƒ½æ›´æ–°äº†ã€‚ æˆ‘ä»¬åªè¦ä½¿ç”¨ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„å€¼ id æ¥å½“åš key å°±è¡Œäº†ã€‚","updated":"2025-08-02T05:46:04.177Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"vue","slug":"vue","permalink":"https://luckyship.github.io/tags/vue/"},{"name":"react","slug":"react","permalink":"https://luckyship.github.io/tags/react/"}]},{"title":"å‰–æcommonjsä¸es module","date":"2021-09-05T01:12:00.000Z","path":"2021/09/05/2021-09-05-commonjs-es-module/","text":"å‰è¨€ä»Šå¤©æˆ‘ä»¬æ¥æ·±åº¦åˆ†æä¸€ä¸‹ Commonjs å’Œ Es Moduleï¼Œå¸Œæœ›é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œèƒ½å¤Ÿè®©å¤§å®¶å½»åº•æ˜ç™½ Commonjs å’Œ Es Module åŸç†ï¼Œèƒ½å¤Ÿä¸€æ¬¡æ€§æå®šé¢è¯•ä¸­é‡åˆ°çš„å¤§éƒ¨åˆ†æœ‰å…³ Commonjs å’Œ Es Module çš„é—®é¢˜ã€‚ è€è§„çŸ©æˆ‘ä»¬å¸¦ä¸Šç–‘é—®å¼€å§‹ä»Šå¤©çš„åˆ†æ ğŸ¤”ğŸ¤”ğŸ¤”ï¼š Commonjs å’Œ Es Module æœ‰ä»€ä¹ˆåŒºåˆ« ï¼Ÿ Commonjs å¦‚ä½•è§£å†³çš„å¾ªç¯å¼•ç”¨é—®é¢˜ ï¼Ÿ æ—¢ç„¶æœ‰äº† exportsï¼Œä¸ºä½•åˆå‡ºäº† module.exports? æ—¢ç”Ÿç‘œï¼Œä½•ç”Ÿäº® ï¼Ÿ require æ¨¡å—æŸ¥æ‰¾æœºåˆ¶ ï¼Ÿ Es Module å¦‚ä½•è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ ï¼Ÿ exports = &#123;&#125; è¿™ç§å†™æ³•ä¸ºä½•æ— æ•ˆ ï¼Ÿ å…³äº import() çš„åŠ¨æ€å¼•å…¥ ï¼Ÿ Es Module å¦‚ä½•æ”¹å˜æ¨¡å—ä¸‹çš„ç§æœ‰å˜é‡ ï¼Ÿ â€¦ æ¨¡å—åŒ–æ—©æœŸ JavaScript å¼€å‘å¾ˆå®¹æ˜“å­˜åœ¨å…¨å±€æ±¡æŸ“å’Œä¾èµ–ç®¡ç†æ··ä¹±é—®é¢˜ã€‚è¿™äº›é—®é¢˜åœ¨å¤šäººå¼€å‘å‰ç«¯åº”ç”¨çš„æƒ…å†µä¸‹å˜å¾—æ›´åŠ æ£˜æ‰‹ã€‚æˆ‘è¿™é‡Œä¾‹ä¸¾ä¸€ä¸ªå¾ˆå¸¸è§çš„åœºæ™¯ï¼š &lt;body&gt; &lt;script src=&quot;./index.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;./home.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;./list.js&quot;&gt;&lt;/script&gt;&lt;/body&gt; å¦‚ä¸Šåœ¨æ²¡æœ‰æ¨¡å—åŒ–çš„å‰æä¸‹ï¼Œå¦‚æœåœ¨ html ä¸­è¿™ä¹ˆå†™ï¼Œé‚£ä¹ˆå°±ä¼šæš´éœ²ä¸€ç³»åˆ—é—®é¢˜ã€‚ å…¨å±€æ±¡æŸ“æ²¡æœ‰æ¨¡å—åŒ–ï¼Œé‚£ä¹ˆ script å†…éƒ¨çš„å˜é‡æ˜¯å¯ä»¥ç›¸äº’æ±¡æŸ“çš„ã€‚æ¯”å¦‚æœ‰ä¸€ç§åœºæ™¯ï¼Œå¦‚ä¸Š ./index.js æ–‡ä»¶å’Œ ./list.js æ–‡ä»¶ä¸ºå° A å¼€å‘çš„ï¼Œ./home.js ä¸ºå° B å¼€å‘çš„ã€‚ å° A åœ¨ index.jsä¸­å£°æ˜ name å±æ€§æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ var name = &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;; ç„¶åå° A åœ¨ list.js ä¸­ï¼Œå¼•ç”¨ name å±æ€§ï¼Œ console.log(name); // Æ’ name()&#123;&#125; æ‰“å°å´å‘ç° name ç«Ÿç„¶å˜æˆäº†ä¸€ä¸ªå‡½æ•°ã€‚åˆšå¼€å§‹å° A ä¸çŸ¥æ‰€æªï¼Œåæ¥å‘ç°åœ¨å° B å¼€å‘çš„ home.js æ–‡ä»¶ä¸­è¿™ä¹ˆå†™é“ï¼š function name() &#123; //...&#125; è€Œä¸”è¿™ä¸ª name æ–¹æ³•è¢«å¼•ç”¨äº†å¤šæ¬¡ï¼Œå¯¼è‡´ä¸€ç³»åˆ—çš„è¿é”ååº”ã€‚ ä¸Šè¿°ä¾‹å­å°±æ˜¯æ²¡æœ‰ä½¿ç”¨æ¨¡å—åŒ–å¼€å‘ï¼Œé€ æˆçš„å…¨å±€æ±¡æŸ“çš„é—®é¢˜ï¼Œæ¯ä¸ªåŠ è½½çš„ js æ–‡ä»¶éƒ½å…±äº«å˜é‡ã€‚å½“ç„¶åœ¨å®é™…çš„é¡¹ç›®å¼€å‘ä¸­ï¼Œå¯ä»¥ä½¿ç”¨åŒ¿åå‡½æ•°è‡ªæ‰§è¡Œçš„æ–¹å¼ï¼Œå½¢æˆç‹¬ç«‹çš„å—çº§ä½œç”¨åŸŸè§£å†³è¿™ä¸ªé—®é¢˜ã€‚ åªéœ€è¦åœ¨ home.js ä¸­è¿™ä¹ˆå†™é“ï¼š (function () &#123; function name() &#123; //... &#125;&#125;)(); è¿™æ ·å° A å°±èƒ½æ­£å¸¸åœ¨ list.js ä¸­è·å– name å±æ€§ã€‚ä½†æ˜¯è¿™åªæ˜¯ä¸€ä¸ª demo ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯åœ¨å®é™…å¼€å‘ä¸­æƒ…å†µä¼šæ›´åŠ å¤æ‚ã€‚æ‰€ä»¥ä¸ä½¿ç”¨æ¨¡å—å¼€å‘ä¼šæš´éœ²å‡ºå¾ˆå¤šé£é™©ã€‚ æ‰€ä»¥å°±éœ€è¦æ¨¡å—åŒ–æ¥è§£å†³ä¸Šè¿°çš„é—®é¢˜ï¼Œä»Šå¤©æˆ‘ä»¬å°±é‡ç‚¹è®²è§£ä¸€ä¸‹å‰ç«¯æ¨¡å—åŒ–çš„ä¸¤ä¸ªé‡è¦æ–¹æ¡ˆï¼šCommonjs å’Œ Es Module CommonjsCommonjs çš„æå‡ºï¼Œå¼¥è¡¥ Javascript å¯¹äºæ¨¡å—åŒ–ï¼Œæ²¡æœ‰ç»Ÿä¸€æ ‡å‡†çš„ç¼ºé™·ã€‚nodejs å€Ÿé‰´äº† Commonjs çš„ Module ï¼Œå®ç°äº†è‰¯å¥½çš„æ¨¡å—åŒ–ç®¡ç†ã€‚ ç›®å‰ commonjs å¹¿æ³›åº”ç”¨äºä»¥ä¸‹å‡ ä¸ªåœºæ™¯ï¼š Node æ˜¯ CommonJS åœ¨æœåŠ¡å™¨ç«¯ä¸€ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„å®ç°ï¼› Browserify æ˜¯ CommonJS åœ¨æµè§ˆå™¨ä¸­çš„ä¸€ç§å®ç°ï¼› webpack æ‰“åŒ…å·¥å…·å¯¹ CommonJS çš„æ”¯æŒå’Œè½¬æ¢ï¼›ä¹Ÿå°±æ˜¯å‰ç«¯åº”ç”¨ä¹Ÿå¯ä»¥åœ¨ç¼–è¯‘ä¹‹å‰ï¼Œå°½æƒ…ä½¿ç”¨CommonJS è¿›è¡Œå¼€å‘ã€‚ commonjs ä½¿ç”¨ä¸åŸç†åœ¨ä½¿ç”¨ è§„èŒƒä¸‹ï¼Œæœ‰å‡ ä¸ªæ˜¾è‘—çš„ç‰¹ç‚¹ã€‚ åœ¨ commonjs ä¸­æ¯ä¸€ä¸ª js æ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸º moduleï¼› è¯¥æ¨¡å—ä¸­ï¼ŒåŒ…å« CommonJS è§„èŒƒçš„æ ¸å¿ƒå˜é‡: exportsã€module.exportsã€requireï¼› exports å’Œ module.exports å¯ä»¥è´Ÿè´£å¯¹æ¨¡å—ä¸­çš„å†…å®¹è¿›è¡Œå¯¼å‡ºï¼› require å‡½æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¯¼å…¥å…¶ä»–æ¨¡å—ï¼ˆè‡ªå®šä¹‰æ¨¡å—ã€ç³»ç»Ÿæ¨¡å—ã€ç¬¬ä¸‰æ–¹åº“æ¨¡å—ï¼‰ä¸­çš„å†…å®¹ï¼› commonjs ä½¿ç”¨åˆä½“éªŒæˆ‘ä»¬å…ˆå°è¯•è¿™å¯¼å‡ºä¸€ä¸ªæ¨¡å—ï¼šhello.jsä¸­ let name = &quot;aaa&quot;;module.exports = function sayName() &#123; return name;&#125;; å¯¼å…¥ï¼šæ¥ä¸‹æ¥ç®€å•çš„å¯¼å…¥ï¼š home.js const sayName = require(&quot;./hello.js&quot;);module.exports = function say() &#123; return &#123; name: sayName(), author: &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;, &#125;;&#125;; å¦‚ä¸Šå°±æ˜¯ Commonjs æœ€ç®€å•çš„å®ç°ï¼Œé‚£ä¹ˆæš´éœ²å‡ºä¸¤ä¸ªé—®é¢˜ï¼š å¦‚ä½•è§£å†³å˜é‡æ±¡æŸ“çš„é—®é¢˜ã€‚ module.exportsï¼Œexportsï¼Œrequire ä¸‰è€…æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿåˆæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ commonjs å®ç°åŸç†é¦–å…ˆä»ä¸Šè¿°å¾—çŸ¥æ¯ä¸ªæ¨¡å—æ–‡ä»¶ä¸Šå­˜åœ¨ moduleï¼Œexportsï¼Œrequire ä¸‰ä¸ªå˜é‡ï¼Œç„¶è€Œè¿™ä¸‰ä¸ªå˜é‡æ˜¯æ²¡æœ‰è¢«å®šä¹‰çš„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨ Commonjs è§„èŒƒä¸‹æ¯ä¸€ä¸ª js æ¨¡å—ä¸Šç›´æ¥ä½¿ç”¨å®ƒä»¬ã€‚åœ¨ nodejs ä¸­è¿˜å­˜åœ¨ **filename å’Œ **dirname å˜é‡ã€‚ å¦‚ä¸Šæ¯ä¸€ä¸ªå˜é‡ä»£è¡¨ä»€ä¹ˆæ„æ€å‘¢ï¼š module è®°å½•å½“å‰æ¨¡å—ä¿¡æ¯ã€‚ require å¼•å…¥æ¨¡å—çš„æ–¹æ³•ã€‚ exports å½“å‰æ¨¡å—å¯¼å‡ºçš„å±æ€§ åœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­ï¼Œå®é™… Commonjs å¯¹ js çš„ä»£ç å—è¿›è¡Œäº†é¦–å°¾åŒ…è£…ï¼Œ æˆ‘ä»¬ä»¥ä¸Šè¿°çš„ home.js ä¸ºä¾‹å­ ğŸŒ°ï¼Œå®ƒè¢«åŒ…è£…ä¹‹åçš„æ ·å­å¦‚ä¸‹ï¼š (function (exports, require, module, __filename, __dirname) &#123; const sayName = require(&quot;./hello.js&quot;); module.exports = function say() &#123; return &#123; name: sayName(), author: &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;, &#125;; &#125;;&#125;); åœ¨ Commonjs è§„èŒƒä¸‹æ¨¡å—ä¸­ï¼Œä¼šå½¢æˆä¸€ä¸ªåŒ…è£…å‡½æ•°ï¼Œæˆ‘ä»¬å†™çš„ä»£ç å°†ä½œä¸ºåŒ…è£…å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä½¿ç”¨çš„ require ï¼Œexports ï¼Œmodule æœ¬è´¨ä¸Šæ˜¯é€šè¿‡å½¢å‚çš„æ–¹å¼ä¼ é€’åˆ°åŒ…è£…å‡½æ•°ä¸­çš„ã€‚ é‚£ä¹ˆåŒ…è£…å‡½æ•°æœ¬è´¨ä¸Šæ˜¯ä»€ä¹ˆæ ·å­çš„å‘¢ï¼Ÿ function wrapper(script) &#123; return &quot;(function (exports, require, module, __filename, __dirname) &#123;&quot; + script + &quot;\\n&#125;)&quot;;&#125; åŒ…è£…å‡½æ•°æ‰§è¡Œã€‚ const modulefunction = wrapper(` const sayName = require(&#x27;./hello.js&#x27;) module.exports = function say()&#123; return &#123; name:sayName(), author:&#x27;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&#x27; &#125; &#125;`); å¦‚ä¸Šæ¨¡æ‹Ÿäº†ä¸€ä¸ªåŒ…è£…å‡½æ•°åŠŸèƒ½ï¼Œ script ä¸ºæˆ‘ä»¬åœ¨ js æ¨¡å—ä¸­å†™çš„å†…å®¹ï¼Œæœ€åè¿”å›çš„å°±æ˜¯å¦‚ä¸ŠåŒ…è£…ä¹‹åçš„å‡½æ•°ã€‚å½“ç„¶è¿™ä¸ªå‡½æ•°æš‚ä¸”æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ runInThisContext(modulefunction)(module.exports, require, module, __filename, __dirname); åœ¨æ¨¡å—åŠ è½½çš„æ—¶å€™ï¼Œä¼šé€šè¿‡ runInThisContext (å¯ä»¥ç†è§£æˆ eval ) æ‰§è¡Œ modulefunction ï¼Œä¼ å…¥require ï¼Œexports ï¼Œmodule ç­‰å‚æ•°ã€‚æœ€ç»ˆæˆ‘ä»¬å†™çš„ nodejs æ–‡ä»¶å°±è¿™ä¹ˆæ‰§è¡Œäº†ã€‚ åˆ°æ­¤ä¸ºæ­¢ï¼Œå®Œæˆäº†æ•´ä¸ªæ¨¡å—æ‰§è¡Œçš„åŸç†ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†æä»¥ä¸‹ require æ–‡ä»¶åŠ è½½çš„æµç¨‹ã€‚ require æ–‡ä»¶åŠ è½½æµç¨‹ä¸Šè¿°è¯´äº† commonjs è§„èŒƒå¤§è‡´çš„å®ç°åŸç†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æä¸€ä¸‹ï¼Œ require å¦‚ä½•è¿›è¡Œæ–‡ä»¶çš„åŠ è½½çš„ã€‚ æˆ‘ä»¬è¿˜æ˜¯ä»¥ nodejs ä¸ºå‚è€ƒï¼Œæ¯”å¦‚å¦‚ä¸‹ä»£ç ç‰‡æ®µä¸­ï¼š const fs = require(&quot;fs&quot;); // â‘ æ ¸å¿ƒæ¨¡å—const sayName = require(&quot;./hello.js&quot;); //â‘¡ æ–‡ä»¶æ¨¡å—const crypto = require(&quot;crypto-js&quot;); // â‘¢ç¬¬ä¸‰æ–¹è‡ªå®šä¹‰æ¨¡å— å¦‚ä¸Šä»£ç ç‰‡æ®µä¸­ï¼š â‘  ä¸º nodejs åº•å±‚çš„æ ¸å¿ƒæ¨¡å—ã€‚ â‘¡ ä¸ºæˆ‘ä»¬ç¼–å†™çš„æ–‡ä»¶æ¨¡å—ï¼Œæ¯”å¦‚ä¸Šè¿° sayName â‘¢ ä¸ºæˆ‘ä»¬é€šè¿‡ npm ä¸‹è½½çš„ç¬¬ä¸‰æ–¹è‡ªå®šä¹‰æ¨¡å—ï¼Œæ¯”å¦‚ crypto-jsã€‚ å½“ require æ–¹æ³•æ‰§è¡Œçš„æ—¶å€™ï¼Œæ¥æ”¶çš„å”¯ä¸€å‚æ•°ä½œä¸ºä¸€ä¸ªæ ‡è¯†ç¬¦ ï¼ŒCommonjs ä¸‹å¯¹ä¸åŒçš„æ ‡è¯†ç¬¦ï¼Œå¤„ç†æµç¨‹ä¸åŒï¼Œä½†æ˜¯ç›®çš„ç›¸åŒï¼Œéƒ½æ˜¯æ‰¾åˆ°å¯¹åº”çš„æ¨¡å—ã€‚ require åŠ è½½æ ‡è¯†ç¬¦åŸåˆ™é¦–å…ˆæˆ‘ä»¬çœ‹ä¸€ä¸‹ nodejs ä¸­å¯¹æ ‡è¯†ç¬¦çš„å¤„ç†åŸåˆ™ã€‚ é¦–å…ˆåƒ fs ï¼Œhttp ï¼Œpath ç­‰æ ‡è¯†ç¬¦ï¼Œä¼šè¢«ä½œä¸º nodejs çš„æ ¸å¿ƒæ¨¡å—ã€‚ ./ å’Œ ../ ä½œä¸ºç›¸å¯¹è·¯å¾„çš„æ–‡ä»¶æ¨¡å—ï¼Œ / ä½œä¸ºç»å¯¹è·¯å¾„çš„æ–‡ä»¶æ¨¡å—ã€‚ éè·¯å¾„å½¢å¼ä¹Ÿéæ ¸å¿ƒæ¨¡å—çš„æ¨¡å—ï¼Œå°†ä½œä¸ºè‡ªå®šä¹‰æ¨¡å—ã€‚ æ ¸å¿ƒæ¨¡å—çš„å¤„ç†ï¼šæ ¸å¿ƒæ¨¡å—çš„ä¼˜å…ˆçº§ä»…æ¬¡äºç¼“å­˜åŠ è½½ï¼Œåœ¨ Node æºç ç¼–è¯‘ä¸­ï¼Œå·²è¢«ç¼–è¯‘æˆäºŒè¿›åˆ¶ä»£ç ï¼Œæ‰€ä»¥åŠ è½½æ ¸å¿ƒæ¨¡å—ï¼ŒåŠ è½½è¿‡ç¨‹ä¸­é€Ÿåº¦æœ€å¿«ã€‚ è·¯å¾„å½¢å¼çš„æ–‡ä»¶æ¨¡å—å¤„ç†ï¼šå·² ./ ï¼Œ../ å’Œ / å¼€å§‹çš„æ ‡è¯†ç¬¦ï¼Œä¼šè¢«å½“ä½œæ–‡ä»¶æ¨¡å—å¤„ç†ã€‚require() æ–¹æ³•ä¼šå°†è·¯å¾„è½¬æ¢æˆçœŸå®è·¯å¾„ï¼Œå¹¶ä»¥çœŸå®è·¯å¾„ä½œä¸ºç´¢å¼•ï¼Œå°†ç¼–è¯‘åçš„ç»“æœç¼“å­˜èµ·æ¥ï¼Œç¬¬äºŒæ¬¡åŠ è½½çš„æ—¶å€™ä¼šæ›´å¿«ã€‚è‡³äºæ€ä¹ˆç¼“å­˜çš„ï¼Ÿæˆ‘ä»¬ç¨åä¼šè®²åˆ°ã€‚ è‡ªå®šä¹‰æ¨¡å—å¤„ç†ï¼šè‡ªå®šä¹‰æ¨¡å—ï¼Œä¸€èˆ¬æŒ‡çš„æ˜¯éæ ¸å¿ƒçš„æ¨¡å—ï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªæ–‡ä»¶æˆ–è€…ä¸€ä¸ªåŒ…ï¼Œå®ƒçš„æŸ¥æ‰¾ä¼šéµå¾ªä»¥ä¸‹åŸåˆ™ï¼š åœ¨å½“å‰ç›®å½•ä¸‹çš„ node_modules ç›®å½•æŸ¥æ‰¾ã€‚ å¦‚æœæ²¡æœ‰ï¼Œåœ¨çˆ¶çº§ç›®å½•çš„ node_modules æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰åœ¨çˆ¶çº§ç›®å½•çš„çˆ¶çº§ç›®å½•çš„ node_modules ä¸­æŸ¥- æ‰¾ã€‚ æ²¿ç€è·¯å¾„å‘ä¸Šé€’å½’ï¼Œç›´åˆ°æ ¹ç›®å½•ä¸‹çš„ node_modules ç›®å½•ã€‚ åœ¨æŸ¥æ‰¾è¿‡ç¨‹ä¸­ï¼Œä¼šæ‰¾ package.json ä¸‹ main å±æ€§æŒ‡å‘çš„æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰ package.json ï¼Œåœ¨ node ç¯å¢ƒä¸‹ä¼šä»¥æ­¤æŸ¥æ‰¾ index.js ï¼Œindex.json ï¼Œindex.nodeã€‚ require æ¨¡å—å¼•å…¥ä¸å¤„ç†CommonJS æ¨¡å—åŒæ­¥åŠ è½½å¹¶æ‰§è¡Œæ¨¡å—æ–‡ä»¶ï¼ŒCommonJS æ¨¡å—åœ¨æ‰§è¡Œé˜¶æ®µåˆ†ææ¨¡å—ä¾èµ–ï¼Œé‡‡ç”¨æ·±åº¦ä¼˜å…ˆéå†ï¼ˆdepth-first traversalï¼‰ï¼Œæ‰§è¡Œé¡ºåºæ˜¯çˆ¶ -&gt; å­ -&gt; çˆ¶ï¼› ä¸ºäº†ææ¸…é™¤ require æ–‡ä»¶å¼•å…¥æµç¨‹ã€‚æˆ‘ä»¬æ¥ä¸‹æ¥å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œè¿™é‡Œæ³¨æ„ä¸€ä¸‹ç»†èŠ‚ï¼š a.jsæ–‡ä»¶ const getMes = require(&quot;./b&quot;);console.log(&quot;æˆ‘æ˜¯ a æ–‡ä»¶&quot;);exports.say = function () &#123; const message = getMes(); console.log(message);&#125;; b.jsæ–‡ä»¶ const say = require(&quot;./a&quot;);const object = &#123; name: &quot;aaaa&quot;, author: &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;,&#125;;console.log(&quot;æˆ‘æ˜¯ b æ–‡ä»¶&quot;);module.exports = function () &#123; return object;&#125;; ä¸»æ–‡ä»¶main.js const a = require(&quot;./a&quot;);const b = require(&quot;./b&quot;);console.log(&quot;node å…¥å£æ–‡ä»¶&quot;); æ¥ä¸‹æ¥ç»ˆç«¯è¾“å…¥ node main.js è¿è¡Œ main.jsï¼Œæ•ˆæœå¦‚ä¸‹ï¼š $ node main.jsæˆ‘æ˜¯ b æ–‡ä»¶æˆ‘æ˜¯ a æ–‡ä»¶node å…¥å£æ–‡ä»¶ ä»ä¸Šé¢çš„è¿è¡Œç»“æœå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š main.js å’Œ a.js æ¨¡å—éƒ½å¼•ç”¨äº† b.js æ¨¡å—ï¼Œä½†æ˜¯ b.js æ¨¡å—åªæ‰§è¡Œäº†ä¸€æ¬¡ã€‚a.js æ¨¡å— å’Œ b.js æ¨¡å—äº’ç›¸å¼•ç”¨ï¼Œä½†æ˜¯æ²¡æœ‰é€ æˆå¾ªç¯å¼•ç”¨çš„æƒ…å†µã€‚æ‰§è¡Œé¡ºåºæ˜¯çˆ¶ -&gt; å­ -&gt; çˆ¶ï¼›é‚£ä¹ˆ Common.js è§„èŒƒæ˜¯å¦‚ä½•å®ç°ä¸Šè¿°æ•ˆæœçš„å‘¢ï¼Ÿ require åŠ è½½åŸç†é¦–å…ˆä¸ºäº†å¼„æ¸…æ¥šä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬è¦æ˜ç™½ä¸¤ä¸ªæ„Ÿå¿µï¼Œé‚£å°±æ˜¯ module å’Œ Moduleã€‚ module ï¼šåœ¨ Node ä¸­æ¯ä¸€ä¸ª js æ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ª module ï¼Œmodule ä¸Šä¿å­˜äº† exports ç­‰ä¿¡æ¯ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ª loaded è¡¨ç¤ºè¯¥æ¨¡å—æ˜¯å¦è¢«åŠ è½½ã€‚ ä¸º false è¡¨ç¤ºè¿˜æ²¡æœ‰åŠ è½½ï¼›ä¸º true è¡¨ç¤ºå·²ç»åŠ è½½Module ï¼šä»¥ nodejs ä¸ºä¾‹ï¼Œæ•´ä¸ªç³»ç»Ÿè¿è¡Œä¹‹åï¼Œä¼šç”¨ Module ç¼“å­˜æ¯ä¸€ä¸ªæ¨¡å—åŠ è½½çš„ä¿¡æ¯ã€‚ require çš„æºç å¤§è‡´é•¿å¦‚ä¸‹çš„æ ·å­ï¼š // id ä¸ºè·¯å¾„æ ‡è¯†ç¬¦function require(id) &#123; /* æŸ¥æ‰¾ Module ä¸Šæœ‰æ²¡æœ‰å·²ç»åŠ è½½çš„ js å¯¹è±¡*/ const cachedModule = Module._cache[id] /* å¦‚æœå·²ç»åŠ è½½äº†é‚£ä¹ˆç›´æ¥å–èµ°ç¼“å­˜çš„ exports å¯¹è±¡ */ if(cachedModule)&#123; return cachedModule.exports &#125; /* åˆ›å»ºå½“å‰æ¨¡å—çš„ module */ const module = &#123; exports: &#123;&#125; ,loaded: false , ...&#125; /* å°† module ç¼“å­˜åˆ° Module çš„ç¼“å­˜å±æ€§ä¸­ï¼Œè·¯å¾„æ ‡è¯†ç¬¦ä½œä¸º id */ Module._cache[id] = module /* åŠ è½½æ–‡ä»¶ */ runInThisContext(wrapper(&#x27;module.exports = &quot;123&quot;&#x27;))(module.exports, require, module, __filename, __dirname) /* åŠ è½½å®Œæˆ *// module.loaded = true /* è¿”å›å€¼ */ return module.exports&#125; ä»ä¸Šé¢æˆ‘ä»¬æ€»ç»“å‡ºä¸€æ¬¡ require å¤§è‡´æµç¨‹æ˜¯è¿™æ ·çš„ï¼› require ä¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°â€”â€”æ–‡ä»¶æ ‡è¯†ç¬¦ï¼Œç„¶ååˆ†æå®šä½æ–‡ä»¶ï¼Œåˆ†æè¿‡ç¨‹æˆ‘ä»¬ä¸Šè¿°å·²ç»è®²åˆ°äº†ï¼ŒåŠ ä¸‹æ¥ä¼šä» Module ä¸ŠæŸ¥æ‰¾æœ‰æ²¡æœ‰ç¼“å­˜ï¼Œå¦‚æœæœ‰ç¼“å­˜ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›ç¼“å­˜çš„å†…å®¹ã€‚ å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œä¼šåˆ›å»ºä¸€ä¸ª module å¯¹è±¡ï¼Œç¼“å­˜åˆ° Module ä¸Šï¼Œç„¶åæ‰§è¡Œæ–‡ä»¶ï¼ŒåŠ è½½å®Œæ–‡ä»¶ï¼Œå°† loaded å±æ€§è®¾ç½®ä¸º true ï¼Œç„¶åè¿”å› module.exports å¯¹è±¡ã€‚å€Ÿæ­¤å®Œæˆæ¨¡å—åŠ è½½æµç¨‹ã€‚ æ¨¡å—å¯¼å‡ºå°±æ˜¯ return è¿™ä¸ªå˜é‡çš„å…¶å®è·Ÿ a = b èµ‹å€¼ä¸€æ ·ï¼Œ åŸºæœ¬ç±»å‹å¯¼å‡ºçš„æ˜¯å€¼ï¼Œ å¼•ç”¨ç±»å‹å¯¼å‡ºçš„æ˜¯å¼•ç”¨åœ°å€ã€‚ exports å’Œ module.exports æŒæœ‰ç›¸åŒå¼•ç”¨ï¼Œå› ä¸ºæœ€åå¯¼å‡ºçš„æ˜¯ module.exportsï¼Œ æ‰€ä»¥å¯¹ exports è¿›è¡Œèµ‹å€¼ä¼šå¯¼è‡´ exports æ“ä½œçš„ä¸å†æ˜¯ module.exports çš„å¼•ç”¨ã€‚ require é¿å…é‡å¤åŠ è½½ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥ç›´æ¥å¾—å‡ºï¼Œrequire å¦‚ä½•é¿å…é‡å¤åŠ è½½çš„ï¼Œé¦–å…ˆåŠ è½½ä¹‹åçš„æ–‡ä»¶çš„ module ä¼šè¢«ç¼“å­˜åˆ° Module ä¸Šï¼Œæ¯”å¦‚ä¸€ä¸ªæ¨¡å—å·²ç» require å¼•å…¥äº† a æ¨¡å—ï¼Œå¦‚æœå¦å¤–ä¸€ä¸ªæ¨¡å—å†æ¬¡å¼•ç”¨ a ï¼Œé‚£ä¹ˆä¼šç›´æ¥è¯»å–ç¼“å­˜å€¼ module ï¼Œæ‰€ä»¥æ— éœ€å†æ¬¡æ‰§è¡Œæ¨¡å—ã€‚ å¯¹åº” demo ç‰‡æ®µä¸­ï¼Œé¦–å…ˆ main.js å¼•ç”¨äº† a.js ï¼Œa.js ä¸­ require äº† b.js æ­¤æ—¶ b.js çš„ module æ”¾å…¥ç¼“å­˜ Module ä¸­ï¼Œæ¥ä¸‹æ¥ main.js å†æ¬¡å¼•ç”¨ b.js ï¼Œé‚£ä¹ˆç›´æ¥èµ°çš„ç¼“å­˜é€»è¾‘ã€‚æ‰€ä»¥ b.js åªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯åœ¨ a.js å¼•å…¥çš„æ—¶å€™ã€‚ require é¿å…å¾ªç¯å¼•ç”¨é‚£ä¹ˆæ¥ä¸‹æ¥è¿™ä¸ªå¾ªç¯å¼•ç”¨é—®é¢˜ï¼Œä¹Ÿå°±å¾ˆå®¹æ˜“è§£å†³äº†ã€‚ä¸ºäº†è®©å¤§å®¶æ›´æ¸…æ™°æ˜ç™½ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥ä¸€èµ·åˆ†ææ•´ä¸ªæµç¨‹ã€‚ â‘  é¦–å…ˆæ‰§è¡Œ node main.js ï¼Œé‚£ä¹ˆå¼€å§‹æ‰§è¡Œç¬¬ä¸€è¡Œ require(a.js)ï¼› â‘¡ é‚£ä¹ˆé¦–å…ˆåˆ¤æ–­ a.js æœ‰æ²¡æœ‰ç¼“å­˜ï¼Œå› ä¸ºæ²¡æœ‰ç¼“å­˜ï¼Œå…ˆåŠ å…¥ç¼“å­˜ï¼Œç„¶åæ‰§è¡Œæ–‡ä»¶ a.js ï¼ˆéœ€è¦æ³¨æ„ æ˜¯å…ˆåŠ å…¥ç¼“å­˜ï¼Œ åæ‰§è¡Œæ¨¡å—å†…- å®¹ï¼‰; â‘¢ a.js ä¸­æ‰§è¡Œç¬¬ä¸€è¡Œï¼Œå¼•ç”¨ b.jsã€‚ â‘£ é‚£ä¹ˆåˆ¤æ–­ b.js æœ‰æ²¡æœ‰ç¼“å­˜ï¼Œå› ä¸ºæ²¡æœ‰ç¼“å­˜ï¼Œæ‰€ä»¥åŠ å…¥ç¼“å­˜ï¼Œç„¶åæ‰§è¡Œ b.js æ–‡ä»¶ã€‚ â‘¤ b.js æ‰§è¡Œç¬¬ä¸€è¡Œï¼Œå†ä¸€æ¬¡å¾ªç¯å¼•ç”¨ require(a.js) æ­¤æ—¶çš„ a.js å·²ç»åŠ å…¥ç¼“å­˜ï¼Œç›´æ¥è¯»å–å€¼ã€‚æ¥ä¸‹æ¥æ‰“å° console.log(&#39;æˆ‘- æ˜¯ b æ–‡ä»¶&#39;)ï¼Œå¯¼å‡ºæ–¹æ³•ã€‚ â‘¥ b.js æ‰§è¡Œå®Œæ¯•ï¼Œå›åˆ° a.js æ–‡ä»¶ï¼Œæ‰“å° console.log(&#39;æˆ‘æ˜¯ a æ–‡ä»¶&#39;)ï¼Œå¯¼å‡ºæ–¹æ³•ã€‚ â‘¦ æœ€åå›åˆ° main.jsï¼Œæ‰“å° console.log(&#39;node å…¥å£æ–‡ä»¶&#39;) å®Œæˆè¿™ä¸ªæµç¨‹ã€‚ä¸è¿‡è¿™é‡Œæˆ‘ä»¬è¦æ³¨æ„é—®é¢˜ï¼š å¦‚ä¸Šç¬¬ â‘¤ çš„æ—¶å€™ï¼Œå½“æ‰§è¡Œ b.js æ¨¡å—çš„æ—¶å€™ï¼Œå› ä¸º a.js è¿˜æ²¡æœ‰å¯¼å‡º say æ–¹æ³•ï¼Œæ‰€ä»¥ b.js åŒæ­¥ä¸Šä¸‹æ–‡ä¸­ï¼Œè·å–ä¸åˆ° sayã€‚ ä¸ºäº†è¿›ä¸€æ­¥éªŒè¯ä¸Šé¢æ‰€è¯´çš„ï¼Œæˆ‘ä»¬æ”¹é€ ä¸€ä¸‹ b.js å¦‚ä¸‹: const say = require(&quot;./a&quot;);const object = &#123; name: &quot;aaa&quot;, author: &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;,&#125;;console.log(&quot;æˆ‘æ˜¯ b æ–‡ä»¶&quot;);console.log(&quot;æ‰“å° a æ¨¡å—&quot;, say);setTimeout(() =&gt; &#123; console.log(&quot;å¼‚æ­¥æ‰“å° a æ¨¡å—&quot;, say);&#125;, 0);module.exports = function () &#123; return object;&#125;; æ‰“å°ç»“æœï¼š $ node main.jsæˆ‘æ˜¯ b æ–‡ä»¶æ‰“å° a æ¨¡å—æˆ‘æ˜¯ a æ–‡ä»¶node å…¥å£æ–‡ä»¶å¼‚æ­¥æ‰“å° a æ¨¡å— ç¬¬ä¸€æ¬¡æ‰“å° say ä¸ºç©ºå¯¹è±¡ã€‚ ç¬¬äºŒæ¬¡æ‰“å° say æ‰çœ‹åˆ° b.js å¯¼å‡ºçš„æ–¹æ³•ã€‚ é‚£ä¹ˆå¦‚ä½•è·å–åˆ° say å‘¢ï¼Œæœ‰ä¸¤ç§åŠæ³•ï¼š ä¸€æ˜¯ç”¨åŠ¨æ€åŠ è½½ a.js çš„æ–¹æ³•ï¼Œé©¬ä¸Šå°±ä¼šè®²åˆ°ã€‚ äºŒä¸ªå°±æ˜¯å¦‚ä¸Šæ”¾åœ¨å¼‚æ­¥ä¸­åŠ è½½ã€‚ æˆ‘ä»¬æ³¨æ„åˆ° a.js æ˜¯ç”¨ exports.say æ–¹å¼å¯¼å‡ºçš„ï¼Œå¦‚æœa.jsç”¨ module.exports ç»“æœä¼šæœ‰æ‰€ä¸åŒã€‚è‡³äºæœ‰ä»€ä¹ˆä¸åŒï¼Œä¸ºä»€ä¹ˆï¼Ÿæˆ‘æ¥ä¸‹æ¥ä¼šè®²åˆ°ã€‚ require åŠ¨æ€åŠ è½½ä¸Šè¿°æˆ‘ä»¬è®²äº† require æŸ¥æ‰¾æ–‡ä»¶å’ŒåŠ è½½æµç¨‹ã€‚æ¥ä¸‹æ¥ä»‹ç» commonjs è§„èŒƒä¸‹çš„ require çš„å¦å¤–ä¸€ä¸ªç‰¹æ€§â€”â€”åŠ¨æ€åŠ è½½ã€‚ require å¯ä»¥åœ¨ä»»æ„çš„ä¸Šä¸‹æ–‡ï¼ŒåŠ¨æ€åŠ è½½æ¨¡å—ã€‚æˆ‘å¯¹ä¸Šè¿° a.js ä¿®æ”¹ã€‚ a.js console.log(&quot;æˆ‘æ˜¯ a æ–‡ä»¶&quot;);exports.say = function () &#123; const getMes = require(&quot;./b&quot;); const message = getMes(); console.log(message);&#125;; main.js const a = require(&quot;./a&quot;);a.say(); å¦‚ä¸Šåœ¨ a.js æ¨¡å—çš„ say å‡½æ•°ä¸­ï¼Œç”¨ require åŠ¨æ€åŠ è½½ b.js æ¨¡å—ã€‚ç„¶åæ‰§è¡Œåœ¨ main.js ä¸­æ‰§è¡Œ a.js æ¨¡å—çš„ say æ–¹æ³•ã€‚ æ‰“å°ç»“æœå¦‚ä¸‹ï¼š $ node main.js&#123; name: &#x27;aaa&#x27;, author: &#x27;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&#x27; &#125; exports å°±æ˜¯ä¼ å…¥åˆ°å½“å‰æ¨¡å—å†…çš„ä¸€ä¸ªå¯¹è±¡ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ module.exportsã€‚ é—®é¢˜ï¼šä¸ºä»€ä¹ˆ exports=&#123;&#125; ç›´æ¥èµ‹å€¼ä¸€ä¸ªå¯¹è±¡å°±ä¸å¯ä»¥å‘¢ï¼Ÿ æ¯”å¦‚æˆ‘ä»¬å°†å¦‚ä¸Š a.js ä¿®æ”¹ä¸€ä¸‹ï¼š exports = &#123; name: &quot;asd&quot;, author: &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;, say() &#123; console.log(666); &#125;,&#125;; æ‰“å°ç»“æœï¼š $ node main.js&#123;&#125; ç†æƒ³æƒ…å†µä¸‹æ˜¯é€šè¿‡ exports = &#123;&#125; ç›´æ¥èµ‹å€¼ï¼Œä¸éœ€è¦åœ¨ exports.a = xxx æ¯ä¸€ä¸ªå±æ€§ï¼Œä½†æ˜¯å¦‚ä¸Šæˆ‘ä»¬çœ‹åˆ°äº†è¿™ç§æ–¹å¼æ˜¯æ— æ•ˆçš„ã€‚ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿå®é™…è¿™ä¸ªæ˜¯ js æœ¬èº«çš„ç‰¹æ€§å†³å®šçš„ã€‚ é€šè¿‡ä¸Šè¿°è®²è§£éƒ½çŸ¥é“ exports ï¼Œ module å’Œ require ä½œä¸ºå½¢å‚çš„æ–¹å¼ä¼ å…¥åˆ° js æ¨¡å—ä¸­ã€‚æˆ‘ä»¬ç›´æ¥ exports = &#123;&#125; ä¿®æ”¹ exports ï¼Œç­‰äºé‡æ–°èµ‹å€¼äº†å½¢å‚ï¼Œé‚£ä¹ˆä¼šé‡æ–°èµ‹å€¼ä¸€ä»½ï¼Œä½†æ˜¯ä¸ä¼šåœ¨å¼•ç”¨åŸæ¥çš„å½¢å‚ã€‚ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ function wrap(myExports) &#123; myExports = &#123; name: &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;, &#125;;&#125;let myExports = &#123; name: &quot;alien&quot;,&#125;;wrap(myExports);console.log(myExports); æ‰“å°ï¼š $ node main.js&#123; name: &#x27;alien&#x27; &#125; æˆ‘ä»¬æœŸæœ›ä¿®æ”¹ myExports ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚ å‡è®¾ wrap å°±æ˜¯ Commonjs è§„èŒƒä¸‹çš„åŒ…è£…å‡½æ•°ï¼Œæˆ‘ä»¬çš„ js ä»£ç å°±æ˜¯åŒ…è£…å‡½æ•°å†…éƒ¨çš„å†…å®¹ã€‚å½“æˆ‘ä»¬æŠŠ myExports å¯¹è±¡ä¼ è¿›å»ï¼Œä½†æ˜¯ç›´æ¥èµ‹å€¼ myExports = &#123; name:&#39;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&#39; &#125; æ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œç›¸ç­‰äºå†…éƒ¨é‡æ–°å£°æ˜ä¸€ä»½ myExports è€Œå’Œå¤–ç•Œçš„ myExports æ–­ç»äº†å…³ç³»ã€‚æ‰€ä»¥è§£é‡Šäº†ä¸ºä»€ä¹ˆä¸èƒ½ exports=&#123;...&#125; ç›´æ¥èµ‹å€¼ã€‚ é‚£ä¹ˆè§£å†³ä¸Šè¿°ä¹Ÿå®¹æ˜“ï¼Œåªéœ€è¦å‡½æ•°ä¸­åƒ exports.name è¿™ä¹ˆå†™å°±å¯ä»¥äº†ã€‚ function wrap(myExports) &#123; myExports.name = &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;;&#125; æ‰“å°: $ node main.js&#123; name: &#x27;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&#x27; &#125; module.exports ä½¿ç”¨module.exports æœ¬è´¨ä¸Šå°±æ˜¯ exports ï¼Œæˆ‘ä»¬ç”¨ module.exports æ¥å®ç°å¦‚ä¸Šçš„å¯¼å‡ºã€‚ module.exports = &#123; name: &quot;aaa&quot;, author: &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;, say() &#123; console.log(666); &#125;,&#125;; module.exports ä¹Ÿå¯ä»¥å•ç‹¬å¯¼å‡ºä¸€ä¸ªå‡½æ•°æˆ–è€…ä¸€ä¸ªç±»ã€‚æ¯”å¦‚å¦‚ä¸‹ï¼š module.exports = function () &#123; // ...&#125;; ä»ä¸Šè¿° require åŸç†å®ç°ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº† exports å’Œ module.exports æŒæœ‰ç›¸åŒå¼•ç”¨ï¼Œå› ä¸ºæœ€åå¯¼å‡ºçš„æ˜¯ module.exports ã€‚é‚£ä¹ˆè¿™å°±è¯´æ˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬æœ€å¥½é€‰æ‹© exports å’Œ module.exports ä¸¤è€…ä¹‹ä¸€ï¼Œå¦‚æœä¸¤è€…åŒæ—¶å­˜åœ¨ï¼Œå¾ˆå¯èƒ½ä¼šé€ æˆè¦†ç›–çš„æƒ…å†µå‘ç”Ÿã€‚æ¯”å¦‚å¦‚ä¸‹æƒ…å†µï¼š exports.name = &quot;alien&quot;; // æ­¤æ—¶ exports.name æ˜¯æ— æ•ˆçš„module.exports = &#123; name: &quot;aaa&quot;, author: &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;, say() &#123; console.log(666); &#125;,&#125;; ä¸Šè¿°æƒ…å†µä¸‹ exports.name æ— æ•ˆï¼Œä¼šè¢« module.exports è¦†ç›–ã€‚ Q &amp; A1 é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Ÿæ—¢ç„¶æœ‰äº† exportsï¼Œä¸ºä½•åˆå‡ºäº† module.exports? ç­”ï¼šå¦‚æœæˆ‘ä»¬ä¸æƒ³åœ¨ commonjs ä¸­å¯¼å‡ºå¯¹è±¡ï¼Œè€Œæ˜¯åªå¯¼å‡ºä¸€ä¸ªç±»æˆ–è€…ä¸€ä¸ªå‡½æ•°å†æˆ–è€…å…¶ä»–å±æ€§çš„æƒ…å†µï¼Œé‚£ä¹ˆ module.exports å°±æ›´æ–¹ä¾¿äº†ï¼Œå¦‚ä¸Šæˆ‘ä»¬çŸ¥é“ exports ä¼šè¢«åˆå§‹åŒ–æˆä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åªèƒ½åœ¨å¯¹è±¡ä¸Šç»‘å®šå±æ€§ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡ module.exports è‡ªå®šä¹‰å¯¼å‡ºå‡ºå¯¹è±¡å¤–çš„å…¶ä»–ç±»å‹å…ƒç´ ã€‚ let a = 1;module.exports = a; // å¯¼å‡ºå‡½æ•°module.exports = [1, 2, 3]; // å¯¼å‡ºæ•°ç»„module.exports = function () &#123;&#125;; //å¯¼å‡ºæ–¹æ³• 2 ä¸ exports ç›¸æ¯”ï¼Œmodule.exports æœ‰ä»€ä¹ˆç¼ºé™· ï¼Ÿ ç­”ï¼šmodule.exports å½“å¯¼å‡ºä¸€äº›å‡½æ•°ç­‰éå¯¹è±¡å±æ€§çš„æ—¶å€™ï¼Œä¹Ÿæœ‰ä¸€äº›é£é™©ï¼Œå°±æ¯”å¦‚å¾ªç¯å¼•ç”¨çš„æƒ…å†µä¸‹ã€‚å¯¹è±¡ä¼šä¿ç•™ç›¸åŒçš„å†…å­˜åœ°å€ï¼Œå°±ç®—ä¸€äº›å±æ€§æ˜¯åç»‘å®šçš„ï¼Œä¹Ÿèƒ½é—´æ¥é€šè¿‡å¼‚æ­¥å½¢å¼è®¿é—®åˆ°ã€‚ä½†æ˜¯å¦‚æœ module.exports ä¸ºä¸€ä¸ªéå¯¹è±¡å…¶ä»–å±æ€§ç±»å‹ï¼Œåœ¨å¾ªç¯å¼•ç”¨çš„æ—¶å€™ï¼Œå°±å®¹æ˜“é€ æˆå±æ€§ä¸¢å¤±çš„æƒ…å†µå‘ç”Ÿäº†ã€‚ Es ModuleNodejs å€Ÿé‰´äº† Commonjs å®ç°äº†æ¨¡å—åŒ– ï¼Œä» ES6 å¼€å§‹ï¼Œ JavaScript æ‰çœŸæ­£æ„ä¹‰ä¸Šæœ‰è‡ªå·±çš„æ¨¡å—åŒ–è§„èŒƒï¼Œ Es Module çš„äº§ç”Ÿæœ‰å¾ˆå¤šä¼˜åŠ¿ï¼Œæ¯”å¦‚: å€ŸåŠ© Es Module çš„é™æ€å¯¼å…¥å¯¼å‡ºçš„ä¼˜åŠ¿ï¼Œå®ç°äº† tree shakingã€‚ Es Module è¿˜å¯ä»¥ import() æ‡’åŠ è½½æ–¹å¼å®ç°ä»£ç åˆ†å‰²ã€‚ åœ¨ Es Module ä¸­ç”¨ export ç”¨æ¥å¯¼å‡ºæ¨¡å—ï¼Œimport ç”¨æ¥å¯¼å…¥æ¨¡å—ã€‚ä½†æ˜¯ export é…åˆ import ä¼šæœ‰å¾ˆå¤šç§ç»„åˆæƒ…å†µï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬é€ä¸€åˆ†æä¸€ä¸‹ã€‚ å¯¼å‡º export å’Œå¯¼å…¥ importæ‰€æœ‰é€šè¿‡ export å¯¼å‡ºçš„å±æ€§ï¼Œåœ¨ import ä¸­å¯ä»¥é€šè¿‡ç»“æ„çš„æ–¹å¼ï¼Œè§£æ„å‡ºæ¥ã€‚ export æ­£å¸¸å¯¼å‡ºï¼Œimport å¯¼å…¥å¯¼å‡ºæ¨¡å—ï¼ša.js const name = &quot;aaa&quot;;const author = &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;;export &#123; name, author &#125;;export const say = function () &#123; console.log(&quot;hello , world&quot;);&#125;; å¯¼å…¥æ¨¡å—ï¼šmain.js // name , author , say å¯¹åº” a.js ä¸­çš„ name , author , sayimport &#123; name, author, say &#125; from &quot;./a.js&quot;; export &#123; &#125;ï¼Œ ä¸å˜é‡åç»‘å®šï¼Œå‘½åå¯¼å‡ºã€‚ import &#123; &#125; from &#39;module&#39;ï¼Œ å¯¼å…¥ module çš„å‘½åå¯¼å‡º ï¼Œmodule ä¸ºå¦‚ä¸Šçš„ ./a.js è¿™ç§æƒ…å†µä¸‹ import &#123; &#125; å†…éƒ¨çš„å˜é‡åç§°ï¼Œè¦ä¸ export &#123; &#125; å®Œå…¨åŒ¹é…ã€‚ é»˜è®¤å¯¼å‡º export defaultå¯¼å‡ºæ¨¡å—ï¼ša.js const name = &quot;aaa&quot;;const author = &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;;const say = function () &#123; console.log(&quot;hello , world&quot;);&#125;;export default &#123; name, author, say,&#125;; å¯¼å…¥æ¨¡å—ï¼šmain.js import mes from &quot;./a.js&quot;;console.log(mes); //&#123; name: &#x27;aaa&#x27;,author:&#x27;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&#x27;, say:Function &#125; export default anything å¯¼å…¥ module çš„é»˜è®¤å¯¼å‡ºã€‚anything å¯ä»¥æ˜¯å‡½æ•°ï¼Œå±æ€§æ–¹æ³•ï¼Œæˆ–è€…å¯¹è±¡ã€‚ å¯¹äºå¼•å…¥é»˜è®¤å¯¼å‡ºçš„æ¨¡å—ï¼Œimport anyName from &#39;module&#39;ï¼Œ anyName å¯ä»¥æ˜¯è‡ªå®šä¹‰åç§°ã€‚ æ··åˆå¯¼å…¥ï½œå¯¼å‡ºES6 module å¯ä»¥ä½¿ç”¨ export default å’Œ export å¯¼å…¥å¤šä¸ªå±æ€§ã€‚ å¯¼å‡ºæ¨¡å—ï¼ša.js export const name = &quot;aaa&quot;;export const author = &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;;export default function say() &#123; console.log(&quot;hello , world&quot;);&#125; å¯¼å…¥æ¨¡å—ï¼šmain.js ä¸­æœ‰å‡ ç§å¯¼å…¥æ–¹å¼ï¼š ç¬¬ä¸€ç§ï¼š import theSay, &#123; name, author as bookAuthor &#125; from &quot;./a.js&quot;;console.log( theSay, // Æ’ say() &#123;console.log(&#x27;hello , world&#x27;) &#125; name, // &quot;aaa&quot; bookAuthor // &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;); ç¬¬äºŒç§ï¼š import theSay, * as mes from &quot;./a&quot;;console.log( theSay, // Æ’ say() &#123; console.log(&#x27;hello , world&#x27;) &#125; mes // &#123; name:&#x27;aaa&#x27; , author: &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot; ï¼Œdefault: Æ’ say() &#123; console.log(&#x27;hello , world&#x27;) &#125; &#125;); å¯¼å‡ºçš„å±æ€§è¢«åˆå¹¶åˆ° mes å±æ€§ä¸Šï¼Œ export è¢«å¯¼å…¥åˆ°å¯¹åº”çš„å±æ€§ä¸Šï¼Œexport default å¯¼å‡ºå†…å®¹è¢«ç»‘å®šåˆ° default å±æ€§ä¸Šã€‚theSay ä¹Ÿå¯ä»¥ä½œä¸ºè¢« export default å¯¼å‡ºå±æ€§ã€‚ é‡å±åå¯¼å…¥import &#123; bookName as name, say, bookAuthor as author &#125; from &quot;module&quot;;console.log(bookName, bookAuthor, say); //aaa æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº ä» module æ¨¡å—ä¸­å¼•å…¥ name ï¼Œå¹¶é‡å‘½åä¸º bookName ï¼Œä» module æ¨¡å—ä¸­å¼•å…¥ author ï¼Œå¹¶é‡å‘½åä¸º bookAuthorã€‚ç„¶ååœ¨å½“å‰æ¨¡å—ä¸‹ï¼Œä½¿ç”¨è¢«é‡å‘½åçš„åå­—ã€‚ é‡å®šå‘å¯¼å‡ºå¯ä»¥æŠŠå½“å‰æ¨¡å—ä½œä¸ºä¸€ä¸ªä¸­è½¬ç«™ï¼Œä¸€æ–¹é¢å¼•å…¥ module å†…çš„å±æ€§ï¼Œç„¶åæŠŠå±æ€§å†ç»™å¯¼å‡ºå»ã€‚ export * from &#x27;module&#x27; // ç¬¬ä¸€ç§æ–¹å¼export &#123; name, author, ..., say &#125; from &#x27;module&#x27; // ç¬¬äºŒç§æ–¹å¼export &#123; bookName as name, bookAuthor as author, ..., say &#125; from &#x27;module&#x27; //ç¬¬ä¸‰ç§æ–¹å¼ ç¬¬ä¸€ç§æ–¹å¼ï¼šé‡å®šå‘å¯¼å‡º module ä¸­çš„æ‰€æœ‰å¯¼å‡ºå±æ€§ï¼Œ ä½†æ˜¯ä¸åŒ…æ‹¬ module å†…çš„ default å±æ€§ã€‚ ç¬¬äºŒç§æ–¹å¼ï¼šä» module ä¸­å¯¼å…¥ name ï¼Œauthor ï¼Œsay å†ä»¥ç›¸åŒçš„å±æ€§åï¼Œå¯¼å‡ºã€‚ ç¬¬ä¸‰ç§æ–¹å¼ï¼šä» module ä¸­å¯¼å…¥ name ï¼Œé‡å±åä¸º bookName å¯¼å‡ºï¼Œä» module ä¸­å¯¼å…¥ author ï¼Œé‡å±åä¸º bookAuthor å¯¼å‡ºï¼Œæ­£å¸¸å¯¼å‡º say ã€‚ æ— éœ€å¯¼å…¥æ¨¡å—ï¼Œåªè¿è¡Œæ¨¡å—import &quot;module&quot;; æ‰§è¡Œ module ä¸å¯¼å‡ºå€¼ å¤šæ¬¡è°ƒç”¨ module åªè¿è¡Œä¸€æ¬¡ã€‚ åŠ¨æ€å¯¼å…¥const promise = import(&quot;module&quot;); import(&#39;module&#39;)ï¼ŒåŠ¨æ€å¯¼å…¥è¿”å›ä¸€ä¸ª Promiseã€‚ä¸ºäº†æ”¯æŒè¿™ç§æ–¹å¼ï¼Œéœ€è¦åœ¨ webpack ä¸­åšç›¸åº”çš„é…ç½®å¤„ç†ã€‚ ES6 module ç‰¹æ€§æ¥ä¸‹æ¥æˆ‘ä»¬é‡ç‚¹åˆ†æä¸€ä¸‹ ES6 module ä¸€äº›é‡è¦ç‰¹æ€§ã€‚ 1 é™æ€è¯­æ³•ES6 module çš„å¼•å…¥å’Œå¯¼å‡ºæ˜¯é™æ€çš„ï¼Œimport ä¼šè‡ªåŠ¨æå‡åˆ°ä»£ç çš„é¡¶å±‚ ï¼Œimport , export ä¸èƒ½æ”¾åœ¨å—çº§ä½œç”¨åŸŸæˆ–æ¡ä»¶è¯­å¥ä¸­ã€‚ğŸ™… é”™è¯¯å†™æ³•ä¸€ï¼š function say() &#123; import name from &quot;./a.js&quot;; export const author = &quot;æˆ‘ä¸æ˜¯å¤–æ˜Ÿäºº&quot;;&#125; ğŸ™… é”™è¯¯å†™æ³•äºŒï¼š isexport &amp;&amp; export const name = &#x27;aaa&#x27; è¿™ç§é™æ€è¯­æ³•ï¼Œåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ç¡®å®šäº†å¯¼å…¥å’Œå¯¼å‡ºçš„å…³ç³»ï¼Œæ‰€ä»¥æ›´æ–¹ä¾¿å»æŸ¥æ‰¾ä¾èµ–ï¼Œæ›´æ–¹ä¾¿å» tree shaking (æ‘‡æ ‘) ï¼Œ å¯ä»¥ä½¿ç”¨ lint å·¥å…·å¯¹æ¨¡å—ä¾èµ–è¿›è¡Œæ£€æŸ¥ï¼Œå¯ä»¥å¯¹å¯¼å…¥å¯¼å‡ºåŠ ä¸Šç±»å‹ä¿¡æ¯è¿›è¡Œé™æ€çš„ç±»å‹æ£€æŸ¥ã€‚ import çš„å¯¼å…¥åä¸èƒ½ä¸ºå­—ç¬¦ä¸²æˆ–åœ¨åˆ¤æ–­è¯­å¥ï¼Œä¸‹é¢ä»£ç æ˜¯é”™è¯¯çš„ ğŸ™… é”™è¯¯å†™æ³•ä¸‰ï¼š import &#x27;defaultExport&#x27; from &#x27;module&#x27;let name = &#x27;Export&#x27;import &#x27;default&#x27; + name from &#x27;module&#x27; 2 æ‰§è¡Œç‰¹æ€§ES6 module å’Œ Common.js ä¸€æ ·ï¼Œå¯¹äºç›¸åŒçš„ js æ–‡ä»¶ï¼Œä¼šä¿å­˜é™æ€å±æ€§ã€‚ ä½†æ˜¯ä¸ Common.js ä¸åŒçš„æ˜¯ ï¼ŒCommonJS æ¨¡å—åŒæ­¥åŠ è½½å¹¶æ‰§è¡Œæ¨¡å—æ–‡ä»¶ï¼ŒES6 æ¨¡å—æå‰åŠ è½½å¹¶æ‰§è¡Œæ¨¡å—æ–‡ä»¶ï¼ŒES6 æ¨¡å—åœ¨é¢„å¤„ç†é˜¶æ®µåˆ†ææ¨¡å—ä¾èµ–ï¼Œåœ¨æ‰§è¡Œé˜¶æ®µæ‰§è¡Œæ¨¡å—ï¼Œä¸¤ä¸ªé˜¶æ®µéƒ½é‡‡ç”¨æ·±åº¦ä¼˜å…ˆéå†ï¼Œæ‰§è¡Œé¡ºåºæ˜¯å­ -&gt; çˆ¶ã€‚ ä¸ºäº†éªŒè¯è¿™ä¸€ç‚¹ï¼Œçœ‹ä¸€ä¸‹å¦‚ä¸‹ demoã€‚main.js console.log(&quot;main.jså¼€å§‹æ‰§è¡Œ&quot;);import say from &quot;./a&quot;;import say1 from &quot;./b&quot;;console.log(&quot;main.jsæ‰§è¡Œå®Œæ¯•&quot;); a.js import b from &quot;./b&quot;;console.log(&quot;aæ¨¡å—åŠ è½½&quot;);export default function say() &#123; console.log(&quot;hello , world&quot;);&#125; b.js console.log(&quot;bæ¨¡å—åŠ è½½&quot;);export default function sayhello() &#123; console.log(&quot;hello,world&quot;);&#125; main.js å’Œ a.js éƒ½å¼•ç”¨äº† b.js æ¨¡å—ï¼Œä½†æ˜¯ b æ¨¡å—ä¹ŸåªåŠ è½½äº†ä¸€æ¬¡ã€‚æ‰§è¡Œé¡ºåºæ˜¯å­ -&gt; çˆ¶ æ•ˆæœå¦‚ä¸‹ï¼š bæ¨¡å—åŠ è½½aæ¨¡å—åŠ è½½main.jså¼€å§‹æ‰§è¡Œmain.jsæ‰§è¡Œå®Œæ¯• 3 å¯¼å‡ºç»‘å®šä¸èƒ½ä¿®æ”¹ import å¯¼å…¥çš„å±æ€§ a.js export let num = 1;export const addNumber = () =&gt; &#123; num++;&#125;; main.jsä¸­ import &#123; num, addNumber &#125; from &quot;./a&quot;;num = 2; å¦‚æœç›´æ¥ä¿®æ”¹ï¼Œé‚£ä¹ˆä¼šæŠ¥é”™ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š Uncaught Error: &quot;num&quot; is read-only. å±æ€§ç»‘å®šæ‰€ä»¥å¯ä»¥åœ¨ main.js ä¸­è¿™ä¹ˆä¿®æ”¹ã€‚ import &#123; num, addNumber &#125; from &quot;./a&quot;;console.log(num); // num = 1addNumber();console.log(num); // num = 2 å¦‚ä¸Šå±æ€§ num çš„å¯¼å…¥æ˜¯ç»‘å®šçš„ã€‚ æ¥ä¸‹æ¥å¯¹ import å±æ€§ä½œå‡ºæ€»ç»“ï¼š ä½¿ç”¨ import è¢«å¯¼å…¥çš„æ¨¡å—è¿è¡Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ã€‚ ä½¿ç”¨ import è¢«å¯¼å…¥çš„å˜é‡æ˜¯åªè¯»çš„ï¼Œå¯ä»¥ç†è§£é»˜è®¤ä¸º const è£…é¥°ï¼Œæ— æ³•è¢«èµ‹å€¼ ä½¿ç”¨ import è¢«å¯¼å…¥çš„å˜é‡æ˜¯ä¸åŸå˜é‡ç»‘å®š/å¼•ç”¨çš„ï¼Œå¯ä»¥ç†è§£ä¸º import å¯¼å…¥çš„å˜é‡æ— è®ºæ˜¯å¦ä¸ºåŸºæœ¬ç±»å‹éƒ½æ˜¯å¼•ç”¨ä¼ é€’ã€‚ import() åŠ¨æ€å¼•å…¥import() è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œ è¿”å›çš„ Promise çš„ then æˆåŠŸå›è°ƒä¸­ï¼Œå¯ä»¥è·å–æ¨¡å—çš„åŠ è½½æˆåŠŸä¿¡æ¯ã€‚æˆ‘ä»¬æ¥ç®€å•çœ‹ä¸€ä¸‹ import() æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚ main.js setTimeout(() =&gt; &#123; const result = import(&quot;./b&quot;); result.then((res) =&gt; &#123; console.log(res); &#125;);&#125;, 0); b.js export const name = &quot;alien&quot;;export default function sayhello() &#123; console.log(&quot;hello,world&quot;);&#125; æ‰“å°å¦‚ä¸‹ï¼š &#123; default: f sayhello() name: &#x27;alien&#x27; _esModule: true&#125; ä»æ‰“å°ç»“æœå¯ä»¥çœ‹å‡º import()çš„åŸºæœ¬ç‰¹æ€§ã€‚ import() å¯ä»¥åŠ¨æ€ä½¿ç”¨ï¼ŒåŠ è½½æ¨¡å—ã€‚ import() è¿”å›ä¸€ä¸ª Promise ï¼ŒæˆåŠŸå›è°ƒ then ä¸­å¯ä»¥è·å–æ¨¡å—å¯¹åº”çš„ä¿¡æ¯ã€‚name å¯¹åº” name å±æ€§ï¼Œ default ä»£è¡¨ export default ã€‚__esModule ä¸º es module çš„æ ‡è¯†ã€‚ import() å¯ä»¥åšä¸€äº›ä»€ä¹ˆåŠ¨æ€åŠ è½½é¦–å…ˆ import() åŠ¨æ€åŠ è½½ä¸€äº›å†…å®¹ï¼Œå¯ä»¥æ”¾åœ¨æ¡ä»¶è¯­å¥æˆ–è€…å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ã€‚ if (isRequire) &#123; const result = import(&quot;./b&quot;);&#125; æ‡’åŠ è½½import() å¯ä»¥å®ç°æ‡’åŠ è½½ï¼Œä¸¾ä¸ªä¾‹å­ vue ä¸­çš„è·¯ç”±æ‡’åŠ è½½ï¼› [ &#123; path: &quot;home&quot;, name: &quot;é¦–é¡µ&quot;, component: () =&gt; import(&quot;./home&quot;), &#125;,]; React ä¸­åŠ¨æ€åŠ è½½const LazyComponent = React.lazy(() =&gt; import(&quot;./text&quot;));class index extends React.Component &#123; render() &#123; return ( &lt;React.Suspense fallback=&#123; &lt;div className=&quot;icon&quot;&gt; &lt;SyncOutlinespin /&gt; &lt;/div&gt; &#125; &gt; &lt;LazyComponent /&gt; &lt;/React.Suspense&gt; ); &#125;&#125; React.lazy å’Œ Suspense é…åˆä¸€èµ·ç”¨ï¼Œèƒ½å¤Ÿæœ‰åŠ¨æ€åŠ è½½ç»„ä»¶çš„æ•ˆæœã€‚React.lazy æ¥å—ä¸€ä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°éœ€è¦åŠ¨æ€è°ƒç”¨ import() ã€‚ import() è¿™ç§åŠ è½½æ•ˆæœï¼Œå¯ä»¥å¾ˆè½»æ¾çš„å®ç°ä»£ç åˆ†å‰²ã€‚é¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§é‡ js æ–‡ä»¶ï¼Œé€ æˆé¦–æ¬¡åŠ è½½ç™½å±æ—¶é—´è¿‡é•¿çš„æƒ…å†µã€‚ tree shaking å®ç°Tree Shaking åœ¨ Webpack ä¸­çš„å®ç°ï¼Œæ˜¯ç”¨æ¥å°½å¯èƒ½çš„åˆ é™¤æ²¡æœ‰è¢«ä½¿ç”¨è¿‡çš„ä»£ç ï¼Œä¸€äº›è¢« import äº†ä½†å…¶å®æ²¡æœ‰è¢«ä½¿ç”¨çš„ä»£ç ã€‚æ¯”å¦‚ä»¥ä¸‹åœºæ™¯ï¼š a.jsï¼š export let num = 1;export const addNumber = () =&gt; &#123; num++;&#125;;export const delNumber = () =&gt; &#123; num--;&#125;; main.jsï¼š import &#123; addNumber &#125; from &quot;./a&quot;;addNumber(); å¦‚ä¸Š a.js ä¸­æš´éœ²ä¸¤ä¸ªæ–¹æ³•ï¼ŒaddNumber å’Œ delNumberï¼Œä½†æ˜¯æ•´ä¸ªåº”ç”¨ä¸­ï¼Œåªç”¨åˆ°äº† addNumberï¼Œé‚£ä¹ˆæ„å»ºæ‰“åŒ…çš„æ—¶å€™ï¼ŒdelNumber å°†ä½œä¸ºæ²¡æœ‰å¼•ç”¨çš„æ–¹æ³•ï¼Œä¸è¢«æ‰“åŒ…è¿›æ¥ã€‚ Commonjs å’Œ Es Module æ€»ç»“æ¥ä¸‹æ¥è´¯ç©¿å…¨æ–‡ï¼Œè®²ä¸€ä¸‹ Commonjs å’Œ Es Module çš„ç‰¹æ€§ã€‚ Commonjs æ€»ç»“Commonjs çš„ç‰¹æ€§å¦‚ä¸‹ï¼š CommonJS æ¨¡å—ç”± JS è¿è¡Œæ—¶å®ç°ã€‚ CommonJs æ˜¯å•ä¸ªå€¼å¯¼å‡ºï¼Œæœ¬è´¨ä¸Šå¯¼å‡ºçš„å°±æ˜¯ exports å±æ€§ã€‚ CommonJS æ˜¯å¯ä»¥åŠ¨æ€åŠ è½½çš„ï¼Œå¯¹æ¯ä¸€ä¸ªåŠ è½½éƒ½å­˜åœ¨ç¼“å­˜ï¼Œå¯ä»¥æœ‰æ•ˆçš„è§£å†³å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚ CommonJS æ¨¡å—åŒæ­¥åŠ è½½å¹¶æ‰§è¡Œæ¨¡å—æ–‡ä»¶ã€‚ es module æ€»ç»“Es module çš„ç‰¹æ€§å¦‚ä¸‹ï¼š ES6 Module é™æ€çš„ï¼Œä¸èƒ½æ”¾åœ¨å—çº§ä½œç”¨åŸŸå†…ï¼Œä»£ç å‘ç”Ÿåœ¨ç¼–è¯‘æ—¶ã€‚ ES6 Module çš„å€¼æ˜¯åŠ¨æ€ç»‘å®šçš„ï¼Œå¯ä»¥é€šè¿‡å¯¼å‡ºæ–¹æ³•ä¿®æ”¹ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ä¿®æ”¹ç»“æœã€‚ ES6 Module å¯ä»¥å¯¼å‡ºå¤šä¸ªå±æ€§å’Œæ–¹æ³•ï¼Œå¯ä»¥å•ä¸ªå¯¼å…¥å¯¼å‡ºï¼Œæ··åˆå¯¼å…¥å¯¼å‡ºã€‚ ES6 æ¨¡å—æå‰åŠ è½½å¹¶æ‰§è¡Œæ¨¡å—æ–‡ä»¶ï¼Œ ES6 Module å¯¼å…¥æ¨¡å—åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ã€‚ ES6 Module çš„ç‰¹æ€§å¯ä»¥å¾ˆå®¹æ˜“å®ç° Tree Shaking å’Œ Code Splittingã€‚ è½¬è½½Commonjs å’Œ Es Module åŒºåˆ«","updated":"2025-08-02T05:46:04.177Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"å‰ç«¯ç¼“å­˜","date":"2021-08-29T07:25:04.000Z","path":"2021/08/29/2021-08-29-http-cache/","text":"ç¼“å­˜ï¼Œè¿™æ˜¯ä¸€ä¸ªè€ç”Ÿå¸¸è°ˆçš„è¯é¢˜ï¼Œä¹Ÿå¸¸è¢«ä½œä¸ºå‰ç«¯é¢è¯•çš„ä¸€ä¸ªçŸ¥è¯†ç‚¹ã€‚ æœ¬æ–‡ï¼Œé‡ç‚¹åœ¨ä¸æ¢è®¨åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå¦‚ä½•è¿›è¡Œç¼“å­˜çš„è®¾ç½®ï¼Œå¹¶ç»™å‡ºä¸€ä¸ªè¾ƒä¸ºåˆç†çš„æ–¹æ¡ˆã€‚ åœ¨ä»‹ç»ç¼“å­˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹ æƒ¯å°†ç¼“å­˜åˆ†ä¸ºå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ä¸¤ç§ã€‚ä¸¤è€…çš„ä¸»è¦åŒºåˆ«æ˜¯ä½¿ç”¨æœ¬åœ°ç¼“å­˜çš„æ—¶å€™ï¼Œæ˜¯å¦éœ€è¦å‘æœåŠ¡å™¨éªŒè¯æœ¬åœ°ç¼“å­˜æ˜¯å¦ä¾æ—§æœ‰æ•ˆã€‚é¡¾åæ€ä¹‰ï¼Œåå•†ç¼“å­˜ï¼Œå°±æ˜¯éœ€è¦å’ŒæœåŠ¡å™¨è¿›è¡Œåå•†ï¼Œæœ€ç»ˆç¡®å®šæ˜¯å¦ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚ å¼ºç¼“å­˜æˆ‘ä»¬çŸ¥é“ï¼Œå¼ºç¼“å­˜ä¸»è¦æ˜¯é€šè¿‡ http è¯·æ±‚å¤´ä¸­çš„ Cache-Control å’Œ Expire ä¸¤ä¸ªå­—æ®µæ§åˆ¶ã€‚Expire æ˜¯ HTTP1.0 æ ‡å‡†ä¸‹çš„å­—æ®µï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¿½ç•¥ã€‚æˆ‘ä»¬é‡ç‚¹æ¥è®¨è®ºçš„ Cache-Control è¿™ä¸ªå­—æ®µã€‚ ä¸€èˆ¬ï¼Œæˆ‘ä»¬ä¼šè®¾ç½® Cache-Control çš„å€¼ä¸º â€œpublic, max-age=xxxâ€ï¼Œè¡¨ç¤ºåœ¨ xxx ç§’å†…å†æ¬¡è®¿é—®è¯¥èµ„æºï¼Œå‡ä½¿ç”¨æœ¬åœ°çš„ç¼“å­˜ï¼Œä¸å†å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚ æ˜¾è€Œæ˜“è§ï¼Œå¦‚æœåœ¨ xxx ç§’å†…ï¼ŒæœåŠ¡å™¨ä¸Šé¢çš„èµ„æºæ›´æ–°äº†ï¼Œå®¢æˆ·ç«¯åœ¨æ²¡æœ‰å¼ºåˆ¶åˆ·æ–°çš„æƒ…å†µä¸‹ï¼Œçœ‹åˆ°çš„å†…å®¹è¿˜æ˜¯æ—§çš„ã€‚å¦‚æœè¯´ä½ ä¸ç€æ€¥ï¼Œå¯ä»¥æ¥å—è¿™æ ·çš„ï¼Œé‚£æ˜¯ä¸æ˜¯å®Œç¾ï¼Ÿç„¶è€Œï¼Œå¾ˆå¤šæ—¶å€™ä¸æ˜¯ä½ æƒ³çš„é‚£ä¹ˆç®€å•çš„ï¼Œå¦‚æœå‘å¸ƒæ–°ç‰ˆæœ¬çš„æ—¶å€™ï¼Œåå°æ¥å£ä¹ŸåŒæ­¥æ›´æ–°äº†ï¼Œé‚£å°± gg äº†ã€‚æœ‰ç¼“å­˜çš„ç”¨æˆ·è¿˜åœ¨ä½¿ç”¨æ—§æ¥å£ï¼Œè€Œé‚£ä¸ªæ¥å£å·²ç»è¢«åå°å¹²æ‰äº†ã€‚æ€ä¹ˆåŠï¼Ÿ åå•†ç¼“å­˜åå•†ç¼“å­˜æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ¯æ¬¡éƒ½è¦å‘æœåŠ¡å™¨éªŒè¯ä¸€ä¸‹ç¼“å­˜çš„æœ‰æ•ˆæ€§ï¼Œä¼¼ä¹çœ‹èµ·æ¥å¾ˆçœäº‹ï¼Œä¸ç®¡é‚£ä¹ˆå¤šï¼Œä½ éƒ½è¦é—®ä¸€ä¸‹æˆ‘æ˜¯å¦æœ‰æ•ˆã€‚ä½†æ˜¯ï¼Œå¯¹äºä¸€ä¸ªæœ‰è¿½æ±‚çš„ç å†œï¼Œè¿™æ˜¯ä¸èƒ½æ¥å—çš„ã€‚æ¯æ¬¡éƒ½å»è¯·æ±‚æœåŠ¡å™¨ï¼Œé‚£è¦ç¼“å­˜è¿˜æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚ å®è·µç¼“å­˜çš„æ„ä¹‰å°±åœ¨äºå‡å°‘è¯·æ±‚ï¼Œæ›´å¤šåœ°ä½¿ç”¨æœ¬åœ°çš„èµ„æºï¼Œç»™ç”¨æˆ·æ›´å¥½çš„ä½“éªŒçš„åŒæ—¶ï¼Œä¹Ÿå‡è½»æœåŠ¡å™¨å‹åŠ›ã€‚æ‰€ä»¥ï¼Œæœ€ä½³å®è·µï¼Œå°±åº”è¯¥æ˜¯å°½å¯èƒ½å‘½ä¸­å¼ºç¼“å­˜ï¼ŒåŒæ—¶ï¼Œèƒ½åœ¨æ›´æ–°ç‰ˆæœ¬çš„æ—¶å€™è®©å®¢æˆ·ç«¯çš„ç¼“å­˜å¤±æ•ˆã€‚ åœ¨æ›´æ–°ç‰ˆæœ¬ä¹‹åï¼Œå¦‚ä½•è®©ç”¨æˆ·ç¬¬ä¸€æ—¶é—´ä½¿ç”¨æœ€æ–°çš„èµ„æºæ–‡ä»¶å‘¢ï¼Ÿæœºæ™ºçš„å‰ç«¯ä»¬æƒ³å‡ºäº†ä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨æ›´æ–°ç‰ˆæœ¬çš„æ—¶å€™ï¼Œé¡ºä¾¿æŠŠé™æ€èµ„æºçš„è·¯å¾„æ”¹äº†ï¼Œè¿™æ ·ï¼Œå°±ç›¸å½“äºç¬¬ä¸€æ¬¡è®¿é—®è¿™äº›èµ„æºï¼Œå°±ä¸ä¼šå­˜åœ¨ç¼“å­˜çš„é—®é¢˜äº†ã€‚ ä¼Ÿå¤§çš„ webpack å¯ä»¥è®©æˆ‘ä»¬åœ¨æ‰“åŒ…çš„æ—¶å€™ï¼Œåœ¨æ–‡ä»¶çš„å‘½åä¸Šå¸¦ä¸Š hash å€¼ã€‚ output:&#123; path:path.join(__dirname,./dist ), publicPath:/dist/, filname:bundle.[chunkhash].js&#125; ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªè¾ƒä¸ºåˆç†çš„ç¼“å­˜æ–¹æ¡ˆï¼š HTMLï¼šä½¿ç”¨åå•†ç¼“å­˜ã€‚ CSS&amp;JS&amp;å›¾ç‰‡ï¼šä½¿ç”¨å¼ºç¼“å­˜ï¼Œæ–‡ä»¶å‘½åå¸¦ä¸Š hash å€¼ã€‚ å“ˆå¸Œä¹Ÿæœ‰è®²ç©¶webpack ç»™æˆ‘ä»¬æä¾›äº†ä¸‰ç§å“ˆå¸Œå€¼è®¡ç®—æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯ hashã€chunkhash å’Œ contenthashã€‚é‚£ä¹ˆè¿™ä¸‰è€…æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ hashï¼šè·Ÿæ•´ä¸ªé¡¹ç›®çš„æ„å»ºç›¸å…³ï¼Œæ„å»ºç”Ÿæˆçš„æ–‡ä»¶ hash å€¼éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªè¦é¡¹ç›®é‡Œæœ‰æ–‡ä»¶æ›´æ”¹ï¼Œæ•´ä¸ªé¡¹ç›®æ„å»ºçš„ hash å€¼éƒ½ä¼šæ›´æ”¹ã€‚ chunkhashï¼šæ ¹æ®ä¸åŒçš„å…¥å£æ–‡ä»¶(Entry)è¿›è¡Œä¾èµ–æ–‡ä»¶è§£æã€æ„å»ºå¯¹åº”çš„ chunkï¼Œç”Ÿæˆå¯¹åº”çš„ hash å€¼ã€‚ contenthashï¼šç”±æ–‡ä»¶å†…å®¹äº§ç”Ÿçš„ hash å€¼ï¼Œå†…å®¹ä¸åŒäº§ç”Ÿçš„ contenthash å€¼ä¹Ÿä¸ä¸€æ ·ã€‚ æ˜¾ç„¶ï¼Œæˆ‘ä»¬æ˜¯ä¸ä¼šä½¿ç”¨ç¬¬ä¸€ç§çš„ã€‚æ”¹äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰“åŒ…ä¹‹åï¼Œå…¶ä»–æ–‡ä»¶çš„ hash éƒ½å˜äº†ï¼Œç¼“å­˜è‡ªç„¶éƒ½å¤±æ•ˆäº†ã€‚è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚ é‚£ chunkhash å’Œ contenthash çš„ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ åœ¨å®é™…åœ¨é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæŠŠé¡¹ç›®ä¸­çš„ css éƒ½æŠ½ç¦»å‡ºå¯¹åº”çš„ css æ–‡ä»¶æ¥åŠ ä»¥å¼•ç”¨ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ chunkhashï¼Œå½“æˆ‘ä»¬æ”¹äº† css ä»£ç ä¹‹åï¼Œä¼šå‘ç° css æ–‡ä»¶ hash å€¼æ”¹å˜çš„åŒæ—¶ï¼Œjs æ–‡ä»¶çš„ hash å€¼ä¹Ÿä¼šæ”¹å˜ã€‚è¿™æ—¶å€™ï¼Œcontenthash å°±æ´¾ä¸Šç”¨åœºäº†ã€‚ ETag è®¡ç®—Nginx å®˜æ–¹é»˜è®¤çš„ ETag è®¡ç®—æ–¹å¼æ˜¯ä¸ºâ€æ–‡ä»¶æœ€åä¿®æ”¹æ—¶é—´ 16 è¿›åˆ¶-æ–‡ä»¶é•¿åº¦ 16 è¿›åˆ¶â€ã€‚ ä¾‹ï¼šETagï¼šâ€œ59e72c84-2404â€ ETag çš„ç”¨å¤„HTTP1.1 ç”¨ ETag æ¥åˆ¤æ–­è¯·æ±‚çš„æ–‡ä»¶æ˜¯å¦è¢«ä¿®æ”¹ï¼Œä¸»è¦ä¸ºäº†è§£å†³ Last-Modified æ— æ³•è§£å†³çš„ä¸€äº›é—®é¢˜ 1ã€ä¸€äº›æ–‡ä»¶ä¹Ÿè®¸ä¼šå‘¨æœŸæ€§çš„æ›´æ”¹ï¼Œä½†æ˜¯ä»–çš„å†…å®¹å¹¶ä¸æ”¹å˜(ä»…ä»…æ”¹å˜çš„ä¿®æ”¹æ—¶é—´)ï¼Œè¿™ä¸ªæ—¶å€™å¹¶ä¸å¸Œæœ›å®¢æˆ·ç«¯è®¤ä¸ºè¿™ä¸ªæ–‡ä»¶è¢«ä¿®æ”¹äº†é‡æ–° GET; 2ã€æŸäº›æ–‡ä»¶ä¿®æ”¹éå¸¸é¢‘ç¹ï¼Œ1 ç§’å†…ä¿®æ”¹äº† N æ¬¡ï¼ŒIf-Modified-Since èƒ½æ£€æŸ¥åˆ°çš„ç²’åº¦æ˜¯ç§’çº§çš„ï¼Œè¿™ç§ä¿®æ”¹æ— æ³•åˆ¤æ–­ 3ã€æŸäº›æœåŠ¡å™¨ä¸èƒ½ç²¾ç¡®çš„å¾—åˆ°æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ï¼› ä¸ºæ­¤ï¼ŒHTTP1.1 å¼•å…¥äº† ETag.ä½†æ ‡å‡†å¹¶æ²¡æœ‰è§„å®š ETag çš„å†…å®¹æ˜¯ä»€ä¹ˆæˆ–è€…è¯´è¦æ€ä¹ˆå®ç°ï¼Œå”¯ä¸€è§„å®šçš„æ˜¯ ETag éœ€è¦æ”¾åœ¨åŒå¼•å·å†…ã€‚ETag ç”±æœåŠ¡å™¨ç«¯ç”Ÿæˆï¼Œå®¢æˆ·ç«¯é€šè¿‡ If-Match æˆ–è€…è¯´ If-None-Match è¿™ä¸ªæ¡ä»¶åˆ¤æ–­è¯·æ±‚æ¥éªŒè¯èµ„æºæ˜¯å¦ä¿®æ”¹ã€‚æˆ‘ä»¬å¸¸è§çš„æ˜¯ä½¿ç”¨ If-None-Match.è¯·æ±‚ä¸€ä¸ªæ–‡ä»¶çš„æµç¨‹å¯èƒ½å¦‚ä¸‹ï¼š ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼š å®¢æˆ·ç«¯å‘èµ· HTTP get è¯·æ±‚ä¸€ä¸ªæ–‡ä»¶ æœåŠ¡å™¨å¤„ç†è¯·æ±‚ï¼Œè¿”å›æ–‡ä»¶å†…å®¹å’Œä¸€å † Headerï¼Œå½“ç„¶åŒ…æ‹¬ ETag(ä¾‹å¦‚â€1ec5-502264e2ae4c0â€)(å‡è®¾æœåŠ¡å™¨æ”¯æŒ ETag ç”Ÿæˆå’Œå·²ç»å¼€å¯äº† ETag).çŠ¶æ€ç  200 ç¬¬äºŒæ¬¡è¯·æ±‚ï¼š å®¢æˆ·ç«¯å‘èµ· HTTP GET è¯·æ±‚ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å®¢æˆ·ç«¯åŒæ—¶å‘é€ä¸€ä¸ª If-None-Match å¤´ï¼Œè¿™ä¸ªå¤´çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶æœåŠ¡å™¨è¿”å›çš„ ETagï¼š1ec5-502264e2ae4c0 æœåŠ¡å™¨åˆ¤æ–­å‘é€è¿‡æ¥çš„ ETag å’Œè®¡ç®—å‡ºæ¥çš„ ETag æ˜¯åŒ¹é…çš„ï¼Œä¸è¿”å› 200ï¼Œè¿”å› 304ï¼Œè®©å®¢æˆ·ç«¯ç»§ç»­ä½¿ç”¨æœ¬åœ°ç¼“å­˜ã€‚ ç«™ç‚¹å¯ç”¨ ETag çš„å¥½å¤„1ã€Sitemap å¯ç”¨ ETag åï¼Œç™¾åº¦å°±å¯ä»¥å¿«é€Ÿçš„çŸ¥é“ Sitemap çš„æ›´æ–°ã€‚åœ¨å†…å®¹æ²¡æœ‰åšæ›´æ”¹çš„æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨åªå‘å› 304 åº”ç­”å¤´ï¼Œå¯¹æµé‡çš„æ¶ˆè€—æå°ã€‚å¹³å‡æ¯ä¸ª head åœ¨ 227B å¤§å°çš„é€šå¸¸ä¸‹ï¼Œå¦‚æœ 24 ä¸ªå°æ—¶æ¯ç§’å›åº”çš„æµé‡æ¶ˆè€—ä»…ä¸º 18.7Mã€‚ 2ã€ç«™é•¿å¹³å°å¯¹æ¯ä¸ªç«™ç‚¹çš„ Sitemap ä¸»åŠ¨æŠ“å–æ¬¡æ•°æ˜¯æœ‰ä¸Šé™çš„ï¼Œä¸” è¿™é¡¹åŠŸèƒ½æ²¡æœ‰å¯¹æ‰€æœ‰ç«™ç‚¹å¼€æ”¾ï¼Œå¦‚æœä½ çš„ç«™ç‚¹ Sitemap å¼€å¯äº† ETagï¼Œå¹¶é€šè¿‡äº†æµ‹è¯•ï¼Œå°±å¯ä»¥ç”¨è¾ƒå°çš„æµé‡äº«å—ç™¾åº¦åŠæ—¶æ›´æ–°ç½‘ç«™çš„ Sitemap çš„åŠŸèƒ½ã€‚ åç«¯éœ€è¦æ€ä¹ˆè®¾ç½®ä¸Šæ–‡ä¸»è¦è¯´çš„æ˜¯å‰ç«¯å¦‚ä½•è¿›è¡Œæ‰“åŒ…ï¼Œé‚£åç«¯æ€ä¹ˆåšå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œæµè§ˆå™¨æ˜¯æ ¹æ®å“åº”å¤´çš„ç›¸å…³å­—æ®µæ¥å†³å®šç¼“å­˜çš„æ–¹æ¡ˆçš„ã€‚æ‰€ä»¥ï¼Œåç«¯çš„å…³é”®å°±åœ¨äºï¼Œæ ¹æ®ä¸åŒçš„è¯·æ±‚è¿”å›å¯¹åº”çš„ç¼“å­˜å­—æ®µã€‚ä»¥ nodejs ä¸ºä¾‹ï¼Œå¦‚æœéœ€è¦æµè§ˆå™¨å¼ºç¼“å­˜ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾ç½®ï¼š res.setHeader(&quot;Cache-Control&quot;, &quot;public, max-age=xxx&quot;); å¦‚æœéœ€è¦åå•†ç¼“å­˜ï¼Œåˆ™å¯ä»¥è¿™æ ·è®¾ç½®ï¼š res.setHeader(&quot;Cache-Control&quot;, &quot;public, max-age=0&quot;);res.setHeader(&quot;Last-Modified&quot;, &quot;xxx&quot;);res.setHeader(&quot;ETag&quot;, &quot;xxx&quot;); å®è·µå®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬é€šå¸¸ä¼š 2 ç§ç¼“å­˜éƒ½ä½¿ç”¨ï¼Œæ¯”å¦‚ github pages è¿™æ˜¯è¿™ç¯‡åšå®¢çš„è¯·æ±‚ç¤ºä¾‹ï¼Œä¸‹é¢æ˜¯è¿”å›å¤´çš„å‚æ•° cache-control max-age=600etag W/&quot;6868c122-420c1&quot;expires Sat, 05 Jul 2025 06:34:39 GMTlast-modified Sat, 05 Jul 2025 06:07:30 GMT æ—¢è®¾ç½®äº† cache-control åˆè®¾ç½®äº† etagï¼Œé‚£æµè§ˆå™¨ä¼šæ ¹æ® cache-control æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦å¼ºç¼“å­˜,è¿™é‡Œçš„æœ‰æ•ˆæ—¶é—´æ˜¯ 600sï¼Œæ‰€ä»¥åœ¨ 600s å†…ï¼Œæµè§ˆå™¨éƒ½ä¸ä¼šè¯·æ±‚æœåŠ¡å™¨ï¼Œè€Œæ˜¯ä¼šåœ¨çŠ¶æ€ç é‡Œé¢æœ‰ä¸€ä¸ªï¼ˆfrom memory cacheï¼‰ï¼Œè¡¨ç¤ºå¼ºç¼“å­˜ Status Code 200 OK (from memory cache) è€Œä¸€æ—¦è¶…è¿‡äº† 600sï¼Œæµè§ˆå™¨å°±ä¼šåœ¨è¯·æ±‚å¤´é‡Œé¢æ·»åŠ if-modified-sinceã€if-none-matchè¿™ä¸¤ä¸ªå­—æ®µ ä¸‹é¢æ˜¯è¶…è¿‡ 600s åï¼Œæµè§ˆå™¨è¯·æ±‚å¤´çš„å‚æ•° if-modified-since Sat, 05 Jul 2025 06:07:30 GMTif-none-match W/&quot;6868c122-420c1&quot; åç«¯æœåŠ¡å™¨æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚ï¼Œä¼šæ ¹æ® if-modified-sinceã€if-none-match è¿™ä¸¤ä¸ªå­—æ®µæ¥åˆ¤æ–­æ˜¯å¦å‘½ä¸­åå•†ç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­åˆ™ç›´æ¥è¿”å› 304 çŠ¶æ€ç ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯çš„è¯·æ±‚æ¥å£çŠ¶æ€å°±ä¼šå˜æˆ 304ï¼Œä¾ç„¶æ˜¯ä½¿ç”¨ç¼“å­˜çš„æƒ…å†µ","updated":"2025-08-02T05:46:04.177Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"}]},{"title":"æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ .+*ï¼Ÿ","date":"2021-08-21T14:11:01.000Z","path":"2021/08/21/2021-08-21-regex-lazy-match/","text":"(.+)é»˜è®¤æ˜¯è´ªå©ªåŒ¹é… (.+?)ä¸ºæƒ°æ€§åŒ¹é… æ­£åˆ™è¡¨è¾¾å¼çš„æƒ°æ€§åŒ¹é…ç–‘é—®å·è®©.+çš„æœç´¢æ¨¡å¼ä»è´ªå©ªæ¨¡å¼å˜æˆæƒ°æ€§æ¨¡å¼ã€‚ var str = &#39;aaa&lt;div style=&quot;font-color:red;&quot;&gt;123456&lt;/div&gt;bbb&#39; &lt;.+?&gt;ä¼šåŒ¹é…&lt;div style=&quot;font-color:red;&quot;&gt; &lt;.+&gt;ä¼šåŒ¹é…&lt;div style=&quot;font-color:red;&quot;&gt;123456&lt;/div&gt; è¦åœ¨æµè§ˆå™¨æµ‹è¯•ç»“æœçš„è¯ï¼Œè¾“å…¥: var str = &#x27;aaa&lt;div style=&quot;font-color:red;&quot;&gt;123456&lt;/div&gt;bbb&#x27;;str.match(/&lt;.+?&gt;/);str.match(/&lt;.+&gt;/);","updated":"2025-08-02T05:46:04.177Z","tags":[{"name":"js","slug":"js","permalink":"https://luckyship.github.io/tags/js/"},{"name":"regexp","slug":"regexp","permalink":"https://luckyship.github.io/tags/regexp/"}]},{"title":"åŸºäºvue2å®ç°ä¸€ä¸ªç®€å•çš„minVue","date":"2021-08-19T02:15:02.000Z","path":"2021/08/19/2021-08-19-min-vue/","text":"åŸºäº vue2 å®ç°ä¸€ä¸ªç®€å•çš„å¯ä»¥åŒå‘ç»‘å®šçš„ minVue æ¨¡ç‰ˆæ’å€¼ æ•°æ®åŠ«æŒï¼Œå˜é‡æ›´æ–° å¤šä¾èµ–æ›´æ–° å®ç° vue æŒ‡ä»¤ï¼Œ v-textï¼Œv-modelï¼Œv-click æ¨¡ç‰ˆæ’å€¼é¦–å…ˆ å®ç°æ¨¡ç‰ˆç¼–è¯‘çš„åŠŸèƒ½å¯¹äº vue çš„ optionï¼Œæˆ‘ä»¬åªä¼ å…¥ el å’Œ dataï¼Œå…¶ä»–çš„å±æ€§æš‚æ—¶æˆ‘ä»¬ä¸åšå¤„ç†ï¼Œè®© html ä¸­çš„æ–‡æœ¬ä¼ å€¼å¯ä»¥è¢« data ä¸­çš„æ•°æ®æ›¿æ¢ &lt;body&gt; &lt;div id=&quot;app&quot;&gt; &lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;/p&gt; &lt;p&gt;&#123;&#123;count&#125;&#125;&lt;/p&gt; &lt;/div&gt;&lt;/body&gt; new MinVue(&#123; el: &quot;#app&quot;, data: &#123; msg: &quot;hello,mini vue.js&quot;, count: 666, &#125;,&#125;); æ­¤å¤„æˆ‘ä»¬åªè€ƒè™‘å…ƒç´ ä¸­åªæœ‰ä¸€ä¸ªæ–‡æœ¬æ’å€¼çš„æƒ…å†µ class MinVue &#123; constructor(options) &#123; this.$el = options.el; this.$data = options.data; // ç¼–è¯‘æ¨¡æ¿ new Compile(this); &#125;&#125;class Compile &#123; constructor(object) &#123; this.$el = object.$el; this.$data = object.$data; this.compile(document.querySelector(this.$el)); &#125; compile(el) &#123; const childNodes = el.childNodes; Array.from(childNodes).forEach((node) =&gt; &#123; if (this.isTextNode(node)) &#123; this.compileTextNode(node); &#125; else if (this.isElementNode(node)) &#123; this.compileElement(node); &#125; if (node.childNodes &amp;&amp; node.childNodes.length) this.compile(node); &#125;); &#125; isTextNode(node) &#123; return node.nodeType === 3; &#125; isElementNode(node) &#123; return node.nodeType === 1; &#125; compileTextNode(node) &#123; // .+?æ­£åˆ™æ‡’æƒ°åŒ¹é…, éè´ªå©ªåŒ¹é…, åŒ¹é…èŠ±æ‹¬å·é‡Œé¢çš„å†…å®¹ // åªåŒ¹é…ç¬¬ä¸€ä¸ªèŠ±æ‹¬å·ï¼Œåç»­çš„ä¸åŒ¹é…ï¼ˆåªè€ƒè™‘å…ƒç´ é‡Œé¢åªæœ‰ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„æƒ…å†µï¼‰ const reg = /\\&#123;\\&#123;(.+?)\\&#125;\\&#125;/g; const text = node.textContent; if (reg.test(text)) &#123; // å¦‚æœåŒ¹é…æˆåŠŸ, è·å–ç¬¬ä¸€ä¸ªåŒ¹é…çš„å†…å®¹ let key = RegExp.$1.trim(); node.textContent = text.replace(reg, this.$data[key]); &#125; &#125; compileElement(node) &#123;&#125;&#125; è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†æ–‡æœ¬æ’å…¥çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å®Œæ•´ä»£ç  &lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;app&quot;&gt; &lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;/p&gt; &lt;p&gt;&#123;&#123;count&#125;&#125;&lt;/p&gt; &lt;/div&gt; &lt;/body&gt; &lt;script&gt; class MinVue &#123; constructor(options) &#123; this.$el = options.el; this.$data = options.data; // ç¼–è¯‘æ¨¡æ¿ new Compile(this); &#125; &#125; class Compile &#123; constructor(object) &#123; this.$el = object.$el; this.$data = object.$data; this.compile(document.querySelector(this.$el)); &#125; compile(el) &#123; const childNodes = el.childNodes; Array.from(childNodes).forEach((node) =&gt; &#123; if (this.isTextNode(node)) &#123; this.compileTextNode(node); &#125; else if (this.isElementNode(node)) &#123; this.compileElement(node); &#125; if (node.childNodes &amp;&amp; node.childNodes.length) this.compile(node); &#125;); &#125; isTextNode(node) &#123; return node.nodeType === 3; &#125; isElementNode(node) &#123; return node.nodeType === 1; &#125; compileTextNode(node) &#123; // .+?æ­£åˆ™æ‡’æƒ°åŒ¹é…, éè´ªå©ªåŒ¹é…, åŒ¹é…èŠ±æ‹¬å·é‡Œé¢çš„å†…å®¹ // åªåŒ¹é…ç¬¬ä¸€ä¸ªèŠ±æ‹¬å·ï¼Œåç»­çš„ä¸åŒ¹é…ï¼ˆåªè€ƒè™‘å…ƒç´ é‡Œé¢åªæœ‰ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„æƒ…å†µï¼‰ const reg = /\\&#123;\\&#123;(.+?)\\&#125;\\&#125;/g; const text = node.textContent; if (reg.test(text)) &#123; // å¦‚æœåŒ¹é…æˆåŠŸ, è·å–ç¬¬ä¸€ä¸ªåŒ¹é…çš„å†…å®¹ let key = RegExp.$1.trim(); node.textContent = text.replace(reg, this.$data[key]); &#125; &#125; compileElement(node) &#123;&#125; &#125; new MinVue(&#123; el: &quot;#app&quot;, data: &#123; msg: &quot;hello,mini vue.js&quot;, count: 666, &#125;, &#125;); &lt;/script&gt;&lt;/html&gt; æ•°æ®åŠ«æŒï¼Œå˜é‡æ›´æ–°æˆ‘ä»¬éƒ½çŸ¥é“ vue2 æ˜¯é€šè¿‡ Object.defineProperty æ¥å®ç°æ•°æ®åŠ«æŒçš„ï¼Œæˆ‘ä»¬ä¹Ÿæ¥å®ç°ä¸€ä¸ªç®€å•çš„ observer class MinVue &#123; constructor(options) &#123; this.$el = options.el; this.$data = options.data; new Observer(this.$data); // ç¼–è¯‘æ¨¡æ¿ new Compile(this); &#125;&#125;class Observer &#123; constructor(data) &#123; this.data = data; this.walk(data); &#125; walk(data) &#123; Object.keys(data).forEach((key) =&gt; &#123; this.defineReactive(data, key, data[key]); &#125;); &#125; defineReactive(obj, key, value) &#123; Object.defineProperty(obj, key, &#123; get() &#123; return value; &#125;, set(newValue) &#123; if (newValue !== value) &#123; value = newValue; &#125; &#125;, &#125;); &#125;&#125; è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†æ•°æ®åŠ«æŒï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æƒ³ä¸€ä¸‹ï¼Œå¦‚ä½•å»å®ç°æ•°æ®ä»£ç†çš„åŠŸèƒ½ é¦–å…ˆæˆ‘ä»¬æƒ³è¦åœ¨å“ªé‡Œå»åšä¾èµ–æ”¶é›†æ¯”è¾ƒåˆé€‚ï¼Œé‚£å°±æ˜¯åœ¨compileTextNodeæ–¹æ³•é‡Œé¢ï¼Œä»–ä¼šè®¿é—®æ‰€æœ‰çš„æ–‡æœ¬æ’å€¼çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œä¾èµ–æ”¶é›†ã€‚ dep = null;class Observer &#123; constructor(data) &#123; this.data = data; this.walk(data); &#125; walk(data) &#123; Object.keys(data).forEach((key) =&gt; &#123; this.defineReactive(data, key, data[key]); &#125;); &#125; defineReactive(obj, key, value) &#123; let updateCallBack = () =&gt; &#123;&#125;; Object.defineProperty(obj, key, &#123; get() &#123; if (dep) &#123; updateCallBack = dep; &#125; return value; &#125;, set(newValue) &#123; if (newValue !== value) &#123; value = newValue; updateCallBack &amp;&amp; updateCallBack(newValue); &#125; &#125;, &#125;); &#125;&#125;compileTextNode(node) &#123; // .+?æ­£åˆ™æ‡’æƒ°åŒ¹é…, éè´ªå©ªåŒ¹é…, åŒ¹é…èŠ±æ‹¬å·é‡Œé¢çš„å†…å®¹ // åªåŒ¹é…ç¬¬ä¸€ä¸ªèŠ±æ‹¬å·ï¼Œåç»­çš„ä¸åŒ¹é…ï¼ˆåªè€ƒè™‘å…ƒç´ é‡Œé¢åªæœ‰ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„æƒ…å†µï¼‰ const reg = /\\&#123;\\&#123;(.+?)\\&#125;\\&#125;/g; const text = node.textContent; if (reg.test(text)) &#123; // å¦‚æœåŒ¹é…æˆåŠŸ, è·å–ç¬¬ä¸€ä¸ªåŒ¹é…çš„å†…å®¹ let key = RegExp.$1.trim(); node.textContent = text.replace(reg, this.$data[key]); // ç»‘å®šæ•°æ®æ›´æ–° dep = (newValue) =&gt; &#123; console.log(newValue); node.textContent = newValue; &#125;; // è§¦å‘getæ–¹æ³• console.log(this.$data[key]); dep = null; &#125;&#125; æˆ‘ä»¬å…ˆä½¿ç”¨ä¸€ä¸ªå…¨å±€å˜é‡ depï¼Œç”¨æ¥å­˜å‚¨ä¾èµ–æ”¶é›†çš„å›è°ƒå‡½æ•°ï¼Œå½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨è¿™ä¸ªå›è°ƒå‡½æ•°æ¥æ›´æ–°è§†å›¾ï¼Œæˆ‘ä»¬åœ¨defineReactiveæ–¹æ³•é‡Œé¢è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œå½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨updateCallBackå›è°ƒå‡½æ•°æ¥æ›´æ–°è§†å›¾ã€‚ æˆ‘ä»¬æ­¤å¤„å…ˆè€ƒè™‘ä¾èµ–åªæœ‰ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬depåªæ˜¯ä¸€ä¸ªå˜é‡ï¼Œåç»­æˆ‘ä»¬ä¼šè€ƒè™‘å¤šä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬depæ˜¯ä¸€ä¸ªæ•°ç»„æˆ–ç±»ï¼Œç”¨æ¥å­˜å‚¨å¤šä¸ªå›è°ƒå‡½æ•°ã€‚ å®Œæ•´ä»£ç  &lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;app&quot;&gt; &lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;/p&gt; &lt;p&gt;&#123;&#123;count&#125;&#125;&lt;/p&gt; &lt;button type=&quot;button&quot; onclick=&quot;increase()&quot;&gt;add+&lt;/button&gt; &lt;/div&gt; &lt;/body&gt; &lt;script&gt; function increase() &#123; minVue.$data.count = minVue.$data.count + 1; &#125; class MinVue &#123; constructor(options) &#123; this.$el = options.el; this.$data = options.data; new Observer(this.$data); // ç¼–è¯‘æ¨¡æ¿ new Compile(this); &#125; &#125; dep = null; class Observer &#123; constructor(data) &#123; this.data = data; this.walk(data); &#125; walk(data) &#123; Object.keys(data).forEach((key) =&gt; &#123; this.defineReactive(data, key, data[key]); &#125;); &#125; defineReactive(obj, key, value) &#123; let updateCallBack = () =&gt; &#123;&#125;; Object.defineProperty(obj, key, &#123; get() &#123; if (dep) &#123; updateCallBack = dep; &#125; return value; &#125;, set(newValue) &#123; if (newValue !== value) &#123; value = newValue; updateCallBack &amp;&amp; updateCallBack(newValue); &#125; &#125;, &#125;); &#125; &#125; class Compile &#123; constructor(object) &#123; this.$el = object.$el; this.$data = object.$data; this.compile(document.querySelector(this.$el)); &#125; compile(el) &#123; const childNodes = el.childNodes; Array.from(childNodes).forEach((node) =&gt; &#123; if (this.isTextNode(node)) &#123; this.compileTextNode(node); &#125; else if (this.isElementNode(node)) &#123; this.compileElement(node); &#125; if (node.childNodes &amp;&amp; node.childNodes.length) this.compile(node); &#125;); &#125; isTextNode(node) &#123; return node.nodeType === 3; &#125; isElementNode(node) &#123; return node.nodeType === 1; &#125; compileTextNode(node) &#123; // .+?æ­£åˆ™æ‡’æƒ°åŒ¹é…, éè´ªå©ªåŒ¹é…, åŒ¹é…èŠ±æ‹¬å·é‡Œé¢çš„å†…å®¹ // åªåŒ¹é…ç¬¬ä¸€ä¸ªèŠ±æ‹¬å·ï¼Œåç»­çš„ä¸åŒ¹é…ï¼ˆåªè€ƒè™‘å…ƒç´ é‡Œé¢åªæœ‰ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„æƒ…å†µï¼‰ const reg = /\\&#123;\\&#123;(.+?)\\&#125;\\&#125;/g; const text = node.textContent; if (reg.test(text)) &#123; // å¦‚æœåŒ¹é…æˆåŠŸ, è·å–ç¬¬ä¸€ä¸ªåŒ¹é…çš„å†…å®¹ let key = RegExp.$1.trim(); node.textContent = text.replace(reg, this.$data[key]); // ç»‘å®šæ•°æ®æ›´æ–° dep = (newValue) =&gt; &#123; console.log(newValue); node.textContent = newValue; &#125;; // è§¦å‘getæ–¹æ³• console.log(this.$data[key]); dep = null; &#125; &#125; compileElement(node) &#123;&#125; &#125; let minVue = new MinVue(&#123; el: &quot;#app&quot;, data: &#123; msg: &quot;hello,mini vue.js&quot;, count: 666, &#125;, &#125;); &lt;/script&gt;&lt;/html&gt; å¤šä¸ªä¾èµ–çš„æƒ…å†µå¦‚æœæˆ‘ä»¬æœ‰å¤šä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„æƒ…å†µï¼Œæ¯”å¦‚æœ‰ 2 ä¸ªä½¿ç”¨ count çš„æƒ…å†µï¼Œå°±æ— æ³•ç”¨ä¸€ä¸ª dep å»å®ç°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ­¤å¤„å°† dep æ”¹é€ æˆæ³ªç±»ï¼Œå¹¶æŠŠæ›´æ–°å‡½æ•°å†™åˆ° Watch ç±»é‡Œé¢ &lt;p&gt;&#123;&#123;count&#125;&#125;&lt;/p&gt;&lt;p&gt;&#123;&#123;count&#125;&#125;&lt;/p&gt; class Dep &#123; constructor() &#123; this.watchers = []; &#125; addWatcher(watcher) &#123; this.watchers.push(watcher); &#125; notify() &#123; this.watchers.forEach((watcher) =&gt; watcher.update()); &#125;&#125;class Watcher &#123; constructor($data, key, cb) &#123; Dep.target = this; this.key = key; this.cb = cb; // æ­¤å¤„è°ƒç”¨getæ–¹æ³•ï¼Œè§¦å‘getæ–¹æ³•çš„definePropertyçš„getæ–¹æ³•ï¼Œå°†watcheræ·»åŠ åˆ°depä¸­ this.$data = $data; this._old = $data[key]; Dep.target = null; &#125; update() &#123; const newValue = this.$data[this.key]; this.cb(newValue); this._old = newValue; &#125;&#125; compileTextNodeä¸­æˆ‘ä»¬æ”¹é€ ä¸€ä¸‹ï¼Œä½¿ç”¨ Watcher æ–¹æ³•å»æ›´æ–° compileTextNode(node) &#123; // .+?æ­£åˆ™æ‡’æƒ°åŒ¹é…, éè´ªå©ªåŒ¹é…, åŒ¹é…èŠ±æ‹¬å·é‡Œé¢çš„å†…å®¹ // åªåŒ¹é…ç¬¬ä¸€ä¸ªèŠ±æ‹¬å·ï¼Œåç»­çš„ä¸åŒ¹é…ï¼ˆåªè€ƒè™‘å…ƒç´ é‡Œé¢åªæœ‰ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„æƒ…å†µï¼‰ const reg = /\\&#123;\\&#123;(.+?)\\&#125;\\&#125;/g; const text = node.textContent; if (reg.test(text)) &#123; // å¦‚æœåŒ¹é…æˆåŠŸ, è·å–ç¬¬ä¸€ä¸ªåŒ¹é…çš„å†…å®¹ let key = RegExp.$1.trim(); node.textContent = text.replace(reg, this.$data[key]); // ç»‘å®šæ•°æ®æ›´æ–° new Watcher(this.$data, key, (newValue) =&gt; &#123; node.textContent = newValue; &#125;); &#125;&#125; ç„¶åå†æŠŠ Observer ä¸­çš„ä»£ç æ›´æ–°ä¸ºDepç±»çš„æ–¹æ³• class Observer &#123; constructor(data) &#123; this.data = data; this.walk(data); &#125; walk(data) &#123; Object.keys(data).forEach((key) =&gt; &#123; this.defineReactive(data, key, data[key]); &#125;); &#125; defineReactive(obj, key, value) &#123; const dep = new Dep(); Object.defineProperty(obj, key, &#123; get() &#123; if (Dep.target) &#123; dep.addWatcher(Dep.target); &#125; return value; &#125;, set(newValue) &#123; if (newValue !== value) &#123; value = newValue; dep.notify(); &#125; &#125;, &#125;); &#125;&#125; &lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;app&quot;&gt; &lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;/p&gt; &lt;p&gt;&#123;&#123;count&#125;&#125;&lt;/p&gt; &lt;p&gt;&#123;&#123;count&#125;&#125;&lt;/p&gt; &lt;button type=&quot;button&quot; onclick=&quot;increase()&quot;&gt;add+&lt;/button&gt; &lt;/div&gt; &lt;/body&gt; &lt;script&gt; function increase() &#123; minVue.$data.count = minVue.$data.count + 1; &#125; class MinVue &#123; constructor(options) &#123; this.$el = options.el; this.$data = options.data; new Observer(this.$data); // ç¼–è¯‘æ¨¡æ¿ new Compile(this); &#125; &#125; class Observer &#123; constructor(data) &#123; this.data = data; this.walk(data); &#125; walk(data) &#123; Object.keys(data).forEach((key) =&gt; &#123; this.defineReactive(data, key, data[key]); &#125;); &#125; defineReactive(obj, key, value) &#123; const dep = new Dep(); Object.defineProperty(obj, key, &#123; get() &#123; if (Dep.target) &#123; dep.addWatcher(Dep.target); &#125; return value; &#125;, set(newValue) &#123; if (newValue !== value) &#123; value = newValue; dep.notify(); &#125; &#125;, &#125;); &#125; &#125; class Dep &#123; constructor() &#123; this.watchers = []; &#125; addWatcher(watcher) &#123; this.watchers.push(watcher); &#125; notify() &#123; this.watchers.forEach((watcher) =&gt; watcher.update()); &#125; &#125; class Watcher &#123; constructor($data, key, cb) &#123; Dep.target = this; this.key = key; this.cb = cb; // æ­¤å¤„è°ƒç”¨getæ–¹æ³•ï¼Œè§¦å‘getæ–¹æ³•çš„definePropertyçš„getæ–¹æ³•ï¼Œå°†watcheræ·»åŠ åˆ°depä¸­ this.$data = $data; this._old = $data[key]; Dep.target = null; &#125; update() &#123; const newValue = this.$data[this.key]; this.cb(newValue); this._old = newValue; &#125; &#125; class Compile &#123; constructor(object) &#123; this.$el = object.$el; this.$data = object.$data; this.compile(document.querySelector(this.$el)); &#125; compile(el) &#123; const childNodes = el.childNodes; Array.from(childNodes).forEach((node) =&gt; &#123; if (this.isTextNode(node)) &#123; this.compileTextNode(node); &#125; else if (this.isElementNode(node)) &#123; this.compileElement(node); &#125; if (node.childNodes &amp;&amp; node.childNodes.length) this.compile(node); &#125;); &#125; isTextNode(node) &#123; return node.nodeType === 3; &#125; isElementNode(node) &#123; return node.nodeType === 1; &#125; compileTextNode(node) &#123; // .+?æ­£åˆ™æ‡’æƒ°åŒ¹é…, éè´ªå©ªåŒ¹é…, åŒ¹é…èŠ±æ‹¬å·é‡Œé¢çš„å†…å®¹ // åªåŒ¹é…ç¬¬ä¸€ä¸ªèŠ±æ‹¬å·ï¼Œåç»­çš„ä¸åŒ¹é…ï¼ˆåªè€ƒè™‘å…ƒç´ é‡Œé¢åªæœ‰ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„æƒ…å†µï¼‰ const reg = /\\&#123;\\&#123;(.+?)\\&#125;\\&#125;/g; const text = node.textContent; if (reg.test(text)) &#123; // å¦‚æœåŒ¹é…æˆåŠŸ, è·å–ç¬¬ä¸€ä¸ªåŒ¹é…çš„å†…å®¹ let key = RegExp.$1.trim(); node.textContent = text.replace(reg, this.$data[key]); // ç»‘å®šæ•°æ®æ›´æ–° new Watcher(this.$data, key, (newValue) =&gt; &#123; node.textContent = newValue; &#125;); &#125; &#125; compileElement(node) &#123;&#125; &#125; let minVue = new MinVue(&#123; el: &quot;#app&quot;, data: &#123; msg: &quot;hello,mini vue.js&quot;, count: 666, &#125;, &#125;); &lt;/script&gt;&lt;/html&gt; è¿™æ ·æˆ‘ä»¬å°±å®ç°äº†å¤šä¸ªä¾èµ–æ›´æ–°çš„æƒ…å†µ å®ç° vue æŒ‡ä»¤å®ç° v-textæˆ‘ä»¬ä¹‹å‰å¯¹é text èŠ‚ç‚¹æ²¡æœ‰ä½œç‰¹æ®Šå¤„ç†ï¼Œç°åœ¨å¤„ç†ä¸€ä¸‹ï¼Œå®ç° v-text çš„åŠŸèƒ½ compileElement(node) &#123; const attrs = node.attributes; if (attrs.length) &#123; Array.from(attrs).forEach((attr) =&gt; &#123; if (this.isDirective(attr.name)) &#123; // æ ¹æ®v-æ¥æˆªå–ä¸€ä¸‹åç¼€å±æ€§å let attrName = attr.name.indexOf(&quot;:&quot;) &gt; -1 ? attr.name.substr(5) : attr.name.substr(2); let key = attr.value; this.update(node, attrName, key, this.$data[key]); &#125; &#125;); &#125;&#125;isDirective(dir) &#123; return dir.startsWith(&quot;v-&quot;);&#125;update(node, attrName, key, value) &#123; if (attrName === &quot;text&quot;) &#123; node.textContent = value; // è¿™é‡Œä¸å†textnodeå¤„ç†ï¼Œ æ‰€ä»¥æˆ‘ä»¬è¦è¿˜æ˜¯è¦åšWatchçš„æ›´æ–° new Watcher(this.$data, key, (newValue) =&gt; &#123; node.textContent = newValue; &#125;); &#125;&#125; åœ¨ html ä¸­è¯•ä¸€ä¸‹ï¼Œèƒ½å¤Ÿæ­£å¸¸å±•ç¤º ğŸ˜Š &lt;p v-text=&quot;msg&quot;&gt;&lt;/p&gt; v-modelç„¶åæˆ‘ä»¬å®ç° v-model update(node, attrName, key, value) &#123; if (attrName === &quot;text&quot;) &#123; node.textContent = value; new Watcher(this.$data, key, (newValue) =&gt; &#123; node.textContent = newValue; &#125;); &#125; if (attrName === &quot;model&quot;) &#123; node.value = value; new Watcher(this.$data, key, (newValue) =&gt; &#123; node.value = newValue; &#125;); node.addEventListener(&quot;input&quot;, (e) =&gt; &#123; this.$data[key] = node.value; &#125;); &#125;&#125; &lt;input v-model=&quot;msg&quot; /&gt; å¯ä»¥æ­£å¸¸ä½¿ç”¨ v-clickæœ€åæˆ‘ä»¬å®ç°ä¸€ä¸‹ v-click æŒ‡ä»¤ class Compile &#123; constructor(object) &#123; this.$el = object.$el; this.$data = object.$data; this.methods = object.methods; // æ³¨å†Œ this.compile(document.querySelector(this.$el)); &#125; update(node, attrName, key, value) &#123; if (attrName === &quot;text&quot;) &#123; node.textContent = value; new Watcher(this.$data, key, (newValue) =&gt; &#123; node.textContent = newValue; &#125;); &#125; if (attrName === &quot;model&quot;) &#123; node.value = value; new Watcher(this.$data, key, (newValue) =&gt; &#123; node.value = newValue; &#125;); node.addEventListener(&quot;input&quot;, (e) =&gt; &#123; this.$data[key] = node.value; &#125;); &#125; if (attrName === &quot;click&quot;) &#123; node.addEventListener(attrName, this.methods[key].bind(this.$data)); &#125; &#125;&#125; class MinVue &#123; constructor(options) &#123; this.$el = options.el; this.$data = options.data; this.methods = options.methods; new Observer(this.$data); // ç¼–è¯‘æ¨¡æ¿ new Compile(this); &#125;&#125;let minVue = new MinVue(&#123; el: &quot;#app&quot;, data: &#123; msg: &quot;hello,mini vue.js&quot;, count: 666, &#125;, methods: &#123; increase() &#123; this.count = this.count + 1; &#125;, &#125;,&#125;); &lt;button type=&quot;button&quot; v-click=&quot;increase&quot;&gt;vue add+&lt;/button&gt; åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å®ç°äº†ä¸€ä¸ªç®€å•çš„ minVue äº†ï¼Œä¸€èµ·æ¥çœ‹ä¸‹æœ€åçš„å®Œæ•´ä»£ç å§ &lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;app&quot;&gt; &lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;/p&gt; &lt;p&gt;&#123;&#123;count&#125;&#125;&lt;/p&gt; &lt;p&gt;&#123;&#123;count&#125;&#125;&lt;/p&gt; &lt;p v-text=&quot;msg&quot;&gt;&lt;/p&gt; &lt;input v-model=&quot;msg&quot; /&gt; &lt;button type=&quot;button&quot; onclick=&quot;increase()&quot;&gt;add+&lt;/button&gt; &lt;button type=&quot;button&quot; v-click=&quot;increase&quot;&gt;vue add+&lt;/button&gt; &lt;/div&gt; &lt;/body&gt; &lt;script&gt; function increase() &#123; minVue.$data.count = minVue.$data.count + 1; &#125; class MinVue &#123; constructor(options) &#123; this.$el = options.el; this.$data = options.data; this.methods = options.methods; new Observer(this.$data); // ç¼–è¯‘æ¨¡æ¿ new Compile(this); &#125; &#125; class Observer &#123; constructor(data) &#123; this.data = data; this.walk(data); &#125; walk(data) &#123; Object.keys(data).forEach((key) =&gt; &#123; this.defineReactive(data, key, data[key]); &#125;); &#125; defineReactive(obj, key, value) &#123; const dep = new Dep(); Object.defineProperty(obj, key, &#123; get() &#123; if (Dep.target) &#123; dep.addWatcher(Dep.target); &#125; return value; &#125;, set(newValue) &#123; if (newValue !== value) &#123; value = newValue; dep.notify(); &#125; &#125;, &#125;); &#125; &#125; class Dep &#123; constructor() &#123; this.watchers = []; &#125; addWatcher(watcher) &#123; this.watchers.push(watcher); &#125; notify() &#123; this.watchers.forEach((watcher) =&gt; watcher.update()); &#125; &#125; class Watcher &#123; constructor($data, key, cb) &#123; Dep.target = this; this.key = key; this.cb = cb; // æ­¤å¤„è°ƒç”¨getæ–¹æ³•ï¼Œè§¦å‘getæ–¹æ³•çš„definePropertyçš„getæ–¹æ³•ï¼Œå°†watcheræ·»åŠ åˆ°depä¸­ this.$data = $data; this._old = $data[key]; Dep.target = null; &#125; update() &#123; const newValue = this.$data[this.key]; this.cb(newValue); this._old = newValue; &#125; &#125; class Compile &#123; constructor(object) &#123; this.$el = object.$el; this.$data = object.$data; this.methods = object.methods; this.compile(document.querySelector(this.$el)); &#125; compile(el) &#123; const childNodes = el.childNodes; Array.from(childNodes).forEach((node) =&gt; &#123; if (this.isTextNode(node)) &#123; this.compileTextNode(node); &#125; else if (this.isElementNode(node)) &#123; this.compileElement(node); &#125; if (node.childNodes &amp;&amp; node.childNodes.length) this.compile(node); &#125;); &#125; isTextNode(node) &#123; return node.nodeType === 3; &#125; isElementNode(node) &#123; return node.nodeType === 1; &#125; compileTextNode(node) &#123; // .+?æ­£åˆ™æ‡’æƒ°åŒ¹é…, éè´ªå©ªåŒ¹é…, åŒ¹é…èŠ±æ‹¬å·é‡Œé¢çš„å†…å®¹ // åªåŒ¹é…ç¬¬ä¸€ä¸ªèŠ±æ‹¬å·ï¼Œåç»­çš„ä¸åŒ¹é…ï¼ˆåªè€ƒè™‘å…ƒç´ é‡Œé¢åªæœ‰ä¸€ä¸ªæ¨¡ç‰ˆå­—ç¬¦ä¸²çš„æƒ…å†µï¼‰ const reg = /\\&#123;\\&#123;(.+?)\\&#125;\\&#125;/g; const text = node.textContent; if (reg.test(text)) &#123; // å¦‚æœåŒ¹é…æˆåŠŸ, è·å–ç¬¬ä¸€ä¸ªåŒ¹é…çš„å†…å®¹ let key = RegExp.$1.trim(); node.textContent = text.replace(reg, this.$data[key]); // ç»‘å®šæ•°æ®æ›´æ–° new Watcher(this.$data, key, (newValue) =&gt; &#123; node.textContent = newValue; &#125;); &#125; &#125; compileElement(node) &#123; const attrs = node.attributes; if (attrs.length) &#123; Array.from(attrs).forEach((attr) =&gt; &#123; if (this.isDirective(attr.name)) &#123; // æ ¹æ®v-æ¥æˆªå–ä¸€ä¸‹åç¼€å±æ€§å let attrName = attr.name.indexOf(&quot;:&quot;) &gt; -1 ? attr.name.substr(5) : attr.name.substr(2); let key = attr.value; this.update(node, attrName, key, this.$data[key]); &#125; &#125;); &#125; &#125; isDirective(dir) &#123; return dir.startsWith(&quot;v-&quot;); &#125; update(node, attrName, key, value) &#123; if (attrName === &quot;text&quot;) &#123; node.textContent = value; new Watcher(this.$data, key, (newValue) =&gt; &#123; node.textContent = newValue; &#125;); &#125; if (attrName === &quot;model&quot;) &#123; node.value = value; new Watcher(this.$data, key, (newValue) =&gt; &#123; node.value = newValue; &#125;); node.addEventListener(&quot;input&quot;, (e) =&gt; &#123; this.$data[key] = node.value; &#125;); &#125; if (attrName === &quot;click&quot;) &#123; node.addEventListener(attrName, this.methods[key].bind(this.$data)); &#125; &#125; &#125; let minVue = new MinVue(&#123; el: &quot;#app&quot;, data: &#123; msg: &quot;hello,mini vue.js&quot;, count: 666, &#125;, methods: &#123; increase() &#123; this.count = this.count + 1; &#125;, &#125;, &#125;); &lt;/script&gt;&lt;/html&gt;","updated":"2025-08-02T05:46:04.177Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"vue","slug":"vue","permalink":"https://luckyship.github.io/tags/vue/"}]},{"title":"æ‰‹å†™javascriptæ–¹æ³•","date":"2021-08-09T08:27:43.000Z","path":"2021/08/09/2021-08-09-javascript-method-implement/","text":"æ•°ç»„æ‰å¹³åŒ–æ•ˆæœï¼š [1, [2, [3]]].flat(2); // [1, 2, 3] es5 å®ç°ï¼šé€’å½’è°ƒç”¨Array.prototype.newFlat = function (depth) &#123; var arr = this; var result = []; for (var i = 0; i &lt; arr.lenght; i++) &#123; if (Array.isArray(arr[i]) &amp;&amp; depth &gt;= 1) &#123; depth--; result = result.concat(arr[i].newFlat(depth)); &#125; else &#123; result.push(arr[i]); &#125; &#125; return result;&#125;; es6 å®ç°Array.prototype.newFlat = function (depth) &#123; var arr = this; // var result = []; while (arr.some((item) =&gt; Array.isArray(item))) &#123; if (depth &gt;= 1) &#123; depth--; arr = [].concat(...arr); &#125; &#125; return arr;&#125;; å®ç° newå®ç°è¦ç‚¹ï¼š new ä¼šäº§ç”Ÿä¸€ä¸ªæ–°å¯¹è±¡ æ–°å¯¹è±¡éœ€è¦èƒ½å¤Ÿè®¿é—®åˆ°æ„é€ å‡½æ•°çš„å±æ€§ï¼Œæ‰€ä»¥éœ€è¦é‡æ–°æŒ‡å®šå®ƒçš„åŸå‹ æ„é€ å‡½æ•°å¯èƒ½ä¼šæ˜¾ç¤ºè¿”å› function objectFactory() &#123; var obj = new Object(); // å–å‡ºç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ„é€ å‡½æ•°ï¼ŒåŒæ—¶åˆ é™¤ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå‰©ä½™å‚æ•°ä¸ºæ„é€ å‡½æ•°çš„å‚æ•° var constructorFunction = [].shift.call(arguments); obj.__proto__ = constructorFunction.prototype; var result = constructorFunction.apply(obj, arguments); // result || obj è¿™é‡Œè¿™ä¹ˆå†™ï¼Œæ˜¯è€ƒè™‘åˆ°æ„é€ å‡½æ•°è¿”å›ä¸ºnull return typeof result === &quot;object&quot; ? result || obj : obj;&#125; å®ä¾‹ function person(name, age) &#123; this.name = name; this.age = age;&#125;var p = objectFactory(person, &quot;asd&quot;, 13);console.log(p); æœ¬è´¨ä¸Šæ˜¯åˆ©ç”¨äº†ï¼Œå®ä¾‹çš„__proto__å±æ€§ ç­‰äºæ„é€ å‡½æ•°çš„ prototype å®ç° instanceof å…³é”®å­—instanceof å°±æ˜¯åˆ¤æ–­æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨å®ä¾‹çš„åŸå‹é“¾ä¸Š function newInstanceof(left, right) &#123; /** * å‰ç½®åˆ¤æ–­ï¼Œä¸ç¬¦åˆç›´æ¥è®¿é—®false * æ ¹æ®è¯­æ³•A instanceof Bï¼Œæˆ‘ä»¬å¯ä»¥å¾—çŸ¥ä¸¤ç‚¹ï¼Œé¦–å…ˆAå¾—æ˜¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼ŒBå¾—æ˜¯ä¸€ä¸ªæ„é€ å™¨å‡½æ•°ã€‚ */ if (typeof left !== &quot;object&quot; || left === null || typeof right !== &quot;function&quot;) &#123; return false; &#125; var proto = left.__proto__; while (true) &#123; if (proto === null) &#123; return false; &#125; if (proto === right.prototype) &#123; return true; &#125; proto = proto.__proto__; &#125;&#125; Promise.allpromiseAll æºç å®ç° function isPromise(obj) &#123; return !!obj &amp;&amp; (typeof obj === &quot;object&quot; || typeof obj === &quot;function&quot;) &amp;&amp; typeof obj.then === &quot;function&quot;;&#125;const myPromiseAll = (arr) =&gt; &#123; let result = []; return new Promise((resolve, reject) =&gt; &#123; console.log(&quot;promiseAll&quot;); for (let i = 0; i &lt; arr.length; i++) &#123; if (isPromise(arr[i])) &#123; arr[i].then((data) =&gt; &#123; result[i] = data; if (result.length === arr.length) &#123; resolve(result); &#125; &#125;, reject); &#125; else &#123; result[i] = arr[i]; &#125; &#125; &#125;);&#125;;let p1 = new Promise((resolve, reject) =&gt; &#123; setTimeout(resolve, 5000, &quot;foo1&quot;);&#125;);let p2 = new Promise((resolve, reject) =&gt; &#123; setTimeout(resolve, 1000, &quot;foo2&quot;);&#125;);let p3 = new Promise((resolve, reject) =&gt; &#123; setTimeout(function () &#123; resolve(&quot;foo3&quot;); &#125;, 10000);&#125;);myPromiseAll([p1, p2, p3]).then((values) =&gt; &#123; console.log(values); // [&quot;foo1&quot;, &quot;foo2&quot;, &quot;foo3&quot;]&#125;); å‡½æ•°æŸ¯é‡ŒåŒ–function add(num) &#123; var sum = 0; sum = sum + num; var tempFun = function (numB) &#123; if (arguments.length === 0) &#123; return sum; &#125; else &#123; sum = sum + numB; return tempFun; &#125; &#125;; tempFun.valueOf = function () &#123; return sum; &#125;; tempFun.toString = function () &#123; return sum + &quot;&quot;; &#125;; return tempFun;&#125; å‚è€ƒ","updated":"2025-08-02T05:46:04.177Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"vscodeé…ç½®é¡¹","date":"2021-08-07T09:15:37.000Z","path":"2021/08/07/2021-08-07-vscode-setting/","text":"prettier é…ç½®å¼ºåˆ¶ prettier ä¸ç”Ÿæ•ˆ &lt;!-- prettier-ignore --&gt;&lt;div class=&quot;x&quot;&gt;hello world&lt;/div&gt;&lt;!-- prettier-ignore-attribute --&gt; vscode é…ç½® è‡ªç”¨é…ç½® &#123; &quot;editor.formatOnSave&quot;: true, // è‡ªåŠ¨ä¿å­˜ &quot;prettier.singleQuote&quot;: true, // å•å¼•å· &quot;prettier.printWidth&quot;: 120, &quot;prettier.useEditorConfig&quot;: false, &quot;prettier.endOfLine&quot;: &quot;auto&quot;, // æœ€åä¸€è¡Œ &quot;prettier.arrowParens&quot;: &quot;avoid&quot; // ç®­å¤´å‡½æ•°æ‹¬å·&#125; å„ç±»è¯­è¨€è‡ªåŠ¨æ ¼å¼åŒ– &#123; &quot;[typescript]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot; &#125;, &quot;[javascript]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot; &#125;, &quot;[html]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot; &#125;, &quot;[json]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;vscode.json-language-features&quot; &#125;, &quot;[jsonc]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;vscode.json-language-features&quot; &#125;, &quot;[css]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot; &#125;, &quot;[scss]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot; &#125;, &quot;editor.formatOnSave&quot;: true&#125; æ–‡æ¡£ &#123; // ä½¿èƒ½æ¯ä¸€ç§è¯­è¨€é»˜è®¤æ ¼å¼åŒ–è§„åˆ™ &quot;[html]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot; &#125;, &quot;[css]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot; &#125;, &quot;[less]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot; &#125;, &quot;[javascript]&quot;: &#123; &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot; &#125;, /* prettierçš„é…ç½® */ &quot;prettier.printWidth&quot;: 100, // è¶…è¿‡æœ€å¤§å€¼æ¢è¡Œ &quot;prettier.tabWidth&quot;: 4, // ç¼©è¿›å­—èŠ‚æ•° &quot;prettier.useTabs&quot;: false, // ç¼©è¿›ä¸ä½¿ç”¨tabï¼Œä½¿ç”¨ç©ºæ ¼ &quot;prettier.semi&quot;: true, // å¥å°¾æ·»åŠ åˆ†å· &quot;prettier.singleQuote&quot;: true, // ä½¿ç”¨å•å¼•å·ä»£æ›¿åŒå¼•å· &quot;prettier.proseWrap&quot;: &quot;preserve&quot;, // é»˜è®¤å€¼ã€‚å› ä¸ºä½¿ç”¨äº†ä¸€äº›æŠ˜è¡Œæ•æ„Ÿå‹çš„æ¸²æŸ“å™¨ï¼ˆå¦‚GitHub commentï¼‰è€ŒæŒ‰ç…§markdownæ–‡æœ¬æ ·å¼è¿›è¡ŒæŠ˜è¡Œ &quot;prettier.arrowParens&quot;: &quot;avoid&quot;, // (x) =&gt; &#123;&#125; ç®­å¤´å‡½æ•°å‚æ•°åªæœ‰ä¸€ä¸ªæ—¶æ˜¯å¦è¦æœ‰å°æ‹¬å·ã€‚avoidï¼šçœç•¥æ‹¬å· &quot;prettier.bracketSpacing&quot;: true, // åœ¨å¯¹è±¡ï¼Œæ•°ç»„æ‹¬å·ä¸æ–‡å­—ä¹‹é—´åŠ ç©ºæ ¼ &quot;&#123; foo: bar &#125;&quot; &quot;prettier.disableLanguages&quot;: [&quot;vue&quot;], // ä¸æ ¼å¼åŒ–vueæ–‡ä»¶ï¼Œvueæ–‡ä»¶çš„æ ¼å¼åŒ–å•ç‹¬è®¾ç½® &quot;prettier.endOfLine&quot;: &quot;auto&quot;, // ç»“å°¾æ˜¯ \\n \\r \\n\\r auto &quot;prettier.htmlWhitespaceSensitivity&quot;: &quot;ignore&quot;, &quot;prettier.ignorePath&quot;: &quot;.prettierignore&quot;, // ä¸ä½¿ç”¨prettieræ ¼å¼åŒ–çš„æ–‡ä»¶å¡«å†™åœ¨é¡¹ç›®çš„.prettierignoreæ–‡ä»¶ä¸­ &quot;prettier.jsxBracketSameLine&quot;: false, // åœ¨jsxä¸­æŠŠ&#x27;&gt;&#x27; æ˜¯å¦å•ç‹¬æ”¾ä¸€è¡Œ &quot;prettier.jsxSingleQuote&quot;: false, // åœ¨jsxä¸­ä½¿ç”¨å•å¼•å·ä»£æ›¿åŒå¼•å· &quot;prettier.parser&quot;: &quot;babylon&quot;, // æ ¼å¼åŒ–çš„è§£æå™¨ï¼Œé»˜è®¤æ˜¯babylon &quot;prettier.requireConfig&quot;: false, // Require a &#x27;prettierconfig&#x27; to format prettier &quot;prettier.stylelintIntegration&quot;: false, //ä¸è®©prettierä½¿ç”¨stylelintçš„ä»£ç æ ¼å¼è¿›è¡Œæ ¡éªŒ &quot;prettier.trailingComma&quot;: &quot;es5&quot;, // åœ¨å¯¹è±¡æˆ–æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ åé¢æ˜¯å¦åŠ é€—å·ï¼ˆåœ¨ES5ä¸­åŠ å°¾é€—å·ï¼‰ &quot;prettier.tslintIntegration&quot;: false, // ä¸è®©prettierä½¿ç”¨tslintçš„ä»£ç æ ¼å¼è¿›è¡Œæ ¡éªŒ &quot;prettier.eslintIntegration&quot;: false, //ä¸è®©prettierä½¿ç”¨eslintçš„ä»£ç æ ¼å¼è¿›è¡Œæ ¡éªŒ &quot;prettier.useEditorConfig&quot;: false // å–æ¶ˆä¼˜å…ˆé…ç½®editconfigï¼Œä¸å–æ¶ˆprettierä¸èµ·ä½œç”¨&#125;","updated":"2025-08-02T05:46:04.177Z","tags":[{"name":"base","slug":"base","permalink":"https://luckyship.github.io/tags/base/"}]},{"title":"js callã€applyã€bindæºç å®ç°","date":"2021-07-24T11:10:37.000Z","path":"2021/07/24/2021-07-24-js-call-apply-bind-source-code/","text":"callé¦–å…ˆä¸Šä¸€ä¸ª call ä½¿ç”¨ function add(c, d) &#123; return this.a + this.b + c + d;&#125;const obj = &#123; a: 1, b: 2,&#125;;console.log(add.call(obj, 3, 4)); // 10 å¤§ç»Ÿä¸Šçš„è¯´æ³•å°±æ˜¯ï¼Œcall æ”¹å˜äº† this çš„æŒ‡å‘, ç„¶åï¼Œä»‹ç» this xxx ä»€ä¹ˆä¸€å¤§å †åè¯ï¼Œåæ­£ä¸ç®¡ä½ æ‡‚ä¸æ‡‚ï¼ŒæˆåŠŸç»•æ™•ä½ å°±å·²ç» ok äº†ï¼Œä½†æ˜¯å®é™…å‘ç”Ÿçš„è¿‡ç¨‹ï¼Œå¯ä»¥çœ‹æˆä¸‹é¢çš„æ ·å­ã€‚ const o = &#123; a: 1, b: 2, add: function (c, d) &#123; return this.a + this.b + c + d; &#125;,&#125;; ç»™ o å¯¹è±¡æ·»åŠ ä¸€ä¸ª add å±æ€§ï¼Œè¿™ä¸ªæ—¶å€™ this å°±æŒ‡å‘äº† oï¼Œ o.add(5, 7)å¾—åˆ°çš„ç»“æœå’Œ add.call(o, 5, 6)ç›¸åŒã€‚ ä½†æ˜¯ç»™å¯¹è±¡ o æ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„ add å±æ€§ï¼Œè¿™ä¸ªå±æ€§æˆ‘ä»¬æ˜¯ä¸éœ€è¦çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ delete åˆ é™¤å®ƒã€‚ so, åŸºæœ¬ä¸ºä»¥ä¸‹ä¸‰éƒ¨ã€‚ // 1. å°†å‡½æ•°è®¾ä¸ºå¯¹è±¡çš„å±æ€§o.fn = bar;// 2. æ‰§è¡Œè¯¥å‡½æ•°o.fn();// 3. åˆ é™¤è¯¥å‡½æ•°delete o.fn; æ‰€ä»¥æˆ‘ä»¬åŸºäº ES5 å®ç° call Function.prototype.es3Call = function (context) &#123; var content = context || window; content.fn = this; var args = []; // argumentsæ˜¯ç±»æ•°ç»„å¯¹è±¡ï¼Œéå†ä¹‹å‰éœ€è¦ä¿å­˜é•¿åº¦ï¼Œè¿‡æ»¤å‡ºç¬¬ä¸€ä¸ªä¼ å‚ for (var i = 1, len = arguments.length; i &lt; len; i++) &#123; // é¿å…objectä¹‹ç±»ä¼ å…¥ args.push(&#x27;arguments[&#x27; + i + &#x27;]&#x27;); &#125; var result = eval(&#x27;content.fn(&#x27; + args + &#x27;)&#x27;); delete content.fn; return result;&#125;;console.error(add.es3Call(obj, 3, 4)); // 10console.log( add.es3Call( &#123; a: 3, b: 9, &#125;, 3, 4 )); // 19console.log( add.es3Call( &#123; a: 3, b: 9, &#125;, &#123; xx: 1, &#125;, 4 )); // 12[object Object]4 åŸºäº ES6 å®ç° call, å…¶å®å·®åˆ«ä¸å¤§ï¼Œes6 æ–°å¢â€¦ restï¼Œè¿™å°±å¯ä»¥æ”¾å¼ƒ eval çš„å†™æ³•ï¼Œå¦‚ä¸‹ // ES6 call å®ç°Function.prototype.es6Call = function (context) &#123; var content = context || window; content.fn = this; var args = []; for (var i = 1, len = arguments.length; i &lt; len; i++) &#123; args.push(arguments[i]); &#125; const result = content.fn(...args); delete content.fn; return result;&#125;;console.error(add.es6Call(obj, 3, 4));console.log( add.es6Call( &#123; a: 3, b: 9, &#125;, &#123; xx: 1, &#125;, 4 )); // 12[object Object]4 applyapply å’Œ call åŒºåˆ«åœ¨äº apply ç¬¬äºŒä¸ªå‚æ•°æ˜¯ Arrayï¼Œè€Œ call æ˜¯å°†ä¸€ä¸ªä¸ªä¼ å…¥ åŸºäº es3 å®ç° Function.prototype.es3Apply = function (context, arr) &#123; var context = context || window; context.fn = this; var result; if (!arr) &#123; result = context.fn(); &#125; else &#123; // è·å–å‚æ•° var args = []; for (var i = 0, len = arr.length; i &lt; len; i++) &#123; args.push(&#x27;arr[&#x27; + i + &#x27;]&#x27;); &#125; // æ‰§è¡Œå‡½æ•° result = eval(&#x27;context.fn(&#x27; + args + &#x27;)&#x27;); &#125; delete context.fn; return result;&#125;;console.log(add.es3Apply(obj, [1, &#x27;abc&#x27;, &#x27;2&#x27;])); // 4abc åŸºäº es6 å®ç° Function.prototype.es6Apply = function (context, arr) &#123; var context = context || window; context.fn = this; var result; if (!arr) &#123; result = context.fn(); &#125; else &#123; if (!(arr instanceof Array)) throw new Error(&#x27;params must be array&#x27;); result = context.fn(...arr); &#125; delete context.fn; return result;&#125;;console.error(add.es6Apply(obj, [1, 2])); // 6 bindbind() æ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªæ–°å‡½æ•°ã€‚å½“è¿™ä¸ªæ–°å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œbind() çš„ç¬¬ä¸€ä¸ªå‚æ•°å°†ä½œä¸ºå®ƒè¿è¡Œæ—¶çš„ thisï¼Œä¹‹åçš„ä¸€åºåˆ—å‚æ•°å°†ä¼šåœ¨ä¼ é€’çš„å®å‚å‰ä¼ å…¥ä½œä¸ºå®ƒçš„å‚æ•°ã€‚å…ˆçœ‹ä¸€ä¸ªä½¿ç”¨ bind æ–¹æ³•çš„å®ä¾‹ function foo(c, d) &#123; this.b = 100; console.log(this.a); console.log(this.b); console.log(c); console.log(d);&#125;// æˆ‘ä»¬å°†foo bindåˆ°&#123;a: 1&#125;var func = foo.bind( &#123; a: 1, &#125;, &#x27;1st&#x27;);func(&#x27;2nd&#x27;); // 1 100 1st 2nd// å³ä½¿å†æ¬¡callä¹Ÿä¸èƒ½æ”¹å˜thisã€‚func.call( &#123; a: 2, &#125;, &#x27;3rd&#x27;); // 1 100 1st 3rd// å½“ bind è¿”å›çš„å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œ// bind æ—¶æŒ‡å®šçš„ this å€¼ä¼šå¤±æ•ˆï¼Œä½†ä¼ å…¥çš„å‚æ•°ä¾ç„¶ç”Ÿæ•ˆã€‚// æ‰€ä»¥ä½¿ç”¨funcä¸ºæ„é€ å‡½æ•°æ—¶ï¼Œthisä¸ä¼šæŒ‡å‘&#123;a: 1&#125;å¯¹è±¡ï¼Œthis.açš„å€¼ä¸ºundefinedã€‚å¦‚ä¸‹// new func(&#x27;4th&#x27;); //undefined 100 1st 4th é¦–å…ˆä½¿ç”¨ ES3 å®ç° Function.prototype.es3Bind = function (context) &#123; if (typeof this !== &#x27;function&#x27;) throw new TypeError(&#x27;what is trying to be bound is not callback&#x27;); var self = this; var args = Array.prototype.slice.call(arguments, 1); const fBound = function () &#123; // è·å–å‡½æ•°çš„å‚æ•° var bindArgs = Array.prototype.slice.call(arguments); // è¿”å›å‡½æ•°çš„æ‰§è¡Œç»“æœ // åˆ¤æ–­å‡½æ•°æ˜¯ä½œä¸ºæ„é€ å‡½æ•°è¿˜æ˜¯æ™®é€šå‡½æ•° // æ„é€ å‡½æ•°this instanceof fNOPè¿”å›trueï¼Œå°†ç»‘å®šå‡½æ•°çš„thisæŒ‡å‘è¯¥å®ä¾‹ï¼Œå¯ä»¥è®©å®ä¾‹è·å¾—æ¥è‡ªç»‘å®šå‡½æ•°çš„å€¼ã€‚ // å½“ä½œä¸ºæ™®é€šå‡½æ•°æ—¶ï¼Œthis æŒ‡å‘ windowï¼Œæ­¤æ—¶ç»“æœä¸º falseï¼Œå°†ç»‘å®šå‡½æ•°çš„ this æŒ‡å‘ context return self.apply(this instanceof fNOP ? this : context, args.concat(bindArgs)); &#125;; // åˆ›å»ºç©ºå‡½æ•° var fNOP = function () &#123;&#125;; // fNOPå‡½æ•°çš„prototypeä¸ºç»‘å®šå‡½æ•°çš„prototype fNOP.prototype = this.prototype; // è¿”å›å‡½æ•°çš„prototypeç­‰äºfNOPå‡½æ•°çš„å®ä¾‹å®ç°ç»§æ‰¿ fBound.prototype = new fNOP(); // ä»¥ä¸Šä¸‰å¥ç›¸å½“äºObject.create(this.prototype) return fBound;&#125;;var func = foo.es3Bind( &#123; a: 1, &#125;, &#x27;1st&#x27;);func(&#x27;2nd&#x27;); // 1 100 1st 2ndfunc.call( &#123; a: 2, &#125;, &#x27;3rd&#x27;); // 1 100 1st 3rdnew func(&#x27;4th&#x27;); //undefined 100 1st 4th es6 å®ç° Function.prototype.es6Bind = function (context, ...rest) &#123; if (typeof this !== &#x27;function&#x27;) throw new TypeError(&#x27;invalid invoked!&#x27;); var self = this; return function F(...args) &#123; if (this instanceof F) &#123; return new self(...rest, ...args); &#125; return self.apply(context, rest.concat(args)); &#125;;&#125;;var func = foo.es6Bind( &#123; a: 1, &#125;, &#x27;1st&#x27;);func(&#x27;2nd&#x27;); // 1 100 1st 2ndfunc.call( &#123; a: 2, &#125;, &#x27;3rd&#x27;); // 1 100 1st 3rdnew func(&#x27;4th&#x27;); //undefined 100 1st 4th","updated":"2025-08-02T05:46:04.176Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"ä½¿ç”¨nodeå¿«é€Ÿå¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨","date":"2021-07-24T03:37:10.000Z","path":"2021/07/24/2021-07-24-start-web-server-quick/","text":"åœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæœ‰æ—¶æˆ‘ä»¬å¯èƒ½éœ€è¦å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæ¥æµ‹è¯•æ¥å£ï¼Œæˆ‘ä»¬ä½¿ç”¨nodeæ¥å¿«é€Ÿå¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ å¯åŠ¨nodeæœåŠ¡å™¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ node çš„ express æ¡†æ¶å»å¯åŠ¨ä¸€ä¸ªæœåŠ¡å™¨ npm install express path æ–°å»º express.js æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ const express = require(&quot;express&quot;);const app = express();const PORT = 8080;const path = require(&quot;path&quot;);let count = 0;app.get(&quot;/test&quot;, (req, res) =&gt; &#123; res.send(&#x27;123&#x27;)&#125;);app.listen(PORT); å¯åŠ¨å‘½ä»¤ node express.js","updated":"2025-08-02T05:46:04.177Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"nodejs","slug":"nodejs","permalink":"https://luckyship.github.io/tags/nodejs/"}]},{"title":"reactåŸºç¡€çŸ¥è¯†","date":"2021-07-18T14:28:03.000Z","path":"2021/07/18/2021-07-18-react-base/","text":"React çš„å“åº”å¼åŸç†React ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿ DOM(virtual DOM)ã€‚å½“ä¸€ä¸ªç»„ä»¶ä¸­çš„çŠ¶æ€æ”¹å˜æ—¶ï¼ŒReact é¦–å…ˆä¼šé€šè¿‡ â€œdiffâ€ ç®—æ³•æ¥æ ‡è®°è™šæ‹Ÿ DOM ä¸­çš„æ”¹å˜ï¼Œç¬¬äºŒæ­¥æ˜¯è°ƒèŠ‚(reconciliation)ï¼Œä¼šç”¨ diff çš„ç»“æœæ¥æ›´æ–°çœŸå® DOMã€‚è™šæ‹ŸDOM ä½œä¸ºä¸€ç§ç¼“å­˜æœºåˆ¶ä¼˜åŒ–äº† UI æ¸²æŸ“å‡å°‘æ˜‚è´µçš„ DOM å˜åŒ–çš„æ•°é‡ã€‚ å¼€å‘è€…åªéœ€å…³æ³¨çŠ¶æ€è½¬ç§»ï¼ˆæ•°æ®ï¼‰ï¼Œå½“çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼ŒReact æ¡†æ¶ä¼šè‡ªåŠ¨æ ¹æ®æ–°çš„çŠ¶æ€é‡æ–°æ„å»º UIã€‚ React æ¡†æ¶åœ¨æ¥æ”¶åˆ°ç”¨æˆ·çŠ¶æ€æ”¹å˜é€šçŸ¥åï¼Œä¼šæ ¹æ®å½“å‰æ¸²æŸ“æ ‘ï¼Œç»“åˆæœ€æ–°çš„çŠ¶æ€æ”¹å˜ï¼Œé€šè¿‡ Diff ç®—æ³•ï¼Œè®¡ç®—å‡ºæ ‘ä¸­å˜åŒ–çš„éƒ¨åˆ†ï¼Œç„¶ååªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†ï¼ˆDOM æ“ä½œï¼‰ï¼Œä»è€Œé¿å…æ•´æ£µæ ‘é‡æ„ï¼Œæé«˜æ€§èƒ½ã€‚çŠ¶æ€å˜åŒ–åReact æ¡†æ¶å¹¶ä¸ä¼šç«‹å³å»è®¡ç®—å¹¶æ¸²æŸ“ DOM æ ‘çš„å˜åŒ–éƒ¨åˆ†ï¼Œç›¸åï¼ŒReact ä¼šåœ¨ DOM çš„åŸºç¡€ä¸Šå»ºç«‹ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œå³è™šæ‹Ÿ DOM æ ‘ï¼Œå¯¹æ•°æ®å’ŒçŠ¶æ€æ‰€åšçš„ä»»ä½•æ”¹åŠ¨ï¼Œéƒ½ä¼šè¢«è‡ªåŠ¨ä¸”é«˜æ•ˆçš„åŒæ­¥åˆ°è™šæ‹Ÿ DOMï¼Œæœ€åå†æ‰¹é‡åŒæ­¥åˆ°çœŸå® DOMä¸­ï¼Œè€Œä¸æ˜¯æ¯æ¬¡æ”¹å˜éƒ½å»æ“ä½œä¸€ä¸‹ DOMã€‚ ä¸ºä»€ä¹ˆä¸èƒ½æ¯æ¬¡æ”¹å˜éƒ½ç›´æ¥å»æ“ä½œ DOM æ ‘ï¼Ÿè¿™æ˜¯å› ä¸ºåœ¨æµè§ˆå™¨ä¸­æ¯ä¸€æ¬¡ DOM æ“ä½œéƒ½æœ‰å¯èƒ½å¼•èµ·æµè§ˆå™¨çš„é‡ç»˜æˆ–å›æµï¼š å¦‚æœ DOM åªæ˜¯å¤–è§‚é£æ ¼å‘ç”Ÿå˜åŒ–ï¼Œå¦‚é¢œè‰²å˜åŒ–ï¼Œä¼šå¯¼è‡´æµè§ˆå™¨é‡ç»˜ç•Œé¢ã€‚ å¦‚æœ DOM æ ‘çš„ç»“æ„å‘ç”Ÿå˜åŒ–ï¼Œå¦‚å°ºå¯¸ã€å¸ƒå±€ã€èŠ‚ç‚¹éšè—ç­‰å¯¼è‡´ï¼Œæµè§ˆå™¨å°±éœ€è¦å›æµï¼ˆåŠé‡æ–°æ’ç‰ˆå¸ƒå±€ï¼‰ã€‚è€Œæµè§ˆå™¨çš„é‡ç»˜å’Œå›æµéƒ½æ˜¯æ¯”è¾ƒæ˜‚è´µçš„æ“ä½œï¼Œå¦‚æœæ¯ä¸€æ¬¡æ”¹å˜éƒ½ç›´æ¥å¯¹ DOM è¿›è¡Œæ“ä½œï¼Œè¿™ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ï¼Œè€Œæ‰¹é‡æ“ä½œåªä¼šè§¦å‘ä¸€æ¬¡ DOM æ›´æ–°ã€‚ ä½¿ç”¨ React æœ‰ä½•ä¼˜ç‚¹ åªéœ€æŸ¥çœ‹ render å‡½æ•°å°±ä¼šå¾ˆå®¹æ˜“çŸ¥é“ä¸€ä¸ªç»„ä»¶æ˜¯å¦‚ä½•è¢«æ¸²æŸ“çš„ JSX çš„å¼•å…¥ï¼Œä½¿å¾—ç»„ä»¶çš„ä»£ç æ›´åŠ å¯è¯»ï¼Œä¹Ÿæ›´å®¹æ˜“çœ‹æ‡‚ç»„ä»¶çš„å¸ƒå±€ï¼Œæˆ–è€…ç»„ä»¶ä¹‹é—´æ˜¯å¦‚ä½•äº’ç›¸å¼•ç”¨çš„ æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“ï¼Œè¿™å¯ä»¥æ”¹è¿› SEO å’Œæ€§èƒ½ æ˜“äºæµ‹è¯• React åªå…³æ³¨ View å±‚ï¼Œæ‰€ä»¥å¯ä»¥å’Œå…¶å®ƒä»»ä½•æ¡†æ¶(å¦‚ Backbone.js, Angular.js)ä¸€èµ·ä½¿ç”¨ å±•ç¤ºç»„ä»¶(Presentational component)å’Œå®¹å™¨ç»„ä»¶(Container component)ä¹‹é—´æœ‰ä½•ä¸åŒå±•ç¤ºç»„ä»¶å…³å¿ƒç»„ä»¶çœ‹èµ·æ¥æ˜¯ä»€ä¹ˆã€‚å±•ç¤ºä¸“é—¨é€šè¿‡ props æ¥å—æ•°æ®å’Œå›è°ƒï¼Œå¹¶ä¸”å‡ ä¹ä¸ä¼šæœ‰è‡ªèº«çš„çŠ¶æ€ï¼Œä½†å½“å±•ç¤ºç»„ä»¶æ‹¥æœ‰è‡ªèº«çš„çŠ¶æ€æ—¶ï¼Œé€šå¸¸ä¹Ÿåªå…³å¿ƒ UI çŠ¶æ€è€Œä¸æ˜¯æ•°æ®çš„çŠ¶æ€ã€‚ å®¹å™¨ç»„ä»¶åˆ™æ›´å…³å¿ƒç»„ä»¶æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚å®¹å™¨ç»„ä»¶ä¼šä¸ºå±•ç¤ºç»„ä»¶æˆ–è€…å…¶å®ƒå®¹å™¨ç»„ä»¶æä¾›æ•°æ®å’Œè¡Œä¸º(behavior)ï¼Œå®ƒä»¬ä¼šè°ƒç”¨ Flux actions ï¼Œå¹¶å°†å…¶ä½œä¸ºå›è°ƒæä¾›ç»™å±•ç¤ºç»„ä»¶ã€‚å®¹å™¨ç»„ä»¶ç»å¸¸æ˜¯æœ‰çŠ¶æ€çš„ï¼Œå› ä¸ºå®ƒä»¬æ˜¯(å…¶å®ƒç»„ä»¶çš„)æ•°æ®æºã€‚ ç±»ç»„ä»¶(Class component)å’Œå‡½æ•°å¼ç»„ä»¶(Functional component)ä¹‹é—´æœ‰ä½•ä¸åŒ ç±»ç»„ä»¶ä¸ä»…å…è®¸ä½ ä½¿ç”¨æ›´å¤šé¢å¤–çš„åŠŸèƒ½ï¼Œå¦‚ç»„ä»¶è‡ªèº«çš„çŠ¶æ€å’Œç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œä¹Ÿèƒ½ä½¿ç»„ä»¶ç›´æ¥è®¿é—® store å¹¶ç»´æŒçŠ¶æ€ å½“ç»„ä»¶ä»…æ˜¯æ¥æ”¶ propsï¼Œå¹¶å°†ç»„ä»¶è‡ªèº«æ¸²æŸ“åˆ°é¡µé¢æ—¶ï¼Œè¯¥ç»„ä»¶å°±æ˜¯ä¸€ä¸ª â€˜æ— çŠ¶æ€ç»„ä»¶(stateless component)â€™ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªçº¯å‡½æ•°æ¥åˆ›å»ºè¿™æ ·çš„ç»„ä»¶ã€‚è¿™ç§ç»„ä»¶ä¹Ÿè¢«ç§°ä¸ºå“‘ç»„ä»¶(dumb components)æˆ–å±•ç¤ºç»„ä»¶ (ç»„ä»¶çš„)çŠ¶æ€(state)å’Œå±æ€§(props)ä¹‹é—´æœ‰ä½•ä¸åŒState æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”¨äºç»„ä»¶æŒ‚è½½æ—¶æ‰€éœ€æ•°æ®çš„é»˜è®¤å€¼ã€‚ State å¯èƒ½ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œå‘ç”Ÿçªå˜ï¼Œä½†å¤šæ•°æ—¶å€™æ˜¯ä½œä¸ºç”¨æˆ·äº‹ä»¶è¡Œä¸ºçš„ç»“æœã€‚ Props (properties çš„ç®€å†™)åˆ™æ˜¯ç»„ä»¶çš„é…ç½®ã€‚ props ç”±çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶ï¼Œå¹¶ä¸”å°±å­ç»„ä»¶è€Œè¨€ï¼Œ props æ˜¯ä¸å¯å˜çš„(immutable)ã€‚ç»„ä»¶ä¸èƒ½æ”¹å˜è‡ªèº«çš„ propsï¼Œä½†æ˜¯å¯ä»¥æŠŠå…¶å­ç»„ä»¶çš„ props æ”¾åœ¨ä¸€èµ·(ç»Ÿä¸€ç®¡ç†)ã€‚Props ä¹Ÿä¸ä»…ä»…æ˜¯æ•°æ®â€“å›è°ƒå‡½æ•°ä¹Ÿå¯ä»¥é€šè¿‡ props ä¼ é€’ã€‚ æŒ‡å‡º(ç»„ä»¶)ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„ä¸åŒ componentWillMount â€“ å¤šç”¨äºæ ¹ç»„ä»¶ä¸­çš„åº”ç”¨ç¨‹åºé…ç½® componentDidMount â€“ åœ¨è¿™å¯ä»¥å®Œæˆæ‰€æœ‰æ²¡æœ‰ DOM å°±ä¸èƒ½åšçš„æ‰€æœ‰é…ç½®ï¼Œå¹¶å¼€å§‹è·å–æ‰€æœ‰ä½ éœ€è¦çš„æ•°æ®ï¼›å¦‚æœéœ€è¦è®¾ç½®äº‹ä»¶ç›‘å¬ï¼Œä¹Ÿå¯ä»¥åœ¨è¿™å®Œæˆ componentWillReceiveProps â€“ è¿™ä¸ªå‘¨æœŸå‡½æ•°ä½œç”¨äºç‰¹å®šçš„ prop æ”¹å˜å¯¼è‡´çš„ state è½¬æ¢ shouldComponentUpdate â€“ å¦‚æœä½ æ‹…å¿ƒç»„ä»¶è¿‡åº¦æ¸²æŸ“ï¼ŒshouldComponentUpdate æ˜¯ä¸€ä¸ªæ”¹å–„æ€§èƒ½çš„åœ°æ–¹ï¼Œå› ä¸ºå¦‚æœç»„ä»¶æ¥æ”¶äº†æ–°çš„ propï¼Œ å®ƒå¯ä»¥é˜»æ­¢(ç»„ä»¶)é‡æ–°æ¸²æŸ“ã€‚shouldComponentUpdate åº”è¯¥è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼æ¥å†³å®šç»„ä»¶æ˜¯å¦è¦é‡æ–°æ¸²æŸ“ componentWillUpdate â€“ å¾ˆå°‘ä½¿ç”¨ã€‚å®ƒå¯ä»¥ç”¨äºä»£æ›¿ç»„ä»¶çš„ componentWillReceiveProps å’Œ shouldComponentUpdate(ä½†ä¸èƒ½è®¿é—®ä¹‹å‰çš„ props) componentDidUpdate â€“ å¸¸ç”¨äºæ›´æ–° DOMï¼Œå“åº” prop æˆ– state çš„æ”¹å˜ componentWillUnmount â€“ åœ¨è¿™ä½ å¯ä»¥å–æ¶ˆç½‘ç»œè¯·æ±‚ï¼Œæˆ–è€…ç§»é™¤æ‰€æœ‰ä¸ç»„ä»¶ç›¸å…³çš„äº‹ä»¶ç›‘å¬å™¨ åº”è¯¥åœ¨ React ç»„ä»¶çš„ä½•å¤„å‘èµ· Ajax è¯·æ±‚åœ¨ React ç»„ä»¶ä¸­ï¼Œåº”è¯¥åœ¨ componentDidMount ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚ã€‚è¿™ä¸ªæ–¹æ³•ä¼šåœ¨ç»„ä»¶ç¬¬ä¸€æ¬¡â€œæŒ‚è½½â€(è¢«æ·»åŠ åˆ° DOM)æ—¶æ‰§è¡Œï¼Œåœ¨ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸­ä»…ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œä½ ä¸èƒ½ä¿è¯åœ¨ç»„ä»¶æŒ‚è½½ä¹‹å‰ Ajax è¯·æ±‚å·²ç»å®Œæˆï¼Œå¦‚æœæ˜¯è¿™æ ·ï¼Œä¹Ÿå°±æ„å‘³ç€ä½ å°†å°è¯•åœ¨ä¸€ä¸ªæœªæŒ‚è½½çš„ç»„ä»¶ä¸Šè°ƒç”¨ setStateï¼Œè¿™å°†ä¸èµ·ä½œç”¨ã€‚åœ¨ componentDidMount ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚å°†ä¿è¯è¿™æœ‰ä¸€ä¸ªç»„ä»¶å¯ä»¥æ›´æ–°äº†ã€‚ ä½•ä¸ºå—æ§ç»„ä»¶(controlled component)åœ¨ HTML ä¸­ï¼Œç±»ä¼¼ &lt;input&gt; , &lt;textarea&gt; å’Œ &lt;select&gt; è¿™æ ·çš„è¡¨å•å…ƒç´ ä¼šç»´æŠ¤è‡ªèº«çš„çŠ¶æ€ï¼Œå¹¶åŸºäºç”¨æˆ·çš„è¾“å…¥æ¥æ›´æ–°ã€‚å½“ç”¨æˆ·æäº¤è¡¨å•æ—¶ï¼Œå‰é¢æåˆ°çš„å…ƒç´ çš„å€¼å°†éšè¡¨å•ä¸€èµ·è¢«å‘é€ã€‚ä½†åœ¨ React ä¸­ä¼šæœ‰äº›ä¸åŒï¼ŒåŒ…å«è¡¨å•å…ƒç´ çš„ç»„ä»¶å°†ä¼šåœ¨ state ä¸­è¿½è¸ªè¾“å…¥çš„å€¼ï¼Œå¹¶ä¸”æ¯æ¬¡è°ƒç”¨å›è°ƒå‡½æ•°æ—¶ï¼Œå¦‚ onChange ä¼šæ›´æ–° stateï¼Œé‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚ä¸€ä¸ªè¾“å…¥è¡¨å•å…ƒç´ ï¼Œå®ƒçš„å€¼é€šè¿‡ React çš„è¿™ç§æ–¹å¼æ¥æ§åˆ¶ï¼Œè¿™æ ·çš„å…ƒç´ å°±è¢«ç§°ä¸ºâ€å—æ§å…ƒç´ â€ã€‚ åœ¨ React ä¸­ï¼Œrefs çš„ä½œç”¨æ˜¯ä»€ä¹ˆRefs å¯ä»¥ç”¨äºè·å–ä¸€ä¸ª DOM èŠ‚ç‚¹æˆ–è€… React ç»„ä»¶(ç»„ä»¶å®ä¾‹)çš„å¼•ç”¨ã€‚ä½•æ—¶ä½¿ç”¨ refs çš„å¥½çš„ç¤ºä¾‹æœ‰ç®¡ç†ç„¦ç‚¹/æ–‡æœ¬é€‰æ‹©ï¼Œè§¦å‘å‘½ä»¤åŠ¨ç”»ï¼Œæˆ–è€…å’Œç¬¬ä¸‰æ–¹ DOM åº“é›†æˆã€‚ä½ åº”è¯¥é¿å…ä½¿ç”¨ String ç±»å‹çš„ Refs å’Œå†…è”çš„ ref å›è°ƒã€‚Refs å›è°ƒæ˜¯ React æ‰€æ¨èçš„ã€‚ ä¸‰ç§ ref æ–¹å¼ string ç±»å‹ç»‘å®šç±»ä¼¼äº vue ä¸­çš„ ref ç»‘å®šæ–¹å¼ï¼Œå¯ä»¥é€šè¿‡ this.refs. ç»‘å®šçš„ ref çš„åå­—è·å–åˆ°èŠ‚ç‚¹ domï¼Œæ³¨æ„çš„æ˜¯è¿™ç§æ–¹å¼å·²ç»ä¸è¢«æœ€æ–°ç‰ˆçš„ react æ¨èä½¿ç”¨ï¼Œæœ‰å¯èƒ½ä¼šåœ¨æœªæ¥ç‰ˆæœ¬ä¸­é—å¼ƒã€‚ focus = () =&gt; &#123; this.refs.inputRef.focus() &#125; &lt;input ref = &quot;inputRef&quot; /&gt; // è·å–å­ç»„ä»¶çš„div // çˆ¶ç»„ä»¶ &lt;Child myRef = &#123; this.state.myDiv &#125;/&gt;// å­ç»„ä»¶&lt;div ref = &#123; this.props.myRef&#125; &gt; æˆ‘æ˜¯å­ç»„ä»¶ &lt;/div&gt; react.CreateRef()é€šè¿‡åœ¨ class ä¸­ä½¿ç”¨ React.createRef()æ–¹æ³•åˆ›å»ºä¸€äº›å˜é‡ï¼Œå¯ä»¥å°†è¿™äº›å˜é‡ç»‘å®šåˆ°æ ‡ç­¾çš„ ref ä¸­ï¼Œè¯¥å˜é‡çš„ current åˆ™æŒ‡å‘ç»‘å®šçš„æ ‡ç­¾ domã€‚ inputRef = React.createRef()focus = () =&gt; &#123; this.inputRef.current.focus() &#125; &lt; input ref = &#123; this.inputRef &#125;/&gt; å‡½æ•°å½¢å¼åœ¨ class ä¸­å£°æ˜å‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­ç»‘å®š ref ä½¿ç”¨è¿™ç§æ–¹æ³•å¯ä»¥å°†å­ç»„ä»¶æš´éœ²ç»™çˆ¶ç»„ä»¶ä»¥ä½¿å¾—çˆ¶ç»„ä»¶èƒ½å¤Ÿè°ƒç”¨å­ç»„ä»¶çš„æ–¹æ³• inputRef = nullfocus = () =&gt; &#123; this.inputRef.focus() &#125; &lt; input ref = &#123; (el) =&gt; this.inputRef = el &#125;/&gt; useRef(å®ä¾‹å±æ€§) function UseRefDemo() &#123; const inputRef = useRef(null as any) const handleFocusInput = () =&gt; &#123; inputRef.current.focus() &#125; return ( &lt;div&gt; &lt;input ref = &#123; inputRef &#125; /&gt; &lt; button onClick = &#123; handleFocusInput &#125; &gt; click focus &lt; /button&gt; &lt; /div&gt; )&#125; forwardRef(è·å–ç»„ä»¶å†…çš„å¼•ç”¨) // å­ç»„ä»¶const Child = forwardRef((props, ref) =&gt; &#123; return ( &lt; div ref = &#123; ref &#125; &gt; &#123; props.txt &#125; &lt; /div&gt; ) &#125;) // çˆ¶ç»„ä»¶ &lt; Child ref = &#123; this.state.myDiv &#125;txt = &quot;parent props txt&quot; / &gt; æ³¨æ„: react å¹¶ä¸æ¨èè¿‡åº¦ä½¿ç”¨ refï¼Œå¦‚æœèƒ½é€šè¿‡ state åšåˆ°çš„äº‹æƒ…ï¼Œå°±ä¸åº”è¯¥ä½¿ç”¨ refs åœ¨ä½ çš„ app ä¸­â€œè®©äº‹æƒ…å‘ç”Ÿâ€ã€‚è¿‡åº¦ä½¿ç”¨ ref å¹¶ä¸ç¬¦åˆæ•°æ®é©±åŠ¨çš„æ€æƒ³ã€‚ ä½•ä¸ºé«˜é˜¶ç»„ä»¶(higher order component)é«˜é˜¶ç»„ä»¶æ˜¯ä¸€ä¸ªä»¥ç»„ä»¶ä¸ºå‚æ•°å¹¶è¿”å›ä¸€ä¸ªæ–°ç»„ä»¶çš„å‡½æ•°ã€‚HOC è¿è¡Œä½ é‡ç”¨ä»£ç ã€é€»è¾‘å’Œå¼•å¯¼æŠ½è±¡ã€‚æœ€å¸¸è§çš„å¯èƒ½æ˜¯ Redux çš„ connect å‡½æ•°ã€‚é™¤äº†ç®€å•åˆ†äº«å·¥å…·åº“å’Œç®€å•çš„ç»„åˆï¼ŒHOC æœ€å¥½çš„æ–¹å¼æ˜¯å…±äº« React ç»„ä»¶ä¹‹é—´çš„è¡Œä¸ºã€‚å¦‚æœä½ å‘ç°ä½ åœ¨ä¸åŒçš„åœ°æ–¹å†™äº†å¤§é‡ä»£ç æ¥åšåŒä¸€ä»¶äº‹æ—¶ï¼Œå°±åº”è¯¥è€ƒè™‘å°†ä»£ç é‡æ„ä¸ºå¯é‡ç”¨çš„ HOCã€‚è£…é¥°å™¨@decorationä¼˜ç‚¹: é€»è¾‘å¤ç”¨ ä¸å½±å“è¢«åŒ…è£¹ç»„ä»¶çš„é€»è¾‘ ç¼ºç‚¹: ä¼ é€’çš„ props å’ŒåŒ…è£¹ç»„ä»¶çš„ props å‘ç”Ÿé‡åä¼šè¦†ç›– ç»„ä»¶åµŒå¥—å¯¼è‡´å±‚çº§è¿‡æ·± æ¸²æŸ“å±æ€§(render props)Render prop æ˜¯ä¸€ä¸ªå‘ŠçŸ¥ç»„ä»¶éœ€è¦æ¸²æŸ“ä»€ä¹ˆå†…å®¹çš„å‡½æ•° propä¼˜ç‚¹: é€»è¾‘å¤ç”¨ æ•°æ®å…±äº« ç¼ºç‚¹: åµŒå¥— æ— æ³•åœ¨ return è¯­å¥å¤–è®¿é—®æ•°æ® ä½¿ç”¨ç®­å¤´å‡½æ•°(arrow functions)çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆ ä½œç”¨åŸŸå®‰å…¨ï¼šåœ¨ç®­å¤´å‡½æ•°ä¹‹å‰ï¼Œæ¯ä¸€ä¸ªæ–°åˆ›å»ºçš„å‡½æ•°éƒ½æœ‰å®šä¹‰è‡ªèº«çš„ this å€¼(åœ¨æ„é€ å‡½æ•°ä¸­æ˜¯æ–°å¯¹è±¡ï¼›åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå‡½æ•°è°ƒç”¨ä¸­çš„ this æ˜¯æœªå®šä¹‰çš„ï¼›å¦‚æœå‡½æ•°è¢«ç§°ä¸ºâ€œå¯¹è±¡æ–¹æ³•â€ï¼Œåˆ™ä¸ºåŸºç¡€å¯¹è±¡ç­‰)ï¼Œä½†ç®­å¤´å‡½æ•°ä¸ä¼šï¼Œå®ƒä¼šä½¿ç”¨å°é—­æ‰§è¡Œä¸Šä¸‹æ–‡çš„ this å€¼ã€‚ ç®€å•ï¼šç®­å¤´å‡½æ•°æ˜“äºé˜…è¯»å’Œä¹¦å†™ æ¸…æ™°ï¼šå½“ä¸€åˆ‡éƒ½æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œä»»ä½•å¸¸è§„å‡½æ•°éƒ½å¯ä»¥ç«‹å³ç”¨äºå®šä¹‰ä½œç”¨åŸŸã€‚å¼€å‘è€…æ€»æ˜¯å¯ä»¥æŸ¥æ‰¾ next-higher å‡½æ•°è¯­å¥ï¼Œä»¥æŸ¥çœ‹ this çš„å€¼ ä¸ºä»€ä¹ˆå»ºè®®ä¼ é€’ç»™ setState çš„å‚æ•°æ˜¯ä¸€ä¸ª callback è€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡å› ä¸º this.props å’Œ this.state çš„æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä¸èƒ½ä¾èµ–å®ƒä»¬çš„å€¼å»è®¡ç®—ä¸‹ä¸€ä¸ª stateã€‚setState åœ¨ç”Ÿå‘½å‘¨æœŸé‡Œæ˜¯å¼‚æ­¥çš„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç»„ä»¶é‡æ–°æ¸²æŸ“å®Œæˆåçš„å›è°ƒã€‚ é™¤äº†åœ¨æ„é€ å‡½æ•°ä¸­ç»‘å®š this ï¼Œè¿˜æœ‰å…¶å®ƒæ–¹å¼å—åœ¨ constructor é‡Œä½¿ç”¨ bindã€‚åœ¨å›è°ƒä¸­ä½ å¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œä½†é—®é¢˜æ˜¯æ¯æ¬¡ç»„ä»¶æ¸²æŸ“æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å›è°ƒã€‚ æ€ä¹ˆé˜»æ­¢ç»„ä»¶çš„æ¸²æŸ“åœ¨ç»„ä»¶çš„ render æ–¹æ³•ä¸­è¿”å› null å¹¶ä¸ä¼šå½±å“è§¦å‘ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³• react ä¸ vue æ•°ç»„ä¸­ key çš„ä½œç”¨æ˜¯ä»€ä¹ˆdiff ç®—æ³•éœ€è¦æ¯”å¯¹è™šæ‹Ÿ dom çš„ä¿®æ”¹ï¼Œç„¶åå¼‚æ­¥çš„æ¸²æŸ“åˆ°é¡µé¢ä¸­ï¼Œå½“å‡ºç°å¤§é‡ç›¸åŒçš„æ ‡ç­¾æ—¶ï¼Œvnode ä¼šé¦–å…ˆåˆ¤æ–­ key å’Œæ ‡ç­¾åæ˜¯å¦ä¸€è‡´ï¼Œå¦‚æœä¸€è‡´å†å»åˆ¤æ–­å­èŠ‚ç‚¹ä¸€è‡´ï¼Œä½¿ç”¨ key å¯ä»¥å¸®åŠ© diff ç®—æ³•æå‡åˆ¤æ–­çš„é€Ÿåº¦ï¼Œåœ¨é¡µé¢é‡æ–°æ¸²æŸ“æ—¶æ›´å¿«æ¶ˆè€—æ›´å°‘ã€‚ (åœ¨æ„é€ å‡½æ•°ä¸­)è°ƒç”¨ super(props) çš„ç›®çš„æ˜¯ä»€ä¹ˆåœ¨ super() è¢«è°ƒç”¨ä¹‹å‰ï¼Œå­ç±»æ˜¯ä¸èƒ½ä½¿ç”¨ this çš„ï¼Œåœ¨ ES2015 ä¸­ï¼Œå­ç±»å¿…é¡»åœ¨ constructor ä¸­è°ƒç”¨ super() ã€‚ä¼ é€’ props ç»™ super() çš„åŸå› åˆ™æ˜¯ä¾¿äº(åœ¨å­ç±»ä¸­)èƒ½åœ¨ constructor è®¿é—® this.props ã€‚ ä½•ä¸º JSXJSX æ˜¯ JavaScript è¯­æ³•çš„ä¸€ç§è¯­æ³•æ‰©å±•ï¼Œå¹¶æ‹¥æœ‰ JavaScript çš„å…¨éƒ¨åŠŸèƒ½ã€‚JSX ç”Ÿäº§ React â€œå…ƒç´ â€ï¼Œä½ å¯ä»¥å°†ä»»ä½•çš„ JavaScript è¡¨è¾¾å¼å°è£…åœ¨èŠ±æ‹¬å·é‡Œï¼Œç„¶åå°†å…¶åµŒå…¥åˆ° JSX ä¸­ã€‚åœ¨ç¼–è¯‘å®Œæˆä¹‹åï¼ŒJSX è¡¨è¾¾å¼å°±å˜æˆäº†å¸¸è§„çš„ JavaScript å¯¹è±¡ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ if è¯­å¥å’Œ for å¾ªç¯å†…éƒ¨ä½¿ç”¨ JSXï¼Œå°†å®ƒèµ‹å€¼ç»™å˜é‡ï¼Œæ¥å—å®ƒä½œä¸ºå‚æ•°ï¼Œå¹¶ä»å‡½æ•°ä¸­è¿”å›å®ƒã€‚ ç¼ºç‚¹ï¼šb&amp;&amp; å¼ºè½¬æˆ boolean ç±»å‹ å¦åˆ™å¦‚æœ b=0 æ¸²æŸ“å‡º 0 æ€ä¹ˆç”¨ React.createElement é‡å†™ä¸‹é¢çš„ä»£ç Questionï¼š const element = &lt;h1 className=&quot;greeting&quot;&gt;Hello, world!&lt;/h1&gt;; Answerï¼š const element = React.createElement( &#x27;h1&#x27;, &#123; className: &#x27;greeting&#x27;, &#125;, &#x27;Hello, world!&#x27;); ä½•ä¸º Childrenåœ¨ JSX è¡¨è¾¾å¼ä¸­ï¼Œä¸€ä¸ªå¼€å§‹æ ‡ç­¾(æ¯”å¦‚ &lt;a&gt; )å’Œä¸€ä¸ªå…³é—­æ ‡ç­¾(æ¯”å¦‚ &lt;/a&gt; )ä¹‹é—´çš„å†…å®¹ä¼šä½œä¸ºä¸€ä¸ªç‰¹æ®Šçš„å±æ€§ props.children è¢«è‡ªåŠ¨ä¼ é€’ç»™åŒ…å«ç€å®ƒçš„ç»„ä»¶ã€‚ è¿™ä¸ªå±æ€§æœ‰è®¸å¤šå¯ç”¨çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬ React. Children.map ï¼Œ React. Children.forEach ï¼Œ React. Children.count ï¼Œ React. Children.only ï¼Œ React. Children.toArray ã€‚ åœ¨ React ä¸­ï¼Œä½•ä¸º stateState å’Œ props ç±»ä¼¼ï¼Œä½†å®ƒæ˜¯ç§æœ‰çš„ï¼Œå¹¶ä¸”å®Œå…¨ç”±ç»„ä»¶è‡ªèº«æ§åˆ¶ã€‚State æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæŒæœ‰æ•°æ®ï¼Œå¹¶å†³å®šç»„ä»¶å¦‚ä½•æ¸²æŸ“çš„å¯¹è±¡ã€‚ ä½ ä¸ºä½•æ’æ–¥ create-react-appåœ¨ä½ æ’æ–¥ä¹‹å‰ï¼Œä½ å¹¶ä¸èƒ½å»é…ç½® webpack æˆ– babel presetsã€‚ ä½•ä¸º reduxRedux çš„åŸºæœ¬æ€æƒ³æ˜¯æ•´ä¸ªåº”ç”¨çš„ state ä¿æŒåœ¨ä¸€ä¸ªå•ä¸€çš„ store ä¸­ã€‚store å°±æ˜¯ä¸€ä¸ªç®€å•çš„ javascript å¯¹è±¡ï¼Œè€Œæ”¹å˜åº”ç”¨ state çš„å”¯ä¸€æ–¹å¼æ˜¯åœ¨åº”ç”¨ä¸­è§¦å‘ actionsï¼Œç„¶åä¸ºè¿™äº› actions ç¼–å†™ reducers æ¥ä¿®æ”¹ stateã€‚æ•´ä¸ª state è½¬åŒ–æ˜¯åœ¨ reducers ä¸­å®Œæˆï¼Œå¹¶ä¸”ä¸åº”è¯¥ç”±ä»»ä½•å‰¯ä½œç”¨ã€‚ åœ¨ Redux ä¸­ï¼Œä½•ä¸º storeStore æ˜¯ä¸€ä¸ª javascript å¯¹è±¡ï¼Œå®ƒä¿å­˜äº†æ•´ä¸ªåº”ç”¨çš„ stateã€‚ä¸æ­¤åŒæ—¶ï¼ŒStore ä¹Ÿæ‰¿æ‹…ä»¥ä¸‹èŒè´£ï¼š å…è®¸é€šè¿‡ getState() è®¿é—® state è¿è¡Œé€šè¿‡ dispatch(action) æ”¹å˜ state é€šè¿‡ subscribe(listener) æ³¨å†Œ listeners é€šè¿‡ subscribe(listener) è¿”å›çš„å‡½æ•°å¤„ç† listeners çš„æ³¨é”€ ä½•ä¸º actionActions æ˜¯ä¸€ä¸ªçº¯ javascript å¯¹è±¡ï¼Œå®ƒä»¬å¿…é¡»æœ‰ä¸€ä¸ª type å±æ€§è¡¨æ˜æ­£åœ¨æ‰§è¡Œçš„ action çš„ç±»å‹ã€‚å®è´¨ä¸Šï¼Œaction æ˜¯å°†æ•°æ®ä»åº”ç”¨ç¨‹åºå‘é€åˆ° store çš„æœ‰æ•ˆè½½è·ã€‚ ä½•ä¸º reducerä¸€ä¸ª reducer æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œè¯¥å‡½æ•°ä»¥å…ˆå‰çš„ state å’Œä¸€ä¸ª action ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸‹ä¸€ä¸ª stateã€‚ Redux Thunk çš„ä½œç”¨æ˜¯ä»€ä¹ˆRedux thunk æ˜¯ä¸€ä¸ªå…è®¸ä½ ç¼–å†™è¿”å›ä¸€ä¸ªå‡½æ•°è€Œä¸æ˜¯ä¸€ä¸ª action çš„ actions creators çš„ä¸­é—´ä»¶ã€‚å¦‚æœæ»¡è¶³æŸä¸ªæ¡ä»¶ï¼Œthunk åˆ™å¯ä»¥ç”¨æ¥å»¶è¿Ÿ action çš„æ´¾å‘(dispatch)ï¼Œè¿™å¯ä»¥å¤„ç†å¼‚æ­¥ action çš„æ´¾å‘(dispatch)ã€‚ ä½•ä¸ºçº¯å‡½æ•°(pure function)ä¸€ä¸ªçº¯å‡½æ•°æ˜¯ä¸€ä¸ªä¸ä¾èµ–äºä¸”ä¸æ”¹å˜å…¶ä½œç”¨åŸŸä¹‹å¤–çš„å˜é‡çŠ¶æ€çš„å‡½æ•°ï¼Œè¿™ä¹Ÿæ„å‘³ç€ä¸€ä¸ªçº¯å‡½æ•°å¯¹äºåŒæ ·çš„å‚æ•°æ€»æ˜¯è¿”å›åŒæ ·çš„ç»“æœã€‚ åŒè¾“å…¥åŒè¾“å‡º æ— å‰¯ä½œç”¨(å‡½æ•°å†…éƒ¨çš„æ“ä½œä¸ä¼šå¯¹å¤–éƒ¨äº§ç”Ÿå½±å“(å¦‚ä¿®æ”¹å…¨å±€å˜é‡çš„å€¼ã€ä¿®æ”¹ dom èŠ‚ç‚¹ç­‰)) redux æœ‰å“ªäº›ä¸­é—´ä»¶ï¼Œä½œç”¨ï¼Ÿä¸­é—´ä»¶æä¾›ç¬¬ä¸‰æ–¹æ’ä»¶çš„æ¨¡å¼ï¼Œè‡ªå®šä¹‰æ‹¦æˆª action -&gt; reducer çš„è¿‡ç¨‹ã€‚å˜ä¸º action -&gt; middlewares -&gt; reducer ã€‚è¿™ç§æœºåˆ¶å¯ä»¥è®©æˆ‘ä»¬æ”¹å˜æ•°æ®æµï¼Œå®ç°å¦‚å¼‚æ­¥ action ï¼Œaction è¿‡æ»¤ï¼Œæ—¥å¿—è¾“å‡ºï¼Œå¼‚å¸¸æŠ¥å‘Šç­‰åŠŸèƒ½ã€‚ redux-loggerï¼šæä¾›æ—¥å¿—è¾“å‡º redux-thunkï¼šå¤„ç†å¼‚æ­¥æ“ä½œ redux-promiseï¼šå¤„ç†å¼‚æ­¥æ“ä½œï¼ŒactionCreator çš„è¿”å›å€¼æ˜¯ promise ç¤ºä¾‹é¡¹ç›® React Spotify React Soundcloud è™šæ‹Ÿ dom(è™šæ‹ŸèŠ‚ç‚¹)æ˜¯ç”¨ JS å¯¹è±¡æ¥æ¨¡æ‹ŸçœŸå® DOM ä¸­çš„èŠ‚ç‚¹è™šæ‹Ÿ dom ç›¸å½“äºåœ¨ js å’ŒçœŸå® dom ä¸­é—´åŠ äº†ä¸€ä¸ªç¼“å­˜ï¼Œåˆ©ç”¨ dom diff ç®—æ³•é¿å…äº†æ²¡æœ‰å¿…è¦çš„ dom æ“ä½œï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚å…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼šç”¨ JavaScript å¯¹è±¡ç»“æ„è¡¨ç¤º DOM æ ‘çš„ç»“æ„ï¼›ç„¶åç”¨è¿™ä¸ªæ ‘æ„å»ºä¸€ä¸ªçœŸæ­£çš„ DOM æ ‘ï¼Œæ’åˆ°æ–‡æ¡£å½“ä¸­å½“çŠ¶æ€å˜æ›´çš„æ—¶å€™ï¼Œé‡æ–°æ„é€ ä¸€æ£µæ–°çš„å¯¹è±¡æ ‘ã€‚ç„¶åç”¨æ–°çš„æ ‘å’Œæ—§çš„æ ‘è¿›è¡Œæ¯”è¾ƒï¼Œè®°å½•ä¸¤æ£µæ ‘å·®å¼‚æŠŠ 2 æ‰€è®°å½•çš„å·®å¼‚åº”ç”¨åˆ°æ­¥éª¤ 1 æ‰€æ„å»ºçš„çœŸæ­£çš„ DOM æ ‘ä¸Šï¼Œè§†å›¾å°±æ›´æ–°äº†ã€‚æ’å…¥æ–°ç»„ä»¶æœ‰äº† key å¯ä»¥å¸®åŠ© react æ‰¾åˆ°æ˜ å°„ã€‚ çœŸå®çš„å…ƒç´ èŠ‚ç‚¹ &lt;div id=&quot;wrap&quot;&gt; &lt;p class=&quot;title&quot;&gt;Hello world!&lt;/p&gt;&lt;/div&gt; vnode &#123; tag: &#x27;div&#x27;, attrs: &#123; id: &#x27;wrap&#x27; &#125;, children: [&#123; tag: &#x27;p&#x27;, text: &#x27;Hello world!&#x27;, attrs: &#123; class: &#x27;title&#x27;, &#125; &#125;]&#125; ä¸ºä»€ä¹ˆä½¿ç”¨è™šæ‹Ÿ domèµ·åˆæˆ‘ä»¬åœ¨ä½¿ç”¨ JS/JQuery æ—¶ï¼Œä¸å¯é¿å…çš„ä¼šå¤§é‡æ“ä½œ DOMï¼Œè€Œ DOM çš„å˜åŒ–åˆä¼šå¼•å‘å›æµæˆ–é‡ç»˜ï¼Œä»è€Œé™ä½é¡µé¢æ¸²æŸ“æ€§èƒ½ã€‚é‚£ä¹ˆæ€æ ·æ¥å‡å°‘å¯¹ DOM çš„æ“ä½œå‘¢ï¼Ÿæ­¤æ—¶è™šæ‹Ÿ DOMåº”ç”¨è€Œç”Ÿï¼Œæ‰€ä»¥è™šæ‹Ÿ DOM å‡ºç°çš„ä¸»è¦ç›®çš„å°±æ˜¯ ä¸ºäº†å‡å°‘é¢‘ç¹æ“ä½œDOMè€Œå¼•èµ·å›æµé‡ç»˜æ‰€å¼•å‘çš„æ€§èƒ½é—®é¢˜çš„ è™šæ‹Ÿ dom çš„ä½œç”¨å…¼å®¹æ€§å¥½ã€‚å› ä¸º Vnode æœ¬è´¨æ˜¯ JS å¯¹è±¡ï¼Œæ‰€ä»¥ä¸ç®¡ Node è¿˜æ˜¯æµè§ˆå™¨ç¯å¢ƒï¼Œéƒ½å¯ä»¥æ“ä½œï¼›å‡å°‘äº†å¯¹ Dom çš„æ“ä½œã€‚é¡µé¢ä¸­çš„æ•°æ®å’ŒçŠ¶æ€å˜åŒ–ï¼Œéƒ½é€šè¿‡ Vnode å¯¹æ¯”ï¼Œåªéœ€è¦åœ¨æ¯”å¯¹å®Œä¹‹åæ›´æ–° DOMï¼Œä¸éœ€è¦é¢‘ç¹æ“ä½œï¼Œæé«˜äº†é¡µé¢æ€§èƒ½ã€‚ æ¯ä¸ª setState é‡æ–°æ¸²æŸ“æ•´ä¸ªå­æ ‘æ ‡è®°ä¸º dirtyã€‚ å¦‚æœè¦å‹ç¼©æ€§èƒ½ï¼Œè¯·å°½å¯èƒ½è°ƒç”¨ setStateï¼Œå¹¶ä½¿ç”¨ shouldComponentUpdate æ¥é˜²æ­¢é‡æ–°æ¸²æŸ“å¤§å‹å­æ ‘ã€‚æŠŠæ ‘å½¢ç»“æ„æŒ‰ç…§å±‚çº§åˆ†è§£ï¼Œåªæ¯”è¾ƒåŒçº§å…ƒç´ ã€‚ç»™åˆ—è¡¨ç»“æ„çš„æ¯ä¸ªå•å…ƒæ·»åŠ å”¯ä¸€çš„ key å±æ€§ï¼Œæ–¹ä¾¿æ¯”è¾ƒã€‚pureComponent(æµ…æ¯”è¾ƒ)+immutable æ›¿æ¢æˆ preact diff ç®—æ³• ä¸€å¼€å§‹ä¼šæ ¹æ®çœŸå® DOM ç”Ÿæˆè™šæ‹Ÿ DOMï¼Œå½“è™šæ‹Ÿ DOM æŸä¸ªèŠ‚ç‚¹çš„æ•°æ®æ”¹å˜åä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ Vnodeï¼Œç„¶å VNode å’Œ oldVnode å¯¹æ¯”ï¼ŒæŠŠä¸åŒçš„åœ°æ–¹ä¿®æ”¹åœ¨çœŸå® DOM ä¸Šï¼Œæœ€åå†ä½¿å¾— oldVnode çš„å€¼ä¸º Vnodeã€‚ diffè¿‡ç¨‹å°±æ˜¯è°ƒç”¨patchå‡½æ•°ï¼Œæ¯”è¾ƒæ–°è€èŠ‚ç‚¹ï¼Œä¸€è¾¹æ¯”è¾ƒä¸€è¾¹ç»™çœŸå®DOMæ‰“è¡¥ä¸(patch)ï¼› æŠŠæ ‘å½¢ç»“æ„æŒ‰ç…§å±‚çº§åˆ†è§£ï¼Œåªæ¯”è¾ƒåŒçº§å…ƒç´ ã€‚ ç»™åˆ—è¡¨ç»“æ„çš„æ¯ä¸ªå•å…ƒæ·»åŠ å”¯ä¸€çš„ key å±æ€§ï¼Œæ–¹ä¾¿æ¯”è¾ƒã€‚ React åªä¼šåŒ¹é…ç›¸åŒ class çš„ componentï¼ˆè¿™é‡Œé¢çš„ class æŒ‡çš„æ˜¯ç»„ä»¶çš„åå­—ï¼‰ åˆå¹¶æ“ä½œï¼Œè°ƒç”¨ component çš„ setState æ–¹æ³•çš„æ—¶å€™, React å°†å…¶æ ‡è®°ä¸º dirty. åˆ°æ¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯ç»“æŸ, React æ£€æŸ¥æ‰€æœ‰æ ‡è®° dirty çš„ component é‡æ–°ç»˜åˆ¶. é€‰æ‹©æ€§å­æ ‘æ¸²æŸ“ã€‚å¼€å‘äººå‘˜å¯ä»¥é‡å†™ shouldComponentUpdate æé«˜ diff çš„æ€§èƒ½ã€‚ diff çš„åªæ˜¯ html tagï¼Œå¹¶æ²¡æœ‰ diff æ•°æ®ã€‚ setState çš„ç†è§£ setState åªåœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°(é™¤äº†componentDidUpdate)ä¸­æ˜¯â€œå¼‚æ­¥â€çš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’Œ setTimeout ä¸­éƒ½æ˜¯åŒæ­¥çš„ã€‚ setState çš„â€œå¼‚æ­¥â€å¹¶ä¸æ˜¯è¯´å†…éƒ¨ç”±å¼‚æ­¥ä»£ç å®ç°ï¼Œå…¶å®æœ¬èº«æ‰§è¡Œçš„è¿‡ç¨‹å’Œä»£ç éƒ½æ˜¯åŒæ­¥çš„ï¼Œåªæ˜¯åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°çš„è°ƒç”¨é¡ºåºåœ¨æ›´æ–°ä¹‹å‰ï¼Œå¯¼è‡´åœ¨åˆæˆäº‹ä»¶å’Œé’©å­å‡½æ•°ä¸­æ²¡æ³•ç«‹é©¬æ‹¿åˆ°æ›´æ–°åçš„å€¼ï¼Œå½¢æˆäº†æ‰€è°“çš„â€œå¼‚æ­¥â€ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡ç¬¬äºŒä¸ªå‚æ•° setState(partialState, callback) ä¸­çš„ callback æ‹¿åˆ°æ›´æ–°åçš„ç»“æœã€‚ setState çš„æ‰¹é‡æ›´æ–°ä¼˜åŒ–ä¹Ÿæ˜¯å»ºç«‹åœ¨â€œå¼‚æ­¥â€ï¼ˆåˆæˆäº‹ä»¶ã€é’©å­å‡½æ•°ï¼‰ä¹‹ä¸Šçš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’Œ setTimeout ä¸­ä¸ä¼šæ‰¹é‡æ›´æ–°ï¼Œåœ¨â€œå¼‚æ­¥â€ä¸­å¦‚æœå¯¹åŒä¸€ä¸ªå€¼è¿›è¡Œå¤šæ¬¡ setStateï¼ŒsetState çš„æ‰¹é‡æ›´æ–°ç­–ç•¥ä¼šå¯¹å…¶è¿›è¡Œè¦†ç›–ï¼Œå–æœ€åä¸€æ¬¡çš„æ‰§è¡Œï¼Œå¦‚æœæ˜¯åŒæ—¶ setState å¤šä¸ªä¸åŒçš„å€¼ï¼Œåœ¨æ›´æ–°æ—¶ä¼šå¯¹å…¶è¿›è¡Œåˆå¹¶æ‰¹é‡æ›´æ–°ã€‚ å¼‚æ­¥ä¸åŒæ­¥: setState å¹¶ä¸æ˜¯å•çº¯çš„å¼‚æ­¥æˆ–åŒæ­¥ï¼Œè¿™å…¶å®ä¸è°ƒç”¨æ—¶çš„ç¯å¢ƒç›¸å…³: åœ¨ åˆæˆäº‹ä»¶ å’Œ ç”Ÿå‘½å‘¨æœŸé’©å­(é™¤ componentDidUpdate) ä¸­ï¼ŒsetState æ˜¯â€å¼‚æ­¥â€çš„ï¼› åŸå› : å› ä¸ºåœ¨ setState çš„å®ç°ä¸­ï¼Œæœ‰ä¸€ä¸ªåˆ¤æ–­: å½“æ›´æ–°ç­–ç•¥æ­£åœ¨äº‹åŠ¡æµçš„æ‰§è¡Œä¸­æ—¶ï¼Œè¯¥ç»„ä»¶æ›´æ–°ä¼šè¢«æ¨å…¥ dirtyComponents é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œï¼›å¦åˆ™ï¼Œå¼€å§‹æ‰§è¡Œ batchedUpdates é˜Ÿåˆ—æ›´æ–°ï¼› åœ¨ç”Ÿå‘½å‘¨æœŸé’©å­è°ƒç”¨ä¸­ï¼Œæ›´æ–°ç­–ç•¥éƒ½å¤„äºæ›´æ–°ä¹‹å‰ï¼Œç»„ä»¶ä»å¤„äºäº‹åŠ¡æµä¸­ï¼Œè€Œ componentDidUpdate æ˜¯åœ¨æ›´æ–°ä¹‹åï¼Œæ­¤æ—¶ç»„ä»¶å·²ç»ä¸åœ¨äº‹åŠ¡æµä¸­äº†ï¼Œå› æ­¤åˆ™ä¼šåŒæ­¥æ‰§è¡Œï¼›åœ¨åˆæˆäº‹ä»¶ä¸­ï¼ŒReact æ˜¯åŸºäº äº‹åŠ¡æµå®Œæˆçš„äº‹ä»¶å§”æ‰˜æœºåˆ¶ å®ç°ï¼Œä¹Ÿæ˜¯å¤„äºäº‹åŠ¡æµä¸­ï¼› é—®é¢˜: æ— æ³•åœ¨ setState åé©¬ä¸Šä» this.state ä¸Šè·å–æ›´æ–°åçš„å€¼ã€‚ è§£å†³: å¦‚æœéœ€è¦é©¬ä¸ŠåŒæ­¥å»è·å–æ–°å€¼ï¼ŒsetState å…¶å®æ˜¯å¯ä»¥ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°çš„ã€‚setState(updater, callback)ï¼Œåœ¨å›è°ƒä¸­å³å¯è·å–æœ€æ–°å€¼ï¼› åœ¨ åŸç”Ÿäº‹ä»¶ å’Œ setTimeout ä¸­ï¼ŒsetState æ˜¯åŒæ­¥çš„ï¼Œå¯ä»¥é©¬ä¸Šè·å–æ›´æ–°åçš„å€¼ï¼› åŸå› : åŸç”Ÿäº‹ä»¶æ˜¯æµè§ˆå™¨æœ¬èº«çš„å®ç°ï¼Œä¸äº‹åŠ¡æµæ— å…³ï¼Œè‡ªç„¶æ˜¯åŒæ­¥ï¼›è€Œ setTimeout æ˜¯æ”¾ç½®äºå®šæ—¶å™¨çº¿ç¨‹ä¸­å»¶åæ‰§è¡Œï¼Œæ­¤æ—¶äº‹åŠ¡æµå·²ç»“æŸï¼Œå› æ­¤ä¹Ÿæ˜¯åŒæ­¥ï¼› æ‰¹é‡æ›´æ–° åœ¨ åˆæˆäº‹ä»¶ å’Œ ç”Ÿå‘½å‘¨æœŸé’©å­ ä¸­ï¼ŒsetState æ›´æ–°é˜Ÿåˆ—æ—¶ï¼Œå­˜å‚¨çš„æ˜¯åˆå¹¶çŠ¶æ€(Object.assign)ã€‚å› æ­¤å‰é¢è®¾ç½®çš„ key å€¼ä¼šè¢«åé¢æ‰€è¦†ç›–ï¼Œæœ€ç»ˆåªä¼šæ‰§è¡Œä¸€æ¬¡æ›´æ–°ï¼› å‡½æ•°å¼ ç”±äº Fiber åŠ åˆå¹¶ çš„é—®é¢˜ï¼Œå®˜æ–¹æ¨èå¯ä»¥ä¼ å…¥ å‡½æ•° çš„å½¢å¼ã€‚setState(fn)ï¼Œåœ¨ fn ä¸­è¿”å›æ–°çš„ state å¯¹è±¡å³å¯ï¼Œä¾‹å¦‚ this.setState((state, props) =&gt; newState)ï¼› ä½¿ç”¨å‡½æ•°å¼ï¼Œå¯ä»¥ç”¨äºé¿å… setState çš„æ‰¹é‡æ›´æ–°çš„é€»è¾‘ï¼Œä¼ å…¥çš„å‡½æ•°å°†ä¼šè¢«é¡ºåºè°ƒç”¨ï¼› æ³¨æ„ç‚¹ å½“ç»„ä»¶å·²è¢«é”€æ¯ï¼Œå¦‚æœå†æ¬¡è°ƒç”¨ setStateï¼ŒReact ä¼šæŠ¥é”™è­¦å‘Šï¼Œé€šå¸¸æœ‰ä¸¤ç§è§£å†³åŠæ³•: å°†æ•°æ®æŒ‚è½½åˆ°å¤–éƒ¨ï¼Œé€šè¿‡ props ä¼ å…¥ï¼Œå¦‚æ”¾åˆ° Redux æˆ– çˆ¶çº§ä¸­ï¼› åœ¨ç»„ä»¶å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªçŠ¶æ€é‡ (isUnmounted)ï¼ŒcomponentWillUnmount ä¸­æ ‡è®°ä¸º trueï¼Œåœ¨ setState å‰è¿›è¡Œåˆ¤æ–­ï¼› æ›¿æ¢çš„å±æ€§ class/className for/htmlFor æ’å…¥ html æ–‡æœ¬dangerouslySetInnerHTML = &#123; &#123; __html: content &#125;&#125; 15 ç‰ˆæœ¬çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š åˆå§‹åŒ–é˜¶æ®µ constructor getDefaultProps getInitialState æŒ‚è½½é˜¶æ®µ componentWillMount render componentDidMount æ›´æ–°é˜¶æ®µpropsï¼š componentWillReceiveProps shouldComponentUpdate componentWillUpdate render componentDidUpdatestateï¼š shouldComponentUpdate componentWillUpdate render componentDidUpdate å¸è½½é˜¶æ®µ componentWillUnmount 16 ç‰ˆæœ¬ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š åˆå§‹åŒ–é˜¶æ®µ constructor getDefaultProps getInitialState æŒ‚è½½é˜¶æ®µ ç»„ä»¶å®ä¾‹åŒ–ã€‚ç»„ä»¶çš„propså‘ç”Ÿå˜åŒ–ã€‚çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚this.setState() ä¸ä¼šè§¦å‘getDerivedStateFromProps()ï¼Œ ä½†æ˜¯this.forceUpdate() ä¼šã€‚ getDerivedStateFromProps: ä¼ å…¥ nextProps å’Œ prevStateï¼Œæ ¹æ®éœ€è¦å°† props æ˜ å°„åˆ° stateï¼Œå¦åˆ™è¿”å› null render componentDidMount æ›´æ–°é˜¶æ®µ getDerivedStateFromProps shouldComponentUpdate render getSnapshotBeforeUpdateï¼šrender ä¹‹å dom æ¸²æŸ“ä¹‹å‰ä¼šå‘ç”Ÿï¼Œè¿”å›ä¸€ä¸ªå€¼ä½œä¸º componentDidUpdate çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä½¿ç”¨ componentDidUpdate å¸è½½é˜¶æ®µ componentWillUnmount é”™è¯¯å¤„ç† componentDidCatch äº‹ä»¶æœºåˆ¶react äº‹ä»¶å¹¶æ²¡æœ‰ç»‘å®šåˆ°çœŸå®çš„ dom èŠ‚ç‚¹ä¸Šï¼Œè€Œæ˜¯é€šè¿‡äº‹ä»¶ä»£ç†ï¼Œåœ¨æœ€å¤–å±‚çš„ document ä¸Šå¯¹äº‹ä»¶è¿›è¡Œç»Ÿä¸€åˆ†å‘ã€‚ ä¸ºä»€ä¹ˆ react äº‹ä»¶è¦è‡ªå·±ç»‘å®š thisåœ¨ react ä¸­äº‹ä»¶å¤„ç†å‡½æ•°æ˜¯ç›´æ¥è°ƒç”¨çš„ï¼Œå¹¶æ²¡æœ‰æŒ‡å®šè°ƒç”¨çš„ç»„ä»¶ï¼Œæ‰€ä»¥ä¸è¿›è¡Œæ‰‹åŠ¨ç»‘å®šçš„æƒ…å†µä¸‹ç›´æ¥è·å–åˆ°çš„ this æ˜¯ä¸å‡†ç¡®çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å°†å½“å‰ç»„ä»¶ç»‘å®šåˆ° this ä¸Šã€‚ react å’ŒåŸç”Ÿäº‹ä»¶çš„æ‰§è¡Œé¡ºåºæ˜¯ä»€ä¹ˆï¼Œå¯ä»¥æ··ç”¨å—react çš„æ‰€æœ‰äº‹ä»¶éƒ½é€šè¿‡ document è¿›è¡Œç»Ÿä¸€åˆ†å‘ï¼Œå½“çœŸå® dom è§¦å‘äº‹ä»¶åå†’æ³¡åˆ° document åæ‰ä¼šå¯¹ react äº‹ä»¶è¿›è¡Œå¤„ç† æ‰€ä»¥åŸç”Ÿäº‹ä»¶ä¼šå…ˆæ‰§è¡Œï¼Œç„¶åæ‰§è¡Œ react åˆæˆäº‹ä»¶ï¼Œæœ€åæ‰§è¡ŒçœŸæ­£åœ¨ document ä¸ŠæŒ‚è½½çš„äº‹ä»¶ä¸¤è€…æœ€å¥½ä¸è¦æ··ç”¨ï¼ŒåŸç”Ÿäº‹ä»¶ä¸­å¦‚æœæ‰§è¡Œäº† stopPropagation æ–¹æ³•ï¼Œåˆ™ä¼šå¯¼è‡´å…¶ä»– react äº‹ä»¶å¤±æ•ˆã€‚ è™šæ‹Ÿ dom æ¯”æ™®é€š dom æ›´å¿«å—é¦–æ¬¡æ¸²æŸ“æ—¶ vdom ä¸å…·æœ‰ä»»ä½•ä¼˜åŠ¿ç”šè‡³è¦è¿›è¡Œæ›´å¤šçš„è®¡ç®—ï¼Œæ¶ˆè€—æ›´å¤šçš„å†…å­˜ã€‚ vdom çš„ä¼˜åŠ¿åœ¨äº react çš„ diff ç®—æ³•å’Œæ‰¹å¤„ç†ç­–ç•¥ï¼Œreact åœ¨é¡µé¢æ›´æ–°ä¹‹å‰ï¼Œæå‰è®¡ç®—å¥½äº†å¦‚ä½•è¿›è¡Œæ›´æ–°å’Œæ¸²æŸ“ domã€‚vdom ä¸»è¦æ˜¯èƒ½åœ¨é‡å¤æ¸²æŸ“æ—¶å¸®åŠ©æˆ‘ä»¬è®¡ç®—å¦‚ä½•å®ç°æ›´é«˜æ•ˆçš„æ›´æ–°ï¼Œè€Œä¸æ˜¯è¯´å®ƒæ¯” dom æ“ä½œå¿«ã€‚ è™šæ‹Ÿ dom ä¸­çš„$$typeof å±æ€§çš„ä½œç”¨æ˜¯ä»€ä¹ˆå®ƒè¢«èµ‹å€¼ä¸º REACT_ELEMENT_TYPEï¼Œæ˜¯ä¸€ä¸ª symbol ç±»å‹çš„å˜é‡ï¼Œè¿™ä¸ªå˜é‡å¯ä»¥é˜²æ­¢ XSSã€‚react æ¸²æŸ“æ—¶ä¼šæŠŠæ²¡æœ‰$$typeofæ ‡è¯†ä»¥åŠè§„åˆ™æ ¡éªŒä¸é€šè¿‡çš„ç»„ä»¶å…¨éƒ½è¿‡æ»¤æ‰ã€‚å½“ä½ çš„ç¯å¢ƒä¸æ”¯æŒSymbolæ—¶ï¼Œ$$typeof è¢«èµ‹å€¼ä¸º 0xeac7ï¼Œä¸ºä»€ä¹ˆé‡‡ç”¨ 0xeac7ï¼Ÿ 0xeac7 çœ‹èµ·æ¥æœ‰ç‚¹åƒ Reactã€‚ HOC åœ¨ä¸šåŠ¡åœºæ™¯ä¸­æœ‰å“ªäº›å®é™…çš„åº”ç”¨ ç»„åˆæ¸²æŸ“(å±æ€§ä»£ç†) // æ›´æ”¹ propsfunction proxyHoc(Comp) &#123; return class extends React.Component &#123; render() &#123; const newProps = &#123; name: &#x27;tayde&#x27;, age: 1, &#125;; return &lt;Comp &#123;...this.props&#125; &#123;...newProps&#125; /&gt;; &#125; &#125;;&#125; å¾ˆæ–¹ä¾¿å°† Input ç»„ä»¶è½¬åŒ–ä¸ºå—æ§ç»„ä»¶ æ¡ä»¶æ¸²æŸ“ // åå‘ç»§æ‰¿ä¼ é€’è¿‡æ¥çš„ç»„ä»¶function withLoading(Comp) &#123; return class extends Comp &#123; render() &#123; if (this.props.isLoading) &#123; return &lt;Loading /&gt;; &#125; else &#123; return super.render(); &#125; &#125; &#125;;&#125; æ“ä½œ props è·å– refs æ“ä½œ stateå¯ä»¥ç›´æ¥é€šè¿‡ this.state è·å–åˆ°è¢«åŒ…è£¹ç»„ä»¶çš„çŠ¶æ€ï¼Œå¹¶è¿›è¡Œæ“ä½œã€‚ä½†è¿™æ ·çš„æ“ä½œå®¹æ˜“ä½¿ state å˜å¾—éš¾ä»¥è¿½è¸ªï¼Œä¸æ˜“ç»´æŠ¤ï¼Œè°¨æ…ä½¿ç”¨ã€‚ æ¸²æŸ“åŠ«æŒ å®é™…åº”ç”¨åœºæ™¯ï¼š æ—¥å¿—æ‰“ç‚¹ // æ€§èƒ½ç›‘æ§åŸ‹ç‚¹function withTiming(Comp)\u0010 &#123; return class extends Comp &#123; constructor(props) &#123; super(props); this.start = Date.now(); this.end = 0; &#125; componentDidMount() &#123; super.componentDidMount &amp;&amp; super.componentDidMount(); this.end = Date.now(); console.log(`$&#123;WrappedComponent.name&#125; ç»„ä»¶æ¸²æŸ“æ—¶é—´ä¸º $&#123;this.end - this.start&#125; ms`); &#125; render() &#123; return super.render(); &#125; &#125;;&#125; æƒé™æ§åˆ¶ function withAdminAuth(WrappedComponent) &#123; return class extends React.Component &#123; constructor(props) &#123; super(props); this.state = &#123; isAdmin: false, &#125;; &#125; async componentWillMount() &#123; const currentRole = await getCurrentUserRole(); this.setState(&#123; isAdmin: currentRole === &#x27;Admin&#x27;, &#125;); &#125; render() &#123; if (this.state.isAdmin) &#123; return &lt;Comp &#123;...this.props&#125; /&gt;; &#125; else &#123; return &lt;div&gt; æ‚¨æ²¡æœ‰æƒé™æŸ¥çœ‹è¯¥é¡µé¢ï¼Œ è¯·è”ç³»ç®¡ç†å‘˜ï¼ &lt;/div&gt;; &#125; &#125; &#125;;&#125; åŒå‘ç»‘å®š è¡¨å•æ ¡éªŒ ä»£ç å¤ç”¨ HOC å’Œ mixin çš„å¼‚åŒç‚¹æ˜¯ä»€ä¹ˆ mixin å¯èƒ½ä¼šäº’ç›¸ä¾èµ–ï¼Œäº’ç›¸è€¦åˆï¼Œä¸åˆ©äºä»£ç ç»´æŠ¤ ä¸åŒçš„ mixin ä¸­çš„æ–¹æ³•å¯èƒ½ä¼šç›¸äº’å†²çª mixin éå¸¸å¤šçš„æ—¶å€™ç»„ä»¶æ˜¯å¯ä»¥æ„ŸçŸ¥åˆ°çš„ï¼Œç”šè‡³è¿˜è¦ä¸ºå…¶åšç›¸å…³å¤„ç†ï¼Œè¿™æ ·ä¼šç»™ä»£ç é€ æˆæ»šé›ªçƒå¼çš„å¤æ‚æ€§ è€Œ HOC çš„å‡ºç°åˆ™å¯ä»¥è§£å†³è¿™äº›é—®é¢˜ hoc æ˜¯ä¸€ä¸ªæ²¡æœ‰å‰¯ä½œç”¨çš„çº¯å‡½æ•°ï¼Œå„ä¸ªé«˜é˜¶ç»„ä»¶ä¸ä¼šäº’ç›¸ä¾èµ–è€¦åˆ é«˜é˜¶ç»„ä»¶ä¹Ÿæœ‰å¯èƒ½é€ æˆå†²çªï¼Œä½†æˆ‘ä»¬å¯ä»¥åœ¨éµå®ˆçº¦å®šçš„æƒ…å†µä¸‹é¿å…è¿™äº›æƒ…å†µ é«˜é˜¶ç»„ä»¶å¹¶ä¸å…³å¿ƒæ•°æ®ä½¿ç”¨çš„æ–¹å¼å’ŒåŸå› ï¼Œè€Œè¢«åŒ…è£¹çš„ç»„ä»¶ä¹Ÿä¸å…³å¿ƒæ•°æ®æ¥è‡ªä½•å¤„ã€‚é«˜é˜¶ç»„ä»¶çš„å¢åŠ ä¸ä¼šä¸ºåŸç»„ä»¶å¢åŠ è´Ÿæ‹… hooks æœ‰å“ªäº›ä¼˜åŠ¿(react æä¾›çš„ api, hoc å’Œ render props å¼€å‘æ¨¡å¼) ç»„ä»¶é€»è¾‘è¶Šæ¥è¶Šå¤æ‚(componentDidMount, componentDidUpdate)å°¤å…¶æ˜¯ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­å¸¸å¸¸åŒ…å«ä¸€äº›ä¸ç›¸å…³çš„é€»è¾‘ï¼Œå®Œå…¨ä¸ç›¸å…³çš„ä»£ç å´åœ¨åŒä¸€ä¸ªæ–¹æ³•ä¸­ç»„åˆåœ¨ä¸€èµ·ã€‚å¦‚æ­¤å¾ˆå®¹æ˜“äº§ç”Ÿ bugï¼Œå¹¶ä¸”å¯¼è‡´é€»è¾‘ä¸ä¸€è‡´ã€‚ ç»„ä»¶ä¹‹é—´å¤ç”¨çŠ¶æ€é€»è¾‘å¾ˆéš¾ï¼Œé¿å…åœ°ç‹±åµŒå¥—hook å’Œ mixin åœ¨ç”¨æ³•ä¸Šæœ‰ä¸€å®šçš„ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†æ˜¯ mixin å¼•å…¥çš„é€»è¾‘çŠ¶æ€æ˜¯å¯ä»¥äº’ç›¸è¦†ç›–çš„ï¼Œè€Œå¤šä¸ª hooks ä¹‹é—´äº’ä¸å½±å“ï¼Œhoc ä¹Ÿå¯èƒ½å¸¦æ¥ä¸€å®šå†²çªï¼Œæ¯”å¦‚ props è¦†ç›–ç­‰ç­‰ï¼Œä½¿ç”¨ hooks åˆ™å¯ä»¥é¿å…è¿™äº›é—®é¢˜ã€‚å¤§é‡ä½¿ç”¨ hoc è®©æˆ‘ä»¬çš„ä»£ç å˜å¾—åµŒå¥—å±‚çº§éå¸¸æ·±ï¼Œä½¿ç”¨ hooks æˆ‘ä»¬å¯ä»¥å®ç°æ‰å¹³å¼çš„çŠ¶æ€é€»è¾‘å¤ç”¨ï¼Œè€Œé¿å…äº†å¤§é‡çš„ç»„ä»¶åµŒå¥—ã€‚ è®©ç»„ä»¶å˜å¾—æ›´åŠ å®¹æ˜“ç†è§£ class ç»„ä»¶ this é’©å­å‡½æ•°ç›¸æ¯”å‡½æ•°ï¼Œç¼–å†™ä¸€ä¸ª class å¯èƒ½éœ€è¦æ›´å¤šçš„çŸ¥è¯†ï¼Œhooks è®©ä½ å¯ä»¥åœ¨ class ä¹‹å¤–ä½¿ç”¨æ›´å¤šçš„ react çš„æ–°ç‰¹æ€§ åç»­ä¸­å±•ç¤ºç»„ä»¶éœ€è¦æ”¹é€ æˆç±»ç»„ä»¶éœ€è¦æœ‰è‡ªå·±çš„çŠ¶æ€ç®¡ç†å’Œç”Ÿå‘½å‘¨æœŸæ–¹æ³•å°†å¤ç”¨é€»è¾‘æå‡åˆ°ä»£ç é¡¶éƒ¨ã€‚ Fiber Fiber æ ¸å¿ƒæ˜¯å®ç°äº†ä¸€ä¸ªåŸºäºä¼˜å…ˆçº§å’Œ requestIdleCallback çš„å¾ªç¯ä»»åŠ¡è°ƒåº¦ç®—æ³• reconciliation é˜¶æ®µå¯ä»¥æŠŠä»»åŠ¡æ‹†åˆ†æˆå¤šä¸ªå°ä»»åŠ¡ reconciliation é˜¶æ®µå¯éšæ—¶ä¸­æ­¢æˆ–æ¢å¤ä»»åŠ¡ å¯ä»¥æ ¹æ®ä¼˜å…ˆçº§ä¸åŒæ¥é€‰æ‹©ä¼˜å…ˆæ‰§è¡Œä»»åŠ¡ åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­é€‰å‡ºé«˜ä¼˜å…ˆçº§çš„ fiber node æ‰§è¡Œï¼Œè°ƒç”¨ requestIdleCallback è·å–æ‰€å‰©æ—¶é—´ï¼Œè‹¥æ‰§è¡Œæ—¶é—´è¶…è¿‡äº† deathLineï¼Œæˆ–è€…çªç„¶æ’å…¥æ›´é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼Œåˆ™æ‰§è¡Œä¸­æ–­ï¼Œä¿å­˜å½“å‰ç»“æœï¼Œä¿®æ”¹ tag æ ‡è®°ä¸€ä¸‹ï¼Œè®¾ç½®ä¸º pending çŠ¶æ€ï¼Œè¿…é€Ÿæ”¶å°¾å¹¶å†è°ƒç”¨ä¸€ä¸ª requestIdleCallbackï¼Œç­‰ä¸»çº¿ç¨‹é‡Šæ”¾å‡ºæ¥å†ç»§ç»­ æ¢å¤ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œæ£€æŸ¥ tag æ˜¯è¢«ä¸­æ–­çš„ä»»åŠ¡ï¼Œä¼šæ¥ç€ç»§ç»­åšä»»åŠ¡æˆ–è€…é‡åš åœ¨ v16 ä¹‹å‰ï¼Œreconciliation ç®€å•è¯´å°±æ˜¯ä¸€ä¸ªè‡ªé¡¶å‘ä¸‹é€’å½’ç®—æ³•ï¼Œäº§å‡ºéœ€è¦å¯¹å½“å‰ DOM è¿›è¡Œæ›´æ–°æˆ–æ›¿æ¢çš„æ“ä½œåˆ—è¡¨ï¼Œä¸€æ—¦å¼€å§‹ï¼Œä¼šæŒç»­å ç”¨ä¸»çº¿ç¨‹ï¼Œä¸­æ–­æ“ä½œå´ä¸å®¹æ˜“å®ç°ã€‚å½“ JS é•¿æ—¶é—´æ‰§è¡Œï¼ˆå¦‚å¤§é‡è®¡ç®—ç­‰ï¼‰ï¼Œä¼šé˜»å¡æ ·å¼è®¡ç®—ã€ç»˜åˆ¶ç­‰å·¥ä½œï¼Œå‡ºç°é¡µé¢è„±å¸§ç°è±¡ã€‚æ‰€ä»¥ï¼Œv16 è¿›è¡Œäº†ä¸€æ¬¡é‡å†™ï¼Œè¿æ¥äº†ä»£å·ä¸º Fiber çš„å¼‚æ­¥æ¸²æŸ“æ¶æ„ã€‚ React çš„æ ¸å¿ƒæµç¨‹å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†: reconciliation (è°ƒåº¦ç®—æ³•ï¼Œä¹Ÿå¯ç§°ä¸º render diff é˜¶æ®µ): æ›´æ–° state ä¸ propsï¼› è°ƒç”¨ç”Ÿå‘½å‘¨æœŸé’©å­ï¼› ç”Ÿæˆ virtual domï¼› è¿™é‡Œåº”è¯¥ç§°ä¸º Fiber Tree æ›´ä¸ºç¬¦åˆï¼› é€šè¿‡æ–°æ—§ vdom è¿›è¡Œ diff ç®—æ³•ï¼Œè·å– vdom changeï¼› ç¡®å®šæ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“ commit(æ“ä½œ dom é˜¶æ®µ): å¦‚éœ€è¦ï¼Œåˆ™æ“ä½œ dom èŠ‚ç‚¹æ›´æ–°ï¼› é—®é¢˜: éšç€åº”ç”¨å˜å¾—è¶Šæ¥è¶Šåºå¤§ï¼Œæ•´ä¸ªæ›´æ–°æ¸²æŸ“çš„è¿‡ç¨‹å¼€å§‹å˜å¾—åƒåŠ›ï¼Œå¤§é‡çš„ç»„ä»¶æ¸²æŸ“ä¼šå¯¼è‡´ä¸»è¿›ç¨‹é•¿æ—¶é—´è¢«å ç”¨ï¼Œå¯¼è‡´ä¸€äº›åŠ¨ç”»æˆ–é«˜é¢‘æ“ä½œå‡ºç°å¡é¡¿å’Œæ‰å¸§çš„æƒ…å†µã€‚è€Œå…³é”®ç‚¹ï¼Œä¾¿æ˜¯ åŒæ­¥é˜»å¡ã€‚åœ¨ä¹‹å‰çš„è°ƒåº¦ç®—æ³•ä¸­ï¼ŒReact éœ€è¦å®ä¾‹åŒ–æ¯ä¸ªç±»ç»„ä»¶ï¼Œç”Ÿæˆä¸€é¢—ç»„ä»¶æ ‘ï¼Œä½¿ç”¨ åŒæ­¥é€’å½’ çš„æ–¹å¼è¿›è¡Œéå†æ¸²æŸ“ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹æœ€å¤§çš„é—®é¢˜å°±æ˜¯æ— æ³• æš‚åœå’Œæ¢å¤ã€‚ è§£å†³æ–¹æ¡ˆ: è§£å†³åŒæ­¥é˜»å¡çš„æ–¹æ³•ï¼Œé€šå¸¸æœ‰ä¸¤ç§: å¼‚æ­¥ä¸ä»»åŠ¡åˆ†å‰²ã€‚è€Œ React Fiber ä¾¿æ˜¯ä¸ºäº†å®ç°ä»»åŠ¡åˆ†å‰²è€Œè¯ç”Ÿçš„ã€‚ åœ¨ React V16 å°†è°ƒåº¦ç®—æ³•è¿›è¡Œäº†é‡æ„ï¼Œ å°†ä¹‹å‰çš„ stack reconciler é‡æ„æˆæ–°ç‰ˆçš„ fiber reconcilerï¼Œå˜æˆäº†å…·æœ‰é“¾è¡¨å’ŒæŒ‡é’ˆçš„å•é“¾è¡¨æ ‘éå†ç®—æ³•ã€‚é€šè¿‡æŒ‡é’ˆæ˜ å°„ï¼Œæ¯ä¸ªå•å…ƒéƒ½è®°å½•ç€éå†å½“ä¸‹çš„ä¸Šä¸€æ­¥ä¸ä¸‹ä¸€æ­¥ï¼Œä»è€Œä½¿éå†å˜å¾—å¯ä»¥è¢«æš‚åœå’Œé‡å¯ã€‚ è¿™é‡Œæˆ‘ç†è§£ä¸ºæ˜¯ä¸€ç§ä»»åŠ¡åˆ†å‰²è°ƒåº¦ç®—æ³•ï¼Œä¸»è¦æ˜¯å°†åŸå…ˆåŒæ­¥æ›´æ–°æ¸²æŸ“çš„ä»»åŠ¡åˆ†å‰²æˆä¸€ä¸ªä¸ªç‹¬ç«‹çš„å°ä»»åŠ¡å•ä½ï¼Œæ ¹æ®ä¸åŒçš„ä¼˜å…ˆçº§ï¼Œå°†å°ä»»åŠ¡åˆ†æ•£åˆ°æµè§ˆå™¨çš„ç©ºé—²æ—¶é—´æ‰§è¡Œï¼Œå……åˆ†åˆ©ç”¨ä¸»è¿›ç¨‹çš„äº‹ä»¶å¾ªç¯æœºåˆ¶ã€‚ class Fiber &#123; constructor(instance) &#123; this.instance = instance; // æŒ‡å‘ç¬¬ä¸€ä¸ª child èŠ‚ç‚¹ this.child = child; // æŒ‡å‘çˆ¶èŠ‚ç‚¹ this.return = parent; // æŒ‡å‘ç¬¬ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ this.sibling = previous; &#125;&#125; æ ¸å¿ƒæ€æƒ³æ˜¯ ä»»åŠ¡æ‹†åˆ†å’ŒååŒï¼Œä¸»åŠ¨æŠŠæ‰§è¡Œæƒäº¤ç»™ä¸»çº¿ç¨‹ï¼Œä½¿ä¸»çº¿ç¨‹æœ‰æ—¶é—´ç©ºæŒ¡å¤„ç†å…¶ä»–é«˜ä¼˜å…ˆçº§ä»»åŠ¡ã€‚å½“é‡åˆ°è¿›ç¨‹é˜»å¡çš„é—®é¢˜æ—¶ï¼Œä»»åŠ¡åˆ†å‰²ã€å¼‚æ­¥è°ƒç”¨ å’Œ ç¼“å­˜ç­–ç•¥ æ˜¯ä¸‰ä¸ªæ˜¾è‘—çš„è§£å†³æ€è·¯ã€‚ ä»»åŠ¡ä¼˜å…ˆçº§(7 ç§) &#123; NoWork: 0, // No work is pending. SynchronousPriority: 1, // æ–‡æœ¬è¾“å…¥æ¡† TaskPriority: 2, // å½“å‰è°ƒåº¦æ­£æ‰§è¡Œçš„ä»»åŠ¡ AnimationPriority: 3, // åŠ¨ç”»è¿‡æ¸¡ HighPriority: 4, // ç”¨æˆ·äº¤äº’åé¦ˆ LowPriority: 5, // æ•°æ®çš„æ›´æ–° OffscreenPriority: 6, // é¢„ä¼°æœªæ¥éœ€è¦æ˜¾ç¤ºçš„ä»»åŠ¡&#125; ä¸ºä»€ä¹ˆç”Ÿå‘½å‘¨æœŸæœ‰äº†å˜åŠ¨åœ¨ Fiber ä¸­ï¼Œreconciliation é˜¶æ®µè¿›è¡Œäº†ä»»åŠ¡åˆ†å‰²ï¼Œæ¶‰åŠåˆ° æš‚åœ å’Œ é‡å¯ï¼Œå› æ­¤å¯èƒ½ä¼šå¯¼è‡´ reconciliation ä¸­çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°åœ¨ä¸€æ¬¡æ›´æ–°æ¸²æŸ“å¾ªç¯ä¸­è¢« å¤šæ¬¡è°ƒç”¨ çš„æƒ…å†µï¼Œäº§ç”Ÿä¸€äº›æ„å¤–é”™è¯¯ã€‚ class Component extends React.Component &#123; // æ›¿æ¢ `componentWillReceiveProps` ï¼Œ // åˆå§‹åŒ–å’Œ update æ—¶è¢«è°ƒç”¨ // é™æ€å‡½æ•°ï¼Œæ— æ³•ä½¿ç”¨ this static getDerivedStateFromProps(nextProps, prevState) &#123;&#125; // åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°ç»„ä»¶ // å¯ä»¥ç”¨äºç»„ä»¶æ€§èƒ½ä¼˜åŒ– shouldComponentUpdate(nextProps, nextState) &#123;&#125; // ç»„ä»¶è¢«æŒ‚è½½åè§¦å‘ componentDidMount() &#123;&#125; // æ›¿æ¢ componentWillUpdate // å¯ä»¥åœ¨æ›´æ–°ä¹‹å‰è·å–æœ€æ–° dom æ•°æ® getSnapshotBeforeUpdate() &#123;&#125; // ç»„ä»¶æ›´æ–°åè°ƒç”¨ componentDidUpdate() &#123;&#125; // ç»„ä»¶å³å°†é”€æ¯ componentWillUnmount() &#123;&#125; // ç»„ä»¶å·²é”€æ¯ componentDidUnMount() &#123;&#125; // é”™è¯¯è¾¹ç•Œæ•è·å…¨å±€å¼‚å¸¸ componentDidCatch() &#123;&#125;&#125; åœ¨ constructor åˆå§‹åŒ– stateï¼› åœ¨ componentDidMount ä¸­è¿›è¡Œäº‹ä»¶ç›‘å¬ï¼Œå¹¶åœ¨ componentWillUnmount ä¸­è§£ç»‘äº‹ä»¶ï¼› åœ¨ componentDidMount ä¸­è¿›è¡Œæ•°æ®çš„è¯·æ±‚ï¼Œè€Œä¸æ˜¯åœ¨ componentWillMountï¼› éœ€è¦æ ¹æ® props æ›´æ–° state æ—¶ï¼Œä½¿ç”¨ getDerivedStateFromProps(nextProps, prevState)ï¼› æ—§ props éœ€è¦è‡ªå·±å­˜å‚¨ï¼Œä»¥ä¾¿æ¯”è¾ƒï¼› public static getDerivedStateFromProps(nextProps, prevState) &#123; // å½“æ–° props ä¸­çš„ data å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒåŒæ­¥æ›´æ–°åˆ° state ä¸Š if (nextProps.data !== prevState.data) &#123; return &#123; data: nextProps.data &#125; &#125; else &#123; return null &#125;&#125; å¯ä»¥åœ¨ componentDidUpdate ç›‘å¬ props æˆ–è€… state çš„å˜åŒ–ï¼Œä¾‹å¦‚: componentDidUpdate(prevProps) &#123; // å½“ id å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°è·å–æ•°æ® if (this.props.id !== prevProps.id) &#123; this.fetchData(this.props.id); &#125;&#125; åœ¨ componentDidUpdate ä½¿ç”¨ setState æ—¶ï¼Œå¿…é¡»åŠ æ¡ä»¶ï¼Œå¦åˆ™å°†è¿›å…¥æ­»å¾ªç¯ï¼› getSnapshotBeforeUpdate(prevProps, prevState)å¯ä»¥åœ¨æ›´æ–°ä¹‹å‰è·å–æœ€æ–°çš„æ¸²æŸ“æ•°æ®ï¼Œå®ƒçš„è°ƒç”¨æ˜¯åœ¨ render ä¹‹åï¼Œ update ä¹‹å‰ï¼› shouldComponentUpdate: é»˜è®¤æ¯æ¬¡è°ƒç”¨ setStateï¼Œä¸€å®šä¼šæœ€ç»ˆèµ°åˆ° diff é˜¶æ®µï¼Œä½†å¯ä»¥é€šè¿‡ shouldComponentUpdate çš„ç”Ÿå‘½é’©å­è¿”å› false æ¥ç›´æ¥é˜»æ­¢åé¢çš„é€»è¾‘æ‰§è¡Œï¼Œé€šå¸¸æ˜¯ç”¨äºåšæ¡ä»¶æ¸²æŸ“ï¼Œä¼˜åŒ–æ¸²æŸ“çš„æ€§èƒ½ã€‚ åºŸå¼ƒçš„åŸå› ä¸»è¦æ˜¯å› ä¸º react åœ¨ 16 ç‰ˆæœ¬é‡æ„äº†è°ƒåº¦ç®—æ³•ï¼Œæ–°çš„è°ƒåº¦å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›ç”Ÿå‘½å‘¨æœŸè¢«åå¤è°ƒç”¨ï¼Œæ‰€ä»¥åœ¨ 16 ä¸­å°±ä¸å»ºè®®ä½¿ç”¨äº†ï¼Œè€Œæ”¹åœ¨å…¶ä»–æ—¶æœºä¸­æš´éœ²å‡ºå…¶ä»–ç”Ÿå‘½å‘¨æœŸé’©å­ç”¨æ¥æ›¿ä»£ã€‚ SSRSSRï¼Œä¿—ç§° æœåŠ¡ç«¯æ¸²æŸ“ (Server Side Render)ï¼Œè®²äººè¯å°±æ˜¯: ç›´æ¥åœ¨æœåŠ¡ç«¯å±‚è·å–æ•°æ®ï¼Œæ¸²æŸ“å‡ºå®Œæˆçš„ HTML æ–‡ä»¶ï¼Œç›´æ¥è¿”å›ç»™ç”¨æˆ·æµè§ˆå™¨è®¿é—®ã€‚å‰åç«¯åˆ†ç¦»: å‰ç«¯ä¸æœåŠ¡ç«¯éš”ç¦»ï¼Œå‰ç«¯åŠ¨æ€è·å–æ•°æ®ï¼Œæ¸²æŸ“é¡µé¢ã€‚ ç—›ç‚¹: é¦–å±æ¸²æŸ“æ€§èƒ½ç“¶é¢ˆ: ç©ºç™½å»¶è¿Ÿ: HTML ä¸‹è½½æ—¶é—´ + JS ä¸‹è½½/æ‰§è¡Œæ—¶é—´ + è¯·æ±‚æ—¶é—´ + æ¸²æŸ“æ—¶é—´ã€‚åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œé¡µé¢å¤„äºç©ºç™½çš„çŠ¶æ€ã€‚ SEO é—®é¢˜: ç”±äºé¡µé¢åˆå§‹çŠ¶æ€ä¸ºç©ºï¼Œå› æ­¤çˆ¬è™«æ— æ³•è·å–é¡µé¢ä¸­ä»»ä½•æœ‰æ•ˆæ•°æ®ï¼Œå› æ­¤å¯¹æœç´¢å¼•æ“ä¸å‹å¥½ã€‚ è™½ç„¶ä¸€ç›´æœ‰åœ¨æåŠ¨æ€æ¸²æŸ“çˆ¬è™«çš„æŠ€æœ¯ï¼Œä¸è¿‡æ®æˆ‘äº†è§£ï¼Œå¤§éƒ¨åˆ†å›½å†…æœç´¢å¼•æ“ä»ç„¶æ˜¯æ²¡æœ‰å®ç°ã€‚ åŸç† Node æœåŠ¡: è®©å‰åç«¯è¿è¡ŒåŒä¸€å¥—ä»£ç æˆä¸ºå¯èƒ½ã€‚ Virtual Dom: è®©å‰ç«¯ä»£ç è„±ç¦»æµè§ˆå™¨è¿è¡Œã€‚ ä¸ºä»€ä¹ˆ react æ²¡æœ‰åŒå‘ç»‘å®šReact çš„è®¾è®¡æ€æƒ³æ˜¯å•å‘æ•°æ®æµï¼Œæˆ‘è§‰å¾—å¯ä»¥è¿™æ ·ç†è§£ä¸ºä»€ä¹ˆæ²¡æœ‰åŒå‘æ•°æ®ç»‘å®šï¼š é¦–å…ˆï¼ŒReact æ˜¯çº¯ç²¹çš„ View å±‚ï¼›ç„¶åï¼Œå¯¹äº React æ¥è¯´åŒå‘æ•°æ®ç»‘å®šæ˜¯ä»€ä¹ˆéœ€æ±‚? â€“ æ˜æ˜¾æ˜¯ä¸šåŠ¡éœ€æ±‚ã€‚å› ä¸ºå•å‘æ•°æ®æµå·²ç»æ»¡è¶³äº† View å±‚æ¸²æŸ“çš„è¦æ±‚å¹¶ä¸”æ›´æ˜“æµ‹è¯•ä¸æ§åˆ¶ï¼ˆæ¥è‡ª Props æˆ– Stateï¼‰ï¼Œæ›´åŠ çš„æ¸…æ™°å¯æ§ï¼Œæ‰€ä»¥åœ¨çº¯ç²¹çš„ React ä¸­æ€ä¹ˆä¼šéœ€è¦åŒå‘æ•°æ®ç»‘å®šè¿™ç§åŠŸèƒ½å‘¢ã€‚ å¦‚æœéœ€è¦è§£å†³åŒå‘æ•°æ®ç»‘å®šé—®é¢˜ï¼Œå¯ä»¥å€ŸåŠ©ç¬¬ä¸‰æ–¹åº“å¦‚ Ant Design çš„ rc-form ä¹‹ç±»ï¼Œä½ ä¹Ÿå¯ä»¥å­˜åœ¨ State é‡Œç”šè‡³æ˜¯ Redux é‡Œï¼Œæ ¹æ®éœ€æ±‚æ¥å§ã€‚æ‰€ä»¥ React æ²¡æœ‰åŒå‘æ•°æ®ç»‘å®šä¸æ˜¯åŠŸèƒ½çš„ç¼ºå¤±æˆ–å†²çªé—®é¢˜ï¼Œè€Œæ˜¯ React åªå…³æ³¨è§£å†³çº¯ç²¹çš„é—®é¢˜ï¼š View å±‚ã€‚ å•å‘æ•°æ®æµå•å‘æ•°æ®æµæ˜¯æŒ‡æ•°æ®çš„æµå‘åªèƒ½ç”±çˆ¶ç»„ä»¶é€šè¿‡ props å°†æ•°æ®ä¼ é€’ç»™å­ç»„ä»¶ï¼Œä¸èƒ½ç”±å­ç»„ä»¶å‘çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œè¦æƒ³å®ç°æ•°æ®çš„åŒå‘ç»‘å®šï¼Œåªèƒ½ç”±å­ç»„ä»¶æ¥æ”¶çˆ¶ç»„ä»¶ props ä¼ è¿‡æ¥çš„æ–¹æ³•å»æ”¹å˜çˆ¶ç»„ä»¶çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ç›´æ¥å°†å­ç»„ä»¶çš„æ•°æ®ä¼ é€’ç»™çˆ¶ç»„ä»¶ã€‚ react å’Œ vue çš„å¯¹æ¯”react å‡½æ•°å¼æ€æƒ³ çº¯ç»„ä»¶ä¼ å…¥çŠ¶æ€å’Œé€»è¾‘ï¼Œæ‰€ä»¥å•é¡¹æ•°æ®æµç»“åˆ immutable setState è§¦å‘é‡æ–° render å•é¡¹æ•°æ®æµè®¾è®¡æˆä¸å¯å˜æ•°æ® purecomponent å¯¹ shouldconponentupdate æ˜¯å¦è§¦å‘é‡æ–°æ¸²æŸ“ã€‚ä¸å¯å˜æ•°æ®è¿”å›æ–°çš„ stateï¼Œè®¡ç®—è™šæ‹Ÿ dom çš„å·®å¼‚ã€‚æ•°æ®æµ props/callbackï¼Œcontext vue å“åº”å¼çš„æ€æƒ³ ç›‘å¬æ•°æ®çš„å˜åŒ– åˆå§‹åŒ–æ—¶å¯¹æ•°æ®çš„æ¯ä¸€ä¸ªå±æ€§æ·»åŠ  watcher åŸºäºæ•°æ®å¯å˜ æ•°æ®å˜åŒ–æ—¶è§¦å‘ watcher å›è°ƒ æ›´æ–°è™šæ‹Ÿ domã€‚å¯å˜æ•°æ®ç›´æ¥ä¿®æ”¹ï¼Œsetter èƒ½ç²¾ç¡®ç›‘å¬æ•°æ®å˜åŒ–ã€‚æ•°æ®æµ props/eventï¼Œinject/provide react çš„æ€§èƒ½ä¼˜åŒ–éœ€è¦æ‰‹åŠ¨å»åˆ¤æ–­ vue æ˜¯è‡ªåŠ¨çš„åº”ä¸ºè¦ç»™æ¯ä¸ªå±æ€§æ·»åŠ  watcher æ‰€ä»¥å¤§å‹é¡¹ç›® state ä¸æ¯”è¾ƒå¤šçš„æ—¶å€™ watcher ä¹Ÿä¼šæ¯”è¾ƒå¤šå®¹æ˜“é€ æˆå¡é¡¿çš„æƒ…å†µã€‚redux ä¸èƒ½ç›´æ¥è°ƒç”¨ reducer è¿›è¡Œä¿®æ”¹ã€‚è€Œ vuex æœ‰ dispatch å’Œ commit React ä¸­ï¼ŒcloneElement ä¸ createElement å„æ˜¯ä»€ä¹ˆï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«React.cloneElement(element, [props], [...children]);React.createElement(type, [props], [...children]); React Portal æœ‰å“ªäº›ä½¿ç”¨åœºæ™¯åœ¨ä»¥å‰ï¼Œ react ä¸­æ‰€æœ‰çš„ç»„ä»¶éƒ½ä¼šä½äº #app ä¸‹ï¼Œè€Œä½¿ç”¨ Portals æä¾›äº†ä¸€ç§è„±ç¦» #app çš„ç»„ä»¶ã€‚å› æ­¤ Portals é€‚åˆè„±ç¦»æ–‡æ¡£æµ(out of flow) çš„ç»„ä»¶ï¼Œç‰¹åˆ«æ˜¯ position: absolute ä¸ position: fixed çš„ç»„ä»¶ã€‚æ¯”å¦‚æ¨¡æ€æ¡†ï¼Œé€šçŸ¥ï¼Œè­¦å‘Šï¼ŒgoTop ç­‰ã€‚ const modalRoot = document.getElementById(&#x27;modal&#x27;);class Modal extends React.Component &#123; constructor(props) &#123; super(props); this.el = document.createElement(&#x27;div&#x27;); &#125; componentDidMount() &#123; modalRoot.appendChild(this.el); &#125; componentWillUnmount() &#123; modalRoot.removeChild(this.el); &#125; render() &#123; return ReactDOM.createPortal(this.props.children, this.el); &#125;&#125; è·¯ç”±ä¼ å‚ params ä¼ å‚(åˆ·æ–°é¡µé¢åå‚æ•°ä¸æ¶ˆå¤±ï¼Œå‚æ•°ä¼šåœ¨åœ°å€æ æ˜¾ç¤º) è·¯ç”±é¡µé¢ï¼š&lt;Route path=&#x27;/demo/:id&#x27; component=&#123;Demo&#125;&gt;&lt;/Route&gt; //æ³¨æ„è¦é…ç½® /:idè·¯ç”±è·³è½¬å¹¶ä¼ é€’å‚æ•°ï¼š é“¾æ¥æ–¹å¼ï¼š&lt;Link to=&#123;&#x27;/demo/&#x27;+&#x27;6&#x27;&#125;&gt;XX&lt;/Link&gt; æˆ–ï¼š&lt;Link to=&#123;&#123;pathname:&#x27;/demo/&#x27;+&#x27;6&#x27;&#125;&#125;&gt;XX&lt;/Link&gt; jsæ–¹å¼ï¼šthis.props.history.push(&#x27;/demo/&#x27;+&#x27;6&#x27;) æˆ–ï¼šthis.props.history.push(&#123;pathname:&#x27;/demo/&#x27;+&#x27;6&#x27;&#125;)è·å–å‚æ•°ï¼šthis.props.match.params.id //æ³¨æ„è¿™é‡Œæ˜¯matchè€Œéhistory query ä¼ å‚(åˆ·æ–°é¡µé¢åå‚æ•°æ¶ˆå¤±) è·¯ç”±é¡µé¢ï¼š&lt;Route path=&#x27;/demo&#x27; component=&#123;Demo&#125;&gt;&lt;/Route&gt; //æ— éœ€é…ç½®è·¯ç”±è·³è½¬å¹¶ä¼ é€’å‚æ•°ï¼š é“¾æ¥æ–¹å¼ï¼š&lt;Link to=&#123;&#123;pathname:&#x27;/demo&#x27;,query:&#123;id:22,name:&#x27;dahuang&#x27;&#125;&#125;&#125;&gt;XX&lt;/Link&gt; jsæ–¹å¼ï¼šthis.props.history.push(&#123;pathname:&#x27;/demo&#x27;,query:&#123;id:22,name:&#x27;dahuang&#x27;&#125;&#125;)è·å–å‚æ•°ï¼š this.props.location.query.name state ä¼ å‚(åˆ·æ–°é¡µé¢åå‚æ•°ä¸æ¶ˆå¤±ï¼Œstate ä¼ çš„å‚æ•°æ˜¯åŠ å¯†çš„ï¼Œæ¯” query ä¼ å‚å¥½ç”¨) è·¯ç”±é¡µé¢ï¼š&lt;Route path=&#x27;/demo&#x27; component=&#123;Demo&#125;&gt;&lt;/Route&gt; //æ— éœ€é…ç½®è·¯ç”±è·³è½¬å¹¶ä¼ é€’å‚æ•°ï¼š é“¾æ¥æ–¹å¼ï¼š &lt;Link to=&#123;&#123;pathname:&#x27;/demo&#x27;,state:&#123;id:12,name:&#x27;dahuang&#x27;&#125;&#125;&#125;&gt;XX&lt;/Link&gt; jsæ–¹å¼ï¼šthis.props.history.push(&#123;pathname:&#x27;/demo&#x27;,state:&#123;id:12,name:&#x27;dahuang&#x27;&#125;&#125;)è·å–å‚æ•°ï¼š this.props.location.state.name create-react-app é…ç½®æ–‡ä»¶ä¿®æ”¹ é€šè¿‡ package.json æˆ–å¼•ç”¨ç¬¬ä¸‰æ–¹çš„åº“å¢åŠ é…ç½® react æ„å»ºæ—¶é€šè¿‡ webpackï¼Œå…³äº webpack é…ç½®æŸ¥çœ‹ node_modules/react-scripts/config/webpack* npm run eject æš´éœ²æ‰€æœ‰é…ç½®æ–‡ä»¶ã€(å®‰è£… react-app-rewired åŒ…)å»ºç«‹æ–°çš„é…ç½®æ–‡ä»¶è¦†ç›–éƒ¨åˆ†é»˜è®¤çš„é…ç½® HashRouter æ”¯æŒé…ç½® package-json homepage: â€˜.â€™ä¿®æ”¹æ ¹ç›®å½•è·¯å¾„ï¼ŒBrowerRouter ä¿®æ”¹æ— æ•ˆè¿˜å¾—ä¿®æ”¹æœåŠ¡ç«¯é…ç½® react diff å’Œ vue diff çš„åŒºåˆ« vnode ä½œä¸ºæ•°æ®å’Œè§†å›¾çš„ä¸€ç§æ˜ å°„å…³ç³» ç›¸åŒç‚¹ï¼šéƒ½æ˜¯åŒå±‚æ¯”è¾ƒã€ä¸åŒç‚¹ï¼švue ä½¿ç”¨åŒæŒ‡é’ˆæ¯”è¾ƒï¼Œreact æ˜¯ key é›†åˆçº§æ¯”è¾ƒ react StrictMode ä¸¥æ ¼æ¨¡å¼StrictMode æ˜¯ä¸€ç§è¾…åŠ©ç»„ä»¶ï¼Œå¯ä»¥å¸®åŠ©ç¼–å†™æ›´å¥½çš„ç»„ä»¶ã€‚ éªŒè¯æ˜¯å¦éµå¾ªæ¨èå†™æ³• éªŒè¯æ˜¯å¦ä½¿ç”¨äº†å·²ç»åºŸå¼ƒçš„å†™æ³• é€šè¿‡è¯†åˆ«ä¸€äº›æ½œåœ¨çš„é£é™©é¢„é˜²å‰¯ä½œç”¨ react äº‹ä»¶çš„åˆæˆæœºåˆ¶ div æˆ–å…¶ä»–å…ƒç´ è§¦å‘äº‹ä»¶ï¼Œè¯¥äº‹ä»¶ä¼šå†’æ³¡åˆ° documentï¼Œç„¶åè¢« React çš„äº‹ä»¶å¤„ç†ç¨‹åºæ•è· äº‹ä»¶å¤„ç†ç¨‹åºéšåå°†äº‹ä»¶ä¼ é€’ç»™ SyntheticEvent çš„å®ä¾‹ï¼Œè¿™æ˜¯ä¸€ä¸ªè·¨æµè§ˆå™¨åŸç”Ÿäº‹ä»¶åŒ…è£…å™¨ã€‚ SyntheticEvent è§¦å‘ dispatchEventï¼Œå°† event å¯¹è±¡äº¤ç”±å¯¹åº”çš„å¤„ç†å™¨æ‰§è¡Œã€‚ ä¸ºä»€ä¹ˆè¦åˆæˆäº‹ä»¶æœºåˆ¶ æ›´å¥½çš„å…¼å®¹æ€§å’Œè·¨å¹³å° react äº‹ä»¶æœºåˆ¶é‡‡ç”¨äº†äº‹ä»¶æ± ï¼Œå¤§å¤§èŠ‚çœå†…å­˜ æ–¹ä¾¿äº‹ä»¶çš„ç»Ÿä¸€ç®¡ç† react å¤„ç†é˜»æ­¢å†’æ³¡ // é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œï¼ˆé˜»æ­¢è¿™ä¸ªåˆæˆäº‹ä»¶ï¼Œå¾€documentä¸Šå†’æ³¡ï¼Œå› æ­¤ä¸ä¼šè§¦å‘clickæ–¹æ³•ï¼‰e.stopPropagation();// é˜»æ­¢åˆæˆäº‹ä»¶é—´çš„å†’æ³¡ï¼Œä¸ä¼šå¾€æœ€å¤–å±‚å†’äº†e.nativeEvent.stopImmediatePropagation(); redux å­˜åœ¨çš„é—®é¢˜ =&gt; é‡ ä¸€ä»½ store æ ‘ï¼Œç¦»å¼€é¡µé¢å†æ¬¡è¿›å…¥ï¼Œæ•°æ®ä¸ä¼šåˆå§‹åŒ– reducer æ‹†åˆ†é€ æˆæ±‡æ€»å›°éš¾ action çš„ type ç®¡ç†æ··ä¹±ï¼Œé‡å¤é—®é¢˜ ç¹æ‚çš„ä½¿ç”¨è§„åˆ™ï¼Œindex é¡µé¢ action å’Œ store å¼•å…¥ï¼Œçº¯å‡½æ•° reducer å¤§é‡ case ä»…ä»…ä¸ºäº†æ”¹å˜ä¸€ä¸ªå€¼ å¸¸ç”¨ UI åº“ ç§»åŠ¨ç«¯ant design mobile pc ç«¯ant design reactstrap patternfly-react semantic-ui material-ui elemental-ui å¸¸ç”¨ç»„ä»¶ æ— é™æ»šåŠ¨åŠ è½½react-infinite-scroller react-list react-infinite-scroll-component å›½é™…åŒ–react-i18next react-intl date åº“momentmimentdayjs å‚è€ƒreact","updated":"2025-08-02T05:46:04.176Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"react","slug":"react","permalink":"https://luckyship.github.io/tags/react/"}]},{"title":"æ‰‹å†™promise","date":"2021-07-17T03:18:50.000Z","path":"2021/07/17/2021-07-17-promise/","text":"Promise è§„èŒƒpromise æœ€æ—©æ˜¯åœ¨ commonjs ç¤¾åŒºæå‡ºæ¥çš„ï¼Œå½“æ—¶æå‡ºäº†å¾ˆå¤šè§„èŒƒã€‚æ¯”è¾ƒæ¥å—çš„æ˜¯ promise/A è§„èŒƒã€‚ä½†æ˜¯ promise/A è§„èŒƒæ¯”è¾ƒç®€å•ï¼Œåæ¥äººä»¬åœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œæå‡ºäº† promise/A+è§„èŒƒï¼Œä¹Ÿå°±æ˜¯å®é™…ä¸Šçš„ä¸šå†…æ¨è¡Œçš„è§„èŒƒï¼›es6 ä¹Ÿæ˜¯é‡‡ç”¨çš„è¿™ç§è§„èŒƒï¼Œä½†æ˜¯ es6 åœ¨æ­¤è§„èŒƒä¸Šè¿˜åŠ å…¥äº† Promise.allã€Promise.raceã€Promise.catchã€Promise.resolveã€Promise.reject ç­‰æ–¹æ³•ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡è„šæœ¬æ¥æµ‹è¯•æˆ‘ä»¬å†™çš„ Promise æ˜¯å¦ç¬¦åˆ promise/A+çš„è§„èŒƒã€‚å°†æˆ‘ä»¬å®ç°çš„ Promise åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š Promise.defer = Promise.deferred = function () &#123; let dfd = &#123;&#125;; dfd.promise = new Promise((resolve, reject) =&gt; &#123; dfd.resolve = resolve; dfd.reject = reject; &#125;); return dfd;&#125;; ç„¶åé€šè¿‡ module.exports å¯¼å‡ºï¼Œå®‰è£…æµ‹è¯•çš„è„šæœ¬ï¼š npm install -g promises-aplus-tests åœ¨å®ç° Promise çš„ç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š promises-aplus-tests promise.js æ¥ä¸‹æ¥ï¼Œè„šæœ¬ä¼šå¯¹ç…§ç€ promise/A+çš„è§„èŒƒï¼Œå¯¹æˆ‘ä»¬çš„è„šæœ¬æ¥ä¸€æ¡ä¸€æ¡åœ°è¿›è¡Œæµ‹è¯•ã€‚ Promise åŸºæœ¬ç»“æ„æˆ‘ä»¬å…ˆå›é¡¾ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¹³æ—¶éƒ½æ˜¯æ€ä¹ˆä½¿ç”¨ Promise çš„ï¼š let p = new Promise(function (resolve, reject) &#123; console.log(&quot;æ‰§è¡Œ&quot;); setTimeout(function () &#123; resolve(2); &#125;, 1000);&#125;);p.then( function (res) &#123; console.log(&quot;suc&quot;, res); &#125;, function (err) &#123; console.log(&quot;err&quot;, err); &#125;); é¦–å…ˆçœ‹å‡ºæ¥ï¼ŒPromise æ˜¯é€šè¿‡æ„é€ å‡½æ•°å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åé€šè¿‡å®ä¾‹å¯¹è±¡ä¸Šçš„ then æ–¹æ³•ï¼Œæ¥å¤„ç†å¼‚æ­¥è¿”å›çš„ç»“æœã€‚åŒæ—¶ï¼Œpromise/A+è§„èŒƒè§„å®šäº†ï¼š promise æ˜¯ä¸€ä¸ªæ‹¥æœ‰ then æ–¹æ³•çš„å¯¹è±¡æˆ–å‡½æ•°ï¼Œå…¶è¡Œä¸ºç¬¦åˆæœ¬è§„èŒƒï¼›ä¸€ä¸ª Promise çš„å½“å‰çŠ¶æ€å¿…é¡»ä¸ºä»¥ä¸‹ä¸‰ç§çŠ¶æ€ä¸­çš„ä¸€ç§ï¼šç­‰å¾…æ€ï¼ˆPendingï¼‰ã€æ‰§è¡Œæ€ï¼ˆFulfilledï¼‰å’Œæ‹’ç»æ€ï¼ˆRejectedï¼‰ã€‚ const PENDING = &quot;pending&quot;;const FULFILLED = &quot;fulfilled&quot;;const REJECTED = &quot;rejected&quot;;function Promise(executor) &#123; let _this = this; this.state = PENDING; //çŠ¶æ€ this.value = undefined; //æˆåŠŸç»“æœ this.reason = undefined; //å¤±è´¥åŸå›  function resolve(value) &#123;&#125; function reject(reason) &#123;&#125;&#125;Promise.prototype.then = function (onFulfilled, onRejected) &#123;&#125;;module.exports = Promise; å½“æˆ‘ä»¬å®ä¾‹åŒ– Promise æ—¶ï¼Œæ„é€ å‡½æ•°ä¼šé©¬ä¸Šè°ƒç”¨ä¼ å…¥çš„æ‰§è¡Œå‡½æ•° executorï¼Œæˆ‘ä»¬å¯ä»¥è¯•ä¸€ä¸‹ï¼š let p = new Promise((resolve, reject) =&gt; &#123; console.log(&quot;æ‰§è¡Œäº†&quot;);&#125;); å› æ­¤åœ¨ Promise ä¸­æ„é€ å‡½æ•°ç«‹é©¬æ‰§è¡Œï¼ŒåŒæ—¶å°† resolve å‡½æ•°å’Œ reject å‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥ï¼š function Promise(executor) &#123; let _this = this; this.state = PENDING; //çŠ¶æ€ this.value = undefined; //æˆåŠŸç»“æœ this.reason = undefined; //å¤±è´¥åŸå›  function resolve(value) &#123;&#125; function reject(reason) &#123;&#125; executor(resolve, reject);&#125; ä½†æ˜¯ executor ä¹Ÿä¼šå¯èƒ½å­˜åœ¨å¼‚å¸¸ï¼Œå› æ­¤é€šè¿‡ try/catch æ¥æ•è·ä¸€ä¸‹å¼‚å¸¸æƒ…å†µï¼š try &#123; executor(resolve, reject);&#125; catch (e) &#123; reject(e);&#125; ä¸å¯å˜promise/A+è§„èŒƒä¸­è§„å®šï¼Œå½“ Promise å¯¹è±¡å·²ç»ç”±ç­‰å¾…æ€ï¼ˆPendingï¼‰æ”¹å˜ä¸ºæ‰§è¡Œæ€ï¼ˆFulfilledï¼‰æˆ–è€…æ‹’ç»æ€ï¼ˆRejectedï¼‰åï¼Œå°±ä¸èƒ½å†æ¬¡æ›´æ”¹çŠ¶æ€ï¼Œä¸”ç»ˆå€¼ä¹Ÿä¸å¯æ”¹å˜ã€‚ å› æ­¤æˆ‘ä»¬åœ¨å›è°ƒå‡½æ•° resolve å’Œ reject ä¸­åˆ¤æ–­ï¼Œåªèƒ½æ˜¯ pending çŠ¶æ€çš„æ—¶å€™æ‰èƒ½æ›´æ”¹çŠ¶æ€ï¼š function resolve(value) &#123; if (_this.state === PENDING) &#123; _this.state = FULFILLED; _this.value = value; &#125;&#125;function reject(reason) &#123; if (_this.state === PENDING) &#123; _this.state = REJECTED; _this.reason = reason; &#125;&#125; æˆ‘ä»¬æ›´æ”¹çŠ¶æ€çš„åŒæ—¶ï¼Œå°†å›è°ƒå‡½æ•°ä¸­æˆåŠŸçš„ç»“æœæˆ–è€…å¤±è´¥çš„åŸå› éƒ½ä¿å­˜åœ¨å¯¹åº”çš„å±æ€§ä¸­ï¼Œæ–¹ä¾¿ä»¥åæ¥è·å–ã€‚ then å®ç°å½“ Promise çš„çŠ¶æ€æ”¹å˜ä¹‹åï¼Œä¸ç®¡æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œéƒ½ä¼šè§¦å‘ then å›è°ƒå‡½æ•°ã€‚å› æ­¤ï¼Œthen çš„å®ç°ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯æ ¹æ®çŠ¶æ€çš„ä¸åŒï¼Œæ¥è°ƒç”¨ä¸åŒå¤„ç†ç»ˆå€¼çš„å‡½æ•°ã€‚ Promise.prototype.then = function (onFulfilled, onRejected) &#123; if (this.state === FULFILLED) &#123; typeof onFulfilled === &quot;function&quot; &amp;&amp; onFulfilled(this.value); &#125; if (this.state === REJECTED) &#123; typeof onRejected === &quot;function&quot; &amp;&amp; onRejected(this.reason); &#125;&#125;; åœ¨è§„èŒƒä¸­ä¹Ÿè¯´äº†ï¼ŒonFulfilled å’Œ onRejected æ˜¯å¯é€‰çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯¹ä¸¤ä¸ªå€¼è¿›è¡Œä¸€ä¸‹ç±»å‹çš„åˆ¤æ–­ï¼š onFulfilled å’Œ onRejected éƒ½æ˜¯å¯é€‰å‚æ•°ã€‚å¦‚æœ onFulfilled ä¸æ˜¯å‡½æ•°ï¼Œå…¶å¿…é¡»è¢«å¿½ç•¥ã€‚å¦‚æœ onRejected ä¸æ˜¯å‡½æ•°ï¼Œå…¶å¿…é¡»è¢«å¿½ç•¥ ä»£ç å†™åˆ°è¿™é‡Œï¼Œè²Œä¼¼è¯¥æœ‰çš„å®ç°æ–¹å¼éƒ½æœ‰äº†ï¼Œæˆ‘ä»¬æ¥å†™ä¸ª demo æµ‹è¯•ä¸€ä¸‹ï¼š let myP = new Promise(function (resolve, reject) &#123; console.log(&quot;æ‰§è¡Œ&quot;); setTimeout(function () &#123; reject(3); &#125;, 1000);&#125;);myP.then( function (res) &#123; console.log(res); &#125;, function (err) &#123; console.log(err); &#125;); ç„¶é¹…ï¼Œå¾ˆé—æ†¾ï¼Œè¿è¡Œèµ·æ¥æˆ‘ä»¬å‘ç°åªæ‰“å°äº†æ„é€ å‡½æ•°ä¸­çš„æ‰§è¡Œï¼Œä¸‹é¢çš„ then å‡½æ•°æ ¹æœ¬éƒ½æ²¡æœ‰æ‰§è¡Œã€‚æˆ‘ä»¬æ•´ç†ä¸€ä¸‹ä»£ç çš„è¿è¡Œæµç•…ï¼š å½“ then é‡Œé¢å‡½æ•°è¿è¡Œæ—¶ï¼Œresolve ç”±äºæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œè¿˜æ²¡æœ‰æ¥å¾—åŠä¿®æ”¹ stateï¼Œæ­¤æ—¶è¿˜æ˜¯ PENDING çŠ¶æ€ï¼›å› æ­¤æˆ‘ä»¬éœ€è¦å¯¹å¼‚æ­¥çš„æƒ…å†µåšä¸€ä¸‹å¤„ç†ã€‚ æ”¯æŒå¼‚æ­¥é‚£ä¹ˆå¦‚ä½•è®©æˆ‘ä»¬çš„ Promise æ¥æ”¯æŒå¼‚æ­¥å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥å‚è€ƒå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œåœ¨æ‰§è¡Œ then æ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚æœå½“å‰è¿˜æ˜¯ PENDING çŠ¶æ€ï¼Œå°±æŠŠå›è°ƒå‡½æ•°å¯„å­˜åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå½“çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå»æ•°ç»„ä¸­å–å‡ºå›è°ƒå‡½æ•°ï¼›å› æ­¤æˆ‘ä»¬å…ˆåœ¨ Promise ä¸­å®šä¹‰ä¸€ä¸‹å˜é‡ï¼š function Promise(executor) &#123; this.onFulfilled = []; //æˆåŠŸçš„å›è°ƒ this.onRejected = []; //å¤±è´¥çš„å›è°ƒ&#125; è¿™æ ·ï¼Œå½“ then æ‰§è¡Œæ—¶ï¼Œå¦‚æœè¿˜æ˜¯ PENDING çŠ¶æ€ï¼Œæˆ‘ä»¬ä¸æ˜¯é©¬ä¸Šå»æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œè€Œæ˜¯å°†å…¶å­˜å‚¨èµ·æ¥ï¼š Promise.prototype.then = function (onFulfilled, onRejected) &#123; if (this.state === FULFILLED) &#123; typeof onFulfilled === &quot;function&quot; &amp;&amp; onFulfilled(this.value); &#125; if (this.state === REJECTED) &#123; typeof onRejected === &quot;function&quot; &amp;&amp; onRejected(this.reason); &#125; if (this.state === PENDING) &#123; typeof onFulfilled === &quot;function&quot; &amp;&amp; this.onFulfilled.push(onFulfilled); typeof onRejected === &quot;function&quot; &amp;&amp; this.onRejected.push(onRejected); &#125;&#125;; å­˜å‚¨èµ·æ¥åï¼Œå½“ resolve æˆ–è€… reject å¼‚æ­¥æ‰§è¡Œçš„æ—¶å€™å°±å¯ä»¥æ¥è°ƒç”¨äº†ï¼š function resolve(value) &#123; if (_this.state === PENDING) &#123; _this.state = FULFILLED; _this.value = value; _this.onFulfilled.forEach((fn) =&gt; fn(value)); &#125;&#125;function reject(reason) &#123; if (_this.state === PENDING) &#123; _this.state = REJECTED; _this.reason = reason; _this.onRejected.forEach((fn) =&gt; fn(reason)); &#125;&#125; æœ‰ç«¥é‹å¯èƒ½ä¼šæå‡ºç–‘é—®äº†ï¼Œä¸ºä»€ä¹ˆè¿™è¾¹ onFulfilled å’Œ onRejected è¦å­˜åœ¨æ•°ç»„ä¸­ï¼Œç›´æ¥ç”¨ä¸€ä¸ªå˜é‡æ¥æ”¶ä¸æ˜¯ä¹Ÿå¯ä»¥ä¹ˆï¼Ÿä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­ï¼š let p = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(4); &#125;, 0);&#125;);p.then((res) =&gt; &#123; //4 res console.log(res, &quot;res&quot;);&#125;);p.then((res1) =&gt; &#123; //4 res1 console.log(res1, &quot;res1&quot;);&#125;); æˆ‘ä»¬åˆ†åˆ«è°ƒç”¨äº†ä¸¤æ¬¡ thenï¼Œå¦‚æœæ˜¯ä¸€ä¸ªå˜é‡çš„è¯ï¼Œæœ€åè‚¯å®šåªä¼šè¿è¡Œåä¸€ä¸ª thenï¼ŒæŠŠä¹‹å‰çš„è¦†ç›–äº†ï¼Œå¦‚æœæ˜¯æ•°ç»„çš„è¯ï¼Œä¸¤ä¸ª then éƒ½èƒ½æ­£å¸¸è¿è¡Œã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬è¿è¡Œ demoï¼Œå°±èƒ½å¦‚æ„¿ä»¥å¿çš„çœ‹åˆ°è¿è¡Œç»“æœäº†ï¼›ä¸€ä¸ªå››åè¡Œå·¦å³çš„ç®€å• Promise å«ç‰‡å°±æ­¤å®Œæˆäº†ã€‚è¿™é‡Œè´´ä¸€ä¸‹å®Œæ•´çš„ä»£ç ï¼š const PENDING = &quot;pending&quot;;const FULFILLED = &quot;fulfilled&quot;;const REJECTED = &quot;rejected&quot;;function Promise(executor) &#123; let _this = this; this.state = PENDING; //çŠ¶æ€ this.value = undefined; //æˆåŠŸç»“æœ this.reason = undefined; //å¤±è´¥åŸå›  this.onFulfilled = []; //æˆåŠŸçš„å›è°ƒ this.onRejected = []; //å¤±è´¥çš„å›è°ƒ function resolve(value) &#123; if (_this.state === PENDING) &#123; _this.state = FULFILLED; _this.value = value; _this.onFulfilled.forEach((fn) =&gt; fn(value)); &#125; &#125; function reject(reason) &#123; if (_this.state === PENDING) &#123; _this.state = REJECTED; _this.reason = reason; _this.onRejected.forEach((fn) =&gt; fn(reason)); &#125; &#125; try &#123; executor(resolve, reject); &#125; catch (e) &#123; reject(e); &#125;&#125;Promise.prototype.then = function (onFulfilled, onRejected) &#123; if (this.state === FULFILLED) &#123; typeof onFulfilled === &quot;function&quot; &amp;&amp; onFulfilled(this.value); &#125; if (this.state === REJECTED) &#123; typeof onRejected === &quot;function&quot; &amp;&amp; onRejected(this.reason); &#125; if (this.state === PENDING) &#123; typeof onFulfilled === &quot;function&quot; &amp;&amp; this.onFulfilled.push(onFulfilled); typeof onRejected === &quot;function&quot; &amp;&amp; this.onRejected.push(onRejected); &#125;&#125;; é“¾å¼è°ƒç”¨ thenç›¸ä¿¡ä¸Šé¢çš„ Promise å«ç‰‡åº”è¯¥å¾ˆå®¹æ˜“ç†è§£ï¼Œä¸‹é¢é“¾å¼è°ƒç”¨æ‰æ˜¯ Promise çš„éš¾ç‚¹å’Œæ ¸å¿ƒç‚¹ï¼›æˆ‘ä»¬å¯¹ç…§ promise/A+è§„èŒƒï¼Œä¸€æ­¥ä¸€æ­¥åœ°æ¥å®ç°ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹è§„èŒƒæ˜¯å¦‚ä½•æ¥å®šä¹‰çš„ï¼š then æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ª promise å¯¹è±¡promise2 = promise1.then(onFulfilled, onRejected); ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ª then æ–¹æ³•éƒ½è¦è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼Œè¿™æ ·æˆ‘ä»¬çš„ then æ–¹æ³•æ‰èƒ½ä¸æ–­çš„é“¾å¼è°ƒç”¨ï¼›å› æ­¤ä¸Šé¢çš„ç®€å•å«ç‰‡ä¸­ then æ–¹æ³•å°±ä¸é€‚ç”¨äº†ï¼Œå› ä¸ºå®ƒä»€ä¹ˆéƒ½æ²¡æœ‰è¿”å›ï¼Œæˆ‘ä»¬å¯¹å…¶è¿›è¡Œç®€å•çš„æ”¹å†™ï¼Œä¸è®º then è¿›è¡Œä»€ä¹ˆæ“ä½œï¼Œéƒ½è¿”å›ä¸€ä¸ªæ–°çš„ Promise å¯¹è±¡ï¼š Promise.prototype.then = function (onFulfilled, onRejected) &#123; let promise2 = new Promise((resolve, reject) =&gt; &#123;&#125;); return promise2;&#125;; æˆ‘ä»¬ç»§ç»­çœ‹ then çš„æ‰§è¡Œè¿‡ç¨‹ï¼š å¦‚æœ onFulfilled æˆ–è€… onRejected è¿”å›ä¸€ä¸ªå€¼ x ï¼Œåˆ™è¿è¡Œä¸‹é¢çš„ Promise è§£å†³è¿‡ç¨‹ï¼š[[Resolve]](promise2, x) å¦‚æœ onFulfilled æˆ–è€… onRejected æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ e ï¼Œåˆ™ promise2 å¿…é¡»æ‹’ç»æ‰§è¡Œï¼Œå¹¶è¿”å›æ‹’å›  e å¦‚æœ onFulfilled ä¸æ˜¯å‡½æ•°ä¸” promise1 æˆåŠŸæ‰§è¡Œï¼Œ promise2 å¿…é¡»æˆåŠŸæ‰§è¡Œå¹¶è¿”å›ç›¸åŒçš„å€¼ å¦‚æœ onRejected ä¸æ˜¯å‡½æ•°ä¸” promise1 æ‹’ç»æ‰§è¡Œï¼Œ promise2 å¿…é¡»æ‹’ç»æ‰§è¡Œå¹¶è¿”å›ç›¸åŒçš„æ®å›  é¦–å…ˆç¬¬ä¸€ç‚¹ï¼Œæˆ‘ä»¬çŸ¥é“ onFulfilled å’Œ onRejected æ‰§è¡Œä¹‹åéƒ½ä¼šæœ‰ä¸€ä¸ªè¿”å›å€¼ xï¼Œå¯¹è¿”å›å€¼ x å¤„ç†å°±éœ€è¦ç”¨åˆ° Promise è§£å†³è¿‡ç¨‹ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¸‹é¢å†è¯´ï¼›ç¬¬äºŒç‚¹éœ€è¦å¯¹ onFulfilled å’Œ onRejected è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼›ç¬¬ä¸‰å’Œç¬¬å››ç‚¹ï¼Œè¯´çš„å…¶å®æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœ onFulfilled å’Œ onRejected ä¸¤ä¸ªå‚æ•°æ²¡æœ‰ä¼ ï¼Œåˆ™ç»§ç»­å¾€ä¸‹ä¼ ï¼ˆå€¼çš„ä¼ é€’ç‰¹æ€§ï¼‰ï¼›ä¸¾ä¸ªä¾‹å­ï¼š let p = new Promise(function (resolve, reject) &#123; setTimeout(function () &#123; resolve(3); &#125;, 1000);&#125;);p.then(1, 1) .then(&quot;&quot;, &quot;&quot;) .then() .then(function (res) &#123; //3 console.log(res); &#125;); è¿™é‡Œä¸ç®¡ onFulfilled å’Œ onRejected ä¼ ä»€ä¹ˆå€¼ï¼Œåªè¦ä¸æ˜¯å‡½æ•°ï¼Œå°±ç»§ç»­å‘ä¸‹ä¼ å…¥ï¼Œç›´åˆ°æœ‰å‡½æ•°è¿›è¡Œæ¥æ”¶ï¼›å› æ­¤æˆ‘ä»¬å¯¹ then æ–¹æ³•è¿›è¡Œå¦‚ä¸‹å®Œå–„ï¼š //_thisæ˜¯promise1çš„å®ä¾‹å¯¹è±¡let _this = this;onFulfilled = typeof onFulfilled === &quot;function&quot; ? onFulfilled : (value) =&gt; value;onRejected = typeof onRejected === &quot;function&quot; ? onRejected : (reason) =&gt; &#123; throw reason; &#125;;let promise2 = new Promise((resolve, reject) =&gt; &#123; if (_this.state === FULFILLED) &#123; let x = onFulfilled(_this.value); resolvePromise(promise2, x, resolve, reject); &#125; else if (_this.state === REJECTED) &#123; let x = onRejected(_this.reason); resolvePromise(promise2, x, resolve, reject); &#125; else if (_this.state === PENDING) &#123; _this.onFulfilled.push(() =&gt; &#123; let x = onFulfilled(_this.value); resolvePromise(promise2, x, resolve, reject); &#125;); _this.onRejected.push(() =&gt; &#123; let x = onRejected(_this.reason); resolvePromise(promise2, x, resolve, reject); &#125;); &#125;&#125;); æˆ‘ä»¬å‘ç°å‡½æ•°ä¸­æœ‰ä¸€ä¸ª resolvePromiseï¼Œå°±æ˜¯ä¸Šé¢è¯´çš„ Promise è§£å†³è¿‡ç¨‹ï¼Œå®ƒæ˜¯å¯¹æ–°çš„ promise2 å’Œä¸Šä¸€ä¸ªæ‰§è¡Œç»“æœ x çš„å¤„ç†ï¼Œç”±äºå…·æœ‰å¤ç”¨æ€§ï¼Œæˆ‘ä»¬æŠŠå®ƒæŠ½æˆä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ï¼Œè¿™ä¹Ÿæ˜¯ä¸Šé¢è§„èŒƒä¸­å®šä¹‰çš„ç¬¬ä¸€ç‚¹ã€‚ ç”±äº then çš„å›è°ƒæ˜¯å¼‚æ­¥æ‰§è¡Œçš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æŠŠ onFulfilled å’Œ onRejected æ‰§è¡Œæ”¾åˆ°å¼‚æ­¥ä¸­å»æ‰§è¡Œï¼ŒåŒæ—¶åšä¸€ä¸‹é”™è¯¯çš„å¤„ç†ï¼š //å…¶ä»–ä»£ç ç•¥if (_this.state === FULFILLED) &#123; setTimeout(() =&gt; &#123; try &#123; let x = onFulfilled(_this.value); resolvePromise(promise2, x, resolve, reject); &#125; catch (error) &#123; reject(error); &#125; &#125;);&#125; else if (_this.state === REJECTED) &#123; setTimeout(() =&gt; &#123; try &#123; let x = onRejected(_this.reason); resolvePromise(promise2, x, resolve, reject); &#125; catch (error) &#123; reject(error); &#125; &#125;);&#125; else if (_this.state === PENDING) &#123; _this.onFulfilled.push(() =&gt; &#123; setTimeout(() =&gt; &#123; try &#123; let x = onFulfilled(_this.value); resolvePromise(promise2, x, resolve, reject); &#125; catch (error) &#123; reject(error); &#125; &#125;); &#125;); _this.onRejected.push(() =&gt; &#123; setTimeout(() =&gt; &#123; try &#123; let x = onRejected(_this.reason); resolvePromise(promise2, x, resolve, reject); &#125; catch (error) &#123; reject(error); &#125; &#125;); &#125;);&#125; Promise è§£å†³è¿‡ç¨‹ Promise è§£å†³è¿‡ç¨‹æ˜¯ä¸€ä¸ªæŠ½è±¡çš„æ“ä½œï¼Œå…¶éœ€è¾“å…¥ä¸€ä¸ª promise å’Œä¸€ä¸ªå€¼ï¼Œæˆ‘ä»¬è¡¨ç¤ºä¸º [[Resolve]](promise, x)ï¼Œå¦‚æœ x æœ‰ then æ–¹æ³•ä¸”çœ‹ä¸Šå»åƒä¸€ä¸ª Promise ï¼Œè§£å†³ç¨‹åºå³å°è¯•ä½¿ promise æ¥å— x çš„çŠ¶æ€ï¼›å¦åˆ™å…¶ç”¨ x çš„å€¼æ¥æ‰§è¡Œ promise ã€‚ è¿™æ®µè¯æ¯”è¾ƒæŠ½è±¡ï¼Œé€šä¿—ä¸€ç‚¹çš„æ¥è¯´å°±æ˜¯ promise çš„è§£å†³è¿‡ç¨‹éœ€è¦ä¼ å…¥ä¸€ä¸ªæ–°çš„ promise å’Œä¸€ä¸ªå€¼ xï¼Œå¦‚æœä¼ å…¥çš„ x æ˜¯ä¸€ä¸ª thenable çš„å¯¹è±¡ï¼ˆå…·æœ‰ then æ–¹æ³•ï¼‰ï¼Œå°±æ¥å— x çš„çŠ¶æ€ï¼š //promise2ï¼šæ–°çš„Promiseå¯¹è±¡//xï¼šä¸Šä¸€ä¸ªthençš„è¿”å›å€¼//resolveï¼špromise2çš„resolve//rejectï¼špromise2çš„rejectfunction resolvePromise(promise2, x, resolve, reject) &#123;&#125; å®šä¹‰å¥½å‡½æ•°åï¼Œæ¥çœ‹å…·ä½“çš„æ“ä½œè¯´æ˜ï¼š x ä¸ promise ç›¸ç­‰ å¦‚æœ promise å’Œ x æŒ‡å‘åŒä¸€å¯¹è±¡ï¼Œä»¥ TypeError ä¸ºæ®å› æ‹’ç»æ‰§è¡Œ promise x ä¸º Promise å¦‚æœ x å¤„äºç­‰å¾…æ€ï¼Œ promise éœ€ä¿æŒä¸ºç­‰å¾…æ€ç›´è‡³ x è¢«æ‰§è¡Œæˆ–æ‹’ç» å¦‚æœ x å¤„äºæ‰§è¡Œæ€ï¼Œç”¨ç›¸åŒçš„å€¼æ‰§è¡Œ promise å¦‚æœ x å¤„äºæ‹’ç»æ€ï¼Œç”¨ç›¸åŒçš„æ®å› æ‹’ç» promise 1ã€x ä¸ºå¯¹è±¡æˆ–å‡½æ•° 1ã€ æŠŠ x.then èµ‹å€¼ç»™ then 2ã€ å¦‚æœå– x.then çš„å€¼æ—¶æŠ›å‡ºé”™è¯¯ e ï¼Œåˆ™ä»¥ e ä¸ºæ®å› æ‹’ç» * promise 3ã€ å¦‚æœ then æ˜¯å‡½æ•°ï¼Œå°† x ä½œä¸ºå‡½æ•°çš„ä½œç”¨åŸŸ this è°ƒç”¨ä¹‹ã€‚ä¼ é€’ä¸¤ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å«åš resolvePromise ï¼Œç¬¬äºŒä¸ªå‚æ•°å«åš rejectPromise: 1ã€ å¦‚æœ resolvePromise ä»¥å€¼ y ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™è¿è¡Œ * [Resolve] 2ã€ å¦‚æœ rejectPromise ä»¥æ®å›  r ä¸ºå‚æ•°è¢«è°ƒç”¨ï¼Œåˆ™ä»¥æ®å›  * r æ‹’ç» promise 3ã€ å¦‚æœ resolvePromise å’Œ rejectPromise å‡è¢«è°ƒç”¨ï¼Œæˆ–* è€…è¢«åŒä¸€å‚æ•°è°ƒç”¨äº†å¤šæ¬¡ï¼Œåˆ™ * ä¼˜å…ˆé‡‡ç”¨é¦–æ¬¡è°ƒç”¨å¹¶å¿½ç•¥å‰©* ä¸‹çš„è°ƒç”¨ 4ã€ å¦‚æœ then ä¸æ˜¯å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ promise 2ã€ å¦‚æœ x ä¸ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œä»¥ x ä¸ºå‚æ•°æ‰§è¡Œ promiseé¦–å…ˆç¬¬ä¸€ç‚¹ï¼Œå¦‚æœ x å’Œ promise ç›¸ç­‰ï¼Œè¿™æ˜¯ä¸€ç§ä»€ä¹ˆæƒ…å†µå‘¢ï¼Œå°±æ˜¯ç›¸å½“äºæŠŠè‡ªå·±è¿”å›å‡ºå»äº†ï¼š let p = new Promise(function (resolve, reject) &#123; resolve(3);&#125;);//Uncaught (in promise) TypeError: Chaining cycle detected for promise #&lt;Promise&gt;let p2 = p.then(function () &#123; return p2;&#125;); è¿™æ ·ä¼šé™·å…¥ä¸€ä¸ªæ­»å¾ªç¯ä¸­ï¼Œå› æ­¤æˆ‘ä»¬é¦–å…ˆè¦æŠŠè¿™ç§æƒ…å†µç»™æ’é™¤æ‰ï¼š function resolvePromise(promise2, x, resolve, reject) &#123; if (promise2 === x) &#123; reject(new TypeError(&quot;Chaining cycle&quot;)); &#125;&#125; æ¥ä¸‹æ¥å°±æ˜¯å¯¹ä¸åŒæƒ…å†µçš„åˆ¤æ–­äº†ï¼Œé¦–å…ˆæˆ‘ä»¬æŠŠ x ä¸ºå¯¹è±¡æˆ–è€…å‡½æ•°çš„æƒ…å†µç»™åˆ¤æ–­å‡ºæ¥ï¼š function resolvePromise(promise2, x, resolve, reject) &#123; if (promise2 === x) &#123; reject(new TypeError(&quot;Chaining cycle&quot;)); &#125; if (x !== null &amp;&amp; (typeof x === &quot;object&quot; || typeof x === &quot;function&quot;)) &#123; //å‡½æ•°æˆ–å¯¹è±¡ &#125; else &#123; //æ™®é€šå€¼ resolve(x); &#125;&#125; å¦‚æœ x ä¸ºå¯¹è±¡æˆ–å‡½æ•°ï¼Œå°±æŠŠ x.then èµ‹å€¼ç»™ then å¥½ç†è§£ï¼Œä½†æ˜¯ç¬¬äºŒç‚¹å– then æœ‰å¯èƒ½ä¼šæŠ¥é”™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºéœ€è¦è€ƒè™‘åˆ°æ‰€æœ‰å‡ºé”™çš„æƒ…å†µï¼ˆé˜²å°äººä¸é˜²å›å­ï¼‰ï¼Œå¦‚æœæœ‰äººå®ç° Promise å¯¹è±¡çš„æ—¶å€™ä½¿ç”¨ Object.defineProperty()æ¶æ„æŠ›é”™ï¼Œå¯¼è‡´ç¨‹åºå´©æºƒï¼Œå°±åƒè¿™æ ·ï¼š let Promise = &#123;&#125;;Object.defineProperty(Promise, &quot;then&quot;, &#123; get: function () &#123; throw Error(&quot;error&quot;); &#125;,&#125;);//Uncaught Error: errorPromise.then; å› æ­¤ï¼Œæˆ‘ä»¬å– then çš„æ—¶å€™ä¹Ÿéœ€è¦ try/catchï¼š //å…¶ä»–ä»£ç ç•¥if (x !== null &amp;&amp; (typeof x === &quot;object&quot; || typeof x === &quot;function&quot;)) &#123; //å‡½æ•°æˆ–å¯¹è±¡ try &#123; let then = x.then; &#125; catch (e) &#123; reject(e); &#125;&#125; å–å‡º then åï¼Œå›åˆ° 3.3ï¼Œåˆ¤æ–­å¦‚æœæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°±å°† x ä½œä¸ºå‡½æ•°çš„ä½œç”¨åŸŸ this è°ƒç”¨ï¼ŒåŒæ—¶ä¼ å…¥ä¸¤ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚ //å…¶ä»–ä»£ç ç•¥try &#123; let then = x.then; if (typeof then === &quot;function&quot;) &#123; then.call( x, (y) =&gt; &#123; resolve(y); &#125;, (r) =&gt; &#123; reject(r); &#125; ); &#125; else &#123; resolve(x); &#125;&#125; catch (e) &#123; reject(e);&#125; è¿™æ ·ï¼Œæˆ‘ä»¬çš„é“¾å¼è°ƒç”¨å°±èƒ½é¡ºåˆ©çš„è°ƒç”¨èµ·æ¥äº†ï¼›ä½†æ˜¯è¿˜æœ‰ä¸€ç§ç‰¹æ®Šçš„æƒ…å†µï¼Œå¦‚æœ resolve çš„ y å€¼è¿˜æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿™æ—¶å°±åº”è¯¥ç»§ç»­æ‰§è¡Œï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­ï¼š let p1 = new Promise((resolve, reject) =&gt; &#123; resolve(&quot;p1&quot;);&#125;);p1.then((res) =&gt; &#123; return new Promise((resolve, reject) =&gt; &#123; resolve( new Promise((resolve, reject) =&gt; &#123; resolve(&quot;p2&quot;); &#125;) ); &#125;);&#125;).then((res1) =&gt; &#123; //Promise &#123;state: &quot;fulfilled&quot;, value: &quot;p2&quot;&#125; console.log(res1);&#125;); è¿™æ—¶å€™ç¬¬äºŒä¸ª then æ‰“å°å‡ºæ¥çš„æ˜¯ä¸€ä¸ª promise å¯¹è±¡ï¼›æˆ‘ä»¬åº”è¯¥ç»§ç»­é€’å½’è°ƒç”¨ resolvePromiseï¼ˆå‚è€ƒè§„èŒƒ 3.3.1ï¼‰ï¼Œå› æ­¤ï¼Œæœ€ç»ˆ resolvePromise çš„å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š function resolvePromise(promise2, x, resolve, reject) &#123; if (promise2 === x) &#123; reject(new TypeError(&quot;Chaining cycle&quot;)); &#125; if ((x &amp;&amp; typeof x === &quot;object&quot;) || typeof x === &quot;function&quot;) &#123; let used; try &#123; let then = x.then; if (typeof then === &quot;function&quot;) &#123; then.call( x, (y) =&gt; &#123; if (used) return; used = true; resolvePromise(promise2, y, resolve, reject); &#125;, (r) =&gt; &#123; if (used) return; used = true; reject(r); &#125; ); &#125; else &#123; if (used) return; used = true; resolve(x); &#125; &#125; catch (e) &#123; if (used) return; used = true; reject(e); &#125; &#125; else &#123; resolve(x); &#125;&#125; åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„ Promise ä¹Ÿèƒ½å¤Ÿå®Œæ•´çš„å®ç°é“¾å¼è°ƒç”¨äº†ï¼›ç„¶åæŠŠä»£ç ç”¨ promises-aplus-tests æµ‹è¯•ä¸€ä¸‹ï¼Œæœ€åå®Œæ•´çš„ä»£ç å¦‚ä¸‹ã€‚ const PENDING = &quot;pending&quot;;const FULFILLED = &quot;fulfilled&quot;;const REJECTED = &quot;rejected&quot;;function Promise(executor) &#123; let _this = this; this.state = PENDING; //çŠ¶æ€ this.value = undefined; //æˆåŠŸç»“æœ this.reason = undefined; //å¤±è´¥åŸå›  this.onFulfilled = []; //æˆåŠŸçš„å›è°ƒ this.onRejected = []; //å¤±è´¥çš„å›è°ƒ function resolve(value) &#123; if (_this.state === PENDING) &#123; _this.state = FULFILLED; _this.value = value; _this.onFulfilled.forEach((fn) =&gt; fn(value)); &#125; &#125; function reject(reason) &#123; if (_this.state === PENDING) &#123; _this.state = REJECTED; _this.reason = reason; _this.onRejected.forEach((fn) =&gt; fn(reason)); &#125; &#125; try &#123; executor(resolve, reject); &#125; catch (e) &#123; reject(e); &#125;&#125;Promise.prototype.then = function (onFulfilled, onRejected) &#123; //_thisæ˜¯promise1çš„å®ä¾‹å¯¹è±¡ let _this = this; onFulfilled = typeof onFulfilled === &quot;function&quot; ? onFulfilled : (value) =&gt; value; onRejected = typeof onRejected === &quot;function&quot; ? onRejected : (reason) =&gt; &#123; throw reason; &#125;; let promise2 = new Promise((resolve, reject) =&gt; &#123; if (_this.state === FULFILLED) &#123; setTimeout(() =&gt; &#123; try &#123; let x = onFulfilled(_this.value); resolvePromise(promise2, x, resolve, reject); &#125; catch (error) &#123; reject(error); &#125; &#125;); &#125; else if (_this.state === REJECTED) &#123; setTimeout(() =&gt; &#123; try &#123; let x = onRejected(_this.reason); resolvePromise(promise2, x, resolve, reject); &#125; catch (error) &#123; reject(error); &#125; &#125;); &#125; else if (_this.state === PENDING) &#123; _this.onFulfilled.push(() =&gt; &#123; setTimeout(() =&gt; &#123; try &#123; let x = onFulfilled(_this.value); resolvePromise(promise2, x, resolve, reject); &#125; catch (error) &#123; reject(error); &#125; &#125;); &#125;); _this.onRejected.push(() =&gt; &#123; setTimeout(() =&gt; &#123; try &#123; let x = onRejected(_this.reason); resolvePromise(promise2, x, resolve, reject); &#125; catch (error) &#123; reject(error); &#125; &#125;); &#125;); &#125; &#125;); return promise2;&#125;;function resolvePromise(promise2, x, resolve, reject) &#123; if (promise2 === x) &#123; reject(new TypeError(&quot;Chaining cycle&quot;)); &#125; if ((x &amp;&amp; typeof x === &quot;object&quot;) || typeof x === &quot;function&quot;) &#123; let used; try &#123; let then = x.then; if (typeof then === &quot;function&quot;) &#123; then.call( x, (y) =&gt; &#123; if (used) return; used = true; resolvePromise(promise2, y, resolve, reject); &#125;, (r) =&gt; &#123; if (used) return; used = true; reject(r); &#125; ); &#125; else &#123; if (used) return; used = true; resolve(x); &#125; &#125; catch (e) &#123; if (used) return; used = true; reject(e); &#125; &#125; else &#123; resolve(x); &#125;&#125;Promise.defer = Promise.deferred = function () &#123; let dfd = &#123;&#125;; dfd.promise = new Promise((resolve, reject) =&gt; &#123; dfd.resolve = resolve; dfd.reject = reject; &#125;); return dfd;&#125;;module.exports = Promise; è½¬è½½ä»é›¶å¼€å§‹æ‰‹å†™ Promise","updated":"2025-08-02T05:46:04.176Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"jsé˜²æŠ–å’ŒèŠ‚æµ","date":"2021-07-10T04:09:42.000Z","path":"2021/07/10/2021-07-10-js-debounce-throttle/","text":"é˜²æŠ–(debounce)åœ¨ç¬¬ä¸€æ¬¡è§¦å‘äº‹ä»¶æ—¶ï¼Œä¸ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œè€Œæ˜¯ç»™å‡ºä¸€ä¸ªæœŸé™å€¼æ¯”å¦‚200ms ï¼Œç„¶åï¼šå¦‚æœåœ¨ 200ms å†…æ²¡æœ‰å†æ¬¡è§¦å‘æ»šåŠ¨äº‹ä»¶ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œå‡½æ•°å¦‚æœåœ¨ 200ms å†…å†æ¬¡è§¦å‘æ»šåŠ¨äº‹ä»¶ï¼Œé‚£ä¹ˆå½“å‰çš„è®¡æ—¶å–æ¶ˆï¼Œé‡æ–°å¼€å§‹è®¡æ—¶ function debounce(func, wait) &#123; var timer = null; return function () &#123; var self = this; var args = arguments; if (timer) clearTimeout(timer); timer = setTimeout(function () &#123; typeof func === &#x27;function&#x27; &amp;&amp; func.apply(self, args); &#125;, wait); &#125;;&#125; èŠ‚æµ(throttle)ç±»ä¼¼æ§åˆ¶é˜€é—¨ä¸€æ ·å®šæœŸå¼€æ”¾çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è®©å‡½æ•°æ‰§è¡Œä¸€æ¬¡åï¼Œåœ¨æŸä¸ªæ—¶é—´æ®µå†…æš‚æ—¶å¤±æ•ˆï¼Œè¿‡äº†è¿™æ®µæ—¶é—´åå†é‡æ–°æ¿€æ´»ï¼ˆç±»ä¼¼äºæŠ€èƒ½å†·å´æ—¶é—´ï¼‰ å¦‚æœçŸ­æ—¶é—´å†…å¤§é‡è§¦å‘åŒä¸€äº‹ä»¶ï¼Œé‚£ä¹ˆåœ¨å‡½æ•°æ‰§è¡Œä¸€æ¬¡ä¹‹åï¼Œè¯¥å‡½æ•°åœ¨æŒ‡å®šçš„æ—¶é—´æœŸé™å†…ä¸å†å·¥ä½œï¼Œç›´è‡³è¿‡äº†è¿™æ®µæ—¶é—´æ‰é‡æ–°ç”Ÿæ•ˆã€‚ function throttle(func, wait) &#123; var timer = null; return function () &#123; var self = this; var args = arguments; if (timer) &#123; return; &#125; typeof func === &#x27;function&#x27; &amp;&amp; func.apply(self, args); timer = setTimeout(function () &#123; timer = null; &#125;, wait); &#125;;&#125; åº”ç”¨è®²å®Œäº†è¿™ä¸¤ä¸ªæŠ€å·§ï¼Œä¸‹é¢ä»‹ç»ä¸€ä¸‹å¹³æ—¶å¼€å‘ä¸­å¸¸é‡åˆ°çš„åœºæ™¯ï¼š é˜²æŠ– ç™»å½•ã€å‘çŸ­ä¿¡ç­‰æŒ‰é’®é¿å…ç”¨æˆ·ç‚¹å‡»å¤ªå¿«ï¼Œä»¥è‡´äºå‘é€äº†å¤šæ¬¡è¯·æ±‚ï¼Œéœ€è¦é˜²æŠ– è°ƒæ•´æµè§ˆå™¨çª—å£å¤§å°æ—¶ï¼Œresize æ¬¡æ•°è¿‡äºé¢‘ç¹ï¼Œé€ æˆè®¡ç®—è¿‡å¤šï¼Œæ­¤æ—¶éœ€è¦ä¸€æ¬¡åˆ°ä½ï¼Œå°±ç”¨åˆ°äº†é˜²æŠ– æ–‡æœ¬ç¼–è¾‘å™¨å®æ—¶ä¿å­˜ï¼Œå½“æ— ä»»ä½•æ›´æ”¹æ“ä½œä¸€ç§’åè¿›è¡Œä¿å­˜ èŠ‚æµ DOM å…ƒç´ çš„æ‹–æ‹½åŠŸèƒ½å®ç°ï¼ˆmousemoveï¼‰ å°„å‡»æ¸¸æˆçš„ mousedown/keydown äº‹ä»¶ï¼ˆå•ä½æ—¶é—´åªèƒ½å‘å°„ä¸€é¢—å­å¼¹ï¼‰","updated":"2025-08-02T05:46:04.176Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"jsæ·±æ‹·è´å’Œæµ…æ‹·è´","date":"2021-05-26T14:29:56.000Z","path":"2021/05/26/2021-05-26-js-clone-deep/","text":"æ•°ç»„æ·±æ‹·è´æ•°ç»„æ·±æ‹·è´å®ç°ä¸»è¦ç”¨åˆ° ç”Ÿæˆæ–°æ•°ç»„ çš„æ–¹æ³• silcelet a = [1, 2, 3];a.slice(0); concatlet a = [1, 2, 3];a.concat(); â€¦ è¿ç®—ç¬¦let a = [1, 2, 3];let b = [...a]; å¯¹è±¡æ·±æ‹·è´JSON æ–¹æ³•åˆ©ç”¨ JSON.stringify() å’Œ JSON.parse() æ–¹æ³• &gt; JSON.parse(JSON.stringify(&#123; a: 1&#125;)) &#123; a: 1&#125; å¼Šç«¯// å‡½æ•°var source = &#123; name: function () &#123; console.log(1); &#125;, child: &#123; name: &#x27;child&#x27;, &#125;,&#125;;var target = JSON.parse(JSON.stringify(source));console.log(target.name); //undefined// æ­£åˆ™var source = &#123; name: function () &#123; console.log(1); &#125;, child: new RegExp(&#x27;e&#x27;),&#125;;var target = JSON.parse(JSON.stringify(source));console.log(target.name); //undefinedconsole.log(target.child); //Object &#123;&#125;// undefinedJSON.stringify(&#123; a: undefined &#125;);(&#x27;&#123;&#125;&#x27;);// NaNã€Infinityå’Œ-InfinityJSON.stringify(&#123; a: NaN, b: Infinity, c: -Infinity,&#125;);(&#x27;&#123;&quot;a&quot;:null,&quot;b&quot;:null,&quot;c&quot;:null&#125;&#x27;); Object.assign åªèƒ½ä¸€çº§æ·±æ‹·è´ä¸€çº§å±æ€§ä¸­æœ‰å¯¹è±¡æ—¶ï¼Œ äºŒçº§å¯¹è±¡ä¸ºæµ…æ‹·è´ï¼Œä¸€çº§å¯¹è±¡ä¸ºæ·±æ‹·è´ let obj = &#123; a: 1, b: 2, c: &#123; d: 1 &#125; &#125;; // undefinedlet obj2 = Object.assign(&#123;&#125;, obj); // undefinedobj2.a = 2; // 2obj.a; // 1obj.c.d = 2; // 2obj2.c.d; // 2 é€’å½’è°ƒç”¨var cloneObj = function (obj) &#123; var str, newobj = obj.constructor === Array ? [] : &#123;&#125;; if (typeof obj !== &#x27;object&#x27;) &#123; return; &#125; else &#123; for (var i in obj) &#123; newobj[i] = typeof obj[i] === &#x27;object&#x27; ? cloneObj(obj[i]) : obj[i]; &#125; &#125; return newobj;&#125;;","updated":"2025-08-02T05:46:04.176Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"å¯¼å‡ºcsvæ–‡ä»¶","date":"2021-05-20T10:11:50.000Z","path":"2021/05/20/2021-05-20-export-csv-file/","text":"æ”¯æŒIE11, chrome, firefox, safri tested on IE 11, Chrome 36 and Firefox 29 function exportToCsv(filename, rows) &#123; var processRow = function(row) &#123; var finalVal = &#x27;&#x27;; for (var j = 0; j &lt; row.length; j++) &#123; var innerValue = row[j] === null ? &#x27;&#x27; : row[j].toString(); if (row[j] instanceof Date) &#123; innerValue = row[j].toLocaleString(); &#125;; var result = innerValue.replace(/&quot;/g, &#x27;&quot;&quot;&#x27;); if (result.search(/(&quot;|,|\\n)/g) &gt;= 0) result = &#x27;&quot;&#x27; + result + &#x27;&quot;&#x27;; if (j &gt; 0) finalVal += &#x27;,&#x27;; finalVal += result; &#125; return finalVal + &#x27;\\n&#x27;; &#125;; var csvFile = &#x27;&#x27;; for (var i = 0; i &lt; rows.length; i++) &#123; csvFile += processRow(rows[i]); &#125; var blob = new Blob([csvFile], &#123; type: &#x27;text/csv;charset=utf-8;&#x27; &#125;); if (navigator.msSaveBlob) &#123; // IE 10+ navigator.msSaveBlob(blob, filename); &#125; else &#123; var link = document.createElement(&quot;a&quot;); if (link.download !== undefined) &#123; // feature detection // Browsers that support HTML5 download attribute var url = URL.createObjectURL(blob); link.setAttribute(&quot;href&quot;, url); link.setAttribute(&quot;download&quot;, filename); link.style.visibility = &#x27;hidden&#x27;; document.body.appendChild(link); link.click(); document.body.removeChild(link); &#125; &#125;&#125;","updated":"2025-08-02T05:46:04.176Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"ç©è½¬git","date":"2021-05-15T06:49:47.000Z","path":"2021/05/15/2021-05-15-git-use/","text":"git ä½œä¸ºå½“å‰æœ€æµè¡Œçš„ä»£ç ç®¡ç†å·¥å…·ï¼Œç”¨å¥½ git å¯ä»¥æœ‰æ•ˆçš„æé«˜å›¢é˜Ÿå¼€å‘æ•ˆç‡ å¸¸ç”¨å‘½ä»¤git add# æäº¤å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰å˜æ›´æ–‡ä»¶git add .# æäº¤å½“å‰ä»“åº“ä¸‹çš„æ‰€æœ‰å˜æ›´æ–‡ä»¶git add -all git commit# æäº¤commit ä¿¡æ¯git commit -m &quot;sss&quot;# æäº¤commit ä¿¡æ¯(å¯ä»¥å¤šè¡Œ)git commit -v# ä¿®æ”¹ä¸Šæ¬¡æäº¤commitçš„ä¿¡æ¯git commit --amend git fetchå°†æŸä¸ªè¿œç¨‹ä¸»æœºçš„æ›´æ–°ï¼Œå…¨éƒ¨/åˆ†æ”¯ å–å›æœ¬åœ°ï¼ˆæ­¤æ—¶ä¹‹æ›´æ–°äº† Repositoryï¼‰å®ƒå–å›çš„ä»£ç å¯¹ä½ æœ¬åœ°çš„å¼€å‘ä»£ç æ²¡æœ‰å½±å“ï¼Œå¦‚éœ€å½»åº•æ›´æ–°éœ€åˆå¹¶æˆ–ä½¿ç”¨ git pull git pullæ‹‰å–è¿œç¨‹ä¸»æœºæŸåˆ†æ”¯çš„æ›´æ–°ï¼Œå†ä¸æœ¬åœ°çš„æŒ‡å®šåˆ†æ”¯åˆå¹¶ï¼ˆç›¸å½“ä¸ fetch åŠ ä¸Šäº†åˆå¹¶åˆ†æ”¯åŠŸèƒ½çš„æ“ä½œï¼‰ git pushå°†æœ¬åœ°åˆ†æ”¯çš„æ›´æ–°ï¼Œæ¨é€åˆ°è¿œç¨‹ä¸»æœºï¼Œå…¶å‘½ä»¤æ ¼å¼ä¸ git pull ç›¸ä¼¼git push -f å¼ºåˆ¶æ¨é€( å¦‚æœæœ¬åœ°commitå’Œè¿œç¨‹commitæœ‰å†²çªæ—¶ï¼Œè¦†ç›–è¿œç¨‹commit ) åˆ†æ”¯æ“ä½œ ä½¿ç”¨ Git ä¸‹è½½æŒ‡å®šåˆ†æ”¯å‘½ä»¤ä¸ºï¼šgit clone -b åˆ†æ”¯åä»“åº“åœ°å€ æ‹‰å–è¿œç¨‹æ–°åˆ†æ”¯ git checkout -b serverfix origin/serverfix åˆå¹¶æœ¬åœ°åˆ†æ”¯ git merge hotfixï¼š(å°† hotfix åˆ†æ”¯åˆå¹¶åˆ°å½“å‰åˆ†æ”¯) åˆå¹¶è¿œç¨‹åˆ†æ”¯ git merge origin/serverfix åˆ é™¤æœ¬åœ°åˆ†æ”¯ git branch -d hotfixï¼š(åˆ é™¤æœ¬åœ° hotfix åˆ†æ”¯) åˆ é™¤è¿œç¨‹åˆ†æ”¯ git push origin --delete serverfix or git branch -D master; //åˆ é™¤æœ¬åœ°masteråˆ†æ”¯git push origin :master; //åˆ é™¤è¿œç¨‹masteråˆ†æ”¯git pull origin master:master // è¿œç¨‹:æœ¬åœ°git push origin master:master // æœ¬åœ°:è¿œç¨‹git push --set-upstream origin master // å°†æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åŒååˆ†æ”¯ç›¸å…³è” ä¸Šä¼ æ–°å‘½åçš„æœ¬åœ°åˆ†æ”¯ï¼šgit push origin newName; åˆ›å»ºæ–°åˆ†æ”¯ï¼šgit branch branchNameï¼š(åˆ›å»ºåä¸º branchName çš„æœ¬åœ°åˆ†æ”¯) åˆ‡æ¢åˆ°æ–°åˆ†æ”¯ï¼šgit checkout branchNameï¼š(åˆ‡æ¢åˆ° branchName åˆ†æ”¯) åˆ›å»ºå¹¶åˆ‡æ¢åˆ†æ”¯ï¼šgit checkout -b branchNameï¼š(ç›¸å½“äºä»¥ä¸Šä¸¤æ¡å‘½ä»¤çš„åˆå¹¶) æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯ï¼šgit branch æŸ¥çœ‹è¿œç¨‹ä»“åº“æ‰€æœ‰åˆ†æ”¯ï¼šgit branch -a æœ¬åœ°åˆ†æ”¯é‡å‘½åï¼š git branch -m oldName newName é‡å‘½åè¿œç¨‹åˆ†æ”¯å¯¹åº”çš„æœ¬åœ°åˆ†æ”¯ï¼šgit branch -m oldName newName æŠŠä¿®æ”¹åçš„æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯å…³è”ï¼šgit branch --set-upstream-to origin/newName git åˆ†æ”¯æäº¤ã€åˆå¹¶å¸¸è§é—®é¢˜ä¸»åˆ†æ”¯é¢†å…ˆå½“å‰åˆ†æ”¯å½“å‰åˆ†æ”¯å·²ç»æäº¤ commitgit checkout mastergit pullgit checkout localgit rebase master rebase ä¼šè‡ªåŠ¨åˆå¹¶é¢†å…ˆçš„ commit æœªæäº¤ commitä¸ç”¨åˆ‡æ¢åˆ†æ”¯ï¼Œå³å¯åŒæ­¥ä¸»åˆ†æ”¯æœ€æ–°ä»£ç  git pull origin master# æœ‰å†²çªè§£å†³å†²çªgit commit git å›é€€git resetåˆ é™¤æŒ‡å®šçš„ commit # ä¿®æ”¹ç‰ˆæœ¬åº“ï¼Œä¿ç•™æš‚å­˜åŒºï¼Œä¿ç•™å·¥ä½œåŒº# å°†ç‰ˆæœ¬åº“è½¯å›é€€1ä¸ªç‰ˆæœ¬ï¼Œè½¯å›é€€è¡¨ç¤ºå°†æœ¬åœ°ç‰ˆæœ¬åº“çš„å¤´æŒ‡é’ˆå…¨éƒ¨é‡ç½®åˆ°æŒ‡å®šç‰ˆæœ¬ï¼Œä¸”å°†è¿™æ¬¡æäº¤ä¹‹åçš„æ‰€æœ‰å˜æ›´éƒ½ç§»åŠ¨åˆ°æš‚å­˜åŒºã€‚git reset --soft HEAD~1# ä¿®æ”¹ç‰ˆæœ¬åº“ï¼Œä¿®æ”¹æš‚å­˜åŒºï¼Œä¿®æ”¹å·¥ä½œåŒº# å°†ç‰ˆæœ¬åº“å›é€€1ä¸ªç‰ˆæœ¬ï¼Œä¸ä»…ä»…æ˜¯å°†æœ¬åœ°ç‰ˆæœ¬åº“çš„å¤´æŒ‡é’ˆå…¨éƒ¨é‡ç½®åˆ°æŒ‡å®šç‰ˆæœ¬ï¼Œä¹Ÿä¼šé‡ç½®æš‚å­˜åŒºï¼Œå¹¶ä¸”ä¼šå°†å·¥ä½œåŒºä»£ç ä¹Ÿå›é€€åˆ°è¿™ä¸ªç‰ˆæœ¬git reset --hard HEAD~1# gitç‰ˆæœ¬å›é€€ï¼Œå›é€€åˆ°ç‰¹å®šçš„commit_idç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡git logæŸ¥çœ‹æäº¤å†å²ï¼Œä»¥ä¾¿ç¡®å®šè¦å›é€€åˆ°å“ªä¸ªç‰ˆæœ¬(commit ä¹‹åçš„å³ä¸ºID);git reset --hard commit_id git revertæ’¤é”€ æŸæ¬¡æ“ä½œï¼Œæ­¤æ¬¡æ“ä½œä¹‹å‰å’Œä¹‹åçš„ commit å’Œ history éƒ½ä¼šä¿ç•™ï¼Œå¹¶ä¸”æŠŠè¿™æ¬¡æ’¤é”€ ä½œä¸ºä¸€æ¬¡æœ€æ–°çš„æäº¤ # æ’¤é”€å‰ä¸€æ¬¡ commitgit revert HEAD# æ’¤é”€å‰å‰ä¸€æ¬¡ commitgit revert HEAD^# (æ¯”å¦‚ï¼šfa042ce57ebbe5bb9c8db709f719cec2c58ee7ffï¼‰æ’¤é”€æŒ‡å®šçš„ç‰ˆæœ¬ï¼Œæ’¤é”€ä¹Ÿä¼šä½œä¸ºä¸€æ¬¡æäº¤è¿›è¡Œä¿å­˜ã€‚git revert commit git revert æ˜¯æäº¤ä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œå°†éœ€è¦ revert çš„ç‰ˆæœ¬çš„å†…å®¹å†åå‘ä¿®æ”¹å›å»ï¼Œç‰ˆæœ¬ä¼šé€’å¢ï¼Œä¸å½±å“ä¹‹å‰æäº¤çš„å†…å®¹ git revert å’Œ git reset çš„åŒºåˆ« git revertæ˜¯ç”¨ä¸€æ¬¡æ–°çš„ commit æ¥å›æ»šä¹‹å‰çš„ commitï¼Œgit resetæ˜¯ç›´æ¥åˆ é™¤æŒ‡å®šçš„ commitã€‚ åœ¨å›æ»šè¿™ä¸€æ“ä½œä¸Šçœ‹ï¼Œæ•ˆæœå·®ä¸å¤šã€‚ä½†æ˜¯åœ¨æ—¥åç»§ç»­ merge ä»¥å‰çš„è€ç‰ˆæœ¬æ—¶æœ‰åŒºåˆ«ã€‚å› ä¸ºgit revertæ˜¯ç”¨ä¸€æ¬¡é€†å‘çš„ commitâ€œä¸­å’Œâ€ä¹‹å‰çš„æäº¤ï¼Œå› æ­¤æ—¥ååˆå¹¶è€çš„ branch æ—¶ï¼Œå¯¼è‡´è¿™éƒ¨åˆ†æ”¹å˜ä¸ä¼šå†æ¬¡å‡ºç°ï¼Œä½†æ˜¯git resetæ˜¯ä¹‹é—´æŠŠæŸäº› commit åœ¨æŸä¸ª branch ä¸Šåˆ é™¤ï¼Œå› è€Œå’Œè€çš„ branch å†æ¬¡ merge æ—¶ï¼Œè¿™äº›è¢«å›æ»šçš„ commit åº”è¯¥è¿˜ä¼šè¢«å¼•å…¥ã€‚ git reset æ˜¯æŠŠ HEAD å‘åç§»åŠ¨äº†ä¸€ä¸‹ï¼Œè€Œgit revertæ˜¯ HEAD ç»§ç»­å‰è¿›ï¼Œåªæ˜¯æ–°çš„ commit çš„å†…å®¹å’Œè¦ revert çš„å†…å®¹æ­£å¥½ç›¸åï¼Œèƒ½å¤ŸæŠµæ¶ˆè¦è¢« revert çš„å†…å®¹ã€‚ git commit ç›¸å…³git commit æäº¤å¤šè¡Œ commit ä¿¡æ¯git commit -v git ä¿®æ”¹ commit ä¿¡æ¯1. æäº¤ä¿¡æ¯å‡ºé”™æ›´æ”¹ commit ä¿¡æ¯ git commit --amend -m â€œæ–°æäº¤æ¶ˆæ¯â€ 2. æ¼æäº¤commit æ—¶ï¼Œé—æ¼æäº¤éƒ¨åˆ†æ›´æ–°ï¼Œæœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š æ–¹æ¡ˆä¸€ï¼šå†æ¬¡ commit git commit -m #æäº¤æ¶ˆæ¯ æ­¤æ—¶ï¼Œgit ä¸Šä¼šå‡ºç°ä¸¤æ¬¡ commit æ–¹æ¡ˆäºŒï¼šé—æ¼æ–‡ä»¶æäº¤åˆ°ä¹‹å‰ commit ä¸Š git add missed-file # missed-file ä¸ºé—æ¼æäº¤æ–‡ä»¶git commit --amend --no-edit --no-edit è¡¨ç¤ºæäº¤æ¶ˆæ¯ä¸ä¼šæ›´æ”¹ï¼Œåœ¨ git ä¸Šä»…ä¸ºä¸€æ¬¡æäº¤ ä¿®æ”¹å†å²çš„ commitgit rebase -i HEAD~3è¡¨ç¤ºè¦ä¿®æ”¹å½“å‰ç‰ˆæœ¬çš„å€’æ•°ç¬¬ä¸‰æ¬¡çŠ¶æ€.è¿™ä¸ªå‘½ä»¤å‡ºæ¥ä¹‹åï¼Œä¼šå‡ºæ¥ä¸‰è¡Œä¸œä¸œï¼š pick:*******pick:*******pick:******* å¦‚æœä½ è¦ä¿®æ”¹å“ªä¸ªï¼Œå°±æŠŠé‚£è¡Œçš„ pick æ”¹æˆ editï¼Œç„¶åä¿å­˜é€€å‡º(ç‚¹å‡» escï¼Œè¾“å…¥ ZZ é€€å‡º)è¿™æ—¶é€šè¿‡git logä½ å¯ä»¥å‘ç°ï¼Œgit çš„æœ€åä¸€æ¬¡æäº¤å·²ç»å˜æˆä½ é€‰çš„é‚£ä¸ªäº†ï¼Œè¿™æ—¶å†ä½¿ç”¨ï¼šgit commit --amend æ¥å¯¹ commit è¿›è¡Œä¿®æ”¹ã€‚ä¿®æ”¹å®Œæˆåä½¿ç”¨git rebase --continueç„¶åå°†å˜åŒ– push åˆ°è¿œç¨‹ï¼šgit push origin HEAD:master --force git åˆå¹¶å¤šä¸ª commitè¿‡å»æ€»æ˜¯ä½¿ç”¨ git reset --soft å›é€€åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œå† commit å push orgin master -f å¼ºæ¨åˆ°è¿œç¨‹åº“ï¼Œèƒ½å¤Ÿè¦†ç›–æ‰ä¹‹å‰çš„ commit ã€‚ ä½†åœ¨å›¢é˜Ÿåä½œæ—¶ï¼Œæ¯æ¬¡ commit å‰è¿˜éœ€è¦ rebase upstreamï¼Œè¿™ä¼šè‡ªåŠ¨å°†ä¸€äº›å…¶ä»–äººåšçš„ä¿®æ”¹ä¹Ÿè‡ªåŠ¨ merge åˆ°æœ¬åœ°çš„æºç ä¸­ã€‚å¦‚æœæ­¤æ—¶å¸Œæœ›è¦†ç›–å‰ä¸€æ¬¡ commit ï¼Œreset åˆ°ä¹‹å‰çš„çŠ¶æ€åï¼Œå†æ¬¡ commit çš„å†…å®¹å°±åŒ…å«äº†å…¶ä»–äººçš„ä¿®æ”¹ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ git rebase -i ã€‚ åŸºæœ¬æ­¥éª¤ git log æŸ¥çœ‹æ‰€æœ‰ commit çš„æƒ…å†µï¼Œæ‰¾åˆ°è‡ªå·±æƒ³è¦åˆå¹¶çš„ commit ä¹‹å‰çš„é‚£ä¸ª commit çš„ ssh ç (å‰ 7 ä½)ï¼› git rebase -i 43jk2l3ï¼Œè¿™æ ·ä¼šå¼¹å‡ºä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨ï¼›æ’¤é”€ commitgit reset â€“softHEAD^ ä¸Šä¸ª commit^^ä¸Šä¸Šä¸ª commitHEAD~2 æœ€è¿‘ 2 æ¬¡çš„æäº¤ ä¿®æ”¹ pick ä¸º squash ä¼šå°†è¿™ä¸ª commit åˆå¹¶åˆ°å‰ä¸€ä¸ª commit ä¸­ï¼Œä¿å­˜é€€å‡ºï¼› æç¤ºå†™ä¸‹æ–°çš„ commit messageï¼Œä¹‹å‰çš„ message å¯ä»¥ç”¨#æ³¨é‡Šæ‰ï¼Œä¿å­˜é€€å‡ºï¼› æ­¤æ—¶å† git log å°±ä¼šå‘ç°ï¼Œä¸¤ä¸ª commit è¢«åˆå¹¶åˆ°ä¸€ä¸ª commit ä¸­ã€‚ ä¿®æ”¹ push åˆ°è¿œç¨‹çš„ commit git log git rebase -i Head~8 pick ä¿®æ”¹ä¸º edit git commit â€“amend ä¿®æ”¹æ–°çš„ commit message ä¿å­˜ (ä¿®æ”¹ä½œè€…ä¿¡æ¯ â€“author â€œluckyship &#x78;&#x78;&#x78;&#x40;&#x78;&#120;&#x78;&#x2e;&#x63;&#x6f;&#x6d;â€œ) git rebase â€“continue // å¤„ç†å®Œåˆå¹¶å ç„¶å git push -f åŒç† git merge â€“continue git push -f Commit message å‰ç¼€è§„èŒƒæè¦ code info feat:msg æ–°åŠŸèƒ½ feature fix:msg ä¿®å¤ bug merge:msg merge ä¿¡æ¯ docs:msg æ–‡æ¡£ä¿®æ”¹ style:msg æ ¼å¼ï¼Œä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨ refactor: msg é‡æ„å³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹ bug çš„ä»£ç å˜åŠ¨ test:msg å¢åŠ æµ‹è¯• chore:msg æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨ rm:msg åˆ é™¤æ–‡ä»¶æˆ–ä»£ç  git stash(æš‚å­˜åŒº)æš‚å­˜git stash å¯ç”¨æ¥æš‚å­˜å½“å‰æ­£åœ¨è¿›è¡Œçš„å·¥ä½œï¼Œæ¯”å¦‚æƒ³ pull æœ€æ–°ä»£ç åˆä¸æƒ³ commit ï¼Œ æˆ–è€…å¦ä¸ºäº†ä¿®æ”¹ä¸€ä¸ªç´§æ€¥çš„ bug ï¼Œå…ˆ stashï¼Œä½¿è¿”å›åˆ°è‡ªå·±ä¸Šä¸€ä¸ª commit, ï¼Œæ”¹å®Œ bug ä¹‹åå† stash pop , ç»§ç»­åŸæ¥çš„å·¥ä½œï¼› æ·»åŠ ç¼“å­˜æ ˆï¼š git stash ; æŸ¥çœ‹ç¼“å­˜æ ˆï¼š git stash list ; æ¨å‡ºç¼“å­˜æ ˆï¼š git stash pop ; å–å‡ºç‰¹å®šç¼“å­˜å†…å®¹ï¼š git stash apply stash@&#123;1&#125; ; æ¢å¤è¯¯åˆ é™¤çš„ stash# æ˜¾ç¤ºæ‰€æœ‰ä¸å¯è®¿é—®å¯¹è±¡git fask --unreachablegit show 302063e31742cbce7c5fdb917edf520183154cc1 &gt; D:\\recovery\\backup.txt åœ¨ä½¿ç”¨ git fsck â€“unreachable å‘½ä»¤è¾“å‡ºçš„å¾ˆå¤šæ–‡ä»¶é‡Œé¢ï¼Œæœ‰å¾ˆå¤šæ˜¯å¸¦æœ‰ commit å’Œ tree çš„æ ‡è¯†çš„ï¼Œè¿™äº›å¯ä»¥ä½¿ç”¨ git stash apply åŠ æ ‡è®°å·è¿›è¡Œæ‰¾å›ã€‚è€Œ blob çš„æ–‡ä»¶æ˜¯åªèƒ½æ‰‹åŠ¨æ‹·è´çš„ï¼Œæˆ–è€…åƒä¸Šé¢ä¸€æ ·ä½¿ç”¨&gt; è¾“å‡ºåˆ°æŒ‡å®šçš„è·¯å¾„å» rebase å’Œ mege çš„åŒºåˆ«1. æ‹‰å–ä»£ç  pull â€“rebaseåœ¨å›¢é˜Ÿåä½œè¿‡ç¨‹ä¸­ï¼Œå‡è®¾ä½ å’Œä½ çš„åŒä¼´åœ¨æœ¬åœ°ä¸­åˆ†åˆ«æœ‰å„è‡ªçš„æ–°æäº¤ï¼Œè€Œä½ çš„åŒä¼´å…ˆäºä½  push äº†ä»£ç åˆ°è¿œç¨‹åˆ†æ”¯ä¸Šï¼Œæ‰€ä»¥ä½ å¿…é¡»å…ˆæ‰§è¡Œ git pull æ¥è·å–åŒä¼´çš„æäº¤ï¼Œç„¶åæ‰èƒ½ push è‡ªå·±çš„æäº¤åˆ°è¿œç¨‹åˆ†æ”¯ã€‚ è€ŒæŒ‰ç…§ Git çš„é»˜è®¤ç­–ç•¥ï¼Œå¦‚æœè¿œç¨‹åˆ†æ”¯å’Œæœ¬åœ°åˆ†æ”¯ä¹‹é—´çš„æäº¤çº¿å›¾æœ‰åˆ†å‰çš„è¯ï¼ˆå³ä¸æ˜¯ fast-forwardedï¼‰ï¼ŒGit ä¼šæ‰§è¡Œä¸€æ¬¡ merge æ“ä½œï¼Œå› æ­¤äº§ç”Ÿä¸€æ¬¡æ²¡æ„ä¹‰çš„æäº¤è®°å½•ï¼Œä»è€Œé€ æˆäº†åƒä¸Šå›¾é‚£æ ·çš„æ··ä¹±ã€‚ å…¶å®åœ¨ pull æ“ä½œçš„æ—¶å€™ï¼Œï¼Œä½¿ç”¨ git pull --rebase é€‰é¡¹å³å¯å¾ˆå¥½åœ°è§£å†³ä¸Šè¿°é—®é¢˜ã€‚ åŠ ä¸Š --rebase å‚æ•°çš„ä½œç”¨æ˜¯ï¼Œæäº¤çº¿å›¾æœ‰åˆ†å‰çš„è¯ï¼ŒGit ä¼š rebase ç­–ç•¥æ¥ä»£æ›¿é»˜è®¤çš„ merge ç­–ç•¥ã€‚ å‡è®¾æäº¤çº¿å›¾åœ¨æ‰§è¡Œ pull å‰æ˜¯è¿™æ ·çš„ï¼š A---B---C remotes/origin/master /D---E---F---G master å¦‚æœæ˜¯æ‰§è¡Œ git pull åï¼Œæäº¤çº¿å›¾ä¼šå˜æˆè¿™æ ·ï¼š A---B---C remotes/origin/master / \\D---E---F---G---H master ç»“æœå¤šå‡ºäº† H è¿™ä¸ªæ²¡å¿…è¦çš„æäº¤è®°å½•ã€‚å¦‚æœæ˜¯æ‰§è¡Œ git pull --rebase çš„è¯ï¼Œæäº¤çº¿å›¾å°±ä¼šå˜æˆè¿™æ ·ï¼š remotes/origin/master |D---E---A---B---C---F&#x27;---G&#x27; master F G ä¸¤ä¸ªæäº¤é€šè¿‡ rebase æ–¹å¼é‡æ–°æ‹¼æ¥åœ¨ C ä¹‹åï¼Œå¤šä½™çš„åˆ†å‰å»æ‰äº†ï¼Œç›®çš„è¾¾åˆ°ã€‚ å°ç»“å¤§å¤šæ•°æ—¶å€™ï¼Œä½¿ç”¨ git pull --rebase æ˜¯ä¸ºäº†ä½¿æäº¤çº¿å›¾æ›´å¥½çœ‹ï¼Œä»è€Œæ–¹ä¾¿ code reviewã€‚ ä¸è¿‡ï¼Œå¦‚æœä½ å¯¹ä½¿ç”¨ git è¿˜ä¸æ˜¯ååˆ†ç†Ÿç»ƒçš„è¯ï¼Œæˆ‘çš„å»ºè®®æ˜¯ git pull --rebase å¤šç»ƒä¹ å‡ æ¬¡ä¹‹åå†ä½¿ç”¨ï¼Œå› ä¸º rebase åœ¨ git ä¸­ï¼Œç®—å¾—ä¸Šæ˜¯ã€å±é™©è¡Œä¸ºã€ã€‚ å¦å¤–ï¼Œè¿˜éœ€æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ git pull --rebase æ¯”ç›´æ¥ pull å®¹æ˜“å¯¼è‡´å†²çªçš„äº§ç”Ÿï¼Œå¦‚æœé¢„æœŸå†²çªæ¯”è¾ƒå¤šçš„è¯ï¼Œå»ºè®®è¿˜æ˜¯ç›´æ¥ pullã€‚ æ³¨æ„ï¼šgit pull = git fetch + git mergegit pull â€“rebase = git fetch + git rebase 2. åˆä»£ç  merge â€“no-ffä¸Šè¿°çš„ git pull --rebase ç­–ç•¥ç›®çš„æ˜¯ä¿®æ•´æäº¤çº¿å›¾ï¼Œä½¿å…¶å½¢æˆä¸€æ¡ç›´çº¿ï¼Œè€Œå³å°†è¦ç”¨åˆ°çš„ git merge --no-ff &lt;branch-name&gt; ç­–ç•¥ååæ˜¯åè¡Œå…¶é“ï¼Œåˆ»æ„åœ°å¼„å‡ºæäº¤çº¿å›¾åˆ†å‰å‡ºæ¥ã€‚ å‡è®¾ä½ åœ¨æœ¬åœ°å‡†å¤‡åˆå¹¶ä¸¤ä¸ªåˆ†æ”¯ï¼Œè€Œåˆšå¥½è¿™ä¸¤ä¸ªåˆ†æ”¯æ˜¯ fast-forwarded çš„ï¼Œé‚£ä¹ˆç›´æ¥åˆå¹¶åä½ å¾—åˆ°ä¸€ä¸ªç›´çº¿çš„æäº¤çº¿å›¾ï¼Œå½“ç„¶è¿™æ ·æ²¡ä»€ä¹ˆåå¤„ï¼Œä½†å¦‚æœä½ æƒ³æ›´æ¸…æ™°åœ°å‘Šè¯‰ä½ åŒä¼´ï¼šè¿™ä¸€ç³»åˆ—çš„æäº¤éƒ½æ˜¯ä¸ºäº†å®ç°åŒä¸€ä¸ªç›®çš„ï¼Œé‚£ä¹ˆä½ å¯ä»¥åˆ»æ„åœ°å°†è¿™æ¬¡æäº¤å†…å®¹å¼„æˆä¸€æ¬¡æäº¤çº¿å›¾åˆ†å‰ã€‚ æ‰§è¡Œ git merge --no-ff &lt;branch-name&gt; çš„ç»“æœå¤§æ¦‚ä¼šæ˜¯è¿™æ ·çš„ï¼š |0 asdasd|0 asdasd|\\| 0 asdasd| || 0 asdasd| || 0 asdasd| || 0 asdasd| /0 asdasd|0 asdasd ä¸­é—´çš„åˆ†å‰çº¿è·¯å›¾å¾ˆæ¸…æ™°çš„æ˜¾ç¤ºè¿™äº›æäº¤éƒ½æ˜¯ä¸ºäº†å®ç° complete adjusting user domains and tags æ›´è¿›ä¸€æ­¥å¾€å¾€æˆ‘çš„ä¹ æƒ¯æ˜¯ï¼Œåœ¨åˆå¹¶åˆ†æ”¯ä¹‹å‰ï¼ˆå‡è®¾è¦åœ¨æœ¬åœ°å°† feature åˆ†æ”¯åˆå¹¶åˆ° dev åˆ†æ”¯ï¼‰ï¼Œä¼šå…ˆæ£€æŸ¥ feature åˆ†æ”¯æ˜¯å¦ã€éƒ¨åˆ†è½åã€äºè¿œç¨‹ dev åˆ†æ”¯ï¼š git checkout devgit pull # æ›´æ–° dev åˆ†æ”¯git log feature..dev å¦‚æœæ²¡æœ‰è¾“å‡ºä»»ä½•æäº¤ä¿¡æ¯çš„è¯ï¼Œå³è¡¨ç¤º feature å¯¹äº dev åˆ†æ”¯æ˜¯ up-to-date çš„ã€‚å¦‚æœæœ‰è¾“å‡ºçš„è¯è€Œé©¬ä¸Šæ‰§è¡Œäº† git merge --no-ff çš„è¯ï¼Œæäº¤çº¿å›¾ä¼šå˜æˆè¿™æ ·ï¼š |0 asdasd|0 asdasd|\\| 0 asdasd| || 0 asdasd| |0 | asdasd| |0 | asdasd| /0 asdasd|0 asdasd æ‰€ä»¥è¿™æ—¶åœ¨åˆå¹¶å‰ï¼Œé€šå¸¸æˆ‘ä¼šå…ˆæ‰§è¡Œï¼š git checkout featuregit rebase dev è¿™æ ·å°±å¯ä»¥å°† feature é‡æ–°æ‹¼æ¥åˆ°æ›´æ–°äº†çš„ dev ä¹‹åï¼Œç„¶åå°±å¯ä»¥åˆå¹¶äº†ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªå¹²å‡€èˆ’æœçš„æäº¤çº¿å›¾ã€‚ å†æ¬¡æé†’ï¼šåƒä¹‹å‰æåˆ°çš„ï¼Œrebase æ˜¯ã€å±é™©è¡Œä¸ºã€ï¼Œå»ºè®®ä½ è¶³å¤Ÿç†Ÿæ‚‰ git æ—¶æ‰è¿™ä¹ˆåšï¼Œå¦åˆ™çš„è¯æ˜¯å¾—ä¸å¿å¤±çš„ã€‚ æ€»ç»“ä½¿ç”¨ git pull --rebase å’Œ git merge --no-ff å…¶å®å’Œç›´æ¥ä½¿ç”¨ git pull git merge å¾—åˆ°çš„ä»£ç åº”è¯¥æ˜¯ä¸€æ ·ã€‚ ä½¿ç”¨ git pull --rebase ä¸»è¦æ˜¯ä¸ºæ˜¯å°†æäº¤çš„çº¿å›¾å¹³å¦åŒ–ï¼Œè€Œ git merge --no-ff åˆ™æ˜¯åˆ»æ„åˆ¶é€ åˆ†å‰ã€‚ git rebase å’Œ git merge ä¸»è¦çš„åŒºåˆ«åœ¨äºæ˜¯å¦ä¿ç•™åˆ†æ”¯çš„ commit æäº¤èŠ‚ç‚¹ï¼Œrebase ä¼šç»™ä½ ä¸€ä¸ªç®€æ´çš„çº¿æ€§å†å²æ ‘ã€‚rebase é€‚åˆå°åˆ†æ”¯ï¼Œå¤§åˆ†æ”¯è¿˜æ˜¯ä½¿ç”¨ merge â€“squashã€‚ git patchgit patch ä¼šç”Ÿæˆä¸€ä¸ªè¡¥ä¸æ–‡ä»¶ï¼Œè¿™æ ·åœ¨ä¸èƒ½ç›´æ¥ git pull å’Œ git push çš„æƒ…å†µä¸‹ï¼Œç›´æ¥æŠŠè¡¥ä¸æ–‡ä»¶åˆå…¥ git é¡¹ç›®ä¸­ # 1ä¸ºæœ€æ–°commitå¾€å‰çš„commitçš„æ•°é‡$ git format-patch -1$ git am xxx.patch git cherry-pickç°ç½‘å‘ç°äº† bugï¼Œç°ç½‘åˆ†æ”¯éœ€è¦ä¿®æ”¹ä»£ç å‡ºè¡¥ä¸ç‰ˆæœ¬ï¼›åŒæ—¶ï¼Œä»£ç ä¹Ÿè¦åˆå…¥ä¸»å¹²ï¼Œä¿è¯ä¸»å¹²ç‰ˆæœ¬æ²¡é—®é¢˜ã€‚ç®€è¨€ä¹‹ï¼Œç›¸åŒçš„ä»£ç ï¼Œè¦åˆå…¥ä¸¤ä¸ªåˆ†æ”¯ï¼Œæ€ä¹ˆåŠ $ git branch* dev master$ git cherry-pick 4c805e2 åŒæ­¥ Github fork å‡ºæ¥çš„åˆ†æ”¯1ã€é…ç½® remoteï¼ŒæŒ‡å‘åŸå§‹ä»“åº“git remote add upstream https://github.com/luckyship/jelly.git 2ã€è·å–ä¸Šæ¸¸åˆ†æ”¯ä¸Šæ¸¸ä»“åº“è·å–åˆ°åˆ†æ”¯ï¼ŒåŠç›¸å…³çš„æäº¤ä¿¡æ¯ï¼Œå®ƒä»¬å°†è¢«ä¿å­˜åœ¨æœ¬åœ°çš„ upstream/master åˆ†æ”¯ git fetch upstream# remote: Counting objects: 75, done.# remote: Compressing objects: 100% (53/53), done.# remote: Total 62 (delta 27), reused 44 (delta 9)# Unpacking objects: 100% (62/62), done.# From https://github.com/ORIGINAL_OWNER/ORIGINAL_REPOSITORY# * [new branch] master -upstream/master 3ã€åˆ‡æ¢åˆ°æœ¬åœ°çš„ master åˆ†æ”¯git checkout master# Switched to branch &#x27;master&#x27; 4ã€åˆå¹¶åˆ†æ”¯æŠŠ upstream/master åˆ†æ”¯åˆå¹¶åˆ°æœ¬åœ°çš„ master åˆ†æ”¯ï¼Œæœ¬åœ°çš„ master åˆ†æ”¯ä¾¿è·Ÿä¸Šæ¸¸ä»“åº“ä¿æŒåŒæ­¥äº†ï¼Œå¹¶ä¸”æ²¡æœ‰ä¸¢å¤±æœ¬åœ°çš„ä¿®æ”¹ã€‚ git merge upstream/master# Updating a422352..5fdff0f# Fast-forward# README | 9 -------# README.md | 7 ++++++# 2 files changed, 7 insertions(+), 9 deletions(-)# delete mode 100644 README# create mode 100644 README.md 5ã€ä¸Šä¼ åˆ°è‡ªå·±çš„è¿œç¨‹ä»“åº“ä¸­git push git é…ç½®é‚®ç®±å’Œç”¨æˆ·åæŸ¥çœ‹git config user.namegit config user.email ä¿®æ”¹git config --global user.name &quot;username&quot;git config --global user.email &quot;email&quot; SSH æŸ¥çœ‹æ˜¯å¦ç”Ÿæˆäº† SSH å…¬é’¥ $ cd ~/.ssh$ lsid_rsa id_rsa.pub known_hosts å…¶ä¸­ id_rsa æ˜¯ç§é’¥ï¼Œid_rsa.pub æ˜¯å…¬é’¥ã€‚ å¦‚æœæ²¡æœ‰é‚£å°±å¼€å§‹ç”Ÿæˆï¼Œè®¾ç½®å…¨å±€çš„ user.name ä¸ user.email git config --list # æŸ¥çœ‹æ˜¯å¦è®¾ç½®äº†user.nameä¸user.emailï¼Œæ²¡æœ‰çš„è¯ï¼Œå»è®¾ç½®# è®¾ç½®å…¨å±€çš„user.nameä¸user.emailgit config --global user.name &quot;XX&quot;git config --global user.email &quot;XX&quot; è¾“å…¥ ssh-keygen å³å¯ï¼ˆæˆ–ssh-keygen -t rsa -C &quot;email&quot;ï¼‰ $ ssh-keygenGenerating public/private rsa key pair.Enter file in which to save the key (/Users/schacon/.ssh/id_rsa):Enter passphrase (empty for no passphrase):Enter same passphrase again:Your identification has been saved in /Users/schacon/.ssh/id_rsa.Your public key has been saved in /Users/schacon/.ssh/id_rsa.pub.The key fingerprint is: ç”Ÿæˆä¹‹åè·å–å…¬é’¥å†…å®¹ï¼Œè¾“å…¥ cat ~/.ssh/id_rsa.pub å³å¯ï¼Œ å¤åˆ¶ ssh-rsa ä¸€ç›´åˆ° .local è¿™ä¸€æ•´æ®µå†…å®¹ $ cat ~/.ssh/id_rsa.pubssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAklOUpkDHrfHY17SbrmTIpNLTGK9Tjom/BWDSUGPl+nafzlHDTYW7hdI4yZ5ew18JH4JW9jbhUFrviQzM7xlELEVf4h9lFX5QVkbPppSwg0cda3Pbv7kOdJ/MTyBlWXFCR+HAo3FXRitBqxiX1nKhXpHAZsMciLq8V6RjsNAQwdsdMFvSlVK/7XAt3FaoJoAsncM1Q9x5+3V0Ww68/eIFmb1zuUFljQJKprrX88XypNDvjYNby6vw/Pb0rwert/EnmZ+AW4OZPnTPI89ZPmVMLuayrD2cE86Z/il8b+gw3r3+1nKatmIkjn2so1d01QraTlMqVSsbxNrRFi9wrf+M7Q== schacon@agadorlaptop.local æ‰“å¼€ GitLab æˆ–è€… GitHubï¼Œç‚¹å‡»å¤´åƒï¼Œæ‰¾åˆ°è®¾ç½®é¡µ å·¦ä¾§æ‰¾åˆ° SSH keys æŒ‰é’®å¹¶ç‚¹å‡»ï¼Œè¾“å…¥åˆšåˆšå¤åˆ¶çš„å…¬é’¥å³å¯ git push æŠ¥ HTTP Basic: Access denied é”™è¯¯ æ°¸ä¹…è®°ä½å¯†ç git config --global credential.helper store å¦‚æœæ²¡ --global ï¼Œåˆ™åœ¨å½“å‰é¡¹ç›®ä¸‹çš„.git/config æ–‡ä»¶ä¸­æ·»åŠ ã€‚ é»˜è®¤è®°ä½ 15 åˆ†é’Ÿ git config â€“global credential.helper cache è‡ªå®šä¹‰é…ç½®è®°ä½ 1 å°æ—¶ï¼š git config â€“global credential.helper â€˜cache â€“timeout=3600â€™ è§£å†³æ–¹æ¡ˆï¼š å¦‚æœè´¦å·å¯†ç æœ‰å˜åŠ¨ ç”¨è¿™ä¸ªå‘½ä»¤ git config --system --unset credential.helper (æ¸…é™¤ç”¨æˆ·åå¯†ç )é‡æ–°è¾“å…¥è´¦å·å¯†ç åº”è¯¥å°±èƒ½è§£å†³äº† å¦‚æœç”¨äº†ç¬¬ä¸€ä¸ªå‘½ä»¤ è¿˜ä¸èƒ½è§£å†³é—®é¢˜é‚£ä¹ˆ ç”¨è¿™ä¸ªå‘½ä»¤ï¼šgit config â€“global http.emptyAuth true æ–‡ä»¶åè¿‡é•¿é”™è¯¯Filename too long warning: Clone succeeded, but checkout failed. git config --system core.longpaths true .gitignore æ›´æ–°åç”Ÿæ•ˆï¼šgit rm -r --cached .git add .git commit -m .gitignore is now working git commit -v ä½¿ç”¨ vim$ cat ~/.gitconfig[user] email = chaox.a.xu@intel.com name = Xu Chao[core] editor = vim -U none # git commit -sv å¯ä»¥ç”¨vim git ç»Ÿè®¡æŸ¥çœ‹ git ä¸Šä¸ªäººä»£ç é‡git log --author=&quot;username&quot; --pretty=tformat: --numstat | awk &#x27;&#123; add += $1; subs += $2; loc += $1 - $2 &#125; END &#123; printf &quot;added lines: %s, removed lines: %s, total lines: %s\\n&quot;, add, subs, loc &#125;&#x27; - ç»Ÿè®¡æ¯ä¸ªäººçš„å¢åˆ è¡Œæ•°git log --format=&#x27;%aN&#x27; | sort -u | while read name; do echo -en &quot;$name\\t&quot;; git log --author=&quot;$name&quot; --pretty=tformat: --numstat | awk &#x27;&#123; add += $1; subs += $2; loc += $1 - $2 &#125; END &#123; printf &quot;added lines: %s, removed lines: %s, total lines: %s\\n&quot;, add, subs, loc &#125;&#x27; -; done æŸ¥çœ‹ä»“åº“æäº¤è€…æ’åå‰ 5git log --pretty=&#x27;%aN&#x27; | sort | uniq -c | sort -k1 -n -r | head -n 5 è´¡çŒ®è€…ç»Ÿè®¡git log --pretty=&#x27;%aN&#x27; | sort -u | wc -l æäº¤æ•°ç»Ÿè®¡git log --oneline | wc -l å‚è€ƒæœ¬æ–‡å‚è€ƒäº†git ç›¸å…³é—®é¢˜åœºæ™¯å’Œå‘½ä»¤ å®¢æˆ·ç«¯ sourcetree Tower sublimemerge gitkraken git-fork gitup ç»ƒä¹  Git å‘½ä»¤å¯è§†åŒ–å­¦ä¹ ","updated":"2025-08-02T05:46:04.176Z","tags":[{"name":"git","slug":"git","permalink":"https://luckyship.github.io/tags/git/"}]},{"title":"typescriptåŸºç¡€","date":"2021-05-12T14:27:38.000Z","path":"2021/05/12/2021-05-12-typescript-base/","text":"TypeScript æ˜¯ä¸€ç§ç”±å¾®è½¯å¼€å‘çš„è‡ªç”±å’Œå¼€æºçš„ç¼–ç¨‹è¯­è¨€ã€‚å®ƒæ˜¯ JavaScript çš„ä¸€ä¸ªè¶…é›†ï¼Œè€Œä¸”æœ¬è´¨ä¸Šå‘è¿™ä¸ªè¯­è¨€æ·»åŠ äº†å¯é€‰çš„é™æ€ç±»å‹å’ŒåŸºäºç±»çš„é¢å‘å¯¹è±¡ç¼–ç¨‹ã€‚ åŒºåˆ« TypeScript JavaScript JavaScript çš„è¶…é›†ç”¨äºè§£å†³å¤§å‹é¡¹ç›®çš„ä»£ç å¤æ‚æ€§ ä¸€ç§è„šæœ¬è¯­è¨€ï¼Œç”¨äºåˆ›å»ºåŠ¨æ€ç½‘é¡µ å¯ä»¥åœ¨ç¼–è¯‘æœŸé—´å‘ç°å¹¶çº æ­£é”™è¯¯ ä½œä¸ºä¸€ç§è§£é‡Šå‹è¯­è¨€ï¼Œåªèƒ½åœ¨è¿è¡Œæ—¶å‘ç°é”™è¯¯ å¼ºç±»å‹ï¼Œæ”¯æŒé™æ€å’ŒåŠ¨æ€ç±»å‹ å¼±ç±»å‹ï¼Œæ²¡æœ‰é™æ€ç±»å‹é€‰é¡¹ æœ€ç»ˆè¢«ç¼–è¯‘æˆ JavaScript ä»£ç ï¼Œä½¿æµè§ˆå™¨å¯ä»¥ç†è§£ å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ æ”¯æŒæ¨¡å—ã€æ³›å‹å’Œæ¥å£ ä¸æ”¯æŒæ¨¡å—ï¼Œæ³›å‹æˆ–æ¥å£ æ”¯æŒ ES3ï¼ŒES4ï¼ŒES5 å’Œ ES6 ç­‰ ä¸æ”¯æŒç¼–è¯‘å…¶ä»– ES3ï¼ŒES4ï¼ŒES5 æˆ– ES6 åŠŸèƒ½ ç¤¾åŒºçš„æ”¯æŒä»åœ¨å¢é•¿ï¼Œè€Œä¸”è¿˜ä¸æ˜¯å¾ˆå¤§ å¤§é‡çš„ç¤¾åŒºæ”¯æŒä»¥åŠå¤§é‡æ–‡æ¡£å’Œè§£å†³é—®é¢˜çš„æ”¯æŒ å®‰è£…npm install - g typescript ç¼–è¯‘tsc helloworld.ts// helloworld.ts =&gt; helloworld.js åœ¨çº¿å­¦ä¹ è¯­æ³•å’Œç‰¹æ€§ ç±»å‹ (11 ç§)Booleanlet isDone: boolean = false;// ES5ï¼švar isDone = false; Numberlet count: number = 10;// ES5ï¼švar count = 10; Stringlet name: string = &#x27;cosyer&#x27;;// ES5ï¼švar name = &#x27;cosyer&#x27;; Arraylet list: number[] = [1, 2, 3];// ES5ï¼švar list = [1,2,3];let list: Array&lt;number&gt; = [1, 2, 3]; // Array&lt;number&gt;æ³›å‹è¯­æ³•// ES5ï¼švar list = [1,2,3]; Enumä½¿ç”¨æšä¸¾æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€äº›å¸¦åå­—çš„å¸¸é‡ã€‚ä½¿ç”¨æšä¸¾å¯ä»¥æ¸…æ™°åœ°è¡¨è¾¾æ„å›¾æˆ–åˆ›å»ºä¸€ç»„æœ‰åŒºåˆ«çš„ç”¨ä¾‹ã€‚ TypeScript æ”¯æŒæ•°å­—çš„å’ŒåŸºäºå­—ç¬¦ä¸²çš„æšä¸¾ã€‚ æ•°å­—æšä¸¾enum Direction &#123; NORTH, SOUTH, EAST, WEST,&#125;let dir: Direction = Direction.NORTH; é»˜è®¤æƒ…å†µä¸‹ï¼ŒNORTH çš„åˆå§‹å€¼ä¸º 0ï¼Œå…¶ä½™çš„æˆå‘˜ä¼šä» 1 å¼€å§‹è‡ªåŠ¨å¢é•¿ã€‚æ¢å¥è¯è¯´ï¼ŒDirection. SOUTH çš„å€¼ä¸º 1ï¼ŒDirection. EAST çš„å€¼ä¸º 2ï¼ŒDirection. WEST çš„å€¼ä¸º 3ã€‚ä¸Šé¢çš„æšä¸¾ç¤ºä¾‹ä»£ç ç»è¿‡ç¼–è¯‘åä¼šç”Ÿæˆä»¥ä¸‹ä»£ç ï¼š &#x27;use strict&#x27;;var Direction;(function (Direction) &#123; Direction[(Direction[&#x27;NORTH&#x27;] = 0)] = &#x27;NORTH&#x27;; Direction[(Direction[&#x27;SOUTH&#x27;] = 1)] = &#x27;SOUTH&#x27;; Direction[(Direction[&#x27;EAST&#x27;] = 2)] = &#x27;EAST&#x27;; Direction[(Direction[&#x27;WEST&#x27;] = 3)] = &#x27;WEST&#x27;;&#125;)(Direction || (Direction = &#123;&#125;));var dir = Direction.NORTH; ä¹Ÿå¯ä»¥è®¾ç½® NORTH çš„åˆå§‹å€¼ï¼Œæ¯”å¦‚ï¼š enum Direction &#123; NORTH = 3, SOUTH, EAST, WEST,&#125; å­—ç¬¦ä¸²æšä¸¾enum Direction &#123; NORTH = &quot;NORTH&quot;, SOUTH = &quot;SOUTH&quot;, EAST = &quot;EAST&quot;, WEST = &quot;WEST&quot;,&#125; ç¼–è¯‘ç”Ÿæˆï¼š &#x27;use strict&#x27;;var Direction;(function (Direction) &#123; Direction[&#x27;NORTH&#x27;] = &#x27;NORTH&#x27;; Direction[&#x27;SOUTH&#x27;] = &#x27;SOUTH&#x27;; Direction[&#x27;EAST&#x27;] = &#x27;EAST&#x27;; Direction[&#x27;WEST&#x27;] = &#x27;WEST&#x27;;&#125;)(Direction || (Direction = &#123;&#125;)); å¼‚æ„æšä¸¾å¼‚æ„æšä¸¾çš„æˆå‘˜å€¼æ˜¯æ•°å­—å’Œå­—ç¬¦ä¸²çš„æ··åˆï¼š enum Enum &#123; A, B, C = &quot;C&quot;, D = &quot;D&quot;, E = 8, F,&#125; ç¼–è¯‘ç”Ÿæˆï¼š &#x27;use strict&#x27;;var Enum;(function (Enum) &#123; Enum[(Enum[&#x27;A&#x27;] = 0)] = &#x27;A&#x27;; Enum[(Enum[&#x27;B&#x27;] = 1)] = &#x27;B&#x27;; Enum[&#x27;C&#x27;] = &#x27;C&#x27;; Enum[&#x27;D&#x27;] = &#x27;D&#x27;; Enum[(Enum[&#x27;E&#x27;] = 8)] = &#x27;E&#x27;; Enum[(Enum[&#x27;F&#x27;] = 9)] = &#x27;F&#x27;;&#125;)(Enum || (Enum = &#123;&#125;)); æ•°å­—æšä¸¾ç›¸å¯¹å­—ç¬¦ä¸²æšä¸¾å¤šäº† â€œåå‘æ˜ å°„â€ï¼š console.log(Enum.A); //è¾“å‡ºï¼š0console.log(Enum[0]); // è¾“å‡ºï¼šA Anyåœ¨ TypeScript ä¸­ï¼Œä»»ä½•ç±»å‹éƒ½å¯ä»¥è¢«å½’ä¸º any ç±»å‹ã€‚è¿™è®© any ç±»å‹æˆä¸ºäº†ç±»å‹ç³»ç»Ÿçš„é¡¶çº§ç±»å‹ï¼ˆä¹Ÿè¢«ç§°ä½œå…¨å±€è¶…çº§ç±»å‹ï¼‰ã€‚ let notSure: any = 666;notSure = &#x27;cosyer&#x27;;notSure = false; any ç±»å‹æœ¬è´¨ä¸Šæ˜¯ç±»å‹ç³»ç»Ÿçš„ä¸€ä¸ªé€ƒé€¸èˆ±ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œè¿™ç»™äº†æˆ‘ä»¬å¾ˆå¤§çš„è‡ªç”±ï¼šTypeScript å…è®¸æˆ‘ä»¬å¯¹ any ç±»å‹çš„å€¼æ‰§è¡Œä»»ä½•æ“ä½œï¼Œè€Œæ— éœ€äº‹å…ˆæ‰§è¡Œä»»ä½•å½¢å¼çš„æ£€æŸ¥ã€‚ let value: any;value.foo.bar; // OKvalue.trim(); // OKvalue(); // OKnew value(); // OKvalue[0][1]; // OK åœ¨è®¸å¤šåœºæ™¯ä¸‹ï¼Œè¿™å¤ªå®½æ¾äº†ã€‚ä½¿ç”¨ any ç±»å‹ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°ç¼–å†™ç±»å‹æ­£ç¡®ä½†åœ¨è¿è¡Œæ—¶æœ‰é—®é¢˜çš„ä»£ç ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ any ç±»å‹ï¼Œå°±æ— æ³•ä½¿ç”¨ TypeScript æä¾›çš„å¤§é‡çš„ä¿æŠ¤æœºåˆ¶ã€‚ä¸ºäº†è§£å†³ any å¸¦æ¥çš„é—®é¢˜ï¼ŒTypeScript 3.0 å¼•å…¥äº† unknown ç±»å‹ã€‚AnyScript 2333. Unknownå°±åƒæ‰€æœ‰ç±»å‹éƒ½å¯ä»¥èµ‹å€¼ç»™ anyï¼Œæ‰€æœ‰ç±»å‹ä¹Ÿéƒ½å¯ä»¥èµ‹å€¼ç»™ unknownã€‚è¿™ä½¿å¾— unknown æˆä¸º TypeScript ç±»å‹ç³»ç»Ÿçš„å¦ä¸€ç§é¡¶çº§ç±»å‹ï¼ˆå¦ä¸€ç§æ˜¯ anyï¼‰ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ unknown ç±»å‹çš„ä½¿ç”¨ç¤ºä¾‹ï¼š let value: unknown;value = true; // OKvalue = 42; // OKvalue = &#x27;Hello World&#x27;; // OKvalue = []; // OKvalue = &#123;&#125;; // OKvalue = Math.random; // OKvalue = null; // OKvalue = undefined; // OKvalue = new TypeError(); // OKvalue = Symbol(&#x27;type&#x27;); // OK å¯¹ value å˜é‡çš„æ‰€æœ‰èµ‹å€¼éƒ½è¢«è®¤ä¸ºæ˜¯ç±»å‹æ­£ç¡®çš„ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬å°è¯•å°†ç±»å‹ä¸º unknown çš„å€¼èµ‹å€¼ç»™å…¶ä»–ç±»å‹çš„å˜é‡æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ let value: unknown;let value1: unknown = value; // OKlet value2: any = value; // OKlet value3: boolean = value; // Errorlet value4: number = value; // Errorlet value5: string = value; // Errorlet value6: object = value; // Errorlet value7: any[] = value; // Errorlet value8: Function = value; // Error unknown ç±»å‹åªèƒ½è¢«èµ‹å€¼ç»™ any ç±»å‹å’Œ unknown ç±»å‹æœ¬èº«ã€‚ç›´è§‚åœ°è¯´ï¼Œè¿™æ˜¯æœ‰é“ç†çš„ï¼šåªæœ‰èƒ½å¤Ÿä¿å­˜ä»»æ„ç±»å‹å€¼çš„å®¹å™¨æ‰èƒ½ä¿å­˜ unknown ç±»å‹çš„å€¼ã€‚æ¯•ç«Ÿæˆ‘ä»¬ä¸çŸ¥é“å˜é‡ value ä¸­å­˜å‚¨äº†ä»€ä¹ˆç±»å‹çš„å€¼ã€‚ å°† value å˜é‡ç±»å‹è®¾ç½®ä¸º unknown åï¼Œè¿™äº›æ“ä½œéƒ½ä¸å†è¢«è®¤ä¸ºæ˜¯ç±»å‹æ­£ç¡®çš„ã€‚é€šè¿‡å°† any ç±»å‹æ”¹å˜ä¸º unknown ç±»å‹ï¼Œæˆ‘ä»¬å·²å°†å…è®¸æ‰€æœ‰æ›´æ”¹çš„é»˜è®¤è®¾ç½®ï¼Œæ›´æ”¹ä¸ºç¦æ­¢ä»»ä½•æ›´æ”¹ã€‚ Tupleä¼—æ‰€å‘¨çŸ¥ï¼Œæ•°ç»„ä¸€èˆ¬ç”±åŒç§ç±»å‹çš„å€¼ç»„æˆï¼Œä½†æœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨å•ä¸ªå˜é‡ä¸­å­˜å‚¨ä¸åŒç±»å‹çš„å€¼ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å…ƒç»„ã€‚åœ¨ JavaScript ä¸­æ˜¯æ²¡æœ‰å…ƒç»„çš„ï¼Œå…ƒç»„æ˜¯ TypeScript ä¸­ç‰¹æœ‰çš„ç±»å‹ï¼Œå…¶å·¥ä½œæ–¹å¼ç±»ä¼¼äºæ•°ç»„ã€‚ å…ƒç»„å¯ç”¨äºå®šä¹‰å…·æœ‰æœ‰é™æ•°é‡çš„æœªå‘½åå±æ€§çš„ç±»å‹ã€‚æ¯ä¸ªå±æ€§éƒ½æœ‰ä¸€ä¸ªå…³è”çš„ç±»å‹ã€‚ä½¿ç”¨å…ƒç»„æ—¶ï¼Œå¿…é¡»æä¾›æ¯ä¸ªå±æ€§çš„å€¼ã€‚ä¸ºäº†æ›´ç›´è§‚åœ°ç†è§£å…ƒç»„çš„æ¦‚å¿µï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼š let tupleType: [string, boolean]; // å¼ºåˆ¶ç±»å‹åŒ¹é…tupleType = [&#x27;cosyer&#x27;, true]; VoidæŸç§ç¨‹åº¦ä¸Šæ¥è¯´ï¼Œvoid ç±»å‹åƒæ˜¯ä¸ any ç±»å‹ç›¸åï¼Œå®ƒè¡¨ç¤ºæ²¡æœ‰ä»»ä½•ç±»å‹ã€‚å½“ä¸€ä¸ªå‡½æ•°æ²¡æœ‰è¿”å›å€¼æ—¶ï¼Œä½ é€šå¸¸ä¼šè§åˆ°å…¶è¿”å›å€¼ç±»å‹æ˜¯ voidï¼š // å£°æ˜å‡½æ•°è¿”å›å€¼ä¸ºvoidfunction warnUser(): void &#123; console.log(&#x27;This is my warning message&#x27;);&#125; éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå£°æ˜ä¸€ä¸ª void ç±»å‹çš„å˜é‡æ²¡æœ‰ä»€ä¹ˆä½œç”¨ï¼Œå› ä¸ºå®ƒçš„å€¼åªèƒ½ä¸º undefined æˆ– nullï¼š let unusable: void = undefined; Null/UndefinedTypeScript é‡Œï¼Œundefined å’Œ null ä¸¤è€…æœ‰å„è‡ªçš„ç±»å‹åˆ†åˆ«ä¸º undefined å’Œ nullã€‚ let u: undefined = undefined;let n: null = null; é»˜è®¤æƒ…å†µä¸‹ null å’Œ undefined æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹ã€‚ å°±æ˜¯è¯´ä½ å¯ä»¥æŠŠ null å’Œ undefined èµ‹å€¼ç»™ number ç±»å‹çš„å˜é‡ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æŒ‡å®šäº†â€“strictNullChecks æ ‡è®°ï¼Œnull å’Œ undefined åªèƒ½èµ‹å€¼ç»™ void å’Œå®ƒä»¬å„è‡ªçš„ç±»å‹ã€‚ Nevernever ç±»å‹è¡¨ç¤ºçš„æ˜¯é‚£äº›æ°¸ä¸å­˜åœ¨çš„å€¼çš„ç±»å‹ã€‚ ä¾‹å¦‚ï¼Œnever ç±»å‹æ˜¯é‚£äº›æ€»æ˜¯ä¼šæŠ›å‡ºå¼‚å¸¸æˆ–æ ¹æœ¬å°±ä¸ä¼šæœ‰è¿”å›å€¼çš„å‡½æ•°è¡¨è¾¾å¼æˆ–ç®­å¤´å‡½æ•°è¡¨è¾¾å¼çš„è¿”å›å€¼ç±»å‹ã€‚ // è¿”å›neverçš„å‡½æ•°å¿…é¡»å­˜åœ¨æ— æ³•è¾¾åˆ°çš„ç»ˆç‚¹function error(message: string): never &#123; throw new Error(message);&#125;function infiniteLoop(): never &#123; while (true) &#123;&#125;&#125; åœ¨ TypeScript ä¸­ï¼Œå¯ä»¥åˆ©ç”¨ never ç±»å‹çš„ç‰¹æ€§æ¥å®ç°å…¨é¢æ€§æ£€æŸ¥ï¼Œå…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š type Foo = string | number;function controlFlowAnalysisWithNever(foo: Foo) &#123; if (typeof foo === &#x27;string&#x27;) &#123; // è¿™é‡Œ foo è¢«æ”¶çª„ä¸º string ç±»å‹ &#125; else if (typeof foo === &#x27;number&#x27;) &#123; // è¿™é‡Œ foo è¢«æ”¶çª„ä¸º number ç±»å‹ &#125; else &#123; // foo åœ¨è¿™é‡Œæ˜¯ never const check: never = foo; &#125;&#125; æ³¨æ„åœ¨ else åˆ†æ”¯é‡Œé¢ï¼Œæˆ‘ä»¬æŠŠæ”¶çª„ä¸º never çš„ foo èµ‹å€¼ç»™ä¸€ä¸ªæ˜¾ç¤ºå£°æ˜çš„ never å˜é‡ã€‚å¦‚æœä¸€åˆ‡é€»è¾‘æ­£ç¡®ï¼Œé‚£ä¹ˆè¿™é‡Œåº”è¯¥èƒ½å¤Ÿç¼–è¯‘é€šè¿‡ã€‚ä½†æ˜¯å‡å¦‚åæ¥æœ‰ä¸€å¤©ä½ çš„åŒäº‹ä¿®æ”¹äº† Foo çš„ç±»å‹ï¼štype Foo = string | number | boolean;å¤åˆ¶ä»£ç ç„¶è€Œä»–å¿˜è®°åŒæ—¶ä¿®æ”¹ controlFlowAnalysisWithNever æ–¹æ³•ä¸­çš„æ§åˆ¶æµç¨‹ï¼Œè¿™æ—¶å€™ else åˆ†æ”¯çš„ foo ç±»å‹ä¼šè¢«æ”¶çª„ä¸º boolean ç±»å‹ï¼Œå¯¼è‡´æ— æ³•èµ‹å€¼ç»™ never ç±»å‹ï¼Œè¿™æ—¶å°±ä¼šäº§ç”Ÿä¸€ä¸ªç¼–è¯‘é”™è¯¯ã€‚é€šè¿‡è¿™ä¸ªæ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿controlFlowAnalysisWithNever æ–¹æ³•æ€»æ˜¯ç©·å°½äº† Foo çš„æ‰€æœ‰å¯èƒ½ç±»å‹ã€‚ é€šè¿‡è¿™ä¸ªç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸€ä¸ªç»“è®ºï¼š ä½¿ç”¨ never é¿å…å‡ºç°æ–°å¢äº†è”åˆç±»å‹æ²¡æœ‰å¯¹åº”çš„å®ç°ï¼Œç›®çš„å°±æ˜¯å†™å‡ºç±»å‹ç»å¯¹å®‰å…¨çš„ä»£ç ã€‚ ç±»å‹æ–­è¨€å°–æ‹¬å·let someValue: any = &quot;this is a string&quot;;let strLength: number = ( &lt; string &gt; someValue).length; aslet someValue: any = &quot;this is a string&quot;;let strLength: number = (someValue as string).length; !éç©ºæ–­è¨€æ“ä½œç¬¦(æ„Ÿå¹å·) x! å°†ä» x å€¼åŸŸä¸­æ’é™¤ null å’Œ undefined. myFunc = (maybeString: string | undefined | null) =&gt; &#123; const onlyString: string = maybeString; // Error const ignoreUndefinedAndNull: string = maybeString!; // Ok&#125;myFunc2 = (onlyString: string) =&gt; &#123; const a: string = onlyString;&#125;constructor() &#123; this.myFunc(&#x27;jerry&#x27;); this.myFunc(undefined); this.myFunc2(undefined); this.myFunc2(null);&#125; æ²¡æœ‰ç¼–è¯‘é”™è¯¯ï¼Œä¹Ÿèƒ½æ­£å¸¸è¿è¡Œï¼š ç±»å‹å®ˆå«ç±»å‹ä¿æŠ¤æ˜¯å¯æ‰§è¡Œè¿è¡Œæ—¶æ£€æŸ¥çš„ä¸€ç§è¡¨è¾¾å¼ï¼Œç”¨äºç¡®ä¿è¯¥ç±»å‹åœ¨ä¸€å®šçš„èŒƒå›´å†…ã€‚æ¢å¥è¯è¯´ï¼Œç±»å‹ä¿æŠ¤å¯ä»¥ä¿è¯ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°½ç®¡å®ƒçš„å€¼ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ•°å€¼ã€‚ç±»å‹ä¿æŠ¤ä¸ç‰¹æ€§æ£€æµ‹å¹¶ä¸æ˜¯å®Œå…¨ä¸åŒï¼Œå…¶ä¸»è¦æ€æƒ³æ˜¯å°è¯•æ£€æµ‹å±æ€§ã€æ–¹æ³•æˆ–åŸå‹ï¼Œä»¥ç¡®å®šå¦‚ä½•å¤„ç†å€¼ã€‚ç›®å‰ä¸»è¦æœ‰å››ç§çš„æ–¹å¼æ¥å®ç°ç±»å‹ä¿æŠ¤ï¼š in å…³é”®å­—interface Admin &#123; name: string; privileges: string[];&#125;interface Employee &#123; name: string; startDate: Date;&#125;type UnknownEmployee = Employee | Admin;function printEmployeeInformation(emp: UnknownEmployee) &#123; console.log(&#x27;Name: &#x27; + emp.name); if (&#x27;privileges&#x27; in emp) &#123; console.log(&#x27;Privileges: &#x27; + emp.privileges); &#125; if (&#x27;startDate&#x27; in emp) &#123; console.log(&#x27;Start Date: &#x27; + emp.startDate); &#125;&#125; typeof å…³é”®å­—function padLeft(value: string, padding: string | number) &#123; if (typeof padding === &#x27;number&#x27;) &#123; return Array(padding + 1).join(&#x27; &#x27;) + value; &#125; if (typeof padding === &#x27;string&#x27;) &#123; return padding + value; &#125; throw new Error(`Expected string or number, got &#x27;$&#123;padding&#125;&#x27;.`);&#125; typeof ç±»å‹ä¿æŠ¤åªæ”¯æŒä¸¤ç§å½¢å¼ï¼štypeof v === â€œtypenameâ€ å’Œ typeof v !== typenameï¼Œâ€typenameâ€ å¿…é¡»æ˜¯ â€œnumberâ€ï¼Œ â€œstringâ€ï¼Œ â€œbooleanâ€ æˆ– â€œsymbolâ€ã€‚ ä½†æ˜¯ TypeScript å¹¶ä¸ä¼šé˜»æ­¢ä½ ä¸å…¶å®ƒå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œè¯­è¨€ä¸ä¼šæŠŠé‚£äº›è¡¨è¾¾å¼è¯†åˆ«ä¸ºç±»å‹ä¿æŠ¤ã€‚ instanceof å…³é”®å­—interface Padder &#123; getPaddingString(): string;&#125;class SpaceRepeatingPadder implements Padder &#123; constructor(private numSpaces: number) &#123;&#125; getPaddingString() &#123; return Array(this.numSpaces + 1).join(&quot; &quot;); &#125;&#125;class StringPadder implements Padder &#123; constructor(private value: string) &#123;&#125; getPaddingString() &#123; return this.value; &#125;&#125;let padder: Padder = new SpaceRepeatingPadder(6);if (padder instanceof SpaceRepeatingPadder) &#123; // padderçš„ç±»å‹æ”¶çª„ä¸º &#x27;SpaceRepeatingPadder&#x27;&#125; è‡ªå®šä¹‰ç±»å‹ä¿æŠ¤çš„ç±»å‹è°“è¯function isNumber(x: any): x is number &#123; return typeof x === &quot;number&quot;;&#125;function isString(x: any): x is string &#123; return typeof x === &quot;string&quot;;&#125; è”åˆç±»å‹å’Œç±»å‹åˆ«åè”åˆç±»å‹è”åˆç±»å‹é€šå¸¸ä¸ null æˆ– undefined ä¸€èµ·ä½¿ç”¨ï¼š const sayHello = (name: string | undefined) =&gt; &#123; /* ... */&#125;; ä¾‹å¦‚ï¼Œè¿™é‡Œ name çš„ç±»å‹æ˜¯ string | undefined æ„å‘³ç€å¯ä»¥å°† string æˆ– undefined çš„å€¼ä¼ é€’ç»™ sayHello å‡½æ•°ã€‚ sayHello(&#x27;cosyer&#x27;);sayHello(undefined); å¯è¾¨è¯†è”åˆTypeScript å¯è¾¨è¯†è”åˆï¼ˆDiscriminated Unionsï¼‰ç±»å‹ï¼Œä¹Ÿç§°ä¸ºä»£æ•°æ•°æ®ç±»å‹æˆ–æ ‡ç­¾è”åˆç±»å‹ã€‚å®ƒåŒ…å« 3 ä¸ªè¦ç‚¹ï¼š å¯è¾¨è¯†ã€è”åˆç±»å‹å’Œç±»å‹å®ˆå«ã€‚ è¿™ç§ç±»å‹çš„æœ¬è´¨æ˜¯ç»“åˆè”åˆç±»å‹å’Œå­—é¢é‡ç±»å‹çš„ä¸€ç§ç±»å‹ä¿æŠ¤æ–¹æ³•ã€‚ å¦‚æœä¸€ä¸ªç±»å‹æ˜¯å¤šä¸ªç±»å‹çš„è”åˆç±»å‹ï¼Œä¸”å¤šä¸ªç±»å‹å«æœ‰ä¸€ä¸ªå…¬å…±å±æ€§ï¼Œé‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªå…¬å…±å±æ€§ï¼Œæ¥åˆ›å»ºä¸åŒçš„ç±»å‹ä¿æŠ¤åŒºå—ã€‚ å¯è¾¨è¯†å¯è¾¨è¯†è¦æ±‚è”åˆç±»å‹ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å«æœ‰ä¸€ä¸ªå•ä¾‹ç±»å‹å±æ€§(å…¬å…±å±æ€§)ï¼Œæ¯”å¦‚ï¼š enum CarTransmission &#123; Automatic = 200, Manual = 300&#125;interface Motorcycle &#123; vType: &quot;motorcycle&quot;; // discriminant make: number; // year&#125;interface Car &#123; vType: &quot;car&quot;; // discriminant transmission: CarTransmission&#125;interface Truck &#123; vType: &quot;truck&quot;; // discriminant capacity: number; // in tons&#125; åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«å®šä¹‰äº† Motorcycleã€ Car å’Œ Truck ä¸‰ä¸ªæ¥å£ï¼Œåœ¨è¿™äº›æ¥å£ä¸­éƒ½åŒ…å«ä¸€ä¸ª vType å±æ€§ï¼Œè¯¥å±æ€§è¢«ç§°ä¸ºå¯è¾¨è¯†çš„å±æ€§ï¼Œè€Œå…¶å®ƒçš„å±æ€§åªè·Ÿç‰¹æ€§çš„æ¥å£ç›¸å…³ã€‚ è”åˆç±»å‹åŸºäºå‰é¢å®šä¹‰äº†ä¸‰ä¸ªæ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª Vehicle è”åˆç±»å‹ï¼š type Vehicle = Motorcycle | Car | Truck; ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹ä½¿ç”¨ Vehicle è”åˆç±»å‹ï¼Œå¯¹äº Vehicle ç±»å‹çš„å˜é‡ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºä¸åŒç±»å‹çš„è½¦è¾†ã€‚ ç±»å‹å®ˆå«ä¸‹é¢æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ª evaluatePrice æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨äºæ ¹æ®è½¦è¾†çš„ç±»å‹ã€å®¹é‡å’Œè¯„ä¼°å› å­æ¥è®¡ç®—ä»·æ ¼ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š const EVALUATION_FACTOR = Math.PI;function evaluatePrice(vehicle: Vehicle) &#123; return vehicle.capacity * EVALUATION_FACTOR;&#125;const myTruck: Truck = &#123; vType: &#x27;truck&#x27;, capacity: 9.5,&#125;;evaluatePrice(myTruck); å¯¹äºä»¥ä¸Šä»£ç ï¼ŒTypeScript ç¼–è¯‘å™¨å°†ä¼šæç¤ºä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼š Property &#x27;capacity&#x27;does not exist on type &#x27;Vehicle&#x27;.Property &#x27;capacity&#x27;does not exist on type &#x27;Motorcycle&#x27;. åŸå› æ˜¯åœ¨ Motorcycle æ¥å£ä¸­ï¼Œå¹¶ä¸å­˜åœ¨ capacity å±æ€§ï¼Œè€Œå¯¹äº Car æ¥å£æ¥è¯´ï¼Œå®ƒä¹Ÿä¸å­˜åœ¨ capacity å±æ€§ã€‚é‚£ä¹ˆï¼Œç°åœ¨æˆ‘ä»¬åº”è¯¥å¦‚ä½•è§£å†³ä»¥ä¸Šé—®é¢˜å‘¢ï¼Ÿè¿™æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç±»å‹å®ˆå«ã€‚ä¸‹é¢æˆ‘ä»¬æ¥é‡æ„ä¸€ä¸‹å‰é¢å®šä¹‰çš„ evaluatePrice æ–¹æ³•ï¼Œé‡æ„åçš„ä»£ç å¦‚ä¸‹ï¼š function evaluatePrice(vehicle: Vehicle) &#123; switch (vehicle.vType) &#123; case &#x27;car&#x27;: return vehicle.transmission * EVALUATION_FACTOR; case &#x27;truck&#x27;: return vehicle.capacity * EVALUATION_FACTOR; case &#x27;motorcycle&#x27;: return vehicle.make * EVALUATION_FACTOR; &#125;&#125; ç±»å‹åˆ«åç±»å‹åˆ«åç”¨æ¥ç»™ä¸€ä¸ªç±»å‹èµ·ä¸ªæ–°åå­—(alias)ã€‚ type Message = string | string[];let greet = (message: Message) =&gt; &#123; // ...&#125;; äº¤å‰ç±»å‹TypeScript äº¤å‰ç±»å‹æ˜¯å°†å¤šä¸ªç±»å‹åˆå¹¶ä¸ºä¸€ä¸ªç±»å‹ã€‚ è¿™è®©æˆ‘ä»¬å¯ä»¥æŠŠç°æœ‰çš„å¤šç§ç±»å‹å åŠ åˆ°ä¸€èµ·æˆä¸ºä¸€ç§ç±»å‹ï¼Œå®ƒåŒ…å«äº†æ‰€éœ€çš„æ‰€æœ‰ç±»å‹çš„ç‰¹æ€§ã€‚ interface IPerson &#123; id: string; age: number;&#125;interface IWorker &#123; companyId: string;&#125;type IStaff = IPerson &amp; IWorker;const staff: IStaff = &#123; id: &#x27;E1006&#x27;, age: 33, companyId: &#x27;EFT&#x27;,&#125;;console.dir(staff); åœ¨ä¸Šé¢ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆä¸º IPerson å’Œ IWorker ç±»å‹å®šä¹‰äº†ä¸åŒçš„æˆå‘˜ï¼Œç„¶åé€šè¿‡ &amp; è¿ç®—ç¬¦å®šä¹‰äº† IStaff äº¤å‰ç±»å‹ï¼Œæ‰€ä»¥è¯¥ç±»å‹åŒæ—¶æ‹¥æœ‰ IPerson å’Œ IWorker è¿™ä¸¤ç§ç±»å‹çš„æˆå‘˜ã€‚ å£°æ˜æ–‡ä»¶TypeScript ä½œä¸º JavaScript çš„è¶…é›†ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¸å¯é¿å…è¦å¼•ç”¨å…¶ä»–ç¬¬ä¸‰æ–¹çš„ JavaScript çš„åº“ã€‚è™½ç„¶é€šè¿‡ç›´æ¥å¼•ç”¨å¯ä»¥è°ƒç”¨åº“çš„ç±»å’Œæ–¹æ³•ï¼Œä½†æ˜¯å´æ— æ³•ä½¿ç”¨ TypeScript è¯¸å¦‚ç±»å‹æ£€æŸ¥ç­‰ç‰¹æ€§åŠŸèƒ½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å°†è¿™äº›åº“é‡Œçš„å‡½æ•°å’Œæ–¹æ³•ä½“å»æ‰ååªä¿ç•™å¯¼å‡ºç±»å‹å£°æ˜ï¼Œè€Œäº§ç”Ÿäº†ä¸€ä¸ªæè¿° JavaScript åº“å’Œæ¨¡å—ä¿¡æ¯çš„å£°æ˜æ–‡ä»¶ã€‚é€šè¿‡å¼•ç”¨è¿™ä¸ªå£°æ˜æ–‡ä»¶ï¼Œå°±å¯ä»¥å€Ÿç”¨ TypeScript çš„å„ç§ç‰¹æ€§æ¥ä½¿ç”¨åº“æ–‡ä»¶äº†ã€‚ å‡å¦‚æˆ‘ä»¬æƒ³ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œæ¯”å¦‚ jQuery ï¼Œæˆ‘ä»¬é€šå¸¸è¿™æ ·è·å–ä¸€ä¸ª id æ˜¯ foo çš„å…ƒç´ ï¼š $(&#x27;#foo&#x27;);// æˆ–jQuery(&#x27;#foo&#x27;); ä½†æ˜¯åœ¨ TypeScript ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“ $ æˆ– jQuery æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼š jQuery(&#x27;#foo&#x27;);// index.ts(1,1): error TS2304: Cannot find name &#x27;jQuery&#x27;. è¿™æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ declare å…³é”®å­—æ¥å®šä¹‰å®ƒçš„ç±»å‹ï¼Œå¸®åŠ© TypeScript åˆ¤æ–­æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ç±»å‹å¯¹ä¸å¯¹ï¼š declare var jQuery: (selector: string) =&gt; any;jQuery(&#x27;#foo&#x27;); declare å®šä¹‰çš„ç±»å‹åªä¼šç”¨äºç¼–è¯‘æ—¶çš„æ£€æŸ¥ï¼Œç¼–è¯‘ç»“æœä¸­ä¼šè¢«åˆ é™¤ã€‚ ä¸Šä¾‹çš„ç¼–è¯‘ç»“æœæ˜¯ï¼š jQuery(&#x27;#foo&#x27;); å‡½æ•°åŒºåˆ« TypeScript JavaScript å«æœ‰ç±»å‹ æ— ç±»å‹ ç®­å¤´å‡½æ•° ç®­å¤´å‡½æ•°ï¼ˆES2015ï¼‰ å‡½æ•°ç±»å‹ æ— å‡½æ•°ç±»å‹ å¿…å¡«å’Œå¯é€‰å‚æ•° æ‰€æœ‰å‚æ•°éƒ½æ˜¯å¯é€‰çš„ é»˜è®¤å‚æ•° é»˜è®¤å‚æ•° å‰©ä½™å‚æ•° å‰©ä½™å‚æ•° å‡½æ•°é‡è½½ æ— å‡½æ•°é‡è½½ ç®­å¤´å‡½æ•°myBooks.forEach(() =&gt; console.log(&#x27;reading&#x27;));myBooks.forEach(title =&gt; console.log(title));myBooks.forEach((title, idx, arr) =&gt; console.log(idx + &#x27;-&#x27; + title););myBooks.forEach((title, idx, arr) =&gt; &#123; console.log(idx + &#x27;-&#x27; + title);&#125;); å‚æ•°ç±»å‹å’Œè¿”å›ç±»å‹function createUserId(name: string, id: number): string &#123; return name + id;&#125; å‡½æ•°ç±»å‹let IdGenerator: (chars: string, nums: number) =&gt; string;function createUserId(name: string, id: number): string &#123; return name + id;&#125;IdGenerator = createUserId; å¯é€‰å‚æ•°å’Œé»˜è®¤å‚æ•°// å¯é€‰å‚æ•°function createUserId(name: string, id: number, age?: number): string &#123; return name + id;&#125;// é»˜è®¤å‚æ•°function createUserId(name: string = &#x27;cosyer&#x27;, id: number, age?: number): string &#123; return name + id;&#125; åœ¨å£°æ˜å‡½æ•°æ—¶ï¼Œå¯ä»¥é€šè¿‡ ? å·æ¥å®šä¹‰å¯é€‰å‚æ•°ï¼Œæ¯”å¦‚ age?: number è¿™ç§å½¢å¼ã€‚åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¯é€‰å‚æ•°è¦æ”¾åœ¨æ™®é€šå‚æ•°çš„åé¢ï¼Œä¸ç„¶ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ã€‚ å‰©ä½™å‚æ•°function push(array, ...items) &#123; items.forEach(function (item) &#123; array.push(item); &#125;);&#125;let a = [];push(a, 1, 2, 3); å‡½æ•°é‡è½½å‡½æ•°é‡è½½æˆ–æ–¹æ³•é‡è½½æ˜¯ä½¿ç”¨ç›¸åŒåç§°å’Œä¸åŒå‚æ•°æ•°é‡æˆ–ç±»å‹åˆ›å»ºå¤šä¸ªæ–¹æ³•çš„ä¸€ç§èƒ½åŠ›ã€‚è¦è§£å†³å‰é¢é‡åˆ°çš„é—®é¢˜ï¼Œæ–¹æ³•å°±æ˜¯ä¸ºåŒä¸€ä¸ªå‡½æ•°æä¾›å¤šä¸ªå‡½æ•°ç±»å‹å®šä¹‰æ¥è¿›è¡Œå‡½æ•°é‡è½½ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®è¿™ä¸ªåˆ—è¡¨å»å¤„ç†å‡½æ•°çš„è°ƒç”¨ã€‚ function add(a: number, b: number): number;function add(a: string, b: string): string;function add(a: string, b: number): string;function add(a: number, b: string): string;function add(a: Combinable, b: Combinable) &#123; if (typeof a === &quot;string&quot; || typeof b === &quot;string&quot;) &#123; return a.toString() + b.toString(); &#125; return a + b;&#125; æ–¹æ³•é‡è½½æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªç±»ä¸­æ–¹æ³•åŒåï¼Œå‚æ•°ä¸åŒï¼ˆå‚æ•°ç±»å‹ä¸åŒã€å‚æ•°ä¸ªæ•°ä¸åŒæˆ–å‚æ•°ä¸ªæ•°ç›¸åŒæ—¶å‚æ•°çš„å…ˆåé¡ºåºä¸åŒï¼‰ï¼Œè°ƒç”¨æ—¶æ ¹æ®å®å‚çš„å½¢å¼ï¼Œé€‰æ‹©ä¸å®ƒåŒ¹é…çš„æ–¹æ³•æ‰§è¡Œæ“ä½œçš„ä¸€ç§æŠ€æœ¯ã€‚æ‰€ä»¥ç±»ä¸­æˆå‘˜æ–¹æ³•æ»¡è¶³é‡è½½çš„æ¡ä»¶æ˜¯ï¼šåœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œæ–¹æ³•åç›¸åŒä¸”å‚æ•°åˆ—è¡¨ä¸åŒã€‚ä¸‹é¢æˆ‘ä»¬æ¥ä¸¾ä¸€ä¸ªæˆå‘˜æ–¹æ³•é‡è½½çš„ä¾‹å­ï¼š class Calculator &#123; add(a: number, b: number): number; add(a: string, b: string): string; add(a: string, b: number): string; add(a: number, b: string): string; add(a: Combinable, b: Combinable) &#123; if (typeof a === &quot;string&quot; || typeof b === &quot;string&quot;) &#123; return a.toString() + b.toString(); &#125; return a + b; &#125;&#125;const calculator = new Calculator();const result = calculator.add(&quot;cosyer&quot;, &quot; chenyu&quot;); è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ TypeScript ç¼–è¯‘å™¨å¤„ç†å‡½æ•°é‡è½½æ—¶ï¼Œå®ƒä¼šæŸ¥æ‰¾é‡è½½åˆ—è¡¨ï¼Œå°è¯•ä½¿ç”¨ç¬¬ä¸€ä¸ªé‡è½½å®šä¹‰ã€‚ å¦‚æœåŒ¹é…çš„è¯å°±ä½¿ç”¨è¿™ä¸ªã€‚ å› æ­¤ï¼Œåœ¨å®šä¹‰é‡è½½çš„æ—¶å€™ï¼Œä¸€å®šè¦æŠŠæœ€ç²¾ç¡®çš„å®šä¹‰æ”¾åœ¨æœ€å‰é¢ã€‚å¦å¤–åœ¨ Calculator ç±»ä¸­ï¼Œadd(a: Combinable, b: Combinable){ } å¹¶ä¸æ˜¯é‡è½½åˆ—è¡¨çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤å¯¹äº add æˆå‘˜æ–¹æ³•æ¥è¯´ï¼Œæˆ‘ä»¬åªå®šä¹‰äº†å››ä¸ªé‡è½½æ–¹æ³•ã€‚ æ•°ç»„æ•°ç»„è§£æ„let x: number;let y: number;let z: number;let five_array = [0, 1, 2, 3, 4];[x, y, z] = five_array; // 0 1 2 æ‰©å±•è¿ç®—ç¬¦let two_array = [0, 1];let five_array = [...two_array, 2, 3, 4]; æ•°ç»„éå†let colors: string[] = [&#x27;red&#x27;, &#x27;green&#x27;, &#x27;blue&#x27;];for (let i of colors) &#123; console.log(i);&#125; å¯¹è±¡å¯¹è±¡è§£æ„let person = &#123; name: &#x27;cosyer&#x27;, gender: &#x27;Male&#x27;,&#125;;let &#123; name, gender &#125; = person; å¯¹è±¡å±•å¼€æ‰©å±•let person = &#123; name: &#x27;cosyer&#x27;, gender: &#x27;Male&#x27;, address: &#x27;Nanjing&#x27;,&#125;;// ç»„è£…å¯¹è±¡let personWithAge = &#123; ...person, age: 33,&#125;;// è·å–é™¤äº†æŸäº›é¡¹å¤–çš„å…¶å®ƒé¡¹let &#123; name, ...rest &#125; = person; æ¥å£åœ¨é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œæ¥å£æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„æ¦‚å¿µï¼Œå®ƒæ˜¯å¯¹è¡Œä¸ºçš„æŠ½è±¡ï¼Œè€Œå…·ä½“å¦‚ä½•è¡ŒåŠ¨éœ€è¦ç”±ç±»å»å®ç°ã€‚ TypeScript ä¸­çš„æ¥å£æ˜¯ä¸€ä¸ªéå¸¸çµæ´»çš„æ¦‚å¿µï¼Œé™¤äº†å¯ç”¨äºå¯¹ç±»çš„ä¸€éƒ¨åˆ†è¡Œä¸ºè¿›è¡ŒæŠ½è±¡ä»¥å¤–ï¼Œä¹Ÿå¸¸ç”¨äºå¯¹ã€Œå¯¹è±¡çš„å½¢çŠ¶ï¼ˆShapeï¼‰ã€è¿›è¡Œæè¿° å¯¹è±¡çš„å½¢çŠ¶(æè¿°)interface Person &#123; name: string; age: number;&#125;let cosyer: Person = &#123; name: &#x27;cosyer&#x27;, age: 25,&#125;; å¯é€‰ã€åªè¯»å±æ€§interface Person &#123; readonly name: string; age ? : number;&#125; åªè¯»å±æ€§ç”¨äºé™åˆ¶åªèƒ½åœ¨å¯¹è±¡åˆšåˆšåˆ›å»ºçš„æ—¶å€™ä¿®æ”¹å…¶å€¼ã€‚æ­¤å¤– TypeScript è¿˜æä¾›äº† ReadonlyArray ç±»å‹ï¼Œå®ƒä¸ Array ç›¸ä¼¼ï¼Œåªæ˜¯æŠŠæ‰€æœ‰å¯å˜æ–¹æ³•å»æ‰äº†ï¼Œå› æ­¤å¯ä»¥ç¡®ä¿æ•°ç»„åˆ›å»ºåå†ä¹Ÿä¸èƒ½è¢«ä¿®æ”¹ã€‚ let a: number[] = [1, 2, 3, 4];let ro: ReadonlyArray&lt;number&gt; = a;ro[0] = 12; // error!ro.push(5); // error!ro.length = 100; // error!a = ro; // error! æ³›å‹è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…è¦åˆ›å»ºä¸€è‡´çš„å®šä¹‰è‰¯å¥½çš„ APIï¼ŒåŒæ—¶ä¹Ÿè¦è€ƒè™‘å¯é‡ç”¨æ€§ã€‚ ç»„ä»¶ä¸ä»…èƒ½å¤Ÿæ”¯æŒå½“å‰çš„æ•°æ®ç±»å‹ï¼ŒåŒæ—¶ä¹Ÿèƒ½æ”¯æŒæœªæ¥çš„æ•°æ®ç±»å‹ï¼Œè¿™åœ¨åˆ›å»ºå¤§å‹ç³»ç»Ÿæ—¶ä¸ºä½ æä¾›äº†ååˆ†çµæ´»çš„åŠŸèƒ½ã€‚ åœ¨åƒ C# å’Œ Java è¿™æ ·çš„è¯­è¨€ä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ³›å‹æ¥åˆ›å»ºå¯é‡ç”¨çš„ç»„ä»¶ï¼Œä¸€ä¸ªç»„ä»¶å¯ä»¥æ”¯æŒå¤šç§ç±»å‹çš„æ•°æ®ã€‚ è¿™æ ·ç”¨æˆ·å°±å¯ä»¥ä»¥è‡ªå·±çš„æ•°æ®ç±»å‹æ¥ä½¿ç”¨ç»„ä»¶ã€‚ è®¾è®¡æ³›å‹çš„å…³é”®ç›®çš„æ˜¯åœ¨æˆå‘˜ä¹‹é—´æä¾›æœ‰æ„ä¹‰çš„çº¦æŸï¼Œè¿™äº›æˆå‘˜å¯ä»¥æ˜¯ï¼šç±»çš„å®ä¾‹æˆå‘˜ã€ç±»çš„æ–¹æ³•ã€å‡½æ•°å‚æ•°å’Œå‡½æ•°è¿”å›å€¼ã€‚ æ³›å‹ï¼ˆGenericsï¼‰æ˜¯å…è®¸åŒä¸€ä¸ªå‡½æ•°æ¥å—ä¸åŒç±»å‹å‚æ•°çš„ä¸€ç§æ¨¡æ¿ã€‚ç›¸æ¯”äºä½¿ç”¨ any ç±»å‹ï¼Œä½¿ç”¨æ³›å‹æ¥åˆ›å»ºå¯å¤ç”¨çš„ç»„ä»¶è¦æ›´å¥½ï¼Œå› ä¸ºæ³›å‹ä¼šä¿ç•™å‚æ•°ç±»å‹ã€‚ æ³›å‹æ¥å£interface GenericIdentityFn&lt;T&gt; &#123; (arg: T): T;&#125; æ³›å‹ç±»class GenericNumber &lt; T &gt; &#123; zeroValue: T; add: (x: T, y: T) =&gt; T;&#125;let myGenericNumber = new GenericNumber &lt; number &gt; ();myGenericNumber.zeroValue = 0;myGenericNumber.add = function(x, y) &#123; return x + y;&#125;; æ³›å‹å˜é‡å¯¹åˆšæ¥è§¦ TypeScript æ³›å‹çš„å°ä¼™ä¼´æ¥è¯´ï¼Œçœ‹åˆ° T å’Œ Eï¼Œè¿˜æœ‰ K å’Œ V è¿™äº›æ³›å‹å˜é‡æ—¶ï¼Œä¼°è®¡ä¼šä¸€è„¸æ‡µé€¼ã€‚å…¶å®è¿™äº›å¤§å†™å­—æ¯å¹¶æ²¡æœ‰ä»€ä¹ˆæœ¬è´¨çš„åŒºåˆ«ï¼Œåªä¸è¿‡æ˜¯ä¸€ä¸ªçº¦å®šå¥½çš„è§„èŒƒè€Œå·²ã€‚ä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨å¤§å†™å­—æ¯ A-Z å®šä¹‰çš„ç±»å‹å˜é‡éƒ½å±äºæ³›å‹ï¼ŒæŠŠ T æ¢æˆ Aï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚ä¸‹é¢æˆ‘ä»¬ä»‹ç»ä¸€ä¸‹ä¸€äº›å¸¸è§æ³›å‹å˜é‡ä»£è¡¨çš„æ„æ€ï¼š Tï¼ˆTypeï¼‰ï¼šè¡¨ç¤ºä¸€ä¸ª TypeScript ç±»å‹ Kï¼ˆKeyï¼‰ï¼šè¡¨ç¤ºå¯¹è±¡ä¸­çš„é”®ç±»å‹ Vï¼ˆValueï¼‰ï¼šè¡¨ç¤ºå¯¹è±¡ä¸­çš„å€¼ç±»å‹ Eï¼ˆElementï¼‰ï¼šè¡¨ç¤ºå…ƒç´ ç±»å‹ æ³›å‹å·¥å…·ç±»å‹(6 ç§)ä¸ºäº†æ–¹ä¾¿å¼€å‘è€… TypeScript å†…ç½®äº†ä¸€äº›å¸¸ç”¨çš„å·¥å…·ç±»å‹ï¼Œæ¯”å¦‚ Partialã€Requiredã€Readonlyã€Record å’Œ ReturnType ç­‰ã€‚ typeoftypeof æ“ä½œç¬¦å¯ä»¥ç”¨æ¥è·å–ä¸€ä¸ªå˜é‡å£°æ˜æˆ–å¯¹è±¡çš„ç±»å‹ã€‚ interface Person &#123; name: string; age: number;&#125;const cosyer: Person = &#123; name: &#x27;cosyer&#x27;, age: 25,&#125;;type Cosyer = typeof cosyer; // -&gt; Personfunction toArray(x: number): Array&lt;number&gt; &#123; return [x];&#125;type Func = typeof toArray; // -&gt; (x: number) =&gt; number[] keyofkeyof æ“ä½œç¬¦å¯ä»¥ç”¨æ¥ä¸€ä¸ªå¯¹è±¡ä¸­çš„æ‰€æœ‰ key å€¼ï¼š interface Person &#123; name: string; age: number;&#125;type K1 = keyof Person; // &quot;name&quot; | &quot;age&quot;type K2 = keyof Person[]; // &quot;length&quot; | &quot;toString&quot; | &quot;pop&quot; | &quot;push&quot; | &quot;concat&quot; | &quot;join&quot;type K3 = keyof &#123; [x: string]: Person&#125;; // string | number inin ç”¨æ¥éå†æšä¸¾ç±»å‹ï¼š type Keys = &quot;a&quot; | &quot;b&quot; | &quot;c&quot;type Obj = &#123; [p in Keys]: any&#125; // -&gt; &#123; a: any, b: any, c: any &#125; inferåœ¨æ¡ä»¶ç±»å‹è¯­å¥ä¸­ï¼Œå¯ä»¥ç”¨ infer å£°æ˜ä¸€ä¸ªç±»å‹å˜é‡å¹¶ä¸”å¯¹å®ƒè¿›è¡Œä½¿ç”¨ã€‚ type ReturnType &lt; T &gt; = T extends( ...args: any[]) =&gt; infer R ? R : any; ä»¥ä¸Šä»£ç ä¸­ infer R å°±æ˜¯å£°æ˜ä¸€ä¸ªå˜é‡æ¥æ‰¿è½½ä¼ å…¥å‡½æ•°ç­¾åçš„è¿”å›å€¼ç±»å‹ï¼Œç®€å•è¯´å°±æ˜¯ç”¨å®ƒå–åˆ°å‡½æ•°è¿”å›å€¼çš„ç±»å‹æ–¹ä¾¿ä¹‹åä½¿ç”¨ã€‚ extendsæœ‰æ—¶å€™æˆ‘ä»¬å®šä¹‰çš„æ³›å‹ä¸æƒ³è¿‡äºçµæ´»æˆ–è€…è¯´æƒ³ç»§æ‰¿æŸäº›ç±»ç­‰ï¼Œå¯ä»¥é€šè¿‡ extends å…³é”®å­—æ·»åŠ æ³›å‹çº¦æŸã€‚ interface ILengthwise &#123; length: number;&#125;function loggingIdentity &lt; T extends ILengthwise &gt; (arg: T): T &#123; console.log(arg.length); return arg;&#125; // error, number doesn&#x27;t have a .length propertyloggingIdentity(3);loggingIdentity(&#123; length: 10, value: 3,&#125;); PartialPartial çš„ä½œç”¨å°±æ˜¯å°†æŸä¸ªç±»å‹é‡Œçš„å±æ€§å…¨éƒ¨å˜ä¸ºå¯é€‰é¡¹ ?ã€‚ /** * node_modules/typescript/lib/lib.es5.d.ts * Make all properties in T optional */type Partial &lt; T &gt; = &#123; [P in keyof T] ? : T[P];&#125;; interface Todo &#123; title: string; description: string;&#125;function updateTodo(todo: Todo, fieldsToUpdate: Partial&lt;Todo&gt;) &#123; return &#123; ...todo, ...fieldsToUpdate, &#125;;&#125;const todo1 = &#123; title: &#x27;organize desk&#x27;, description: &#x27;clear clutter&#x27;,&#125;;const todo2 = updateTodo(todo1, &#123; description: &#x27;throw out trash&#x27;,&#125;); è£…é¥°å™¨è£…é¥°å™¨æ˜¯ä»€ä¹ˆ å®ƒæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ è¯¥è¡¨è¾¾å¼è¢«æ‰§è¡Œåï¼Œè¿”å›ä¸€ä¸ªå‡½æ•° å‡½æ•°çš„å…¥å‚åˆ†åˆ«ä¸º targetã€name å’Œ descriptor æ‰§è¡Œè¯¥å‡½æ•°åï¼Œå¯èƒ½è¿”å› descriptor å¯¹è±¡ï¼Œç”¨äºé…ç½® target å¯¹è±¡ è£…é¥°å™¨çš„åˆ†ç±» ç±»è£…é¥°å™¨ï¼ˆClass decoratorsï¼‰ å±æ€§è£…é¥°å™¨ï¼ˆProperty decoratorsï¼‰ æ–¹æ³•è£…é¥°å™¨ï¼ˆMethod decoratorsï¼‰ å‚æ•°è£…é¥°å™¨ï¼ˆParameter decoratorsï¼‰ ç±»è£…é¥°å™¨declare type ClassDecorator = &lt; TFunction extends Function &gt; ( target: TFunction) =&gt; TFunction | void; ç±»è£…é¥°å™¨é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ç”¨æ¥è£…é¥°ç±»çš„ã€‚å®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼š target: TFunction - è¢«è£…é¥°çš„ç±» function Greeter(target: Function): void &#123; target.prototype.greet = function (): void &#123; console.log(&#x27;Hello cosyer!&#x27;); &#125;;&#125;@Greeterclass Greeting &#123; constructor() &#123; // å†…éƒ¨å®ç° &#125;&#125;let myGreeting = new Greeting();myGreeting.greet(); // console output: &#x27;Hello cosyer!&#x27;; è‡ªå®šä¹‰å‚æ•° function Greeter(greeting: string) &#123; return function (target: Function) &#123; target.prototype.greet = function (): void &#123; console.log(greeting); &#125;; &#125;;&#125;@Greeter(&#x27;Hello TS!&#x27;)class Greeting &#123; constructor() &#123; // å†…éƒ¨å®ç° &#125;&#125;let myGreeting = new Greeting();myGreeting.greet(); // console output: &#x27;Hello TS!&#x27;; å±æ€§è£…é¥°å™¨declare type PropertyDecorator = (target: Object, propertyKey: string | symbol) =&gt; void; å±æ€§è£…é¥°å™¨é¡¾åæ€ä¹‰ï¼Œç”¨æ¥è£…é¥°ç±»çš„å±æ€§ã€‚å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š target: Object - è¢«è£…é¥°çš„ç±» propertyKey: string | symbol - è¢«è£…é¥°ç±»çš„å±æ€§å function logProperty(target: any, key: string) &#123; delete target[key]; const backingField = &quot;_&quot; + key; Object.defineProperty(target, backingField, &#123; writable: true, enumerable: true, configurable: true &#125;); // property getter const getter = function(this: any) &#123; const currVal = this[backingField]; console.log(`Get: $&#123;key&#125; =&gt; $&#123;currVal&#125;`); return currVal; &#125;; // property setter const setter = function(this: any, newVal: any) &#123; console.log(`Set: $&#123;key&#125; =&gt; $&#123;newVal&#125;`); this[backingField] = newVal; &#125;; // Create new property with getter and setter Object.defineProperty(target, key, &#123; get: getter, set: setter, enumerable: true, configurable: true &#125;);&#125;class Person &#123; @logProperty public name: string; constructor(name: string) &#123; this.name = name; &#125;&#125;const p1 = new Person(&quot;cosyer&quot;);p1.name = &quot;chenyu&quot;;// Set: name =&gt; cosyer// Set: name =&gt; chenyu æ–¹æ³•è£…é¥°å™¨declare type MethodDecorator = &lt;T&gt;( target: Object, propertyKey: string | symbol, descriptor: TypePropertyDescript&lt;T&gt;) =&gt; TypedPropertyDescriptor&lt;T&gt; | void; æ–¹æ³•è£…é¥°å™¨é¡¾åæ€ä¹‰ï¼Œç”¨æ¥è£…é¥°ç±»çš„æ–¹æ³•ã€‚å®ƒæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š target: Object - è¢«è£…é¥°çš„ç±» propertyKey: string | symbol - æ–¹æ³•å descriptor: TypePropertyDescript - å±æ€§æè¿°ç¬¦ function LogOutput(tarage: Function, key: string, descriptor: any) &#123; let originalMethod = descriptor.value; let newMethod = function(...args: any[]): any &#123; let result: any = originalMethod.apply(this, args); if (!this.loggedOutput) &#123; this.loggedOutput = new Array &lt; any &gt; (); &#125; this.loggedOutput.push(&#123; method: key, parameters: args, output: result, timestamp: new Date() &#125;); return result; &#125;; descriptor.value = newMethod;&#125;class Calculator &#123; @LogOutput double(num: number): number &#123; return num * 2; &#125;&#125;let calc = new Calculator();calc.double(11);// console ouput: [&#123;method: &quot;double&quot;, output: 22, ...&#125;]console.log(calc.loggedOutput); å‚æ•°è£…é¥°å™¨declare type ParameterDecorator = (target: Object, propertyKey: string | symbol, parameterIndex: number) =&gt; void; å‚æ•°è£…é¥°å™¨é¡¾åæ€ä¹‰ï¼Œæ˜¯ç”¨æ¥è£…é¥°å‡½æ•°å‚æ•°ï¼Œå®ƒæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š target: Object - è¢«è£…é¥°çš„ç±» propertyKey: string | symbol - æ–¹æ³•å parameterIndex: number - æ–¹æ³•ä¸­å‚æ•°çš„ç´¢å¼•å€¼ function Log(target: Function, key: string, parameterIndex: number) &#123; let functionLogged = key || target.prototype.constructor.name; console.log(`The parameter in position $&#123;parameterIndex&#125; at $&#123;functionLogged&#125; has been decorated`);&#125;class Greeter &#123; greeting: string; constructor(@Log phrase: string) &#123; this.greeting = phrase; &#125;&#125;// console output: The parameter in position 0// at Greeter has been decorated ç±»ç±»çš„å±æ€§å’Œæ–¹æ³•åœ¨é¢å‘å¯¹è±¡è¯­è¨€ä¸­ï¼Œç±»æ˜¯ä¸€ç§é¢å‘å¯¹è±¡è®¡ç®—æœºç¼–ç¨‹è¯­è¨€çš„æ„é€ ï¼Œæ˜¯åˆ›å»ºå¯¹è±¡çš„è“å›¾ï¼Œæè¿°äº†æ‰€åˆ›å»ºçš„å¯¹è±¡å…±åŒçš„å±æ€§å’Œæ–¹æ³•ã€‚ class Greeter &#123; // é™æ€å±æ€§ static cname: string = &#x27;Greeter&#x27;; // æˆå‘˜å±æ€§ greeting: string; // æ„é€ å‡½æ•° - æ‰§è¡Œåˆå§‹åŒ–æ“ä½œ constructor(message: string) &#123; this.greeting = message; &#125; // é™æ€æ–¹æ³• static getClassName() &#123; return &#x27;Class name is Greeter&#x27;; &#125; // æˆå‘˜æ–¹æ³• greet() &#123; return &#x27;Hello, &#x27; + this.greeting; &#125;&#125;let greeter = new Greeter(&#x27;world&#x27;); ç¼–è¯‘ç”Ÿæˆï¼š &#x27;use strict&#x27;;var Greeter = /** @class */ (function () &#123; // æ„é€ å‡½æ•° - æ‰§è¡Œåˆå§‹åŒ–æ“ä½œ function Greeter(message) &#123; this.greeting = message; &#125; // é™æ€æ–¹æ³• Greeter.getClassName = function () &#123; return &#x27;Class name is Greeter&#x27;; &#125;; // æˆå‘˜æ–¹æ³• Greeter.prototype.greet = function () &#123; return &#x27;Hello, &#x27; + this.greeting; &#125;; // é™æ€å±æ€§ Greeter.cname = &#x27;Greeter&#x27;; return Greeter;&#125;)();var greeter = new Greeter(&#x27;world&#x27;); è®¿é—®å™¨(getter/setter)åœ¨ TypeScript ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ getter å’Œ setter æ–¹æ³•æ¥å®ç°æ•°æ®çš„å°è£…å’Œæœ‰æ•ˆæ€§æ ¡éªŒï¼Œé˜²æ­¢å‡ºç°å¼‚å¸¸æ•°æ®ã€‚ let passcode = &quot;Hello TypeScript&quot;;class Employee &#123; private _fullName: string; get fullName(): string &#123; return this._fullName; &#125; set fullName(newName: string) &#123; if (passcode &amp;&amp; passcode == &quot;Hello TypeScript&quot;) &#123; this._fullName = newName; &#125; else &#123; console.log(&quot;Error: Unauthorized update of employee!&quot;); &#125; &#125;&#125;let employee = new Employee();employee.fullName = &quot;cosyer&quot;;if (employee.fullName) &#123; console.log(employee.fullName);&#125; ç»§æ‰¿ç»§æ‰¿ (Inheritance) æ˜¯ä¸€ç§è”ç»“ç±»ä¸ç±»çš„å±‚æ¬¡æ¨¡å‹ã€‚æŒ‡çš„æ˜¯ä¸€ä¸ªç±»ï¼ˆç§°ä¸ºå­ç±»ã€å­æ¥å£ï¼‰ç»§æ‰¿å¦å¤–çš„ä¸€ä¸ªç±»ï¼ˆç§°ä¸ºçˆ¶ç±»ã€çˆ¶æ¥å£ï¼‰çš„åŠŸèƒ½ï¼Œå¹¶å¯ä»¥å¢åŠ è‡ªå·±æ–°åŠŸèƒ½çš„èƒ½åŠ›ï¼Œç»§æ‰¿æ˜¯ç±»ä¸ç±»æˆ–è€…æ¥å£ä¸æ¥å£ä¹‹é—´æœ€å¸¸è§çš„å…³ç³»ã€‚ class Animal &#123; name: string; constructor(theName: string) &#123; this.name = theName; &#125; move(distanceInMeters: number = 0) &#123; console.log(`$&#123;this.name&#125; moved $&#123;distanceInMeters&#125;m.`); &#125;&#125;class Snake extends Animal &#123; constructor(name: string) &#123; super(name); &#125; move(distanceInMeters = 5) &#123; console.log(&#x27;Slithering...&#x27;); super.move(distanceInMeters); &#125;&#125;let sam = new Snake(&#x27;Sammy the Python&#x27;);sam.move(); ç§æœ‰å­—æ®µåœ¨ TypeScript 3.8 ç‰ˆæœ¬å°±å¼€å§‹æ”¯æŒ ECMAScript ç§æœ‰å­—æ®µ class Person &#123; #name: string; constructor(name: string) &#123; this.#name = name; &#125; greet() &#123; console.log(`Hello, my name is $&#123;this.#name&#125;!`); &#125;&#125;let cosyer = new Person(&#x27;cosyer&#x27;);cosyer.#name;// Property &#x27;#name&#x27; is not accessible outside class &#x27;Person&#x27;// because it has a private identifier. ä¸å¸¸è§„å±æ€§ï¼ˆç”šè‡³ä½¿ç”¨ private ä¿®é¥°ç¬¦å£°æ˜çš„å±æ€§ï¼‰ä¸åŒï¼Œç§æœ‰å­—æ®µè¦ç‰¢è®°ä»¥ä¸‹è§„åˆ™ï¼š ç§æœ‰å­—æ®µä»¥ # å­—ç¬¦å¼€å¤´ï¼Œæœ‰æ—¶æˆ‘ä»¬ç§°ä¹‹ä¸ºç§æœ‰åç§°ï¼› æ¯ä¸ªç§æœ‰å­—æ®µåç§°éƒ½å”¯ä¸€åœ°é™å®šäºå…¶åŒ…å«çš„ç±»ï¼› ä¸èƒ½åœ¨ç§æœ‰å­—æ®µä¸Šä½¿ç”¨ TypeScript å¯è®¿é—®æ€§ä¿®é¥°ç¬¦ï¼ˆå¦‚ public æˆ– privateï¼‰ï¼› ç§æœ‰å­—æ®µä¸èƒ½åœ¨åŒ…å«çš„ç±»ä¹‹å¤–è®¿é—®ï¼Œç”šè‡³ä¸èƒ½è¢«æ£€æµ‹åˆ°ã€‚ ç¼–è¯‘ä¸Šä¸‹æ–‡tsconfig.json çš„ä½œç”¨ ç”¨äºæ ‡è¯† TypeScript é¡¹ç›®çš„æ ¹è·¯å¾„ï¼› ç”¨äºé…ç½® TypeScript ç¼–è¯‘å™¨ï¼› ç”¨äºæŒ‡å®šç¼–è¯‘çš„æ–‡ä»¶ã€‚ tsconfig.json é‡è¦å­—æ®µ files - è®¾ç½®è¦ç¼–è¯‘çš„æ–‡ä»¶çš„åç§°ï¼› include - è®¾ç½®éœ€è¦è¿›è¡Œç¼–è¯‘çš„æ–‡ä»¶ï¼Œæ”¯æŒè·¯å¾„æ¨¡å¼åŒ¹é…ï¼› exclude - è®¾ç½®æ— éœ€è¿›è¡Œç¼–è¯‘çš„æ–‡ä»¶ï¼Œæ”¯æŒè·¯å¾„æ¨¡å¼åŒ¹é…ï¼› compilerOptions - è®¾ç½®ä¸ç¼–è¯‘æµç¨‹ç›¸å…³çš„é€‰é¡¹ã€‚ compilerOptions é€‰é¡¹&#123; &quot;compilerOptions&quot;: &#123; /* åŸºæœ¬é€‰é¡¹ */ &quot;target&quot;: &quot;es5&quot;, // æŒ‡å®š ECMAScript ç›®æ ‡ç‰ˆæœ¬: &#x27;ES3&#x27; (default), &#x27;ES5&#x27;, &#x27;ES6&#x27;/&#x27;ES2015&#x27;, &#x27;ES2016&#x27;, &#x27;ES2017&#x27;, or &#x27;ESNEXT&#x27; &quot;module&quot;: &quot;commonjs&quot;, // æŒ‡å®šä½¿ç”¨æ¨¡å—: &#x27;commonjs&#x27;, &#x27;amd&#x27;, &#x27;system&#x27;, &#x27;umd&#x27; or &#x27;es2015&#x27; &quot;lib&quot;: [], // æŒ‡å®šè¦åŒ…å«åœ¨ç¼–è¯‘ä¸­çš„åº“æ–‡ä»¶ &quot;allowJs&quot;: true, // å…è®¸ç¼–è¯‘ javascript æ–‡ä»¶ &quot;checkJs&quot;: true, // æŠ¥å‘Š javascript æ–‡ä»¶ä¸­çš„é”™è¯¯ &quot;jsx&quot;: &quot;preserve&quot;, // æŒ‡å®š jsx ä»£ç çš„ç”Ÿæˆ: &#x27;preserve&#x27;, &#x27;react-native&#x27;, or &#x27;react&#x27; &quot;declaration&quot;: true, // ç”Ÿæˆç›¸åº”çš„ &#x27;.d.ts&#x27; æ–‡ä»¶ &quot;sourceMap&quot;: true, // ç”Ÿæˆç›¸åº”çš„ &#x27;.map&#x27; æ–‡ä»¶ &quot;outFile&quot;: &quot;./&quot;, // å°†è¾“å‡ºæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶ &quot;outDir&quot;: &quot;./&quot;, // æŒ‡å®šè¾“å‡ºç›®å½• &quot;rootDir&quot;: &quot;./&quot;, // ç”¨æ¥æ§åˆ¶è¾“å‡ºç›®å½•ç»“æ„ --outDir. &quot;removeComments&quot;: true, // åˆ é™¤ç¼–è¯‘åçš„æ‰€æœ‰çš„æ³¨é‡Š &quot;noEmit&quot;: true, // ä¸ç”Ÿæˆè¾“å‡ºæ–‡ä»¶ &quot;importHelpers&quot;: true, // ä» tslib å¯¼å…¥è¾…åŠ©å·¥å…·å‡½æ•° &quot;isolatedModules&quot;: true, // å°†æ¯ä¸ªæ–‡ä»¶åšä¸ºå•ç‹¬çš„æ¨¡å— ï¼ˆä¸ &#x27;ts.transpileModule&#x27; ç±»ä¼¼ï¼‰. /* ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥é€‰é¡¹ */ &quot;strict&quot;: true, // å¯ç”¨æ‰€æœ‰ä¸¥æ ¼ç±»å‹æ£€æŸ¥é€‰é¡¹ &quot;noImplicitAny&quot;: true, // åœ¨è¡¨è¾¾å¼å’Œå£°æ˜ä¸Šæœ‰éšå«çš„ anyç±»å‹æ—¶æŠ¥é”™ &quot;strictNullChecks&quot;: true, // å¯ç”¨ä¸¥æ ¼çš„ null æ£€æŸ¥ &quot;noImplicitThis&quot;: true, // å½“ this è¡¨è¾¾å¼å€¼ä¸º any ç±»å‹çš„æ—¶å€™ï¼Œç”Ÿæˆä¸€ä¸ªé”™è¯¯ &quot;alwaysStrict&quot;: true, // ä»¥ä¸¥æ ¼æ¨¡å¼æ£€æŸ¥æ¯ä¸ªæ¨¡å—ï¼Œå¹¶åœ¨æ¯ä¸ªæ–‡ä»¶é‡ŒåŠ å…¥ &#x27;use strict&#x27; /* é¢å¤–çš„æ£€æŸ¥ */ &quot;noUnusedLocals&quot;: true, // æœ‰æœªä½¿ç”¨çš„å˜é‡æ—¶ï¼ŒæŠ›å‡ºé”™è¯¯ &quot;noUnusedParameters&quot;: true, // æœ‰æœªä½¿ç”¨çš„å‚æ•°æ—¶ï¼ŒæŠ›å‡ºé”™è¯¯ &quot;noImplicitReturns&quot;: true, // å¹¶ä¸æ˜¯æ‰€æœ‰å‡½æ•°é‡Œçš„ä»£ç éƒ½æœ‰è¿”å›å€¼æ—¶ï¼ŒæŠ›å‡ºé”™è¯¯ &quot;noFallthroughCasesInSwitch&quot;: true, // æŠ¥å‘Š switch è¯­å¥çš„ fallthrough é”™è¯¯ã€‚ï¼ˆå³ï¼Œä¸å…è®¸ switch çš„ case è¯­å¥è´¯ç©¿ï¼‰ /* æ¨¡å—è§£æé€‰é¡¹ */ &quot;moduleResolution&quot;: &quot;node&quot;, // é€‰æ‹©æ¨¡å—è§£æç­–ç•¥ï¼š &#x27;node&#x27; (Node.js) or &#x27;classic&#x27; (TypeScript pre-1.6) &quot;baseUrl&quot;: &quot;./&quot;, // ç”¨äºè§£æéç›¸å¯¹æ¨¡å—åç§°çš„åŸºç›®å½• &quot;paths&quot;: &#123;&#125;, // æ¨¡å—ååˆ°åŸºäº baseUrl çš„è·¯å¾„æ˜ å°„çš„åˆ—è¡¨ &quot;rootDirs&quot;: [], // æ ¹æ–‡ä»¶å¤¹åˆ—è¡¨ï¼Œå…¶ç»„åˆå†…å®¹è¡¨ç¤ºé¡¹ç›®è¿è¡Œæ—¶çš„ç»“æ„å†…å®¹ &quot;typeRoots&quot;: [], // åŒ…å«ç±»å‹å£°æ˜çš„æ–‡ä»¶åˆ—è¡¨ &quot;types&quot;: [], // éœ€è¦åŒ…å«çš„ç±»å‹å£°æ˜æ–‡ä»¶ååˆ—è¡¨ &quot;allowSyntheticDefaultImports&quot;: true, // å…è®¸ä»æ²¡æœ‰è®¾ç½®é»˜è®¤å¯¼å‡ºçš„æ¨¡å—ä¸­é»˜è®¤å¯¼å…¥ã€‚ /* Source Map Options */ &quot;sourceRoot&quot;: &quot;./&quot;, // æŒ‡å®šè°ƒè¯•å™¨åº”è¯¥æ‰¾åˆ° TypeScript æ–‡ä»¶è€Œä¸æ˜¯æºæ–‡ä»¶çš„ä½ç½® &quot;mapRoot&quot;: &quot;./&quot;, // æŒ‡å®šè°ƒè¯•å™¨åº”è¯¥æ‰¾åˆ°æ˜ å°„æ–‡ä»¶è€Œä¸æ˜¯ç”Ÿæˆæ–‡ä»¶çš„ä½ç½® &quot;inlineSourceMap&quot;: true, // ç”Ÿæˆå•ä¸ª soucemaps æ–‡ä»¶ï¼Œè€Œä¸æ˜¯å°† sourcemaps ç”Ÿæˆä¸åŒçš„æ–‡ä»¶ &quot;inlineSources&quot;: true, // å°†ä»£ç ä¸ sourcemaps ç”Ÿæˆåˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œè¦æ±‚åŒæ—¶è®¾ç½®äº† --inlineSourceMap æˆ– --sourceMap å±æ€§ /* å…¶ä»–é€‰é¡¹ */ &quot;experimentalDecorators&quot;: true, // å¯ç”¨è£…é¥°å™¨ &quot;emitDecoratorMetadata&quot;: true // ä¸ºè£…é¥°å™¨æä¾›å…ƒæ•°æ®çš„æ”¯æŒ &#125;&#125; å‚è€ƒtypescript","updated":"2025-08-02T05:46:04.175Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"typescript","slug":"typescript","permalink":"https://luckyship.github.io/tags/typescript/"}]},{"title":"angular7åŸºç¡€","date":"2021-05-12T14:24:02.000Z","path":"2021/05/12/2021-05-12-angular7-base/","text":"å¼€å§‹å‡†å¤‡ å®‰è£… nodejs npm -v å®‰è£…@angular/cli npm i -g @angular/cli CLI å‘½ä»¤å»ºç«‹é¡¹ç›® ng new ng7demo é€‰æ‹©æ˜¯å¦åŠ å…¥è·¯ç”±æ¨¡å—ä»¥åŠå“ªç§ css é¢„å¤„ç†å™¨ å¯ ctrl+c å–æ¶ˆè‡ªåŠ¨å®‰è£… node_modulesï¼Œæ‰‹åŠ¨è¿›å…¥é¡¹ç›® npm installnode-sass å®‰è£…ä¸ä¸Šå¯åˆ‡æ¢æ·˜å®é•œåƒåº“æˆ–è€…ç”¨ cnpm å®‰è£… npm config set registry https://registry.npm.taobao.orgnpm install or npm install -g cnpmcnpm install å¯åŠ¨é¡¹ç›® ng serve --open // è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ http://localhost:4200/ è¯­æ³•ç”Ÿæˆç»„ä»¶// æ ‡ç­¾app-article å¦‚æœä¸æƒ³è¦æˆ–è€…è‡ªå®šä¹‰å‰ç¼€å¯åœ¨angular.jsoné‡Œä¿®æ”¹prefixå±æ€§ng generate component article// å¯æ·»åŠ ç›®å½•ng generate service ./serveices/eventBus// ç»„ä»¶å¼•ç”¨// æ ‡ç­¾æ–¹å¼å¼•ç”¨&lt;app-article&gt;&lt;/app-article&gt;// å±æ€§æ–¹å¼å¼•ç”¨&lt;div app-article&gt;&lt;/div&gt;// ç±»æ–¹å¼å¼•ç”¨&lt;div class=&quot;app-article&quot;&gt;&lt;/div&gt; // @Componentè£…é¥°å™¨æ ‡è¯†è¿™æ˜¯ä¸€ä¸ªç»„ä»¶@Component(&#123; //selector: &#x27;app-article&#x27;, //selector: &#x27;[app-article]&#x27;, //å±æ€§æ–¹å¼ selector: &#x27;.app-article&#x27;, //ç±»æ–¹å¼ templateUrl: &#x27;./article.component.html&#x27;, styleUrls: [&#x27;./article.component.css&#x27;]&#125;) æ’å€¼è¡¨è¾¾å¼å°†ä¸šåŠ¡é€»è¾‘ä¸­çš„æ•°æ®é€šè¿‡æ’å€¼è¡¨è¾¾å¼æ˜¾ç¤ºåœ¨æ¨¡æ¿æ–‡ä»¶ï¼Œå³ html é¡µé¢ä¸Šï¼Œæˆ–è€…å°† html é¡µé¢ä¸Šçš„äº‹ä»¶ä¼ è¾“åˆ°ä¸šåŠ¡é€»è¾‘ã€‚ &lt;p&gt;æ ‡é¢˜æ˜¯&#123;&#123;title&#125;&#125;&lt;/p&gt; å±æ€§ç»‘å®š&lt;img [src]=&quot;imgSrc&quot; /&gt;&lt;input value=&quot;value&quot; /&gt; æ’å€¼è¿ç®— åŠ å‡ä¹˜é™¤/å­—ç¬¦ä¸²æ‹¼æ¥/ä¸‰å…ƒ/æ–¹æ³•è°ƒç”¨&#123;&#123;5+3&#125;&#125;,&#123;&#123;5-3&#125;&#125;,&#123;&#123;5*3&#125;&#125;,&#123;&#123;5/3&#125;&#125;,&#123;&#123; &quot;a&quot; + &quot;b&quot;&#125;&#125;,&#123;&#123;true?1:0&#125;&#125; äº‹ä»¶ç»‘å®š&lt;button (click)=&quot;showModal(&#x27;click&#x27;)&quot;&gt;&lt;/button&gt;&lt;!-- ä¼ é€’äº‹ä»¶å‚æ•° --&gt;&lt;input type=&quot;text&quot; (keyup)=&quot;updateContent($event)&quot; /&gt;&lt;!-- åŒå‘ç»‘å®š è§†å›¾å’Œæ•°æ®ï¼Œåªè¦ä¸€æ–¹å‘ç”Ÿå˜åŒ–ï¼Œå¦ä¸€æ–¹è·Ÿç€å˜åŒ–ã€‚ --&gt;&lt;!-- ä¸éœ€è¦åœ¨ä»£ç ä¸­æ‰‹åŠ¨æ›´æ–°è§†å›¾ï¼Œç®€åŒ–å¼€å‘ï¼Œå¢åŠ ä»£ç å†…èšæ€§ï¼Œä»£ç å¯è¯»æ€§æ›´å¼ºã€‚ --&gt;&lt;input type=&quot;text&quot; [(ngModel)]=&quot;title&quot; /&gt;&lt;!-- ä¸ºäº†ngModelèƒ½å¤Ÿè§£æéœ€è¦å¼•å…¥ import &#123;FormsModule&#125; from &quot;@angular/forms&quot;; --&gt; æ¨¡æ¿æŒ‡ä»¤åˆ¤æ–­æŒ‡ä»¤&lt;img *ngIf=&quot;imgShow;else #p1&quot; /&gt;&lt;p #p1&gt;&lt;/p&gt; æ ·å¼æŒ‡ä»¤&lt;p [ngClass]=&quot;&#123;bg:true&#125;&quot;&gt;è¿™æ®µå†…å®¹åº”ç”¨çš„æ˜¯ç±»æ ·å¼ã€‚&lt;/p&gt;&lt;p [ngStyle]=&quot;&#123;backgroundColor:pink&#125;&quot;&gt;æœ¬æ®µå†…å®¹æ ·å¼æ˜¯å†…è”æ ·å¼ã€‚&lt;/p&gt; å¾ªç¯æŒ‡ä»¤&lt;ul&gt; &lt;li *ngFor=&quot;let race of raceList; let i = index; let l = last&quot;&gt;&#123;&#123; race.name &#125;&#125;-&#123;&#123; i + 1 &#125;&#125;&lt;/li&gt;&lt;/ul&gt; å±æ€§ è¯´æ˜ $implicit: T å£°æ˜åœ¨æ„é€ å‡½æ•°ä¸­ ngForOf: U å£°æ˜åœ¨æ„é€ å‡½æ•°ä¸­ index: number å£°æ˜åœ¨æ„é€ å‡½æ•°ä¸­ count: number å£°æ˜åœ¨æ„é€ å‡½æ•°ä¸­ first: boolean åªè¯» last: boolean åªè¯» even: boolean åªè¯» odd: boolean åªè¯» ç®¡é“ç¬¦&#123;&#123;currentTime | date: &quot;yyyy-MM-dd HH:mm:ss&quot; &#125;&#125; åœ¨ ts ä¸­çš„ç”¨æ³•import &#123; DatePipe &#125; from &#x27;@angular/common&#x27;;constructor(private datePipe: DatePipe) &#123;&#125;this.datePipe.transform() è‡ªå®šä¹‰ç®¡é“ng generate pipe search ä¸ºäº†èŠ‚çœæ€§èƒ½ï¼Œangular å†…éƒ¨å¯¹ç®¡é“è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå‚æ•° pure ä¸º true æ—¶(çº¯ç®¡é“)ï¼Œå½“åªæœ‰æ•°æ®å˜åŒ–æ—¶ï¼Œæ‰ä¼šè§¦å‘ç®¡é“çš„æ‰§è¡Œï¼ŒåŸºäºè¿™æ ·çš„æœºåˆ¶ï¼Œangular ç®¡é“æ— æ³•æ£€æµ‹åˆ°æ•°ç»„ï¼Œå¯¹è±¡è¿™æ ·å¤æ‚æ•°æ®ç±»å‹çš„å€¼çš„å˜åŒ–ï¼Œæ‰€ä»¥é’ˆå¯¹è¿™æ ·çš„æ•°æ® pure åº”è®¾ä¸º false(éçº¯ç®¡é“) @Pipe(&#123; name: &quot;flyingHeroesImpure&quot;, pure: false,&#125;)export class FlyingHeroesImpurePipe extends FlyingHeroesPipe &#123;&#125; å‚è€ƒ å†…ç½®ç®¡é“ ç®¡é“å ç”¨é€” date æ—¥æœŸç®¡é“ï¼Œæ ¼å¼åŒ–æ—¥æœŸ json(éçº¯ç®¡é“) å°†è¾“å…¥æ•°æ®å¯¹è±¡ç»è¿‡ï¼ŒJSON.stringify()æ–¹æ³•è½¬æ¢åè¾“å‡ºå¯¹è±¡çš„å­—ç¬¦ä¸² uppercase å°†æ–‡æœ¬æ‰€æœ‰å°å†™å­—æ¯è½¬æ¢æˆå¤§å†™å­—æ¯ lowercase å°†æ–‡æœ¬æ‰€æœ‰å¤§å†™å­—æ¯è½¬æ¢æˆå°å†™å­—æ¯ number å°†æ•°å€¼æŒ‰ç‰¹å®šçš„æ ¼å¼æ˜¾ç¤ºæ–‡æœ¬ percent å°†æ•°å€¼è½¬ç™¾åˆ†æ¯”æ ¼å¼ currentcy å°†æ•°å€¼è¿›è¡Œè´§å¸æ ¼å¼åŒ–å¤„ç† slice(éçº¯ç®¡é“) å°†æ•°ç»„æˆ–è€…å­—ç¬¦ä¸²è£å‰ªæˆæ–°å­é›† i18n ç¿»è¯‘ç®¡é“ ç»„ä»¶æ³¨å†Œ declarations: å£°æ˜è¯¥æ¨¡å—ä¸­æ‹¥æœ‰å“ªäº›ç»„ä»¶ã€æŒ‡ä»¤å’Œç®¡é“ã€‚è¿™äº›ç»„ä»¶ç­‰éƒ½æ˜¯è¯¥æ¨¡å—ä¸­çš„å±€éƒ¨ç»„ä»¶ã€‚ imports: å£°æ˜è¯¥æ¨¡å—æ‰€ä¾èµ–çš„å…¶ä»–æ¨¡å—ã€‚åœ¨è¯¥æ¨¡å—ä¸­ä½¿ç”¨äº†å…¶ä»–æ¨¡å—å¯¼å‡ºçš„ç»„ä»¶ã€æŒ‡ä»¤å’ŒæœåŠ¡æ—¶ï¼Œå¿…é¡»å…ˆå°†è¿™äº›æ¨¡å—å¼•å…¥è¿›æ¥ã€‚ exports: å£°æ˜è¯¥æ¨¡å—ä¸­å¯è¢«å¤–éƒ¨è®¿é—®çš„ç»„ä»¶ã€æŒ‡ä»¤å’Œç®¡é“ã€‚è¿™äº›ç»„ä»¶ç­‰éƒ½æ˜¯è¯¥æ¨¡å—ä¸­çš„å…¨å±€ç»„ä»¶ã€‚ providers: å£°æ˜è¯¥æ¨¡å—ä¸­æä¾›çš„æœåŠ¡ã€‚è¿™äº›æœåŠ¡å¯ä»¥è¢«è¯¥æ¨¡å—ä»¥åŠè¯¥æ¨¡å—æ‰€ä¾èµ–çš„å…¶ä»–æ¨¡å—ä½¿ç”¨ã€‚ bootstrap: å£°æ˜è¯¥æ¨¡å—çš„æ ¹ç»„ä»¶ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œåªæœ‰åº”ç”¨çš„æ ¹æ¨¡å—æ‰ä¼šè®¾ç½®è¯¥å±æ€§ã€‚ import &#123; BrowserModule &#125; from &quot;@angular/platform-browser&quot;;import &#123; NgModule &#125; from &quot;@angular/core&quot;;import &#123; AppRoutingModule &#125; from &quot;./app-routing.module&quot;;import &#123; AppComponent &#125; from &quot;./app.component&quot;;@NgModule(&#123; declarations: [AppComponent], imports: [BrowserModule, AppRoutingModule], providers: [], bootstrap: [AppComponent],&#125;)export class AppModule &#123;&#125; é˜²æŠ–æ–¹æ³•å®ç°withRefresh = false;packages$!: Observable&lt;NpmPackageInfo[]&gt;;private searchText$ = new Subject&lt;string&gt;();search(packageName: string) &#123; this.searchText$.next(packageName);&#125;ngOnInit() &#123; this.packages$ = this.searchText$.pipe( debounceTime(500), distinctUntilChanged(), switchMap(packageName =&gt; this.searchService.search(packageName, this.withRefresh)) );&#125;constructor(private searchService: PackageSearchService) &#123; &#125; searchText$ æ˜¯æ¥è‡ªç”¨æˆ·çš„æœç´¢æ¡†å€¼çš„åºåˆ—ã€‚å®ƒè¢«å®šä¹‰ä¸º RxJS Subject ç±»å‹ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªå¤šæ’­ Observableï¼Œå®ƒè¿˜å¯ä»¥é€šè¿‡è°ƒç”¨ next(value) æ¥è‡ªè¡Œå‘å‡ºå€¼ï¼Œå°±åƒåœ¨ search() æ–¹æ³•ä¸­ä¸€æ ·ã€‚ é™¤äº†æŠŠæ¯ä¸ª searchText çš„å€¼éƒ½ç›´æ¥è½¬å‘ç»™ PackageSearchService ä¹‹å¤–ï¼ŒngOnInit() ä¸­çš„ä»£ç è¿˜é€šè¿‡ä¸‹åˆ—ä¸‰ä¸ªæ“ä½œç¬¦å¯¹è¿™äº›æœç´¢å€¼è¿›è¡Œç®¡é“å¤„ç†ï¼Œä»¥ä¾¿åªæœ‰å½“å®ƒæ˜¯ä¸€ä¸ªæ–°å€¼å¹¶ä¸”ç”¨æˆ·å·²ç»åœæ­¢è¾“å…¥æ—¶ï¼Œè¦æœç´¢çš„å€¼æ‰ä¼šæŠµè¾¾è¯¥æœåŠ¡ã€‚ debounceTime(500)â â€”ç­‰å¾…ç”¨æˆ·åœæ­¢è¾“å…¥ï¼ˆæœ¬ä¾‹ä¸­ä¸º 1/2 ç§’ï¼‰ã€‚ distinctUntilChanged()â â€”ç­‰å¾…æœç´¢æ–‡æœ¬å‘ç”Ÿå˜åŒ–ã€‚ switchMap()â â€”å°†æœç´¢è¯·æ±‚å‘é€åˆ°æœåŠ¡ã€‚ çˆ¶å­ç»„ä»¶é€šä¿¡Inputã€Output ä¼ å€¼// è¾“å…¥&lt;child title = &quot;æˆ‘çš„å­ç»„ä»¶&quot;&gt; &lt;/child&gt;@Inputpublic title: string = &quot;&quot;;// è¾“å‡º&lt;child title=&quot;æˆ‘çš„å­ç»„ä»¶&quot; (follow)=&quot;getFollow($event)&quot; #child &gt;&lt;/child&gt;@Output()public follow = new EventEmitter();this.follow.emit(&quot;å­ç»„ä»¶ä¼ æ¥çš„æ•°æ®&quot;); æœåŠ¡æ€»çº¿ æ³¨å†ŒæœåŠ¡ ng g s ./services/eventBus import &#123; Injectable&#125; from &quot;@angular/core&quot;;import &#123; Observable, Subject&#125; from &quot;rxjs&quot;;// æœåŠ¡æ€»çº¿ ç»„ä»¶é—´åˆ†äº«æ•°æ®@Injectable(&#123; providedIn: &quot;root&quot; // åœ¨æ‰€æœ‰ç»„ä»¶å…±äº«æ•°æ®&#125;)export class EventBusService &#123; public eventBus: Subject &lt; string &gt; = new Subject(); constructor() &#123;&#125;&#125; service ä¹Ÿå¯ä»¥æŒ‡å®šåœ¨æŸä¸ªæŸå—ç”Ÿæ•ˆï¼Œæ¯”å¦‚ä¸‹æ–¹ service å°±åªåœ¨UserModuleä¸­ç”Ÿæ•ˆ import &#123; Injectable &#125; from &quot;@angular/core&quot;;import &#123; UserModule &#125; from &quot;./user.module&quot;;@Injectable(&#123; providedIn: UserModule,&#125;)export class UserService &#123;&#125; ç»„ä»¶å†…å‘å°„æ•°æ® this.eventBusService.eventBus.next(&quot;childç»„ä»¶å‘é€çš„æ•°æ®&quot;); ç»„ä»¶æ¥æ”¶æ•°æ® this.eventBusService.eventBus.subscribe((arg) =&gt; &#123; console.log(`æ¥æ”¶åˆ°äº‹ä»¶$&#123;arg&#125;`);&#125;); æ ‡ç­¾å˜é‡å¼•ç”¨&lt;child title=&quot;æˆ‘çš„å­ç»„ä»¶&quot; #child (follow)=&quot;getFollow($event)&quot;&gt;&lt;/child&gt;&lt;button (click)=&quot;child.sayHello()&quot;&gt;å­ç»„ä»¶è¯´è¯&lt;/button&gt; è·¯ç”±å¯¼èˆªimport &#123; NgModule &#125; from &quot;@angular/core&quot;;import &#123; Routes, RouterModule &#125; from &quot;@angular/router&quot;;import &#123; ChildComponent &#125; from &quot;./child/child.component&quot;;import &#123; BrotherComponent &#125; from &quot;./brother/brother.component&quot;;const routes: Routes = [ &#123; path: &quot;&quot;, component: ChildComponent, &#125;, &#123; path: &quot;brother&quot;, component: BrotherComponent, &#125;,];@NgModule(&#123; imports: [RouterModule.forRoot(routes)], exports: [RouterModule],&#125;)export class AppRoutingModule &#123;&#125; &lt;!-- RouterOutlet ç›¸å½“äºä¸€ä¸ªå ä½ç¬¦, åœ¨Angularä¸­æ ¹æ®è·¯ç”±çŠ¶æ€åŠ¨æ€æ’å…¥è§†å›¾ --&gt;&lt;a [routerLink]=&quot;[&#x27;/&#x27;]&quot;&gt; child &lt;/a&gt;&lt;br /&gt;&lt;a [routerLink]=&quot;[&#x27;/brother&#x27;]&quot;&gt; brother &lt;/a&gt;&lt;router-outlet&gt;&lt;/router-outlet&gt; è·¯ç”±æ‡’åŠ è½½ä½¿ç”¨loadChildrenå¯ä»¥é…ç½®è·¯ç”±æ‡’åŠ è½½ const routes: Routes = [ &#123; path: &quot;items&quot;, loadChildren: () =&gt; import(&quot;./items/items.module&quot;).then((m) =&gt; m.ItemsModule), &#125;,]; http æœåŠ¡// app.module.tsimport &#123; HttpModule &#125; from &quot;@angular/http&quot;;import &#123; HttpClientModule &#125; from &quot;@angular/common/http&quot;;// servicesimport &#123; Headers &#125; from &quot;@angular/http&quot;;import &#123; HttpClient, HttpResponse &#125; from &quot;@angular/common/http&quot;;this.httpClient.request(UserService.METHOD_POST, url, options).subscribe( (next) =&gt; &#123;&#125;, (error) =&gt; &#123;&#125;, (complete) =&gt; &#123;&#125; // æŒ‡nextå®Œæˆåï¼Œä¼šæ‰§è¡Œcomplete, å¹¶ä¸æ˜¯finallyçš„æ„æ€); å¦‚æœæƒ³ä½¿ç”¨asyncè¯­æ³•ï¼Œå¯ä»¥æŠŠangularè§‚å¯Ÿå¯¹è±¡è½¬æˆpromise this.httpClient.request(UserService.METHOD_POST, url, options).toPromise(); é›†ä¸­å¤„ç† http çš„ errorclass MyErrorHandler implements ErrorHandler &#123; handleError(error) &#123; // do something with the exception &#125;&#125;@NgModule(&#123; providers: [&#123; provide: ErrorHandler, useClass: MyErrorHandler &#125;],&#125;)class MyModule &#123;&#125; å‚è€ƒ angular é€šè¿‡ ip è®¿é—®ç»‘å®šåˆ°0.0.0.0ä¸Š # ng serve --host 0.0.0.0 --port 4200 angular.json// angular.json&quot;budgets&quot;: [&#123; &quot;type&quot;: &quot;initial&quot;, &quot;maximumWarning&quot;: &quot;2mb&quot;, &quot;maximumError&quot;: &quot;5mb&quot;&#125;]// è¿™ä¸ªé…ç½®é€‚ç”¨äºæ‰“åŒ…æ–‡ä»¶é™åˆ¶ ng build --prod// æ‰“åŒ…ç”Ÿæˆç”Ÿäº§ç¯å¢ƒæ—¶å¦‚æœåŒ…å¤§äº2MB,é‚£ä¹ˆCLIå·¥å…·ä¼šæç¤ºwaning,å¦‚æœå¤§äº5MB,ä¸­æ–­æ‰“åŒ…ã€‚&#123; &quot;project&quot;: &#123; &quot;name&quot;: &quot;ng-admin&quot;, //é¡¹ç›®åç§° &quot;ejected&quot;: false // æ ‡è®°è¯¥åº”ç”¨æ˜¯å¦å·²ç»æ‰§è¡Œè¿‡ejectå‘½ä»¤æŠŠwebpacké…ç½®é‡Šæ”¾å‡ºæ¥ &#125;, &quot;apps&quot;: [ &#123; &quot;root&quot;: &quot;src&quot;, // æºç æ ¹ç›®å½• &quot;outDir&quot;: &quot;dist&quot;, // ç¼–è¯‘åçš„è¾“å‡ºç›®å½•ï¼Œé»˜è®¤æ˜¯dist/ &quot;assets&quot;: [ // è®°å½•èµ„æºæ–‡ä»¶å¤¹ï¼Œæ„å»ºæ—¶å¤åˆ¶åˆ°`outDir`æŒ‡å®šçš„ç›®å½• &quot;assets&quot;, &quot;favicon.ico&quot; ], &quot;index&quot;: &quot;index.html&quot;, // æŒ‡å®šé¦–é¡µæ–‡ä»¶ï¼Œé»˜è®¤å€¼æ˜¯&quot;index.html&quot; &quot;main&quot;: &quot;main.ts&quot;, // æŒ‡å®šåº”ç”¨çš„å…¥é—¨æ–‡ä»¶ &quot;polyfills&quot;: &quot;polyfills.ts&quot;, // æŒ‡å®špolyfillæ–‡ä»¶ &quot;test&quot;: &quot;test.ts&quot;, // æŒ‡å®šæµ‹è¯•å…¥é—¨æ–‡ä»¶ &quot;tsconfig&quot;: &quot;tsconfig.app.json&quot;, // æŒ‡å®štsconfigæ–‡ä»¶ &quot;testTsconfig&quot;: &quot;tsconfig.spec.json&quot;, // æŒ‡å®šTypeScriptå•æµ‹è„šæœ¬çš„tsconfigæ–‡ä»¶ &quot;tsconfig&quot;: &quot;tsconfig.app.json&quot;, &quot;prefix&quot;: &quot;app&quot;, // ä½¿ç”¨`ng generate`å‘½ä»¤æ—¶ï¼Œè‡ªåŠ¨ä¸ºselectorå…ƒæ•°æ®çš„å€¼æ·»åŠ çš„å‰ç¼€å &quot;deployUrl&quot;: &quot;//cdn.com.cn&quot;, // æŒ‡å®šç«™ç‚¹çš„éƒ¨ç½²åœ°å€ï¼Œè¯¥å€¼æœ€ç»ˆä¼šèµ‹ç»™webpackçš„output.publicPathï¼Œå¸¸ç”¨äºCDNéƒ¨ç½² &quot;styles&quot;: [ // å¼•å…¥å…¨å±€æ ·å¼ï¼Œæ„å»ºæ—¶ä¼šæ‰“åŒ…è¿›æ¥ï¼Œå¸¸ç”¨äºç¬¬ä¸‰æ–¹åº“å¼•å…¥çš„æ ·å¼ &quot;styles.css&quot; ], &quot;scripts&quot;: [ // å¼•å…¥å…¨å±€è„šæœ¬ï¼Œæ„å»ºæ—¶ä¼šæ‰“åŒ…è¿›æ¥ï¼Œå¸¸ç”¨è¯­ç¬¬ä¸‰æ–¹åº“å¼•å…¥çš„è„šæœ¬ ], &quot;environmentSource&quot;: &quot;environments/environment.ts&quot;, // åŸºç¡€ç¯å¢ƒé…ç½® &quot;environments&quot;: &#123; // å­ç¯å¢ƒé…ç½®æ–‡ä»¶ &quot;dev&quot;: &quot;environments/environment.ts&quot;, &quot;prod&quot;: &quot;environments/environment.prod.ts&quot; &#125; &#125; ], &quot;e2e&quot;: &#123; &quot;protractor&quot;: &#123; &quot;config&quot;: &quot;./protractor.conf.js&quot; &#125; &#125;, &quot;lint&quot;: [ &#123; &quot;project&quot;: &quot;src/tsconfig.app.json&quot; &#125;, &#123; &quot;project&quot;: &quot;src/tsconfig.spec.json&quot; &#125;, &#123; &quot;project&quot;: &quot;e2e/tsconfig.e2e.json&quot; &#125; ], &quot;test&quot;: &#123; &quot;karma&quot;: &#123; &quot;config&quot;: &quot;./karma.conf.js&quot; &#125; &#125;, &quot;defaults&quot;: &#123; // æ‰§è¡Œ`ng generate`å‘½ä»¤æ—¶çš„ä¸€äº›é»˜è®¤å€¼ &quot;styleExt&quot;: &quot;scss&quot;, // é»˜è®¤ç”Ÿæˆçš„æ ·å¼æ–‡ä»¶åç¼€å &quot;component&quot;: &#123; &quot;flat&quot;: false, // ç”Ÿæˆç»„ä»¶æ—¶æ˜¯å¦æ–°å»ºæ–‡ä»¶å¤¹åŒ…è£…ç»„ä»¶æ–‡ä»¶ï¼Œé»˜è®¤ä¸ºfalseï¼ˆå³æ–°å»ºæ–‡ä»¶å¤¹ï¼‰ &quot;spec&quot;: true, // æ˜¯å¦ç”Ÿæˆspecæ–‡ä»¶ï¼Œé»˜è®¤ä¸ºtrue &quot;inlineStyle&quot;: false, // æ–°å»ºæ—¶æ˜¯å¦ä½¿ç”¨å†…è”æ ·å¼ï¼Œé»˜è®¤ä¸ºfalse &quot;inlineTemplate&quot;: false, // æ–°å»ºæ—¶æ˜¯å¦ä½¿ç”¨å†…è”æ¨¡æ¿ï¼Œé»˜è®¤ä¸ºfalse &quot;viewEncapsulation&quot;: &quot;Emulated&quot;, // æŒ‡å®šç”Ÿæˆçš„ç»„ä»¶çš„å…ƒæ•°æ®viewEncapsulationçš„é»˜è®¤å€¼ &quot;changeDetection&quot;: &quot;OnPush&quot; // æŒ‡å®šç”Ÿæˆçš„ç»„ä»¶çš„å…ƒæ•°æ®changeDetectionçš„é»˜è®¤å€¼ &#125; &#125;&#125; å®˜ç½‘å‚è€ƒ","updated":"2025-08-02T05:46:04.175Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"angular","slug":"angular","permalink":"https://luckyship.github.io/tags/angular/"}]},{"title":"æµè§ˆå™¨é¡µé¢æ¸²æŸ“è¿‡ç¨‹","date":"2021-05-12T14:13:17.000Z","path":"2021/05/12/2021-05-12-browser-render/","text":"æµè§ˆå™¨çš„æ¸²æŸ“æ–¹å¼ æ„å»º DOM æ ‘æµè§ˆå™¨è¯·æ±‚åˆ° html ä»£ç åï¼Œåœ¨ç”Ÿæˆ DOM çš„æœ€å¼€å§‹é˜¶æ®µï¼Œå¹¶è¡Œå‘èµ· cssã€å›¾ç‰‡ã€js çš„è¯·æ±‚ã€‚ï¼ˆè§£ç -&gt;ä»¤ç‰ŒåŒ–-&gt;è¯æ³•åˆ†æ-&gt;dom æ ‘åˆ›å»ºï¼‰ æ„å»º CSSOMcss æ–‡ä»¶åŠ è½½å®Œæˆï¼Œå¼€å§‹æ„å»º CSSOMï¼ˆCSSOM åªè¾“å‡ºåŒ…å«æœ‰æ ·å¼çš„èŠ‚ç‚¹ï¼‰ ç”Ÿæˆæ¸²æŸ“æ ‘ï¼ˆRender Treeï¼‰CSSOM æ„å»ºç»“æŸåï¼Œå’Œ DOM ä¸€èµ·ç”Ÿæˆ Render Tree è®¡ç®—æ¸²æŸ“æ ‘å¸ƒå±€ï¼ˆLayoutï¼‰æœ‰äº† Render Treeï¼Œæµè§ˆå™¨å·²ç»èƒ½çŸ¥é“ç½‘é¡µä¸­æœ‰å“ªäº›èŠ‚ç‚¹ï¼Œå„ä¸ªèŠ‚ç‚¹çš„ CSS å®šä¹‰ä»¥åŠä»–ä»¬çš„ä»å±å…³ç³»ã€‚ä¾ç…§ç›’å­æ¨¡å‹ï¼Œè®¡ç®—å‡ºæ¯ä¸ªèŠ‚ç‚¹åœ¨å±å¹•ä¸­çš„ä½ç½®åŠå°ºå¯¸ã€‚ å°†å¸ƒå±€ Paint ç»˜åˆ¶åˆ°å±å¹•ä¸Šå¸ƒå±€ä¹‹åï¼Œæµè§ˆå™¨çŸ¥é“å“ªäº›èŠ‚ç‚¹è¦æ˜¾ç¤ºï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„ CSS å±æ€§æ˜¯ä»€ä¹ˆï¼Œæ¯ä¸ªèŠ‚ç‚¹åœ¨å±å¹•ä¸­çš„ä½ç½®ã€‚æ‰€ä»¥æ¥ä¸‹æ¥æŒ‰ç…§ç®—å‡ºæ¥çš„è§„åˆ™ï¼Œé€šè¿‡æ˜¾å¡ï¼ŒæŠŠå†…å®¹ç”»åœ¨å±å¹•ä¸Šã€‚ é¡µé¢æ¸²æŸ“ä¼˜åŒ–é¿å… CSS é˜»å¡æ¸²æŸ“ï¼šç”±äº CSSOM è´Ÿè´£å­˜å‚¨æ¸²æŸ“ä¿¡æ¯ï¼Œæµè§ˆå™¨å°±å¿…é¡»ä¿è¯åœ¨åˆæˆæ¸²æŸ“æ ‘ä¹‹å‰ï¼ŒCSSOM æ˜¯å®Œå¤‡çš„ï¼Œè¿™ç§å®Œå¤‡æ˜¯æŒ‡æ‰€æœ‰çš„ CSSï¼ˆå†…è”ã€å†…éƒ¨å’Œå¤–éƒ¨ï¼‰éƒ½å·²ç»ä¸‹è½½å®Œï¼Œå¹¶è§£æå®Œï¼Œåªæœ‰ CSSOM å’Œ DOM çš„è§£æå®Œå…¨ç»“æŸï¼Œæµè§ˆå™¨æ‰ä¼šè¿›å…¥ä¸‹ä¸€æ­¥çš„æ¸²æŸ“ã€‚CSS é˜»å¡æ¸²æŸ“æ„å‘³ç€ï¼Œåœ¨ CSSOM å®Œå¤‡å‰ï¼Œé¡µé¢å°†ä¸€ç›´å¤„ç†ç™½å±çŠ¶æ€ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ ·å¼æ”¾åœ¨ head ä¸­ï¼Œä»…ä»…æ˜¯ä¸ºäº†æ›´å¿«çš„è§£æ CSSï¼Œä¿è¯æ›´å¿«çš„é¦–æ¬¡æ¸²æŸ“ã€‚ é¿å… JS é˜»å¡é¡µé¢ï¼šJS å¯ä»¥æ“ä½œ DOM æ¥ä¿®æ”¹ DOM ç»“æ„ï¼Œå¯ä»¥æ“ä½œ CSSOM æ¥ä¿®æ”¹èŠ‚ç‚¹æ ·å¼ï¼Œè¿™å°±å¯¼è‡´äº†æµè§ˆå™¨åœ¨è§£æ HTML æ—¶ï¼Œä¸€æ—¦ç¢°åˆ° scriptï¼Œå°±ä¼šç«‹å³åœæ­¢ HTML çš„è§£æï¼Œä¹Ÿé˜»å¡äº†å…¶åçš„ CSS è§£æï¼Œæ•´ä¸ªè§£æè¿›ç¨‹å¿…é¡»ç­‰å¾… JS çš„æ‰§è¡Œå®Œæˆæ‰èƒ½å¤Ÿç»§ç»­ã€‚ä»æ€§èƒ½è§’åº¦ä¸Šè®²ï¼Œå°† script æ”¾åœ¨é¡µé¢åº•éƒ¨ï¼Œä¹Ÿå°±åˆæƒ…åˆç†äº†ã€‚ å‡å°‘é‡ç»˜ï¼ˆ Repaint ï¼‰ï¼šå½“å„ç§ç›’å­çš„ä½ç½®ã€å¤§å°ä»¥åŠå…¶ä»–å±æ€§ï¼Œä¾‹å¦‚é¢œè‰²ã€å­—ä½“å¤§å°ç­‰éƒ½ç¡®å®šä¸‹æ¥åï¼Œæµè§ˆå™¨ä¾¿æŠŠè¿™äº›å…ƒç´ éƒ½æŒ‰ç…§å„è‡ªçš„ç‰¹æ€§ç»˜åˆ¶äº†ä¸€éï¼Œäºæ˜¯é¡µé¢çš„å†…å®¹å‡ºç°äº†ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸º repaintã€‚ é‡ç»˜(repaint): å½“å…ƒç´ æ ·å¼çš„æ”¹å˜ä¸å½±å“å¸ƒå±€æ—¶ï¼Œæµè§ˆå™¨å°†ä½¿ç”¨é‡ç»˜å¯¹å…ƒç´ è¿›è¡Œæ›´æ–°ï¼Œæ­¤æ—¶ç”±äºåªéœ€è¦ UI å±‚é¢çš„é‡æ–°åƒç´ ç»˜åˆ¶ï¼Œå› æ­¤ æŸè€—è¾ƒå°‘ã€‚ è§¦å‘é‡ç»˜ DOM æ”¹åŠ¨ CSS æ”¹åŠ¨ å‡å°‘é‡æ’ï¼ˆ Reflow ï¼‰ï¼šDOM ç»“æ„ä¸­çš„å„ä¸ªå…ƒç´ éƒ½æœ‰è‡ªå·±çš„ç›’å­ï¼ˆæ¨¡å‹ï¼‰ï¼Œè¿™äº›éƒ½éœ€è¦æµè§ˆå™¨æ ¹æ®å„ç§æ ·å¼æ¥è®¡ç®—å¹¶æ ¹æ®è®¡ç®—ç»“æœå°†å…ƒç´ æ”¾åˆ°å®ƒè¯¥å‡ºç°çš„ä½ç½®ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸º reflowã€‚ å›æµ(reflow): å½“å…ƒç´ çš„å°ºå¯¸ã€ç»“æ„æˆ–è§¦å‘æŸäº›å±æ€§æ—¶ï¼Œæµè§ˆå™¨ä¼šé‡æ–°æ¸²æŸ“é¡µé¢ï¼Œç§°ä¸ºå›æµã€‚æ­¤æ—¶ï¼Œæµè§ˆå™¨éœ€è¦é‡æ–°ç»è¿‡è®¡ç®—ï¼Œè®¡ç®—åè¿˜éœ€è¦é‡æ–°é¡µé¢å¸ƒå±€ï¼Œå› æ­¤æ˜¯è¾ƒé‡çš„æ“ä½œã€‚ è§¦å‘é‡æ’ å½“å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹DOMèŠ‚ç‚¹æ—¶ï¼Œä¼šå¯¼è‡´reflowæˆ–repaint å½“ç§»åŠ¨DOMçš„ä½ç½®ï¼Œæˆ–æ˜¯æ’å…¥åŠ¨ç”»çš„æ—¶å€™ å½“ä¿®æ”¹ CSS æ ·å¼çš„æ—¶å€™ å½“ Resize çª—å£çš„æ—¶å€™ï¼Œæˆ–æ˜¯æ»šåŠ¨çš„æ—¶å€™ å½“ä¿®æ”¹ç½‘é¡µçš„é»˜è®¤å­—ä½“æ—¶ é‡æ’å’Œé‡ç»˜çš„åŒºåˆ«ä»–ä»¬çš„åŒºåˆ«å¾ˆå¤§ï¼šå›æµå¿…å°†å¼•èµ·é‡ç»˜ï¼Œè€Œé‡ç»˜ä¸ä¸€å®šä¼šå¼•èµ·å›æµã€‚æ¯”å¦‚ï¼šåªæœ‰é¢œè‰²æ”¹å˜çš„æ—¶å€™å°±åªä¼šå‘ç”Ÿé‡ç»˜è€Œä¸ä¼šå¼•èµ·å›æµå½“é¡µé¢å¸ƒå±€å’Œå‡ ä½•å±æ€§æ”¹å˜æ—¶å°±éœ€è¦å›æµæ¯”å¦‚ï¼šæ·»åŠ æˆ–è€…åˆ é™¤å¯è§çš„ DOM å…ƒç´ ï¼Œå…ƒç´ ä½ç½®æ”¹å˜ï¼Œå…ƒç´ å°ºå¯¸æ”¹å˜â€”â€”è¾¹è·ã€å¡«å……ã€è¾¹æ¡†ã€å®½åº¦å’Œé«˜åº¦ï¼Œå†…å®¹æ”¹å˜ æœ€å°åŒ–é‡ç»˜å’Œé‡æ’ é¿å…é¢‘ç¹ä½¿ç”¨styleï¼Œè€Œæ˜¯é‡‡ç”¨ä¿®æ”¹classçš„æ–¹å¼ã€‚ æ‰¹é‡ä¿®æ”¹DOMï¼šä½¿ç”¨æ–‡æ¡£ç‰‡æ®µåˆ›å»ºä¸€ä¸ªå­æ ‘ï¼Œç„¶åå†æ‹·è´åˆ°æ–‡æ¡£ä¸­ï¼ˆdocument.fragmentï¼‰ä½¿ç”¨ createDocumentFragment è¿›è¡Œæ‰¹é‡çš„ DOM æ“ä½œã€‚ ç¼“å­˜å¸ƒå±€ä¿¡æ¯ å¯¹äº resizeã€scroll ç­‰è¿›è¡Œé˜²æŠ–/èŠ‚æµå¤„ç†ã€‚ åˆ›å»ºåŠ¨ç”»æˆ–è€…ç§»åŠ¨å…ƒç´ ä½ç½®æ—¶å°½é‡ä½¿ç”¨transform: translate ä½¿ç”¨å­—ä½“å›¾æ ‡ iconfont ä»£æ›¿å›¾ç‰‡å›¾æ ‡ï¼šå›¾ç‰‡ä¼šå¢åŠ ç½‘ç»œè¯·æ±‚æ¬¡æ•°ï¼Œä»è€Œæ‹–æ…¢é¡µé¢åŠ è½½æ—¶é—´iconfont å¯ä»¥å¾ˆå¥½çš„ç¼©æ”¾å¹¶ä¸”ä¸ä¼šæ·»åŠ é¢å¤–çš„è¯·æ±‚ é™ä½ css é€‰æ‹©å™¨çš„å¤æ‚åº¦ï¼šæµè§ˆå™¨è¯»å–é€‰æ‹©å™¨ï¼Œéµå¾ªçš„åŸåˆ™æ˜¯ä»é€‰æ‹©å™¨çš„å³è¾¹åˆ°å·¦è¾¹è¯»å–ã€‚ å‡å°‘åµŒå¥—ï¼šæœ€å¤šä¸è¦è¶…è¿‡ä¸‰å±‚ï¼Œå¹¶ä¸”åä»£é€‰æ‹©å™¨çš„å¼€é”€è¾ƒé«˜ï¼Œæ…é‡ä½¿ç”¨ é¿å…ä½¿ç”¨é€šé…ç¬¦ï¼Œå¯¹ç”¨åˆ°çš„å…ƒç´ è¿›è¡ŒåŒ¹é…å³å¯ åˆ©ç”¨ç»§æ‰¿ï¼Œé¿å…é‡å¤åŒ¹é…å’Œå®šä¹‰ æ­£ç¡®ä½¿ç”¨ç±»é€‰æ‹©å™¨å’Œ id é€‰æ‹©å™¨","updated":"2025-08-02T05:46:04.175Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"only-childå’Œonly-of-typeåŒºåˆ«","date":"2021-05-06T06:45:11.000Z","path":"2021/05/06/2021-05-06-css-diff-only-of-type-and-only-child/","text":"only-childé€‰æ‹©å™¨:only-child é€‰æ‹©å™¨é€‰æ‹©çš„æ˜¯çˆ¶å…ƒç´ ä¸­åªæœ‰ä¸€ä¸ªå­å…ƒç´ ï¼Œè€Œä¸”åªæœ‰å”¯ä¸€çš„ä¸€ä¸ªå­å…ƒç´ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŒ¹é…çš„å…ƒç´ çš„çˆ¶å…ƒç´ ä¸­ä»…æœ‰ä¸€ä¸ªå­å…ƒç´ ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªå”¯ä¸€çš„å­å…ƒç´ ã€‚ only-of-typeé€‰æ‹©å™¨:only-of-type é€‰æ‹©å™¨ç”¨æ¥é€‰æ‹©ä¸€ä¸ªå…ƒç´ æ˜¯å®ƒçš„çˆ¶å…ƒç´ çš„å”¯ä¸€ä¸€ä¸ªç›¸åŒç±»å‹çš„å­å…ƒç´ ã€‚è¿™æ ·è¯´æˆ–è®¸ä¸å¤ªå¥½ç†è§£ï¼Œæ¢ä¸€ç§è¯´æ³•ã€‚ :only-of-type æ˜¯è¡¨ç¤ºä¸€ä¸ªå…ƒç´ ä»–æœ‰å¾ˆå¤šä¸ªå­å…ƒç´ ï¼Œè€Œå…¶ä¸­åªæœ‰ä¸€ç§ç±»å‹çš„å­å…ƒç´ æ˜¯å”¯ä¸€çš„ï¼Œä½¿ç”¨ :only-of-type é€‰æ‹©å™¨å°±å¯ä»¥é€‰ä¸­è¿™ä¸ªå…ƒç´ ä¸­çš„å”¯ä¸€ä¸€ä¸ªç±»å‹å­å…ƒç´ ã€‚ ç¤ºä¾‹&lt;style&gt; p:only-of-type &#123; background: #ff0000; &#125; p:only-child &#123; border: 5px solid blue; &#125;&lt;/style&gt;&lt;body&gt; &lt;div&gt; &lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæ®µè½ã€‚&lt;/p&gt; &lt;span&gt;123&lt;/span&gt; &lt;span&gt;123&lt;/span&gt; &lt;/div&gt; &lt;div&gt; &lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæ®µè½ã€‚&lt;/p&gt; &lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæ®µè½ã€‚&lt;/p&gt; &lt;/div&gt; &lt;div&gt; &lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæ®µè½ã€‚&lt;/p&gt; &lt;/div&gt;&lt;/body&gt;","updated":"2025-08-02T05:46:04.175Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"}]},{"title":"cssæ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼ˆBFCã€IFCï¼‰","date":"2021-05-06T03:49:52.000Z","path":"2021/05/06/2021-05-06-css-block-format-context/","text":"BFCFormatting context (æ ¼å¼åŒ–ä¸Šä¸‹æ–‡) æ˜¯ W3C CSS2.1 è§„èŒƒä¸­çš„ä¸€ä¸ªæ¦‚å¿µã€‚å®ƒæ˜¯é¡µé¢ä¸­çš„ä¸€å—æ¸²æŸ“åŒºåŸŸï¼Œå¹¶ä¸”æœ‰ä¸€å¥—æ¸²æŸ“è§„åˆ™ï¼Œå®ƒå†³å®šäº†å…¶å­å…ƒç´ å°†å¦‚ä½•å®šä½ï¼Œä»¥åŠå’Œå…¶ä»–å…ƒç´ çš„å…³ç³»å’Œç›¸äº’ä½œç”¨ã€‚ é‚£ä¹ˆ BFC æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ BFC å³ Block Formatting Contexts (å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡)ï¼Œå®ƒå±äºä¸Šè¿°å®šä½æ–¹æ¡ˆçš„æ™®é€šæµã€‚ å…·æœ‰ BFC ç‰¹æ€§çš„å…ƒç´ å¯ä»¥çœ‹ä½œæ˜¯éš”ç¦»äº†çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å…ƒç´ ä¸ä¼šåœ¨å¸ƒå±€ä¸Šå½±å“åˆ°å¤–é¢çš„å…ƒç´  ï¼Œå¹¶ä¸” BFC å…·æœ‰æ™®é€šå®¹å™¨æ‰€æ²¡æœ‰çš„ä¸€äº›ç‰¹æ€§ã€‚ é€šä¿—ä¸€ç‚¹æ¥è®²ï¼Œå¯ä»¥æŠŠ BFC ç†è§£ä¸ºä¸€ä¸ªå°é—­çš„å¤§ç®±å­ï¼Œç®±å­å†…éƒ¨çš„å…ƒç´ æ— è®ºå¦‚ä½•ç¿»æ±Ÿå€’æµ·ï¼Œéƒ½ä¸ä¼šå½±å“åˆ°å¤–éƒ¨ã€‚ åˆ›å»ºæ–°çš„å—æ ¼å¼ä¸Šä¸‹æ–‡åªè¦å…ƒç´ æ»¡è¶³ä¸‹é¢ä»»ä¸€æ¡ä»¶å³å¯è§¦å‘ BFC ç‰¹æ€§ï¼š body æ ¹å…ƒç´  æµ®åŠ¨å…ƒç´ ï¼šfloat é™¤ none ä»¥å¤–çš„å€¼ ç»å¯¹å®šä½å…ƒç´ ï¼šposition (absoluteã€fixed) display ä¸º inline-blockã€table-cellsã€flex overflow é™¤äº† visible ä»¥å¤–çš„å€¼ (hiddenã€autoã€scroll) è¿™å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºæ–°çš„ BFC çš„è¡Œä¸ºä¸æœ€å¤–å±‚çš„æ–‡æ¡£éå¸¸ç›¸ä¼¼ï¼Œå®ƒåœ¨ä¸»å¸ƒå±€ä¸­åˆ›é€ äº†ä¸€ä¸ªå°å¸ƒå±€ã€‚BFC åŒ…å«å…¶å†…éƒ¨çš„æ‰€æœ‰å†…å®¹ï¼Œfloat å’Œ clear ä»…é€‚ç”¨äºåŒä¸€æ ¼å¼ä¸Šä¸‹æ–‡ä¸­çš„é¡¹ç›®ï¼Œè€Œé¡µè¾¹è·ä»…åœ¨åŒä¸€æ ¼å¼ä¸Šä¸‹æ–‡ä¸­çš„å…ƒç´ ä¹‹é—´æŠ˜å ã€‚ è¾¹è·ä¸Šçš„è¿ç”¨ä»æ•ˆæœä¸Šçœ‹ï¼Œå› ä¸ºä¸¤ä¸ª div å…ƒç´ éƒ½å¤„äºåŒä¸€ä¸ª BFC å®¹å™¨ä¸‹ (è¿™é‡ŒæŒ‡ body å…ƒç´ ) æ‰€ä»¥ç¬¬ä¸€ä¸ª div çš„ä¸‹è¾¹è·å’Œç¬¬äºŒä¸ª div çš„ä¸Šè¾¹è·å‘ç”Ÿäº†é‡å ï¼Œæ‰€ä»¥ä¸¤ä¸ªç›’å­ä¹‹é—´è·ç¦»åªæœ‰ 50pxï¼Œè€Œä¸æ˜¯ 100pxã€‚ é¦–å…ˆè¿™ä¸æ˜¯ CSS çš„ bugï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºä¸€ç§è§„èŒƒï¼Œå¦‚æœæƒ³è¦é¿å…å¤–è¾¹è·çš„é‡å ï¼Œå¯ä»¥å°†å…¶æ”¾åœ¨ä¸åŒçš„ BFC å®¹å™¨ä¸­ã€‚ &lt;style type=&quot;text/css&quot;&gt; .container &#123; overflow: hidden; &#125; p &#123; width: 100px; height: 100px; background: lightblue; margin: 50px; &#125;&lt;/style&gt;&lt;body&gt; &lt;div&gt; &lt;p&gt;&lt;/p&gt; &lt;/div&gt; &lt;div&gt; &lt;p&gt;&lt;/p&gt; &lt;/div&gt; &lt;hr /&gt; &lt;div class=&quot;container&quot;&gt; &lt;p&gt;&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;container&quot;&gt; &lt;p&gt;&lt;/p&gt; &lt;/div&gt;&lt;/body&gt; BFC å¯ä»¥åŒ…å«æµ®åŠ¨çš„å…ƒç´ ï¼ˆæ¸…é™¤æµ®åŠ¨ï¼‰æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæµ®åŠ¨çš„å…ƒç´ ä¼šè„±ç¦»æ™®é€šæ–‡æ¡£æµï¼Œæ¥çœ‹ä¸‹ä¸‹é¢ä¸€ä¸ªä¾‹å­ &lt;div style=&quot;border: 1px solid #000;&quot;&gt; &lt;div style=&quot;width: 100px;height: 100px;background: #eee;float: left;&quot;&gt;&lt;/div&gt;&lt;/div&gt; &lt;div style=&quot;border: 1px solid #000;overflow: hidden&quot;&gt; &lt;div style=&quot;width: 100px;height: 100px;background: #eee;float: left;&quot;&gt;&lt;/div&gt;&lt;/div&gt; BFC å¯ä»¥é˜»æ­¢å…ƒç´ è¢«æµ®åŠ¨å…ƒç´ è¦†ç›–å…ˆæ¥çœ‹ä¸€ä¸ªæ–‡å­—ç¯ç»•æ•ˆæœï¼š &lt;div style=&quot;height: 100px;width: 100px;float: left;background: lightblue&quot;&gt; æˆ‘æ˜¯ä¸€ä¸ªå·¦æµ®åŠ¨çš„å…ƒç´ &lt;/div&gt;&lt;div style=&quot;width: 200px; height: 200px;background: #eee&quot;&gt; æˆ‘æ˜¯ä¸€ä¸ªæ²¡æœ‰è®¾ç½®æµ®åŠ¨, ä¹Ÿæ²¡æœ‰è§¦å‘ BFC å…ƒç´ , width: 200px; height:200px; background: #eee;&lt;/div&gt; è¿™æ—¶å€™å…¶å®ç¬¬äºŒä¸ªå…ƒç´ æœ‰éƒ¨åˆ†è¢«æµ®åŠ¨å…ƒç´ æ‰€è¦†ç›–ï¼Œ(ä½†æ˜¯æ–‡æœ¬ä¿¡æ¯ä¸ä¼šè¢«æµ®åŠ¨å…ƒç´ æ‰€è¦†ç›–) å¦‚æœæƒ³é¿å…å…ƒç´ è¢«è¦†ç›–ï¼Œå¯è§¦ç¬¬äºŒä¸ªå…ƒç´ çš„ BFC ç‰¹æ€§ï¼Œåœ¨ç¬¬äºŒä¸ªå…ƒç´ ä¸­åŠ å…¥ overflow: hiddenï¼Œå°±ä¼šå˜æˆï¼š è¿™ä¸ªæ–¹æ³•å¯ä»¥ç”¨æ¥å®ç°ä¸¤åˆ—è‡ªé€‚åº”å¸ƒå±€ï¼Œæ•ˆæœä¸é”™ï¼Œè¿™æ—¶å€™å·¦è¾¹çš„å®½åº¦å›ºå®šï¼Œå³è¾¹çš„å†…å®¹è‡ªé€‚åº”å®½åº¦(å»æ‰ä¸Šé¢å³è¾¹å†…å®¹çš„å®½åº¦)ã€‚ IFC(è¡Œå†…æ ¼å¼åŒ–ä¸Šä¸‹æ–‡)Inline Formatting Contextsï¼Œä¹Ÿå°±æ˜¯â€œå†…è”æ ¼å¼åŒ–ä¸Šä¸‹æ–‡â€ã€‚ ç¬¦åˆä»¥ä¸‹æ¡ä»¶å³ä¼šç”Ÿæˆä¸€ä¸ª IFC å—çº§å…ƒç´ ä¸­ä»…åŒ…å«å†…è”çº§åˆ«å…ƒç´  å½¢æˆæ¡ä»¶éå¸¸ç®€å•ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å½“ IFC ä¸­æœ‰å—çº§å…ƒç´ æ’å…¥æ—¶ï¼Œä¼šäº§ç”Ÿä¸¤ä¸ªåŒ¿åå—å°†çˆ¶å…ƒç´ åˆ†å‰²å¼€æ¥ï¼Œäº§ç”Ÿä¸¤ä¸ª IFCï¼Œè¿™é‡Œä¸åšè¿‡å¤šä»‹ç»ã€‚ IFC å¸ƒå±€è§„åˆ™ å­å…ƒç´ æ°´å¹³æ–¹å‘æ¨ªå‘æ’åˆ—ï¼Œå¹¶ä¸”å‚ç›´æ–¹å‘èµ·ç‚¹ä¸ºå…ƒç´ é¡¶éƒ¨ã€‚ å­å…ƒç´ åªä¼šè®¡ç®—æ¨ªå‘æ ·å¼ç©ºé—´ï¼Œpaddingã€borderã€marginï¼Œå‚ç›´æ–¹å‘æ ·å¼ç©ºé—´ä¸ä¼šè¢«è®¡ç®—ï¼Œpaddingã€borderã€marginã€‚ åœ¨å‚ç›´æ–¹å‘ä¸Šï¼Œå­å…ƒç´ ä¼šä»¥ä¸åŒå½¢å¼æ¥å¯¹é½ï¼ˆvertical-alignï¼‰ èƒ½æŠŠåœ¨ä¸€è¡Œä¸Šçš„æ¡†éƒ½å®Œå…¨åŒ…å«è¿›å»çš„ä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼Œè¢«ç§°ä¸ºè¯¥è¡Œçš„è¡Œæ¡†ï¼ˆline boxï¼‰ã€‚è¡Œæ¡†çš„å®½åº¦æ˜¯ç”±åŒ…å«å—ï¼ˆcontaining boxï¼‰å’Œä¸å…¶ä¸­çš„æµ®åŠ¨æ¥å†³å®šã€‚ IFC ä¸­çš„â€œline boxâ€ä¸€èˆ¬å·¦å³è¾¹è´´ç´§å…¶åŒ…å«å—ï¼Œä½† float å…ƒç´ ä¼šä¼˜å…ˆæ’åˆ—ã€‚ IFC ä¸­çš„â€œline boxâ€é«˜åº¦ç”± CSS è¡Œé«˜è®¡ç®—è§„åˆ™æ¥ç¡®å®šï¼ŒåŒä¸ª IFC ä¸‹çš„å¤šä¸ª line box é«˜åº¦å¯èƒ½ä¼šä¸åŒã€‚ å½“ inline-level boxes çš„æ€»å®½åº¦å°‘äºåŒ…å«å®ƒä»¬çš„ line box æ—¶ï¼Œå…¶æ°´å¹³æ¸²æŸ“è§„åˆ™ç”± text-align å±æ€§å€¼æ¥å†³å®šã€‚ å½“ä¸€ä¸ªâ€œinline boxâ€è¶…è¿‡çˆ¶å…ƒç´ çš„å®½åº¦æ—¶ï¼Œå®ƒä¼šè¢«åˆ†å‰²æˆå¤šä¸ª boxesï¼Œè¿™äº› oxes åˆ†å¸ƒåœ¨å¤šä¸ªâ€œline boxâ€ä¸­ã€‚å¦‚æœå­å…ƒç´ æœªè®¾ç½®å¼ºåˆ¶æ¢è¡Œçš„æƒ…å†µä¸‹ï¼Œâ€œinline boxâ€å°†ä¸å¯è¢«åˆ†å‰²ï¼Œå°†ä¼šæº¢å‡ºçˆ¶å…ƒç´ ã€‚ ä¸Šä¸‹é—´è·ä¸ç”Ÿæ•ˆå†…è”æ ¼å¼ä¸Šä¸‹æ–‡å­˜åœ¨äºå…¶ä»–æ ¼å¼ä¸Šä¸‹æ–‡ä¸­ï¼Œå¯ä»¥å°†å…¶è§†ä¸ºæ®µè½çš„ä¸Šä¸‹æ–‡ã€‚æ®µè½åˆ›å»ºäº†ä¸€ä¸ªå†…è”æ ¼å¼ä¸Šä¸‹æ–‡ï¼Œå…¶ä¸­åœ¨æ–‡æœ¬ä¸­ä½¿ç”¨è¯¸å¦‚ &lt;strong&gt; ã€ &lt;a&gt; æˆ– &lt;span&gt; å…ƒç´ ç­‰å†…å®¹ã€‚ box model ä¸å®Œå…¨é€‚ç”¨äºå‚ä¸å†…è”æ ¼å¼ä¸Šä¸‹æ–‡ã€‚åœ¨æ°´å¹³ä¹¦å†™æ¨¡å¼è¡Œä¸­ï¼Œæ°´å¹³å¡«å……ã€è¾¹æ¡†å’Œè¾¹è·å°†åº”ç”¨äºå…ƒç´ ï¼Œå¹¶å·¦å³ç§»åŠ¨æ–‡æœ¬ã€‚ä½†æ˜¯ï¼Œå…ƒç´ ä¸Šæ–¹å’Œä¸‹æ–¹è¾¹è·å°†ä¸é€‚ç”¨ã€‚åº”ç”¨å‚ç›´å¡«å……å’Œè¾¹æ¡†å¯èƒ½ä¼šåœ¨å†…å®¹çš„ä¸Šæ–¹å’Œä¸‹æ–¹é‡å ï¼Œå› ä¸ºåœ¨å†…è”æ ¼å¼ä¸Šä¸‹æ–‡ä¸­ï¼Œå¡«å……å’Œè¾¹æ¡†ä¸ä¼šå°†è¡Œæ¡†æ’‘å¼€ã€‚ å¤šä¸ªå…ƒç´ æ°´å¹³å±…ä¸­.warp &#123; border: 1px solid red; width: 200px; text-align: center;&#125;.text &#123; background: green;&#125; &lt;div class=&quot;warp&quot;&gt; &lt;span class=&quot;text&quot;&gt;æ–‡æœ¬ä¸€&lt;/span&gt; &lt;span class=&quot;text&quot;&gt;æ–‡æœ¬äºŒ&lt;/span&gt;&lt;/div&gt; float å…ƒç´ ä¼˜å…ˆæ’åˆ—.warp &#123; border: 1px solid red; width: 200px;&#125;.text &#123; background: green;&#125;.f-l &#123; float: left;&#125; &lt;div class=&quot;warp&quot;&gt; &lt;span class=&quot;text&quot;&gt;è¿™æ˜¯æ–‡æœ¬1&lt;/span&gt; &lt;span class=&quot;text&quot;&gt;è¿™æ˜¯æ–‡æœ¬2&lt;/span&gt; &lt;span class=&quot;text f-l&quot;&gt;è¿™æ˜¯æ–‡æœ¬3&lt;/span&gt; &lt;span class=&quot;text&quot;&gt;è¿™æ˜¯æ–‡æœ¬4&lt;/span&gt;&lt;/div&gt; IFC ä¸­å…·å¤‡ float å±æ€§å€¼çš„å…ƒç´ ä¼˜å…ˆæ’åˆ—ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸­ç”¨æ¥åœ¨æ–‡ç« æ®µè½å¼€å¤´æ·»åŠ â€œtagâ€å¯ä»¥ç”¨åˆ°ã€‚ å›¾ç‰‡æ— æ³•å’Œæ–‡å­—å‚ç›´å±…ä¸­åœ¨å›¾ç‰‡ä¸Šè®¾ç½®vertical: middle &lt;div class=&quot;warp&quot;&gt; &lt;img src=&quot;/img/head.jpg&quot; width=&quot;100&quot; height=&quot;100&quot; /&gt; &lt;span&gt;luckyship&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;warp&quot;&gt; &lt;img src=&quot;/img/head.jpg&quot; width=&quot;100&quot; height=&quot;100&quot; style=&quot;vertical-align: middle;&quot; /&gt; &lt;span&gt;luckyship&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;warp&quot;&gt; &lt;img src=&quot;/img/head.jpg&quot; width=&quot;100&quot; height=&quot;100&quot; style=&quot;vertical-align: middle;&quot; /&gt; &lt;span&gt;luckyship&lt;/span&gt; &lt;img src=&quot;/img/head.jpg&quot; width=&quot;200&quot; height=&quot;200&quot; /&gt;&lt;/div&gt;&lt;div class=&quot;warp&quot;&gt; &lt;img src=&quot;/img/head.jpg&quot; width=&quot;100&quot; height=&quot;100&quot; style=&quot;vertical-align: middle;&quot; /&gt; &lt;span&gt;luckyship&lt;/span&gt; &lt;img src=&quot;/img/head.jpg&quot; width=&quot;200&quot; height=&quot;200&quot; style=&quot;vertical-align: middle;&quot; /&gt;&lt;/div&gt; è¿™ç§è®¾ç½®å‚ç›´å±…ä¸­çš„æ–¹æ³•ï¼Œæ ¹æœ¬ä¸Šæ˜¯æ”¹å˜äº†è¡Œå†…å…ƒç´ çš„åŸºçº¿å¯¹é½æ–¹å¼ å‚è€ƒè¡Œå†…æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼ˆInline formatting contextï¼‰ 10 åˆ†é’Ÿç†è§£ BFC åŸç† CSS ä¹‹ IFC","updated":"2025-08-02T05:46:04.175Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"}]},{"title":"csså¸¸ç”¨çŸ¥è¯†","date":"2021-05-06T02:35:44.000Z","path":"2021/05/06/2021-05-06-css-interview/","text":"ä»€ä¹ˆæ˜¯ç›’å­æ¨¡å‹ç›’æ¨¡å‹åˆ†ä¸ºæ ‡å‡†ç›’æ¨¡å‹å’Œæ€ªå¼‚ç›’æ¨¡å‹ï¼ˆIEï¼‰ box-sizing : content-box //æ ‡å‡†ç›’æ¨¡å‹box-sizing : border-box //æ€ªå¼‚ç›’æ¨¡å‹ æ ‡å‡†ç›’æ¨¡å‹: è¿™ç§ç›’æ¨¡å‹è®¾ç½®widthçš„æ—¶å€™çš„å€¼æ˜¯å†…å®¹åŒºçš„å®½åº¦, å¦‚æœå†è®¾ç½®paddingå’Œmargin, borderçš„è¯ç›’å­çš„å®é™…å®½åº¦ä¼šå¢å¤§ï¼› æ€ªå¼‚ç›’æ¨¡å‹: è¿™ç§ç›’å­çš„widthè®¾ç½®çš„å€¼ä¸ºç›’å­å®é™…çš„å®½åº¦, borderå’Œpaddingçš„è®¾ç½®ä¸ä¼šå½±å“ç›’å­çš„å®é™…å®½åº¦å’Œé«˜åº¦ CSS æ–°ç‰¹æ€§transition //è¿‡æ¸¡transform //æ—‹è½¬ã€ç¼©æ”¾ã€ç§»åŠ¨æˆ–è€…å€¾æ–œanimation //åŠ¨ç”»gradient //æ¸å˜shadow //é˜´å½±border-radius //åœ†è§’ æ˜¾ç¤ºçœç•¥å·æ ·å¼overflow: hidden;text-overflow: ellipsis; link å’Œ @import çš„åŒºåˆ« link å±äº HTML æ ‡ç­¾ï¼Œè€Œ@import æ˜¯ CSS æä¾›çš„ã€‚ é¡µé¢åŠ è½½çš„æ—¶å€™ï¼Œlink ä¼šåŒæ—¶è¢«åŠ è½½ï¼Œè€Œ@import å¼•ç”¨çš„ CSS ä¼šç­‰åˆ°é¡µé¢è¢«åŠ è½½å®Œå†åŠ è½½ã€‚ import åªåœ¨ IE5 ä»¥ä¸Šæ‰èƒ½è¯†åˆ«ï¼Œè€Œ link æ˜¯ HTML æ ‡ç­¾ï¼Œæ— å…¼å®¹é—®é¢˜ã€‚ link æ ·å¼çš„æƒé‡é«˜äº@import æ ·å¼çš„æƒé‡ã€‚ ä»‹ç»ä¸€ä¸‹æ ‡å‡†çš„ CSS çš„ç›’å­æ¨¡å‹ï¼Ÿä¸ä½ç‰ˆæœ¬ IE çš„ç›’å­æ¨¡å‹æœ‰ä»€ä¹ˆä¸åŒçš„ï¼Ÿæ ‡å‡†ç›’å­æ¨¡å‹ï¼šå®½åº¦=å†…å®¹çš„å®½åº¦ ï¼ˆcontentï¼‰+ border + padding + margin ä½ç‰ˆæœ¬ IE ç›’å­æ¨¡å‹ï¼šå®½åº¦=å†…å®¹å®½åº¦ ï¼ˆcontent+border+paddingï¼‰+ margin box-sizing å±æ€§ï¼Ÿç”¨æ¥æ§åˆ¶å…ƒç´ çš„ç›’å­æ¨¡å‹çš„è§£ææ¨¡å¼ï¼Œé»˜è®¤ä¸º content-boxcontext-boxï¼šW3C çš„æ ‡å‡†ç›’å­æ¨¡å‹ï¼Œè®¾ç½®å…ƒç´ çš„ height/width å±æ€§æŒ‡çš„æ˜¯ content éƒ¨åˆ†çš„é«˜/å®½border-boxï¼šIE ä¼ ç»Ÿç›’å­æ¨¡å‹ã€‚è®¾ç½®å…ƒç´ çš„ height/width å±æ€§æŒ‡çš„æ˜¯ border + padding + content éƒ¨åˆ†çš„é«˜/å®½ CSS é€‰æ‹©å™¨æœ‰å“ªäº›ï¼Ÿå“ªäº›å±æ€§å¯ä»¥ç»§æ‰¿ï¼ŸCSS é€‰æ‹©ç¬¦ï¼šid é€‰æ‹©å™¨(#myid)ã€ç±»é€‰æ‹©å™¨(.myclassname)ã€æ ‡ç­¾é€‰æ‹©å™¨(div, h1, p)ã€ç›¸é‚»é€‰æ‹©å™¨(h1 + p)ã€å­é€‰æ‹©å™¨ï¼ˆul &gt; liï¼‰ã€åä»£é€‰æ‹©å™¨ï¼ˆli aï¼‰ã€é€šé…ç¬¦é€‰æ‹©å™¨ï¼ˆ*ï¼‰ã€å±æ€§é€‰æ‹©å™¨ï¼ˆa[rel=â€externalâ€]ï¼‰ã€ä¼ªç±»é€‰æ‹©å™¨ï¼ˆa:hover, li:nth-childï¼‰ å¯ç»§æ‰¿çš„å±æ€§ï¼š font-size, font-family, color ä¸å¯ç»§æ‰¿çš„æ ·å¼ï¼š border, padding, margin, width, height ä¼˜å…ˆçº§ï¼ˆå°±è¿‘åŸåˆ™ï¼‰ï¼š!important &gt; [ id &gt; class &gt; tag ] !important æ¯”å†…è”ä¼˜å…ˆçº§é«˜ CSS ä¼˜å…ˆçº§ç®—æ³•å¦‚ä½•è®¡ç®—ï¼Ÿ å…ƒç´ é€‰æ‹©ç¬¦ï¼š 1 class é€‰æ‹©ç¬¦ï¼š 10 id é€‰æ‹©ç¬¦ï¼š100 è¡Œå†…æ ·å¼ï¼š1000 !important å£°æ˜çš„æ ·å¼ä¼˜å…ˆçº§æœ€é«˜ï¼Œå¦‚æœå†²çªå†è¿›è¡Œè®¡ç®—ã€‚å¦‚æœä¼˜å…ˆçº§ç›¸åŒï¼Œåˆ™é€‰æ‹©æœ€åå‡ºç°çš„æ ·å¼ã€‚ç»§æ‰¿å¾—åˆ°çš„æ ·å¼çš„ä¼˜å…ˆçº§æœ€ä½ã€‚ æ•°å­—åªæ˜¯ä¸ºäº†åŒä¸€çº§åˆ«çš„ä¼˜å…ˆçº§æ¯”è¾ƒï¼Œä¸ä¼šå‡ºç°ä½çº§åˆ«æ•°é‡å¤šçš„æƒ…å†µè¦†ç›–é«˜çº§åˆ«å› ä¸ºæ¯ä¸ªçº§åˆ«éƒ½æœ‰ä¸Šé™ï¼Œè¶…è¿‡ä¸€å®šæ•°é‡åï¼Œä¼˜å…ˆçº§ä¸ä¼šå¢åŠ  CSS3 æ–°å¢ä¼ªç±»æœ‰é‚£äº›? p:first-of-type é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„é¦–ä¸ªå…ƒç´  p:last-of-type é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„æœ€åå…ƒç´  p:only-of-type é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ å”¯ä¸€çš„å…ƒç´  p:only-child é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„å”¯ä¸€å­å…ƒç´  p:nth-child(2) é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„ç¬¬äºŒä¸ªå­å…ƒç´  :enabled :disabled è¡¨å•æ§ä»¶çš„ç¦ç”¨çŠ¶æ€ã€‚ :checked å•é€‰æ¡†æˆ–å¤é€‰æ¡†è¢«é€‰ä¸­ã€‚ display æœ‰å“ªäº›å€¼ï¼Ÿè¯´æ˜ä»–ä»¬çš„ä½œç”¨? inlineï¼ˆé»˜è®¤ï¼‰â€“å†…è” noneâ€“éšè— blockâ€“å—æ˜¾ç¤º tableâ€“è¡¨æ ¼æ˜¾ç¤º list-itemâ€“é¡¹ç›®åˆ—è¡¨ inline-block position çš„å€¼ staticï¼ˆé»˜è®¤ï¼‰ï¼šæŒ‰ç…§æ­£å¸¸æ–‡æ¡£æµè¿›è¡Œæ’åˆ—ï¼› relativeï¼ˆç›¸å¯¹å®šä½ï¼‰ï¼šä¸è„±ç¦»æ–‡æ¡£æµï¼Œå‚è€ƒè‡ªèº«é™æ€ä½ç½®é€šè¿‡ top, bottom, left, right å®š* ä½ï¼› absolute(ç»å¯¹å®šä½)ï¼šå‚è€ƒè·å…¶æœ€è¿‘ä¸€ä¸ªä¸ä¸º static çš„çˆ¶çº§å…ƒç´ é€šè¿‡ top, bottom, left, right * å®šä½ï¼› fixed(å›ºå®šå®šä½)ï¼šæ‰€å›ºå®šçš„å‚ç…§å¯¹åƒæ˜¯å¯è§†çª—å£ã€‚ CSS3 æœ‰å“ªäº›æ–°ç‰¹æ€§ RGBA å’Œé€æ˜åº¦ background-image background-origin(content-box/padding-box/border-box) * background-size background-repeat word-wrapï¼ˆå¯¹é•¿çš„ä¸å¯åˆ†å‰²å•è¯æ¢è¡Œï¼‰word-wrapï¼šbreak-word æ–‡å­—é˜´å½±ï¼štext-shadowï¼š 5px 5px 5px #FF0000; ï¼ˆæ°´å¹³é˜´å½±ï¼Œå‚ç›´é˜´å½±ï¼Œæ¨¡ç³Šè·ç¦»ï¼Œé˜´å½±é¢œè‰²ï¼‰ font-face å±æ€§ï¼šå®šä¹‰è‡ªå·±çš„å­—ä½“ åœ†è§’ï¼ˆè¾¹æ¡†åŠå¾„ï¼‰ï¼šborder-radius å±æ€§ç”¨äºåˆ›å»ºåœ†è§’ è¾¹æ¡†å›¾ç‰‡ï¼šborder-image: url(border.png) 30 30 round ç›’é˜´å½±ï¼šbox-shadow: 10px 10px 5px #888888 åª’ä½“æŸ¥è¯¢ï¼šå®šä¹‰ä¸¤å¥— cssï¼Œå½“æµè§ˆå™¨çš„å°ºå¯¸å˜åŒ–æ—¶ä¼šé‡‡ç”¨ä¸åŒçš„å±æ€§ ç”¨çº¯ CSS åˆ›å»ºä¸€ä¸ªä¸‰è§’å½¢çš„åŸç†æ˜¯ä»€ä¹ˆé¦–å…ˆï¼Œéœ€è¦æŠŠå…ƒç´ çš„å®½åº¦ã€é«˜åº¦è®¾ä¸º 0ã€‚ç„¶åè®¾ç½®è¾¹æ¡†æ ·å¼ã€‚ CSS é‡Œçš„ visibility å±æ€§æœ‰ä¸ª collapse å±æ€§å€¼ï¼Ÿåœ¨ä¸åŒæµè§ˆå™¨ä¸‹ä»¥åä»€ä¹ˆåŒºåˆ«ï¼Ÿå½“ä¸€ä¸ªå…ƒç´ çš„ visibility å±æ€§è¢«è®¾ç½®æˆ collapse å€¼åï¼Œå¯¹äºä¸€èˆ¬çš„å…ƒç´ ï¼Œå®ƒçš„è¡¨ç°è·Ÿ hidden æ˜¯ä¸€æ ·çš„ã€‚ chrome ä¸­ï¼Œä½¿ç”¨ collapse å€¼å’Œä½¿ç”¨ hidden æ²¡æœ‰åŒºåˆ«ã€‚firefoxï¼Œopera å’Œ IEï¼Œä½¿ç”¨ collapse å€¼å’Œä½¿ç”¨ displayï¼šnone æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚ display:none ä¸ visibilityï¼šhidden çš„åŒºåˆ«ï¼Ÿdisplayï¼šnone ä¸æ˜¾ç¤ºå¯¹åº”çš„å…ƒç´ ï¼Œåœ¨æ–‡æ¡£å¸ƒå±€ä¸­ä¸å†åˆ†é…ç©ºé—´ï¼ˆå›æµ+é‡ç»˜ï¼‰visibilityï¼šhidden éšè—å¯¹åº”å…ƒç´ ï¼Œåœ¨æ–‡æ¡£å¸ƒå±€ä¸­ä»ä¿ç•™åŸæ¥çš„ç©ºé—´ï¼ˆé‡ç»˜ï¼‰ position è·Ÿ displayã€overflowã€float è¿™äº›ç‰¹æ€§ç›¸äº’å åŠ åä¼šæ€ä¹ˆæ ·display å±æ€§è§„å®šå…ƒç´ åº”è¯¥ç”Ÿæˆçš„æ¡†çš„ç±»å‹ï¼› position å±æ€§è§„å®šå…ƒç´ çš„å®šä½ç±»å‹ï¼› float å±æ€§æ˜¯ä¸€ç§å¸ƒå±€æ–¹å¼ï¼Œå®šä¹‰å…ƒç´ åœ¨å“ªä¸ªæ–¹å‘æµ®åŠ¨ã€‚ç±»ä¼¼äºä¼˜å…ˆçº§æœºåˆ¶ï¼š positionï¼šabsolute/fixed ä¼˜å…ˆçº§æœ€é«˜ï¼Œæœ‰ä»–ä»¬åœ¨æ—¶ï¼Œ float ä¸èµ·ä½œç”¨ï¼Œ display å€¼éœ€è¦è°ƒæ•´ã€‚ float æˆ–è€… absolute å®šä½çš„å…ƒç´ ï¼Œåªèƒ½æ˜¯å—å…ƒç´ æˆ–è¡¨æ ¼ã€‚ å¯¹ BFC è§„èŒƒ(å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼šblock formatting context)çš„ç†è§£ï¼ŸBFC è§„å®šäº†å†…éƒ¨çš„ Block Box å¦‚ä½•å¸ƒå±€ã€‚å®šä½æ–¹æ¡ˆï¼š å†…éƒ¨çš„ Box ä¼šåœ¨å‚ç›´æ–¹å‘ä¸Šä¸€ä¸ªæ¥ä¸€ä¸ªæ”¾ç½®ã€‚ Box å‚ç›´æ–¹å‘çš„è·ç¦»ç”± margin å†³å®šï¼Œå±äºåŒä¸€ä¸ª BFC çš„ä¸¤ä¸ªç›¸é‚» Box çš„ margin ä¼šå‘ç”Ÿé‡å ã€‚ æ¯ä¸ªå…ƒç´ çš„ margin box çš„å·¦è¾¹ï¼Œä¸åŒ…å«å— border box çš„å·¦è¾¹ç›¸æ¥è§¦ã€‚ BFC çš„åŒºåŸŸä¸ä¼šä¸ float box é‡å ã€‚ BFC æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ã€‚ è®¡ç®— BFC çš„é«˜åº¦æ—¶ï¼Œæµ®åŠ¨å…ƒç´ ä¹Ÿä¼šå‚ä¸è®¡ç®—ã€‚æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ä¹‹ä¸€å°±å¯è§¦å‘ BFC æ ¹å…ƒç´ ï¼Œå³ html float çš„å€¼ä¸ä¸º noneï¼ˆé»˜è®¤ï¼‰ overflow çš„å€¼ä¸ä¸º visibleï¼ˆé»˜è®¤ï¼‰ display çš„å€¼ä¸º inline-blockã€table-cellã€table-caption position çš„å€¼ä¸º absolute æˆ– fixed æµè§ˆå™¨æ˜¯æ€æ ·è§£æ CSS é€‰æ‹©å™¨çš„ï¼ŸCSS é€‰æ‹©å™¨çš„è§£ææ˜¯ä»å³å‘å·¦è§£æçš„ã€‚è‹¥ä»å·¦å‘å³çš„åŒ¹é…ï¼Œå‘ç°ä¸ç¬¦åˆè§„åˆ™ï¼Œéœ€è¦è¿›è¡Œå›æº¯ï¼Œä¼šæŸå¤±å¾ˆå¤šæ€§èƒ½ã€‚è‹¥ä»å³å‘å·¦åŒ¹é…ï¼Œå…ˆæ‰¾åˆ°æ‰€æœ‰çš„æœ€å³èŠ‚ç‚¹ï¼Œå¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå‘ä¸Šå¯»æ‰¾å…¶çˆ¶èŠ‚ç‚¹ç›´åˆ°æ‰¾åˆ°æ ¹å…ƒç´ æˆ–æ»¡è¶³æ¡ä»¶çš„åŒ¹é…è§„åˆ™ï¼Œåˆ™ç»“æŸè¿™ä¸ªåˆ†æ”¯çš„éå†ã€‚ä¸¤ç§åŒ¹é…è§„åˆ™çš„æ€§èƒ½å·®åˆ«å¾ˆå¤§ï¼Œæ˜¯å› ä¸ºä»å³å‘å·¦çš„åŒ¹é…åœ¨ç¬¬ä¸€æ­¥å°±ç­›é€‰æ‰äº†å¤§é‡çš„ä¸ç¬¦åˆæ¡ä»¶çš„æœ€å³èŠ‚ç‚¹ï¼ˆå¶å­èŠ‚ç‚¹ï¼‰ï¼Œè€Œä»å·¦å‘å³çš„åŒ¹é…è§„åˆ™çš„æ€§èƒ½éƒ½æµªè´¹åœ¨äº†å¤±è´¥çš„æŸ¥æ‰¾ä¸Šé¢ã€‚è€Œåœ¨ CSS è§£æå®Œæ¯•åï¼Œéœ€è¦å°†è§£æçš„ç»“æœä¸ DOM Tree çš„å†…å®¹ä¸€èµ·è¿›è¡Œåˆ†æå»ºç«‹ä¸€æ£µ Render Treeï¼Œæœ€ç»ˆç”¨æ¥è¿›è¡Œç»˜å›¾ã€‚åœ¨å»ºç«‹ Render Tree æ—¶ï¼ˆWebKit ä¸­çš„ã€ŒAttachmentã€è¿‡ç¨‹ï¼‰ï¼Œæµè§ˆå™¨å°±è¦ä¸ºæ¯ä¸ª DOM Tree ä¸­çš„å…ƒç´ æ ¹æ® CSS çš„è§£æç»“æœï¼ˆStyle Rulesï¼‰æ¥ç¡®å®šç”Ÿæˆæ€æ ·çš„ Render Treeã€‚ å‚è€ƒå…ƒç´ ç«–å‘çš„ç™¾åˆ†æ¯”è®¾å®šæ˜¯ç›¸å¯¹äºå®¹å™¨çš„é«˜åº¦å—ï¼Ÿå½“æŒ‰ç™¾åˆ†æ¯”è®¾å®šä¸€ä¸ªå…ƒç´ çš„å®½åº¦æ—¶ï¼Œå®ƒæ˜¯ç›¸å¯¹äºçˆ¶å®¹å™¨çš„å®½åº¦è®¡ç®—çš„ï¼Œä½†æ˜¯ï¼Œå¯¹äºä¸€äº›è¡¨ç¤ºç«–å‘è·ç¦»çš„å±æ€§ï¼Œä¾‹å¦‚ padding-top , padding-bottom , margin-top , margin-bottom ç­‰ï¼Œå½“æŒ‰ç™¾åˆ†æ¯”è®¾å®šå®ƒä»¬æ—¶ï¼Œä¾æ®çš„ä¹Ÿæ˜¯çˆ¶å®¹å™¨çš„å®½åº¦ï¼Œè€Œä¸æ˜¯é«˜åº¦ã€‚ å‚è€ƒå…¨å±æ»šåŠ¨çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿç”¨åˆ°äº† CSS çš„å“ªäº›å±æ€§ï¼ŸåŸç†ï¼šæœ‰ç‚¹ç±»ä¼¼äºè½®æ’­ï¼Œæ•´ä½“çš„å…ƒç´ ä¸€ç›´æ’åˆ—ä¸‹å»ï¼Œå‡è®¾æœ‰ 5 ä¸ªéœ€è¦å±•ç¤ºçš„å…¨å±é¡µé¢ï¼Œé‚£ä¹ˆé«˜åº¦æ˜¯ 500%ï¼Œåªæ˜¯å±•ç¤º 100%ï¼Œå‰©ä¸‹çš„å¯ä»¥é€šè¿‡ transform è¿›è¡Œ y è½´å®šä½ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ margin-top å®ç°overflowï¼šhiddenï¼›transitionï¼šall 1000ms easeï¼› ä»€ä¹ˆæ˜¯å“åº”å¼è®¾è®¡ï¼Ÿå“åº”å¼è®¾è®¡çš„åŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•å…¼å®¹ä½ç‰ˆæœ¬çš„ IEï¼Ÿå“åº”å¼ç½‘ç«™è®¾è®¡(Responsive Web design)æ˜¯ä¸€ä¸ªç½‘ç«™èƒ½å¤Ÿå…¼å®¹å¤šä¸ªç»ˆç«¯ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸€ä¸ªç»ˆç«¯åšä¸€ä¸ªç‰¹å®šçš„ç‰ˆæœ¬ã€‚åŸºæœ¬åŸç†æ˜¯é€šè¿‡åª’ä½“æŸ¥è¯¢æ£€æµ‹ä¸åŒçš„è®¾å¤‡å±å¹•å°ºå¯¸åšå¤„ç†ã€‚é¡µé¢å¤´éƒ¨å¿…é¡»æœ‰ meta å£°æ˜çš„ viewportã€‚ ::before å’Œ :after ä¸­åŒå†’å·å’Œå•å†’å·æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿè§£é‡Šä¸€ä¸‹è¿™ 2 ä¸ªä¼ªå…ƒç´ çš„ä½œç”¨å•å†’å·(:)ç”¨äº CSS3 ä¼ªç±»ï¼ŒåŒå†’å·(::)ç”¨äº CSS3 ä¼ªå…ƒç´ ã€‚:: before å°±æ˜¯ä»¥ä¸€ä¸ªå­å…ƒç´ çš„å­˜åœ¨ï¼Œå®šä¹‰åœ¨å…ƒç´ ä¸»ä½“å†…å®¹ä¹‹å‰çš„ä¸€ä¸ªä¼ªå…ƒç´ ã€‚å¹¶ä¸å­˜åœ¨äº dom ä¹‹ä¸­ï¼Œåªå­˜åœ¨åœ¨é¡µé¢ä¹‹ä¸­ã€‚ ä½ å¯¹ line-height æ˜¯å¦‚ä½•ç†è§£çš„ï¼Ÿè¡Œé«˜æ˜¯æŒ‡ä¸€è¡Œæ–‡å­—çš„é«˜åº¦ï¼Œå…·ä½“è¯´æ˜¯ä¸¤è¡Œæ–‡å­—é—´åŸºçº¿çš„è·ç¦»ã€‚CSS ä¸­èµ·é«˜åº¦ä½œç”¨çš„æ˜¯ height å’Œ line-height ï¼Œæ²¡æœ‰å®šä¹‰ height å±æ€§ï¼Œæœ€ç»ˆå…¶è¡¨ç°ä½œç”¨ä¸€å®šæ˜¯ line-height ã€‚å•è¡Œæ–‡æœ¬å‚ç›´å±…ä¸­ï¼šæŠŠ line-height å€¼è®¾ç½®ä¸º height ä¸€æ ·å¤§å°çš„å€¼å¯ä»¥å®ç°å•è¡Œæ–‡å­—çš„å‚ç›´å±…ä¸­ï¼Œå…¶å®ä¹Ÿå¯ä»¥æŠŠ height åˆ é™¤ã€‚å¤šè¡Œæ–‡æœ¬å‚ç›´å±…ä¸­ï¼šéœ€è¦è®¾ç½® display å±æ€§ä¸º inline-block ã€‚ æ€ä¹ˆè®© Chrome æ”¯æŒå°äº 12px çš„æ–‡å­—font-size: 12px;transform: 0.8; // ç¼©å°æ¯”ä¾‹ å¦‚æœéœ€è¦æ‰‹åŠ¨å†™åŠ¨ç”»ï¼Œä½ è®¤ä¸ºæœ€å°æ—¶é—´é—´éš”æ˜¯å¤šä¹…ï¼Œä¸ºä»€ä¹ˆï¼Ÿå¤šæ•°æ˜¾ç¤ºå™¨é»˜è®¤é¢‘ç‡æ˜¯ 60Hzï¼Œå³ 1 ç§’åˆ·æ–° 60 æ¬¡ï¼Œæ‰€ä»¥ç†è®ºä¸Šæœ€å°é—´éš”ä¸º 1/60ï¼Š1000ms ï¼ 16.7ms li ä¸ li ä¹‹é—´æœ‰çœ‹ä¸è§çš„ç©ºç™½é—´éš”æ˜¯ä»€ä¹ˆåŸå› å¼•èµ·çš„ï¼Ÿæœ‰ä»€ä¹ˆè§£å†³åŠæ³•ï¼Ÿè¡Œæ¡†çš„æ’åˆ—ä¼šå—åˆ°ä¸­é—´ç©ºç™½ï¼ˆå›è½¦ç©ºæ ¼ï¼‰ç­‰çš„å½±å“ï¼Œå› ä¸ºç©ºæ ¼ä¹Ÿå±äºå­—ç¬¦, è¿™äº›ç©ºç™½ä¹Ÿä¼šè¢«åº”ç”¨æ ·å¼ï¼Œå æ®ç©ºé—´ï¼Œæ‰€ä»¥ä¼šæœ‰é—´éš”ï¼ŒæŠŠå­—ç¬¦å¤§å°è®¾ä¸º 0ï¼Œå°±æ²¡æœ‰ç©ºæ ¼äº†ã€‚è§£å†³æ–¹æ³•ï¼š å¯ä»¥å°†&lt;li&gt;ä»£ç å…¨éƒ¨å†™åœ¨ä¸€æ’ æµ®åŠ¨ li ä¸­ floatï¼šleft åœ¨ ul ä¸­ç”¨ font-sizeï¼š0ï¼ˆè°·æ­Œä¸æ”¯æŒï¼‰ï¼›å¯ä»¥ä½¿ç”¨ letter-spaceï¼š-3px display:inline-block ä»€ä¹ˆæ—¶å€™ä¼šæ˜¾ç¤ºé—´éš™ï¼Ÿ æœ‰ç©ºæ ¼æ—¶å€™ä¼šæœ‰é—´éš™ è§£å†³ï¼šç§»é™¤ç©ºæ ¼ margin æ­£å€¼çš„æ—¶å€™ è§£å†³ï¼šmargin ä½¿ç”¨è´Ÿå€¼ ä½¿ç”¨ font-size æ—¶å€™ è§£å†³ï¼šfont-size:0ã€letter-spacingã€word-spacing æœ‰ä¸€ä¸ªé«˜åº¦è‡ªé€‚åº”çš„ divï¼Œé‡Œé¢æœ‰ä¸¤ä¸ª divï¼Œä¸€ä¸ªé«˜åº¦ 100pxï¼Œå¸Œæœ›å¦ä¸€ä¸ªå¡«æ»¡å‰©ä¸‹çš„é«˜åº¦?å¤–å±‚ div ä½¿ç”¨ positionï¼šrelativeï¼›é«˜åº¦è¦æ±‚è‡ªé€‚åº”çš„ div ä½¿ç”¨ position: absolute; top: 100px; bottom: 0; left: 0 style æ ‡ç­¾å†™åœ¨ body åä¸ body å‰æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿé¡µé¢åŠ è½½è‡ªä¸Šè€Œä¸‹ å½“ç„¶æ˜¯å…ˆåŠ è½½æ ·å¼ã€‚å†™åœ¨ body æ ‡ç­¾åç”±äºæµè§ˆå™¨ä»¥é€è¡Œæ–¹å¼å¯¹ HTML æ–‡æ¡£è¿›è¡Œè§£æï¼Œå½“è§£æåˆ°å†™åœ¨å°¾éƒ¨çš„æ ·å¼è¡¨ï¼ˆå¤–è”æˆ–å†™åœ¨ style æ ‡ç­¾ï¼‰ä¼šå¯¼è‡´æµè§ˆå™¨åœæ­¢ä¹‹å‰çš„æ¸²æŸ“ï¼Œç­‰å¾…åŠ è½½ä¸”è§£ææ ·å¼è¡¨å®Œæˆä¹‹åé‡æ–°æ¸²æŸ“ï¼Œåœ¨ windows çš„ IE ä¸‹å¯èƒ½ä¼šå‡ºç° FOUC ç°è±¡ï¼ˆå³æ ·å¼å¤±æ•ˆå¯¼è‡´çš„é¡µé¢é—ªçƒé—®é¢˜ï¼‰","updated":"2025-08-02T05:46:04.175Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"}]},{"title":"angularç”Ÿå‘½å‘¨æœŸå‡½æ•°","date":"2021-04-20T03:04:16.000Z","path":"2021/04/20/2021-04-20-angular-lifecycle/","text":"åŠ è½½æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°export class LifecircleComponent &#123; constructor() &#123; console.log(&#x27;00æ„é€ å‡½æ•°æ‰§è¡Œäº†---é™¤äº†ä½¿ç”¨ç®€å•çš„å€¼å¯¹å±€éƒ¨å˜é‡è¿›è¡Œåˆå§‹åŒ–ä¹‹å¤–ï¼Œä»€ä¹ˆéƒ½ä¸åº”è¯¥åš&#x27;) &#125; ngOnChanges() &#123; console.log(&#x27;01ngOnChagesæ‰§è¡Œäº†---å½“è¢«ç»‘å®šçš„è¾“å…¥å±æ€§çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶è°ƒç”¨(çˆ¶å­ç»„ä»¶ä¼ å€¼çš„æ—¶å€™ä¼šè§¦å‘)&#x27;); &#125; ngOnInit() &#123; console.log(&#x27;02ngOnInitæ‰§è¡Œäº†--- è¯·æ±‚æ•°æ®ä¸€èˆ¬æ”¾åœ¨è¿™ä¸ªé‡Œé¢&#x27;); &#125; ngDoCheck() &#123; console.log(&#x27;03ngDoCheckæ‰§è¡Œäº†---æ£€æµ‹ï¼Œå¹¶åœ¨å‘ç”Ÿ Angular æ— æ³•æˆ–ä¸æ„¿æ„è‡ªå·±æ£€æµ‹çš„å˜åŒ–æ—¶ä½œå‡ºååº”&#x27;); &#125; ngAfterContentInit() &#123; console.log(&#x27;04ngAfterContentInitæ‰§è¡Œäº†---å½“æŠŠå†…å®¹æŠ•å½±è¿›ç»„ä»¶ä¹‹åè°ƒç”¨&#x27;); &#125; ngAfterContentChecked() &#123; console.log(&#x27;05ngAfterContentCheckedæ‰§è¡Œäº†---æ¯æ¬¡å®Œæˆè¢«æŠ•å½±ç»„ä»¶å†…å®¹çš„å˜æ›´æ£€æµ‹ä¹‹åè°ƒç”¨&#x27;); &#125; ngAfterViewInit(): void &#123; console.log(&#x27;06 ngAfterViewInitæ‰§è¡Œäº†----åˆå§‹åŒ–å®Œç»„ä»¶è§†å›¾åŠå…¶å­è§†å›¾ä¹‹åè°ƒç”¨ï¼ˆdomæ“ä½œæ”¾åœ¨è¿™ä¸ªé‡Œé¢ï¼‰&#x27;); &#125; ngAfterViewChecked() &#123; console.log(&#x27;07ngAfterViewCheckedæ‰§è¡Œäº†----æ¯æ¬¡åšå®Œç»„ä»¶è§†å›¾å’Œå­è§†å›¾çš„å˜æ›´æ£€æµ‹ä¹‹åè°ƒç”¨&#x27;); &#125; ngOnDestroy() &#123; console.log(&#x27;08ngOnDestroyæ‰§è¡Œäº†Â·Â·Â·Â·&#x27;); &#125; //è‡ªå®šä¹‰æ–¹æ³• changeMsg() &#123; this.msg = &quot;æ•°æ®æ”¹å˜äº†&quot;; &#125;&#125; ç”Ÿå‘½å‘¨æœŸé’©å­è¯¦è§£constructorconstructor ï¼Œæ¥åˆå§‹åŒ–ç±»ã€‚ Angular ä¸­çš„ç»„ä»¶å°±æ˜¯åŸºäº class ç±»å®ç°çš„ï¼Œåœ¨ Angular ä¸­ï¼Œ constructor ç”¨äºæ³¨å…¥ä¾èµ–ã€‚ç»„ä»¶çš„æ„é€ å‡½æ•°ä¼šåœ¨æ‰€æœ‰çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¹‹å‰è¢«è°ƒç”¨ï¼Œå®ƒä¸»è¦ç”¨äºä¾èµ–æ³¨å…¥æˆ–æ‰§è¡Œç®€å•çš„æ•°æ®åˆå§‹åŒ–æ“ä½œã€‚ ngOnChanges()@input å±æ€§(è¾“å…¥å±æ€§)å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè°ƒç”¨ã€‚éæ­¤å±æ€§ï¼Œä¸ä¼šè°ƒç”¨ã€‚ å½“è¾“å…¥å±æ€§ä¸ºå¯¹è±¡æ—¶ï¼Œå½“å¯¹è±¡çš„å±æ€§å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¸ä¼šè°ƒç”¨ï¼Œå½“å¯¹è±¡çš„å¼•ç”¨å˜åŒ–æ—¶ä¼šè§¦å‘ ã€‚é¦–æ¬¡è°ƒç”¨ä¸€ å®šä¼šå‘ç”Ÿåœ¨ ngOnInit()ä¹‹å‰ã€‚ ngOnInit()åœ¨ Angular ç¬¬ä¸€æ¬¡æ˜¾ç¤ºæ•°æ®ç»‘å®šå’Œè®¾ç½®æŒ‡ä»¤/ç»„ä»¶çš„è¾“å…¥å±æ€§ä¹‹åï¼Œåˆå§‹åŒ–æŒ‡ä»¤/ç»„ä»¶ã€‚åœ¨ç¬¬ä¸€è½® ngOnChanges () å®Œæˆä¹‹åè°ƒç”¨ï¼Œåªè°ƒç”¨ä¸€æ¬¡ã€‚å¯ä»¥è¯·æ±‚æ•°æ® ä½¿ç”¨ ngOnInit() æœ‰ä¸¤ä¸ªåŸå› : åœ¨æ„é€ å‡½æ•°ä¹‹åé©¬ä¸Šæ‰§è¡Œå¤æ‚çš„åˆå§‹åŒ–é€»è¾‘åœ¨ Angular è®¾ç½®å®Œè¾“å…¥å±æ€§ä¹‹åï¼Œå¯¹è¯¥ç»„ä»¶è¿›è¡Œå‡†å¤‡ã€‚æœ‰ç»éªŒçš„å¼€å‘è€…ä¼šè®¤åŒç»„ä»¶çš„æ„å»ºåº”è¯¥å¾ˆä¾¿å®œå’Œå®‰å…¨ ngDoCheck()æ£€æµ‹ï¼Œå¹¶åœ¨å‘ç”Ÿ Angular æ— æ³•æˆ–ä¸æ„¿æ„è‡ªå·±æ£€æµ‹çš„å˜ åŒ–æ—¶ä½œå‡ºååº”ã€‚åœ¨æ¯ä¸ª Angular å˜æ›´æ£€æµ‹å‘¨æœŸä¸­è°ƒç”¨ï¼Œ ngOnChanges() å’Œ ngOnInit()ä¹‹åã€‚ ngAfterContentInit()å½“æŠŠå†…å®¹æŠ•å½±è¿›ç»„ä»¶ä¹‹åè°ƒç”¨ã€‚ç¬¬ä¸€æ¬¡ ngDoCheck() ä¹‹åè°ƒç”¨ï¼Œåªè°ƒç”¨ä¸€æ¬¡ ngAfterContentChecked()æ¯æ¬¡å®Œæˆè¢«æŠ•å½±ç»„ä»¶å†…å®¹çš„å˜æ›´æ£€æµ‹ä¹‹åè°ƒç”¨ã€‚ ngAfterContentInit() å’Œæ¯æ¬¡ ngDoCheck() ä¹‹åè°ƒ ngAfterViewInit()â€“æŒæ¡åˆå§‹åŒ–å®Œç»„ä»¶è§†å›¾åŠå…¶å­è§†å›¾ä¹‹åè°ƒç”¨ã€‚ç¬¬ä¸€ æ¬¡ ngAfterContentChecked() ä¹‹åè°ƒç”¨ï¼Œåªè°ƒç”¨ä¸€æ¬¡ã€‚åœ¨è¿™é‡Œå¯ä»¥æ“ä½œDOM ngAfterViewChecked()æ¯æ¬¡åšå®Œç»„ä»¶è§†å›¾å’Œå­è§†å›¾çš„å˜æ›´æ£€æµ‹ä¹‹åè°ƒç”¨ã€‚ ngAfterViewInit()å’Œæ¯æ¬¡ ngAfterContentChecked() ä¹‹å è°ƒç”¨ã€‚ ngOnDestroy()â€“æŒæ¡å½“ Angular æ¯æ¬¡é”€æ¯æŒ‡ä»¤/ç»„ä»¶ä¹‹å‰è°ƒç”¨å¹¶æ¸…æ‰«ã€‚åœ¨è¿™å„¿åè®¢é˜…å¯è§‚å¯Ÿå¯¹è±¡å’Œåˆ†ç¦»äº‹ä»¶å¤„ç†å™¨ï¼Œä»¥é˜²å†…å­˜æ³„ æ¼ã€‚åœ¨ Angular é”€æ¯æŒ‡ä»¤/ç»„ä»¶ä¹‹å‰è°ƒç”¨ã€‚æ¯”å¦‚ï¼šç§»é™¤äº‹ä»¶ç›‘å¬ã€æ¸…é™¤å®šæ—¶å™¨ã€é€€è®¢ Observable ç­‰ã€‚","updated":"2025-08-02T05:46:04.175Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"angualr","slug":"angualr","permalink":"https://luckyship.github.io/tags/angualr/"}]},{"title":"lesså’Œsassçš„åŒºåˆ«","date":"2021-04-06T14:20:21.000Z","path":"2021/04/06/2021-04-06-difference-sass-and-less/","text":"LESS å’Œ SCSS éƒ½å±äº CSS é¢„å¤„ç†å™¨çš„èŒƒç•´ï¼Œä¹Ÿå°±æ˜¯ CSS çš„è¶…é›†ï¼Œä½†æ˜¯ä¸¤è€…çš„è¯­æ³•ã€å¦‚ä½•ä½¿ç”¨å’Œå…·ä½“çš„åŠŸèƒ½å®ç°è¿˜æ˜¯æœ‰å·®å¼‚çš„ã€‚ å£°æ˜å’Œä½¿ç”¨å˜é‡ LESS é‡‡ç”¨ @ ç¬¦å·ï¼ŒSCSS é‡‡ç”¨ $ ç¬¦å·ã€‚ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨è§„åˆ™å¤–å£°æ˜äº†ä¸€ä¸ªåä¸º link-color çš„å˜é‡ï¼Œç„¶ååœ¨åä¸º #main çš„è§„åˆ™å†…å£°æ˜ä¸€ä¸ªåä¸º width çš„å˜é‡ï¼Œæ¥ç€æŠŠ width å˜é‡èµ‹å€¼ç»™äº† CSS çš„ width å±æ€§ã€‚ LESS: @link-color: #428bca;#main &#123; @width: 5em; width: @width;&#125; SCSS: $link-color: #428bca;#main &#123; $width: 5em; width: $width;&#125; å˜é‡æ’å€¼ï¼ˆVariable Interpolationï¼‰ LESS é‡‡ç”¨ @&#123;xxxx&#125; çš„å½¢å¼ï¼ŒSCSS é‡‡ç”¨ #&#123;xxxx&#125; çš„å½¢å¼ã€‚ LESSï¼š // Variables @my-selector: banner;// Usage .@&#123;my-selector&#125; &#123; font-weight: bold; line-height: 40px; margin: 0 auto;&#125; SCSS: // Variables $my-selector: banner;// Usage .#&#123;$my-selector&#125; &#123; font-weight: bold; line-height: 40px; margin: 0 auto;&#125; Mixins çš„å®šä¹‰ã€ä½¿ç”¨åŠå‚æ•°å®šä¹‰æ–¹æ³•å®šä¹‰ä¸€ä¸ª Mixinï¼šLESS ä½¿ç”¨ dot ç¬¦å·ï¼ˆä¹Ÿå°±æ˜¯å¥ç‚¹ï¼‰æ¥å®šä¹‰ä¸€ä¸ª Mixinï¼Œå¹¶ä¸”å¯ä»¥æŠŠä»»æ„çš„ CSS è§„åˆ™ä½œä¸º Mixin ä½¿ç”¨ï¼›SCSS ä½¿ç”¨ @mixin æŒ‡ä»¤æ¥å®šä¹‰ä¸€ä¸ª Mixinã€‚ ç¤ºä¾‹ - æ¥è‡ª BootStrap çš„ alert-variant Mixin çš„å®šä¹‰LESSï¼š .alert-variant(@background; @border; @text-color) &#123; background-color: @background; border-color: @border; color: @text-color; hr &#123; border-top-color: darken(@border, 5%); &#125; .alert-link &#123; color: darken(@text-color, 10%); &#125;&#125; SCSS: @mixin alert-variant($background, $border, $text-color) &#123; background-color: $background; border-color: $border; color: $text-color; hr &#123; border-top-color: darken($border, 5%); &#125; .alert-link &#123; color: darken($text-color, 10%); &#125;&#125; ä½¿ç”¨ä½¿ç”¨ Mixinï¼šLESS ä»æ˜¯ä½¿ç”¨ dot ç¬¦å·ï¼ˆå¥ç‚¹ï¼‰ï¼Œå¦‚æœ Mixin æ²¡æœ‰å‚æ•°çš„è¯å¯ä»¥çœç•¥åé¢çš„åœ†æ‹¬å·ï¼›SCSS ä½¿ç”¨ @include æŒ‡ä»¤æ¥å¼•å…¥ä¸€ä¸ª Mixinã€‚ ç¤ºä¾‹ - å¼•å…¥ä¸€ä¸ªåä¸º center-block çš„ Mixinã€‚LESSï¼š .center-block() &#123; display: block; margin-left: auto; margin-right: auto;&#125;.a &#123; .center-block;&#125; SCSS: @mixin center-block() &#123; display: block; margin-left: auto; margin-right: auto;&#125;.a &#123; @include center-block;&#125; å‚æ•°å½¢å¼å¦‚æœå­˜åœ¨å¤šä¸ªå‚æ•°çš„è¯ï¼ŒLESS ä½¿ç”¨åˆ†å·åˆ†éš”ï¼›SCSS ä½¿ç”¨é€—å·åˆ†éš”ã€‚ä¸¤è€…éƒ½æ”¯æŒä¸ºå‚æ•°è®¾ç½®é»˜è®¤å€¼ã€‚ ç¤ºä¾‹ - æ¥åœ¨ BootStrap çš„ form-control-validation Mixin çš„ä½¿ç”¨ LESSï¼š @state-success-text: #3c763d;@state-success-bg: #dff0d8;@state-success-border: darken(spin(@state-success-bg, -10), 5%);@state-info-text: #31708f;@state-info-bg: #d9edf7;@state-info-border: darken(spin(@state-info-bg, -10), 7%);@state-warning-text: #8a6d3b;@state-warning-bg: #fcf8e3;@state-warning-border: darken(spin(@state-warning-bg, -10), 5%);@state-danger-text: #a94442;@state-danger-bg: #f2dede;@state-danger-border: darken(spin(@state-danger-bg, -10), 5%);.box-shadow(@shadow) &#123; -webkit-box-shadow: @shadow; // iOS &lt;4.3 &amp; Android &lt;4.1 box-shadow: @shadow;&#125;.form-control-validation(@text-color: #555; @border-color: #ccc; @background-color: #f5f5f5) &#123; // Color the label and help text .help-block, .control-label, .radio, .checkbox, .radio-inline, .checkbox-inline, &amp;.radio label, &amp;.checkbox label, &amp;.radio-inline label, &amp;.checkbox-inline label &#123; color: @text-color; &#125; // Set the border and box shadow on specific inputs to match .form-control &#123; border-color: @border-color; .box-shadow(inset 0 1px 1px rgba(0, 0, 0, .075)); // Redeclare so transitions work &amp;:focus &#123; border-color: darken(@border-color, 10%); @shadow: inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 6px lighten(@border-color, 20%); .box-shadow(@shadow); &#125; &#125; // Set validation states also for addons .input-group-addon &#123; color: @text-color; border-color: @border-color; background-color: @background-color; &#125; // Optional feedback icon .form-control-feedback &#123; color: @text-color; &#125;&#125;// Feedback states .has-success &#123; .form-control-validation(@state-success-text; @state-success-text; @state-success-bg);&#125;.has-warning &#123; .form-control-validation(@state-warning-text; @state-warning-text; @state-warning-bg);&#125;.has-error &#123; .form-control-validation(@state-danger-text; @state-danger-text; @state-danger-bg);&#125; SCSS: $state-success-text: #3c763d;$state-success-bg: #dff0d8;$state-success-border: darken(adjust_hue($state-success-bg, -10), 5%);$state-info-text: #31708f;$state-info-bg: #d9edf7;$state-info-border: darken(adjust_hue($state-info-bg, -10), 7%);$state-warning-text: #8a6d3b;$state-warning-bg: #fcf8e3;$state-warning-border: darken(adjust_hue($state-warning-bg, -10), 5%);$state-danger-text: #a94442;$state-danger-bg: #f2dede;$state-danger-border: darken(adjust_hue($state-danger-bg, -10), 5%);@mixin box-shadow($shadow) &#123; -webkit-box-shadow: $shadow; // iOS &lt;4.3 &amp; Android &lt;4.1 box-shadow: $shadow;&#125;@mixin form-control-validation($text-color: #555, $border-color: #ccc, $background-color: #f5f5f5) &#123; // Color the label and help text .help-block, .control-label, .radio, .checkbox, .radio-inline, .checkbox-inline, &amp;.radio label, &amp;.checkbox label, &amp;.radio-inline label, &amp;.checkbox-inline label &#123; color: $text-color; &#125; // Set the border and box shadow on specific inputs to match .form-control &#123; border-color: $border-color; @include box-shadow(inset 0 1px 1px rgba(0, 0, 0, .075)); // Redeclare so transitions work &amp;:focus &#123; border-color: darken($border-color, 10%); $shadow: inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 6px lighten($border-color, 20%); @include box-shadow($shadow); &#125; &#125; // Set validation states also for addons .input-group-addon &#123; color: $text-color; border-color: $border-color; background-color: $background-color; &#125; // Optional feedback icon .form-control-feedback &#123; color: $text-color; &#125;&#125;// Feedback states .has-success &#123; @include form-control-validation($state-success-text, $state-success-text, $state-success-bg);&#125;.has-warning &#123; @include form-control-validation($state-warning-text, $state-warning-text, $state-warning-bg);&#125;.has-error &#123; @include form-control-validation($state-danger-text, $state-danger-text, $state-danger-bg);&#125; å‡½æ•°çš„ä½¿ç”¨å­—ç¬¦ä¸²å‡½æ•°LESS ä½¿ç”¨ e æˆ–è€… ~&quot;xxxx&quot; è¿™ç§è¯­æ³•è¿›è¡Œ CSS è½¬ä¹‰ï¼›SCSS æœ¬èº«å¹¶æ²¡æœ‰æä¾› CSS è½¬ä¹‰çš„å‡½æ•°ï¼Œè¦è¾¾åˆ°ç›¸åŒçš„æ•ˆæœå¯ä»¥ä½¿ç”¨å˜é‡æ’å€¼ï¼ˆVariable Interpolationï¼‰å®ç°ã€‚ LESS: @input-border-focus: #66afe9;.box-shadow(@shadow) &#123; -webkit-box-shadow: @shadow; // iOS &lt;4.3 &amp; Android &lt;4.1 box-shadow: @shadow;&#125;.form-control-focus(@color: @input-border-focus) &#123; @color-rgba: rgba(red(@color), green(@color), blue(@color), .6); &amp;:focus &#123; border-color: @color; outline: 0; .box-shadow(~&quot;inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px @&#123;color-rgba&#125;&quot;); //æˆ–è€… @str: &quot;inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px @&#123;color-rgba&#125;&quot; .box-shadow(e(@str)); &#125;&#125;.form-control &#123; .form-control-focus();&#125; SCSS: $input-border-focus: #66afe9;@mixin box-shadow($shadow) &#123; -webkit-box-shadow: $shadow; // iOS &lt;4.3 &amp; Android &lt;4.1 box-shadow: $shadow;&#125;@mixin form-control-focus($color: $input-border-focus) &#123; $color-rgba: rgba(red($color), green($color), blue($color), .6); &amp;:focus &#123; border-color: $color; outline: 0; @include box-shadow(#&#123;inset 0 1px 1px rgba(0,0,0,.075), 0 0 8px $color-rgba&#125;); &#125;&#125;.form-control &#123; @include form-control-focus();&#125; é¢œè‰²å‡½æ•°è°ƒèŠ‚è‰²ç›¸ï¼ŒLESS ä½¿ç”¨åä¸º spin() çš„å‡½æ•°ï¼›SCSS ä½¿ç”¨åä¸º adjust_hue() çš„å‡½æ•°ã€‚ LESS: @state-success-border: darken(spin(@state-success-bg, -10), 5%); SCSS: $state-success-border: darken(adjust_hue($state-success-bg, -10), 5%); æ•°å­¦å‡½æ•°LESS æä¾›äº†ä¸€äº› SCSS ä¸­å¹¶ä¸å…·å¤‡çš„æ•°å­¦å‡½æ•°ï¼Œåœ¨ SCSS ä¸­åªèƒ½é€šè¿‡è‡ªå®šä¹‰å‡½æ•°å®ç°ï¼Œç„¶åé€šè¿‡ node-sass çš„æ¥å£ä¼ é€’ç»™ç¼–è¯‘å™¨ã€‚ SCSSï¼š // rotate for ie8 and blow@mixin ie-rotate($rotation) &#123; -ms-filter: &quot;progid:DXImageTransform.Microsoft.BasicImage(rotation=@&#123;rotation&#125;)&quot;;&#125;// rotate for ie8 and blow// degrees unit@mixin ie-rotate-via-degrees($degrees) &#123; /* IE6-IE8 */ $radians: parseInt(&quot;#&#123;$degrees&#125;&quot;) * PI() * 2 / 360; $costheta: cos(&quot;#&#123;$radians&#125;&quot;); $sintheta: sin(&quot;#&#123;$radians&#125;&quot;); $negsintheta: &quot;#&#123;$sintheta&#125;&quot;* -1; -ms-filter: &quot;progid:DXImageTransform.Microsoft.Matrix(sizingMethod=&#x27;auto expand&#x27;, M11=@&#123;costheta&#125;, M12=@&#123;negsintheta&#125;, M21=@&#123;sintheta&#125;, M22=@&#123;costheta&#125;)&quot;; zoom: 1; :root &amp; &#123; filter: none; &#125;&#125;// support rotate for all browsers@mixin cross-rotate($degrees) &#123; @include rotate($degrees); @include ie-rotate-via-degrees($degrees);&#125;// Placeholder text@mixin placeholder($color: $input-placeholder-color) &#123; // Firefox &amp;::-moz-placeholder &#123; color: $color; opacity: 1; // Override Firefox&#x27;s unusual default opacity; see https://github.com/twbs/bootstrap/pull/11526 &#125; // Internet Explorer 10+ &amp;:-ms-input-placeholder &#123; color: $color; &#125; // Safari and Chrome &amp;::-webkit-input-placeholder &#123; color: $color; &#125;&#125; ä¸Šè¿° Math å®ç°æ‰€éœ€çš„ JS æ–‡ä»¶ï¼š module.exports = &#123; &#x27;parseInt($str)&#x27;: function(str) &#123; return parseInt(str, 10); &#125;, &#x27;Math.sin($degree)&#x27;: function(degree) &#123; return Math.sin(degree); &#125;, &#x27;Math.cos($degree)&#x27;: function(degree) &#123; return Math.cos(degree); &#125;, &#x27;Math.PI&#x27;: Math.PI&#125; æœ‰å…³å‡½æ•°çš„åŒºåˆ«è¿˜æœ‰ï¼šLESS çš„ fade() å‡½æ•°åœ¨ SCSS ä¸­åªèƒ½ä½¿ç”¨ rgba() ä¹‹ç±»çš„å®ç°ï¼Œå› ä¸º SCSS ä¹Ÿæ²¡æœ‰è¿™ä¸ªå‡½æ•°ã€‚ @import çš„å®ç° åƒ @media , @import è¿™äº›å¸¦ @ ç¬¦å·çš„åœ¨ CSS ä¸­éƒ½ç§°ä¸º At-rulesã€‚ å€¼çš„ä¸€æçš„æ˜¯ LESS å’Œ SCSS å¯¹ @import å®ç°çš„åŒºåˆ«ã€‚ LESS å¦‚æœæ‰©å±•åä¸º .cssï¼Œå°†æ–‡ä»¶è¯†åˆ«ä¸º CSS æ–‡ä»¶ å…¶ä»–ä»»ä½•æ‰©å±•åéƒ½å°†è¢«ä½œä¸º LESS æ–‡ä»¶å¤„ç† æ²¡æœ‰æ‰©å±•åä¼šè¢«é™„åŠ ä¸€ä¸ª .less çš„æ‰©å±•åå¹¶ä¸”ä½œä¸º LESS æ–‡ä»¶å¤„ç† SCSS é»˜è®¤æƒ…å†µä¸‹ï¼ŒSCSS çš„ @import å®ç°ä¼šè¯•å›¾å¯»æ‰¾ä¸€ä¸ª Sass æ–‡ä»¶è¿›è¡Œå¯¼å…¥ã€‚ ä½†æ˜¯åœ¨ä¸‹åˆ—æƒ…å†µå‡ºç°æ—¶ï¼Œ@import ä¼šç›´æ¥è¢«ç¼–è¯‘ä¸º CSS çš„ @import at-rule æ–‡ä»¶æ‰©å±•åæ˜¯ .css æ–‡ä»¶ä»¥ http:// å¼€å¤´ æ–‡ä»¶åæ˜¯ä¸€ä¸ª url() @import å…·æœ‰åª’ä½“æŸ¥è¯¢ SCSS æŒ‰çº¦å®šè®¤ä¸ºä¸‹åˆ’çº¿å¼€å§‹çš„æ–‡ä»¶æ˜¯å†…è”æ–‡ä»¶ï¼Œä¸ä¼šè¢«ç¼–è¯‘ä¸ºå•ç‹¬çš„ CSS æ–‡ä»¶è¾“å‡ºã€‚ ç¤ºä¾‹ LESS: @import &quot;foo&quot;;@import &quot;bar.less&quot;;@import &quot;foo.php&quot;; // å½“æˆ LESS æ–‡ä»¶å¤„ç†@import &quot;foo.css&quot;; SCSS: @import &quot;foo&quot;;@import &quot;foo.scss&quot;; éƒ½ä¼šå¯¼å…¥ foo.scss æ–‡ä»¶ã€‚ å…¶ä»–åŒºåˆ« LESS å’Œ SCSS å‡ä½¿ç”¨ &amp; ç¬¦å·è¡¨ç¤ºçˆ¶é€‰æ‹©å™¨å¼•ç”¨ï¼Œä½†æ˜¯ SCSS çš„ &amp; ç¬¦å·åªèƒ½å‡ºç°åœ¨ä¸€ä¸ªç»„åˆé€‰æ‹©å™¨çš„å¼€å§‹ä½ç½®ï¼ŒLESS åˆ™æ²¡æœ‰è¿™ä¸ªé™åˆ¶ã€‚ ç¤ºä¾‹ LESSï¼š .bg-variant(@color) &#123; background-color: @color; a&amp;:hover, a&amp;:focus &#123; background-color: darken(@color, 10%); &#125;&#125; SCSS: a &#123; font-weight: bold; text-decoration: none; &amp;:hover &#123; text-decoration: underline; &#125; body.firefox &amp; &#123; font-weight: normal; &#125;&#125; SCSS ä¸æ”¯æŒ LESS ä¸­çš„ CSS Guard åŠŸèƒ½ï¼Œæ¯”å¦‚ if, when ... ï¼Œåœ¨ SCSS ä¸­éœ€è¦æ¢ç§æ–¹å¼å®ç°ã€‚ LESS ç¤ºä¾‹ï¼š .my-optional-style() when (@my-option =true) &#123; button &#123; color: white; &#125;&#125;.my-optional-style(); Noteï¼šSCSS éœ€è¦æ¢ä¸€ç§å†™æ³•å®ç°åŒæ ·çš„åŠŸèƒ½ã€‚ SCSS æ”¯æŒ !defaultï¼Œä¸€èˆ¬æ˜¯ç”¨åœ¨åŸºç¡€ Rule çš„å£°æ˜ä¸­ï¼Œå‘Šè¯‰ä½¿ç”¨è€…è¿™æ˜¯å¯ä»¥è¢«è¦†ç›–çš„ã€‚ SCSS ç¤ºä¾‹ï¼š $primary: $blue !default;$secondary: $gray-600 !default; SCSSæ”¯æŒ if, else, for, each ç­‰æ–¹æ³•, LESSä¸æ”¯æŒ SCSS: $type: monster;p &#123; @if $type==ocean &#123; color: blue; &#125; @else if $type==matador &#123; color: red; &#125; @else if $type==monster &#123; color: green; &#125; @else &#123; color: black; &#125;&#125;@for $i from 1 through 3 &#123; .item-#&#123;$i&#125; &#123; width: 2em * $i; &#125;&#125;@each $animal in puma,sea-slug,egret,salamander &#123; .#&#123;$animal&#125;-icon &#123; background-image: url(&#x27;/images/#&#123;$animal&#125;.png&#x27;); &#125;&#125; SCSS ä¸åƒ LESS ä¸€æ ·é»˜è®¤å¯ä»¥æŠŠ rule ä½œä¸º Mixin ä½¿ç”¨ï¼Œä½†æ˜¯ SCSS æœ‰ç±»ä¼¼çš„ @extend æŒ‡ä»¤ï¼›è€Œ LESS çš„ extend è¯­æ³•çœ‹èµ·æ¥åˆ™åƒæ˜¯ä¼ªç±»ä¸€æ ·ã€‚ ç¤ºä¾‹ï¼š LESS: .error &#123; border: 1px #f00; background-color: #fdd;&#125;.seriousError &#123; @extend .error; border-width: 3px;&#125; SCSS: .error &#123; border: 1px #f00; background-color: #fdd;&#125;.seriousError &#123; @extend .error; border-width: 3px;&#125; é›†æˆ JavaScript åŠŸèƒ½çš„æ–¹å¼ï¼šLESS ä½¿ç”¨ @functions æŒ‡ä»¤ï¼Œå¯ä»¥æŠŠ js ä»£ç ç›´æ¥æ”¾åˆ° ~ xxx ä¸­é—´å³å¯ï¼›SCSS å¯ä»¥æŠŠ JS ä»£ç æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ï¼Œç„¶åä½¿ç”¨ node-sassç¼–è¯‘çš„æ—¶å€™æŒ‡å®šå‚æ•°ä¼ ç»™ node-sassã€‚ LESS ç¤ºä¾‹ï¼šant-design/ant-design SCSS ç¤ºä¾‹ï¼šå‘½ä»¤ node-sass --output-style expanded --source-map true --precision 6 --functions components/style/custom.js components/button/style/index.scss components/button/style/index.css LESS æ”¯æŒ lazy evaluationï¼Œä½†æ˜¯ SCSS ä¸æ”¯æŒï¼Œæ‰€ä»¥åœ¨ LESS ä¸­å¯ä»¥å…ˆä½¿ç”¨å†å®šä¹‰ï¼Œä½†æ˜¯åœ¨ SCSS ä¸­ä¸€å®šè¦å…ˆå®šä¹‰å†ä½¿ç”¨ã€‚ SCSS æ˜¯ä¸æ”¯æŒ Mixin é‡è½½çš„, ä¹Ÿå°±æ˜¯è¯´ LESS å¯ä»¥æœ‰åŒåä½†æ˜¯å‚æ•°ä¸ªæ•°ä¸åŒçš„å‡ ä¸ª Mixins, SCSS åŒæ ·åå­—çš„ Mixin åªèƒ½æœ‰ä¸€ä¸ª. å‚è€ƒlesså’Œsassæˆ–è€…scss æœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿ LESSå®˜ç½‘SASSå®˜ç½‘","updated":"2025-08-02T05:46:04.175Z","tags":[{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"},{"name":"sass","slug":"sass","permalink":"https://luckyship.github.io/tags/sass/"},{"name":"less","slug":"less","permalink":"https://luckyship.github.io/tags/less/"}]},{"title":"cssä¸­çš„æ¢è¡Œ","date":"2021-04-06T06:58:25.000Z","path":"2021/04/06/2021-04-06-css-wrap-line/","text":"å¼ºåˆ¶ä¸æ¢è¡Œ: p &#123; white-space:nowrap; &#125; è‡ªåŠ¨æ¢è¡Œ: p &#123; word-wrap:break-word; &#125; å¼ºåˆ¶è‹±æ–‡å•è¯æ–­è¡Œ: p &#123; word-break:break-all; &#125; æ³¨æ„ï¼šè®¾ç½®å¼ºåˆ¶å°†è‹±æ–‡å•è¯æ–­è¡Œï¼Œéœ€è¦å°†è¡Œå†…å…ƒç´ è®¾ç½®ä¸ºå—çº§å…ƒç´ ã€‚ è¶…å‡ºæ˜¾ç¤ºçœç•¥å·: p&#123;text-overflow:ellipsis;overflow:hidden;&#125; white-space: normal|pre|nowrap|pre-wrap|pre-line|inherit;white-space: å±æ€§è®¾ç½®å¦‚ä½•å¤„ç†å…ƒç´ å†…çš„ç©ºç™½ normal: é»˜è®¤ã€‚ç©ºç™½ä¼šè¢«æµè§ˆå™¨å¿½ç•¥ã€‚ pre: ç©ºç™½ä¼šè¢«æµè§ˆå™¨ä¿ç•™ã€‚å…¶è¡Œä¸ºæ–¹å¼ç±»ä¼¼ HTML ä¸­çš„ pre æ ‡ç­¾ã€‚ nowrap: æ–‡æœ¬ä¸ä¼šæ¢è¡Œï¼Œæ–‡æœ¬ä¼šåœ¨åœ¨åŒä¸€è¡Œä¸Šç»§ç»­ï¼Œç›´åˆ°é‡åˆ° br æ ‡ç­¾ä¸ºæ­¢ã€‚ pre-wrap: ä¿ç•™ç©ºç™½ç¬¦åºåˆ—ï¼Œä½†æ˜¯æ­£å¸¸åœ°è¿›è¡Œæ¢è¡Œã€‚ pre-line: åˆå¹¶ç©ºç™½ç¬¦åºåˆ—ï¼Œä½†æ˜¯ä¿ç•™æ¢è¡Œç¬¦ã€‚ inherit: è§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ white-space å±æ€§çš„å€¼ã€‚ word-wrap: normal|break-word; word-wrap: å±æ€§ç”¨æ¥æ ‡æ˜æ˜¯å¦å…è®¸æµè§ˆå™¨åœ¨å•è¯å†…è¿›è¡Œæ–­å¥ï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢å½“ä¸€ä¸ªå­—ç¬¦ä¸²å¤ªé•¿è€Œæ‰¾ä¸åˆ°å®ƒçš„è‡ªç„¶æ–­å¥ç‚¹æ—¶äº§ç”Ÿæº¢å‡ºç°è±¡ã€‚ normal: åªåœ¨å…è®¸çš„æ–­å­—ç‚¹æ¢è¡Œ(æµè§ˆå™¨ä¿æŒé»˜è®¤å¤„ç†) break-word: åœ¨é•¿å•è¯æˆ– URL åœ°å€å†…éƒ¨è¿›è¡Œæ¢è¡Œ word-break: normal|break-all|keep-all; word-break å±æ€§ç”¨æ¥æ ‡æ˜æ€ä¹ˆæ ·è¿›è¡Œå•è¯å†…çš„æ–­å¥ã€‚ normalï¼šä½¿ç”¨æµè§ˆå™¨é»˜è®¤çš„æ¢è¡Œè§„åˆ™ã€‚ break-all: å…è®¸å†å•è¯å†…æ¢è¡Œ keep-all: åªèƒ½åœ¨åŠè§’ç©ºæ ¼æˆ–è¿å­—ç¬¦å¤„æ¢è¡Œ å®ä¾‹&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot; /&gt; &lt;title&gt;èœé¸Ÿæ•™ç¨‹(runoob.com)&lt;/title&gt; &lt;style&gt; .word &#123; background: #e4ffe9; width: 250px; margin: 50px auto; padding: 20px; font-family: &quot;microsoft yahei&quot;; &#125; /* å¼ºåˆ¶ä¸æ¢è¡Œ */ .nowrap &#123; white-space: nowrap; &#125; /* å…è®¸å•è¯å†…æ–­å¥ï¼Œé¦–å…ˆä¼šå°è¯•æŒªåˆ°ä¸‹ä¸€è¡Œï¼Œçœ‹çœ‹ä¸‹ä¸€è¡Œçš„å®½åº¦å¤Ÿä¸å¤Ÿï¼Œ ä¸å¤Ÿçš„è¯å°±è¿›è¡Œå•è¯å†…çš„æ–­å¥ */ .breakword &#123; word-wrap: break-word; &#125; /* æ–­å¥æ—¶ï¼Œä¸ä¼šæŠŠé•¿å•è¯æŒªåˆ°ä¸‹ä¸€è¡Œï¼Œè€Œæ˜¯ç›´æ¥è¿›è¡Œå•è¯å†…çš„æ–­å¥ */ .breakAll &#123; word-break: break-all; &#125; /* è¶…å‡ºéƒ¨åˆ†æ˜¾ç¤ºçœç•¥å· */ .ellipsis &#123; text-overflow: ellipsis; overflow: hidden; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;word&quot;&gt; &lt;p class=&quot;normal&quot;&gt; wordwrap:break-word;absavhsafhuafdfbjhfvsalguvfaihuivfsa &lt;/p&gt; &lt;p class=&quot;nowrap&quot;&gt; wordwrap:break-word;absavhsafhuafdfbjhfvsalguvfaihuivfs &lt;/p&gt; &lt;p class=&quot;breakword&quot;&gt; wordwrap:break-word;absavhsafhuafdfbjhfvsalguvfaihui &lt;/p&gt; &lt;p class=&quot;breakAll&quot;&gt; wordwrap:break-word;absavhsafhuafdfbjhfvsalguvfaihuivf &lt;/p&gt; &lt;p class=&quot;ellipsis&quot;&gt; wordwrap:breakword;absavhsafhuafdfbjhfvsalguvfaihuivfsab &lt;/p&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt;","updated":"2025-08-02T05:46:04.175Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"}]},{"title":"escape, encodeURI, encodeURIComponentæœ‰ä»€ä¹ˆåŒºåˆ«","date":"2021-04-06T06:27:26.000Z","path":"2021/04/06/2021-04-06-difference-escape-encodeURI-encodeURIComponent/","text":"escape , encodeURI , encodeURIComponent éƒ½æ˜¯ javascript çš„ç¼–ç æ–¹æ³• escapeç®€å•æ¥è¯´ï¼Œescapeæ˜¯å¯¹å­—ç¬¦ä¸²(string)è¿›è¡Œç¼–ç (è€Œå¦å¤–ä¸¤ç§æ˜¯å¯¹URL)ï¼Œä½œç”¨æ˜¯è®©å®ƒä»¬åœ¨æ‰€æœ‰ç”µè„‘ä¸Šå¯è¯»ã€‚ç¼–ç ä¹‹åçš„æ•ˆæœæ˜¯%XXæˆ–è€…%uXXXXè¿™ç§å½¢å¼ã€‚å…¶ä¸­ ASCIIå­—æ¯ ã€ æ•°å­— ã€ @*/+ è¿™å‡ ä¸ªå­—ç¬¦ä¸ä¼šè¢«ç¼–ç ï¼Œå…¶ä½™çš„éƒ½ä¼šã€‚æœ€å…³é”®çš„æ˜¯ï¼Œå½“ä½ éœ€è¦å¯¹URLç¼–ç æ—¶ï¼Œè¯·å¿˜è®°è¿™ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯é’ˆå¯¹å­—ç¬¦ä¸²ä½¿ç”¨çš„ï¼Œä¸é€‚ç”¨äºURLã€‚ encodeURIå’ŒencodeURIComponentåŒºåˆ«å¯¹URLç¼–ç æ˜¯å¸¸è§çš„äº‹ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªæ–¹æ³•åº”è¯¥æ˜¯å®é™…ä¸­è¦ç‰¹åˆ«æ³¨æ„çš„ã€‚å®ƒä»¬éƒ½æ˜¯ç¼–ç URLï¼Œå”¯ä¸€åŒºåˆ«å°±æ˜¯ç¼–ç çš„å­—ç¬¦èŒƒå›´ï¼Œå…¶ä¸­ encodeURI æ–¹æ³•ä¸ä¼šå¯¹ä¸‹åˆ—å­—ç¬¦ç¼–ç  ASCIIå­—æ¯ æ•°å­— ~!@#$&amp;*()=:/, ; ?+&#39; encodeURIComponentæ–¹æ³•ä¸ä¼šå¯¹ä¸‹åˆ—å­—ç¬¦ç¼–ç  ASCIIå­—æ¯ æ•°å­— ~!*()&#39; æ‰€ä»¥ encodeURIComponent æ¯” encodeURI ç¼–ç çš„èŒƒå›´æ›´å¤§ã€‚å®é™…ä¾‹å­æ¥è¯´ï¼Œ encodeURIComponent ä¼šæŠŠ http:// ç¼–ç æˆ http%3A%2F%2F è€Œ encodeURI å´ä¸ä¼šã€‚ ä½¿ç”¨åœºæ™¯1ã€å¦‚æœåªæ˜¯ç¼–ç å­—ç¬¦ä¸²ï¼Œä¸å’ŒURLæœ‰åŠæ¯›é’±å…³ç³»ï¼Œé‚£ä¹ˆç”¨ escape ã€‚ 2ã€å¦‚æœä½ éœ€è¦ç¼–ç æ•´ä¸ªURLï¼Œç„¶åéœ€è¦ä½¿ç”¨è¿™ä¸ªURLï¼Œé‚£ä¹ˆç”¨ encodeURI ã€‚ 3ã€å½“ä½ éœ€è¦ç¼–ç URLä¸­çš„å‚æ•°çš„æ—¶å€™ï¼Œé‚£ä¹ˆencodeURIComponentæ˜¯æœ€å¥½æ–¹æ³•ã€‚ var param = &quot;http://www.cnblogs.com/season-huang/&quot;; //paramä¸ºå‚æ•°param = encodeURIComponent(param);var url = &quot;http://www.cnblogs.com?next=&quot; + param;console.log(url) //&quot;http://www.cnblogs.com?next=http%3A%2F%2Fwww.cnblogs.com%2Fseason-huang%2F&quot; å‚è€ƒescape, encodeURI, encodeURIComponentæœ‰ä»€ä¹ˆåŒºåˆ«","updated":"2025-08-02T05:46:04.175Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"ä½¿ç”¨csså®ç°4ä¸ªè§’è¾¹æ¡†","date":"2021-03-20T09:45:39.000Z","path":"2021/03/20/2021-03-20-four-angle-border-by-css/","text":"ç›®å‰å‘ç°2ç§å®ç°æ–¹å¼ï¼Œä½¿ç”¨ css3 background æˆ–è€…ä½¿ç”¨ä¼ªå…ƒç´  css3 backgroundå®ç°.rect &#123; position: absolute; top: 20px; left: 20px; width: 100px; height: 100px; background: linear-gradient(to left, #f00, #f00) left top no-repeat, linear-gradient(to bottom, #f00, #f00) left top no-repeat, linear-gradient(to left, #f00, #f00) right top no-repeat, linear-gradient(to bottom, #f00, #f00) right top no-repeat, linear-gradient(to left, #f00, #f00) left bottom no-repeat, linear-gradient(to bottom, #f00, #f00) left bottom no-repeat, linear-gradient(to left, #f00, #f00) right bottom no-repeat, linear-gradient(to left, #f00, #f00) right bottom no-repeat; background-size: 1px 20px, 20px 1px, 1px 20px, 20px 1px;&#125; &lt;div class=&quot;rect&quot;&gt;&lt;/div&gt; ä¼ªå…ƒç´ å®ç°#border &#123; width: 100px; height: 50px; position: relative;&#125;#border:after &#123; position: absolute; top: 0; left: 0; content: &#x27;&#x27;; display: block; height: 25%; width: 25%; border-left: 1px solid black; border-top: 1px solid black;&#125;#border:before &#123; position: absolute; top: 0; right: 0; content: &#x27;&#x27;; display: block; height: 25%; width: 25%; border-right: 1px solid black; border-top: 1px solid black;&#125;#border2 &#123; width: 100px; height: 50px; position: relative;&#125;#border2:after &#123; position: absolute; bottom: 0; left: 0; content: &#x27;&#x27;; display: block; height: 25%; width: 25%; border-left: 1px solid black; border-bottom: 1px solid black;&#125;#border2:before &#123; position: absolute; bottom: 0; right: 0; content: &#x27;&#x27;; display: block; height: 25%; width: 25%; border-right: 1px solid black; border-bottom: 1px solid black;&#125; &lt;div id=&#x27;border&#x27;&gt;&lt;/div&gt;&lt;div id=&#x27;border2&#x27;&gt;&lt;/div&gt; å‚è€ƒdivåªæœ‰å››ä¸ªè§’æœ‰è¾¹æ¡†æ€ä¹ˆå®ç°ï¼Ÿ","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"}]},{"title":"è·¨åŸŸï¼ˆæœåŠ¡ç«¯è§£å†³ï¼‰","date":"2021-03-20T09:31:30.000Z","path":"2021/03/20/2021-03-20-cross-domain-server/","text":"åœ¨å¼€å‘webé¡¹ç›®çš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡è§è·¨åŸŸé—®é¢˜ï¼Œè™½ç„¶æ˜¯ä¸ªå‰ç«¯ï¼Œä½†æ˜¯äº†è§£ä¸€äº›åç«¯è§£å†³è·¨åŸŸçš„æ–¹æ³•ï¼Œæœ‰åŠ©äºæˆ‘ä»¬æ›´å¿«è§£å†³é—®é¢˜ nodejs expressæ¡†æ¶è·¨åŸŸè§£å†³app.all(&quot;*&quot;, function(req, res, next) &#123; //è®¾ç½®å…è®¸è·¨åŸŸçš„åŸŸåï¼Œ*ä»£è¡¨å…è®¸ä»»æ„åŸŸåè·¨åŸŸ res.header(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;); //å…è®¸çš„headerç±»å‹ res.header(&quot;Access-Control-Allow-Headers&quot;, &quot;Origin, X-Requested-With, Content-Type, Accept, Authorization&quot;); //è·¨åŸŸå…è®¸çš„è¯·æ±‚æ–¹å¼ res.header(&quot;Access-Control-Allow-Methods&quot;, &quot;DELETE,PUT,POST,GET,OPTIONS&quot;); next();&#125;); nginxè½¬å‘è·¨åŸŸnginxè®¾ç½® location ~ ^/aaaa &#123; add_header Access-Control-Allow-Origin *; add_header Access-Control-Allow-Methods &#x27;GET, POST, OPTIONS&#x27;; add_header Access-Control-Allow-Headers &#x27;Origin, X-Requested-With, Content-Type, Accept, Authorization&#x27;; proxy_pass http://xx.xx.xx.xx:7071;&#125;","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"nodejs","slug":"nodejs","permalink":"https://luckyship.github.io/tags/nodejs/"}]},{"title":"node-sasså®‰è£…å¤±è´¥é—®é¢˜æ±‡æ€»","date":"2021-03-20T09:17:45.000Z","path":"2021/03/20/2021-03-20-node-sass-failure/","text":"node-scss æ˜¯æˆ‘ä»¬å¸¸è§çš„ä¾èµ–åŒ…ï¼Œä½†æ˜¯å®‰è£…çš„æ—¶å€™ï¼Œ node-scss æ€»æ˜¯æŠ¥é”™ï¼Œç‰¹åœ°æ±‡æ€»ä¸€ä¸‹ï¼Œä»¥é¿å…è¸©å‘ npm æºé€Ÿåº¦æ…¢ç”±äºä¼—æ‰€å‘¨çŸ¥çš„å›½å†…ç½‘ç»œç¯å¢ƒï¼Œä»å›½å†…å®‰è£…å®˜æ–¹æºçš„ä¾èµ–åŒ…ä¼šå¾ˆæ…¢ã€‚å¯ä»¥å°† npm æºè®¾ç½®æˆå›½å†…é•œåƒæº(å¦‚æ·˜å® npm)ï¼š npm config set registry https://registry.npm.taobao.org æˆ–è€…é€šè¿‡ .npmrc æ–‡ä»¶è®¾ç½®: // .npmrcregistry=https://registry.npm.taobao.org/ binding.node æºæ— æ³•è®¿é—®æˆ–é€Ÿåº¦æ…¢node-sass é™¤äº† npm éƒ¨åˆ†çš„ä»£ç ï¼Œè¿˜ä¼šä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶ binding.node ï¼Œé»˜è®¤æºæ˜¯ githubï¼Œå›½å†…è®¿é—®è¾ƒæ…¢, ç‰¹æ®Šæ—¶æœŸç”šè‡³æ— æ³•è®¿é—®ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å…¶æ”¹æˆå›½å†…æºï¼š // linuxã€mac ä¸‹SASS_BINARY_SITE=https://npm.taobao.org/mirrors/node-sass/ npm install node-sass// window ä¸‹set SASS_BINARY_SITE=https://npm.taobao.org/mirrors/node-sass/ &amp;&amp; npm install node-sass æœ‰ç±»ä¼¼é—®é¢˜çš„è¿˜æœ‰ chromedriver, phantomjs, electron ç­‰å¸¸è§ä¾èµ–åŒ…, æˆ‘ä»¬å¯ä»¥ä¸€å¹¶å†™åˆ°.npmrc ä¸­: // .npmrcsass_binary_site=https://npm.taobao.org/mirrors/node-sasschromedriver_cdnurl=https://npm.taobao.org/mirrors/chromedriverphantomjs_cdnurl=https://npm.taobao.org/mirrors/phantomjselectron_mirror=https://npm.taobao.org/mirrors/electron å¯ä»¥å‚è€ƒnpm å®‰è£… node ç‰ˆæœ¬ä¸ node-sass ç‰ˆæœ¬ä¸å…¼å®¹node-sass ç‰ˆæœ¬å…¼å®¹æ€§å¹¶ä¸å¥½ï¼Œè€é¡¹ç›®ä¸­ä¾èµ–çš„ node-sass å¾ˆå¯èƒ½å·²ç»ä¸å…¼å®¹æ–°çš„ nodeï¼Œå¯¹åº”ç‰ˆæœ¬å…¼å®¹å¦‚ä¸‹(æˆ–å‚è€ƒå®˜æ–¹ä»“åº“)ï¼š NodeJS Minimum node-sass version Node Module Node 8 4.5.3+ 57 Node 13 4.13+ 79 Node 12 4.12+ 72 Node 11 4.10+ 67 Node 10 4.9+ 64 ç¼“å­˜ä¸­ binding.node ç‰ˆæœ¬ä¸ä¸€è‡´å‡å¦‚æœ¬åœ° node ç‰ˆæœ¬æ”¹äº†ï¼Œæˆ–åœ¨ä¸åŒæœºå™¨ä¸Šè¿è¡Œï¼Œnode ç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œä¼šæŠ¥ç±»ä¼¼é”™è¯¯ï¼š Found bindings for the following environments: - Windows 64-bit with Node.js 6.x è¿™æ˜¯å› ä¸ºåŸæœ‰ binding.node ç¼“å­˜è·Ÿç° node ç‰ˆæœ¬ä¸ä¸€è‡´ã€‚æŒ‰æç¤º npm rebuild node-sass æˆ–æ¸…é™¤ç¼“å­˜é‡æ–°å®‰è£…å³å¯ã€‚ å®‰è£…å¤±è´¥åé‡æ–°å®‰è£…å®‰è£…å¤±è´¥åé‡æ–°å®‰è£…ï¼Œæœ‰å¯èƒ½æ— æƒé™åˆ é™¤å·²å®‰è£…å†…å®¹ï¼Œæ­¤æ—¶ npm uninstall node-sass æˆ–æ‰‹åŠ¨åˆ æ‰åŸç›®å½•åå†å®‰è£…å³å¯ã€‚ æç¤ºæ²¡æœ‰å®‰è£… pythonã€build å¤±è´¥ç­‰å‡å¦‚æ‹‰å– binding.node å¤±è´¥ï¼Œnode-sass ä¼šå°è¯•åœ¨æœ¬åœ°ç¼–è¯‘ binding.node ï¼Œè¿‡ç¨‹å°±éœ€è¦ python ã€‚å‡å¦‚ä½ é‡åˆ°å‰é¢å‡ ç§æƒ…å†µè§£å†³äº†ï¼Œå®é™…ä¸Šä¹Ÿä¸ä¼šå‡ºç°åœ¨æœ¬åœ°æ„å»ºçš„æƒ…å†µäº†ï¼Œæˆ‘ä»¬å°±ä¸è°ˆè¿™ç§å¤±è´¥ä¸­å¤±è´¥çš„æƒ…å†µå§ :-)","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"nodejs","slug":"nodejs","permalink":"https://luckyship.github.io/tags/nodejs/"},{"name":"npm","slug":"npm","permalink":"https://luckyship.github.io/tags/npm/"},{"name":"sass","slug":"sass","permalink":"https://luckyship.github.io/tags/sass/"}]},{"title":"angular cssæ ·å¼ä½œç”¨åŸŸ","date":"2021-03-20T08:56:01.000Z","path":"2021/03/20/2021-03-20-angular-css-scope/","text":"åœ¨ä½¿ç”¨ angular æ—¶ï¼Œæˆ‘ä»¬å‘ç°æ¯ä¸ªç»„ä»¶çš„ css ä½œç”¨åŸŸéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œä¸”æ— æ³•ä¿®æ”¹å¼•ç”¨ç»„ä»¶çš„æ ·å¼ï¼Œè¿™æ˜¯å› ä¸ºï¼š åœ¨å°è£…ç»„ä»¶çš„æ—¶å€™ï¼Œç»„ä»¶ä¼šåˆ†é…ä¸€ä¸ªå”¯ä¸€çš„å±æ€§ï¼Œå¹¶å°†è¿™ä¸ªå±æ€§æ·»åŠ åˆ°ç»„ä»¶å†…çš„æ¯ä¸€ä¸ªæ ‡ç­¾ä¸Šï¼Œå°è£…åçš„æ ·å¼è¡¨çš„é€‰æ‹©å™¨ä¸­ä¼šåŠ ä¸Šå±æ€§é€‰æ‹©å™¨ï¼Œä»è€Œå½¢æˆäº†ä¸€ä¸ªæ ·å¼è¡¨çš„ä½œç”¨åŸŸï¼ŒåŸŸå†…æ ·å¼ä¸ä¼šå½±å“å¤–éƒ¨è¿™ä¸ Vue ä¸­çš„ scoped å±æ€§åŸç†ä¸€æ ·ï¼Œæˆ‘ä»¬å¼•å…¥ ViewEncapsulation ç±»å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ ViewEncapsulationenum ViewEncapsulation &#123; Emulated Native None&#125; ViewEncapsulation çš„å€¼æ˜¯ç”¨æ¥æŒ‡å®šï¼Œåœ¨å°è£… Angular ç»„ä»¶çš„æ—¶å€™ï¼Œå¦‚ä½•å¤„ç†æ ·å¼å’Œæ ‡ç­¾ä¹‹é—´çš„å…³ç³»ï¼Œé»˜è®¤å€¼æ˜¯ï¼š ViewEncapsulation. Emulated ;ç”¨æ³•æ˜¯ï¼š import &#123; ViewEncapsulation&#125; from &quot;@angular/core&quot;;@Component(&#123; templateUrl: &quot;./login.html&quot;, styleUrls: [&#x27;./login.css&#x27;, &#x27;/bootstrap/css/bootstrap.min.css&#x27;], encapsulation: ViewEncapsulation.Emulated&#125;) ViewEncapsulation.Emulatedï¼ˆé»˜è®¤å€¼ï¼‰è¿™ç§æ–¹å¼åœ¨å°è£…ç»„ä»¶çš„æ—¶å€™ï¼Œä¼šç»™ç»„ä»¶åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„å±æ€§ï¼Œå¹¶å°†è¿™ä¸ªå±æ€§æ·»åŠ åˆ°ç»„ä»¶å†…çš„æ¯ä¸€ä¸ªæ ‡ç­¾ä¸Šï¼Œå°è£…åçš„æ ·å¼è¡¨çš„é€‰æ‹©å™¨ä¸­ä¼šåŠ ä¸Šå±æ€§é€‰æ‹©å™¨ï¼Œä»è€Œå½¢æˆäº†ä¸€ä¸ªæ ·å¼è¡¨çš„ä½œç”¨åŸŸï¼ŒåŸŸå†…æ ·å¼ä¸ä¼šå½±å“å¤–éƒ¨ï¼Œä½†æ˜¯ç»„ä»¶ä¼šå—åˆ°çˆ¶çº§æ ·å¼çš„å½±å“ å³ï¼šåªè¿›ä¸å‡ºï¼Œå…¨å±€æ ·å¼èƒ½è¿›æ¥ï¼Œç»„ä»¶æ ·å¼å‡ºä¸å» ViewEncapsulation.ShadowDomè¿™ç§æ–¹å¼æŠŠç»„ä»¶å°è£…æˆä¸€ä¸ª shadow DOMï¼› å³ï¼š ä¸è¿›ä¸å‡ºï¼Œæ²¡æœ‰æ ·å¼èƒ½è¿›æ¥ï¼Œç»„ä»¶æ ·å¼å‡ºä¸å»ã€‚ ä»€ä¹ˆæ˜¯ shadow DOM ViewEncapsulation.Noneè¿™ç§æ–¹æ³•çš„æ ·å¼è¡¨ä¸ºå…¨å±€çš„ä½œç”¨åŸŸï¼Œç»„ä»¶ä¸­å£°æ˜çš„æ ·å¼æ—¢å¯ä»¥å½±å“åˆ°æœ¬ç»„ä»¶ï¼ŒåŒæ—¶ä¹Ÿä¼šå½±å“å…¨å±€æ ·å¼è¡¨ï¼›åè¿‡æ¥ï¼Œè¯¥ç»„ä»¶æ”¶å…¨å±€æ ·å¼è¡¨çš„å½±å“ã€‚ ä¸¤ç§æƒ…å†µï¼š1ã€å¤–éƒ¨æ ·å¼è¡¨ä½œç”¨çš„æ ‡ç­¾æ˜¯é™æ€çš„ï¼ˆå¦‚ bootstrap ï¼‰: ç›´æ¥åœ¨ç»„ä»¶å…ƒæ•°æ®ä¸­å¼•å…¥ï¼Œä½¿ç”¨é»˜è®¤æ–¹å¼ï¼š @Component(&#123; templateUrl: &quot;./login.html&quot;, styleUrls: [&#x27;./login.css&#x27;, &#x27;/bootstrap/css/bootstrap.min.css&#x27;]&#125;) 2ã€æ ·å¼è¡¨ä½œç”¨äºåŠ¨æ€åˆ›å»ºçš„æ ‡ç­¾ï¼ˆå¦‚åˆ›å»ºä¸€ä¸ªå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ CKEditor ï¼Œ wangEditor ç­‰ï¼‰ï¼š å› ä¸ºæ ‡ç­¾æ˜¯åŠ¨æ€åˆ›å»ºçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ‰“åŒ…ç»„ä»¶çš„æ—¶å€™ï¼Œå¼•å…¥çš„å¤–éƒ¨æ ·å¼è¡¨ä½œç”¨çš„æ ‡ç­¾å°šæœªå­˜åœ¨ï¼ˆä»£ç è¿è¡Œçš„æ—¶å€™ï¼Œnew ä¸€ä¸ª Editor ä¹‹åæ‰ä¼šåˆ›å»ºæ ‡ç­¾ï¼‰ï¼Œè€Œæ‰“åŒ…çš„æ—¶å€™å´ç»™æ‰€æœ‰é€‰æ‹©å™¨éƒ½æ·»åŠ äº†ä¸€ä¸ªå±æ€§é€‰æ‹©å™¨ï¼Œå› æ­¤ï¼ŒåŠ¨æ€åˆ›å»ºçš„æ ‡ç­¾å°±ä¸ä¼šè¢«å¼•å…¥çš„æ ·å¼è¡¨å½±å“ã€‚ä¹Ÿå°±æ˜¯è¯´æ–°åˆ›å»ºçš„æ ‡ç­¾ä¸å±äºç»„ä»¶è¿™ä¸ªä½œç”¨åŸŸã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œåªèƒ½åœ¨æ‰“åŒ…ç»„ä»¶çš„æ—¶å€™ï¼Œä¸ç»™è¿™ä¸ªç»„ä»¶åˆ›å»ºä½œç”¨äºï¼š import &#123; ViewEncapsulation&#125; from &quot;@angular/core&quot;;@Component(&#123; templateUrl: &quot;./login.html&quot;, styleUrls: [&#x27;./login.css&#x27;, &#x27;/bootstrap/css/bootstrap.min.css&#x27;], encapsulation: ViewEncapsulation.None&#125;) ::ng-deep::ng-deep ä¼šè·³è¿‡ä¸­é—´çš„æ­¥éª¤ï¼Œç›´æ¥æ‰¾åˆ°å¯¹åº”çš„é€‰æ‹©å™¨ï¼Œä½¿ç”¨è¿™ä¸ªä¸ä¼šå— angular ä½œç”¨åŸŸçš„å½±å“ ::ng-deep .class &#123; color: white;&#125; å‚è€ƒåœ¨ Angular ç»„ä»¶ä¸­å¼•å…¥å¤–éƒ¨æ ·å¼","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"angular","slug":"angular","permalink":"https://luckyship.github.io/tags/angular/"}]},{"title":"jsonpçš„åŸç†å’Œå®ç°","date":"2021-03-07T09:07:42.000Z","path":"2021/03/07/2021-03-07-jsonp/","text":"åœ¨åº”å¯¹æµè§ˆå™¨è·¨åŸŸé—®é¢˜æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€ç§è§£å†³æ–¹æ³•ï¼Œä½¿ç”¨ jsonp ã€‚é‚£ä¹ˆ jsonp åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ æ¦‚è¿°jsonpæ˜¯ä¸€ç§è·¨åŸŸé€šä¿¡çš„æ‰‹æ®µï¼Œå®ƒçš„åŸç†å…¶å®å¾ˆç®€å•ï¼š é¦–å…ˆæ˜¯åˆ©ç”¨scriptæ ‡ç­¾çš„srcå±æ€§æ¥å®ç°è·¨åŸŸã€‚ é€šè¿‡å°†å‰ç«¯æ–¹æ³•ä½œä¸ºå‚æ•°ä¼ é€’åˆ°æœåŠ¡å™¨ç«¯ï¼Œç„¶åç”±æœåŠ¡å™¨ç«¯æ³¨å…¥å‚æ•°ä¹‹åå†è¿”å›ï¼Œå®ç°æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯é€šä¿¡ã€‚ ç”±äºä½¿ç”¨scriptæ ‡ç­¾çš„srcå±æ€§ï¼Œå› æ­¤åªæ”¯æŒgetæ–¹æ³• å®ç°æµç¨‹è®¾å®šä¸€ä¸ªscriptæ ‡ç­¾ &lt; script src = &quot;http://jsonp.js?callback=xxx&quot; &gt; &lt; /script&gt; callback å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°åï¼Œè€Œè¿œç¨‹æœåŠ¡ç«¯é€šè¿‡è°ƒç”¨æŒ‡å®šçš„å‡½æ•°å¹¶ä¼ å…¥å‚æ•°æ¥å®ç°ä¼ é€’å‚æ•°ï¼Œå°† fn(response) ä¼ é€’å›å®¢æˆ·ç«¯ $callback = !empty($_GET[&#x27;callback&#x27;]) ? $_GET[&#x27;callback&#x27;] : &#x27;callback&#x27;;echo $callback.&#x27;(.json_encode($data).)&#x27;; å®¢æˆ·ç«¯æ¥æ”¶åˆ°è¿”å›çš„jsè„šæœ¬ï¼Œå¼€å§‹è§£æå’Œæ‰§è¡Œ fn(response) jsonpç®€å•å®ç°ä¸€ä¸ªç®€å•çš„jsonpå®ç°ï¼Œå…¶å®å°±æ˜¯æ‹¼æ¥urlï¼Œç„¶åå°†åŠ¨æ€æ·»åŠ ä¸€ä¸ªscriptå…ƒç´ åˆ°å¤´éƒ¨ã€‚ function jsonp(req) &#123; var script = document.createElement(&#x27;script&#x27;); var url = req.url + &#x27;?callback=&#x27; + req.callback.name; script.src = url; document.getElementsByTagName(&#x27;head&#x27;)[0].appendChild(script);&#125; å‰ç«¯jsç¤ºä¾‹ function hello(res) &#123; alert(&#x27;hello &#x27; + res.data);&#125;jsonp(&#123; url: &#x27;&#x27;, callback: hello&#125;); æœåŠ¡å™¨ç«¯ä»£ç  var http = require(&#x27;http&#x27;);var urllib = require(&#x27;url&#x27;);var port = 8080;var data = &#123; &#x27;data&#x27;: &#x27;world&#x27;&#125;;http.createServer(function(req, res) &#123; var params = urllib.parse(req.url, true); if (params.query.callback) &#123; console.log(params.query.callback); //jsonp var str = params.query.callback + &#x27;(&#x27; + JSON.stringify(data) + &#x27;)&#x27;; res.end(str); &#125; else &#123; res.end(); &#125;&#125;).listen(port, function() &#123; console.log(&#x27;jsonp server is on&#x27;);&#125;); ç„¶è€Œï¼Œè¿™ä¸ªå®ç°è™½ç„¶ç®€å•ï¼Œä½†æœ‰ä¸€äº›ä¸è¶³çš„åœ°æ–¹ï¼š æˆ‘ä»¬ä¼ é€’çš„å›è°ƒå¿…é¡»æ˜¯ä¸€ä¸ªå…¨å±€æ–¹æ³•ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“è¦å°½é‡å‡å°‘å…¨å±€çš„æ–¹æ³•ã€‚ éœ€è¦åŠ å…¥ä¸€äº›å‚æ•°æ ¡éªŒï¼Œç¡®ä¿æ¥å£å¯ä»¥æ­£å¸¸æ‰§è¡Œã€‚ å¯é çš„jsonpå®ç°(function(global) &#123; var id = 0, container = document.getElementsByTagName(&quot;head&quot;)[0]; function jsonp(options) &#123; if (!options || !options.url) return; var scriptNode = document.createElement(&quot;script&quot;), data = options.data || &#123;&#125;, url = options.url, callback = options.callback, fnName = &quot;jsonp&quot; + id++; // æ·»åŠ å›è°ƒå‡½æ•° data[&quot;callback&quot;] = fnName; // æ‹¼æ¥url var params = []; for (var key in data) &#123; params.push(encodeURIComponent(key) + &quot;=&quot; + encodeURIComponent(data[key])); &#125; url = url.indexOf(&quot;?&quot;) &gt; 0 ? (url + &quot;&amp;&quot;) : (url + &quot;?&quot;); url += params.join(&quot;&amp;&quot;); scriptNode.src = url; // ä¼ é€’çš„æ˜¯ä¸€ä¸ªåŒ¿åçš„å›è°ƒå‡½æ•°ï¼Œè¦æ‰§è¡Œçš„è¯ï¼Œæš´éœ²ä¸ºä¸€ä¸ªå…¨å±€æ–¹æ³• global[fnName] = function(ret) &#123; callback &amp;&amp; callback(ret); container.removeChild(scriptNode); delete global[fnName]; &#125; // å‡ºé”™å¤„ç† scriptNode.onerror = function() &#123; callback &amp;&amp; callback(&#123; error: &quot;error&quot; &#125;); container.removeChild(scriptNode); global[fnName] &amp;&amp; delete global[fnName]; &#125; scriptNode.type = &quot;text/javascript&quot;; container.appendChild(scriptNode) &#125; global.jsonp = jsonp;&#125;)(this); ä½¿ç”¨ç¤ºä¾‹ jsonp(&#123; url: &quot;www.example.com&quot;, data: &#123; id: 1 &#125;, callback: function(ret) &#123; console.log(ret); &#125;&#125;); å‚è€ƒjsonpçš„åŸç†ä¸å®ç°","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"jsæ­£åˆ™æ–¹æ³•","date":"2021-02-14T07:08:27.000Z","path":"2021/02/14/2021-02-14-js-regex-method/","text":"jsæœ‰å¾ˆå¤šæ­£åˆ™æ–¹æ³•ï¼š testã€searchã€matchã€replaceã€exec ï¼Œä»–ä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆå‘¢ å®šä¹‰æ­£åˆ™ï¼š var re = new RegExp(â€œaâ€); //RegExpå¯¹è±¡ã€‚å‚æ•°å°±æ˜¯æˆ‘ä»¬æƒ³è¦åˆ¶å®šçš„è§„åˆ™ã€‚å½“å‚æ•°ä¸ºå˜é‡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼var re = /a/; // ç®€å†™æ–¹æ³• æ¨èä½¿ç”¨ æ€§èƒ½æ›´å¥½ ä¸èƒ½ä¸ºç©º ä¸ç„¶ä»¥ä¸ºæ˜¯æ³¨é‡Š ï¼Œ javascriptä¸­æ­£åˆ™è¡¨è¾¾å¼æ”¯æŒçš„æ­£åˆ™è¡¨è¾¾å¼æœ‰ä¸‰ä¸ªï¼Œ gã€iã€m ï¼Œåˆ†åˆ«ä»£è¡¨å…¨å±€åŒ¹é…ã€å¿½ç•¥å¤§å°å†™ã€å¤šè¡Œæ¨¡å¼ã€‚ä¸‰ç§å±æ€§å¯ä»¥è‡ªç”±ç»„åˆå…±å­˜ã€‚ teståœ¨å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾ç¬¦åˆæ­£åˆ™çš„å†…å®¹ï¼Œè‹¥æŸ¥æ‰¾åˆ°è¿”å›true, åä¹‹è¿”å›false.ç”¨æ³•ï¼š reg.test(str) var str = &#x27;374829348791&#x27;;var re = /\\D/; // \\Dä»£è¡¨éæ•°å­—if (re.test(str)) &#123; // è¿”å›true,ä»£è¡¨åœ¨å­—ç¬¦ä¸²ä¸­æ‰¾åˆ°äº†éæ•°å­—ã€‚ console.log(&#x27;ä¸å…¨æ˜¯æ•°å­—&#x27;);&#125; else &#123; console.log(&#x27;å…¨æ˜¯æ•°å­—&#x27;);&#125; searchåœ¨å­—ç¬¦ä¸²æœç´¢ç¬¦åˆæ­£åˆ™çš„å†…å®¹ï¼Œæœç´¢åˆ°å°±è¿”å›å‡ºç°çš„ä½ç½®ï¼ˆä»0å¼€å§‹ï¼Œå¦‚æœåŒ¹é…çš„ä¸åªæ˜¯ä¸€ä¸ªå­—æ¯ï¼Œé‚£åªä¼šè¿”å›ç¬¬ä¸€ä¸ªå­—æ¯çš„ä½ç½®ï¼‰ï¼Œ å¦‚æœæœç´¢å¤±è´¥å°±è¿”å› -1ç”¨æ³•: str.search(reg) var str = &#x27;abcdef&#x27;;var re = /B/i;//var re = new RegExp(&#x27;B&#x27;,&#x27;i&#x27;); ä¹Ÿå¯ä»¥è¿™æ ·å†™console.log(str.search(re)); // 1 matchåœ¨å­—ç¬¦ä¸²ä¸­æœç´¢å¤åˆè§„åˆ™çš„å†…å®¹ï¼Œæœç´¢æˆåŠŸå°±è¿”å›å†…å®¹ï¼Œæ ¼å¼ä¸ºæ•°ç»„ï¼Œå¤±è´¥å°±è¿”å›nullã€‚ç”¨æ³•ï¼š str.match(reg) var str = &#x27;haj123sdk54hask33dkhalsd879&#x27;;var re = /\\d+/g;// æ¯æ¬¡åŒ¹é…è‡³å°‘ä¸€ä¸ªæ•°å­— ä¸”å…¨å±€åŒ¹é… å¦‚æœä¸æ˜¯å…¨å±€åŒ¹é…ï¼Œå½“æ‰¾åˆ°æ•°å­—123ï¼Œå®ƒå°±ä¼šåœæ­¢äº†ã€‚// å°±åªä¼šå¼¹å‡º123.åŠ ä¸Šå…¨å±€åŒ¹é…ï¼Œå°±ä¼šä»å¼€å§‹åˆ°ç»“æŸä¸€ç›´å»æœç´¢ç¬¦åˆè§„åˆ™çš„ã€‚å¦‚æœæ²¡æœ‰åŠ å·ï¼ŒåŒ¹é…çš„ç»“æœå°±æ˜¯1ï¼Œ2ï¼Œ3ï¼Œ5ï¼Œ4ï¼Œ3ï¼Œ3ï¼Œ8ï¼Œ7ï¼Œ9å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œ// æœ‰äº†åŠ å·ï¼Œæ¯æ¬¡åŒ¹é…çš„æ•°å­—å°±æ˜¯è‡³å°‘ä¸€ä¸ªäº†ã€‚console.log(str.match(re)); // [123ï¼Œ54ï¼Œ33ï¼Œ879] replaceæŸ¥æ‰¾ç¬¦åˆæ­£åˆ™çš„å­—ç¬¦ä¸²ï¼Œå°±æ›¿æ¢æˆå¯¹åº”çš„å­—ç¬¦ä¸²ã€‚è¿”å›æ›¿æ¢åçš„å†…å®¹ã€‚ç”¨æ³•ï¼š str.replace(//, æ–°çš„å­—ç¬¦ä¸²/å›è°ƒå‡½æ•°) ç¬¬ä¸€ä¸ªå‚æ•°ä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸² var str = &quot;æˆ‘çˆ±åŒ—äº¬å¤©å®‰é—¨ï¼Œå¤©å®‰é—¨ä¸Šå¤ªé˜³å‡ã€‚&quot;;var re = /åŒ—äº¬|å¤©å®‰é—¨/g; // æ‰¾åˆ°åŒ—äº¬ æˆ–è€…å¤©å®‰é—¨ å…¨å±€åŒ¹é…var str2 = str.replace(re, function(str) &#123; console.log(str); //ç”¨æ¥æµ‹è¯•ï¼šå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨æ¯æ¬¡æœç´¢åˆ°çš„ç¬¦åˆæ­£åˆ™çš„å­—ç¬¦ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡stræŒ‡çš„æ˜¯åŒ—äº¬ ç¬¬äºŒæ¬¡stræ˜¯å¤©å®‰é—¨ ç¬¬ä¸‰æ¬¡stræ˜¯å¤©å®‰é—¨ var result = &#x27;&#x27;; for (var i = 0; i &lt; str.length; i++) &#123; result += &#x27;*&#x27;; &#125; return result; //æ‰€ä»¥æœç´¢åˆ°äº†å‡ ä¸ªå­—å°±è¿”å›å‡ ä¸ª*&#125;);console.log(str2) //æˆ‘çˆ±*****ï¼Œ***ä¸Šå¤ªé˜³å‡//æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯ï¼Œæ‰¾åˆ°åŒ—äº¬ï¼Œæ›¿æ¢æˆäº†ä¸¤ä¸ª*ï¼Œæ‰¾åˆ°å¤©å®‰é—¨æ›¿æ¢æˆäº†3ä¸ª*ï¼Œæ‰¾åˆ°å¤©å®‰é—¨æ›¿æ¢æˆ3ä¸ª*ã€‚ replace()çš„ç¬¬äºŒä¸ªå‚æ•°replacementæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ›¿æ¢çš„æ–‡æœ¬ï¼Œå…¶ä¸­å¯ä»¥ä½¿ç”¨ä¸€äº›ç‰¹æ®Šå­—ç¬¦ä¸²ã€‚ $&amp;ï¼šåŒ¹é…çš„å­å­—ç¬¦ä¸²ã€‚ $` ï¼šåŒ¹é…ç»“æœå‰é¢çš„æ–‡æœ¬ã€‚ $â€™ï¼šåŒ¹é…ç»“æœåé¢çš„æ–‡æœ¬ã€‚ $nï¼šåŒ¹é…æˆåŠŸçš„ç¬¬nç»„å†…å®¹ï¼Œnæ˜¯ä»1å¼€å§‹çš„è‡ªç„¶æ•°ã€‚è¿™ä¸ªå‚æ•°ç”Ÿæ•ˆçš„å‰ææ˜¯ï¼Œç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯æ­£åˆ™* è¡¨è¾¾å¼ã€‚ $$ï¼šæŒ‡ä»£ç¾å…ƒç¬¦å·$ã€‚ å‚è€ƒreplace execå’Œmatchæ–¹æ³•ä¸€æ ·ï¼Œæœç´¢ç¬¦åˆè§„åˆ™çš„å†…å®¹ï¼Œå¹¶è¿”å›å†…å®¹ï¼Œæ ¼å¼ä¸ºæ•°ç»„ï¼Œå¤±è´¥å°±è¿”å›nullã€‚ç”¨æ³•ï¼š reg.exec(str) var testStr = &quot;now test001 test002&quot;;var re = /test(\\d+)/; //åªåŒ¹é…ä¸€æ¬¡var r = &quot;&quot;;var r = re.exec(testStr)console.log(r); // test001 001 è¿”å›åŒ¹é…ç»“æœï¼Œä»¥åŠå­é¡¹console.log(r.length); //2 è¿”å›å†…å®¹çš„é•¿åº¦console.log(r.input); //now test001 test002 ä»£è¡¨æ¯æ¬¡åŒ¹é…æˆåŠŸçš„å­—ç¬¦ä¸²console.log(r[0]); //test001console.log(r[1]); //001 ä»£è¡¨æ¯æ¬¡åŒ¹é…æˆåŠŸå­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå­é¡¹ (\\d+)console.log(r.index); // 4 æ¯æ¬¡åŒ¹é…æˆåŠŸçš„å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä½ç½® replaceAlles6æ–°å¢ï¼Œå†å²ä¸Šï¼Œå­—ç¬¦ä¸²çš„å®ä¾‹æ–¹æ³•replace()åªèƒ½æ›¿æ¢ç¬¬ä¸€ä¸ªåŒ¹é…ã€‚ &#x27;aabbcc&#x27;.replace(&#x27;b&#x27;, &#x27;_&#x27;)// &#x27;aa_bcc&#x27; ä¸Šé¢ä¾‹å­ä¸­ï¼Œreplace()åªå°†ç¬¬ä¸€ä¸ªbæ›¿æ¢æˆäº†ä¸‹åˆ’çº¿ã€‚å¦‚æœè¦æ›¿æ¢æ‰€æœ‰çš„åŒ¹é…ï¼Œä¸å¾—ä¸ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„gä¿®é¥°ç¬¦ã€‚ &#x27;aabbcc&#x27;.replace(/b/g, &#x27;_&#x27;)// &#x27;aa__cc&#x27; æ­£åˆ™è¡¨è¾¾å¼æ¯•ç«Ÿä¸æ˜¯é‚£ä¹ˆæ–¹ä¾¿å’Œç›´è§‚ï¼ŒES2021 å¼•å…¥äº†replaceAll()æ–¹æ³•ï¼Œå¯ä»¥ä¸€æ¬¡æ€§æ›¿æ¢æ‰€æœ‰åŒ¹é…ã€‚ &#x27;aabbcc&#x27;.replaceAll(&#x27;b&#x27;, &#x27;_&#x27;)// &#x27;aa__cc&#x27; å¦‚æœsearchValueæ˜¯ä¸€ä¸ªä¸å¸¦æœ‰gä¿®é¥°ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ŒreplaceAll()ä¼šæŠ¥é”™ã€‚è¿™ä¸€ç‚¹è·Ÿreplace()ä¸åŒã€‚ // ä¸æŠ¥é”™&#x27;aabbcc&#x27;.replace(/b/, &#x27;_&#x27;)// æŠ¥é”™&#x27;aabbcc&#x27;.replaceAll(/b/, &#x27;_&#x27;) ä¸Šé¢ä»£ç ä¸­ï¼ŒsearchValueæ˜¯æœç´¢æ¨¡å¼ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå…¨å±€çš„æ­£åˆ™è¡¨è¾¾å¼ï¼ˆå¸¦æœ‰gä¿®é¥°ç¬¦ï¼‰ã€‚ matchAll","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"linuxç»ˆç«¯å¿«æ·é”®","date":"2021-02-10T06:01:24.000Z","path":"2021/02/10/2021-02-10-linux-terminal-keyboard-shortcut/","text":"linuxç»ˆç«¯ä¸‹æœ‰å¾ˆå¤šå¿«æ·é”®ï¼Œè¿™äº›å¿«æ·é”®èƒ½å¤§å¤§æé«˜æˆ‘ä»¬çš„æ•ˆç‡ï¼Œä¾‹å¦‚ï¼šctrl+shift+cæ˜¯å¤åˆ¶å‘½ä»¤ï¼Œctrl+shift+væ˜¯ç²˜è´´ æˆ‘æƒ³æä¸€ä¸‹ä¸€äº›å¿«æ·é”®å¯èƒ½ä¾èµ–äºä½ ä½¿ç”¨çš„ Shellã€‚ Bash æ˜¯æœ€å—æ¬¢è¿çš„ shellï¼Œæ‰€ä»¥åˆ—å‡ºçš„å¿«æ·é”®é›†ä¸­åœ¨ Bashã€‚ å¦‚æœä½ æ„¿æ„ï¼Œä½ ä¹Ÿå¯ä»¥ç§°å…¶ä¸º Bash å¿«æ·é”®åˆ—è¡¨ã€‚ æ³¨æ„æˆ‘åœ¨é”®ç›˜å¿«æ·é”®ä¸­ä½¿ç”¨äº†å¤§å†™å­—æ¯ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€ä½ åœ¨ä½¿ç”¨å¿«æ·é”®æ—¶å¿…é¡»æŒ‰ä¸‹ shift é”®ã€‚ å¸¸ç”¨Tabè¿™æ˜¯ä½ ä¸èƒ½æ²¡æœ‰çš„ Linux å¿«æ·é”®ã€‚å®ƒå°†èŠ‚çœä½  Linux å‘½ä»¤è¡Œä¸­çš„å¤§é‡æ—¶é—´ã€‚åªéœ€è¦è¾“å…¥ä¸€ä¸ªå‘½ä»¤ï¼Œæ–‡ä»¶åï¼Œç›®å½•åç”šè‡³æ˜¯å‘½ä»¤é€‰é¡¹çš„å¼€å¤´ï¼Œå¹¶æ•²å‡» tab é”®ã€‚å®ƒå°†è‡ªåŠ¨å®Œæˆä½ è¾“å…¥çš„å†…å®¹ï¼Œæˆ–ä¸ºä½ æ˜¾ç¤ºå…¨éƒ¨å¯èƒ½çš„ç»“æœã€‚å¦‚æœä½ åªè®°ä¸€ä¸ªå¿«æ·é”®ï¼Œè¿™å°†æ˜¯å¿…é€‰çš„ä¸€ä¸ªã€‚ Ctrl + Cè¿™äº›æ˜¯ä¸ºäº†åœ¨ç»ˆç«¯ä¸Šä¸­æ–­å‘½ä»¤æˆ–è¿›ç¨‹è¯¥æŒ‰çš„é”®ã€‚å®ƒå°†ç«‹åˆ»ç»ˆæ­¢è¿è¡Œçš„ç¨‹åºã€‚å¦‚æœä½ æƒ³è¦åœæ­¢ä½¿ç”¨ä¸€ä¸ªæ­£åœ¨åå°è¿è¡Œçš„ç¨‹åºï¼Œåªéœ€æŒ‰ä¸‹è¿™å¯¹ç»„åˆé”®ã€‚ Ctrl + Zè¯¥å¿«æ·é”®å°†æ­£åœ¨è¿è¡Œçš„ç¨‹åºé€åˆ°åå°ã€‚ é€šå¸¸ï¼Œä½ å¯ä»¥åœ¨ä½¿ç”¨ &amp; é€‰é¡¹è¿è¡Œç¨‹åºå‰ä¹‹å®Œæˆè¯¥æ“ä½œï¼Œ ä½†æ˜¯å¦‚æœä½ å¿˜è®°ä½¿ç”¨é€‰é¡¹è¿è¡Œç¨‹åºï¼Œå°±ä½¿ç”¨è¿™å¯¹ç»„åˆé”®ã€‚ Ctrl + Dè¿™å¯¹é”®ç›˜å¿«æ·é”®å°†ä½¿ä½ é€€å‡ºå½“å‰ç»ˆç«¯ã€‚å¦‚æœä½ ä½¿ç”¨ SSH è¿æ¥ï¼Œå®ƒå°†ä¼šå…³é—­ã€‚ å¦‚æœä½ ç›´æ¥ä½¿ç”¨ä¸€ä¸ªç»ˆç«¯ï¼Œè¯¥åº”ç”¨å°†ä¼šç«‹åˆ»å…³é—­ã€‚æŠŠå®ƒå½“æˆâ€é€€å‡ºâ€å‘½ä»¤ã€‚ Ctrl + Lä½ æ€ä¹ˆæ¸…ç©ºä½ çš„ç»ˆç«¯å±å¹•ï¼Ÿæˆ‘çŒœæ˜¯ç”¨ clear å‘½ä»¤ã€‚ä½ å¯ä»¥ä½¿ç”¨ Ctrl+L æ¸…ç©ºç»ˆç«¯ï¼Œä»£æ›¿è¾“å…¥ C-L-E-A-Rã€‚å¾—å¿ƒåº”æ‰‹ï¼Œä¸æ˜¯å—ï¼Ÿ Ctrl + Aè¯¥å¿«æ·é”®å°†ç§»åŠ¨å…‰æ ‡åˆ°æ‰€åœ¨è¡Œé¦–ã€‚å‡è®¾ä½ åœ¨ç»ˆç«¯è¾“å…¥äº†ä¸€ä¸ªå¾ˆé•¿çš„å‘½ä»¤æˆ–è·¯å¾„ï¼Œå¹¶ä¸”ä½ æƒ³è¦å›åˆ°å®ƒçš„å¼€å¤´ï¼Œ ä½¿ç”¨æ–¹å‘é”®ç§»åŠ¨å…‰æ ‡å°†èŠ±è´¹å¤§é‡æ—¶é—´ã€‚æ³¨æ„ä½ æ— æ³•ä½¿ç”¨é¼ æ ‡ç§»åŠ¨å…‰æ ‡åˆ°è¡Œé¦–ã€‚è¿™æ˜¯ Ctrl+A èŠ‚çœæ—¶é—´çš„åœ°æ–¹ã€‚ Ctrl + Eè¿™å¯¹å¿«æ·é”®ä¸ Ctrl+A ç›¸åã€‚ Ctrl+A é€å…‰æ ‡åˆ°è¡Œé¦–ï¼Œåä¹‹ Ctrl+E ç§»åŠ¨å…‰æ ‡åˆ°è¡Œå°¾ã€‚ Ctrl + Uè¾“å…¥äº†é”™è¯¯çš„å‘½ä»¤ï¼Ÿ ä»£æ›¿ç”¨é€€æ ¼é”®æ¥ä¸¢å¼ƒå½“å‰å‘½ä»¤ï¼Œä½¿ç”¨ Linux ç»ˆç«¯ä¸­çš„ Ctrl+U å¿«æ·é”®ã€‚ è¯¥å¿«æ·é”®ä¼šæ“¦é™¤ä»å½“å‰å…‰æ ‡ä½ç½®åˆ°è¡Œé¦–çš„å…¨éƒ¨å†…å®¹ã€‚ Ctrl + Kè¿™å¯¹å’Œ Ctrl+U å¿«æ·é”®æœ‰ç‚¹åƒã€‚ å”¯ä¸€çš„ä¸åŒåœ¨äºä¸æ˜¯è¡Œé¦–ï¼Œå®ƒæ“¦é™¤çš„æ˜¯ä»å½“å‰å…‰æ ‡ä½ç½®åˆ°è¡Œå°¾çš„å…¨éƒ¨å†…å®¹ã€‚ Ctrl + Wä½ åˆšæ‰äº†è§£äº†æ“¦é™¤åˆ°è¡Œé¦–å’Œè¡Œå°¾çš„æ–‡æœ¬ã€‚ ä½†å¦‚æœä½ åªéœ€è¦åˆ é™¤ä¸€ä¸ªå•è¯å‘¢ï¼Ÿä½¿ç”¨ Ctrl+W å¿«æ·é”®ã€‚ä½¿ç”¨ Ctrl+W å¿«æ·é”®ï¼Œä½ å¯ä»¥æ“¦é™¤å…‰æ ‡ä½ç½®å‰çš„å•è¯ã€‚ å¦‚æœå…‰æ ‡åœ¨ä¸€ä¸ªå•è¯æœ¬èº«ä¸Šï¼Œå®ƒå°†æ“¦é™¤ä»å…‰æ ‡ä½ç½®åˆ°è¯é¦–çš„å…¨éƒ¨å­—æ¯ã€‚æœ€å¥½çš„æ–¹æ³•æ˜¯ç”¨å®ƒç§»åŠ¨å…‰æ ‡åˆ°è¦åˆ é™¤å•è¯åçš„ä¸€ä¸ªç©ºæ ¼ä¸Šï¼Œ ç„¶åä½¿ç”¨ Ctrl+W é”®ç›˜å¿«æ·é”®ã€‚ Ctrl + Yè¿™å°†ç²˜è´´ä½¿ç”¨ Ctrl+Wï¼ŒCtrl+U å’Œ Ctrl+K å¿«æ·é”®æ“¦é™¤çš„æ–‡æœ¬ã€‚ å¦‚æœä½ åˆ é™¤äº†é”™è¯¯çš„æ–‡æœ¬æˆ–éœ€è¦åœ¨æŸå¤„ä½¿ç”¨å·²æ“¦é™¤çš„æ–‡æœ¬ï¼Œè¿™å°†æ´¾ä¸Šç”¨åœºã€‚ Ctrl + Pä½ å¯ä»¥ä½¿ç”¨è¯¥å¿«æ·é”®æ¥æŸ¥çœ‹ä¸Šä¸€ä¸ªå‘½ä»¤ã€‚ ä½ å¯ä»¥åå¤æŒ‰è¯¥é”®æ¥è¿”å›åˆ°å†å²å‘½ä»¤ã€‚ åœ¨å¾ˆå¤šç»ˆç«¯é‡Œï¼Œä½¿ç”¨ PgUp é”®æ¥å®ç°ç›¸åŒçš„åŠŸèƒ½ã€‚ Ctrl + Nä½ å¯ä»¥ç»“åˆ Ctrl+P ä½¿ç”¨è¯¥å¿«æ·é”®ã€‚Ctrl+N æ˜¾ç¤ºä¸‹ä¸€ä¸ªå‘½ä»¤ã€‚ å¦‚æœä½¿ç”¨ Ctrl+P æŸ¥çœ‹ä¸Šä¸€æ¡å‘½ä»¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ Ctrl+N æ¥å›å¯¼èˆªã€‚ è®¸å¤šç»ˆç«¯éƒ½æŠŠæ­¤å¿«æ·é”®æ˜ å°„åˆ° PgDn é”®ã€‚ Ctrl + Rä½ å¯ä»¥ä½¿ç”¨è¯¥å¿«æ·é”®æ¥æœç´¢å†å²å‘½ä»¤ã€‚ Ctrl+å·¦å³é”®åœ¨å•è¯ä¹‹é—´è·³è½¬ å…¶ä»–Alt â€“ d ï¼šç”±å…‰æ ‡ä½ç½®å¼€å§‹ï¼Œå¾€å³åˆ é™¤å•è¯ã€‚å¾€è¡Œå°¾åˆ  è¯´æ˜ Ctrl â€“ k: å…ˆæŒ‰ä½ Ctrl é”®ï¼Œç„¶åå†æŒ‰ k é”®ï¼› Alt â€“ k: å…ˆæŒ‰ä½ Alt é”®ï¼Œç„¶åå†æŒ‰ k é”®ï¼› M â€“ kï¼šå…ˆå•å‡» Esc é”®ï¼Œç„¶åå†æŒ‰ k é”®ã€‚ ç§»åŠ¨å…‰æ ‡ Ctrl â€“ a ï¼šç§»åˆ°è¡Œé¦– Ctrl â€“ e ï¼šç§»åˆ°è¡Œå°¾ Ctrl â€“ b ï¼šå¾€å›(å·¦)ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦ Ctrl â€“ f ï¼šå¾€å(å³)ç§»åŠ¨ä¸€ä¸ªå­—ç¬¦ Alt â€“ b ï¼šå¾€å›(å·¦)ç§»åŠ¨ä¸€ä¸ªå•è¯ Alt â€“ f ï¼šå¾€å(å³)ç§»åŠ¨ä¸€ä¸ªå•è¯ Ctrl â€“ xx ï¼šåœ¨å‘½ä»¤è¡Œå°¾å’Œå…‰æ ‡ä¹‹é—´ç§»åŠ¨ M-b ï¼šå¾€å›(å·¦)ç§»åŠ¨ä¸€ä¸ªå•è¯ M-f ï¼šå¾€å(å³)ç§»åŠ¨ä¸€ä¸ªå•è¯ ç¼–è¾‘å‘½ä»¤ Ctrl â€“ h ï¼šåˆ é™¤å…‰æ ‡å·¦æ–¹ä½ç½®çš„å­—ç¬¦ Ctrl â€“ d ï¼šåˆ é™¤å…‰æ ‡å³æ–¹ä½ç½®çš„å­—ç¬¦ï¼ˆæ³¨æ„ï¼šå½“å‰å‘½ä»¤è¡Œæ²¡æœ‰ä»»ä½•å­—ç¬¦æ—¶ï¼Œä¼šé”€ç³»ç»Ÿæˆ–ç»“æŸç»ˆç«¯ï¼‰ Ctrl â€“ w ï¼šç”±å…‰æ ‡ä½ç½®å¼€å§‹ï¼Œå¾€å·¦åˆ é™¤å•è¯ã€‚å¾€è¡Œé¦–åˆ  Alt â€“ d ï¼šç”±å…‰æ ‡ä½ç½®å¼€å§‹ï¼Œå¾€å³åˆ é™¤å•è¯ã€‚å¾€è¡Œå°¾åˆ  M â€“ d ï¼šç”±å…‰æ ‡ä½ç½®å¼€å§‹ï¼Œåˆ é™¤å•è¯ï¼Œç›´åˆ°è¯¥å•è¯ç»“æŸã€‚ Ctrl â€“ k ï¼šç”±å…‰æ ‡æ‰€åœ¨ä½ç½®å¼€å§‹ï¼Œåˆ é™¤å³æ–¹æ‰€æœ‰çš„å­—ç¬¦ï¼Œç›´åˆ°è¯¥è¡Œç»“æŸã€‚ Ctrl â€“ u ï¼šç”±å…‰æ ‡æ‰€åœ¨ä½ç½®å¼€å§‹ï¼Œåˆ é™¤å·¦æ–¹æ‰€æœ‰çš„å­—ç¬¦ï¼Œç›´åˆ°è¯¥è¡Œå¼€å§‹ã€‚ Ctrl â€“ y ï¼šç²˜è´´ä¹‹å‰åˆ é™¤çš„å†…å®¹åˆ°å…‰æ ‡åã€‚ ctrl â€“ t ï¼šäº¤æ¢å…‰æ ‡å¤„å’Œä¹‹å‰ä¸¤ä¸ªå­—ç¬¦çš„ä½ç½®ã€‚ Alt + . ï¼šä½¿ç”¨ä¸Šä¸€æ¡å‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°ã€‚ Ctrl â€“ _ ï¼šå›å¤ä¹‹å‰çš„çŠ¶æ€ã€‚æ’¤é”€æ“ä½œã€‚ Ctrl -a + Ctrl -k æˆ– Ctrl -e + Ctrl -u æˆ– Ctrl -k + Ctrl -u ç»„åˆå¯åˆ é™¤æ•´è¡Œã€‚ Bang(!)å‘½ä»¤ !! ï¼šæ‰§è¡Œä¸Šä¸€æ¡å‘½ä»¤ã€‚ ^foo^bar ï¼šæŠŠä¸Šä¸€æ¡å‘½ä»¤é‡Œçš„fooæ›¿æ¢ä¸ºbarï¼Œå¹¶æ‰§è¡Œã€‚ !wget ï¼šæ‰§è¡Œæœ€è¿‘çš„ä»¥wgetå¼€å¤´çš„å‘½ä»¤ã€‚ !wget:p ï¼šä»…æ‰“å°æœ€è¿‘çš„ä»¥wgetå¼€å¤´çš„å‘½ä»¤ï¼Œä¸æ‰§è¡Œã€‚ !$ ï¼šä¸Šä¸€æ¡å‘½ä»¤çš„æœ€åä¸€ä¸ªå‚æ•°ï¼Œ ä¸ Alt - . å’Œ $_ ç›¸åŒã€‚ !* ï¼šä¸Šä¸€æ¡å‘½ä»¤çš„æ‰€æœ‰å‚æ•° !*:p ï¼šæ‰“å°ä¸Šä¸€æ¡å‘½ä»¤æ˜¯æ‰€æœ‰å‚æ•°ï¼Œä¹Ÿå³ !*çš„å†…å®¹ã€‚ ^abc ï¼šåˆ é™¤ä¸Šä¸€æ¡å‘½ä»¤ä¸­çš„abcã€‚ ^foo^bar ï¼šå°†ä¸Šä¸€æ¡å‘½ä»¤ä¸­çš„ foo æ›¿æ¢ä¸º bar ^foo^bar^ ï¼šå°†ä¸Šä¸€æ¡å‘½ä»¤ä¸­çš„ foo æ›¿æ¢ä¸º bar !-n ï¼šæ‰§è¡Œå‰næ¡å‘½ä»¤ï¼Œæ‰§è¡Œä¸Šä¸€æ¡å‘½ä»¤ï¼š !-1ï¼Œ æ‰§è¡Œå‰5æ¡å‘½ä»¤çš„æ ¼å¼æ˜¯ï¼š !-5 æŸ¥æ‰¾å†å²å‘½ä»¤ Ctrl â€“ p ï¼šæ˜¾ç¤ºå½“å‰å‘½ä»¤çš„ä¸Šä¸€æ¡å†å²å‘½ä»¤ Ctrl â€“ n ï¼šæ˜¾ç¤ºå½“å‰å‘½ä»¤çš„ä¸‹ä¸€æ¡å†å²å‘½ä»¤ Ctrl â€“ r ï¼šæœç´¢å†å²å‘½ä»¤ï¼Œéšç€è¾“å…¥ä¼šæ˜¾ç¤ºå†å²å‘½ä»¤ä¸­çš„ä¸€æ¡åŒ¹é…å‘½ä»¤ï¼ŒEnteré”®æ‰§è¡ŒåŒ¹é…å‘½ä»¤ï¼›ESCé”®åœ¨å‘½ä»¤è¡Œæ˜¾ç¤ºè€Œä¸æ‰§è¡ŒåŒ¹é…å‘½ä»¤ã€‚ Ctrl â€“ g ï¼šä»å†å²æœç´¢æ¨¡å¼ï¼ˆCtrl â€“ rï¼‰é€€å‡ºã€‚ æ§åˆ¶å‘½ä»¤ Ctrl â€“ l ï¼šæ¸…é™¤å±å¹•ï¼Œç„¶åï¼Œåœ¨æœ€ä¸Šé¢é‡æ–°æ˜¾ç¤ºç›®å‰å…‰æ ‡æ‰€åœ¨çš„è¿™ä¸€è¡Œçš„å†…å®¹ã€‚ Ctrl â€“ o ï¼šæ‰§è¡Œå½“å‰å‘½ä»¤ï¼Œå¹¶é€‰æ‹©ä¸Šä¸€æ¡å‘½ä»¤ã€‚ Ctrl â€“ s ï¼šé˜»æ­¢å±å¹•è¾“å‡º Ctrl â€“ q ï¼šå…è®¸å±å¹•è¾“å‡º Ctrl â€“ c ï¼šç»ˆæ­¢å‘½ä»¤ Ctrl â€“ z ï¼šæŒ‚èµ·å‘½ä»¤ é‡å¤æ‰§è¡Œæ“ä½œåŠ¨ä½œ M â€“ æ“ä½œæ¬¡æ•° æ“ä½œåŠ¨ä½œ ï¼š æŒ‡å®šæ“ä½œæ¬¡æ•°ï¼Œé‡å¤æ‰§è¡ŒæŒ‡å®šçš„æ“ä½œã€‚ æ€»ç»“ï¼š åœ¨ Linux ä¸‹ä½¿ç”¨å‘½ä»¤æ“ä½œçš„æ—¶å€™ï¼Œå…‰æ ‡çš„ç§»åŠ¨ä»¤äººå¤´ç—›ã€‚å‘½ä»¤è¾“å…¥å®Œäº†ï¼Œæ‰§è¡Œä¹‹åå‘ç°ç¼ºå°‘æƒé™ï¼Œç„¶åä¸å¾—ä¸ç§»åŠ¨å…‰æ ‡åˆ°è¡Œé¦–ï¼Œè€Œå‘½ä»¤åˆæé•¿â€¦â€¦ä»¥ä¸Šæ˜¯ä¸€äº›æ¯ä¸ª Linux ç”¨æˆ·å¿…é¡»ä½¿ç”¨çš„é”®ç›˜å¿«æ·é”®ã€‚ä½¿ç”¨å‘½ä»¤è¡Œæ—¶ï¼Œè¿™äº› Linux å¿«æ·é”®å°†æå‡ä½ çš„å·¥ä½œæ•ˆç‡å’Œæ•ˆç‡ã€‚ å‚è€ƒLinux ç”¨æˆ·å¿…çŸ¥ï¼šä¸€åˆ†é’ŸæŒæ¡14ä¸ªå¸¸ç”¨Linuxå‘½ä»¤è¡Œå¿«æ·é”®","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"linux","slug":"linux","permalink":"https://luckyship.github.io/tags/linux/"}]},{"title":"js fetchç®€ä»‹","date":"2021-02-03T10:34:45.000Z","path":"2021/02/03/2021-02-03-js-fetch/","text":"fetch ä¸ jquery çš„ajaxç±»ä¼¼ï¼Œæä¾›ä¸€ç§è®¿é—®httpçš„æ–¹æ³•ï¼Œå®ƒæ˜¯æµè§ˆå™¨çš„å…¨å±€æ–¹æ³•ï¼Œ ç›®å‰IEä¸æ”¯æŒ ç®€ä»‹Fetch API æä¾›äº†ä¸€ä¸ª JavaScript æ¥å£ï¼Œç”¨äºè®¿é—®å’Œæ“çºµ HTTP ç®¡é“çš„ä¸€äº›å…·ä½“éƒ¨åˆ†ï¼Œä¾‹å¦‚è¯·æ±‚å’Œå“åº”ã€‚å®ƒè¿˜æä¾›äº†ä¸€ä¸ªå…¨å±€ fetch() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æä¾›äº†ä¸€ç§ç®€å•ï¼Œåˆç†çš„æ–¹å¼æ¥è·¨ç½‘ç»œå¼‚æ­¥è·å–èµ„æºã€‚ è¿™ç§åŠŸèƒ½ä»¥å‰æ˜¯ä½¿ç”¨ XMLHttpRequest å®ç°çš„ã€‚Fetch æä¾›äº†ä¸€ä¸ªæ›´ç†æƒ³çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°è¢«å…¶ä»–æŠ€æœ¯ä½¿ç”¨ï¼Œä¾‹å¦‚ Service Workersã€‚Fetch è¿˜æä¾›äº†ä¸“é—¨çš„é€»è¾‘ç©ºé—´æ¥å®šä¹‰å…¶ä»–ä¸ HTTP ç›¸å…³çš„æ¦‚å¿µï¼Œä¾‹å¦‚ CORS å’Œ HTTP çš„æ‰©å±•ã€‚ è¯·æ³¨æ„ï¼Œfetch è§„èŒƒä¸ jQuery.ajax() ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼çš„ä¸åŒï¼š å½“æ¥æ”¶åˆ°ä¸€ä¸ªä»£è¡¨é”™è¯¯çš„ HTTP çŠ¶æ€ç æ—¶ï¼Œä» fetch() è¿”å›çš„ Promise ä¸ä¼šè¢«æ ‡è®°ä¸º rejectï¼Œ å³ä½¿å“åº”çš„ HTTP çŠ¶æ€ç æ˜¯ 404 æˆ– 500ã€‚ç›¸åï¼Œå®ƒä¼šå°† Promise çŠ¶æ€æ ‡è®°ä¸º resolve ï¼ˆä½†æ˜¯ä¼šå°† resolve çš„è¿”å›å€¼çš„ ok å±æ€§è®¾ç½®ä¸º false ï¼‰ï¼Œä»…å½“ç½‘ç»œæ•…éšœæ—¶æˆ–è¯·æ±‚è¢«é˜»æ­¢æ—¶ï¼Œæ‰ä¼šæ ‡è®°ä¸º rejectã€‚ fetch() å¯ä»¥æ¥å—è·¨åŸŸ cookiesï¼›ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ fetch() å»ºç«‹èµ·è·¨åŸŸä¼šè¯ã€‚ fetch ä¸ä¼šå‘é€ cookiesã€‚é™¤éä½ ä½¿ç”¨äº†credentials çš„åˆå§‹åŒ–é€‰é¡¹ã€‚ï¼ˆè‡ª 2017 å¹´ 8 æœˆ 25 æ—¥ä»¥åï¼Œé»˜è®¤çš„ credentials æ”¿ç­–å˜æ›´ä¸º same-originã€‚Firefox ä¹Ÿåœ¨ 61.0b13 ç‰ˆæœ¬ä¸­è¿›è¡Œäº†ä¿®æ”¹ï¼‰ ç¤ºä¾‹fetch(&#x27;http://example.com/movies.json&#x27;) .then(function(response) &#123; return response.json(); &#125;) .then(function(myJson) &#123; console.log(myJson); &#125;); è¿™é‡Œæˆ‘ä»¬é€šè¿‡ç½‘ç»œè·å–ä¸€ä¸ª JSON æ–‡ä»¶å¹¶å°†å…¶æ‰“å°åˆ°æ§åˆ¶å°ã€‚æœ€ç®€å•çš„ç”¨æ³•æ˜¯åªæä¾›ä¸€ä¸ªå‚æ•°ç”¨æ¥æŒ‡æ˜æƒ³ fetch() åˆ°çš„èµ„æºè·¯å¾„ï¼Œç„¶åè¿”å›ä¸€ä¸ªåŒ…å«å“åº”ç»“æœçš„promiseï¼ˆä¸€ä¸ª Response å¯¹è±¡ï¼‰ã€‚ å½“ç„¶å®ƒåªæ˜¯ä¸€ä¸ª HTTP å“åº”ï¼Œè€Œä¸æ˜¯çœŸçš„JSONã€‚ä¸ºäº†è·å–JSONçš„å†…å®¹ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ json() æ–¹æ³• å‚æ•°// Example POST method implementation:postData(&#x27;http://example.com/answer&#x27;, &#123; answer: 42 &#125;) .then(data =&gt; console.log(data)) // JSON from `response.json()` call .catch(error =&gt; console.error(error))function postData(url, data) &#123; // Default options are marked with * return fetch(url, &#123; body: JSON.stringify(data), // must match &#x27;Content-Type&#x27; header cache: &#x27;no-cache&#x27;, // *default, no-cache, reload, force-cache, only-if-cached credentials: &#x27;same-origin&#x27;, // include, same-origin, *omit headers: &#123; &#x27;user-agent&#x27;: &#x27;Mozilla/4.0 MDN Example&#x27;, &#x27;content-type&#x27;: &#x27;application/json&#x27; &#125;, method: &#x27;POST&#x27;, // *GET, POST, PUT, DELETE, etc. mode: &#x27;cors&#x27;, // no-cors, cors, *same-origin redirect: &#x27;follow&#x27;, // manual, *follow, error referrer: &#x27;no-referrer&#x27;, // *client, no-referrer &#125;) .then(response =&gt; response.json()) // parses response to JSON&#125; å‚è€ƒä½¿ç”¨ Fetch","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"jsç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°åŒºåˆ«","date":"2021-01-16T09:51:10.000Z","path":"2021/01/16/2021-01-16-diff-from-arrow-function-and-function/","text":"æ™®é€šå‡½æ•°åœ¨ es5 ä¸­å°±æœ‰äº†ï¼Œç®­å¤´å‡½æ•°æ˜¯ es6 ä¸­å‡ºç°çš„å‡½æ•°å½¢å¼ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç»§ç»­ç”¨æ™®é€šå‡½æ•°ã€‚ ç®­å¤´å‡½æ•°ä»£ç å°‘ï¼Œæ›´åˆ©äºé˜…è¯»ï¼Œä½†æ˜¯åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œä¼šè¡¨ç°å‡ºå’Œæ™®é€šå‡½æ•°ä¸ä¸€æ ·çš„ç‰¹æ€§ ç®­å¤´å‡½æ•°è¯­æ³• å¼€å‘æ—¶æ ¹æ®å®é™…æƒ…å†µå¯ä»¥çœç•¥ä¸€äº›ä¸œè¥¿ å•æ¡å¤„ç†å¯ä»¥çœç•¥ return å’Œ{å¤§æ‹¬å·} å•ä¸ªå‚æ•°å¯ä»¥çœç•¥(å°æ‹¬å·) &gt; [1, 2, 3].map(item =&gt; item * 2) // (3)[2, 4, 6] ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°ç®­å¤´å‡½æ•°ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•° ä¸èƒ½ newã€‚ä¼šæŠ¥é”™ let A = () =&gt; &#123;&#125;;// undefinedlet a = new A();// VM423: 1 Uncaught TypeError: A is not a constructor// at &lt; anonymous &gt;: 1: 9 ä¸ç»‘å®š argumentsï¼Œä½†æ˜¯å¯ä½¿ç”¨ â€¦rest å‚æ•°æ™®é€šå‡½æ•°ä½¿ç”¨ arguments let A = function (a) &#123; console.log(arguments);&#125;;// undefinedA(1, 2, 3, 4);// VM530: 2 Arguments(4)[1, 2, 3, 4, callee: Æ’, Symbol(Symbol.iterator): Æ’]// undefined ç®­å¤´å‡½æ•°ä½¿ç”¨ï¼Œç”¨äº†ä¼šæŠ¥é”™ã€‚ ä½†æ˜¯å¯ä»¥ä½¿ç”¨ ...rest å‡½æ•° let A = (...a) =&gt; console.log(a);// undefinedA(1, 2, 3, 4);// VM680: 1(4)[1, 2, 3, 4]// undefined arguments çš„ä¸€èˆ¬ä½¿ç”¨åœºæ™¯æ˜¯ï¼šå…è®¸ä¼ å…¥ 3 ä¸ªå‚æ•°ï¼Œä¸­é—´ä¸€ä¸ªå‚æ•°æ˜¯å¯é€‰ã€‚å¦‚æœåªä¼  1 ä¸ªå‚å°±æ˜¯å‚æ•° 1 ç”¨ï¼Œä¼ å…¥ 2 ä¸ªå‚å°±æ˜¯å‚æ•° 1 å’Œå‚æ•° 3 ç”¨â€¦ let f = function (a, b, c) &#123; if (arguments.length == 2) &#123; c = b; b = null; &#125; console.log(a, b, c);&#125;;f(1);// VM850: 6 1 undefined undefinedf(1, 2);// VM850: 6 1 null 2f(1, 2, 3);// VM850: 6 1 2 3 rest å‚æ•°ä½¿ç”¨æ•ˆæœï¼šrest é»˜è®¤æ˜¯[]ï¼Œå¤šä½™çš„ä¼ å‚ä¼šåŠ å…¥æ•°ç»„ this æŒ‡å‘ä¸ä¸€æ · f1 æ˜¯ç®­å¤´å‡½æ•°ï¼Œthis ä»£è¡¨ä¸Šå±‚å¯¹è±¡ï¼Œè‹¥æ— è‡ªå®šä¹‰ä¸Šå±‚ï¼Œåˆ™ä»£è¡¨ windowã€‚ f2 æ˜¯æ™®é€šå‡½æ•°ï¼Œthis ä»£è¡¨å½“å‰å¯¹è±¡ã€‚ ç®­å¤´å‡½æ•°çš„ call()æˆ– apply()å‡½æ•°ï¼Œä¸ä¼šå½±å“åˆ° this çš„ä»£è¡¨å¯¹è±¡ï¼š ç®­å¤´å‡½æ•°æ²¡æœ‰åŸå‹å±æ€§ï¼š prototype æ˜¯æ™®é€šå‡½æ•°ç”¨äºè·å–åŸå‹å¯¹è±¡çš„ã€‚ æ€»ç»“ç®­å¤´å‡½æ•°å†…çš„ this æŒ‡å‘ä¸Šå±‚å¯¹è±¡ï¼Œbind()ã€call()ã€apply()å‡æ— æ³•æ”¹å˜æŒ‡å‘ã€‚ æ™®é€šå‡½æ•°å†…çš„ this æ‰§è¡Œè°ƒç”¨å…¶å‡½æ•°çš„å¯¹è±¡ã€‚ å‚è€ƒç†è§£æ™®é€šå‡½æ•°å’Œç®­å¤´å‡½æ•°çš„åŒºåˆ«ç‚¹","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"cssä»å³å¾€å·¦åŒ¹é…è§„åˆ™","date":"2021-01-16T09:37:04.000Z","path":"2021/01/16/2021-01-16-css-match-principle/","text":"ä¸¾ä¸ªä¾‹å­ .mod-nav h3 span &#123; font-size: 16px;&#125; ä¸Šè¿°ä»£ç åœ¨cssè¿è¡Œæ—¶ï¼Œæ˜¯ä»å·¦å¾€å³åŒ¹é…å‘¢ï¼Œè¿˜æ˜¯ä»å³å¾€å·¦åŒ¹é…ã€‚ å¦‚æœä¸çŸ¥é“åŒ¹é…è§„åˆ™ï¼Œå¯èƒ½çš„ç†è§£æ˜¯ä»å·¦å‘å³åŒ¹é…: å…ˆæ‰¾åˆ°.mod-navï¼Œç„¶åé€çº§åŒ¹é…h3ã€spanï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¦‚æœéå†åˆ°å¶å­èŠ‚ç‚¹éƒ½æ²¡æœ‰åŒ¹é…å°±éœ€è¦å›æº¯ï¼Œç»§ç»­å¯»æ‰¾ä¸‹ä¸€ä¸ªåˆ†æ”¯ã€‚ ä½†äº‹å®ä¸Šï¼ŒCSSé€‰æ‹©å™¨çš„è¯»å–é¡ºåºæ˜¯ä»å³å‘å·¦ã€‚ è¿˜æ˜¯ä¸Šé¢çš„é€‰æ‹©å™¨ï¼Œå®ƒçš„è¯»å–é¡ºåºå˜æˆï¼šå…ˆæ‰¾åˆ°æ‰€æœ‰çš„spanï¼Œæ²¿ç€spançš„çˆ¶å…ƒç´ æŸ¥æ‰¾h3ï¼Œä¸­é€”æ‰¾åˆ°äº†ç¬¦åˆåŒ¹é…è§„åˆ™çš„èŠ‚ç‚¹å°±åŠ å…¥ç»“æœé›†ï¼›å¦‚æœç›´åˆ°æ ¹å…ƒç´ htmléƒ½æ²¡æœ‰åŒ¹é…ï¼Œåˆ™ä¸å†éå†è¿™æ¡è·¯å¾„ï¼Œä»ä¸‹ä¸€ä¸ªspanå¼€å§‹é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼ˆå¦‚æœæœ‰å¤šä¸ªæœ€å³èŠ‚ç‚¹ä¸ºspançš„è¯ï¼‰ã€‚ ä¸ºä»€ä¹ˆä»å³å‘å·¦çš„è§„åˆ™è¦æ¯”ä»å·¦å‘å³çš„é«˜æ•ˆï¼Ÿ .mode-nav / \\ header div / \\ h3 ul | / \\span li ... li | | a a å‡å¦‚DOMçš„ç»“æ„å¦‚ä¸Šå›¾ï¼ŒåŒ¹é…è§„åˆ™æ˜¯ .mod-nav h3 span ã€‚ è‹¥ä»å·¦å‘å³çš„åŒ¹é…ï¼Œè¿‡ç¨‹æ˜¯ï¼šä» .mod-nav å¼€å§‹ï¼Œéå†å­èŠ‚ç‚¹ header å’Œå­èŠ‚ç‚¹ div ï¼Œç„¶åå„è‡ªå‘å­èŠ‚ç‚¹éå†ã€‚åœ¨å³ä¾§ div çš„åˆ†æ”¯ä¸­ï¼Œæœ€åéå†åˆ°å¶å­èŠ‚ç‚¹ a ï¼Œå‘ç°ä¸ç¬¦åˆè§„åˆ™ï¼Œéœ€è¦å›æº¯åˆ° ul èŠ‚ç‚¹ï¼Œå†éå†ä¸‹ä¸€ä¸ª li-a ï¼Œå‡å¦‚æœ‰1000ä¸ª li ï¼Œåˆ™è¿™1000æ¬¡çš„éå†ä¸å›æº¯ä¼šæŸå¤±å¾ˆå¤šæ€§èƒ½ã€‚ å†çœ‹çœ‹ä»å³è‡³å·¦çš„åŒ¹é…ï¼šå…ˆæ‰¾åˆ°æ‰€æœ‰çš„æœ€å³èŠ‚ç‚¹ span ï¼Œå¯¹äºæ¯ä¸€ä¸ª span ï¼Œå‘ä¸Šå¯»æ‰¾èŠ‚ç‚¹ h3 ï¼Œç”±h3å†å‘ä¸Šå¯»æ‰¾class=mod-navçš„èŠ‚ç‚¹ï¼Œæœ€åæ‰¾åˆ°æ ¹å…ƒç´  html åˆ™ç»“æŸè¿™ä¸ªåˆ†æ”¯çš„éå†ã€‚ å¾ˆæ˜æ˜¾ï¼Œä¸¤ç§åŒ¹é…è§„åˆ™çš„æ€§èƒ½å·®åˆ«å¾ˆå¤§ã€‚ä¹‹æ‰€ä»¥ä¼šå·®åˆ«å¾ˆå¤§ï¼Œæ˜¯å› ä¸ºä»å³å‘å·¦çš„åŒ¹é…åœ¨ç¬¬ä¸€æ­¥å°±ç­›é€‰æ‰äº†å¤§é‡çš„ä¸ç¬¦åˆæ¡ä»¶çš„æœ€å³èŠ‚ç‚¹ï¼ˆå¶å­èŠ‚ç‚¹ï¼‰ï¼›è€Œä»å·¦å‘å³çš„åŒ¹é…è§„åˆ™çš„æ€§èƒ½éƒ½æµªè´¹åœ¨äº†å¤±è´¥çš„æŸ¥æ‰¾ä¸Šé¢ã€‚ å½“ç„¶è¿™æ˜¯æ¯”è¾ƒæ˜æ˜¾æƒ…å†µï¼Œå¦‚æœåœ¨å¶å­ä¸Šå­˜åœ¨å¤šä¸ªä¸ç¬¦åˆæ¡ä»¶çš„ span ï¼Œä»å³å‘å·¦çš„è§„åˆ™ä¹Ÿä¼šèµ°ä¸€äº›å¼¯è·¯ï¼ˆè¿™æ—¶å°±éœ€è¦ä¼˜åŒ– CSS é€‰æ‹©å™¨äº†ï¼‰ã€‚ä½†å¹³å‡æ¥è¯´å®ƒè¿˜æ˜¯æ›´é«˜æ•ˆï¼Œå› ä¸ºå¤§å¤šæ—¶å€™ï¼Œä¸€ä¸ª DOM æ ‘ä¸­ï¼Œç¬¦åˆåŒ¹é…æ¡ä»¶çš„èŠ‚ç‚¹ï¼ˆå¦‚ .mod-nav h3 span ï¼‰è¿œè¿œè¿œè¿œå°‘äºä¸ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ã€‚ jQuery ä»1.3ç‰ˆæœ¬å¼€å§‹ä½¿ç”¨çš„ Sizzle å¼•æ“ï¼Œå®ƒæŒ‰ç…§äº† CSS é€‰æ‹©å™¨çš„åŒ¹é…è§„åˆ™ï¼ˆä»å³è‡³å·¦ï¼‰è¿›è¡ŒDOMå…ƒç´ çš„æŸ¥æ‰¾ä¸åŒ¹é…ï¼ˆå½“ç„¶å…¶ä¸­åšäº†å¾ˆå¤šä¼˜åŒ–ï¼‰ï¼Œæ€§èƒ½å¾—åˆ°äº†å¾ˆå¤§çš„æå‡ã€‚ å‚è€ƒCSSé€‰æ‹©å™¨ä»å³å‘å·¦çš„åŒ¹é…è§„åˆ™","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"}]},{"title":"jsæ•°æ®ç±»å‹åˆ¤æ–­","date":"2021-01-01T03:19:20.000Z","path":"2021/01/01/2021-01-01-js-data-type-judge/","text":"javascripä¸­æœ‰å‡ ç§åˆ¤æ–­æ•°æ®ç±»å‹çš„åŠæ³•ï¼Œä¸åŒçš„åœºæ™¯ä½¿ç”¨ä¸åŒçš„æ–¹æ³• typeof ã€ Object.prototype.toString.call ã€ instance of typeoftypeof æ˜¯ä¸€ä¸ªä¸€å…ƒè¿ç®—ï¼Œæ”¾åœ¨ä¸€ä¸ªè¿ç®—æ•°ä¹‹å‰ï¼Œè¿ç®—æ•°å¯ä»¥æ˜¯ä»»æ„ç±»å‹ã€‚è¿”å›å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²è¯´æ˜è¿ç®—æ•°çš„ç±»å‹ã€‚typeof ä¸€èˆ¬åªèƒ½è¿”å›å¦‚ä¸‹å‡ ä¸ªç»“æœï¼šnumber, boolean, string, function, object, undefined ã€‚ä¸€èˆ¬å¯ä»¥ä½¿ç”¨ typeof æ¥è·å–ä¸€ä¸ªå˜é‡æ˜¯å¦å­˜åœ¨ï¼Œå¦‚ if (typeof a != &quot;undefined&quot;) &#123; alert(&quot;ok&quot;)&#125; è€Œä¸è¦å»ä½¿ç”¨ if(a) å› ä¸ºå¦‚æœ a ä¸å­˜åœ¨ï¼ˆæœªå£°æ˜ï¼‰åˆ™ä¼šå‡ºé”™ï¼Œå¯¹äº Array , Null ç­‰ç‰¹æ®Šå¯¹è±¡ä½¿ç”¨ typeof ä¸€å¾‹è¿”å› object ï¼Œè¿™æ­£æ˜¯ typeof çš„å±€é™æ€§ã€‚ Object.prototype.toString.call1. åˆ¤æ–­åŸºæœ¬ç±»å‹ï¼šObject.prototype.toString.call(null); //&quot;[object Null]&quot;Object.prototype.toString.call(undefined); //&quot;[object Undefined]&quot;Object.prototype.toString.call(&quot;abc&quot;); //&quot;[object String]&quot;Object.prototype.toString.call(123); //&quot;[object Number]&quot;Object.prototype.toString.call(true); //&quot;[object Boolean]&quot; 2. åˆ¤æ–­åŸç”Ÿå¼•ç”¨ç±»å‹ï¼šå‡½æ•°ç±»å‹Function fn() &#123; console.log(&quot;test&quot;);&#125;Object.prototype.toString.call(fn); //&quot;[object Function]&quot;æ—¥æœŸç±»å‹var date = new Date();Object.prototype.toString.call(date); //&quot;[object Date]&quot;æ•°ç»„ç±»å‹var arr = [1, 2, 3];Object.prototype.toString.call(arr); //&quot;[object Array]&quot;æ­£åˆ™è¡¨è¾¾å¼var reg = /[hbc]at/gi;Object.prototype.toString.call(arr); //&quot;[object RegExp]&quot;è‡ªå®šä¹‰ç±»å‹function Person(name, age) &#123; this.name = name; this.age = age;&#125;var person = new Person(&quot;Rose&quot;, 18);Object.prototype.toString.call(person); //&quot;[object Object]&quot; instance ofinstanceof ç”¨äºåˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æŸä¸ªå¯¹è±¡çš„å®ä¾‹ï¼Œå¦‚ var a = new Array();alert(a instanceof Array); ä¼šè¿”å› trueï¼ŒåŒæ—¶ alert(a instanceof Object) ä¹Ÿä¼šè¿”å› true ; è¿™æ˜¯å› ä¸º Array æ˜¯ object çš„å­ç±»ã€‚ ä½†æ˜¯å½“æˆ‘ä»¬ç”¨å˜é‡ç›´æ¥èµ‹å€¼æ—¶ï¼Œå®ƒä¸æ˜¯ç”±æ„é€ å‡½æ•°äº§ç”Ÿçš„ï¼Œ instanceof ä¸º false var a = &#x27;123&#x27;undefineda instanceof Objectfalsevar a = new String(&#x27;123&#x27;)undefineda instanceof Objecttrue","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"æµè§ˆå™¨ä»è¾“å…¥URLåˆ°æ¸²æŸ“å®Œé¡µé¢çš„æ•´ä¸ªè¿‡ç¨‹","date":"2020-12-29T02:22:01.000Z","path":"2020/12/29/2020-12-29-process-of-render-page/","text":"ä»è¾“å…¥ URL åˆ°æ¸²æŸ“å‡ºæ•´ä¸ªé¡µé¢çš„è¿‡ç¨‹åŒ…æ‹¬ä»¥ä¸‹éƒ¨åˆ†ï¼š 1ã€DNS è§£æ URL çš„è¿‡ç¨‹ 2ã€æµè§ˆå™¨å‘é€è¯·æ±‚ä¸æœåŠ¡å™¨äº¤äº’çš„è¿‡ç¨‹ï¼ˆ3 æ¬¡æ¡æ‰‹ï¼‰ 3ã€æµè§ˆå™¨å¯¹æ¥æ”¶åˆ°çš„ html é¡µé¢æ¸²æŸ“çš„è¿‡ç¨‹ 4ã€æµè§ˆå™¨å’ŒæœåŠ¡å™¨æ–­å¼€è¿æ¥ï¼ˆ4 æ¬¡æ¡æ‰‹ï¼‰ DNS è§£æ URL çš„è¿‡ç¨‹DNS è§£æçš„è¿‡ç¨‹å°±æ˜¯å¯»æ‰¾å“ªä¸ªæœåŠ¡å™¨ä¸Šæœ‰è¯·æ±‚çš„èµ„æºã€‚å› ä¸º ip åœ°å€ä¸å®¹æ˜“è®°å¿†ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨ URL åŸŸåï¼ˆå¦‚www.baidu.comï¼‰ä½œä¸ºç½‘å€ã€‚DNS è§£æå°±æ˜¯å°†åŸŸåç¿»è¯‘æˆ IP åœ°å€çš„è¿‡ç¨‹ã€‚ å…·ä½“è¿‡ç¨‹ï¼š 1 æµè§ˆå™¨ç¼“å­˜ï¼šæµè§ˆå™¨ä¼šæŒ‰ç…§ä¸€å®šçš„é¢‘ç‡ ç¼“å­˜ DNS è®°å½• 2 æ“ä½œç³»ç»Ÿç¼“å­˜ï¼šå¦‚æœæµè§ˆå™¨ç¼“å­˜ä¸­æ‰¾ä¸åˆ°éœ€è¦çš„ DNS è®°å½•ï¼Œå°±ä¼šå–æ“ä½œç³»ç»Ÿä¸­æ‰¾ 3 è·¯ç”±ç¼“å­˜ï¼šè·¯ç”±å™¨ä¹Ÿæœ‰ DNS ç¼“å­˜ 4 ISP çš„ DNS æœåŠ¡å™¨ï¼šISP æœ‰ä¸“é—¨çš„ DNS æœåŠ¡å™¨åº”å¯¹ DNS æŸ¥è¯¢è¯·æ±‚ 5 æ ¹æœåŠ¡å™¨ï¼šISP çš„ DNS æœåŠ¡å™¨æ‰¾ä¸åˆ°ä¹‹åï¼Œå°±è¦å‘æ ¹æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œè¿›è¡Œé€’å½’æŸ¥è¯¢ æµè§ˆå™¨ä¸æœåŠ¡å™¨äº¤äº’è¿‡ç¨‹ 1 é¦–å…ˆæµè§ˆå™¨åˆ©ç”¨ tcp åè®®é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ http è¯·æ±‚åŒ…æ‹¬ header å’Œ bodyã€‚header ä¸­åŒ…æ‹¬è¯·æ±‚çš„æ–¹å¼ï¼ˆget å’Œ postï¼‰ã€è¯·æ±‚çš„åè®® ï¼ˆhttpã€httpsã€ftpï¼‰ã€è¯·æ±‚çš„åœ°å€ ipã€ç¼“å­˜ cookieã€‚body ä¸­æœ‰è¯·æ±‚çš„å†…å®¹ã€‚ tcp å°† http é•¿æŠ¥æ–‡åˆ’åˆ†ä¸ºçŸ­æŠ¥æ–‡ï¼Œé€šè¿‡ä¸‰æ¬¡æ¡æ‰‹ä¸æœåŠ¡ç«¯å»ºç«‹è¿æ¥ï¼Œè¿›è¡Œå¯é ä¼ è¾“ã€‚ä¸‰æ¬¡æ¡æ‰‹çš„æ­¥éª¤ï¼ˆæŠ½è±¡æ´¾ï¼‰å®¢æˆ·ç«¯ï¼šhelloï¼Œä½ æ˜¯ server ä¹ˆï¼ŸæœåŠ¡ç«¯ï¼šhelloï¼Œæˆ‘æ˜¯ serverï¼Œä½ æ˜¯ client ä¹ˆå®¢æˆ·ç«¯ï¼šyesï¼Œæˆ‘æ˜¯ client 2 æµè§ˆå™¨æ ¹æ®è§£æåˆ°çš„ IP åœ°å€å’Œç«¯å£å·å‘èµ· http çš„ get è¯·æ±‚. 3 æœåŠ¡å™¨æ¥æ”¶åˆ° http è¯·æ±‚ä¹‹åï¼Œå¼€å§‹æœç´¢ html é¡µé¢ï¼Œå¹¶ä½¿ç”¨ http è¿”å›å“åº”æŠ¥æ–‡ 4 è‹¥çŠ¶æ€ç ä¸º 200 æ˜¾ç¤ºå“åº”æˆåŠŸï¼Œæµè§ˆå™¨æ¥æ”¶åˆ°è¿”å›çš„ html é¡µé¢ä¹‹åï¼Œå¼€å§‹è¿›è¡Œé¡µé¢çš„æ¸²æŸ“ æµè§ˆå™¨é¡µé¢æ¸²æŸ“è¿‡ç¨‹ 1 æµè§ˆå™¨æ ¹æ®æ·±åº¦éå†çš„æ–¹å¼æŠŠ html èŠ‚ç‚¹éå†æˆ dom æ ‘ 2 å°† css è§£ææˆ CSS DOM æ ‘ 3 å°† dom æ ‘å’Œ CSS DOM æ ‘æ„é€ æˆ render æ ‘ 4 JS æ ¹æ®å¾—åˆ°çš„ render æ ‘ è®¡ç®—æ‰€æœ‰èŠ‚ç‚¹åœ¨å±å¹•ä¸­çš„ä½ç½®ï¼Œè¿›è¡Œå¸ƒå±€ï¼ˆå›æµï¼‰ 5 éå† render æ ‘å¹¶è°ƒç”¨ç¡¬ä»¶ API ç»˜åˆ¶æ‰€æœ‰èŠ‚ç‚¹ï¼ˆé‡ç»˜ï¼‰ æµè§ˆå™¨ä¸æœåŠ¡å™¨æ–­å¼€è¿æ¥æ–­å¼€è¿æ¥æ—¶ï¼Œéœ€è¦è¿›è¡Œå››æ¬¡æŒ¥æ‰‹ï¼ˆå› ä¸ºæ˜¯å…¨åŒå·¥çš„ï¼Œæ‰€ä»¥éœ€è¦å››æ¬¡æŒ¥æ‰‹ï¼‰ã€‚ å››æ¬¡æŒ¥æ‰‹çš„æ­¥éª¤(æŠ½è±¡æ´¾) ä¸»åŠ¨æ–¹ï¼šæˆ‘å·²ç»å…³é—­äº†å‘ä½ é‚£è¾¹çš„ä¸»åŠ¨é€šé“äº†ï¼Œåªèƒ½è¢«åŠ¨æ¥æ”¶äº† è¢«åŠ¨æ–¹ï¼šæ”¶åˆ°é€šé“å…³é—­çš„ä¿¡æ¯ è¢«åŠ¨æ–¹ï¼šé‚£æˆ‘ä¹Ÿå‘Šè¯‰ä½ ï¼Œæˆ‘è¿™è¾¹å‘ä½ çš„ä¸»åŠ¨é€šé“ä¹Ÿå…³é—­äº† ä¸»åŠ¨æ–¹ï¼šæœ€åæ”¶åˆ°æ•°æ®ï¼Œä¹‹ååŒæ–¹æ— æ³•é€šä¿¡","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"}]},{"title":"VUEåŸºç¡€çŸ¥è¯†","date":"2020-12-22T16:00:00.000Z","path":"2020/12/23/2020-12-23-vue-knownledge/","text":"vue åŒå‘ç»‘å®šçš„åŸç†é‡‡ç”¨æ•°æ®åŠ«æŒç»“åˆå‘å¸ƒè€…-è®¢é˜…è€…æ¨¡å¼çš„æ–¹å¼ï¼Œé€šè¿‡ Object.defineProperty()æ¥åŠ«æŒå„ä¸ªå±æ€§çš„ setterï¼Œgetterï¼Œåœ¨æ•°æ®å˜åŠ¨æ—¶å‘å¸ƒæ¶ˆæ¯ç»™è®¢é˜…è€…ï¼Œè§¦å‘ç›¸åº”çš„ç›‘å¬å›è°ƒï¼Œå®ç°è§†å›¾åˆ·æ–°ã€‚ å…·ä½“æµç¨‹ï¼šVue ä¸­å…ˆéå† data é€‰é¡¹ä¸­æ‰€æœ‰çš„å±æ€§ï¼ˆå‘å¸ƒè€…ï¼‰ç”¨ Object.defineProperty åŠ«æŒè¿™äº›å±æ€§å°†å…¶è½¬ä¸º getter/setterã€‚è¯»å–æ•°æ®æ—¶å€™ä¼šè§¦å‘ getterã€‚ä¿®æ”¹æ•°æ®æ—¶ä¼šè§¦å‘ setterã€‚ ç„¶åç»™æ¯ä¸ªå±æ€§å¯¹åº” new Dep()ï¼ŒDep æ˜¯ä¸“é—¨æ”¶é›†ä¾èµ–ã€åˆ é™¤ä¾èµ–ã€å‘ä¾èµ–å‘é€æ¶ˆæ¯çš„ã€‚å…ˆè®©æ¯ä¸ªä¾èµ–è®¾ç½®åœ¨ Dep.target ä¸Šï¼Œåœ¨ Dep ä¸­åˆ›å»ºä¸€ä¸ªä¾èµ–æ•°ç»„ï¼Œå…ˆåˆ¤æ–­ Dep.target æ˜¯å¦å·²ç»åœ¨ä¾èµ–ä¸­å­˜åœ¨ï¼Œä¸å­˜åœ¨çš„è¯æ·»åŠ åˆ°ä¾èµ–æ•°ç»„ä¸­å®Œæˆä¾èµ–æ”¶é›†ï¼Œéšåå°† Dep.target ç½®ä¸ºä¸Šä¸€ä¸ªä¾èµ–ã€‚ ç»„ä»¶åœ¨æŒ‚è½½è¿‡ç¨‹ä¸­éƒ½ä¼š new ä¸€ä¸ª Watcher å®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹å°±æ˜¯ä¾èµ–ï¼ˆè®¢é˜…è€…ï¼‰ã€‚Watcher ç¬¬äºŒå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ­¤å‡½æ•°ä½œç”¨æ˜¯æ›´æ–°ä¸”æ¸²æŸ“èŠ‚ç‚¹ã€‚åœ¨é¦–æ¬¡æ¸²æŸ“è¿‡ç¨‹ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ Dep æ–¹æ³•æ¥æ”¶é›†ä¾èµ–ï¼Œæ”¶é›†å®Œæˆåç»„ä»¶ä¸­æ¯ä¸ªæ•°æ®éƒ½ç»‘å®šä¸Šè¯¥ä¾èµ–ã€‚å½“æ•°æ®å˜åŒ–æ—¶å°±ä¼šåœ¨ setter ä¸­é€šçŸ¥å¯¹åº”çš„ä¾èµ–è¿›è¡Œæ›´æ–°ã€‚åœ¨æ›´æ–°è¿‡ç¨‹ä¸­è¦å…ˆè¯»å–æ•°æ®ï¼Œå°±ä¼šè§¦å‘ Wacther çš„ç¬¬äºŒä¸ªå‡½æ•°å‚æ•°ã€‚ä¸€è§¦å‘å°±å†æ¬¡è‡ªåŠ¨è°ƒç”¨ Dep æ–¹æ³•æ”¶é›†ä¾èµ–ï¼ŒåŒæ—¶åœ¨æ­¤å‡½æ•°ä¸­è¿è¡Œpatchï¼ˆdiff è¿ç®—)æ¥æ›´æ–°å¯¹åº”çš„ DOM èŠ‚ç‚¹ï¼Œå®Œæˆäº†åŒå‘ç»‘å®šã€‚ æ¯ä¸€ä¸ªç»„ä»¶é»˜è®¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ª Watcherï¼Œè‡ªå®šä¹‰çš„ watch å’Œ computed æ–¹æ³•ä¹Ÿä¼šåˆ›å»º Watcher Object.defineProperty()å®ç°åŒå‘ç»‘å®šçš„ç¼ºç‚¹ åªèƒ½ç›‘å¬æŸä¸ªå±æ€§ï¼Œä¸èƒ½ç›‘å¬æ•´ä¸ªå¯¹è±¡ éœ€è¦ä½¿ç”¨ for in éå†å¯¹è±¡å±æ€§ç»‘å®šç›‘å¬ ä¸èƒ½ç›‘å¬æ•°ç»„ï¼Œéœ€è¦é‡å†™æ•°ç»„æ–¹æ³•è¿›è¡Œç‰¹å¼‚æ€§æ“ä½œ ä¼šæ±¡æŸ“åŸå¯¹è±¡ ç›´æ¥ç»™ä¸€ä¸ªæ•°ç»„é¡¹èµ‹å€¼ï¼Œvue èƒ½æ£€æµ‹åˆ°å— ç”±äº js çš„é™åˆ¶(å¼•ç”¨ç±»å‹)ï¼Œvue ä¸èƒ½æ£€æµ‹åˆ°ä»¥ä¸‹æ•°ç»„çš„å˜åŠ¨(å¯¹è±¡å±æ€§çš„æ·»åŠ å’Œåˆ é™¤)ï¼š å½“ä½ åˆ©ç”¨ç´¢å¼•ç›´æ¥è®¾ç½®ä¸€ä¸ªæ•°ç»„é¡¹æ—¶ï¼Œä¾‹å¦‚ vm.item[indexOfItem] = newValue å½“ä½ ä¿®æ”¹æ•°ç»„çš„é•¿åº¦æ—¶ï¼Œä¾‹å¦‚ vm.items.length = newLength ä¸ºäº†è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œvue æä¾›äº†ä»¥ä¸‹æ“ä½œæ–¹æ³•ï¼š Vue.set(vm.items, indexOfItem, newValue)Vue.$set(vm.items, indexOfItem, newValue)Vue.$set(this.data, â€keyâ€, value) // åŠ¨æ€æ·»åŠ å•ä¸ªå±æ€§// åŠ¨æ€æ·»åŠ å¤šä¸ªå±æ€§this.obj = Object.assign(&#123;&#125;, this.obj, &#123; age: 18, name: &#x27;Chocolate&#x27;,&#125;)Vue.items.splice(indexOfItem, 1, newValue) ä¸ºäº†è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ï¼Œvue æä¾›äº†ä»¥ä¸‹æ“ä½œæ–¹æ³•ï¼š vm.items.splice(newLength); Vue æ˜¯ä¸èƒ½æ£€æµ‹å¯¹è±¡å±æ€§çš„æ·»åŠ æˆ–åˆ é™¤ data() &#123; return &#123; obj: &#123; name: &#x27;Vue&#x27; &#125; &#125;; &#125;, mounted() &#123; this.name = &#x27;zs&#x27; // ä¸æ˜¯å“åº”å¼çš„ this.$set(this.obj, &#x27;name&#x27;, &#x27;lisi&#x27;) //å“åº”å¼ è§£å†³æ·»åŠ  // ç”¨Object.assignæ¥è§£å†³ç¬¬äºŒç§æƒ…å†µã€‚è§£å†³å¯¹è±¡çš„åˆ é™¤ // Vue.delete &#125;, delete å’Œ Vue.delete çš„åŒºåˆ«delete åªæ˜¯è¢«åˆ é™¤çš„å…ƒç´ å˜æˆäº† empty/undefinedï¼Œå…¶ä»–å…ƒç´ çš„é”®å€¼è¿˜æ˜¯ä¸å˜çš„ã€‚è€Œ Vue.delete ç›´æ¥åˆ é™¤äº†æ•°ç»„ï¼Œæ”¹å˜äº†æ•°ç»„çš„é”®å€¼ã€‚ Vue ä¸­èƒ½ç›‘å¬åˆ°æ•°ç»„å˜åŒ–çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿä¸ºä»€ä¹ˆè¿™äº›æ–¹æ³•èƒ½ç›‘å¬åˆ°å‘¢ï¼Ÿ push()ã€pop()ã€shift()ã€unshift()ã€splice()ã€sort()ã€reverse()ï¼Œè¿™äº›æ–¹æ³•åœ¨ Vue ä¸­è¢«é‡æ–°å®šä¹‰äº†ï¼Œæ•…å¯ä»¥ç›‘å¬åˆ°æ•°ç»„å˜åŒ–ï¼› filter()ã€concat()ã€slice()ï¼Œè¿™äº›æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°æ•°ç»„ï¼Œä¹Ÿå¯ä»¥ç›‘å¬åˆ°æ•°ç»„çš„å˜åŒ–ã€‚ ç»„ä»¶ä¸­çš„ data ä¸ºä»€ä¹ˆæ˜¯ä¸ªå‡½æ•°å› ä¸ºç»„ä»¶æ˜¯æ‹¿æ¥å¤ç”¨çš„ï¼Œä¸” js é‡Œçš„å¯¹è±¡æ˜¯å¼•ç”¨å…³ç³»ï¼Œå¦‚æœç»„ä»¶ä¸­çš„ data æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆè¿™æ ·ä½œç”¨åŸŸæ²¡æœ‰éš”ç¦»ï¼Œå­ç»„ä»¶ä¸­çš„ data å±æ€§å€¼ä¼šç›¸äº’å½±å“ï¼Œå¦‚æœç»„ä»¶ä¸­çš„ data æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆæ¯ä¸ªå®ä¾‹å¯ä»¥ç»´æŠ¤ä¸€ä»½è¢«è¿”å›å¯¹è±¡çš„ç‹¬ç«‹çš„æ‹·è´ï¼Œç»„ä»¶å®ä¾‹ä¹‹é—´çš„ data å±æ€§å€¼ä¸ä¼šäº’ç›¸å½±å“ï¼Œè€Œ new Vue çš„å®ä¾‹æ˜¯ä¸ä¼šè¢«å¤ç”¨çš„ï¼Œå› æ­¤ä¸å­˜åœ¨å¼•ç”¨å¯¹è±¡çš„é—®é¢˜ã€‚ ä¸éœ€è¦å“åº”å¼çš„æ•°æ®åº”è¯¥æ€ä¹ˆå¤„ç†// 1 å®šä¹‰åœ¨dataä¹‹å¤–data() &#123; this.list1 = &#123; &#125;; this.list2 = &#123; &#125;; return &#123;&#125;&#125;// 2 Object.freezedata() &#123; return &#123; list1: Object.freeze(&#123;&#125;) list2: Object.freeze(&#123;&#125;) &#125;&#125; vue æŒ‡ä»¤v-show å’Œ v-if æœ‰ä»€ä¹ˆåŒºåˆ« v-ifï¼ˆåˆå§‹åŒ–ä¸ä¼šæ¸²æŸ“ï¼‰v-if æ˜¯çœŸæ­£çš„æ¡ä»¶æ¸²æŸ“ï¼Œå› ä¸ºå®ƒä¼šç¡®ä¿åœ¨åˆ‡æ¢è¿‡ç¨‹ä¸­æ¡ä»¶å—å†…çš„äº‹ä»¶ç›‘å¬å’Œå­ç»„ä»¶é€‚å½“åœ°è¢«é”€æ¯å’Œé‡å»ºï¼Œä¹Ÿæ˜¯æƒ°æ€§çš„ï¼Œå¦‚æœåœ¨åˆå§‹æ¸²æŸ“æ¡ä»¶ä¸ºå‡æ—¶ï¼Œåˆ™ä»€ä¹ˆä¹Ÿä¸åšâ€”â€”ç›´åˆ°æ¡ä»¶ç¬¬ä¸€æ¬¡å˜ä¸ºçœŸæ—¶æ‰å¼€å§‹æ¸²æŸ“æ¡ä»¶å—ï¼Œèƒ½ç”¨åœ¨ &lt;template&gt; ä¸Šã€‚ v-showï¼ˆåˆå§‹åŒ–ä¼šæ¸²æŸ“ï¼‰v-show å°±ç®€å•å¾—å¤šï¼Œä¸ç®¡åˆå§‹æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Œå…ƒç´ æ€»æ˜¯ä¼šè¢«æ¸²æŸ“ï¼Œå¹¶ä¸”åªæ˜¯ç®€å•åœ°åŸºäº css çš„ display è¿›è¡Œåˆ‡æ¢ã€‚ æ‰€ä»¥ï¼Œv-if é€‚ç”¨äºåˆ‡æ¢ä¸é¢‘ç¹çš„åœºæ™¯ï¼Œv-show é€‚ç”¨äºåˆ‡æ¢é¢‘ç¹çš„åœºæ™¯ï¼Œä¸èƒ½ç”¨åœ¨ &lt;template&gt; ä¸Šã€‚ ä¸ºä»€ä¹ˆåœ¨ v-for ä¸­ä½¿ç”¨ keyï¼Ÿä¸ºäº†æ ‡è¯†æ¯ä¸ªå”¯ä¸€çš„èŠ‚ç‚¹ï¼Œæ–¹ä¾¿æ¯”è¾ƒï¼Œv-for ä¸­åŠ  key å¯ä»¥å‡å°‘æ¸²æŸ“æ¬¡æ•°ï¼Œæå‡æ¸²æŸ“æ€§èƒ½ã€‚ ä¸¾ä¸ªä¾‹å­ &lt;div v-for=&quot;(item, index) in list&quot; :key=&quot;index&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;/div&gt;list: [ &#123; name: &#x27;å°æ˜&#x27;, id: &#x27;11&#x27; &#125;, &#123; name: &#x27;å°çº¢&#x27;, id: &#x27;12&#x27; &#125;, &#123; name: &#x27;å°è“&#x27;, id: &#x27;13&#x27; &#125;,]&lt;!-- æ¸²æŸ“ä¸º --&gt;&lt;div key=&quot;0&quot;&gt;å°æ˜&lt;/div&gt;&lt;div key=&quot;1&quot;&gt;å°çº¢&lt;/div&gt;&lt;div key=&quot;2&quot;&gt;å°è“&lt;/div&gt;&lt;!-- ç°åœ¨æ‰§è¡Œ list.unshift(&#123; name: &#x27;å°æ—&#x27;, id: &#x27;14&#x27; &#125;) --&gt;&lt;!-- æ¸²æŸ“ä¸º --&gt;&lt;div key=&quot;0&quot;&gt;å°æ—&lt;/div&gt;&lt;div key=&quot;1&quot;&gt;å°æ˜&lt;/div&gt;&lt;div key=&quot;2&quot;&gt;å°çº¢&lt;/div&gt;&lt;div key=&quot;3&quot;&gt;å°è“&lt;/div&gt;&lt;!-- æ–°æ—§å¯¹æ¯” --&gt;&lt;div key=&quot;0&quot;&gt;å°æ˜&lt;/div&gt; &lt;div key=&quot;0&quot;&gt;å°æ—&lt;/div&gt;&lt;div key=&quot;1&quot;&gt;å°çº¢&lt;/div&gt; &lt;div key=&quot;1&quot;&gt;å°æ˜&lt;/div&gt;&lt;div key=&quot;2&quot;&gt;å°è“&lt;/div&gt; &lt;div key=&quot;2&quot;&gt;å°çº¢&lt;/div&gt; &lt;div key=&quot;3&quot;&gt;å°è“&lt;/div&gt; å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœç”¨ index ä½œ key çš„è¯ï¼Œå¦‚æœæ•°ç»„ index å‘ç”Ÿäº†å˜åŒ–ï¼Œæ²¡æœ‰æå‡æ¸²æŸ“æ•ˆç‡ &lt;!-- ç°åœ¨æˆ‘ä»¬ç”¨idä½œkey --&gt;&lt;div key=&quot;11&quot;&gt;å°æ˜&lt;/div&gt;&lt;div key=&quot;12&quot;&gt;å°çº¢&lt;/div&gt;&lt;div key=&quot;13&quot;&gt;å°è“&lt;/div&gt;&lt;!-- ç°åœ¨æ‰§è¡Œ list.unshift(&#123; name: &#x27;å°æ—&#x27;, id: &#x27;14&#x27; &#125;) --&gt;&lt;div key=&quot;14&quot;&gt;å°æ—&lt;/div&gt;&lt;div key=&quot;11&quot;&gt;å°æ˜&lt;/div&gt;&lt;div key=&quot;12&quot;&gt;å°çº¢&lt;/div&gt;&lt;div key=&quot;13&quot;&gt;å°è“&lt;/div&gt;&lt;!-- æ–°æ—§å¯¹æ¯” --&gt;&lt;div key=&quot;14&quot;&gt;å°æ—&lt;/div&gt;&lt;div key=&quot;11&quot;&gt;å°æ˜&lt;/div&gt;&lt;div key=&quot;11&quot;&gt;å°æ˜&lt;/div&gt;&lt;div key=&quot;12&quot;&gt;å°çº¢&lt;/div&gt;&lt;div key=&quot;12&quot;&gt;å°çº¢&lt;/div&gt;&lt;div key=&quot;13&quot;&gt;å°è“&lt;/div&gt;&lt;div key=&quot;13&quot;&gt;å°è“&lt;/div&gt;&lt;!-- å¯ä»¥çœ‹å‡ºå…¶ä»–ä¸‰é¡¹ä¸å˜ï¼Œåªæœ‰å°æ—æ˜¯æ–°å¢çš„ --&gt; ä¸ºä»€ä¹ˆ v-if å’Œ v-for ä¸å»ºè®®ç”¨åœ¨åŒä¸€æ ‡ç­¾åœ¨ vue ä¸­ v-for çš„ä¼˜å…ˆçº§é«˜äº v-if &lt;div v-for=&quot;item in [1,2,3,4,5]&quot; v-if=&quot;item !== 3&quot;&gt;&#123;&#123; item &#125;&#125;&lt;/div&gt; å½“ v-for å’Œ v-if åŒæ—¶å­˜åœ¨æ—¶ï¼Œv-for ä¼šæŠŠä¸Šé¢çš„ 5 ä¸ªå…ƒç´ å…¨éƒ¨æ¸²æŸ“å‡ºæ¥ï¼Œç„¶ååœ¨å»æ‰§è¡Œ v-ifï¼Œå»æŠŠ 3 èŠ‚ç‚¹éšè—èµ·æ¥ï¼Œè¿™æ ·åšçš„åå¤„åœ¨äºæ¸²æŸ“äº†æ— ç”¨çš„ dom èŠ‚ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨ computed å»è§£å†³è¿™ä¸ªé—®é¢˜ &lt;div v-for=&quot;item in list&quot;&gt; &#123;&#123; item &#125;&#125;&lt;/div&gt;computed() &#123; list() &#123; return [1,2,3,4,5].filter(item =&gt; item !==3) &#125;&#125; class å’Œ style å¦‚ä½•åŠ¨æ€ç»‘å®šclass å¯ä»¥é€šè¿‡å¯¹è±¡è¯­æ³•å’Œæ•°ç»„è¯­æ³•è¿›è¡ŒåŠ¨æ€ç»‘å®šï¼š å¯¹è±¡è¯­æ³• &lt;div v-bind:class=&quot;&#123;active: isActive, &#x27;text-danger&#x27;: hasError &#125;&quot;&gt;&lt;/div&gt;&lt;script&gt; data: &#123; isActive: true, hasError: false &#125;&lt;/script&gt; æ•°ç»„è¯­æ³• &lt;div v-bind:class=&quot;[isActive ? activeClass : &#x27;&#x27;, errorClass]&quot;&gt;&lt;/div&gt;&lt;script&gt; data: &#123; activeClass: &#x27;active&#x27;, errorClass: &#x27;text-danger&#x27; &#125;&lt;/script&gt; style ä¹Ÿå¯ä»¥é€šè¿‡å¯¹è±¡è¯­æ³•å’Œæ•°ç»„è¯­æ³•è¿›è¡ŒåŠ¨æ€ç»‘å®š åŠ¨æ€ç»‘å®š Class å’Œ Style&lt;!--ç¬¬ä¸€ç§å¯¹è±¡è¯­æ³• --&gt;&lt;div class=&quot;test&quot; :class=&quot;&#123;active:actived,&#x27;active-click&#x27;: clicked&amp;&amp;actived&#125;&quot;&gt;&lt;/div&gt;&lt;!-- ç¬¬äºŒç§æ•°ç»„è¯­æ³• --&gt;&lt;div class=&quot;test&quot; :class=&quot;[actived?activeClass : &#x27;&#x27;, clicked&amp;&amp;actived?activeClickClass : &#x27;&#x27;]&quot;&gt;&lt;/div&gt;&lt;!-- ç¬¬ä¸‰ç§å¯¹è±¡å’Œæ•°ç»„æ··åˆ --&gt;&lt;div :class=&quot;[testClass,&#123;active:actived&#125;,&#123;&#x27;active-click&#x27;:clicked&amp;&amp;actived&#125;]&quot;&gt;&lt;/div&gt;&lt;!-- ç¬¬å››ç§å¯¹è±¡å’Œè®¡ç®—å±æ€§(æ¨è) --&gt;&lt;div :class=&quot;classObject&quot;&gt;&lt;/div&gt; v-model çš„åŸç†æˆ‘ä»¬åœ¨ vue é¡¹ç›®ä¸­ä¸»è¦ä½¿ç”¨ v-model æŒ‡ä»¤åœ¨è¡¨å• inputï¼Œtextareaï¼Œselect ç­‰å…ƒç´ ä¸Šåˆ›å»ºåŒå‘ç»‘å®šï¼Œæˆ‘ä»¬çŸ¥é“ v-model æœ¬è´¨ä¸Šä¸è¿‡æ˜¯è¯­æ³•ç³–ï¼Œv-model åœ¨å†…éƒ¨ä¸ºä¸åŒçš„è¾“å…¥å…ƒç´ ä½¿ç”¨ä¸åŒçš„å±æ€§å¹¶æŠ›å‡ºä¸åŒçš„äº‹ä»¶ï¼š text å’Œ textarea å…ƒç´ ä½¿ç”¨ value å±æ€§å’Œ input äº‹ä»¶ checkbox å’Œ radio ä½¿ç”¨ checked å’Œ change select å­—æ®µå°† value ä½œä¸º prop å¹¶å°† change ä½œä¸ºäº‹ä»¶ v-on ç»‘å®šå¤šä¸ªæ–¹æ³•&lt;template&gt; &lt;div v-on:&#123;click:a,dblclick:b&#125;&gt;&lt;/div&gt;&lt;/template&gt;&lt;script&gt; methods: &#123; a() &#123; alert(1) &#125;, b() &#123; alert(2) &#125; &#125;&lt;/script&gt; slot æ’æ§½åˆ†å‘å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å°è£…äº†ä¸€ä¸ªå­ç»„ä»¶ä¹‹åï¼Œåœ¨çˆ¶ç»„ä»¶ä½¿ç”¨çš„æ—¶å€™ï¼Œæƒ³æ·»åŠ ä¸€äº› dom å…ƒç´ ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨ slot æ’æ§½äº†ï¼Œä½†æ˜¯è¿™äº› dom æ˜¯å¦æ˜¾ç¤ºä»¥åŠåœ¨å“ªé‡Œæ˜¾ç¤ºï¼Œåˆ™æ˜¯çœ‹å­ç»„ä»¶ä¸­ slot ç»„ä»¶çš„ä½ç½®äº†ã€‚ v-clock æŒ‡ä»¤çš„ä½œç”¨ è§£å†³é¡µé¢é—ªçƒé—®é¢˜(ä¼šæ˜¾ç¤ºæ’å€¼è¡¨è¾¾å¼)å¦‚æœç½‘é€Ÿæ…¢ï¼Œè€Œè¯¥æ ‡ç­¾å†…å®¹æ˜¯å˜é‡æ²¡æœ‰è¯·æ±‚å“åº”å›æ¥çš„æ—¶å€™ï¼Œé¡µé¢ä¸Šå…ˆä¸æ˜¾ç¤ºè¯¥æ ‡ç­¾ï¼ˆvue ç»™è¯¥æ ‡ç­¾åŠ äº† css æ ·å¼ï¼‰ï¼Œå½“å“åº”å›æ¥çš„æ—¶å€™æ”¹æ ‡ç­¾é»˜è®¤å°† css æ ·å¼å»é™¤ã€‚ æ­¤æŒ‡ä»¤å¯ä»¥è§£å†³ä½¿ç”¨æ’å€¼è¡¨è¾¾å¼é¡µé¢é—ªçƒé—®é¢˜ å°†è¯¥æŒ‡ä»¤åŠ åœ¨ html æ ‡ç­¾ä¸­æ—¶ï¼Œå¯ä»¥åœ¨è¯¥æ–‡ä»¶ä¸­åŠ style å±æ€§ä¸º displayï¼šnone &lt;div class=&quot;#app&quot; v-cloak&gt; &lt;p&gt;&#123;&#123;name&#125;&#125;&lt;/p&gt;&lt;/div&gt;[v-cloak] &#123; display: none; &#125; vue çˆ¶å­ç»„ä»¶å®ç°åŒå‘ç»‘å®šå®ä¾‹&lt;Child :name=&quot;name&quot; :change=&quot;changeName&quot; /&gt;&lt;script&gt; props: &#123; name: &#123; type: String, required: false &#125; &#125;, data() &#123; newName: &#x27;&#x27; &#125;, watch: &#123; name(val) &#123; this.newName = val &#125;, newName(val) &#123; this.$emit(&#x27;change&#x27;, val) &#125; &#125;&lt;/script&gt; è‡ªå®šä¹‰ v-modelè‡ªå®šä¹‰ v-modelï¼Œè®¾ç½®å­ç»„ä»¶ model å±æ€§ï¼Œè®¾ç½® v-model ä¾¦å¬çš„å±æ€§å€¼ï¼ŒåŒæ—¶ç»‘å®šå±æ€§å˜åŒ–æ—¶æ‰§è¡Œçš„äº‹ä»¶ï¼Œå®ç°è‡ªå®šä¹‰ v-modelï¼Œå³åŒå‘ç»‘å®šã€‚ // v-modelåªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–&lt;input type=&quot;text&quot; v-model=&quot;price&quot; /&gt;&lt;input type=&quot;text&quot; :value=&quot;price&quot; @input=&quot;price=$event.target.value&quot; /&gt; Vue.extend æ–¹æ³•åˆ›å»ºä¸€ä¸ªç»„ä»¶ // æ³¨å†Œç»„ä»¶Vue.component(&quot;base-checkbox&quot;, &#123; model: &#123; prop: &#x27;checked&#x27;, // ç»‘å®šå±æ€§ event: &#x27;change&#x27;, // æŠ›å‡ºäº‹ä»¶ &#125;, props: &#123; checked: boolean &#125;, templete: `&lt;input type=&quot;checkbox&quot; v-bind:checked=&quot;checked&quot; v-on:change=&quot;$emit(&#x27;change&#x27;,$event.target.value)&quot;/&gt;` &#125;) &lt;base-checkbox v-model=&quot;value&quot; &gt; &lt;/base-checkbox&gt; ç†è§£ vue é‡Œçš„å•å‘æ•°æ®æµæ‰€æœ‰çš„ prop éƒ½ä½¿å¾—å…¶çˆ¶å­ prop ä¹‹é—´å½¢æˆä¸€ä¸ªå•å‘ä¸‹è¡Œç»‘å®šï¼šçˆ¶çº§ prop çš„æ›´æ–°ä¼šå‘ä¸‹æµåŠ¨åˆ°å­ç»„ä»¶ä¸­ï¼Œä½†æ˜¯åè¿‡æ¥ä¸è¡Œï¼Œè¿™æ ·ä¼šé˜²æ­¢ä»å­ç»„ä»¶æ„å¤–æ”¹å˜çˆ¶çº§ç»„ä»¶çš„çŠ¶æ€ï¼Œä»è€Œå¯¼è‡´ä½ çš„åº”ç”¨çš„æ•°æ®æµéš¾ä»¥è§£é‡Š. é¢å¤–åœ°ï¼Œæ¯æ¬¡çˆ¶çº§ç»„ä»¶å‘ç”Ÿæ›´æ–°æ—¶ï¼Œå­ç»„ä»¶ä¸­çš„æ‰€æœ‰ prop éƒ½ä¼šåˆ·æ–°ä¸ºæœ€æ–°çš„å€¼ï¼Œè¿™æ„å‘³ç€ä½ ä¸åº”è¯¥åœ¨ä¸€ä¸ªå­ç»„ä»¶å†…éƒ¨æ”¹å˜ propï¼Œå¦‚æœä½ è¿™æ ·åšäº†ï¼Œvue ä¼šåœ¨æµè§ˆå™¨çš„æ§åˆ¶å°å‘å‡ºè­¦å‘Šï¼Œå­ç»„ä»¶æƒ³ä¿®æ”¹æ—¶ï¼Œåªèƒ½é€šè¿‡$emit æ´¾å‘ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œçˆ¶ç»„ä»¶æ¥æ”¶åˆ°åï¼Œç”±çˆ¶ç»„ä»¶ä¿®æ”¹. åŒå‘æ•°æ®æµæ˜¯æŒ‡æ•°æ®ä»çˆ¶çº§å‘å­çº§ä¼ é€’æ•°æ®ï¼Œå­çº§å¯ä»¥é€šè¿‡ä¸€äº›æ‰‹æ®µæ”¹å˜çˆ¶çº§å‘å­çº§ä¼ é€’çš„æ•°æ®ã€‚ computed å’Œ watchcomputed å’Œ watch çš„åŒºåˆ«å’Œè¿ç”¨åœºæ™¯ computedï¼šæ˜¯è®¡ç®—å±æ€§ï¼Œä¾èµ–å…¶ä»–å±æ€§å€¼ï¼Œå¹¶ä¸” computed çš„å€¼æœ‰ç¼“å­˜ï¼Œåªæœ‰å®ƒä¾èµ–çš„å±æ€§å€¼å‘ç”Ÿæ”¹å˜æ—¶ä¸‹ä¸€æ¬¡è·å– computed çš„å€¼æ—¶å€™æ‰ä¼šé‡æ–°è®¡ç®— computed çš„å€¼ã€‚é¿å…åœ¨æ¨¡æ¿ä¸­æ”¾å…¥å¤ªå¤šçš„é€»è¾‘ï¼Œå¯¼è‡´æ¨¡æ¿è¿‡é‡ä¸”éš¾ä»¥ç»´æŠ¤ã€‚å½“æœªå‘ç”Ÿæ”¹å˜æ—¶ï¼Œåˆ™ä¼šè¿”å›ä¸Šä¸€æ¬¡çš„æ•°æ®ã€‚ä¸èƒ½å¼‚æ­¥æ“ä½œ watchï¼šæ›´å¤šçš„æ˜¯è§‚å¯Ÿä½œç”¨ï¼Œç±»ä¼¼äºæŸäº›æ•°æ®çš„ç›‘å¬å›è°ƒï¼Œæ¯å½“ç›‘å¬çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶éƒ½ä¼šæ‰§è¡Œå›è°ƒè¿›è¡Œåç»­æ“ä½œã€‚å¯ä»¥è¿›è¡Œå¼‚æ­¥æ“ä½œ methods: æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½éœ€è¦é‡æ–°æ‰§è¡Œã€‚ ç®€å•çš„è¯´ï¼š 1.methods é‡Œé¢å®šä¹‰çš„æ˜¯å‡½æ•°ï¼Œä½ æ˜¾ç„¶éœ€è¦åƒfuc()è¿™æ ·å»è°ƒç”¨å®ƒï¼ˆå‡è®¾å‡½æ•°ä¸º fucï¼‰ã€‚ 2.computed æ˜¯è®¡ç®—å±æ€§ï¼Œäº‹å®ä¸Šå’Œå’Œ data å¯¹è±¡é‡Œçš„æ•°æ®å±æ€§æ˜¯åŒä¸€ç±»çš„ï¼ˆä½¿ç”¨ä¸Šï¼‰ã€‚ 3.watch: ç±»ä¼¼äºç›‘å¬æœºåˆ¶+äº‹ä»¶æœºåˆ¶ã€‚ watch å’Œ computed çš„å¯¹æ¯” é¦–å…ˆå®ƒä»¬éƒ½æ˜¯ä»¥ Vue çš„ä¾èµ–è¿½è¸ªæœºåˆ¶ä¸ºåŸºç¡€çš„ï¼Œå®ƒä»¬çš„å…±åŒç‚¹æ˜¯ï¼šéƒ½æ˜¯å¸Œæœ›åœ¨ä¾èµ–æ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œè¢«ä¾èµ–çš„æ•°æ®æ ¹æ®é¢„å…ˆå®šä¹‰å¥½çš„å‡½æ•°ï¼Œå‘ç”Ÿâ€œè‡ªåŠ¨â€çš„å˜åŒ–ã€‚æˆ‘ä»¬å½“ç„¶å¯ä»¥è‡ªå·±å†™ä»£ç å®Œæˆè¿™ä¸€åˆ‡ï¼Œä½†å´å¾ˆå¯èƒ½é€ æˆå†™æ³•æ··ä¹±ï¼Œä»£ç å†—ä½™çš„æƒ…å†µã€‚ ä½† watch å’Œ computed ä¹Ÿæœ‰æ˜æ˜¾ä¸åŒçš„åœ°æ–¹ï¼š watch å’Œ computed å„è‡ªå¤„ç†çš„æ•°æ®å…³ç³»åœºæ™¯ä¸åŒ 1.watch æ“…é•¿å¤„ç†çš„åœºæ™¯ï¼šä¸€ä¸ªæ•°æ®å½±å“å¤šä¸ªæ•°æ® 2.computed æ“…é•¿å¤„ç†çš„åœºæ™¯ï¼šä¸€ä¸ªæ•°æ®å—å¤šä¸ªæ•°æ®å½±å“ ç›¸æ¯”äº watch/computedï¼Œmethods ä¸å¤„ç†æ•°æ®é€»è¾‘å…³ç³»ï¼Œåªæä¾›å¯è°ƒç”¨çš„å‡½æ•° è¿ç”¨åœºæ™¯ï¼š å½“æˆ‘ä»¬éœ€è¦è¿›è¡Œæ•°å€¼è®¡ç®—ï¼Œå¹¶ä¾èµ–äºå…¶ä»–æ•°æ®æ—¶ï¼Œåº”è¯¥ä½¿ç”¨ computedï¼Œå› ä¸ºå¯ä»¥åˆ©ç”¨ computed çš„ç¼“å­˜ç‰¹æ€§ï¼Œé¿å…æ¯æ¬¡è·å–å€¼æ—¶éƒ½è¦é‡æ–°è®¡ç®—ã€‚ ä½†æˆ‘ä»¬éœ€è¦åœ¨æ•°æ®å˜åŒ–æ—¶æ‰§è¡Œå¼‚æ­¥æˆ–å¼€é”€è¾ƒå¤§çš„æ“ä½œæ—¶åº”è¯¥ä½¿ç”¨ watchï¼Œä½¿ç”¨ watch é€‰é¡¹å…è®¸æˆ‘ä»¬æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œé™åˆ¶æˆ‘ä»¬æ‰§è¡Œè¯¥æ“ä½œçš„é¢‘ç‡ï¼Œå¹¶åœ¨æˆ‘ä»¬å¾—åˆ°æœ€ç»ˆç»“æœå‰ï¼Œè®¾ç½®ä¸­é—´çŠ¶æ€ï¼Œè¿™äº›éƒ½æ˜¯è®¡ç®—å±æ€§æ— æ³•åšåˆ°çš„ã€‚ æ·±å…¥ç†è§£ vue computed åŸç† computed ä¸­çš„å±æ€§åå’Œ data ä¸­çš„å±æ€§åå¯ä»¥ç›¸åŒå—ï¼Ÿä¹Ÿä¸èƒ½å’Œ method ä¸­å±æ€§åŒåä¸èƒ½åŒåï¼Œå› ä¸ºä¸ç®¡æ˜¯ computed å±æ€§åè¿˜æ˜¯ data æ•°æ®åè¿˜æ˜¯ props æ•°æ®åéƒ½ä¼šè¢«æŒ‚è½½åœ¨ vm å®ä¾‹ä¸Šï¼Œå› æ­¤è¿™ä¸‰ä¸ªéƒ½ä¸èƒ½åŒåã€‚ watch çš„å±æ€§ä½¿ç”¨ç®­å¤´å‡½æ•°å®šä¹‰å¯ä»¥å—ï¼Ÿä¸å¯ä»¥ã€‚this ä¼šæ˜¯ undefind, å› ä¸ºç®­å¤´å‡½æ•°ä¸­çš„ this æŒ‡å‘çš„æ˜¯å®šä¹‰æ—¶çš„ thisï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ—¶çš„ thisï¼Œæ‰€ä»¥ä¸ä¼šæŒ‡å‘ Vue å®ä¾‹çš„ä¸Šä¸‹æ–‡ã€‚ watch æ€ä¹ˆæ·±åº¦ç›‘å¬å¯¹è±¡å˜åŒ–ç›‘å¬çš„å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æœ€æ–°çš„å€¼ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¾“å…¥ä¹‹å‰çš„å€¼ï¼› watch: &#123; a: &#123; handler: function(val, oldval) &#123; &#125;, deep: true, // ä¸€å±‚å±‚éå†ç»™å±æ€§éƒ½åŠ ä¸Šç›‘å¬å™¨ immediate: true // ç»„ä»¶åŠ è½½ç«‹å³è§¦å‘å›è°ƒå‡½æ•°æ‰§è¡Œ &#125;, &#x27;obj.a&#x27;: &#123; &#125;&#125; Vue ç”Ÿå‘½å‘¨æœŸvue ç”Ÿå‘½å‘¨æœŸçš„ç†è§£ï¼ˆ10 ä¸ªï¼‰ ç”Ÿå‘½å‘¨æœŸæ˜¯ä»€ä¹ˆ(åˆ›å»ºåˆ°é”€æ¯çš„è¿‡ç¨‹)vue å®ä¾‹æœ‰ä¸€ä¸ªå®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¹Ÿå°±æ˜¯ä»å¼€å§‹åˆ›å»ºï¼Œåˆå§‹åŒ–æ•°æ®ï¼Œç¼–è¯‘æ¨¡æ¿ï¼ŒæŒ‚è½½ dom-&gt;æ¸²æŸ“æ›´æ–°-&gt;æ¸²æŸ“å¸è½½ç­‰ä¸€äº›è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç§°è¿™æ˜¯ vue çš„ç”Ÿå‘½å‘¨æœŸ å„ä¸ªç”Ÿå‘½å‘¨æœŸçš„ä½œç”¨ beforeCreateï¼šç»„ä»¶è¢«åˆ›å»ºä¹‹åˆï¼Œç»„ä»¶çš„å±æ€§ç”Ÿæ•ˆä¹‹å‰ createdï¼šç»„ä»¶å®ä¾‹å·²ç»å®Œå…¨åˆ›å»ºï¼Œå±æ€§ä¹Ÿç»‘å®šï¼Œä½†æ˜¯çœŸå®çš„ dom è¿˜æ²¡æœ‰ç”Ÿæˆï¼Œ$el è¿˜ä¸èƒ½ç”¨(vue å®ä¾‹çš„æ•°æ®å¯¹è±¡dataæœ‰äº†ï¼Œel å’Œæ•°æ®å¯¹è±¡ data éƒ½ä¸º undefinedï¼Œè¿˜æœªåˆå§‹åŒ–ã€‚) beforeMountï¼šåœ¨æŒ‚è½½å¼€å§‹ä¹‹å‰è¢«è°ƒç”¨ï¼Œç›¸å…³çš„ render å‡½æ•°é¦–æ¬¡è¢«è°ƒç”¨ mountedï¼šel è¢«æ–°åˆ›å»ºçš„ vm.$el æ›¿æ¢ï¼Œå¹¶æŒ‚è½½åˆ°å®ä¾‹ä¸Šå»åè°ƒç”¨è¯¥é’©å­ beforeUpdateï¼šç»„ä»¶æ•°æ®æ›´æ–°ä¹‹å‰è°ƒç”¨ï¼Œå‘ç”Ÿåœ¨è™šæ‹Ÿ dom æ‰“è¡¥ä¸ä¹‹å‰ updatedï¼šç»„ä»¶æ•°æ®æ›´æ–°ä¹‹å activatedï¼škeep-alive ä¸“å±ï¼Œç»„ä»¶è¢«æ¿€æ´»æ—¶è°ƒç”¨ deactivatedï¼škeep-alive ä¸“å±ï¼Œç»„ä»¶è¢«é”€æ¯æ—¶è°ƒç”¨ beforeDestroyï¼šç»„ä»¶è¢«é”€æ¯å‰ destroyedï¼šç»„ä»¶è¢«é”€æ¯åè°ƒç”¨ init initLifecycle/Eventï¼Œå¾€ vm ä¸ŠæŒ‚è½½å„ç§å±æ€§ callHook: beforeCreate: å®ä¾‹åˆšåˆ›å»º initInjection/initState: åˆå§‹åŒ–æ³¨å…¥å’Œ data å“åº”æ€§ created: åˆ›å»ºå®Œæˆï¼Œå±æ€§å·²ç»ç»‘å®šï¼Œ ä½†è¿˜æœªç”ŸæˆçœŸå® dom è¿›è¡Œå…ƒç´ çš„æŒ‚è½½ï¼š $el / vm.$mount() æ˜¯å¦æœ‰ template: è§£ææˆ render function *.vue æ–‡ä»¶: vue-loader ä¼šå°†&lt;template&gt;ç¼–è¯‘æˆ render function beforeMount: æ¨¡æ¿ç¼–è¯‘/æŒ‚è½½ä¹‹å‰ æ‰§è¡Œ render functionï¼Œç”ŸæˆçœŸå®çš„ domï¼Œå¹¶æ›¿æ¢åˆ° dom tree ä¸­ mounted: ç»„ä»¶å·²æŒ‚è½½ update: æ‰§è¡Œ diff ç®—æ³•ï¼Œæ¯”å¯¹æ”¹å˜æ˜¯å¦éœ€è¦è§¦å‘ UI æ›´æ–° flushScheduleQueue watcher.before: è§¦å‘ beforeUpdate é’©å­ watcher.run(): æ‰§è¡Œ watcher ä¸­çš„ notifyï¼Œé€šçŸ¥æ‰€æœ‰ä¾èµ–é¡¹æ›´æ–° UI è§¦å‘ updated é’©å­: ç»„ä»¶å·²æ›´æ–° actived / deactivated(keep-alive): ä¸é”€æ¯ï¼Œç¼“å­˜ï¼Œç»„ä»¶æ¿€æ´»ä¸å¤±æ´» destroy: beforeDestroy: é”€æ¯å¼€å§‹ é”€æ¯è‡ªèº«ä¸”é€’å½’é”€æ¯å­ç»„ä»¶ä»¥åŠäº‹ä»¶ç›‘å¬ remove(): åˆ é™¤èŠ‚ç‚¹ watcher.teardown(): æ¸…ç©ºä¾èµ– vm.$off(): è§£ç»‘ç›‘å¬ destroyed: å®Œæˆåè§¦å‘é’©å­ new Vue(&#123;&#125;)// åˆå§‹åŒ–Vueå®ä¾‹function _init() &#123; // æŒ‚è½½å±æ€§ initLifeCycle(vm) // åˆå§‹åŒ–äº‹ä»¶ç³»ç»Ÿï¼Œé’©å­å‡½æ•°ç­‰ initEvent(vm) // ç¼–è¯‘slotã€vnode initRender(vm) // è§¦å‘é’©å­ callHook(vm, &#x27;beforeCreate&#x27;) // æ·»åŠ injectåŠŸèƒ½ initInjection(vm) // å®Œæˆæ•°æ®å“åº”æ€§ props/data/watch/computed/methods initState(vm) // æ·»åŠ  provide åŠŸèƒ½ initProvide(vm) // è§¦å‘é’©å­ callHook(vm, &#x27;created&#x27;) // æŒ‚è½½èŠ‚ç‚¹ if (vm.$options.el) &#123; vm.$mount(vm.$options.el) &#125;&#125;// æŒ‚è½½èŠ‚ç‚¹å®ç°function mountComponent(vm) &#123; // è·å– render function if (!this.options.render) &#123; // template to render // Vue.compile = compileToFunctions let &#123; render &#125; = compileToFunctions() this.options.render = render &#125; // è§¦å‘é’©å­ callHook(&#x27;beforeMount&#x27;) // åˆå§‹åŒ–è§‚å¯Ÿè€… // render æ¸²æŸ“ vdomï¼Œ vdom = vm.render() // update: æ ¹æ® diff å‡ºçš„ patchs æŒ‚è½½æˆçœŸå®çš„ dom vm._update(vdom) // è§¦å‘é’©å­ callHook(vm, &#x27;mounted&#x27;)&#125;// æ›´æ–°èŠ‚ç‚¹å®ç°function queueWatchecr(watcher) &#123; nextTick(flushScheduleQueue)&#125;// æ¸…ç©ºé˜Ÿåˆ—function flushScheduleQueue() &#123; // éå†é˜Ÿåˆ—ä¸­æ‰€æœ‰ä¿®æ”¹ for () &#123; // beforeUpdate watcher.before() // ä¾èµ–å±€éƒ¨æ›´æ–°èŠ‚ç‚¹ watcher.update() callHook(&#x27;updated&#x27;) &#125;&#125;// é”€æ¯å®ä¾‹å®ç°Vue.prototype.$destory = function() &#123; // è§¦å‘é’©å­ callHook(vm, &#x27;beforeDestory&#x27;) // è‡ªèº«åŠå­èŠ‚ç‚¹ remove() // åˆ é™¤ä¾èµ– watcher.teardown() // åˆ é™¤ç›‘å¬ vm.$off() // è§¦å‘é’©å­ callHook(vm, &#x27;destoryed&#x27;)&#125; vue çˆ¶å­ç»„ä»¶ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°çš„æ‰§è¡Œé¡ºåº åŠ è½½æ¸²æŸ“è¿‡ç¨‹çˆ¶ beforeCreate-&gt;çˆ¶ created-&gt;çˆ¶ beforeMount-&gt;å­ beforeCreate-&gt;å­ created-&gt;å­ beforeMount-&gt;å­ mounted-&gt;çˆ¶ mounted å­ç»„ä»¶æ›´æ–°è¿‡ç¨‹çˆ¶ beforeUpdate-&gt;å­ beforeUpdate-&gt;å­ updated-&gt;çˆ¶ updated çˆ¶ç»„ä»¶æ›´æ–°è¿‡ç¨‹çˆ¶ beforeUpdate-&gt;çˆ¶ updated é”€æ¯è¿‡ç¨‹çˆ¶ beforeDestroy-&gt;å­ beforeDestroy-&gt;å­ destroyed-&gt;çˆ¶ destroy åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸå†…è°ƒç”¨å¼‚æ­¥è¯·æ±‚å¯ä»¥åœ¨å‡½æ•° createdï¼ŒbeforeMountï¼Œmounted ä¸­è¿›è¡Œè°ƒç”¨ï¼Œå› ä¸ºåœ¨è¿™ä¸‰ä¸ªé’©å­å‡½æ•°ä¸­ data å·²ç»å¯ä»¥åˆ›å»ºï¼Œå¯ä»¥å°†æœåŠ¡ç«¯è¿”å›çš„æ•°æ®è¿›è¡Œèµ‹å€¼ï¼Œä½†æ˜¯æ¯”è¾ƒæ¨èåœ¨ created é’©å­å‡½æ•°ä¸­è°ƒç”¨å¼‚æ­¥è¯·æ±‚ï¼Œå› ä¸ºï¼š èƒ½æ›´å¿«çš„è·å–åˆ°æœåŠ¡ç«¯æ•°æ®ï¼Œå‡å°‘é¡µé¢ loading æ—¶é—´ ssr ä¸æ”¯æŒ beforeMountï¼Œmounted é’©å­å‡½æ•°ï¼Œæ‰€ä»¥æ”¾åœ¨ created ä¸­æœ‰åŠ©äºä¸€è‡´æ€§ mounted é‡Œèƒ½å¤Ÿæ“ä½œ dom åœ¨ä»€ä¹ˆé˜¶æ®µæ‰èƒ½è®¿é—®æ“ä½œ DOMåœ¨é’©å­å‡½æ•° mounted è¢«è°ƒç”¨ä¹‹å‰ï¼Œvue å·²ç»æŠŠç¼–è¯‘å¥½çš„æ¨¡æ¿æŒ‚è½½åˆ°é¡µé¢ä¸Šï¼Œæ‰€ä»¥åœ¨ mounted ä¸­å¯ä»¥è®¿é—®æ“ä½œ domï¼Œvue å…·ä½“çš„ç”Ÿå‘½å‘¨æœŸã€‚ çˆ¶ç»„ä»¶å¯ä»¥ç›‘å¬åˆ°å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸå— æ‰‹åŠ¨è®¾ç½®$emit æ¥å‘å¸ƒç›‘å¬ // parent&lt;Child @mounted = &quot;fn&quot; / &gt; // child mounted() &#123; this.$emit(&quot;mounted&quot;); &#125; @hook // parent&lt;Child @hook: mounted = &quot;fn&quot; / &gt; fn() &#123; console.log(&#x27;get&#x27;) &#125;// childmounted() &#123; console.log(&#x27;emit&#x27;); åœ¨ created å’Œ mounted è¿™ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸä¸­è¯·æ±‚æ•°æ®æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿåœ¨ created ä¸­ï¼Œé¡µé¢è§†å›¾æœªå‡ºç°ï¼Œå¦‚æœè¯·æ±‚ä¿¡æ¯è¿‡å¤šï¼Œé¡µé¢ä¼šé•¿æ—¶é—´å¤„äºç™½å±çŠ¶æ€ï¼ŒDOM èŠ‚ç‚¹æ²¡å‡ºæ¥ï¼Œæ— æ³•æ“ä½œ DOM èŠ‚ç‚¹ã€‚åœ¨ mounted ä¸ä¼šè¿™æ ·ï¼Œæ¯”è¾ƒå¥½ã€‚ ç»„ä»¶ä»€ä¹ˆæ—¶å€™ä¸‹è¢«é”€æ¯ æ²¡æœ‰ä½¿ç”¨ keep-alive åˆ‡æ¢ v-if=&quot;false&quot; æ‰§è¡Œ vm.$destroy() è°ˆè°ˆä½ å¯¹ keep-alive çš„äº†è§£keep-alive æ˜¯ vue å†…ç½®çš„ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥ä½¿è¢«åŒ…å«çš„ç»„ä»¶ä¿ç•™çŠ¶æ€ï¼Œé¿å…é‡å¤æ¸²æŸ“ï¼Œå…¶æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š ä¸€èˆ¬ç»“åˆè·¯ç”±å’ŒåŠ¨æ€ç»„ä»¶ä½¿ç”¨ï¼Œç”¨äºç¼“å­˜ç»„ä»¶ æä¾› include å’Œ exclude å±æ€§ï¼Œä¸¤è€…éƒ½æ”¯æŒå­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ï¼Œinclude è¡¨ç¤ºåªæœ‰åå­—åŒ¹é…çš„ç»„ä»¶ä¼šè¢«ç¼“å­˜ï¼Œexclude è¡¨ç¤ºä»»ä½•åç§°åŒ¹é…çš„ç»„ä»¶éƒ½ä¸ä¼šè¢«ç¼“å­˜ï¼Œå…¶ä¸­ exclude çš„ä¼˜å…ˆçº§æ¯” include é«˜ å¯¹åº”ä¸¤ä¸ªé’©å­å‡½æ•° actived å’Œ deactivated vue ç»„ä»¶é—´é€šä¿¡æœ‰å“ªå‡ ç§æ–¹å¼ï¼ˆ6 ç§ï¼‰ props å’Œ$emité€‚ç”¨çˆ¶å­ç»„ä»¶é€šä¿¡ ref å’Œ$parent $childrenrefï¼šå¦‚æœåœ¨æ™®é€š dom ä¸Šä½¿ç”¨ï¼Œå¼•ç”¨æŒ‡å‘çš„å°±æ˜¯ dom å…ƒç´ ï¼Œå¦‚æœç”¨åœ¨å­ç»„ä»¶ä¸Šï¼Œå¼•ç”¨å°±æŒ‡å‘ç»„ä»¶å®ä¾‹ $parent/$childrenï¼šè®¿é—®çˆ¶å­å®ä¾‹ EventBusï¼ˆ$emit/$onï¼‰è¿™ç§æ–¹æ³•é€šè¿‡ä¸€ä¸ªç©ºçš„ vue å®ä¾‹ä½œä¸ºä¸­å¤®äº‹ä»¶æ€»çº¿ï¼ˆäº‹ä»¶ä¸­å¿ƒï¼‰ï¼Œç”¨å®ƒæ¥è§¦å‘äº‹ä»¶å’Œç›‘å¬äº‹ä»¶ï¼Œä»è€Œå®ç°ä»»ä½•ç»„ä»¶é—´çš„é€šä¿¡ï¼ŒåŒ…æ‹¬çˆ¶å­ï¼Œéš”ä»£ï¼Œå…„å¼Ÿç»„ä»¶ $attrs/$listeners$attrsï¼šåŒ…å«äº†çˆ¶ä½œç”¨åŸŸé‡Œä¸è¢« prop æ‰€è¯†åˆ«ï¼ˆä¸”è·å–ï¼‰çš„ç‰¹æ€§ç»‘å®šï¼ˆclass å’Œ style é™¤å¤–ï¼‰ã€‚å½“ä¸€ä¸ªç»„ä»¶æ²¡æœ‰å£°æ˜ä»»ä½• prop æ—¶ï¼Œè¿™é‡Œä¼šåŒ…å«æ‰€æœ‰çˆ¶ä½œç”¨åŸŸçš„ç»‘å®šï¼ˆclass å’Œ style é™¤å¤–ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡v-bind=&quot;$attrs&quot;ä¼ å…¥å†…éƒ¨ç»„ä»¶ã€‚é€šå¸¸é…åˆ inheritAttrs é€‰é¡¹ä¸€èµ·ä½¿ç”¨ $listenersï¼šåŒ…å«äº†çˆ¶ä½œç”¨åŸŸä¸­çš„ v-on äº‹ä»¶ç›‘å¬å™¨ï¼Œå®ƒå¯ä»¥é€šè¿‡v-on=&quot;$listeners&quot;ä¼ å…¥å†…éƒ¨ç»„ä»¶ provideã€injectç¥–å…ˆç»„ä»¶é€šè¿‡ provide æ¥æä¾›å˜é‡ï¼Œç„¶ååœ¨å­å­™ç»„ä»¶ä¸­é€šè¿‡ inject æ¥æ³¨å…¥å˜é‡ï¼Œprovide / inject API ä¸»è¦è§£å†³äº†è·¨çº§ç»„ä»¶é—´çš„é€šä¿¡é—®é¢˜ï¼Œä¸è¿‡ä»–çš„ä½¿ç”¨åœºæ™¯ï¼Œä¸»è¦æ˜¯å­ç»„ä»¶è·å–ä¸Šçº§ç»„ä»¶çš„çŠ¶æ€ï¼Œè·¨çº§ç»„ä»¶é—´å»ºç«‹ä¸€ç§ä¸»åŠ¨æä¾›å’Œä¾èµ–æ³¨å…¥çš„å…³ç³» vuexvuex æ˜¯ä¸€ä¸ªä¸“ä¸º vue åº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ï¼Œæ¯ä¸€ä¸ª vuex åº”ç”¨çš„æ ¸å¿ƒå°±æ˜¯ storeï¼Œstore åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä»“åº“ï¼Œå®ƒåŒ…å«ç€ä½ çš„åº”ç”¨ä¸­å¤§éƒ¨åˆ†çš„çŠ¶æ€ vuex çš„çŠ¶æ€å­˜å‚¨æ˜¯å“åº”å¼çš„ï¼Œå½“ vue ä» store ä¸­è¯»å–çŠ¶æ€æ—¶å€™ï¼Œè‹¥ store ä¸­çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç›¸åº”çš„ç»„ä»¶ä¹Ÿä¼šç›¸åº”çš„å¾—åˆ°é«˜æ•ˆæ›´æ–° æ”¹å˜ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€çš„é€”å¾„å°±æ˜¯æ˜¾å¼åœ°æäº¤ mutationï¼Œè¿™æ ·ä½¿æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°è·Ÿè¸ªæ¯ä¸€ä¸ªçŠ¶æ€çš„å˜åŒ– provide/inject æœ‰ä»€ä¹ˆç”¨ï¼Ÿ å¸¸ç”¨çš„çˆ¶å­ç»„ä»¶é€šä¿¡æ–¹å¼éƒ½æ˜¯çˆ¶ç»„ä»¶ç»‘å®šè¦ä¼ é€’ç»™å­ç»„ä»¶çš„æ•°æ®ï¼Œå­ç»„ä»¶é€šè¿‡ props å±æ€§æ¥æ”¶ï¼Œä¸€æ—¦ç»„ä»¶å±‚çº§å˜å¤šæ—¶ï¼Œé‡‡ç”¨è¿™ç§æ–¹å¼ä¸€çº§ä¸€çº§ä¼ é€’å€¼éå¸¸éº»çƒ¦ï¼Œè€Œä¸”ä»£ç å¯è¯»æ€§ä¸é«˜ï¼Œä¸ä¾¿åæœŸç»´æŠ¤ã€‚ vue æä¾›äº† provide å’Œ inject å¸®åŠ©æˆ‘ä»¬è§£å†³å¤šå±‚æ¬¡åµŒå¥—åµŒå¥—é€šä¿¡é—®é¢˜ã€‚åœ¨ provide ä¸­æŒ‡å®šè¦ä¼ é€’ç»™å­å­™ç»„ä»¶çš„æ•°æ®ï¼Œå­å­™ç»„ä»¶é€šè¿‡ inject æ³¨å…¥ç¥–çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„æ•°æ®ã€‚ provide å’Œ inject ä¸»è¦ä¸ºé«˜é˜¶æ’ä»¶/ç»„ä»¶åº“æä¾›ç”¨ä¾‹ã€‚å¹¶ä¸æ¨èç›´æ¥ç”¨äºåº”ç”¨ç¨‹åºä»£ç ä¸­ã€‚ provide() &#123; return &#123; elForm: this &#125;&#125;inject: [&#x27;elForm&#x27;]provide: &#123; name: &#x27;cosyer&#x27;&#125;inject: &#123; newName: &#123; from: &#x27;name&#x27;, default: &#x27;&#x27; &#125;&#125; vuexä½ ä½¿ç”¨è¿‡ vuex å—vuex æ˜¯ä¸€ä¸ªä¸“é—¨ä¸º vue åº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ï¼Œæ¯ä¸€ä¸ª vuex åº”ç”¨çš„æ ¸å¿ƒæ˜¯ storeï¼Œstore åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒåŒ…å«ç€ä½ çš„åº”ç”¨ä¸­å¤§éƒ¨åˆ†çš„çŠ¶æ€ï¼ˆstateï¼‰ ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ¨¡å—ï¼š stateï¼šå®šä¹‰äº†åº”ç”¨çŠ¶æ€çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥åœ¨è¿™é‡Œè®¾ç½®é»˜è®¤çš„åˆå§‹çŠ¶æ€ Gettersï¼šå…è®¸ç»„ä»¶ä» State ä¸­è·å–æ•°æ®ï¼ŒmapGetters è¾…åŠ©å‡½æ•°ä»…ä»…æ˜¯å°† store ä¸­çš„ getter æ˜ å°„åˆ°å±€éƒ¨è®¡ç®—å±æ€§ Mutationsï¼šæ˜¯å”¯ä¸€æ›´æ”¹ store ä¸­çŠ¶æ€çš„æ–¹æ³•ï¼Œä¸”å¿…é¡»æ˜¯åŒæ­¥å‡½æ•° Actionsï¼šç”¨äºæäº¤ mutationï¼Œè€Œä¸æ˜¯ç›´æ¥æ›´æ”¹çŠ¶æ€ï¼Œå¯ä»¥åŒ…å«ä»»æ„çš„å¼‚æ­¥æ“ä½œ Modulesï¼šå…è®¸å°†å•ä¸€çš„ Store æ‹†åˆ†æˆå¤šä¸ª store ä¸”åŒæ—¶ä¿å­˜åœ¨å•ä¸€çš„çŠ¶æ€æ ‘é‡Œ vuex è§£å†³äº†ä»€ä¹ˆé—®é¢˜ å¤šä¸ªç»„ä»¶ä¾èµ–åŒä¸€çŠ¶æ€ï¼Œå¤šå±‚åµŒå¥—ç¹çï¼Œå…„å¼Ÿç»„ä»¶æ²¡åŠæ³•ä¼ å€¼é€šä¿¡ã€‚ ä¸åŒç»„ä»¶çš„è¡Œä¸ºéœ€è¦ä¿®æ”¹åŒä¸€çŠ¶æ€ Vuex ä¸­çŠ¶æ€æ˜¯å¯¹è±¡æ—¶ï¼Œä½¿ç”¨æ—¶è¦æ³¨æ„ä»€ä¹ˆï¼Ÿå› ä¸ºå¯¹è±¡æ˜¯å¼•ç”¨ç±»å‹ï¼Œå¤åˆ¶åæ”¹å˜å±æ€§è¿˜æ˜¯ä¼šå½±å“åŸå§‹æ•°æ®ï¼Œè¿™æ ·ä¼šæ”¹å˜ state é‡Œé¢çš„çŠ¶æ€ï¼Œæ˜¯ä¸å…è®¸ï¼Œæ‰€ä»¥å…ˆç”¨æ·±åº¦å…‹éš†å¤åˆ¶å¯¹è±¡ï¼Œå†ä¿®æ”¹ã€‚ ç»„ä»¶ä¸­æ‰¹é‡ä½¿ç”¨ Vuex çš„ state çŠ¶æ€import &#123; mapState &#125; from &#x27;vuex&#x27;;export default &#123; computed: &#123; ...mapState([&#x27;price&#x27;, &#x27;number&#x27;]), &#125;,&#125;; Vuex ä¸­è¦ä» state æ´¾ç”Ÿä¸€äº›çŠ¶æ€å‡ºæ¥ï¼Œä¸”å¤šä¸ªç»„ä»¶ä½¿ç”¨å®ƒä½¿ç”¨ getter å±æ€§ï¼Œç›¸å½“ Vue ä¸­çš„è®¡ç®—å±æ€§ computedï¼Œåªæœ‰åŸçŠ¶æ€æ”¹å˜æ´¾ç”ŸçŠ¶æ€æ‰ä¼šæ”¹å˜ã€‚ const store = new Vuex.Store(&#123; state: &#123; price: 10, number: 10, discount: 0.7, &#125;, getters: &#123; total: state =&gt; &#123; return state.price * state.number; &#125;, discountTotal: (state, getters) =&gt; &#123; return state.discount * getters.total; &#125;, getTodoById: state =&gt; id =&gt; &#123; return state.todos.find(todo =&gt; todo.id === id); &#125;, &#125;,&#125;); computed: &#123; total() &#123; return this.$store.getters.total &#125;, discountTotal() &#123; return this.$store.getters.discountTotal &#125;, getTodoById() &#123; return this.$store.getters.getTodoById &#125;, ...mapGetters([&#x27;total&#x27;, &#x27;discountTotal&#x27;]), // æ‰¹é‡ä½¿ç”¨getterå±æ€§ ...mapGetters(&#123; myTotal: &#x27;total&#x27;, myDiscountTotal: &#x27;discountTotal&#x27;, &#125;) // å–åˆ«å &#125;, mounted() &#123; console.log(this.getTodoById(2).done) //false &#125; åœ¨ getter ä¸­å¯ä»¥é€šè¿‡ç¬¬ä¸‰ä¸ªå‚æ•° rootState è®¿é—®åˆ°å…¨å±€çš„ state, å¯ä»¥é€šè¿‡ç¬¬å››ä¸ªå‚æ•° rootGetters è®¿é—®åˆ°å…¨å±€çš„ getterã€‚ åœ¨ mutation ä¸­ä¸å¯ä»¥è®¿é—®å…¨å±€çš„ state å’Œ getterï¼Œåªèƒ½è®¿é—®åˆ°å±€éƒ¨çš„ stateã€‚ åœ¨ action ä¸­ç¬¬ä¸€ä¸ªå‚æ•° context ä¸­çš„ context.rootState è®¿é—®åˆ°å…¨å±€çš„ stateï¼Œcontext.rootGetters è®¿é—®åˆ°å…¨å±€çš„ getterã€‚ åœ¨ç»„ä»¶ä¸­å¤šæ¬¡æäº¤åŒä¸€ä¸ª mutation, actionmethods: &#123; ...mapMutations(&#123; setNumber: &#x27;SET_NUMBER&#x27;, &#125;), ...mapActions(&#123; setNumber: &#x27;SET_NUMBER&#x27;, &#125;)&#125; this.setNumber(10)ç›¸å½“è°ƒç”¨ this.$store.commit(&#39;SET_NUMBER&#39;, 10) Vuex ä¸­ action å’Œ mutation æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ action æäº¤çš„æ˜¯ mutationï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ã€‚mutation å¯ä»¥ç›´æ¥å˜æ›´çŠ¶æ€ã€‚ action å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œã€‚mutation åªèƒ½æ˜¯åŒæ­¥æ“ä½œã€‚ æäº¤æ–¹å¼ä¸åŒï¼Œaction æ˜¯ç”¨ this.$store.dispatch(&#39;ACTION_NAME&#39;,data)æ¥æäº¤ã€‚mutationæ˜¯ç”¨this.$store.commit(&#39;SET_NUMBER&#39;,10)æ¥æäº¤ã€‚ æ¥æ”¶å‚æ•°ä¸åŒï¼š &#123; state, // ç­‰åŒäº `store.state`ï¼Œè‹¥åœ¨æ¨¡å—ä¸­åˆ™ä¸ºå±€éƒ¨çŠ¶æ€ rootState, // ç­‰åŒäº `store.state`ï¼Œåªå­˜åœ¨äºæ¨¡å—ä¸­ commit, // ç­‰åŒäº `store.commit` dispatch, // ç­‰åŒäº `store.dispatch` getters, // ç­‰åŒäº `store.getters` rootGetters; // ç­‰åŒäº `store.getters`ï¼Œåªå­˜åœ¨äºæ¨¡å—ä¸­&#125; å¤šä¸ª actionsï¼ŒA ç»“æŸåå†æ‰§è¡Œå…¶ä»–æ“ä½œ actions: &#123; async actionA(&#123; commit &#125;) &#123; //... &#125;, async actionB(&#123; dispatch &#125;) &#123; await dispatch(&#x27;actionA&#x27;) //ç­‰å¾…actionAå®Œæˆ // ... &#125;&#125; å‘½åç©ºé—´export default &#123; namespaced: true, state, getters, mutations, actions,&#125;; æ€ä¹ˆåœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…æäº¤å…¨å±€çš„ mutation å’Œ actionï¼Ÿ this.$store.dispatch(&#x27;actionA&#x27;, null, &#123; root: true,&#125;);this.$store.commit(&#x27;mutationA&#x27;, null, &#123; root: true,&#125;); åœ¨ Vuex æ’ä»¶ä¸­æ€ä¹ˆç›‘å¬ç»„ä»¶ä¸­æäº¤ mutation å’Œ actionï¼Ÿexport default function createPlugin(param) &#123; return store =&gt; &#123; store.subscribe((mutation, state) =&gt; &#123; console.log(mutation.type); //æ˜¯é‚£ä¸ªmutation console.log(mutation.payload); console.log(state); &#125;); // store.subscribeAction((action, state) =&gt; &#123; // console.log(action.type)//æ˜¯é‚£ä¸ªaction // console.log(action.payload)//æäº¤actionçš„å‚æ•° // &#125;) store.subscribeAction(&#123; before: (action, state) =&gt; &#123; //æäº¤actionä¹‹å‰ console.log(`before action $&#123;action.type&#125;`); &#125;, after: (action, state) =&gt; &#123; //æäº¤actionä¹‹å console.log(`after action $&#123;action.type&#125;`); &#125;, &#125;); &#125;;&#125; åœ¨ v-model ä¸Šæ€ä¹ˆç”¨ Vuex ä¸­ state çš„å€¼ï¼Ÿ&lt; input v - model = &quot;message&quot; &gt; // ... computed: &#123; message: &#123; get() &#123; return this.$store.state.message &#125;, set(value) &#123; this.$store.commit(&#x27;updateMessage&#x27;, value) &#125; &#125; &#125; Vuex é¡µé¢åˆ·æ–°æ•°æ®ä¸¢å¤±æ€ä¹ˆè§£å†³ï¼Ÿä½¿ç”¨ vuex-persist æ’ä»¶ï¼Œå®ƒå°±æ˜¯ä¸º Vuex æŒä¹…åŒ–å­˜å‚¨è€Œç”Ÿçš„ä¸€ä¸ªæ’ä»¶ã€‚ä¸éœ€è¦ä½ æ‰‹åŠ¨å­˜å– storage ï¼Œè€Œæ˜¯ç›´æ¥å°†çŠ¶æ€ä¿å­˜è‡³ cookie æˆ–è€… localStorage ä¸­ vue routervue router å…¨å±€å¯¼èˆªå®ˆå«ä¸‰ä¸ªå‚æ•° route toï¼šå³å°†è¦è¿›å…¥çš„ç›®æ ‡ è·¯ç”±å¯¹è±¡ã€‚ fromï¼šå½“å‰å¯¼èˆªæ­£è¦ç¦»å¼€çš„è·¯ç”±å¯¹è±¡ã€‚ nextï¼šå‡½æ•°ï¼Œå¿…é¡»è°ƒç”¨ï¼Œä¸ç„¶è·¯ç”±è·³è½¬ä¸è¿‡å»ã€‚ next()ï¼šè¿›å…¥ä¸‹ä¸€ä¸ªè·¯ç”±ã€‚next(false)ï¼šä¸­æ–­å½“å‰çš„å¯¼èˆªã€‚next(&#39;/&#39;)æˆ– next(&#123; path: &#39;/&#39; &#125;) : è·³è½¬åˆ°å…¶ä»–è·¯ç”±ï¼Œå½“å‰å¯¼èˆªè¢«ä¸­æ–­ï¼Œè¿›è¡Œæ–°çš„ä¸€ä¸ªå¯¼èˆªã€‚ router.beforeEachï¼šå…¨å±€å‰ç½®å®ˆå«ã€‚ router.beforeResolveï¼šå…¨å±€è§£æå®ˆå«ã€‚ router.afterEachï¼šå…¨å±€åç½®é’©å­ã€‚ è·¯ç”±ç‹¬äº«å®ˆå«const router = new VueRouter(&#123; routes: [ &#123; path: &#x27;/foo&#x27;, component: Foo, beforeEnter: (to, from, next) =&gt; &#123; // ... &#125;, &#125;, ],&#125;); ç»„ä»¶å†…å¯¼èˆªå®ˆå« beforeRouteLeaveï¼šåœ¨å¤±æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ç¦»å¼€å®ˆå«ã€‚ beforeRouteUpdateï¼šåœ¨é‡ç”¨çš„ç»„ä»¶é‡Œè°ƒç”¨, æ¯”å¦‚åŒ…å«&lt;router-view /&gt;çš„ç»„ä»¶ã€‚ beforeRouteEnterï¼šåœ¨è¿›å…¥å¯¹åº”è·¯ç”±çš„ç»„ä»¶åˆ›å»ºå‰è°ƒç”¨ã€‚ router-link&lt;router-link&gt; æ˜¯ Vue-Router çš„å†…ç½®ç»„ä»¶ï¼Œåœ¨å…·æœ‰è·¯ç”±åŠŸèƒ½çš„åº”ç”¨ä¸­ä½œä¸ºå£°æ˜å¼çš„å¯¼èˆªä½¿ç”¨ã€‚ç±»ä¼¼ react çš„ Link æ ‡ç­¾ &lt;router-link to=&quot;home&quot;&gt;Home&lt;/router-link&gt;&lt;router-link :to=&quot;&#x27;home&#x27;&quot;&gt;Home&lt;/router-link&gt;&lt;router-link :to=&quot;&#123; path: &#x27;home&#x27; &#125;&quot;&gt;Home&lt;/router-link&gt;&lt;router-link :to=&quot;&#123; name: &#x27;user&#x27;, params: &#123; userId: 123 &#125;&#125;&quot;&gt;User&lt;/router-link&gt;&lt;router-link :to=&quot;&#123; path: &#x27;user&#x27;, query: &#123; userId: 123 &#125;&#125;&quot;&gt;User&lt;/router-link&gt; æ³¨å†Œåœ¨ router-link ä¸Šäº‹ä»¶æ— æ•ˆè§£å†³æ–¹æ³•:ä½¿ç”¨@click.nativeã€‚åŸå› ï¼šrouter-link ä¼šé˜»æ­¢ click äº‹ä»¶ï¼Œ.native æŒ‡ç›´æ¥ç›‘å¬ä¸€ä¸ªåŸç”Ÿäº‹ä»¶ åœ¨ ie å’Œ firefox æ— æ•ˆï¼š ä½¿ç”¨ a æ ‡ç­¾ä¸ç”¨ Button ä½¿ç”¨ Button å’Œ Router.navigate æ–¹æ³• vue-router mode hash history è·³è½¬ this.$router.push() &lt;router-link to=&quot;&quot;&gt;&lt;/router-link&gt; å ä½ &lt;router-view&gt;&lt;/router-view&gt; hashæ¨¡å¼ï¼šé€šè¿‡å¯¹#å·çš„ä¿®æ”¹è§¦å‘ hashchange äº‹ä»¶ï¼Œå®ç°è·¯ç”±åˆ‡æ¢ history æ¨¡å¼ï¼šé€šè¿‡ pushState å’Œ replaceState åˆ‡æ¢ urlï¼Œè§¦å‘ popState äº‹ä»¶ï¼Œå®ç°è·¯ç”±åˆ‡æ¢ï¼Œéœ€è¦åç«¯é…åˆ Vue router è·³è½¬å’Œ location.href æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿrouter æ˜¯ hash æ”¹å˜location.href æ˜¯é¡µé¢è·³è½¬ï¼Œåˆ·æ–°é¡µé¢ Vue router é™¤äº† router-link æ€ä¹ˆå®ç°è·³è½¬?router.go(1);router.push(&#x27;/&#x27;); params å’Œ query çš„åŒºåˆ«query éœ€è¦ path å¼•å…¥ï¼Œparams éœ€è¦ name å¼•å…¥this.$route.query.nameã€this.$route.params.query æ³¨æ„ç‚¹ï¼šquery åˆ·æ–°ä¸ä¼šä¸¢å¤± query æ•°æ®ï¼Œparams åˆ·æ–°ä¼šä¸¢å¤±æ•°æ® ç»„ä»¶å†…ç›‘å¬è·¯ç”±çš„å˜åŒ–åªèƒ½ç”¨åœ¨åŒ…å«&lt;router-view /&gt;çš„ç»„ä»¶å†… 1. watch: &#123; &#x27;$route&#x27;(to, from) &#123; //è¿™é‡Œç›‘å¬ &#125;,&#125; 2. beforeRouteUpdate(to, from, next) &#123; //è¿™é‡Œç›‘å¬&#125;, åˆ‡æ¢æ–°è·¯ç”±çš„æ»šåŠ¨æ¡å¤„ç†const router = new Router(&#123; mode: &#x27;history&#x27;, base: process.env.BASE_URL, routes, scrollBehavior(to, from, savedPosition) &#123; if (savedPosition) &#123; return savedPosition; &#125; else &#123; return &#123; x: 0, y: 0, &#125;; &#125; &#125;,&#125;); è·¯ç”±ä¼ å‚è·å–æ–¹å¼ metaï¼šè·¯ç”±å…ƒä¿¡æ¯ï¼Œå†™åœ¨ routes é…ç½®æ–‡ä»¶ä¸­ã€‚ &#123; path: &#x27;/home&#x27;, name: &#x27;home&#x27;, component: load(&#x27;home&#x27;), meta: &#123; title: &#x27;é¦–é¡µ&#x27; &#125;,&#125;, this.$route.meta.title query this.$router.push(&#123; path: &#x27;/home&#x27;, query: &#123; userId: 123, &#125;,&#125;); this.$route.query.userId params &#123; path: &#x27;/home/:userId&#x27;, name: &#x27;home&#x27;, component: load(&#x27;home&#x27;),&#125;,// æ³¨æ„ç”¨paramsä¼ å‚ï¼Œåªèƒ½ç”¨å‘½åçš„è·¯ç”±ï¼ˆç”¨nameè®¿é—®ï¼‰const userId = &#x27;123&#x27;this.$router.push(&#123; name: &#x27;home&#x27;, params: &#123; userId &#125;&#125;)// this.$route.params å®ç°åŠ¨æ€åŠ è½½è·¯ç”±(è·¯ç”±æ‡’åŠ è½½) ä½¿ç”¨ Router çš„å®ä¾‹æ–¹æ³• addRoutes æ¥å®ç°åŠ¨æ€åŠ è½½è·¯ç”±ï¼Œä¸€èˆ¬ç”¨æ¥å®ç°èœå•æƒé™ã€‚ ä½¿ç”¨æ—¶è¦æ³¨æ„ï¼Œé™æ€è·¯ç”±æ–‡ä»¶ä¸­ä¸èƒ½æœ‰ 404 è·¯ç”±ï¼Œè€Œè¦é€šè¿‡ addRoutes ä¸€èµ·åŠ¨æ€æ·»åŠ è¿›å»ã€‚ webpack &lt; 2.4 æ—¶ &#123; path: &#x27;/&#x27;, name: &#x27;home&#x27;, components: resolve =&gt; require([&#x27;@/components/home&#x27;], resolve)&#125;webpack &gt; 2.4 æ—¶ &#123; path: &#x27;/&#x27;, name: &#x27;home&#x27;, components: () =&gt; import(&#x27;@/components/home&#x27;)&#125; éæ‡’åŠ è½½è·¯ç”±é…ç½® import Vue from &#x27;vue&#x27;;import Router from &#x27;vue-router&#x27;;import Hello from &#x27;@/components/Hello&#x27;;Vue.use(Router);export default new Router(&#123; routes: [ &#123; path: &#x27;/&#x27;, name: &#x27;Hello&#x27;, component: Hello, &#125;, ],&#125;); è·¯ç”±ä¹‹é—´è·³è½¬ å£°æ˜å¼é€šè¿‡ä½¿ç”¨å†…ç½®ç»„ä»¶æ¥è·³è½¬ or router-link :to=â€{name:â€™indexâ€™}â€&gt; ç¼–ç¨‹å¼ this.$router.push(&#123; path: &#x27;home&#x27;&#125;)this.$router.replace(&#123; path: &#x27;/home&#x27;&#125;)this.$router.push(&#123; name: &#x27;ç»„ä»¶å&#x27;)&#125;; $routerå’Œ$route çš„åŒºåˆ«$routeä¸ºå½“å‰routerè·³è½¬å¯¹è±¡ï¼Œé‡Œé¢å¯ä»¥è·å–nameã€pathã€queryã€paramsç­‰$router ä¸º VueRouter å®ä¾‹ï¼Œæƒ³è¦å¯¼èˆªåˆ°ä¸åŒ URLï¼Œåˆ™ä½¿ç”¨ router.push æ–¹æ³•ï¼Œè¿”å›ä¸Šä¸€ä¸ªå†å²$router.to(-1) æ‰“å¼€æ–°çª—å£const obj = &#123; path: xxx, //è·¯ç”±åœ°å€ query: &#123; mid: data.id, //å¯ä»¥å¸¦å‚æ•° &#125;,&#125;;const &#123; href &#125; = this.$router.resolve(obj);window.open(href, &#x27;_blank&#x27;); è¿‡æ»¤å™¨(filter)&lt;div&gt;&lt;span&gt; &#123;&#123; money | moneyFilter(0.15) &#125;&#125; &lt;/span&gt;ç¾å…ƒ&lt;/div&gt;&lt;div&gt;&lt;span&gt; &#123;&#123; money | moneyFilter(0.12) &#125;&#125; &lt;/span&gt;è‹±é•‘&lt;/div&gt; filters: &#123; moneyFilter: function(val, ratio) &#123; return Number(val * ratio).toFixed(2); &#125; &#125; é™¤äº†ç”¨åœ¨æ’å€¼ä¸Šè¿˜å¯ä»¥ç”¨åœ¨ v-bind è¡¨è¾¾å¼ä¸Šã€‚ å¼ºåˆ¶åˆ·æ–°ç»„ä»¶ this.$forceUpdate()ã€‚ ç»„ä»¶ä¸ŠåŠ ä¸Š keyï¼Œç„¶åå˜åŒ– key çš„å€¼ã€‚ è®¿é—®å­ç»„ä»¶å®ä¾‹æˆ–è€…å­å…ƒç´  refå…ˆç”¨ ref ç‰¹æ€§ä¸ºå­ç»„ä»¶èµ‹äºˆä¸€ä¸ª ID å¼•ç”¨&lt;/ æ¯”å¦‚å­ç»„ä»¶æœ‰ä¸ª focus çš„æ–¹æ³•ï¼Œå¯ä»¥è¿™æ ·è°ƒç”¨ this.$refs.myInput.focus()ï¼›æ¯”å¦‚å­ç»„ä»¶æœ‰ä¸ªvalueçš„æ•°æ®ï¼Œå¯ä»¥è¿™æ ·ä½¿ç”¨this.$refs.myInput.valueã€‚ å­ç»„ä»¶è®¿é—®çˆ¶ç»„ä»¶this.$parent $event.targetå’Œ$event.currentTarget æœ‰ä»€ä¹ˆåŒºåˆ«$event.currentTargetå§‹ç»ˆæŒ‡å‘äº‹ä»¶æ‰€ç»‘å®šçš„å…ƒç´ ï¼Œè€Œ$event.target æŒ‡å‘äº‹ä»¶å‘ç”Ÿæ—¶çš„å…ƒç´ ã€‚ äº‹ä»¶ä¿®é¥°ç¬¦å’Œè¡¨å•ä¿®é¥°ç¬¦ äº‹ä»¶ä¿®é¥°ç¬¦ .stopï¼šé˜»æ­¢äº‹ä»¶ä¼ é€’ï¼› .preventï¼š é˜»æ­¢é»˜è®¤äº‹ä»¶ï¼› .capture ï¼šåœ¨æ•è·çš„è¿‡ç¨‹ç›‘å¬ï¼Œæ²¡æœ‰ capture ä¿®é¥°ç¬¦æ—¶éƒ½æ˜¯é»˜è®¤å†’æ³¡è¿‡ç¨‹ç›‘å¬ï¼› .selfï¼šå½“å‰ç»‘å®šäº‹ä»¶çš„å…ƒç´ æ‰èƒ½è§¦å‘ï¼› .onceï¼šäº‹ä»¶åªä¼šè§¦å‘ä¸€æ¬¡ï¼› .passiveï¼šé»˜è®¤äº‹ä»¶ä¼šç«‹å³è§¦å‘ï¼Œä¸è¦æŠŠ.passive å’Œ.prevent ä¸€èµ·ä½¿ç”¨ï¼Œå› ä¸º.prevent å°†ä¸èµ·ä½œç”¨ã€‚ .native åŠ åœ¨è‡ªå®šä¹‰ç»„ä»¶ä¸Šï¼Œä¿è¯äº‹ä»¶èƒ½æ‰§è¡Œ .leftã€.rightã€.middleè¿™ä¸‰ä¸ªä¿®é¥°ç¬¦æ˜¯é¼ æ ‡çš„å·¦ä¸­å³é”®è§¦å‘çš„äº‹ä»¶ .camel ç¡®ä¿ç»‘å®šå‚æ•°è¢«è¯†åˆ«ä¸ºé©¼å³°å†™æ³• .syncçˆ¶å­ç»„ä»¶ä¼ å€¼ï¼Œå­ç»„ä»¶æƒ³æ›´æ–°è¿™ä¸ªå€¼ï¼Œä½¿ç”¨æ­¤ä¿®é¥°ç¬¦å¯ç®€å†™ è¡¨å•ä¿®é¥°ç¬¦.number .lazy .trim &lt;comp :foo.sync=&quot;bar&quot;&gt;&lt;/comp&gt; ç›¸å½“äº &lt;comp :foo=&quot;bar&quot; @update:foo=&quot;val =&gt; bar = val&quot;&gt;&lt;/comp&gt;// this.$emit(&#x27;update:foo&#x27;, newValue) è¦æ³¨æ„é¡ºåºå¾ˆé‡è¦ï¼Œç”¨@click.prevent.self ä¼šé˜»æ­¢æ‰€æœ‰çš„ç‚¹å‡»ï¼Œè€Œ@click.self.prevent åªä¼šé˜»æ­¢å¯¹å…ƒç´ è‡ªèº«çš„ç‚¹å‡»ã€‚ è¯´è¯´ä½ å¯¹ Vue çš„è¡¨å•ä¿®é¥°ç¬¦.lazy çš„ç†è§£ã€‚input æ ‡ç­¾ v-model ç”¨ lazy ä¿®é¥°ä¹‹åï¼Œå¹¶ä¸ä¼šç«‹å³ç›‘å¬ input çš„ value çš„æ”¹å˜ï¼Œä¼šåœ¨ input å¤±å»ç„¦ç‚¹ä¹‹åï¼Œæ‰ä¼šç›‘å¬ input çš„ value çš„æ”¹å˜ã€‚ ç›‘å¬é”®ç›˜äº‹ä»¶ä½¿ç”¨æŒ‰é”®ä¿®é¥°ç¬¦ &lt;input @keyup.enter=â€submitâ€&gt;æŒ‰ä¸‹å›è½¦é”®æ—¶å€™è§¦å‘ submit äº‹ä»¶ã€‚ .enter .tab .delete (æ•è·â€œåˆ é™¤â€å’Œâ€œé€€æ ¼â€é”®) .esc .space .up .down .left .right css æ ·å¼å½“å‰ç»„ä»¶æœ‰æ•ˆ&lt;style lang=&quot;less&quot; scoped&gt;&lt;/style&gt; åŸç†ï¼švue é€šè¿‡åœ¨ DOM ç»“æ„ä»¥åŠ css æ ·å¼ä¸ŠåŠ ä¸Šå”¯ä¸€çš„æ ‡è®° data-v-xxxxxx ï¼Œä¿è¯åŠ¨æ€å±æ€§å”¯ä¸€ï¼Œè¾¾åˆ°æ ·å¼ç§æœ‰åŒ–ï¼Œä¸æ±¡æŸ“å…¨å±€çš„ä½œç”¨ã€‚ ç¼–è¯‘åï¼š &lt;template&gt; &lt;span data-v-3e5b2a80 class=&quot;textScoped&quot;&gt;scopedæµ‹è¯•&lt;/span&gt;&lt;/template&gt;&lt;script&gt;&lt;/script&gt;&lt;style scoped&gt; .textScoped[data-v-3e5b2a80] &#123; color: red; &#125;&lt;/style&gt; å¦‚ä½•è§£å†³æ ·å¼éš”ç¦» æ·±åº¦é€‰æ‹©å™¨ &gt;&gt;&gt; /deep/ ::v-deep æœ‰äº›åƒ Sass ä¹‹ç±»çš„é¢„å¤„ç†å™¨æ— æ³•æ­£ç¡®è§£æ &gt;&gt;&gt;ã€‚è¿™ç§æƒ…å†µä¸‹ä½ å¯ä»¥ä½¿ç”¨ /deep/ æˆ– ::v-deep æ“ä½œç¬¦å–è€Œä»£ä¹‹â€”â€”ä¸¤è€…éƒ½æ˜¯ &gt;&gt;&gt; çš„åˆ«åï¼ŒåŒæ ·å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ éœ€è¦æ³¨æ„å³ä½¿æŠŠæ·±åº¦é€‰æ‹©å™¨åŠ åœ¨æœ€å‰é¢ï¼Œå¯¹äºè®¾ç½®äº†scopedçš„styleæ ‡ç­¾ï¼Œä»ç„¶æ— æ³•å½±å“å¤–éƒ¨ç»„ä»¶çš„æ ·å¼ï¼Œè¿™ä¸€ç‚¹å’Œangularæœ‰åŒºåˆ« æ–°å¢ä¸€ä¸ªstyleæ ‡ç­¾ &lt;template&gt; &lt;span data-v-3e5b2a80 class=&quot;textScoped&quot;&gt;scopedæµ‹è¯•&lt;/span&gt;&lt;/template&gt;&lt;script&gt;&lt;/script&gt;&lt;style scoped&gt; .textScoped[data-v-3e5b2a80] &#123; color: red; &#125;&lt;/style&gt;&lt;!-- æ–°å¢styleæ ‡ç­¾ï¼Œä¸åŠ scopedï¼Œå°±ä¸ä¼šå‘ç”Ÿæ ·å¼éš”ç¦» --&gt;&lt;style&gt; .textScoped &#123; color: red; &#125;&lt;/style&gt; æ¸²æŸ“æ¨¡æ¿ä¿ç•™æ³¨é‡Š åœ¨ç»„ä»¶ä¸­å°† comments é€‰é¡¹è®¾ç½®ä¸º true &lt;template comments&gt; ... &lt;template&gt; Vue ç»„ä»¶é‡Œçš„å®šæ—¶å™¨è¦æ€ä¹ˆé”€æ¯ï¼Ÿ å¦‚æœé¡µé¢ä¸Šæœ‰å¾ˆå¤šå®šæ—¶å™¨ï¼Œå¯ä»¥åœ¨ data é€‰é¡¹ä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡ timerï¼Œç»™æ¯ä¸ªå®šæ—¶å™¨å–ä¸ªåå­—ä¸€ä¸€æ˜ å°„åœ¨å¯¹è±¡ timer ä¸­ï¼Œåœ¨ beforeDestroy æ„é€ å‡½æ•°ä¸­ for(let k in this.timer){clearInterval(k)}ï¼› å¦‚æœé¡µé¢åªæœ‰å•ä¸ªå®šæ—¶å™¨ï¼Œå¯ä»¥è¿™ä¹ˆåšã€‚ const timer = setInterval(() =&gt; &#123;&#125;, 500);this.$once(&#x27;hook:beforeDestroy&#x27;, () =&gt; &#123; clearInterval(timer);&#125;); å®šä¹‰å…¨å±€æ–¹æ³• æŒ‚è½½åœ¨ Vue çš„ prototype ä¸Š åˆ©ç”¨å…¨å±€æ··å…¥ mixin this.$root.$on(&#x27;demo&#x27;, function() &#123; console.log(&#x27;test&#x27;);&#125;)this.$root.$emit(&#x27;demo&#x27;)ï¼›this.$root.$off(&#x27;demo&#x27;)ï¼›// Mustacheçš„webæ¨¡æ¿å¼•æ“ æ•è·ç»„ä»¶çš„é”™è¯¯ä¿¡æ¯ errorCaptured æ˜¯ç»„ä»¶å†…éƒ¨é’©å­ï¼Œå½“æ•è·ä¸€ä¸ªæ¥è‡ªå­å­™ç»„ä»¶çš„é”™è¯¯æ—¶è¢«è°ƒç”¨ï¼Œæ¥æ”¶ errorã€vmã€info ä¸‰ä¸ªå‚æ•°ï¼Œreturn false åå¯ä»¥é˜»æ­¢é”™è¯¯ç»§ç»­å‘ä¸ŠæŠ›å‡ºã€‚ errorHandler ä¸ºå…¨å±€é’©å­ï¼Œä½¿ç”¨ Vue.config.errorHandler é…ç½®ï¼Œæ¥æ”¶å‚æ•°ä¸ errorCaptured ä¸€è‡´ï¼Œ2.6 åå¯æ•æ‰v-onä¸ promise é“¾çš„é”™è¯¯ï¼Œå¯ç”¨äºç»Ÿä¸€é”™è¯¯å¤„ç†ä¸é”™è¯¯å…œåº•ã€‚ vue SSRvue æ˜¯æ„å»ºå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºçš„æ¡†æ¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¾“å‡º vue ç»„ä»¶ï¼Œè¿›è¡Œç”Ÿæˆ dom å’Œæ“ä½œ domï¼Œç„¶è€Œï¼Œä¹Ÿå¯ä»¥å°†åŒä¸€ä¸ªç»„ä»¶æ¸²æŸ“ä¸ºæœåŠ¡ç«¯çš„ html å­—ç¬¦ä¸²ï¼Œå°†ä»–ä»¬ç›´æ¥å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œç„¶åå°†è¿™äº›é™æ€æ ‡è®°æ¿€æ´»ä¸ºå®¢æˆ·ç«¯ä¸Šå¯ä»¥äº¤äº’çš„åº”ç”¨ç¨‹åºã€‚ å³ ssr çš„æ„æ€å°±æ˜¯ vue åœ¨æœåŠ¡ç«¯å®Œæˆå°†æ ‡ç­¾æ¸²æŸ“æˆæ•´ä¸ª html ç‰‡æ®µçš„å·¥ä½œï¼Œç„¶åå°†ç‰‡æ®µç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ä½¿ç”¨ ssr ä¼˜ç‚¹ï¼š æ›´å¥½çš„ seoï¼šå› ä¸º spa é¡µé¢çš„å†…å®¹æ˜¯é€šè¿‡ ajax è·å–ï¼Œè€Œæœç´¢å¼•æ“çˆ¬å–å·¥å…·å¹¶ä¸ä¼šç­‰å¾… ajax ä¸€æ­¥å®Œæˆåå†æŠ“å–é¡µé¢å†…å®¹ï¼Œæ‰€ä»¥åœ¨ spa ä¸­æ˜¯æŠ“å–ä¸åˆ°é¡µé¢é€šè¿‡ ajax è·å–åˆ°çš„å†…å®¹ï¼›è€Œ ssr æ˜¯ç›´æ¥ç”±æœåŠ¡å™¨è¿”å›å·²ç»æ¸²æŸ“å¥½çš„é¡µé¢ï¼ˆæ•°æ®å·²ç»åŒ…å«åœ¨é¡µé¢ä¸­ï¼‰ï¼Œæ‰€ä»¥æœç´¢å¼•æ“çˆ¬å–å·¥å…·å¯ä»¥æŠ“å–åˆ°æ¸²æŸ“å¥½çš„é¡µé¢ æ›´å¿«çš„å†…å®¹åˆ°è¾¾æ—¶é—´ï¼ˆé¦–å±åŠ è½½å¿«ï¼‰ï¼šspa ä¼šç­‰å¾…æ‰€æœ‰ vue ç¼–è¯‘åçš„ js æ–‡ä»¶éƒ½ä¸‹è½½å®Œæˆåï¼Œæ‰å¼€å§‹è¿›è¡Œä¹Ÿå…å¾—æ¸²æŸ“ï¼Œæ–‡ä»¶ä¸‹è½½éœ€è¦ä¸€å®šçš„æ—¶é—´ç­‰ï¼Œæ‰€ä»¥é¦–å±åŠ è½½éœ€è¦æ—¶é—´ï¼Œè€Œ ssr ç›´æ¥ç”±æœåŠ¡å™¨æ¸²æŸ“å¥½é¡µé¢è¿”å›æ˜¾ç¤ºï¼Œæ— éœ€ç­‰å¾… js æ–‡ä»¶å†å»æ¸²æŸ“ï¼Œæ‰€ä»¥ ssr æœ‰æ›´å¿«çš„å†…å®¹åˆ°è¾¾æ—¶é—´ ssr ç¼ºç‚¹ï¼š æ›´å¤šçš„å¼€å‘æ¡ä»¶é™åˆ¶ï¼šä¾‹å¦‚æœåŠ¡ç«¯æ¸²æŸ“åªæ”¯æŒ beforeCreate å’Œ created ä¸¤ä¸ªé’©å­å‡½æ•°ï¼Œè¿™ä¼šå¯¼è‡´ä¸€äº›å¤–éƒ¨æ‰©å±•åº“éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œæ‰èƒ½åœ¨æœåŠ¡ç«¯æ¸²æŸ“ç¨‹åºä¸­è¿è¡Œï¼›å¹¶ä¸”ä¸å¯ä»¥éƒ¨ç½²åœ¨ä»»ä½•é™æ€æ–‡ä»¶æœåŠ¡å™¨ä¸Šçš„å®Œå…¨é™æ€å•é¡µé¢åº”ç”¨ç¨‹åº spa ä¸åŒï¼ŒæœåŠ¡ç«¯æ¸²æŸ“åº”ç”¨ç¨‹åºï¼Œéœ€è¦å¤„äº nodejs server ä¸­æ‰èƒ½è¿è¡Œ æ›´å¤šçš„æœåŠ¡å™¨è´Ÿè½½ nextTickåœ¨ä¸‹æ¬¡ dom æ›´æ–°å¾ªç¯ç»“æŸä¹‹åæ‰§è¡Œå»¶è¿Ÿå›è°ƒï¼Œå¯ç”¨äºè·å–æ›´æ–°åçš„ dom çŠ¶æ€ã€‚ æ–°ç‰ˆæœ¬ä¸­é»˜è®¤æ˜¯ microtasks, v-on ä¸­ä¼šä½¿ç”¨ macrotasks // ä¿®æ”¹æ•°æ®vm.msg = &#x27;Hello&#x27;// DOM è¿˜æ²¡æœ‰æ›´æ–°Vue.nextTick(function() &#123; // DOM æ›´æ–°äº† ... //DOMæ“ä½œ&#125;)// ä½œä¸ºä¸€ä¸ª Promise ä½¿ç”¨Vue.nextTick() .then(function() &#123; // DOM æ›´æ–°äº† &#125;) Vue åœ¨æ›´æ–° DOM æ—¶æ˜¯å¼‚æ­¥æ‰§è¡Œçš„ã€‚åªè¦ä¾¦å¬åˆ°æ•°æ®å˜åŒ–ï¼ŒVue å°†å¼€å¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶ç¼“å†²åœ¨åŒä¸€äº‹ä»¶å¾ªç¯ä¸­å‘ç”Ÿçš„æ‰€æœ‰æ•°æ®å˜æ›´ã€‚å¦‚æœåŒä¸€ä¸ª watcher è¢«å¤šæ¬¡è§¦å‘ï¼Œåªä¼šè¢«æ¨å…¥åˆ°é˜Ÿåˆ—ä¸­ä¸€æ¬¡ã€‚è¿™ç§åœ¨ç¼“å†²æ—¶å»é™¤é‡å¤æ•°æ®å¯¹äºé¿å…ä¸å¿…è¦çš„è®¡ç®—å’Œ DOM æ“ä½œæ˜¯éå¸¸é‡è¦çš„ã€‚ç„¶åï¼Œåœ¨ä¸‹ä¸€ä¸ªçš„äº‹ä»¶å¾ªç¯tickä¸­ï¼ŒVue åˆ·æ–°é˜Ÿåˆ—å¹¶æ‰§è¡Œå®é™… (å·²å»é‡çš„) å·¥ä½œã€‚Vue åœ¨å†…éƒ¨å¯¹å¼‚æ­¥é˜Ÿåˆ—å°è¯•ä½¿ç”¨åŸç”Ÿçš„ Promise.thenã€MutationObserver å’Œ setImmediateï¼Œå¦‚æœæ‰§è¡Œç¯å¢ƒä¸æ”¯æŒï¼Œåˆ™ä¼šé‡‡ç”¨ setTimeout(fn, 0) ä»£æ›¿ã€‚ ä¾‹å¦‚ï¼Œå½“ä½ è®¾ç½® vm.someData = &#39;new value&#39;ï¼Œè¯¥ç»„ä»¶ä¸ä¼šç«‹å³é‡æ–°æ¸²æŸ“ã€‚å½“åˆ·æ–°é˜Ÿåˆ—æ—¶ï¼Œç»„ä»¶ä¼šåœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯tickä¸­æ›´æ–°ã€‚å¤šæ•°æƒ…å†µæˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒè¿™ä¸ªè¿‡ç¨‹ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³åŸºäºæ›´æ–°åçš„ DOM çŠ¶æ€æ¥åšç‚¹ä»€ä¹ˆï¼Œè¿™å°±å¯èƒ½ä¼šæœ‰äº›æ£˜æ‰‹ã€‚è™½ç„¶ Vue.js é€šå¸¸é¼“åŠ±å¼€å‘äººå‘˜ä½¿ç”¨â€œæ•°æ®é©±åŠ¨â€çš„æ–¹å¼æ€è€ƒï¼Œé¿å…ç›´æ¥æ¥è§¦ DOMï¼Œä½†æ˜¯æœ‰æ—¶æˆ‘ä»¬å¿…é¡»è¦è¿™ä¹ˆåšã€‚ä¸ºäº†åœ¨æ•°æ®å˜åŒ–ä¹‹åç­‰å¾… Vue å®Œæˆæ›´æ–° DOMï¼Œå¯ä»¥åœ¨æ•°æ®å˜åŒ–ä¹‹åç«‹å³ä½¿ç”¨ Vue.nextTick(callback)ã€‚è¿™æ ·å›è°ƒå‡½æ•°å°†åœ¨ DOM æ›´æ–°å®Œæˆåè¢«è°ƒç”¨ã€‚ dom æ›´æ–°ä¸ºä»€ä¹ˆæ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œå› ä¸ºå®ƒæå‡äº†æ¸²æŸ“æ•ˆç‡ã€‚ æ•°æ®å“åº”(æ•°æ®åŠ«æŒ)æ•°æ®å“åº”çš„å®ç°ç”±ä¸¤éƒ¨åˆ†æ„æˆ: è§‚å¯Ÿè€…( watcher ) å’Œ ä¾èµ–æ”¶é›†å™¨( Dep )ï¼Œå…¶æ ¸å¿ƒæ˜¯ defineProperty è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒå¯ä»¥é‡å†™å±æ€§çš„ get ä¸ set æ–¹æ³•ï¼Œä»è€Œå®Œæˆç›‘å¬æ•°æ®çš„æ”¹å˜ã€‚ å¯¹éœ€è¦ observe çš„æ•°æ®å¯¹è±¡è¿›è¡Œé€’å½’éå†ï¼ŒåŒ…æ‹¬å­å±æ€§å¯¹è±¡çš„å±æ€§ï¼Œéƒ½åŠ ä¸Š setter å’Œ getter è¿™æ ·çš„è¯ï¼Œç»™è¿™ä¸ªå¯¹è±¡çš„æŸä¸ªå€¼èµ‹å€¼ï¼Œå°±ä¼šè§¦å‘ setterï¼Œé‚£ä¹ˆå°±èƒ½ç›‘å¬åˆ°äº†æ•°æ®å˜åŒ– compile è§£ææ¨¡æ¿æŒ‡ä»¤ï¼Œå°†æ¨¡æ¿ä¸­çš„å˜é‡æ›¿æ¢æˆæ•°æ®ï¼Œç„¶ååˆå§‹åŒ–æ¸²æŸ“é¡µé¢è§†å›¾ï¼Œå¹¶å°†æ¯ä¸ªæŒ‡ä»¤å¯¹åº”çš„èŠ‚ç‚¹ç»‘å®šæ›´æ–°å‡½æ•°ï¼Œæ·»åŠ ç›‘å¬æ•°æ®çš„è®¢é˜…è€…ï¼Œä¸€æ—¦æ•°æ®æœ‰å˜åŠ¨ï¼Œæ”¶åˆ°é€šçŸ¥ï¼Œæ›´æ–°è§†å›¾ Watcher è®¢é˜…è€…æ˜¯ Observer å’Œ Compile ä¹‹é—´é€šä¿¡çš„æ¡¥æ¢ï¼Œä¸»è¦åšçš„äº‹æƒ…æ˜¯:â‘  åœ¨è‡ªèº«å®ä¾‹åŒ–æ—¶å¾€å±æ€§è®¢é˜…å™¨(dep)é‡Œé¢æ·»åŠ è‡ªå·±â‘¡ è‡ªèº«å¿…é¡»æœ‰ä¸€ä¸ª update()æ–¹æ³•â‘¢ å¾…å±æ€§å˜åŠ¨ dep.notice()é€šçŸ¥æ—¶ï¼Œèƒ½è°ƒç”¨è‡ªèº«çš„ update()æ–¹æ³•ï¼Œå¹¶è§¦å‘ Compile ä¸­ç»‘å®šçš„å›è°ƒ MVVM ä½œä¸ºæ•°æ®ç»‘å®šçš„å…¥å£ï¼Œæ•´åˆ Observerã€Compile å’Œ Watcher ä¸‰è€…ï¼Œé€šè¿‡ Observer æ¥ç›‘å¬è‡ªå·±çš„ model æ•°æ®å˜åŒ–ï¼Œé€šè¿‡ Compile æ¥è§£æç¼–è¯‘æ¨¡æ¿æŒ‡ä»¤ï¼Œæœ€ç»ˆåˆ©ç”¨ Watcher æ­èµ· Observer å’Œ Compile ä¹‹é—´çš„é€šä¿¡æ¡¥æ¢ï¼Œè¾¾åˆ°æ•°æ®å˜åŒ– -&gt; è§†å›¾æ›´æ–°ï¼›è§†å›¾äº¤äº’å˜åŒ–(input) -&gt; æ•°æ® model å˜æ›´çš„åŒå‘ç»‘å®šæ•ˆæœã€‚ let data = &#123; a: 1,&#125;;// æ•°æ®å“åº”æ€§observe(data);// åˆå§‹åŒ–è§‚å¯Ÿè€…new Watcher(data, &#x27;name&#x27;, updateComponent);data.a = 2;// ç®€å•è¡¨ç¤ºç”¨äºæ•°æ®æ›´æ–°åçš„æ“ä½œfunction updateComponent() &#123; vm._update(); // patchs&#125;// ç›‘è§†å¯¹è±¡function observe(obj) &#123; // éå†å¯¹è±¡ï¼Œä½¿ç”¨ get/set é‡æ–°å®šä¹‰å¯¹è±¡çš„æ¯ä¸ªå±æ€§å€¼ Object.keys(obj).map(key =&gt; &#123; defineReactive(obj, key, obj[key]); &#125;);&#125;function defineReactive(obj, k, v) &#123; // é€’å½’å­å±æ€§ if (type(v) == &#x27;object&#x27;) observe(v); // æ–°å»ºä¾èµ–æ”¶é›†å™¨ let dep = new Dep(); // å®šä¹‰get/set Object.defineProperty(obj, k, &#123; enumerable: true, configurable: true, get: function reactiveGetter() &#123; // å½“æœ‰è·å–è¯¥å±æ€§æ—¶ï¼Œè¯æ˜ä¾èµ–äºè¯¥å¯¹è±¡ï¼Œå› æ­¤è¢«æ·»åŠ è¿›æ”¶é›†å™¨ä¸­ if (Dep.target) &#123; dep.addSub(Dep.target); &#125; return v; &#125;, // é‡æ–°è®¾ç½®å€¼æ—¶ï¼Œè§¦å‘æ”¶é›†å™¨çš„é€šçŸ¥æœºåˆ¶ set: function reactiveSetter(nV) &#123; v = nV; dep.nofify(); &#125;, &#125;);&#125;// ä¾èµ–æ”¶é›†å™¨class Dep &#123; constructor() &#123; this.subs = []; &#125; addSub(sub) &#123; this.subs.push(sub); &#125; notify() &#123; this.subs.map(sub =&gt; &#123; sub.update(); &#125;); &#125;&#125;Dep.target = null;// è§‚å¯Ÿè€…class Watcher &#123; constructor(obj, key, cb) &#123; Dep.target = this; this.cb = cb; this.obj = obj; this.key = key; this.value = obj[key]; Dep.target = null; &#125; addDep(Dep) &#123; Dep.addSub(this); &#125; update() &#123; this.value = this.obj[this.key]; this.cb(this.value); &#125; before() &#123; callHook(&#x27;beforeUpdate&#x27;); &#125;&#125; è™šæ‹Ÿ dom åŸç†å®ç° åˆ›å»º dom æ ‘ æ ‘çš„ diffï¼ŒåŒå±‚å¯¹æ¯”ï¼Œè¾“å‡º patchs(listDiff/diffChildren/diffProps) æ²¡æœ‰æ–°çš„èŠ‚ç‚¹ï¼Œè¿”å› æ–°çš„èŠ‚ç‚¹ tagName ä¸ key ä¸å˜ï¼Œ å¯¹æ¯” propsï¼Œç»§ç»­é€’å½’éå†å­æ ‘ å¯¹æ¯”å±æ€§(å¯¹æ¯”æ–°æ—§å±æ€§åˆ—è¡¨): æ—§å±æ€§æ˜¯å¦å­˜åœ¨ä¸æ–°å±æ€§åˆ—è¡¨ä¸­ éƒ½å­˜åœ¨çš„æ˜¯å¦æœ‰å˜åŒ– æ˜¯å¦å‡ºç°æ—§åˆ—è¡¨ä¸­æ²¡æœ‰çš„æ–°å±æ€§ tagName å’Œ key å€¼å˜åŒ–äº†ï¼Œåˆ™ç›´æ¥æ›¿æ¢æˆæ–°èŠ‚ç‚¹ æ¸²æŸ“å·®å¼‚ éå† patchsï¼Œ æŠŠéœ€è¦æ›´æ”¹çš„èŠ‚ç‚¹å–å‡ºæ¥ å±€éƒ¨æ›´æ–° dom patch å‡½æ•° oldvnode vnode å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹ä¸ä¸€æ ·ï¼Œç›´æ¥ç”¨æ–°èŠ‚ç‚¹æ›¿æ¢è€èŠ‚ç‚¹ï¼› å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹ä¸€æ · æ–°è€èŠ‚ç‚¹ä¸€æ ·ï¼Œç›´æ¥è¿”å›ï¼› è€èŠ‚ç‚¹æœ‰å­èŠ‚ç‚¹ï¼Œæ–°èŠ‚ç‚¹æ²¡æœ‰ï¼šåˆ é™¤è€èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼› è€èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œæ–°èŠ‚ç‚¹æœ‰å­èŠ‚ç‚¹ï¼šæ–°èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ç›´æ¥ append åˆ°è€èŠ‚ç‚¹ï¼› éƒ½åªæœ‰æ–‡æœ¬èŠ‚ç‚¹ï¼šç›´æ¥ç”¨æ–°èŠ‚ç‚¹çš„æ–‡æœ¬èŠ‚ç‚¹æ›¿æ¢è€çš„æ–‡æœ¬èŠ‚ç‚¹ï¼› éƒ½æœ‰å­èŠ‚ç‚¹ï¼šupdateChildren // diffç®—æ³•çš„å®ç°function diff(oldTree, newTree) &#123; // å·®å¼‚æ”¶é›† let pathchs = &#123;&#125;; dfs(oldTree, newTree, 0, pathchs); return pathchs;&#125;function dfs(oldNode, newNode, index, pathchs) &#123; let curPathchs = []; if (newNode) &#123; // å½“æ–°æ—§èŠ‚ç‚¹çš„ tagName å’Œ key å€¼å®Œå…¨ä¸€è‡´æ—¶ if (oldNode.tagName === newNode.tagName &amp;&amp; oldNode.key === newNode.key) &#123; // ç»§ç»­æ¯”å¯¹å±æ€§å·®å¼‚ let props = diffProps(oldNode.props, newNode.props); curPathchs.push(&#123; type: &#x27;changeProps&#x27;, props, &#125;); // é€’å½’è¿›å…¥ä¸‹ä¸€å±‚çº§çš„æ¯”è¾ƒ diffChildrens(oldNode.children, newNode.children, index, pathchs); &#125; else &#123; // å½“ tagName æˆ–è€… key ä¿®æ”¹äº†åï¼Œè¡¨ç¤ºå·²ç»æ˜¯å…¨æ–°èŠ‚ç‚¹ï¼Œæ— éœ€å†æ¯” curPathchs.push(&#123; type: &#x27;replaceNode&#x27;, node: newNode, &#125;); &#125; &#125; // æ„å»ºå‡ºæ•´é¢—å·®å¼‚æ ‘ if (curPathchs.length) &#123; if (pathchs[index]) &#123; pathchs[index] = pathchs[index].concat(curPathchs); &#125; else &#123; pathchs[index] = curPathchs; &#125; &#125;&#125;// å±æ€§å¯¹æ¯”å®ç°function diffProps(oldProps, newProps) &#123; let propsPathchs = []; // éå†æ–°æ—§å±æ€§åˆ—è¡¨ // æŸ¥æ‰¾åˆ é™¤é¡¹ // æŸ¥æ‰¾ä¿®æ”¹é¡¹ // æŸ¥æ‰¾æ–°å¢é¡¹ forin(olaProps, (k, v) =&gt; &#123; if (!newProps.hasOwnProperty(k)) &#123; propsPathchs.push(&#123; type: &#x27;remove&#x27;, prop: k, &#125;); &#125; else &#123; if (v !== newProps[k]) &#123; propsPathchs.push(&#123; type: &#x27;change&#x27;, prop: k, value: newProps[k], &#125;); &#125; &#125; &#125;); forin(newProps, (k, v) =&gt; &#123; if (!oldProps.hasOwnProperty(k)) &#123; propsPathchs.push(&#123; type: &#x27;add&#x27;, prop: k, value: v, &#125;); &#125; &#125;); return propsPathchs;&#125;// å¯¹æ¯”å­çº§å·®å¼‚function diffChildrens(oldChild, newChild, index, pathchs) &#123; // æ ‡è®°å­çº§çš„åˆ é™¤/æ–°å¢/ç§»åŠ¨ let &#123; change, list &#125; = diffList(oldChild, newChild, index, pathchs); if (change.length) &#123; if (pathchs[index]) &#123; pathchs[index] = pathchs[index].concat(change); &#125; else &#123; pathchs[index] = change; &#125; &#125; // æ ¹æ® key è·å–åŸæœ¬åŒ¹é…çš„èŠ‚ç‚¹ï¼Œè¿›ä¸€æ­¥é€’å½’ä»å¤´å¼€å§‹å¯¹æ¯” oldChild.map((item, i) =&gt; &#123; let keyIndex = list.indexOf(item.key); if (keyIndex) &#123; let node = newChild[keyIndex]; // è¿›ä¸€æ­¥é€’å½’å¯¹æ¯” dfs(item, node, index, pathchs); &#125; &#125;);&#125;// åˆ—è¡¨å¯¹æ¯”ï¼Œä¸»è¦ä¹Ÿæ˜¯æ ¹æ® key å€¼æŸ¥æ‰¾åŒ¹é…é¡¹// å¯¹æ¯”å‡ºæ–°æ—§åˆ—è¡¨çš„æ–°å¢/åˆ é™¤/ç§»åŠ¨function diffList(oldList, newList, index, pathchs) &#123; let change = []; let list = []; const newKeys = getKey(newList); oldList.map(v =&gt; &#123; if (newKeys.indexOf(v.key) &gt; -1) &#123; list.push(v.key); &#125; else &#123; list.push(null); &#125; &#125;); // æ ‡è®°åˆ é™¤ for (let i = list.length - 1; i &gt;= 0; i--) &#123; if (!list[i]) &#123; list.splice(i, 1); change.push(&#123; type: &#x27;remove&#x27;, index: i, &#125;); &#125; &#125; // æ ‡è®°æ–°å¢å’Œç§»åŠ¨ newList.map((item, i) =&gt; &#123; const key = item.key; const index = list.indexOf(key); if (index === -1 || key == null) &#123; // æ–°å¢ change.push(&#123; type: &#x27;add&#x27;, node: item, index: i, &#125;); list.splice(i, 0, key); &#125; else &#123; // ç§»åŠ¨ if (index !== i) &#123; change.push(&#123; type: &#x27;move&#x27;, form: index, to: i, &#125;); move(list, index, i); &#125; &#125; &#125;); return &#123; change, list, &#125;;&#125; Proxy ç›¸æ¯”äº defineProperty çš„ä¼˜åŠ¿ æ•°ç»„å˜åŒ–ä¹Ÿèƒ½ç›‘å¬åˆ° ä¸éœ€è¦æ·±åº¦éå†ç›‘å¬(éå†æ¯ä¸€ä¸ªå±æ€§) let data = &#123; a: 1,&#125;;let reactiveData = new Proxy(data, &#123; get: function (target, name) &#123; // ... &#125;, // ...&#125;); vue é¡¹ç›®çš„ä¼˜åŒ– v-if å’Œ v-show åŒºåˆ†åœºæ™¯ä½¿ç”¨ computed å’Œ watch åŒºåˆ†åœºæ™¯ä½¿ç”¨ v-for éå†å¿…é¡»åŠ  keyï¼Œkey æœ€å¥½æ˜¯ id å€¼ï¼Œå¦‚æœé‡‡ç”¨ index å½“æ’å…¥æ•°æ®æ—¶ç´¢å¼•ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä¸”é¿å…åŒæ—¶ä½¿ç”¨ v-if(ç”¨è®¡ç®—å±æ€§è¿‡æ»¤æ•°æ®) å›¾ç‰‡æ‡’åŠ è½½ è·¯ç”±æ‡’åŠ è½½ ç¬¬ä¸‰æ–¹æ’ä»¶æŒ‰éœ€å¼•å…¥ é•¿åˆ—è¡¨(è™šæ‹Ÿåˆ—è¡¨) æ— é™åˆ—è¡¨åŠ è½½åˆ°åº•éƒ¨è¯·æ±‚ apiï¼Œç”¨ v-for å¾ªç¯æ•°æ®è¿™æ ·æ˜¯æ¬ å¦¥å½“çš„ã€‚éšç€æ•°æ®çš„åŠ è½½ï¼Œdom ä¼šè¶Šæ¥è¶Šå¤šï¼Œé€ æˆæ€§èƒ½çš„å¼€é”€å¤§ï¼Œå¯¹å®¢æˆ·ç«¯é€ æˆå‹åŠ›ã€‚è™šæ‹Ÿåˆ—è¡¨ä¿è¯ dom æ•°é‡ä¸€å®šï¼Œæ¸²æŸ“å¯è§†åŒºçš„ domï¼Œé€šè¿‡æ›¿æ¢æ•°æ®æ¥å®ç°é•¿åˆ—è¡¨çš„æ˜¾ç¤ºã€‚ é‡Šæ”¾ç»„ä»¶èµ„æº(beforeDestroy ç§»é™¤ç›‘å¬) é¦–å±ä¼˜åŒ– mixins æŠ½ç¦»å…¬å…±ä»£ç  vue is çš„ä½œç”¨ç®€å•æ¥è¯´å°±æ˜¯æ‰©å±• html æ ‡ç­¾çš„é™åˆ¶&lt;ul&gt; &lt;li&gt;&lt;/li&gt;&lt;/ul&gt;&lt;!-- ulé‡Œé¢åµŒå¥—liæ˜¯å›ºå®šçš„å†™æ³• --&gt; å½“æˆ‘ä»¬ä½¿ç”¨è‡ªå®šä¹‰çš„ç»„ä»¶æ—¶ä¼šè¢«å½“ä½œæ— æ•ˆå†…å®¹ â†“ &lt;ul&gt; &lt;my-li&gt;&lt;/my-li&gt;&lt;/ul&gt; å¯ä»¥é€šè¿‡ is æ¥æ‰©å±• &lt;ul&gt; &lt;li is=&quot;my-li&quot;&gt;&lt;/li&gt;&lt;/ul&gt; åŠ¨æ€åˆ‡æ¢ç»„ä»¶&lt;div :is=&quot;å˜é‡åç§°&quot;&gt;&lt;/div&gt; assets å’Œ static çš„åŒºåˆ« assets ä¸­çš„æ–‡ä»¶åœ¨è¿è¡Œ npm run build çš„æ—¶å€™ä¼šæ‰“åŒ…ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¼šè¢«å‹ç¼©ä½“ç§¯ï¼Œä»£ç æ ¼å¼åŒ–ä¹‹ç±»çš„ã€‚æ‰“åŒ…ä¹‹åä¹Ÿä¼šæ”¾åˆ° static ä¸­ã€‚ static ä¸­çš„æ–‡ä»¶åˆ™ä¸ä¼šè¢«æ‰“åŒ…ã€‚ å»ºè®®ï¼šå°†å›¾ç‰‡ç­‰æœªå¤„ç†çš„æ–‡ä»¶æ”¾åœ¨ assets ä¸­ï¼Œæ‰“åŒ…å‡å°‘ä½“ç§¯ã€‚è€Œå¯¹äºç¬¬ä¸‰æ–¹å¼•å…¥çš„ä¸€äº›èµ„æºæ–‡ä»¶å¦‚ iconfont.css ç­‰å¯ä»¥æ”¾åœ¨ static ä¸­ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶å·²ç»ç»è¿‡å¤„ç†äº†ã€‚ å°è£… vue ç»„ä»¶çš„è¿‡ç¨‹ å»ºç«‹ç»„ä»¶æ¨¡æ¿ã€æ¶å­å†™å†™æ ·å¼ï¼Œè€ƒè™‘å¥½ç»„ä»¶çš„åŸºæœ¬é€»è¾‘ å‡†å¤‡å¥½ç»„ä»¶çš„æ•°æ®è¾“å…¥ï¼Œå®šå¥½ props é‡Œé¢çš„æ•°æ®ã€ç±»å‹ å‡†å¤‡å¥½ç»„ä»·çš„æ•°æ®è¾“å‡ºï¼Œå®šå¥½æš´éœ²å‡ºæ¥çš„æ–¹æ³• å¸¸ç”¨ç»„ä»¶åº“ æ–‡æœ¬æ¯”å¯¹:vue-code-diff JSON ä»£ç ç¼–è¾‘å™¨:vue-codemirror å›½é™…åŒ–:vue-i18n å¯Œæ–‡æœ¬ç¼–è¾‘å™¨:wangEditor å¯Œæ–‡æœ¬ç¼–è¾‘å™¨:tinymce monaco ç¼–è¾‘å™¨:vue-monaco ace ç¼–è¾‘å™¨:vue2-ace-editor å‰ªåˆ‡æ¿:vue-clipboard2 æ“ä½œ cookie:vue-cookies fragment å…ƒç´ :vue-fragment ä»£ç é«˜äº®:vue-highlightjs command ç•Œé¢:xterm.js command ç•Œé¢:hterm å¤„ç† yaml:yaml.js yaml:js-yaml vue çš„ echarts å°è£…:v-charts mock:mockjs åˆ¤æ–­æ˜¯å¦æ˜¯é»‘è‰²:is-dark-color XSS è¿‡æ»¤: DOMPurify å¸¸ç”¨ UI åº“ç§»åŠ¨ç«¯ mint-ui Vant VUX cube-ui pc ç«¯ [element-ui](https://element.eleme.cn/2.13/#/zh-CN/component/installationï¼‰ Ant Design of Vue iview/viewui/view-design Avue vuetify å¸¸ç”¨é…ç½®publicPath cli2 config/index.js build: &#123; assetsPublicPath: &#x27;./&#x27;;&#125; cli3 vue.config.js module.exports = &#123; publicPath: &#x27;./&#x27;,&#125;; éƒ¨ç½²åº”ç”¨åŒ…æ—¶çš„åŸºæœ¬ URLã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒVue CLI ä¼šå‡è®¾ä½ çš„åº”ç”¨æ˜¯è¢«éƒ¨ç½²åœ¨ä¸€ä¸ªåŸŸåçš„æ ¹è·¯å¾„ä¸Šï¼Œä¾‹å¦‚ https://www.my-app.com/ ã€‚å¦‚æœåº”ç”¨è¢«éƒ¨ç½²åœ¨ä¸€ä¸ªå­è·¯å¾„ä¸Šï¼Œä½ å°±éœ€è¦ç”¨è¿™ä¸ªé€‰é¡¹æŒ‡å®šè¿™ä¸ªå­è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„åº”ç”¨è¢«éƒ¨ç½²åœ¨ https://www.my-app.com/my-app/ ï¼Œåˆ™è®¾ç½® publicPathä¸º/my-app/ proxy: &#123; &quot;/api&quot;: &#123; //å¦‚æœajaxè¯·æ±‚çš„åœ°å€æ˜¯http://192.168.0.118:9999/api1é‚£ä¹ˆä½ å°±å¯ä»¥åœ¨ajaxä¸­ä½¿ç”¨/api/api1è·¯å¾„,å…¶è¯·æ±‚è·¯å¾„ä¼šè§£æ // http://192.168.0.118:9999/api1ï¼Œå½“ç„¶ä½ åœ¨æµè§ˆå™¨ä¸Šçœ‹åˆ°çš„è¿˜æ˜¯http://localhost:8080/api/api1; target: &quot;http://192.168.0.118:9999&quot;, //æ˜¯å¦å…è®¸è·¨åŸŸï¼Œè¿™é‡Œæ˜¯åœ¨å¼€å‘ç¯å¢ƒä¼šèµ·ä½œç”¨ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ï¼Œè¿˜æ˜¯ç”±åå°å»å¤„ç†ï¼Œæ‰€ä»¥ä¸å¿…å¤ªåœ¨æ„ changeOrigin: true, pathRewrite: &#123; //æŠŠå¤šä½™çš„è·¯å¾„ç½®ä¸º&#x27;&#x27; &quot;api&quot;: &quot;&quot; &#125; &#125; vue3 createApp vue2.x import Vue from &#x27;vue&#x27;;import App from &#x27;./App.vue&#x27;;new Vue(&#123; render: h =&gt; h(App),&#125;).$mount(&#x27;#app&#x27;); vue3 æ–°ç‰¹æ€§ createApp ä¼šäº§ç”Ÿä¸€ä¸ª app å®ä¾‹ï¼Œè¯¥å®ä¾‹æ‹¥æœ‰å…¨å±€çš„å¯é…ç½®ä¸Šä¸‹æ–‡ import &#123; createApp &#125; from &#x27;vue&#x27;;import App from &#x27;./App.vue&#x27;;createApp(App).mount(&#x27;#app&#x27;); globalProperties app.config.globalProperties.foo = &#x27;bar&#x27;;app.component(&#x27;child-component&#x27;, &#123; mounted() &#123; console.log(this.foo); // &#x27;bar&#x27; &#125;,&#125;); æ·»åŠ å¯åœ¨ç¨‹åºå†…çš„ä»»ä½•ç»„ä»¶å®ä¾‹ä¸­è®¿é—®çš„å…¨å±€å±æ€§ã€‚å½“å­˜åœ¨é”®å†²çªæ—¶ï¼Œç»„ä»¶å±æ€§å°†ä¼˜å…ˆæ›¿ä»£æ‰ Vue2.x çš„ Vue.prototype å±æ€§æ”¾åˆ°åŸå‹ä¸Šçš„å†™æ³• // Vue2.xVue.prototype.$http = () =&gt; &#123;&#125;;// Vue3const app = Vue.createApp(&#123;&#125;);app.config.globalProperties.$http = () =&gt; &#123;&#125;; æ›´å¿« é‡å†™è™šæ‹Ÿ DOM (Virtual DOM Rewrite) éšç€è™šæ‹Ÿ DOM é‡å†™ï¼Œæˆ‘ä»¬å¯ä»¥æœŸå¾…æ›´å¤šçš„ ç¼–è¯‘æ—¶ï¼ˆcompile-timeï¼‰æç¤ºæ¥å‡å°‘ è¿è¡Œæ—¶ï¼ˆruntimeï¼‰å¼€é”€ã€‚é‡å†™å°†åŒ…æ‹¬æ›´æœ‰æ•ˆçš„ä»£ç æ¥åˆ›å»ºè™šæ‹ŸèŠ‚ç‚¹ã€‚ ä¼˜åŒ–æ’æ§½ç”Ÿæˆ(Optimized Slots Generation) åœ¨å½“å‰çš„ Vue ç‰ˆæœ¬ä¸­ï¼Œå½“çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œå…¶å­ç»„ä»¶ä¹Ÿå¿…é¡»é‡æ–°æ¸²æŸ“ã€‚ ä½¿ç”¨ Vue 3 ï¼Œå¯ä»¥å•ç‹¬é‡æ–°æ¸²æŸ“çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶ã€‚ é™æ€æ ‘æå‡(Static Tree Hoisting) ä½¿ç”¨é™æ€æ ‘æå‡ï¼Œè¿™æ„å‘³ç€ Vue 3 çš„ç¼–è¯‘å™¨å°†èƒ½å¤Ÿæ£€æµ‹åˆ°ä»€ä¹ˆæ˜¯é™æ€ç»„ä»¶ï¼Œç„¶åå°†å…¶æå‡ï¼Œä»è€Œé™ä½äº†æ¸²æŸ“æˆæœ¬ã€‚å®ƒå°†èƒ½å¤Ÿè·³è¿‡æœªæ•´ä¸ªæ ‘ç»“æ„æ‰“è¡¥ä¸çš„è¿‡ç¨‹ã€‚ é™æ€å±æ€§æå‡ï¼ˆStatic Props Hoistingï¼‰ æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥æœŸå¾…é™æ€å±æ€§æå‡ï¼Œå…¶ä¸­ Vue 3 å°†è·³è¿‡ä¸ä¼šæ”¹å˜èŠ‚ç‚¹çš„æ‰“è¡¥ä¸è¿‡ç¨‹ã€‚ åŸºäº Proxy çš„è§‚å¯Ÿè€…æœºåˆ¶ æ›´å°Vue å·²ç»éå¸¸å°äº†ï¼Œåœ¨è¿è¡Œæ—¶ï¼ˆruntimeï¼‰å‹ç¼©åå¤§çº¦ 20kb ã€‚ ä½†æˆ‘ä»¬å¯ä»¥æœŸå¾…å®ƒä¼šå˜å¾—æ›´åŠ å°ï¼Œæ–°çš„æ ¸å¿ƒè¿è¡Œæ—¶å‹ç¼©åå¤§æ¦‚ 10kb ã€‚ ä½¿å…¶æ›´å…·å¯ç»´æŠ¤æ€§ä¸ä»…ä¼šä½¿ç”¨ TypeScriptï¼ˆå…è®¸åœ¨ç¼–è¾‘å™¨ä¸­è¿›è¡Œé«˜çº§çš„ç±»å‹æ£€æŸ¥å’Œæœ‰ç”¨çš„é”™è¯¯å’Œè­¦å‘Šï¼‰ ï¼Œè€Œä¸”è®¸å¤šè½¯ä»¶åŒ…å°†è¢«è§£è€¦ï¼Œä½¿æ‰€æœ‰å†…å®¹æ›´åŠ æ¨¡å—åŒ–ã€‚ æ›´å¤šçš„åŸç”Ÿæ”¯æŒè¿è¡Œæ—¶å†…æ ¸ä¹Ÿå°†ä¸å¹³å°æ— å…³ï¼Œä½¿å¾— Vue å¯ä»¥æ›´å®¹æ˜“åœ°ä¸ä»»ä½•å¹³å°ï¼ˆä¾‹å¦‚ Webï¼ŒiOS æˆ– Androidï¼‰ä¸€èµ·ä½¿ç”¨ã€‚ æ›´æ˜“äºå¼€å‘ä½¿ç”¨å½“æˆ‘ä»¬éœ€è¦åœ¨ Vue ä¸­å…±äº«ä¸¤ä¸ªç»„ä»¶ä¹‹é—´çš„è¡Œä¸ºæ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ Mixins ã€‚ç„¶è€Œï¼ŒEvan æ­£åœ¨å°è¯•ä½¿ç”¨ Hooks API æ¥é¿å…æ¥è‡ª Mixins çš„ä¸€äº›é—®é¢˜ï¼Œå¹¶ä¸”æ›´é€‚åˆ ä½¿ç”¨æƒ¯ç”¨çš„ Vue ä»£ç ã€‚ä½¿ç”¨ Time Slicingï¼Œå°† JS çš„æ‰§è¡Œåˆ†è§£ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼Œå¦‚æœæœ‰ç”¨æˆ·äº¤äº’éœ€è¦å¤„ç†ï¼Œè¿™äº›éƒ¨åˆ†å°†æä¾›ç»™æµè§ˆå™¨ã€‚ element-ui ä½¿ç”¨ä¸­é‡åˆ°çš„å‘ ä¸æ”¯æŒ v-model ä¿®é¥°ç¬¦å¯¼è‡´å¦‚æœä½¿ç”¨.trim å½“æ•°æ®æ‹¼æ¥äº†&#39; &#39;åï¼Œç¬¬ä¸€æ¬¡ç‚¹å‡»æ•°æ®ä¸­é—´ç¼–è¾‘ï¼Œå…‰æ ‡ä¼šè·³åˆ°æœ«å°¾ el-table å½“æ³¨å…¥çš„ data ç»è¿‡è¿‡æ»¤ï¼Œæ‰€å¯¹åº”çš„$index è¿˜æ˜¯åŸæ¥çš„ï¼Œå¯¼è‡´åˆ é™¤ splice å¯¹åº”çš„ index ä¸å‡†ç¡® åœ¨ disabled çš„ button ä¸Šä½¿ç”¨ Tooltip å¤±æ•ˆï¼Œ el-tooltip ä¸æ˜¾ç¤º(disable å±æ€§) input-number è¾“å…¥ç²¾åº¦ precision æ—¢è¦ç¼–è¾‘åˆè¦æ˜¾ç¤ºè¶…å‡ºæœ€å°å€¼ é¡µé¢åˆ·æ–°ã€å±€éƒ¨åˆ·æ–° è½¬è½½","updated":"2025-08-02T05:46:04.174Z","tags":[{"name":"+ vue","slug":"vue","permalink":"https://luckyship.github.io/tags/vue/"}]},{"title":"csså…±é€šå±æ€§","date":"2020-12-21T09:24:15.000Z","path":"2020/12/21/2020-12-21-css-common-attribute/","text":"css é€šç”¨å±æ€§ initial inherit unset revert initialinitial å…³é”®å­—ç”¨äºè®¾ç½® CSS å±æ€§ä¸ºå®ƒçš„é»˜è®¤å€¼ï¼Œå¯ä½œç”¨äºä»»ä½• CSS æ ·å¼ã€‚ï¼ˆIE ä¸æ”¯æŒè¯¥å…³é”®å­—ï¼‰ inheritæ¯ä¸€ä¸ª CSS å±æ€§éƒ½æœ‰ä¸€ä¸ªç‰¹æ€§å°±æ˜¯ï¼Œè¿™ä¸ªå±æ€§å¿…ç„¶æ˜¯é»˜è®¤ç»§æ‰¿çš„ (inherited: Yes) æˆ–è€…æ˜¯é»˜è®¤ä¸ç»§æ‰¿çš„ (inherited: no) å…¶ä¸­ä¹‹ä¸€ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ MDN ä¸Šé€šè¿‡è¿™ä¸ªç´¢å¼•æŸ¥æ‰¾ï¼Œåˆ¤æ–­ä¸€ä¸ªå±æ€§çš„æ˜¯å¦ç»§æ‰¿ç‰¹æ€§ã€‚ å¯ç»§æ‰¿å±æ€§æœ€åç½—åˆ—ä¸€ä¸‹é»˜è®¤ä¸º inherited: Yes çš„å±æ€§ï¼š æ‰€æœ‰å…ƒç´ å¯ç»§æ‰¿ï¼švisibility å’Œ cursor å†…è”å…ƒç´ å¯ç»§æ‰¿ï¼šletter-spacingã€word-spacingã€white-spaceã€line-heightã€colorã€fontã€ font-familyã€font-sizeã€font-styleã€font-variantã€font-weightã€text- decorationã€text-transformã€direction å—çŠ¶å…ƒç´ å¯ç»§æ‰¿ï¼štext-indent å’Œ text-align åˆ—è¡¨å…ƒç´ å¯ç»§æ‰¿ï¼šlist-styleã€list-style-typeã€list-style-positionã€list-style-image è¡¨æ ¼å…ƒç´ å¯ç»§æ‰¿ï¼šborder-collapse unsetåå¦‚å…¶æ„ï¼Œ unset å…³é”®å­—æˆ‘ä»¬å¯ä»¥ç®€å•ç†è§£ä¸ºä¸è®¾ç½®ã€‚å…¶å®ï¼Œå®ƒæ˜¯å…³é”®å­— initial å’Œ inherit çš„ç»„åˆã€‚ ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¹Ÿå°±æ˜¯å½“æˆ‘ä»¬ç»™ä¸€ä¸ª CSS å±æ€§è®¾ç½®äº† unset çš„è¯ï¼š å¦‚æœè¯¥å±æ€§æ˜¯é»˜è®¤ç»§æ‰¿å±æ€§ï¼Œè¯¥å€¼ç­‰åŒäº inherit å¦‚æœè¯¥å±æ€§æ˜¯éç»§æ‰¿å±æ€§ï¼Œè¯¥å€¼ç­‰åŒäº initial revertrevert æ˜¯æ›´ä¸ºæ–°çš„ä¸€ä¸ªå…³é”®å­—ã€‚ç›´æ¥æ„è¯‘çš„æ„æ€ä¸º â€“ æ¢å¤ã€‚ å®ƒä¸å…³é”®å­— unset éå¸¸ç±»ä¼¼ï¼Œåœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œä»–ä»¬çš„ä½œç”¨æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼š revertï¼šå±æ€§åº”ç”¨äº†è¯¥å€¼åï¼Œå°†è¿˜åŸåˆ°å…·æœ‰ç”±æµè§ˆå™¨æˆ–ç”¨æˆ·åˆ›å»ºçš„è‡ªå®šä¹‰æ ·å¼è¡¨ï¼ˆåœ¨æµè§ˆå™¨ä¾§è®¾ç½®ï¼‰è®¾ç½®çš„å€¼ unset: å±æ€§åº”ç”¨äº†è¯¥å€¼åï¼Œæ ·å¼å°†å®Œå…¨è¢«è¿˜åŸ unset å’Œ revert çš„ä¸åŒä¹‹å¤„&lt;div class=&quot;father&quot;&gt; &lt;b class=&quot;color unset&quot;&gt;è®¾ç½®äº† unsetï¼Œæˆ‘çš„ font-weight ä¼šè¢«å®Œå…¨æ¸…é™¤&lt;/b&gt; &lt;br /&gt; &lt;b class=&quot;color revert&quot; &gt;è®¾ç½®äº† revertï¼Œæˆ‘çš„ font-weight å°†ä¼šè¢«è¿˜åŸåˆ°æµè§ˆå™¨é»˜è®¤æ ·å¼çš„ font-weight: bold;&lt;/b &gt;&lt;/div&gt; .unset &#123; font-weight: unset;&#125;.revert &#123; font-weight: revert;&#125; å‚è€ƒå†™äº†è¿™ä¹ˆå¤šå¹´ CSSï¼Œinitial å’Œ inherit ä»¥åŠ unset å’Œ revert è¿˜å‚»å‚»åˆ†ä¸æ¸…æ¥šï¼Ÿ","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"}]},{"title":"vueç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°","date":"2020-12-20T09:25:12.000Z","path":"2020/12/20/2020-12-20-vue-life-hook-function/","text":"vueçš„ç”Ÿå‘½å‘¨æœŸç®€å•çš„è¯´ç”Ÿå‘½å‘¨æœŸå°±æ˜¯äº‹ç‰©ä»äº§ç”Ÿåˆ°æ¶ˆå¤±çš„ä¸€ä¸ªæ—¶é—´è¿‡ç¨‹ã€‚é‚£ä¹ˆvueçš„ç”Ÿå‘½å‘¨æœŸå°±æ˜¯ä»å…¶è¢«åˆ›å»ºåˆ°é”€æ¯çš„è¿‡ç¨‹ï¼Œå…¶ä¸­åŒ…å«äº†å¼€å§‹åˆ›å»ºã€åˆå§‹åŒ–æ•°æ®ã€ç¼–è¯‘æ¨¡æ¿ã€æŒ‚è½½domï¼ˆæ¸²æŸ“ï¼‰ ï¼Œæ¸²æŸ“-&gt;æ›´æ–°-&gt;æ¸²æŸ“ã€é”€æ¯ï¼ˆå¸è½½ï¼‰ç­‰ä¸€ç³»åˆ—è¿‡ç¨‹ã€‚ é‚£ä¹ˆå…¶ä¸­çš„é’©å­å‡½æ•°éƒ½æ‹…è´Ÿç€è‡ªå·±çš„èŒè´£ï¼Œè¾ƒä¸ºå¸¸ç”¨çš„å°±æ˜¯createdå’Œmountedå‡½æ•°ï¼Œå¯ä»¥åœ¨å‡½æ•°ä¸­ç¼–å†™ç›¸å…³çš„ä¸šåŠ¡é€»è¾‘ã€‚ é’©å­å‡½æ•°beforeCreateåœ¨å®ä¾‹åˆå§‹åŒ–ä¹‹åï¼Œæ•°æ®è§‚æµ‹å’Œäº‹ä»¶ã€ç”Ÿå‘½å‘¨æœŸåˆå§‹åŒ–é…ç½®ä¹‹å‰è¢«è°ƒç”¨ã€‚ createdå®ä¾‹å·²ç»åˆ›å»ºå®Œæˆä¹‹åè¢«è°ƒç”¨ã€‚åœ¨è¿™ä¸€æ­¥ï¼Œå®ä¾‹å·²å®Œæˆä»¥ä¸‹çš„é…ç½®ï¼šæ•°æ®è§‚æµ‹ï¼Œå±æ€§å’Œæ–¹æ³•çš„è¿ç®—ï¼Œäº‹ä»¶å›è°ƒã€‚ç„¶è€Œï¼ŒæŒ‚è½½é˜¶æ®µè¿˜æ²¡å¼€å§‹ï¼Œ$el å±æ€§ç›®å‰ä¸å¯è§ã€‚ beforeMountåœ¨æŒ‚è½½å¼€å§‹ä¹‹å‰è¢«è°ƒç”¨ï¼šç›¸å…³çš„ render å‡½æ•°é¦–æ¬¡è¢«è°ƒç”¨ï¼Œæ­¤æ—¶æœ‰äº†è™šæ‹ŸDOMã€‚ mountedel è¢«æ–°åˆ›å»ºçš„ vm.$el æ›¿æ¢ï¼Œå¹¶æŒ‚è½½åˆ°å®ä¾‹ä¸Šå»ä¹‹åè°ƒç”¨è¯¥é’©å­ï¼Œæ¸²æŸ“ä¸ºçœŸå®DOMã€‚ beforeUpdateåœ¨æ•°æ®æ›´æ–°ä¹‹å‰æ—¶è°ƒç”¨ï¼Œå‘ç”Ÿåœ¨è™šæ‹Ÿ DOM é‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸ä¹‹å‰ã€‚ ä½ å¯ä»¥åœ¨è¿™ä¸ªé’©å­ä¸­è¿›ä¸€æ­¥åœ°æ›´æ”¹çŠ¶æ€ï¼Œè¿™ä¸ä¼šè§¦å‘é™„åŠ çš„é‡æ¸²æŸ“è¿‡ç¨‹ã€‚ updatedç”±äºæ•°æ®æ›´æ”¹å¯¼è‡´çš„è™šæ‹Ÿ DOM é‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸ï¼Œåœ¨è¿™ä¹‹åä¼šè°ƒç”¨è¯¥é’©å­ã€‚ å½“è¿™ä¸ªé’©å­è¢«è°ƒç”¨æ—¶ï¼Œç»„ä»¶ DOM å·²ç»æ›´æ–°ï¼Œæ‰€ä»¥ä½ ç°åœ¨å¯ä»¥æ‰§è¡Œä¾èµ–äº DOM çš„æ“ä½œã€‚ç„¶è€Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥é¿å…åœ¨æ­¤æœŸé—´æ›´æ”¹çŠ¶æ€ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå¯¼è‡´æ›´æ–°æ— é™å¾ªç¯ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šè¯¥é’©å­åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æœŸé—´ä¸è¢«è°ƒç”¨ã€‚ beforeDestroyå®ä¾‹é”€æ¯ä¹‹å‰è°ƒç”¨ã€‚æ­¤æ—¶ï¼Œå®ä¾‹ä»ç„¶æ˜¯å¯ç”¨çš„ã€‚ destroyedvue å®ä¾‹é”€æ¯åè°ƒç”¨ã€‚è°ƒç”¨åï¼Œvue å®ä¾‹æŒ‡ç¤ºçš„æ‰€æœ‰ä¸œè¥¿éƒ½ä¼šè§£ç»‘ï¼Œæ‰€æœ‰çš„äº‹ä»¶ç›‘å¬å™¨ä¼šè¢«å¸è½½ç§»é™¤ï¼Œæ‰€æœ‰çš„å­å®ä¾‹ä¹Ÿä¼šè¢«é”€æ¯ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼šè¯¥é’©å­åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æœŸé—´ä¸è¢«è°ƒç”¨ã€‚ å‚è€ƒVueJSç”Ÿå‘½å‘¨æœŸ","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"vue","slug":"vue","permalink":"https://luckyship.github.io/tags/vue/"}]},{"title":"jsäº‹ä»¶è¿è¡Œæœºåˆ¶event loop","date":"2020-12-20T03:06:21.000Z","path":"2020/12/20/2020-12-20-js-event-loop/","text":"ä¸ºä»€ä¹ˆä¼šæœ‰event loopjsæ˜¯ä¸€ç§å•çº¿ç¨‹è¿è¡Œæœºåˆ¶ï¼Œå¯ä»¥é¢„è§çš„æ˜¯ï¼Œç”±äºæµè§ˆå™¨è¿è¡Œæœºåˆ¶çš„ç‰¹æ®Šæ€§ï¼Œjsä»¥åå°†ä¸€ç›´ä¼šæ˜¯ä¸€ç§å•çº¿ç¨‹è¯­è¨€ï¼Œå› ä¸ºæœ‰domæ“ä½œçš„æ—¶å€™ï¼Œå¦‚æœå¯ä»¥å¤šçº¿ç¨‹æ“ä½œï¼Œå°±ä¼šè®©æµè§ˆå™¨æ¸²æŸ“å˜å¾—æ··ä¹±ã€‚å•çº¿ç¨‹è¿è¡Œï¼Œæ„å‘³ç€åœ¨åŒä¸€æ—¶é—´ï¼Œåªèƒ½æ‰§è¡Œä¸€ä¸ªè¿›ç¨‹ï¼Œå¯¹äºæŸäº›ä¼šé˜»å¡çš„æœåŠ¡ï¼Œåƒhttpè¯·æ±‚ã€I/Oè®¾å¤‡ï¼Œjsä¼šæŒ‚èµ·è¿™äº›ä»»åŠ¡ï¼Œè®©ä»–ä»¬è¿›å…¥è®¡åˆ’ä»»åŠ¡é‡Œé¢ï¼Œç­‰å¾…æ‰€æœ‰ä¸»è¿›ç¨‹çš„ä»»åŠ¡è¿è¡Œå®Œæ¯•åï¼Œå†æ‰§è¡Œè¢«æŒ‚èµ·çš„ä»»åŠ¡ã€‚ æ‰§è¡Œè¿‡ç¨‹ä»»åŠ¡é˜Ÿåˆ—å­˜åœ¨å¤šä¸ªï¼ŒåŒä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼ŒæŒ‰é˜Ÿåˆ—é¡ºåºè¢«ä¸»çº¿ç¨‹å–èµ°ï¼›ä¸åŒçš„ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå­˜åœ¨ç€ä¼˜å…ˆçº§ï¼Œä¼˜å…ˆçº§é«˜çš„ç°è·å– step1: ä¸»çº¿ç¨‹è¯»å–JSä»£ç ï¼Œæ­¤æ—¶ä¸ºåŒæ­¥ç¯å¢ƒï¼Œå½¢æˆç›¸åº”çš„å †å’Œæ‰§è¡Œæ ˆï¼›step2: ä¸»çº¿ç¨‹é‡åˆ°å¼‚æ­¥ä»»åŠ¡ï¼ŒæŒ‡ç»™å¯¹åº”çš„å¼‚æ­¥è¿›ç¨‹è¿›è¡Œå¤„ç†ï¼ˆWEB APIï¼‰ï¼›step3: å¼‚æ­¥è¿›ç¨‹å¤„ç†å®Œæ¯•ï¼ˆAjaxè¿”å›ï¼ŒDOMäº‹ä»¶å¤„ç†ï¼ŒTimerå®šæ—¶å™¨ç­‰ï¼‰ï¼Œå°†å¯¹åº”çš„å¼‚æ­¥ä»»åŠ¡æ¨å…¥å¼‚æ­¥é˜Ÿåˆ—ä¸­ï¼›step4: ä¸»çº¿ç¨‹æŸ¥è¯¢ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰§è¡Œmicrotask(å®ä»»åŠ¡) queueï¼Œå°†å…¶æŒ‰åºæ‰§è¡Œï¼Œå…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼›step5: ä¸»çº¿ç¨‹æŸ¥è¯¢ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ‰§è¡Œmacrotask(å¾®ä»»åŠ¡) queueï¼Œå°†å…¶æŒ‰åºæ‰§è¡Œï¼Œå…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼›step6: é‡å¤step4ï¼Œ5ï¼› å®ä»»åŠ¡æµè§ˆå™¨ä¸ºäº†èƒ½å¤Ÿä½¿å¾—JSå†…éƒ¨taskä¸DOMä»»åŠ¡èƒ½å¤Ÿæœ‰åºçš„æ‰§è¡Œï¼Œä¼šåœ¨ä¸€ä¸ªtaskæ‰§è¡Œç»“æŸåï¼Œåœ¨ä¸‹ä¸€ä¸ª task æ‰§è¡Œå¼€å§‹å‰ï¼Œå¯¹é¡µé¢è¿›è¡Œé‡æ–°æ¸²æŸ“ ï¼ˆtask-&gt;æ¸²æŸ“-&gt;task-&gt;â€¦ï¼‰é¼ æ ‡ç‚¹å‡»ä¼šè§¦å‘ä¸€ä¸ªäº‹ä»¶å›è°ƒï¼Œéœ€è¦æ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼Œç„¶åè§£æHTMlã€‚ setTimeout çš„ä½œç”¨æ˜¯ç­‰å¾…ç»™å®šçš„æ—¶é—´åä¸ºå®ƒçš„å›è°ƒäº§ç”Ÿä¸€ä¸ªæ–°çš„å®ä»»åŠ¡*ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ‰“å°â€˜setTimeoutâ€™åœ¨â€˜script endâ€™ä¹‹åã€‚å› ä¸ºæ‰“å°â€˜script endâ€™æ˜¯ç¬¬ä¸€ä¸ªå®ä»»åŠ¡é‡Œé¢çš„äº‹æƒ…ï¼Œè€Œâ€˜setTimeoutâ€™æ˜¯å¦ä¸€ä¸ªç‹¬ç«‹çš„ä»»åŠ¡é‡Œé¢æ‰“å°çš„ã€‚ setTimeoutã€setIntervalå’ŒsetImmediateI/Oæ“ä½œã€UIæ¸²æŸ“ã€scriptè„šæœ¬æ‰§è¡ŒMessageChannel(Vueçš„nexttickæœ‰ä½¿ç”¨) å¾®ä»»åŠ¡å¾®ä»»åŠ¡é€šå¸¸æ¥è¯´å°±æ˜¯éœ€è¦åœ¨å½“å‰ task æ‰§è¡Œç»“æŸåç«‹å³æ‰§è¡Œçš„ä»»åŠ¡ï¼Œæ¯”å¦‚å¯¹ä¸€ç³»åˆ—åŠ¨ä½œåšå‡ºåé¦ˆï¼Œæˆ–æˆ–è€…æ˜¯éœ€è¦å¼‚æ­¥çš„æ‰§è¡Œä»»åŠ¡è€Œåˆä¸éœ€è¦åˆ†é…ä¸€ä¸ªæ–°çš„ taskï¼Œè¿™æ ·ä¾¿å¯ä»¥å‡å°ä¸€ç‚¹æ€§èƒ½çš„å¼€é”€ã€‚åªè¦æ‰§è¡Œæ ˆä¸­æ²¡æœ‰å…¶ä»–çš„jsä»£ç æ­£åœ¨æ‰§è¡Œä¸”æ¯ä¸ªå®ä»»åŠ¡æ‰§è¡Œå®Œï¼Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¼šç«‹å³æ‰§è¡Œã€‚å¦‚æœåœ¨å¾®ä»»åŠ¡æ‰§è¡ŒæœŸé—´å¾®ä»»åŠ¡é˜Ÿåˆ—åŠ å…¥äº†æ–°çš„å¾®ä»»åŠ¡ï¼Œä¼šå°†æ–°çš„å¾®ä»»åŠ¡åŠ å…¥é˜Ÿåˆ—å°¾éƒ¨ï¼Œä¹‹åä¹Ÿä¼šè¢«æ‰§è¡Œã€‚å¾®ä»»åŠ¡åŒ…æ‹¬äº† mutation observe çš„å›è°ƒè¿˜æœ‰æ¥ä¸‹æ¥çš„ä¾‹å­ promise çš„å›è°ƒã€‚ promiseMutationObserverprocess.nextTick (Node) å®ä¾‹äº‹ä»¶å¾ªç¯çš„é¡ºåºï¼Œå†³å®šjsä»£ç çš„æ‰§è¡Œé¡ºåºã€‚è¿›å…¥æ•´ä½“ä»£ç (å®ä»»åŠ¡)åï¼Œå¼€å§‹ç¬¬ä¸€æ¬¡å¾ªç¯ã€‚æ¥ç€æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡ã€‚ç„¶åå†æ¬¡ä»å®ä»»åŠ¡å¼€å§‹ï¼Œæ‰¾åˆ°å…¶ä¸­ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—æ‰§è¡Œå®Œæ¯•ï¼Œå†æ‰§è¡Œæ‰€æœ‰çš„å¾®ä»»åŠ¡ã€‚å¬èµ·æ¥æœ‰ç‚¹ç»•ï¼Œæˆ‘ä»¬ç”¨ä¸€æ®µä»£ç è¯´æ˜ï¼š setTimeout(function() &#123; console.log(&#x27;setTimeout&#x27;);&#125;)new Promise(function(resolve) &#123; console.log(&#x27;promise&#x27;);&#125;).then(function() &#123; console.log(&#x27;then&#x27;);&#125;)console.log(&#x27;console&#x27;); è¿™æ®µä»£ç ä½œä¸ºå®ä»»åŠ¡ï¼Œè¿›å…¥ä¸»çº¿ç¨‹ã€‚ å…ˆé‡åˆ°setTimeoutï¼Œé‚£ä¹ˆå°†å…¶å›è°ƒå‡½æ•°æ³¨å†Œååˆ†å‘åˆ°å®ä»»åŠ¡Event Queueã€‚(æ³¨å†Œè¿‡ç¨‹ä¸ä¸ŠåŒï¼Œä¸‹æ–‡ä¸å†æè¿°) æ¥ä¸‹æ¥é‡åˆ°äº†Promiseï¼Œnew Promiseç«‹å³æ‰§è¡Œï¼Œthenå‡½æ•°åˆ†å‘åˆ°å¾®ä»»åŠ¡Event Queueã€‚ é‡åˆ°console.log()ï¼Œç«‹å³æ‰§è¡Œã€‚ å¥½å•¦ï¼Œæ•´ä½“ä»£ç scriptä½œä¸ºç¬¬ä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œç»“æŸï¼Œçœ‹çœ‹æœ‰å“ªäº›å¾®ä»»åŠ¡ï¼Ÿæˆ‘ä»¬å‘ç°äº†thenåœ¨å¾®ä»»åŠ¡Event Queueé‡Œé¢ï¼Œæ‰§è¡Œã€‚ okï¼Œç¬¬ä¸€è½®äº‹ä»¶å¾ªç¯ç»“æŸäº†ï¼Œæˆ‘ä»¬å¼€å§‹ç¬¬äºŒè½®å¾ªç¯ï¼Œå½“ç„¶è¦ä»å®ä»»åŠ¡Event Queueå¼€å§‹ã€‚æˆ‘ä»¬å‘ç°äº†å®ä»»åŠ¡Event Queueä¸­setTimeoutå¯¹åº”çš„å›è°ƒå‡½æ•°ï¼Œç«‹å³æ‰§è¡Œã€‚ ç»“æŸã€‚ æ³¨æ„promiseçš„å¼‚æ­¥æ˜¯æŒ‡ then å’Œ catch , è¿è¡Œåœ¨ promise ä¸­çš„ä»£ç ä¼šè¢«å½“ä½œåŒæ­¥ä»»åŠ¡ å‚è€ƒè¿™ä¸€æ¬¡ï¼Œå½»åº•å¼„æ‡‚ JavaScript æ‰§è¡Œæœºåˆ¶ jsé¢è¯•â€”â€”eventLoop é¢è¯•é¢˜ä¹‹Event Loopç»ˆæç¯‡","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"nginxå®‰è£…é…ç½®","date":"2020-12-16T09:42:39.000Z","path":"2020/12/16/2020-12-16-nginx-config/","text":"å®‰è£…ç¼–è¯‘ä¸‹è½½nginxå®‰è£…åŒ…wget http://nginx.org/download/nginx-1.8.0.tar.gz è§£å‹tar -zxvf nginx-1.8.0.tar.gz å®‰è£…ä¾èµ–yum install -y pcre pcre-devel openssl openssl-devel gcc gcc gcc-c++ ncurses-devel perl ç¼–è¯‘å‰å‡†å¤‡#å°†è¿™å¥æ³¨é‡Šæ‰ å–æ¶ˆDebugç¼–è¯‘æ¨¡å¼ï¼Œåœ¨179è¡Œ vim auto/cc/gcc#CFLAGS=&quot;$CFLAGS -g&quot; é…ç½®$ cd nginx$ ./configure --prefix=/usr/local/nginx --user=www --group=www --with-http_stub_status_module --with-http_ssl_module ç¼–è¯‘ã€å®‰è£…$ make$ make install åˆ›å»ºè½¯è¿æ¥ln -s /usr/local/nginx/sbin/nginx /usr/local/sbin/ nginxé…ç½®ç®€å•é…ç½®server &#123; listen 3333; server_name xx.xxx.xxx.xxx; location / &#123; proxy_pass xxx.xxx.xx.xxx; &#125; location ^~ /asd &#123; # æ­£åˆ™å­—ç¬¦ä¸² proxy_pass xxx.xxx.xx.xxx; &#125;&#125; ç›®å½•è§£æ conf : å­˜æ”¾é…ç½®æ–‡ä»¶html: ç½‘é¡µæ–‡ä»¶logsï¼šå­˜æ”¾æ—¥å¿—sbinï¼šshellå¯åŠ¨ï¼Œåœæ­¢è„šæœ¬ conf/nginx.configæ–‡ä»¶ç»„æˆmain # å…¨å±€é…ç½®events &#123; # nginxå·¥ä½œæ¨¡å¼é…ç½® ....&#125;http &#123; # httpè®¾ç½® .... server &#123; # æœåŠ¡å™¨ä¸»æœºé…ç½® .... location &#123; # è·¯ç”±é…ç½® .... &#125; upstream name &#123; # è´Ÿè½½å‡è¡¡é…ç½® .... &#125;&#125; å¦‚ä¸Šè¿°é…ç½®æ–‡ä»¶æ‰€ç¤ºï¼Œä¸»è¦ç”±6ä¸ªéƒ¨åˆ†ç»„æˆï¼š mainï¼šç”¨äºè¿›è¡Œnginxå…¨å±€ä¿¡æ¯çš„é…ç½®eventsï¼šç”¨äºnginxå·¥ä½œæ¨¡å¼çš„é…ç½®httpï¼šç”¨äºè¿›è¡Œhttpåè®®ä¿¡æ¯çš„ä¸€äº›é…ç½®serverï¼šç”¨äºè¿›è¡ŒæœåŠ¡å™¨è®¿é—®ä¿¡æ¯çš„é…ç½®locationï¼šç”¨äºè¿›è¡Œè®¿é—®è·¯ç”±çš„é…ç½®upstreamï¼šç”¨äºè¿›è¡Œè´Ÿè½½å‡è¡¡çš„é…ç½® serveræ¨¡å—sreveræ¨¡å—é…ç½®æ˜¯httpæ¨¡å—ä¸­çš„ä¸€ä¸ªå­æ¨¡å—ï¼Œç”¨æ¥å®šä¹‰ä¸€ä¸ªè™šæ‹Ÿè®¿é—®ä¸»æœºï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè™šæ‹ŸæœåŠ¡å™¨çš„é…ç½®ä¿¡æ¯ server &#123; listen 80; server_name localhost 192.168.1.100; root /var/www/html; index index.php index.html index.html; charset utf-8; access_log logs/access.log; error_log logs/error.log; ......&#125; æ ¸å¿ƒé…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š serverï¼šä¸€ä¸ªè™šæ‹Ÿä¸»æœºçš„é…ç½®ï¼Œä¸€ä¸ªhttpä¸­å¯ä»¥é…ç½®å¤šä¸ªserverserver_nameï¼šç”¨åŠ›å•ŠæŒ‡å®šipåœ°å€æˆ–è€…åŸŸåï¼Œå¤šä¸ªé…ç½®ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”rootï¼šè¡¨ç¤ºæ•´ä¸ªserverè™šæ‹Ÿä¸»æœºå†…çš„æ ¹ç›®å½•ï¼Œæ‰€æœ‰å½“å‰ä¸»æœºä¸­webé¡¹ç›®çš„æ ¹ç›®å½•indexï¼šç”¨æˆ·è®¿é—®webç½‘ç«™æ—¶çš„å…¨å±€é¦–é¡µcharsetï¼šç”¨äºè®¾ç½®www/è·¯å¾„ä¸­é…ç½®çš„ç½‘é¡µçš„é»˜è®¤ç¼–ç æ ¼å¼access_logï¼šç”¨äºæŒ‡å®šè¯¥è™šæ‹Ÿä¸»æœºæœåŠ¡å™¨ä¸­çš„è®¿é—®è®°å½•æ—¥å¿—å­˜æ”¾è·¯å¾„error_logï¼šç”¨äºæŒ‡å®šè¯¥è™šæ‹Ÿä¸»æœºæœåŠ¡å™¨ä¸­è®¿é—®é”™è¯¯æ—¥å¿—çš„å­˜æ”¾è·¯å¾„ locationæ¨¡å—location æ¨¡å—æ˜¯ nginx é…ç½®ä¸­å‡ºç°æœ€å¤šçš„ä¸€ä¸ªé…ç½®ï¼Œä¸»è¦ç”¨äºé…ç½®è·¯ç”±è®¿é—®ä¿¡æ¯åœ¨è·¯ç”±è®¿é—®ä¿¡æ¯é…ç½®ä¸­å…³è”åˆ°åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ç­‰ç­‰å„é¡¹åŠŸèƒ½ï¼Œæ‰€ä»¥ location æ¨¡å—ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„é…ç½®æ¨¡å—åŸºæœ¬é…ç½® location / &#123; root /nginx/www; index index.php index.html index.htm;&#125; nginxå¯åŠ¨å¯åŠ¨# é»˜è®¤ä¸ºnginx.conf$ ./nginx# ä»¥å…¶ä»–çš„configæ¥æ‰§è¡Œnginxï¼Œ$ /usr/local/nginx/sbin/nginx -c conf/nginx.conf åˆ·æ–°é…ç½®$ ./nginx -s reload é‡å¯é…ç½®$ /usr/local/nginx/sbin/nginx -s reopen åœæ­¢$ ./nginx -s stop$ ./nginx -s quit# æ€æ­»nginxçš„è¿›ç¨‹$ kill -s 9 å‚è€ƒNginxå®‰è£…åŠé…ç½®è¯¦ç»†æ•™ç¨‹","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"nginx","slug":"nginx","permalink":"https://luckyship.github.io/tags/nginx/"}]},{"title":"hls.jsæ’­æ”¾hlsç›´æ’­æº","date":"2020-12-15T05:15:32.000Z","path":"2020/12/15/2020-12-15-hls-js-video-md/","text":"video.jså’Œhls.jsçš„åŒºåˆ«å’Œä¼˜ç¼ºç‚¹video.jsï¼šä¼˜ç‚¹ï¼šåŠŸèƒ½æ¯”è¾ƒå¼ºå¤§ï¼Œæœ‰å¾ˆå¤šåŠŸèƒ½å°è£…å¥½äº†ï¼Œè€Œä¸”æœ‰è‡ªå·±çš„ä¸€å¥—UIï¼Œåœ¨ä¸åŒæµè§ˆå™¨ä¸‹æ˜¾ç¤ºæ¯”è¾ƒä¸€è‡´ç¼ºç‚¹ï¼šåŒ…æ¯”è¾ƒå¤§ï¼Œå®ç°hlsç›´æ’­çš„æ—¶å€™å…¶å®æ˜¯å†…åµŒäº†hls.jsçš„ä»£ç ï¼Œå®é™…ä¸Šæ˜¯è¿ç”¨äº†hls.jsï¼Œè€Œä¸”ç”±äºå°è£…çš„uiå’ŒåŠŸèƒ½ï¼Œä½¿å…¶ä¸å¤Ÿçº¯å‡€ï¼Œä¸å¤Ÿçµæ´»ï¼Œä¿®æ”¹uiçš„æ—¶å€™è¦ç”¨åˆ°å…¶ä»–çš„æ’ä»¶ï¼Œæœ‰ç‚¹ç”»è›‡æ·»è¶³çš„æ„Ÿè§‰ hls.jsï¼šä¼˜ç‚¹ï¼šåŒ…æ¯”è¾ƒå°ï¼Œå¾ˆçº¯å‡€ï¼ŒUIå¯ä»¥æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡è‡ªæ‰©å±•ï¼Œè‡ªå·±å°è£…åŠŸèƒ½å’ŒUIï¼Œæ¯”è¾ƒåˆ‡åˆè‡ªå·±å¼€å‘çš„ç›´æ’­æ’­æ”¾å™¨ï¼Œè€Œä¸”ä¸“ä¸šç›´æ’­HLSç¼ºç‚¹ï¼šæ²¡æœ‰å°è£…å¥½çš„UIï¼ŒåŠŸèƒ½ä¸Šä¹Ÿéœ€è¦è‡ªå·±å»å®ç° hls.jsæ’­æ”¾hlsç›´æ’­æº &lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;hls.js&lt;/title&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;./index.css&quot;&gt; &lt;script src=&quot;https://cdn.jsdelivr.net/npm/hls.js@latest&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;video id=&quot;video&quot; controls&gt;&lt;/video&gt; &lt;script src=&quot;./index.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; index.js var Hls = window.Hlsvar url = &#x27;http://localhost:8765/hls/movie.m3u8&#x27;var video = document.getElementById(&#x27;video&#x27;)if (Hls.isSupported()) &#123; var hls = new Hls() hls.loadSource(url) hls.attachMedia(video) hls.on(Hls.Events.MANIFEST_PARSED, function() &#123; // video.play() &#125;)&#125; else if (video.canPlayType(&#x27;application/vnd.apple.mpegurl&#x27;)) &#123; video.src = url video.addEventListener(&#x27;canplay&#x27;, function() &#123; // video.play() &#125;)&#125;","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"video","slug":"video","permalink":"https://luckyship.github.io/tags/video/"}]},{"title":"jså°æŠ€å·§","date":"2020-12-14T08:22:02.000Z","path":"2020/12/14/2020-12-14-js-knowledge-md/","text":"æŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­æŸä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°let str = &quot;21312312312312&quot;console.log(str.split(&quot;1&quot;).length - 1) jsæ­£åˆ™åŒ¹é…å¿«é€Ÿä½¿ç”¨åŒ¹é…é¡¹let tel = &quot;13122223333&quot;;let reg = /^(\\d&#123;3&#125;)\\d&#123;4&#125;(\\d&#123;4&#125;)$/;tel = tel.replace(reg, &quot;$1****$2&quot;); æœ€å¤§å…¬çº¦æ•°const gcd = (x, y) =&gt; !y ? x : gcd(y, x % y); è‡ªé€‚åº”å•ä½vwï¼š1vwç­‰äºè§†å£å®½åº¦çš„1%ã€‚ vhï¼š1vhç­‰äºè§†å£é«˜åº¦çš„1%ã€‚ vminï¼šé€‰å–vwå’Œvhä¸­æœ€å°çš„é‚£ä¸ªã€‚ vmaxï¼šé€‰å–vwå’Œvhä¸­æœ€å¤§çš„é‚£ä¸ª CSSç™¾åˆ†æ¯”æ˜¯ç›¸å¯¹äºåŒ…å«å®ƒçš„æœ€è¿‘çš„çˆ¶å…ƒç´ çš„é«˜åº¦å’Œå®½åº¦ blurå’Œclickå†²çªåœºæ™¯ï¼šå¹³æ—¶åšè¡¨å•éªŒè¯çš„æ—¶å€™ä¸€èˆ¬éƒ½æœ‰ä¸ªinputæ¡†å’Œåˆ é™¤æŒ‰é’®ï¼Œç„¶åä¹ æƒ¯æ€§åœ¨å¤±å»ç„¦ç‚¹çš„æ—¶å€™&gt; å»éªŒè¯è¾“å…¥çš„å†…å®¹æ˜¯å¦æ­£ç¡®ï¼ŒåšéªŒè¯ï¼Œå‘è¯·æ±‚ç­‰ç­‰ã€‚ è¿™ä¸ªæ—¶å€™ï¼Œé‚£ä¸ªç‚¹å‡»åˆ é™¤æŒ‰é’®å¾€å¾€ä¹Ÿå°±è§¦å‘äº†inputçš„å¤±å»ç„¦ç‚¹äº‹ä»¶ ç»™å¤±å»ç„¦ç‚¹çš„æ—¶é—´åŠ ä¸Šå»¶è¿Ÿæ—¶é—´ï¼Œè®©bluræ—¶é—´åœ¨clickäº‹ä»¶åæ‰§è¡Œï¼Œè¿™ä¸ªæ–¹æ³•å›ºç„¶èƒ½å¤Ÿè§£å†³é—®é¢˜ï¼Œä½†æ˜¯æœ¬äººå¹¶ä¸æ˜¯å¾ˆæ¨èï¼Œå› ä¸ºå½±å“æ€§èƒ½ï¼Œä¸åˆ°æœ€åä¸ç”¨è¿™ä¸ªæ–¹æ³•ï¼›event.relatedTarget.idäº‹ä»¶å±æ€§è¿”å›ä¸äº‹ä»¶çš„ç›®æ ‡èŠ‚ç‚¹ç›¸å…³çš„èŠ‚ç‚¹ã€‚ï¼ˆéIEï¼‰mousedownäº‹ä»¶æ›¿ä»£å¤„ç†clickäº‹ä»¶ éšæœºæ•°// [0,1) å·¦é—­å³å¼€ min-max Math.floor(min + Math.random() * (max - min + 1))// toString() this is objectæ–¹æ³• toString() valueOf// éšæœºé¢œè‰²item.style.backgroundColor = &#x27;#&#x27; + Math.random().toString(16).slice(2, 8);// &quot;#&quot; + (&quot;00000&quot; + ((Math.random() * 0x1000000) &lt;&lt; 0).toString(16)).slice(-6) äº¤æ¢ä¸¤ä¸ªæ•°çš„å€¼// åŠ å‡è¿ç®— ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œæ•´å‹æ•°æ®æº¢å‡ºï¼Œå¯¹äº32ä½å­—ç¬¦æœ€å¤§è¡¨ç¤ºæ•°å­—æ˜¯2147483647ï¼Œå¦‚æœæ˜¯2147483645å’Œ2147483646äº¤æ¢å°±å¤±è´¥äº†ã€‚var a = 1, b = 2;a += b;b = a - b;a -= b;// ç¬¬ä¸‰ä¸ªä¸´æ—¶å˜é‡var a = 1, b = 2;var temp = a;a = b;b = temp;// ä½è¿ç®—let a = 3, b = 4;a ^= b;b ^= a;a ^= b;// es6let a = 1, b = 2;[a, b] = [b, a]; ä½¿ç”¨Booleanè¿‡æ»¤æ•°ç»„ä¸­çš„å‡å€¼const compact = arr =&gt; arr.filter(Boolean)compact([0, 1, false, 2, &#x27;&#x27;, 3, &#x27;a&#x27;, &#x27;e&#x27; * 23, NaN, &#x27;s&#x27;, 34]) // // [ 1, 2, 3, &#x27;a&#x27;, &#x27;s&#x27;, 34 ] base64åŠ å¯†let encodedData = window.btoa(&quot;Hello, world&quot;); // ç¼–ç let decodedData = window.atob(encodedData); // è§£ç  å¦‚æœå­—ç¬¦ä¸²æ˜¯unicodeå­—ç¬¦ä¸²ï¼Œåˆ™éœ€è¦å¯¹å…¶è½¬ç ï¼Œé€šå¸¸ä½¿ç”¨escapeå’Œunescape // ucs-2 string to base64 encoded asciifunction utoa(str) &#123; return window.btoa(unescape(encodeURIComponent(str)));&#125;// base64 encoded ascii to ucs-2 stringfunction atou(str) &#123; return decodeURIComponent(escape(window.atob(str)));&#125;// Usage:utoa(&#x27;âœ“ Ã  la mode&#x27;); // 4pyTIMOgIGxhIG1vZGU=atou(&#x27;4pyTIMOgIGxhIG1vZGU=&#x27;); // &quot;âœ“ Ã  la mode&quot;utoa(&#x27;I \\u2661 Unicode!&#x27;); // SSDimaEgVW5pY29kZSE=atou(&#x27;SSDimaEgVW5pY29kZSE=&#x27;); // &quot;I â™¡ Unicode!&quot; æ•°ç»„åˆå¹¶çš„å‡ ç§æ–¹æ³•// å››ç§æ–¹æ³•ã€‚var arr1 = [1, 2, 3];var arr2 = [4, 5, 6];arr1 = arr1.concat(arr2);console.log(arr1);var arr1 = [1, 2, 3];var arr2 = [4, 5, 6];Array.prototype.push.apply(arr1, arr2);console.log(arr1);var arr1 = [1, 2, 3];var arr2 = [4, 5, 6];for (var i = 0; i &lt; arr2.length; i++) &#123; arr1.push(arr2[i]);&#125;console.log(arr1);var arr1 = [1, 2, 3];var arr2 = [4, 5, 6];arr1.push(...arr2) è¿›åˆ¶è½¬æ¢parseInt è½¬æ¢ä¸º10è¿›åˆ¶ï¼Œ toString() ä½œè¿›åˆ¶è½¬æ¢ // eg. 8-bit hexadecimal =&gt; Binary FFFFFFFF =&gt; 11111111111111111111111111111111const chars = parseInt(char, 16).toString(2).padStart(32, &#x27;0&#x27;); é©¼å³°è½¬æ¢const regExp = /_(\\w)/g;&#x27;operation_status_graph_file_download&#x27;.replace(regExp, ($0, $1) =&gt; $1.toUpperCase()); åˆ¤æ–­2ä¸ªå¯¹è±¡ç›¸ç­‰åˆ©ç”¨ JSON æ–¹æ³•è½¬æ¢ä¸ºå­—ç¬¦ä¸² JSON.stringify(obj) == JSON.stringify(obj2); //trueJSON.stringify(obj) == JSON.stringify(obj3); //false","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"npmå®‰è£…é…ç½®","date":"2020-12-01T08:49:16.000Z","path":"2020/12/01/2020-12-01-npm-install-md/","text":"linux å®‰è£…tar -zvxf node-v14.tar.gzln -s /node-v14/bin/npm /usr/bin/npmln -s /node-v14/bin/npm /usr/local/bin/npm æŸ¥çœ‹ npm é…ç½®npm config list ä»£ç†è®¾ç½®npm config set proxy=http://127.0.0.1:8087npm config set https-proxy http://127.0.0.1:8087// éœ€è¦ç”¨æˆ·åå’Œå¯†ç npm config set proxy http://username:password@server:portnpm confit set https-proxy http://username:password@server:port// å–æ¶ˆä»£ç†npm config delete proxynpm config delete https-proxy npm å®‰è£…è®¾ç½®npm config set strict-ssl false // SSLé”™è¯¯npm config get registry // æŸ¥çœ‹å½“å‰æºnpm config set registry https://registry.npmmirror.com/ // è®¾ç½®æ·˜å®æº(å·²æ›´æ–°)npm config set registry https://registry.npmjs.org/ // è®¾ç½®å®˜æ–¹æºnpm config set sass_binary_site https://registry.npmmirror.com/mirrors/node-sass/npm config set chromedriver_cdnurl https://cdn.npm.taobao.org/dist/chromedrivernpm config set electron_mirror https://registry.npmmirror.com/mirrors/electron/yarn config set chromedriver_cdnurl https://cdn.npm.taobao.org/dist/chromedriveryarn config set electron_mirror https://registry.npmmirror.com/mirrors/electron/yarn config set registry https://registry.npmmirror.com//yarn config set registry https://registry.yarnpkg.comyarn config set sass_binary_site https://registry.npmmirror.com/mirrors/node-sass/yarn config set phantomjs_cdnurl http://cnpmjs.org/downloadsyarn config set sqlite3_binary_host_mirror https://foxgis.oss-cn-shanghai.aliyuncs.com/yarn config set profiler_binary_host_mirror https://registry.npmmirror.com/mirrors/node-inspector/ æ·˜å®æºå·²æ›´æ–°æˆï¼šhttps://registry.npmmirror.com/ npm i å’Œ npm install çš„å°åŒºåˆ« ç”¨npm i å®‰è£…çš„æ¨¡å—æ— æ³•ç”¨npm uninstallå¸è½½ï¼Œéœ€è¦ç”¨npm uninstall iå‘½ä»¤ npm i ä¼šå¸®åŠ©æ£€æµ‹ä¸å½“å‰ node ç‰ˆæœ¬æœ€åŒ¹é…çš„ npm åŒ… ç‰ˆæœ¬å·ï¼Œå¹¶åŒ¹é…å‡ºæ¥ç›¸äº’ä¾èµ–çš„ npm åŒ…åº”è¯¥æå‡çš„ç‰ˆæœ¬å· éƒ¨åˆ†npmåŒ…åœ¨å½“å‰ node ç‰ˆæœ¬ä¸‹æ— æ³•ä½¿ç”¨ï¼Œå¿…é¡»ä½¿ç”¨å»ºè®®ç‰ˆæœ¬ å®‰è£…æŠ¥é”™æ—¶ intall è‚¯å®šä¼šå‡ºç°npm-debug.log æ–‡ä»¶ï¼Œnpm iä¸ä¸€å®š npm install çš„æ‰§è¡Œè¿‡ç¨‹ å‘å‡ºnpm installå‘½ä»¤ æŸ¥è¯¢ node_modules ç›®å½•ä¹‹ä¸­æ˜¯å¦å·²ç»å­˜åœ¨æŒ‡å®šæ¨¡å— è‹¥å­˜åœ¨ï¼Œä¸å†é‡æ–°å®‰è£… è‹¥ä¸å­˜åœ¨npm å‘ registry æŸ¥è¯¢æ¨¡å—å‹ç¼©åŒ…çš„ç½‘å€ä¸‹è½½å‹ç¼©åŒ…ï¼Œå­˜æ”¾åœ¨æ ¹ç›®å½•ä¸‹çš„.npm ç›®å½•é‡Œ è§£å‹å‹ç¼©åŒ…åˆ°å½“å‰é¡¹ç›®çš„ node_modules ç›®å½• å¦‚æœæœ‰ package-lock.jsonï¼Œä¼šä¼˜å…ˆæŒ‰ç…§ package-lock.json ä¸­çš„ç‰ˆæœ¬æ¥å®‰è£…åŒ… npm ä¸­çš„ç‰ˆæœ¬æŒ‡å®šæ–¹å¼ æŒ‡å®šç‰ˆæœ¬ï¼šæ¯”å¦‚ 1.2.2 ï¼Œéµå¾ªâ€œå¤§ç‰ˆæœ¬.æ¬¡è¦ç‰ˆæœ¬.å°ç‰ˆæœ¬â€çš„æ ¼å¼è§„å®šï¼Œå®‰è£…æ—¶åªå®‰è£…æŒ‡å®šç‰ˆæœ¬ã€‚ æ³¢æµªå·ï¼ˆtildeï¼‰+æŒ‡å®šç‰ˆæœ¬ï¼šæ¯”å¦‚ ~1.2.2 ï¼Œè¡¨ç¤ºå®‰è£… 1.2.x çš„æœ€æ–°ç‰ˆæœ¬ï¼ˆä¸ä½äº 1.2.2ï¼‰ï¼Œä½†æ˜¯ä¸å®‰è£… 1.3.xï¼Œä¹Ÿå°±æ˜¯è¯´å®‰è£…æ—¶ä¸æ”¹å˜å¤§ç‰ˆæœ¬å·å’Œæ¬¡è¦ç‰ˆæœ¬å·ã€‚ æ’å…¥å·ï¼ˆcaretï¼‰+æŒ‡å®šç‰ˆæœ¬ï¼šæ¯”å¦‚ Ë†1.2.2ï¼Œè¡¨ç¤ºå®‰è£… 1.x.x çš„æœ€æ–°ç‰ˆæœ¬ï¼ˆä¸ä½äº 1.2.2ï¼‰ï¼Œä½†æ˜¯ä¸å®‰è£… 2.x.xï¼Œä¹Ÿå°±æ˜¯è¯´å®‰è£…æ—¶ä¸æ”¹å˜å¤§ç‰ˆæœ¬å·ã€‚éœ€è¦æ³¨æ„çš„- æ˜¯ï¼Œå¦‚æœå¤§ç‰ˆæœ¬å·ä¸º 0ï¼Œåˆ™æ’å…¥å·çš„è¡Œä¸ºä¸æ³¢æµªå·ç›¸åŒï¼Œè¿™æ˜¯å› ä¸ºæ­¤æ—¶å¤„äºå¼€å‘é˜¶æ®µï¼Œå³ä½¿æ˜¯æ¬¡è¦ç‰ˆæœ¬å·å˜åŠ¨ï¼Œä¹Ÿå¯èƒ½å¸¦æ¥ç¨‹åºçš„ä¸å…¼å®¹ã€‚ latestï¼šå®‰è£…æœ€æ–°ç‰ˆæœ¬ã€‚ package.lock çš„ä½œç”¨5.0.x ç‰ˆæœ¬ï¼šä¸ç®¡ package.json ä¸­ä¾èµ–æ˜¯å¦æœ‰æ›´æ–°ï¼Œnpm install éƒ½ä¼šæ ¹æ® package-lock.json ä¸‹è½½ã€‚é’ˆå¯¹è¿™ç§å®‰è£…ç­–ç•¥ï¼Œæœ‰äººæå‡ºäº†è¿™ä¸ª issue[6] ï¼Œç„¶åå°±æ¼”å˜æˆäº† 5.1.0 ç‰ˆæœ¬åçš„è§„åˆ™ã€‚ 5.1.0 ç‰ˆæœ¬åï¼šå½“ package.json ä¸­çš„ä¾èµ–é¡¹æœ‰æ–°ç‰ˆæœ¬æ—¶ï¼Œnpm install ä¼šæ— è§† package-lock.json å»ä¸‹è½½æ–°ç‰ˆæœ¬çš„ä¾èµ–é¡¹å¹¶ä¸”æ›´æ–° package-lock.jsonã€‚é’ˆå¯¹è¿™ç§å®‰è£…ç­–ç•¥ï¼Œåˆæœ‰äººæå‡ºäº†ä¸€ä¸ª issue[7] å‚è€ƒ npm è´¡çŒ®è€… iarna çš„è¯„è®ºï¼Œå¾—å‡º 5.4.2 ç‰ˆæœ¬åçš„è§„åˆ™ã€‚ 5.4.2 ç‰ˆæœ¬åï¼šå¦‚æœåªæœ‰ä¸€ä¸ª package.json æ–‡ä»¶ï¼Œè¿è¡Œ npm install ä¼šæ ¹æ®å®ƒç”Ÿæˆä¸€ä¸ª package-lock.json æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ç›¸å½“äºæœ¬æ¬¡ install çš„ä¸€ä¸ªå¿«ç…§ï¼Œå®ƒä¸ä»…è®°å½•äº† package.json æŒ‡æ˜çš„ç›´æ¥ä¾èµ–çš„ç‰ˆæœ¬ï¼Œä¹Ÿè®°å½•äº†é—´æ¥ä¾èµ–çš„ç‰ˆæœ¬ã€‚ å¦‚æœ package.json çš„ semver-range version å’Œ package-lock.json ä¸­ç‰ˆæœ¬å…¼å®¹(package-lock.json ç‰ˆæœ¬åœ¨ package.json æŒ‡å®šçš„ç‰ˆæœ¬èŒƒå›´å†…)ï¼Œå³ä½¿æ­¤æ—¶ package.json ä¸­æœ‰æ–°çš„ç‰ˆæœ¬ï¼Œæ‰§è¡Œ npm install ä¹Ÿè¿˜æ˜¯ä¼šæ ¹æ® package-lock.json ä¸‹è½½ã€‚ å¦‚æœæ‰‹åŠ¨ä¿®æ”¹äº† package.json çš„ version rangesï¼Œä¸”å’Œ package-lock.json ä¸­ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œé‚£ä¹ˆæ‰§è¡Œ npm install æ—¶ package-lock.json å°†ä¼šæ›´æ–°åˆ°å…¼å®¹ package.json çš„ç‰ˆæœ¬ã€‚ yarnyarn çš„å‡ºç°ä¸»è¦ç›®æ ‡æ˜¯è§£å†³ç”±äºè¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶è€Œå¯¼è‡´çš„ npm å®‰è£…çš„ä¸ç¡®å®šæ€§é—®é¢˜ã€‚è™½ç„¶å¯ä»¥ä½¿ç”¨ npm shrinkwrap æ¥å®ç°å¯é¢„æµ‹çš„ä¾èµ–å…³ç³»æ ‘ï¼Œä½†å®ƒå¹¶ä¸æ˜¯é»˜è®¤é€‰é¡¹ï¼Œè€Œæ˜¯å–å†³äºæ‰€æœ‰çš„å¼€å‘äººå‘˜çŸ¥é“å¹¶ä¸”å¯ç”¨è¿™ä¸ªé€‰é¡¹ã€‚yarn é‡‡å–äº†ä¸åŒçš„åšæ³•ã€‚æ¯ä¸ª yarn å®‰è£…éƒ½ä¼šç”Ÿæˆä¸€ä¸ªç±»ä¼¼äºnpm-shrinkwrap.json çš„ yarn.lock æ–‡ä»¶ï¼Œè€Œä¸”å®ƒæ˜¯é»˜è®¤åˆ›å»ºçš„ã€‚é™¤äº†å¸¸è§„ä¿¡æ¯ä¹‹å¤–ï¼Œyarn.lock æ–‡ä»¶è¿˜åŒ…å«è¦å®‰è£…çš„å†…å®¹çš„æ ¡éªŒå’Œï¼Œä»¥ç¡®ä¿ä½¿ç”¨çš„åº“çš„ç‰ˆæœ¬ç›¸åŒã€‚ yarn çš„ä¸»è¦ä¼˜åŒ–yarn çš„å‡ºç°ä¸»è¦åšäº†å¦‚ä¸‹ä¼˜åŒ–ï¼š å¹¶è¡Œå®‰è£…ï¼šæ— è®º npm è¿˜æ˜¯ yarn åœ¨æ‰§è¡ŒåŒ…çš„å®‰è£…æ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œä¸€ç³»åˆ—ä»»åŠ¡ã€‚npm æ˜¯æŒ‰ç…§é˜Ÿåˆ—æ‰§è¡Œæ¯ä¸ª packageï¼Œä¹Ÿå°±æ˜¯è¯´å¿…é¡»è¦ç­‰åˆ°å½“å‰ package å®‰è£…å®Œæˆä¹‹åï¼Œæ‰èƒ½ç»§ç»­åé¢çš„å®‰è£…ã€‚è€Œ yarn æ˜¯åŒæ­¥æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡ï¼Œæé«˜äº†æ€§èƒ½ã€‚ ç¦»çº¿æ¨¡å¼ï¼šå¦‚æœä¹‹å‰å·²ç»å®‰è£…è¿‡ä¸€ä¸ªè½¯ä»¶åŒ…ï¼Œç”¨ yarn å†æ¬¡å®‰è£…æ—¶ä¹‹é—´ä»ç¼“å­˜ä¸­è·å–ï¼Œå°±ä¸ç”¨åƒ npm é‚£æ ·å†ä»ç½‘ç»œä¸‹è½½äº†ã€‚ å®‰è£…ç‰ˆæœ¬ç»Ÿä¸€ï¼šä¸ºäº†é˜²æ­¢æ‹‰å–åˆ°ä¸åŒçš„ç‰ˆæœ¬ï¼Œyarn æœ‰ä¸€ä¸ªé”å®šæ–‡ä»¶ (lock file) è®°å½•äº†è¢«ç¡®åˆ‡å®‰è£…ä¸Šçš„æ¨¡å—çš„ç‰ˆæœ¬å·ã€‚æ¯æ¬¡åªè¦æ–°å¢äº†ä¸€ä¸ªæ¨¡å—ï¼Œyarn å°±ä¼šåˆ›å»ºï¼ˆæˆ–æ›´æ–°ï¼‰yarn.lock è¿™ä¸ªæ–‡ä»¶ã€‚è¿™ä¹ˆåšå°±ä¿è¯äº†ï¼Œæ¯ä¸€æ¬¡æ‹‰å–åŒä¸€ä¸ªé¡¹ç›®ä¾èµ–æ—¶ï¼Œä½¿ç”¨çš„éƒ½æ˜¯ä¸€æ ·çš„æ¨¡å—ç‰ˆæœ¬ã€‚ æ›´å¥½çš„è¯­ä¹‰åŒ–ï¼šyarn æ”¹å˜äº†ä¸€äº› npm å‘½ä»¤çš„åç§°ï¼Œæ¯”å¦‚ yarn add/removeï¼Œæ¯” npm åŸæœ¬çš„ install/uninstall è¦æ›´æ¸…æ™°ã€‚ å‚è€ƒ","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"nodejs","slug":"nodejs","permalink":"https://luckyship.github.io/tags/nodejs/"},{"name":"npm","slug":"npm","permalink":"https://luckyship.github.io/tags/npm/"}]},{"title":"jqueryç›‘å¬ajaxäº‹ä»¶","date":"2020-12-01T08:35:05.000Z","path":"2020/12/01/2020-12-01-jquery-subscribe-ajax-event-md/","text":"jQuery.ajaxComplete()å›è°ƒå‡½æ•°handleræœ‰3ä¸ªå‚æ•°ï¼šå…¶ä¸€æ˜¯è¡¨ç¤ºå½“å‰äº‹ä»¶çš„ Event å¯¹è±¡ï¼Œå…¶äºŒæ˜¯å‘é€å½“å‰AJAXè¯·æ±‚çš„ jqXHR å¯¹è±¡ï¼Œå…¶ä¸‰æ˜¯åŒ…å«ä¸ºæœ¬æ¬¡ AJAX è¯·æ±‚è®¾ç½®çš„æ‰€æœ‰å‚æ•°é€‰é¡¹(åŒ…æ‹¬æ— éœ€æŒ‡å®šçš„é»˜è®¤å‚æ•°é€‰é¡¹)çš„ Object å¯¹è±¡ã€‚ ä»jQuery 1.8å¼€å§‹ï¼ŒajaxCompleteäº‹ä»¶çš„å¤„ç†å‡½æ•°å¿…é¡»ç»‘å®šåˆ°documentå¯¹è±¡ä¸Šæ‰èƒ½ç”Ÿæ•ˆã€‚ å¦‚æœåœ¨jQuery.ajax()æˆ–jQuery.ajaxSetup()ä¸­å°†é€‰é¡¹å‚æ•°globalè®¾ä¸ºfalseï¼Œå¯ä»¥ç¦æ­¢è¯¥AJAXè¯·æ±‚è§¦å‘å…¨å±€çš„AJAXäº‹ä»¶ã€‚ å› æ­¤ï¼Œä¸è®ºå½“å‰jQueryä¸ºä½•ç‰ˆæœ¬ï¼Œå¦‚æœä¸æ˜¯ç‰¹æ®Šéœ€æ±‚ï¼Œæˆ‘ä»¬éƒ½åº”è¯¥å°†ajaxCompleteäº‹ä»¶çš„å¤„ç†å‡½æ•°ç»‘å®šåˆ°documentå¯¹è±¡ä¸Šã€‚ $(document).ajaxComplete(function(event, jqXHR, options) &#123; alert(&quot;å¤„ç†å‡½æ•°1ï¼šè¯·æ±‚çš„urlä¸º&quot; + options.url);&#125;);$(document).ajaxComplete(function(event, jqXHR, options) &#123; alert(&quot;å¤„ç†å‡½æ•°2ï¼šè¯·æ±‚æ–¹å¼ä¸º&quot; + options.type);&#125;);// æ‰§è¡Œè¯¥AJAXè¯·æ±‚ï¼Œä¼šå¼¹å‡º2æ¬¡å¯¹è¯æ¡†// å› ä¸ºdocumentå¯¹è±¡ä¸Šç»‘å®šäº†2ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°$.ajax(&#123; url: &quot;index.html&quot; // , global: false // å¯ä»¥ç¦æ­¢è§¦å‘å…¨å±€çš„Ajaxäº‹ä»¶&#125;);// æ‰§è¡Œè¯¥AJAXè¯·æ±‚ï¼Œä¼šå¼¹å‡º3æ¬¡å¯¹è¯æ¡†// å› ä¸º$.ajax()è‡ªå·±é€šè¿‡completeé€‰é¡¹ç»‘å®šäº†ä¸€ä¸ªå±€éƒ¨çš„ajaxCompleteäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œå®ƒä¹Ÿåœ¨documentå¯¹è±¡ä¸Šï¼Œä¼šæ‰§è¡Œä¸€æ¬¡// æˆ‘ä»¬è¿˜é€šè¿‡ajaxComplete()é¢å¤–ç»‘å®šäº†ä¸¤ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œä¼šå†å¼¹å‡º2æ¬¡$.ajax(&#123; url: &quot;myurl&quot;, complete: function(jqXHR, textStatus) &#123; // jqXHR æ˜¯ç»è¿‡jQueryå°è£…çš„XMLHttpRequestå¯¹è±¡ // textStatus å¯èƒ½ä¸ºï¼šnullã€&#x27;success&#x27;ã€ &#x27;notmodified&#x27;ã€ &#x27;error&#x27;ã€ &#x27;timeout&#x27;ã€ &#x27;abort&#x27;æˆ–&#x27;parsererror&#x27;ç­‰ alert(&quot;ajax()&quot;); &#125; // , global: false // å¯ä»¥ç¦æ­¢è§¦å‘å…¨å±€çš„Ajaxäº‹ä»¶&#125;); å‚è€ƒåŸåˆ› jQuery.ajaxComplete() å‡½æ•°è¯¦è§£ jQuery.ajaxComplete() å‡½æ•°è¯¦è§£","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"jquery","slug":"jquery","permalink":"https://luckyship.github.io/tags/jquery/"}]},{"title":"ä½¿ç”¨es6-setæ•°ç»„å»é‡","date":"2020-12-01T01:48:04.000Z","path":"2020/12/01/2020-12-01-es6-uniq/","text":"ä½¿ç”¨ set å»é‡Array.from æ˜¯ es6 ç”¨æ³•ï¼Œå°†ç±»æ•°ç»„è½¬æ¢ä¸ºæ•°ç»„ let a = [1, 1, 2, 3, 3, 4, 4];//undefinedArray.from(new Set(a));// [1, 2, 3, 4] ä¸€èˆ¬å»é‡æ–¹æ³•å…¼å®¹æ€§å¥½ï¼Œå¯ä¸ç”¨æ”¯æŒ es6 è¯­æ³• function unique(arr) &#123; var newArr = []; for (var i = 0; i &lt; arr.length; i++) &#123; if (newArr.indexOf(arr[i]) == -1) &#123; newArr.push(arr[i]); &#125; &#125; return newArr;&#125;var arr = [1, 2, 2, 3, 4, 4, 5, 1, 3];var newArr = unique(arr);console.log(newArr); ä½¿ç”¨ filter æ–¹æ³• function unique(arr) &#123; return arr.filter((item, index, array) =&gt; &#123; return array.indexOf(item) === index; &#125;);&#125;var arr = [1, 2, 2, 3, 4, 4, 5, 1, 3];var newArr = unique(arr);console.log(newArr);","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"es6","slug":"es6","permalink":"https://luckyship.github.io/tags/es6/"}]},{"title":"jsæµ®ç‚¹æ•°è®¡ç®—","date":"2020-12-01T01:48:04.000Z","path":"2020/12/01/2020-12-01-js-float-calculate/","text":"å› ä¸ºè®¡ç®—æœºçš„ç‰¹æ€§ï¼Œæµ®ç‚¹æ•°è®¡ç®—å¾ˆå¤šæ—¶å€™ä¸ä¼šç­‰äºæˆ‘ä»¬æƒ³è¦çš„å€¼ &gt; 0.1 + 0.20.30000000000000004 &gt; 0.7 / 100.06999999999999999 åŸå› JavaScript å†…éƒ¨åªæœ‰ä¸€ç§æ•°å­—ç±»å‹ Number ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ JavaScript è¯­è¨€çš„åº•å±‚æ ¹æœ¬æ²¡æœ‰æ•´æ•°ï¼Œæ‰€æœ‰æ•°å­—éƒ½æ˜¯ä»¥IEEE-754æ ‡å‡†æ ¼å¼64ä½æµ®ç‚¹æ•°å½¢å¼å‚¨å­˜ï¼Œ1ä¸1.0æ˜¯ç›¸åŒçš„ã€‚å› ä¸ºæœ‰äº›å°æ•°ä»¥äºŒè¿›åˆ¶è¡¨ç¤ºä½æ•°æ˜¯æ— ç©·çš„ã€‚ JavaScript ä¼šæŠŠè¶…å‡º 53 ä½ä¹‹åçš„äºŒè¿›åˆ¶èˆå¼ƒï¼Œæ‰€ä»¥æ¶‰åŠå°æ•°çš„æ¯”è¾ƒå’Œè¿ç®—è¦ç‰¹åˆ«å°å¿ƒã€‚ æµ®ç‚¹æ•°çš„è¿ç®—è¿‡ç¨‹é¦–å…ˆï¼Œåè¿›åˆ¶çš„0.1å’Œ0.2ä¼šè½¬æ¢æˆäºŒè¿›åˆ¶çš„ï¼Œä½†æ˜¯ç”±äºæµ®ç‚¹æ•°ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºæ˜¯æ— ç©·çš„ 0.1â€”â€”&gt;0.0001 1001 1001 1001 ...(1001å¾ªç¯)0.2â€”â€”&gt;0.0011 0011 0011 0011 ...(0011å¾ªç¯) IEEE754 æ ‡å‡†çš„ 64 ä½åŒç²¾åº¦æµ®ç‚¹æ•°çš„å°æ•°éƒ¨åˆ†æœ€å¤šæ”¯æŒ 53 ä½äºŒè¿›åˆ¶ï¼Œå¤šä½™çš„äºŒè¿›åˆ¶æ•°å­—è¢«æˆªæ–­ï¼Œæ‰€ä»¥ä¸¤è€…ç›¸åŠ ä¹‹åçš„äºŒè¿›åˆ¶ä¹‹å’Œæ˜¯ 0.0100110011001100110011001100110011001100110011001101 å°†æˆªæ–­ä¹‹åçš„äºŒè¿›åˆ¶æ•°å­—å†è½¬æ¢ä¸ºåè¿›åˆ¶ï¼Œå°±æˆäº† 0.30000000000000004 ï¼Œæ‰€ä»¥åœ¨è®¡ç®—æ—¶äº§ç”Ÿäº†è¯¯å·® è§£å†³æ–¹æ³•è½¬æ¢ä¸ºæ•´æ•°è¿ç®—åœ¨çŸ¥é“å°æ•°çš„ä½æ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†å®ƒè½¬ä¸ºæ•´æ•°ï¼Œç»“æœåœ¨é™¤ä»¥å¯¹åº”çš„å€æ•° &gt; 0.1 + 0.20.30000000000000004 &gt; (0.1 * 10 + 0.2 * 10) / 100.3 ä½æ•°èˆå…¥æ³•å°æ•°éƒ¨åˆ†æœ€å¤šæ”¯æŒ53ä½ï¼Œ å¯¹åº”çš„å°æ•°ä½æ”¯æŒ17ä½ï¼Œæˆ‘ä»¬å–15ä½ï¼Œç„¶ååœ¨ç”¨ Number è½¬æ¢ &gt; Number((0.1 + 0.2).toPrecision(15))0.3 é€‚ç”¨äºä¸çŸ¥é“ä½æ•°çš„æƒ…å†µä¸‹ï¼Œä½†æ˜¯å°æ•°ä½ä¸ä¼šè¶…è¿‡15ä½ å°æ•°è½¬æ•´æ•°è¿ç®—é€‚ç”¨æ‰€æœ‰æƒ…å†µï¼šæŠŠå°æ•°éƒ¨åˆ†å’Œæ•´æ•°éƒ¨åˆ†éƒ½è½¬æ¢ä¸ºæ•´æ•°è¿ç®—ï¼Œåœ¨é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥å›æ¥ function add(a, b) &#123; var c, d, e; try &#123; c = a.toString().split(&quot;.&quot;)[1].length; &#125; catch (f) &#123; c = 0; &#125; try &#123; d = b.toString().split(&quot;.&quot;)[1].length; &#125; catch (f) &#123; d = 0; &#125; return e = Math.pow(10, Math.max(c, d)), (mul(a, e) + mul(b, e)) / e;&#125;function sub(a, b) &#123; var c, d, e; try &#123; c = a.toString().split(&quot;.&quot;)[1].length; &#125; catch (f) &#123; c = 0; &#125; try &#123; d = b.toString().split(&quot;.&quot;)[1].length; &#125; catch (f) &#123; d = 0; &#125; return e = Math.pow(10, Math.max(c, d)), (mul(a, e) - mul(b, e)) / e;&#125;function mul(a, b) &#123; var c = 0, d = a.toString(), e = b.toString(); try &#123; c += d.split(&quot;.&quot;)[1].length; &#125; catch (f) &#123;&#125; try &#123; c += e.split(&quot;.&quot;)[1].length; &#125; catch (f) &#123;&#125; return Number(d.replace(&quot;.&quot;, &quot;&quot;)) * Number(e.replace(&quot;.&quot;, &quot;&quot;)) / Math.pow(10, c);&#125;function div(a, b) &#123; var c, d, e = 0, f = 0; try &#123; e = a.toString().split(&quot;.&quot;)[1].length; &#125; catch (g) &#123;&#125; try &#123; f = b.toString().split(&quot;.&quot;)[1].length; &#125; catch (g) &#123;&#125; return c = Number(a.toString().replace(&quot;.&quot;, &quot;&quot;)), d = Number(b.toString().replace(&quot;.&quot;, &quot;&quot;)), mul(c / d, Math.pow(10, f - e));&#125; å‚è€ƒJavascriptä¼˜åŒ–åçš„åŠ å‡ä¹˜é™¤ï¼ˆè§£å†³jsæµ®ç‚¹æ•°è®¡ç®—bugï¼‰ è§£å†³JSæµ®ç‚¹æ•°è¿ç®—ç»“æœä¸ç²¾ç¡®çš„Bug","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"dataTableä»‹ç»","date":"2020-11-21T01:48:04.000Z","path":"2020/11/21/2020-11-21-dataTable/","text":"ä½¿ç”¨npm å¼•å…¥dataTableå¼•å…¥datatables.net-dté¦–å…ˆå¯¼å…¥ npm åŒ… npm install datatables.net-dt åœ¨éœ€è¦å¼•ç”¨çš„åœ°æ–¹ï¼Œå¯¼å…¥ dataTable import $ from â€˜jqueryâ€™require(&#x27;datatables.net&#x27;)require(&#x27;datatables.net-dt/css/jquery.dataTables.css&#x27;) å‚è€ƒdataTable è·å–apiçš„ä¸‰ç§æ–¹æ³• $(selector). DataTable();$(selector).dataTable().api();$.fn.dataTable. Api( selector ); ç¬¬ä¸‰ç§æ–¹æ³•æ¯”è¾ƒç‰¹æ®Šï¼Œæˆ‘ä½¿ç”¨è¿‡ä¸€æ¬¡ï¼Œä½¿ç”¨åœºæ™¯ä¸ºï¼šæ— æ³•å¼•å…¥ jquery ï¼Œ dataTable ä¸èƒ½åˆå§‹åŒ–ï¼Œè¿™ä¸»è¦æ˜¯å› ä¸ºä½¿ç”¨ npm è¿›è¡Œæ¨¡å—åŠ è½½çš„æ—¶å€™ï¼Œä¸»ä»£ç å·²ç»æœ‰ jquery ï¼Œå†å¼•å…¥ jquery å›è¦†ç›–ä¹‹å‰ jquery çš„æ’ä»¶ï¼Œæ‰€ä»¥ä½¿ç”¨ window.dt = require(&#x27;datatables.net&#x27;);// åœ¨ä½¿ç”¨åˆ°çš„æ¨¡å—é‡Œå¼•å…¥dtwindow.$.fn.dataTable = window.dt; è¿™é‡Œä½¿ç”¨ $(selector). DataTable(); ã€ $(selector).dataTable().api(); éƒ½æ— æ³•è¿”å›Api; æ‰€ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼ $(selector).dataTable();$.fn.dataTable.Api(selector); å‚è€ƒdataTable api æœç´¢åŒ¹é…æ­£åˆ™çš„é—®é¢˜DataTable ä¸­çš„ search æœç´¢æ¡†åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯ä»¥åŒ¹é…è¡¨æ ¼ä¸­çš„ä»»æ„æ•°æ®ã€‚ä¸ä»…å¦‚æ­¤ DataTable è¿˜æä¾›äº† regex é€‰é¡¹å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚ $(&#x27;#example&#x27;).dataTable(&#123; &quot;search&quot;: &#123; &quot;regex&quot;: true &#125;&#125;); ä½†æ˜¯ï¼Œå¦‚æœä½ æœ‰æ›´å¤šçš„è¦æ±‚ï¼Œæ¯”å¦‚ï¼šå¯¹ä¸€è¡Œçš„å¤šä¸ªåˆ—è¿›è¡ŒåŒ¹é…ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦äº†è§£dataTableçš„åŒ¹é…è§„åˆ™DataTableæœç´¢ç»“æœä»¥è¡Œæ˜¾ç¤ºï¼Œé‚£ä¹ˆæ¯ä¸€è¡Œæ˜¯æ€ä¹ˆåŒ¹é…æ­£åˆ™çš„ï¼Ÿ æ¯ä¸€è¡Œä»£è¡¨çš„å­—ç¬¦ä¸²æ˜¯ä»¥2ä¸ªç©ºæ ¼å°†æ²¡ä¸€åˆ—è¿æˆä¸€ä¸ªå­—ç¬¦ä¸² ä¾‹å¦‚ï¼š|example1|example2|example3||:-:|:-:|:-:||a|c|d||e|f|g||h|i|j| å¦‚æœæˆ‘ä»¬åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥: ^a c d å³å¯åŒ¹é…åˆ°ç¬¬ä¸€è¡Œ å¦‚æœæƒ³è¦æ›´å¤šçš„éªŒè¯DataTableçš„æ­£åˆ™åŒ¹é…è§„åˆ™ï¼Œå¯ä»¥ç‚¹å‡»è¿æ¥éªŒè¯ å¤šåˆ—ä½¿ç”¨æœç´¢å¾ˆå¤šäººæƒ³åˆ°ç”¨ .columns() ï¼Œä½†æ˜¯ .columns() è¡¨ç¤ºçš„æ˜¯ä¸ &amp;&amp; , ä¾‹å¦‚ .columns([1, 2]).search(&#39;&#39;) è¡¨ç¤ºçš„æ˜¯ç¬¬2ï¼Œ3åˆ—éƒ½æœ‰åŒ¹é…çš„é¡¹ æœ‰ä¸€ç§æ›¿ä»£æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š $(&#x27;table&#x27;).dataTable().api().column(1).search(&#x27;æ&#x27;).column(0).search(&#x27;1&#x27;).draw(); æ·»åŠ å¤–éƒ¨htmlå¯ä»¥åœ¨ dom é€‰é¡¹ä¸­æ·»åŠ ç±»åä¸º toolbar çš„ div ï¼Œå†å¾€å…¶ä¸­åŠ å…¥ä»£ç å³å¯ $(document).ready(function() &#123; $(&#x27;#example&#x27;).DataTable(&#123; &quot;dom&quot;: &#x27;&lt;&quot;toolbar&quot;&gt;frtip&#x27; &#125;); $(&quot;div.toolbar&quot;).html(&#x27;&lt;b&gt;Custom tool bar! Text/images etc.&lt;/b&gt;&#x27;);&#125;); å‚è€ƒdom_toolbar","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"dataTable","slug":"dataTable","permalink":"https://luckyship.github.io/tags/dataTable/"},{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"daterangepickeré»˜è®¤æ˜¾ç¤ºä¸ºç©º","date":"2020-11-02T08:14:11.000Z","path":"2020/11/02/2020-11-02-daterangepicker-default-null/","text":"daterangepicker é»˜è®¤æ˜¾ç¤ºä¸ºç©ºç›®å‰å®˜ç½‘æä¾›å±æ€§ autoUpdateInput: false ï¼Œè¾“å…¥æ¡†å°±å¯ä»¥æ˜¾ç¤ºä¸ºç©ºï¼Œä½†æ˜¯å†æ¬¡é€‰æ‹©æ—¥æœŸçš„æ—¶å€™ä¸ä¼šå‘ç”Ÿå˜åŒ–æˆ‘ä»¬å¯¹ç»„ä»¶è¿›è¡Œä¸€äº›ä¿®æ”¹ï¼Œè®©å®ƒå¯ä»¥æ˜¾ç¤ºä¸ºç©ºå€¼ã€‚ $(&#x27;.date&#x27;).daterangepicker(&#123; singleDatePicker: true, autoUpdateInput: false, showDropdowns: true, locale: &#123; format: &quot;YYYY-MM-DD&quot;, &#125;,&#125;, function(start, end, label) &#123; $(el).val(start.format(&#x27;YYYY-MM-DD&#x27;));&#125;); åˆ©ç”¨å›è°ƒå‡½æ•°ï¼Œä¸ºè¾“å…¥æ¡†èµ‹å€¼æˆ‘ä»¬é€‰æ‹©çš„æ—¥æœŸ","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"es6","slug":"es6","permalink":"https://luckyship.github.io/tags/es6/"}]},{"title":"jså¾ªç¯","date":"2020-10-23T08:14:11.000Z","path":"2020/10/23/2021-07-10-js-loop/","text":"forEachforEach æ— æ³•ä½¿ç”¨ break æˆ–è€… continue è·³å‡ºå¾ªç¯ ä¼˜ç‚¹ï¼šä½¿ç”¨å›è°ƒå‡½æ•°ï¼Œå½¢æˆç‰¹å®šçš„ä½œç”¨åŸŸï¼Œä¸ä¼šæ±¡æŸ“å¤–éƒ¨å˜é‡ forEach æ˜¯ä¸èƒ½é˜»å¡çš„ï¼Œé»˜è®¤æ˜¯è¯·æ±‚å¹¶è¡Œå‘èµ·æ¥çœ‹ä¸€ä¸ªä¾‹å­ const list = [1, 2, 3];const square = num =&gt; &#123; return new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(num * num); &#125;, 1000); &#125;);&#125;;function test() &#123; list.forEach(async x =&gt; &#123; const res = await square(x); console.log(res); &#125;);&#125;test(); ä¸Šé¢å‡½æ•°æ‰§è¡Œï¼Œè™½ç„¶åŠ äº†å¼‚æ­¥å‡½æ•°ï¼Œä½†æ˜¯æ‰§è¡Œç»“æœæ˜¯åŒæ—¶è¾“å‡º 1ã€4ã€9 å¦‚æœæƒ³è¦èƒ½å¤Ÿå¼‚æ­¥æ‰§è¡Œï¼Œéœ€è¦ä½¿ç”¨ for å¾ªç¯ async function test() &#123; for (let i = 0; i &lt; list.length; i++) &#123; let x = list[i]; const res = await square(x); console.log(res); &#125;&#125; æˆ–è€… for..of async function test() &#123; for (let x of list) &#123; const res = await square(x); console.log(res); &#125;&#125; forâ€¦ofes6 æ–°å¢ï¼Œç”¨äºè¿­ä»£å™¨ï¼Œæ— æ³•ç”¨äºå¯¹è±¡ var arr = [1, 2, 3, 4, 5];for (var i in arr) &#123; console.log(i);&#125; forâ€¦inä¸€èˆ¬ä¸ºå¯¹è±¡ä½¿ç”¨ï¼Œä¸è¿‡ for...in ä¼šæŠŠå¯¹è±¡åŸå‹é“¾çš„å±æ€§ä¹Ÿéå†å‡ºæ¥ Object.prototype.bar = 10; // ä¿®æ”¹Object.prototypevar obj = &#123; name: &#x27;wjy&#x27;, age: 26, sex: &#x27;female&#x27;,&#125;; //å®šä¹‰ä¸€ä¸ªobjectå¯¹è±¡var keys = []; //å®šä¹‰ä¸€ä¸ªæ•°ç»„ç”¨æ¥æ¥å—keyvar values = []; //å®šä¹‰ä¸€ä¸ªæ•°ç»„ç”¨æ¥æ¥å—valuefor (var key in obj) &#123; console.log(key + &#x27;: &#x27; + obj[key]); //å–å¾—value&#125; å¦‚æœä¸æƒ³éå†åŸå‹é“¾çš„å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ Object.hasOwnProperty() æ¥åˆ¤æ–­æ˜¯å¦ä¸ºè‡ªèº«å±æ€§ å¯¹è±¡éå†æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ï¼Œ Object.keys å’Œ Object.values() ä¸ç”¨äºæ•°ç»„çš„åŸå›  for..inçš„ key å€¼æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œæ•°ç»„çš„ index æ˜¯æ•°å­—ï¼Œä¼šé€ æˆè¯¯è§£ å¦‚æœæ•°ç»„ä¸­æˆ–åŸå‹é“¾ä¸­æœ‰å¯æšä¸¾çš„å±æ€§ï¼Œéå†ç»“æœä¸­ä¼šå‡ºç° æ•°ç»„æ˜¯æœ‰åºçš„ï¼Œè€Œå¯¹è±¡çš„keyæ˜¯æ— åºçš„ for å¾ªç¯æœ€åŸºç¡€çš„å¾ªç¯ forå¾ªç¯å’ŒforEachçš„æ€§èƒ½åŒºåˆ«åœ¨æ€§èƒ½å¯¹æ¯”æ–¹é¢æˆ‘ä»¬åŠ å…¥ä¸€ä¸ª map è¿­ä»£å™¨ï¼Œå®ƒä¸ filter ä¸€æ ·éƒ½æ˜¯ç”Ÿæˆæ–°æ•°ç»„ã€‚æˆ‘ä»¬å¯¹æ¯” for forEach map çš„æ€§èƒ½åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­éƒ½æ˜¯ä»€ä¹ˆæ ·çš„ï¼š æ€§èƒ½æ¯”è¾ƒï¼šfor &gt; forEach &gt; map åœ¨ chrome 62 å’Œ Node.js v9.1.0 ç¯å¢ƒä¸‹ï¼šfor å¾ªç¯æ¯” forEach å¿« 1 å€ï¼ŒforEach æ¯” map å¿« 20%å·¦å³ã€‚ åŸå› åˆ†æforï¼šfor å¾ªç¯æ²¡æœ‰é¢å¤–çš„å‡½æ•°è°ƒç”¨æ ˆå’Œä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥å®ƒçš„å®ç°æœ€ä¸ºç®€å•ã€‚forEachï¼šå¯¹äº forEach æ¥è¯´ï¼Œå®ƒçš„å‡½æ•°ç­¾åä¸­åŒ…å«äº†å‚æ•°å’Œä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥æ€§èƒ½ä¼šä½äº for å¾ªç¯ã€‚mapï¼šmap æœ€æ…¢çš„åŸå› æ˜¯å› ä¸º map ä¼šè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæ•°ç»„çš„åˆ›å»ºå’Œèµ‹å€¼ä¼šå¯¼è‡´åˆ†é…å†…å­˜ç©ºé—´ï¼Œå› æ­¤ä¼šå¸¦æ¥è¾ƒå¤§çš„æ€§èƒ½å¼€é”€ã€‚ å¦‚æœå°†mapåµŒå¥—åœ¨ä¸€ä¸ªå¾ªç¯ä¸­ï¼Œä¾¿ä¼šå¸¦æ¥æ›´å¤šä¸å¿…è¦çš„å†…å­˜æ¶ˆè€—ã€‚å½“å¤§å®¶ä½¿ç”¨è¿­ä»£å™¨éå†ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œå¦‚æœä¸éœ€è¦è¿”å›ä¸€ä¸ªæ–°æ•°ç»„å´ä½¿ç”¨ map æ˜¯è¿èƒŒè®¾è®¡åˆè¡·çš„ã€‚åœ¨æˆ‘å‰ç«¯åˆä½œå¼€å‘æ—¶è§è¿‡å¾ˆå¤šäººåªæ˜¯ä¸ºäº†éå†æ•°ç»„è€Œç”¨ map çš„ï¼š","updated":"2025-08-02T05:46:04.176Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"es6","slug":"es6","permalink":"https://luckyship.github.io/tags/es6/"}]},{"title":"es6å¼‚æ­¥çš„å†™æ³•","date":"2020-10-22T07:21:00.000Z","path":"2020/10/22/2020-10-22-es6-async-methods/","text":"Promiseæ–°ç•Œ promise å¯¹è±¡ï¼Œåœ¨å…¶ä¸­å†™å…¥éœ€è¦å¼‚æ­¥çš„ä»£ç  var p1 = new Promise(function(resolve, reject) &#123; //åšä¸€äº›å¼‚æ­¥æ“ä½œ setTimeout(function() &#123; console.log(&#x27;æ‰§è¡Œå®ŒæˆPromise&#x27;); resolve(&#x27;è¦è¿”å›çš„æ•°æ®å¯ä»¥ä»»ä½•æ•°æ®ä¾‹å¦‚æ¥å£è¿”å›æ•°æ®&#x27;); &#125;, 2000);&#125;);p1.then(function(data) &#123; console.log(data)&#125;);æ‰§è¡Œå®ŒæˆPromiseè¦è¿”å›çš„æ•°æ®å¯ä»¥ä»»ä½•æ•°æ®ä¾‹å¦‚æ¥å£è¿”å›æ•°æ® æ³¨æ„new Promise((resolve, reject) =&gt; &#123; resolve(1); console.log(2);&#125;).then(r =&gt; &#123; console.log(r);&#125;);// 2// 1 ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨ resolve(1) ä»¥åï¼Œåé¢çš„ console.log(2) è¿˜æ˜¯ä¼šæ‰§è¡Œï¼Œå¹¶ä¸”ä¼šé¦–å…ˆæ‰“å°å‡ºæ¥ã€‚è¿™æ˜¯å› ä¸ºç«‹å³ resolved çš„ Promise æ˜¯åœ¨æœ¬è½®äº‹ä»¶å¾ªç¯çš„æœ«å°¾æ‰§è¡Œï¼Œæ€»æ˜¯æ™šäºæœ¬è½®å¾ªç¯çš„åŒæ­¥ä»»åŠ¡ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè°ƒç”¨ resolve æˆ– reject ä»¥åï¼Œ Promise çš„ä½¿å‘½å°±å®Œæˆäº†ï¼Œåç»§æ“ä½œåº”è¯¥æ”¾åˆ° then æ–¹æ³•é‡Œé¢ï¼Œè€Œä¸åº”è¯¥ç›´æ¥å†™åœ¨ resolve æˆ– reject çš„åé¢ã€‚æ‰€ä»¥ï¼Œæœ€å¥½åœ¨å®ƒä»¬å‰é¢åŠ ä¸Š return è¯­å¥ï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰æ„å¤–ã€‚ new Promise((resolve, reject) =&gt; &#123; return resolve(1); // åé¢çš„è¯­å¥ä¸ä¼šæ‰§è¡Œ console.log(2);&#125;) Generatorå‡½æ•°Generator å‡½æ•°æ˜¯ ES6 æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œè¯­æ³•è¡Œä¸ºä¸ä¼ ç»Ÿå‡½æ•°å®Œå…¨ä¸åŒ function* helloWorldGenerator() &#123; yield &#x27;hello&#x27;; yield &#x27;world&#x27;; return &#x27;ending&#x27;;&#125; ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª Generator å‡½æ•°helloWorldGeneratorï¼Œå®ƒå†…éƒ¨æœ‰ä¸¤ä¸ªyieldè¡¨è¾¾å¼ï¼ˆhelloå’Œworldï¼‰ï¼Œå³è¯¥å‡½æ•°æœ‰ä¸‰ä¸ªçŠ¶æ€ï¼šhelloï¼Œworld å’Œ return è¯­å¥ï¼ˆç»“æŸæ‰§è¡Œï¼‰ã€‚ ç„¶åï¼ŒGenerator å‡½æ•°çš„è°ƒç”¨æ–¹æ³•ä¸æ™®é€šå‡½æ•°ä¸€æ ·ï¼Œä¹Ÿæ˜¯åœ¨å‡½æ•°ååé¢åŠ ä¸Šä¸€å¯¹åœ†æ‹¬å·ã€‚ä¸åŒçš„æ˜¯ï¼Œè°ƒç”¨ Generator å‡½æ•°åï¼Œè¯¥å‡½æ•°å¹¶ä¸æ‰§è¡Œï¼Œè¿”å›çš„ä¹Ÿä¸æ˜¯å‡½æ•°è¿è¡Œç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡å‘å†…éƒ¨çŠ¶æ€çš„æŒ‡é’ˆå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€ç« ä»‹ç»çš„éå†å™¨å¯¹è±¡ï¼ˆIterator Objectï¼‰ã€‚ ä¸‹ä¸€æ­¥ï¼Œå¿…é¡»è°ƒç”¨éå†å™¨å¯¹è±¡çš„nextæ–¹æ³•ï¼Œä½¿å¾—æŒ‡é’ˆç§»å‘ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡è°ƒç”¨nextæ–¹æ³•ï¼Œå†…éƒ¨æŒ‡é’ˆå°±ä»å‡½æ•°å¤´éƒ¨æˆ–ä¸Šä¸€æ¬¡åœä¸‹æ¥çš„åœ°æ–¹å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªyieldè¡¨è¾¾å¼ï¼ˆæˆ–returnè¯­å¥ï¼‰ä¸ºæ­¢ã€‚æ¢è¨€ä¹‹ï¼ŒGenerator å‡½æ•°æ˜¯åˆ†æ®µæ‰§è¡Œçš„ï¼Œyieldè¡¨è¾¾å¼æ˜¯æš‚åœæ‰§è¡Œçš„æ ‡è®°ï¼Œè€Œnextæ–¹æ³•å¯ä»¥æ¢å¤æ‰§è¡Œã€‚ hw.next()// &#123; value: &#x27;hello&#x27;, done: false &#125;hw.next()// &#123; value: &#x27;world&#x27;, done: false &#125;hw.next()// &#123; value: &#x27;ending&#x27;, done: true &#125;hw.next()// &#123; value: undefined, done: true &#125; ä¸Šé¢ä»£ç ä¸€å…±è°ƒç”¨äº†å››æ¬¡nextæ–¹æ³•ã€‚ ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œ Generator å‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ª yield è¡¨è¾¾å¼ä¸ºæ­¢ã€‚ next æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„ value å±æ€§å°±æ˜¯å½“å‰ yield è¡¨è¾¾å¼çš„å€¼ hello ï¼Œ done å±æ€§çš„å€¼ false ï¼Œè¡¨ç¤ºéå†è¿˜æ²¡æœ‰ç»“æŸã€‚ ç¬¬äºŒæ¬¡è°ƒç”¨ï¼Œ Generator å‡½æ•°ä»ä¸Šæ¬¡ yield è¡¨è¾¾å¼åœä¸‹çš„åœ°æ–¹ï¼Œä¸€ç›´æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ª yield è¡¨è¾¾å¼ã€‚ next æ–¹æ³•è¿”å›çš„å¯¹è±¡çš„ value å±æ€§å°±æ˜¯å½“å‰ yield è¡¨è¾¾å¼çš„å€¼ world ï¼Œ done å±æ€§çš„å€¼ false ï¼Œè¡¨ç¤ºéå†è¿˜æ²¡æœ‰ç»“æŸã€‚ ç¬¬ä¸‰æ¬¡è°ƒç”¨ï¼Œ Generator å‡½æ•°ä»ä¸Šæ¬¡ yield è¡¨è¾¾å¼åœä¸‹çš„åœ°æ–¹ï¼Œä¸€ç›´æ‰§è¡Œåˆ° return è¯­å¥ï¼ˆå¦‚æœæ²¡æœ‰ return è¯­å¥ï¼Œå°±æ‰§è¡Œåˆ°å‡½æ•°ç»“æŸï¼‰ã€‚ next æ–¹æ³•è¿”å›çš„å¯¹è±¡çš„ value å±æ€§ï¼Œå°±æ˜¯ç´§è·Ÿåœ¨ return è¯­å¥åé¢çš„è¡¨è¾¾å¼çš„å€¼ï¼ˆå¦‚æœæ²¡æœ‰ return è¯­å¥ï¼Œåˆ™ value å±æ€§çš„å€¼ä¸º undefined ï¼‰ï¼Œ done å±æ€§çš„å€¼ true ï¼Œè¡¨ç¤ºéå†å·²ç»ç»“æŸã€‚ ç¬¬å››æ¬¡è°ƒç”¨ï¼Œæ­¤æ—¶ Generator å‡½æ•°å·²ç»è¿è¡Œå®Œæ¯•ï¼Œ next æ–¹æ³•è¿”å›å¯¹è±¡çš„ value å±æ€§ä¸º undefined ï¼Œ done å±æ€§ä¸º true ã€‚ä»¥åå†è°ƒç”¨ next æ–¹æ³•ï¼Œè¿”å›çš„éƒ½æ˜¯è¿™ä¸ªå€¼ã€‚ æ€»ç»“ä¸€ä¸‹ï¼Œè°ƒç”¨ Generator å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä»£è¡¨ Generator å‡½æ•°çš„å†…éƒ¨æŒ‡é’ˆã€‚ä»¥åï¼Œæ¯æ¬¡è°ƒç”¨éå†å™¨å¯¹è±¡çš„ next æ–¹æ³•ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªæœ‰ç€ value å’Œ done ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ã€‚ value å±æ€§è¡¨ç¤ºå½“å‰çš„å†…éƒ¨çŠ¶æ€çš„å€¼ï¼Œæ˜¯ yield è¡¨è¾¾å¼åé¢é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼› done å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦éå†ç»“æŸã€‚ asyncå‡½æ•°async å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿä¸€å¥è¯ï¼Œå®ƒå°±æ˜¯ Generator å‡½æ•°çš„è¯­æ³•ç³–ã€‚ const fs = require(&#x27;fs&#x27;);const readFile = function(fileName) &#123; return new Promise(function(resolve, reject) &#123; fs.readFile(fileName, function(error, data) &#123; if (error) return reject(error); resolve(data); &#125;); &#125;);&#125;;const gen = function*() &#123; const f1 = yield readFile(&#x27;/etc/fstab&#x27;); const f2 = yield readFile(&#x27;/etc/shells&#x27;); console.log(f1.toString()); console.log(f2.toString());&#125;; ä¸Šé¢ä»£ç çš„å‡½æ•° gen å¯ä»¥å†™æˆ async å‡½æ•°ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚ const asyncReadFile = async function() &#123; const f1 = await readFile(&#x27;/etc/fstab&#x27;); const f2 = await readFile(&#x27;/etc/shells&#x27;); console.log(f1.toString()); console.log(f2.toString());&#125;; ä¸€æ¯”è¾ƒå°±ä¼šå‘ç°ï¼Œ async å‡½æ•°å°±æ˜¯å°† Generator å‡½æ•°çš„æ˜Ÿå· ï¼ˆ*ï¼‰ æ›¿æ¢æˆ async ï¼Œå°† yield æ›¿æ¢æˆ await ï¼Œä»…æ­¤è€Œå·²ã€‚async å‡½æ•°å¯¹ Generator å‡½æ•°çš„æ”¹è¿›ï¼Œä½“ç°åœ¨ä»¥ä¸‹å››ç‚¹ã€‚ ï¼ˆ1ï¼‰å†…ç½®æ‰§è¡Œå™¨ã€‚Generator å‡½æ•°çš„æ‰§è¡Œå¿…é¡»é æ‰§è¡Œå™¨ï¼Œæ‰€ä»¥æ‰æœ‰äº†coæ¨¡å—ï¼Œè€Œasyncå‡½æ•°è‡ªå¸¦æ‰§è¡Œå™¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œasyncå‡½æ•°çš„æ‰§è¡Œï¼Œä¸æ™®é€šå‡½æ•°ä¸€æ¨¡ä¸€æ ·ï¼Œåªè¦ä¸€è¡Œã€‚ asyncReadFile(); ä¸Šé¢çš„ä»£ç è°ƒç”¨äº† asyncReadFile å‡½æ•°ï¼Œç„¶åå®ƒå°±ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œè¾“å‡ºæœ€åç»“æœã€‚è¿™å®Œå…¨ä¸åƒ Generator å‡½æ•°ï¼Œéœ€è¦è°ƒç”¨ next æ–¹æ³•ï¼Œæˆ–è€…ç”¨ co æ¨¡å—ï¼Œæ‰èƒ½çœŸæ­£æ‰§è¡Œï¼Œå¾—åˆ°æœ€åç»“æœã€‚ ï¼ˆ2ï¼‰æ›´å¥½çš„è¯­ä¹‰ã€‚async å’Œ await ï¼Œæ¯”èµ·æ˜Ÿå·å’Œ yield ï¼Œè¯­ä¹‰æ›´æ¸…æ¥šäº†ã€‚ async è¡¨ç¤ºå‡½æ•°é‡Œæœ‰å¼‚æ­¥æ“ä½œï¼Œ await è¡¨ç¤ºç´§è·Ÿåœ¨åé¢çš„è¡¨è¾¾å¼éœ€è¦ç­‰å¾…ç»“æœã€‚ ï¼ˆ3ï¼‰æ›´å¹¿çš„é€‚ç”¨æ€§ã€‚co æ¨¡å—çº¦å®šï¼Œ yield å‘½ä»¤åé¢åªèƒ½æ˜¯ Thunk å‡½æ•°æˆ– Promise å¯¹è±¡ï¼Œè€Œ async å‡½æ•°çš„ await å‘½ä»¤åé¢ï¼Œå¯ä»¥æ˜¯ Promise å¯¹è±¡å’ŒåŸå§‹ç±»å‹çš„å€¼ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼Œä½†è¿™æ—¶ä¼šè‡ªåŠ¨è½¬æˆç«‹å³ resolved çš„ Promise å¯¹è±¡ï¼‰ã€‚ ï¼ˆ4ï¼‰è¿”å›å€¼æ˜¯ Promiseã€‚async å‡½æ•°çš„è¿”å›å€¼æ˜¯ Promise å¯¹è±¡ï¼Œè¿™æ¯” Generator å‡½æ•°çš„è¿”å›å€¼æ˜¯ Iterator å¯¹è±¡æ–¹ä¾¿å¤šäº†ã€‚ä½ å¯ä»¥ç”¨ then æ–¹æ³•æŒ‡å®šä¸‹ä¸€æ­¥çš„æ“ä½œã€‚ è¿›ä¸€æ­¥è¯´ï¼Œ async å‡½æ•°å®Œå…¨å¯ä»¥çœ‹ä½œå¤šä¸ªå¼‚æ­¥æ“ä½œï¼ŒåŒ…è£…æˆçš„ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè€Œ await å‘½ä»¤å°±æ˜¯å†…éƒ¨thenå‘½ä»¤çš„è¯­æ³•ç³–ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚ async function getStockPriceByName(name) &#123; const symbol = await getStockSymbol(name); const stockPrice = await getStockPrice(symbol); return stockPrice;&#125;getStockPriceByName(&#x27;goog&#x27;).then(function(result) &#123; console.log(result);&#125;); Promiseå¯¹è±¡çš„çŠ¶æ€å˜åŒ–async å‡½æ•°è¿”å›çš„ Promise å¯¹è±¡ï¼Œå¿…é¡»ç­‰åˆ°å†…éƒ¨æ‰€æœ‰ await å‘½ä»¤åé¢çš„ Promise å¯¹è±¡æ‰§è¡Œå®Œï¼Œæ‰ä¼šå‘ç”ŸçŠ¶æ€æ”¹å˜ï¼Œé™¤éé‡åˆ° return è¯­å¥æˆ–è€…æŠ›å‡ºé”™è¯¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰ async å‡½æ•°å†…éƒ¨çš„å¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡Œ then æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚ async function getTitle(url) &#123; let response = await fetch(url); let html = await response.text(); return html.match(/&lt;title&gt;([\\s\\S]+)&lt;\\/title&gt;/i)[1];&#125;getTitle(&#x27;https://tc39.github.io/ecma262/&#x27;).then(console.log)// &quot;ECMAScript 2017 Language Specification&quot; ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•° getTitle å†…éƒ¨æœ‰ä¸‰ä¸ªæ“ä½œï¼šæŠ“å–ç½‘é¡µã€å–å‡ºæ–‡æœ¬ã€åŒ¹é…é¡µé¢æ ‡é¢˜ã€‚åªæœ‰è¿™ä¸‰ä¸ªæ“ä½œå…¨éƒ¨å®Œæˆï¼Œæ‰ä¼šæ‰§è¡Œ then æ–¹æ³•é‡Œé¢çš„ console.log ã€‚ await å‘½ä»¤æ­£å¸¸æƒ…å†µä¸‹ï¼Œ await å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè¿”å›è¯¥å¯¹è±¡çš„ç»“æœã€‚å¦‚æœä¸æ˜¯ Promise å¯¹è±¡ï¼Œå°±ç›´æ¥è¿”å›å¯¹åº”çš„å€¼ã€‚ async function f() &#123; // ç­‰åŒäº // return 123; return await 123;&#125;f().then(v =&gt; console.log(v))// 123 ä¸Šé¢ä»£ç ä¸­ï¼Œ await å‘½ä»¤çš„å‚æ•°æ˜¯æ•°å€¼ 123 ï¼Œè¿™æ—¶ç­‰åŒäº return 123 ã€‚ å¦ä¸€ç§æƒ…å†µæ˜¯ï¼Œ await å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª thenable å¯¹è±¡ï¼ˆå³å®šä¹‰äº† then æ–¹æ³•çš„å¯¹è±¡ï¼‰ï¼Œé‚£ä¹ˆ await ä¼šå°†å…¶ç­‰åŒäº Promise å¯¹è±¡ã€‚ class Sleep &#123; constructor(timeout) &#123; this.timeout = timeout; &#125; then(resolve, reject) &#123; const startTime = Date.now(); setTimeout( () =&gt; resolve(Date.now() - startTime), this.timeout ); &#125;&#125;(async () =&gt; &#123; const sleepTime = await new Sleep(1000); console.log(sleepTime);&#125;)();// 1000 ä¸Šé¢ä»£ç ä¸­ï¼Œ await å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª Sleep å¯¹è±¡çš„å®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹ä¸æ˜¯ Promise å¯¹è±¡ï¼Œä½†æ˜¯å› ä¸ºå®šä¹‰äº† then æ–¹æ³•ï¼Œ await ä¼šå°†å…¶è§†ä¸º Promise å¤„ç†ã€‚ å‚è€ƒPromise å¯¹è±¡Generator å‡½æ•°çš„è¯­æ³•asyncå‡½æ•°","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"es6","slug":"es6","permalink":"https://luckyship.github.io/tags/es6/"}]},{"title":"å„ç§jsã€jqueryæµè§ˆå™¨é«˜åº¦ã€å®½åº¦","date":"2020-10-21T09:29:48.000Z","path":"2020/10/21/2020-10-21-browser-window-size/","text":"JavascriptIEä¸­ï¼šdocument.body.clientWidth == &gt; BODYå¯¹è±¡å®½åº¦document.body.clientHeight == &gt; BODYå¯¹è±¡é«˜åº¦document.documentElement.clientWidth == &gt; å¯è§åŒºåŸŸå®½åº¦document.documentElement.clientHeight == &gt; å¯è§åŒºåŸŸé«˜åº¦FireFoxä¸­ï¼šdocument.body.clientWidth == &gt; BODYå¯¹è±¡å®½åº¦document.body.clientHeight == &gt; BODYå¯¹è±¡é«˜åº¦document.documentElement.clientWidth == &gt; å¯è§åŒºåŸŸå®½åº¦document.documentElement.clientHeight == &gt; å¯è§åŒºåŸŸé«˜åº¦Operaä¸­ï¼šdocument.body.clientWidth == &gt; å¯è§åŒºåŸŸå®½åº¦document.body.clientHeight == &gt; å¯è§åŒºåŸŸé«˜åº¦document.documentElement.clientWidth == &gt; é¡µé¢å¯¹è±¡å®½åº¦ï¼ˆ å³BODYå¯¹è±¡å®½åº¦åŠ ä¸ŠMarginå®½ï¼‰document.documentElement.clientHeight == &gt; é¡µé¢å¯¹è±¡é«˜åº¦ï¼ˆ å³BODYå¯¹è±¡é«˜åº¦åŠ ä¸ŠMarginé«˜ï¼‰alert(document.body.clientWidth); //ç½‘é¡µå¯è§åŒºåŸŸå®½(body)alert(document.body.clientHeight); //ç½‘é¡µå¯è§åŒºåŸŸé«˜(body)alert(document.body.offsetWidth); //ç½‘é¡µå¯è§åŒºåŸŸå®½(body)ï¼ŒåŒ…æ‹¬borderã€marginç­‰alert(document.body.offsetHeight); //ç½‘é¡µå¯è§åŒºåŸŸå®½(body)ï¼ŒåŒ…æ‹¬borderã€marginç­‰alert(document.body.scrollWidth); //ç½‘é¡µæ­£æ–‡å…¨æ–‡å®½ï¼ŒåŒ…æ‹¬æœ‰æ»šåŠ¨æ¡æ—¶çš„æœªè§åŒºåŸŸalert(document.body.scrollHeight); //ç½‘é¡µæ­£æ–‡å…¨æ–‡é«˜ï¼ŒåŒ…æ‹¬æœ‰æ»šåŠ¨æ¡æ—¶çš„æœªè§åŒºåŸŸalert(document.body.scrollTop); //ç½‘é¡µè¢«å·å»çš„Top(æ»šåŠ¨æ¡)alert(document.body.scrollLeft); //ç½‘é¡µè¢«å·å»çš„Left(æ»šåŠ¨æ¡)alert(window.screenTop); //æµè§ˆå™¨è·ç¦»Topalert(window.screenLeft); //æµè§ˆå™¨è·ç¦»Leftalert(window.screen.height); //å±å¹•åˆ†è¾¨ç‡çš„é«˜alert(window.screen.width); //å±å¹•åˆ†è¾¨ç‡çš„å®½alert(window.screen.availHeight); //å±å¹•å¯ç”¨å·¥ä½œåŒºçš„é«˜alert(window.screen.availWidth); //å±å¹•å¯ç”¨å·¥ä½œåŒºçš„å®½ scrollTop æ˜¯ä¸€ä¸ªéæ•´æ•°ï¼Œè€Œ scrollHeight å’Œ clientHeight æ˜¯å››èˆäº”å…¥çš„ï¼Œå› æ­¤ç¡®å®šæ»šåŠ¨åŒºåŸŸæ˜¯å¦æ»šåŠ¨åˆ°åº•çš„å”¯ä¸€æ–¹æ³•æ˜¯æŸ¥çœ‹æ»šåŠ¨é‡æ˜¯å¦è¶³å¤Ÿæ¥è¿‘æŸä¸ªé˜ˆå€¼ (åœ¨æœ¬ä¾‹ä¸­ä¸º 1)ï¼š Math.abs(element.scrollHeight - element.clientHeight - element.scrollTop) &lt; 1 å‚è€ƒ jqueryalert($(window).height()); //æµè§ˆå™¨å½“å‰çª—å£å¯è§†åŒºåŸŸé«˜åº¦alert($(document).height()); //æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£çš„é«˜åº¦alert($(document.body).height()); //æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£bodyçš„é«˜åº¦alert($(document.body).outerHeight(true)); //æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£bodyçš„æ€»é«˜åº¦ åŒ…æ‹¬border padding marginalert($(window).width()); //æµè§ˆå™¨å½“å‰çª—å£å¯è§†åŒºåŸŸå®½åº¦alert($(document).width()); //æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£å¯¹è±¡å®½åº¦alert($(document.body).width()); //æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£bodyçš„å®½åº¦alert($(document.body).outerWidth(true)); //æµè§ˆå™¨å½“å‰çª—å£æ–‡æ¡£bodyçš„æ€»å®½åº¦ åŒ…æ‹¬border padding margin","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"jquery","slug":"jquery","permalink":"https://luckyship.github.io/tags/jquery/"}]},{"title":"hexoæ–°å»ºé¡µé¢","date":"2020-10-11T13:06:47.000Z","path":"2020/10/11/2020-10-11-hexo-new-page/","text":"ä½¿ç”¨ hexo new page å‘½ä»¤ $ hexo new page comment åœ¨ source æ–‡ä»¶å¤¹ä¸‹å°±æœ‰äº†ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ $ ls sourcecomment _post å½“ä½¿ç”¨ hexo g æ—¶ï¼Œä¼šåœ¨ public æ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆæ–°çš„æ–‡ä»¶å¤¹ comment ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨ç½‘é¡µä¸Šå°±å¯ä»¥é€šè¿‡ url + comment/ çš„æ–¹å¼è®¿é—®è¯¥é¡µé¢","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"hexo","slug":"hexo","permalink":"https://luckyship.github.io/tags/hexo/"}]},{"title":"gitee pages è‡ªåŠ¨æ›´æ–°","date":"2020-10-10T16:00:00.000Z","path":"2020/10/11/2020-10-11-gitee-update-pages-auto/","text":"ç¯å¢ƒå‡†å¤‡ node &gt;= 14.13.1 npm &gt;= 6.14.8å®‰è£… puppeteer npm install puppeteer --save puppeteer æ˜¯è°·æ­Œæä¾›çš„ä¸€ä¸ªæ— ç•Œé¢çš„æµè§ˆå™¨ç¨‹åºï¼Œç›¸å½“äºç”¨ä»£ç å®ç°æµè§ˆå™¨çš„åŠŸèƒ½ è‡ªåŠ¨åŒ–è„šæœ¬æ–°å»ºæ–‡ä»¶updatePages.jséœ€è¦å¡«å…¥ gitee è´¦å·ã€å¯†ç å’Œ pages çš„åœ°å€ // npm &gt;= 10.18const puppeteer = require(&quot;puppeteer&quot;);const username = &quot;&quot;; // giteeç”¨æˆ·åconst password = &quot;&quot;; // giteeå¯†ç const giteePageUrl = &quot;https://gitee.com/luckyship/luckyship/pages&quot;; // gitee pageåœ°å€async function giteeUpdate(username, giteePageUrl, passwd) &#123; const browser = await puppeteer.launch(&#123; // æ­¤å¤„å¯ä»¥ä½¿ç”¨ false æœ‰å¤´æ¨¡å¼è¿›è¡Œè°ƒè¯•, è°ƒè¯•å®Œæ³¨é‡Šå³å¯ headless: false, &#125;); const page = await browser.newPage(); await page.goto(&quot;https://gitee.com/login&quot;); // 1. é€‰ä¸­è´¦å·æ§ä»¶ let accountElements = await page.$x(&#x27;//*[@id=&quot;user_login&quot;]&#x27;); // æ­¤å¤„ä½¿ç”¨ xpath å¯»æ‰¾æ§ä»¶ï¼Œä¸‹åŒ // 2. å¡«å…¥è´¦å· await accountElements[0].type(username); // 3. é€‰ä¸­å¯†ç æ§ä»¶ let pwdElements = await page.$x(&#x27;//*[@id=&quot;user_password&quot;]&#x27;); // 4. å¡«å…¥å¯†ç  await pwdElements[0].type(passwd); // 5. ç‚¹å‡»ç™»å½• let loginButtons = await page.$x( // &#x27;//*[@id=&quot;new_user&quot;]/div[2]/div/div/div[4]/input&#x27; &#x27;//*[@id=&quot;new_user&quot;]/div/div/div/div[4]/input&#x27; ); console.log(loginButtons); await loginButtons[0].click(); // 6. ç­‰å¾…ç™»å½•æˆåŠŸ await page.waitFor(1000); await page.goto(giteePageUrl); // æ¯”å¦‚ï¼š https://gitee.com/yang0033/hexo-blog/pages // 7.1. ç›‘å¬æ­¥éª¤ 7 ä¸­è§¦å‘çš„ç¡®è®¤å¼¹æ¡†ï¼Œå¹¶ç‚¹å‡»ç¡®è®¤ await page.on(&quot;dialog&quot;, async (dialog) =&gt; &#123; console.log(&quot;ç¡®è®¤æ›´æ–°&quot;); dialog.accept(); &#125;); // 7. ç‚¹å‡»æ›´æ–°æŒ‰é’®ï¼Œå¹¶å¼¹å‡ºç¡®è®¤å¼¹çª— let updateButtons = await page.$x(&#x27;//*[@id=&quot;pages-branch&quot;]/div[6]&#x27;); await updateButtons[0].click(); // 8. è½®è¯¢å¹¶ç¡®è®¤æ˜¯å¦æ›´æ–°å®Œæ¯• while (true) &#123; await page.waitFor(2000); try &#123; // 8.1 è·å–æ›´æ–°çŠ¶æ€æ ‡ç­¾ deploying = await page.$x(&#x27;//*[@id=&quot;pages_deploying&quot;]&#x27;); if (deploying.length &gt; 0) &#123; console.log(&quot;æ›´æ–°ä¸­...&quot;); &#125; else &#123; console.log(&quot;æ›´æ–°å®Œæ¯•&quot;); break; &#125; &#125; catch (error) &#123; break; &#125; &#125; await page.waitFor(500); // 10.æ›´æ–°å®Œæ¯•ï¼Œå…³é—­æµè§ˆå™¨ browser.close();&#125;giteeUpdate(username, giteePageUrl, password); $ node updatePages.js","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"hexo","slug":"hexo","permalink":"https://luckyship.github.io/tags/hexo/"}]},{"title":"ä½¿ç”¨hexoåœ¨githubä¸Šæ­å»ºåšå®¢","date":"2020-10-06T16:00:00.000Z","path":"2020/10/07/2020-10-07-deploy-hexo/","text":"ç¯å¢ƒå‡†å¤‡ npm &gt;= 6.14.8 hexo &gt;= 4.2.0 hexoä¸»é¢˜yilia éƒ¨ç½²åº”ç”¨åˆ›å»ºç›®å½• hexo ï¼Œè¿›å…¥ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ $ hexo init$ ls_config.yml node_modules/ package-lock.json scaffolds/ themes/db.json package.json public/ source/ ä¿®æ”¹ _config.yml ï¼Œå°†å…¶ä¸­çš„ theme å­—æ®µä¿®æ”¹ä¸º lucky $ cat _config.ymltheme: lucky è¿›å…¥ themes ç›®å½•ï¼Œå…‹éš†hexoä¸»é¢˜ä»“åº“ï¼ˆæ³¨æ„åå­—ä¸ºthemeå­—æ®µçš„ä¿®æ”¹å€¼ï¼‰ git clone https://github.com/luckyship/myblog.git ./lucky é€€å›hexoä¸»ç›®å½•ï¼Œæ‰§è¡Œ hexo generatehexo sever å³å¯çœ‹åˆ°webæœåŠ¡å·²ç»å¯åŠ¨ï¼Œç«¯å£é»˜è®¤ä¸º4000ï¼Œè®¿é—® localhost:4000 å³å¯ å¼€å‘åº”ç”¨ä¿®æ”¹ä¸»é¢˜ä»£ç ä¾‹å¦‚ css, js, html ç­‰ï¼Œéœ€è¦é‡æ–°æ‰“åŒ…ä¸»é¢˜ä»£ç  $ npm run dev å†æ¸…é™¤hexoç¼“å­˜ï¼Œé‡æ–°æ‰“åŒ…åˆ°hexoä¸Š $ hexo c // æ¸…é™¤æ‰€æœ‰ç¼“å­˜$ hexo g // æ‰“åŒ…æ ¼å¼åŒ–mdæ–‡ä»¶$ hexo s // æœ¬åœ°ç¯å¢ƒ æ·»åŠ mdæ–‡ä»¶æ·»åŠ çš„æ–‡ä»¶å¯ä»¥å®æ—¶æ˜¾ç°åˆ°webä¸Š $ hexo s -g --debug ä¸Šä¼ è‡³githubå®‰è£…åŒ… npm install hexo-deployer-git --save åœ¨ _config.yml ä¸­æ·»åŠ  deploy: type: git repo: git@github.com:luckyship/luckyship.github.io.git branch: main message: &#x27;collect new post&#x27; æ‰§è¡Œå‘½ä»¤ï¼Œ deploy ä¸Šä¼ çš„æ¯æ¬¡ generate è¿‡åçš„æ–‡ä»¶ï¼Œæ‰€ä»¥ä¸Šä¼ ä¹‹å‰éœ€è¦ generate $ hexo g$ hexo deploy ä¿®æ”¹ä»£ç é«˜äº®é…ç½®Highlight.js# _config.ymlhighlight: enable: true auto_detect: false line_number: true tab_replace: &#x27; &#x27; wrap: true hljs: falseprismjs: enable: false highlight.js é»˜è®¤å¼€å¯ï¼Œç”¨ä½œ Hexo çš„æœåŠ¡ç«¯é«˜äº®ç»„ä»¶ã€‚å¦‚æœä½ éœ€è¦åœ¨æµè§ˆå™¨ç«¯è¿è¡Œ highlight.jsï¼Œè¯·æŠŠå®ƒå…³é—­ã€‚ ã€ŒæœåŠ¡ç«¯é«˜äº®ã€æŒ‡è¯­æ³•é«˜äº®åœ¨ hexo generate æˆ– hexo server æ—¶å®Œæˆã€‚ auto_detectauto_detect æ˜¯ highlight.js çš„ç‰¹æ€§ï¼Œèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹ä»£ç å—çš„è¯­è¨€ã€‚ æç¤ºï¼šå¦‚æœä½ æƒ³ä½¿ç”¨ã€Œå­è¯­è¨€é«˜äº®ã€åŠŸèƒ½ï¼ˆä¾‹å¦‚åœ¨é«˜äº® HTML æ—¶åŒæ—¶é«˜äº®å†…éƒ¨åµŒå…¥çš„ JavaScript ä»£ç ï¼‰ï¼Œè¯·å¼€å¯ auto_detectï¼Œå¹¶ä¸”åœ¨æ–‡ç« ä¸­æ’å…¥ä»£ç å—æ—¶ä¸è¦æ ‡æ³¨è¯­è¨€ã€‚è­¦å‘Šï¼auto_detect ååˆ†è€—è´¹èµ„æºã€‚ å¦‚æœä½ ä¸éœ€è¦ä½¿ç”¨ã€Œå­è¯­è¨€é«˜äº®ã€åŠŸèƒ½ï¼Œæˆ–è€…ä¸ä»‹æ„åœ¨ä¹¦å†™ä»£ç å—æ—¶æ ‡è®°è¯­è¨€ï¼Œè¯·ä¸è¦å¯ç”¨æ­¤åŠŸèƒ½ã€‚ line_numberhighlight.js ä¸æ”¯æŒè¡Œå·æ˜¾ç¤ºã€‚Hexo é€šè¿‡ç”¨ &lt;figure&gt; å’Œ &lt;table&gt; åŒ…è£¹å…¶ä»£ç å—ä¸ºå…¶æ·»åŠ äº†è¡Œå·æ˜¾ç¤ºæ”¯æŒ: &lt;figure class=&quot;highlight yaml&quot;&gt; &lt;table&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td class=&quot;gutter&quot;&gt; &lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt; &lt;/td&gt; &lt;td class=&quot;code&quot;&gt; &lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;attr&quot;&gt;hello:&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;hexo&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt;&lt;/figure&gt; è¿™ä¸æ˜¯ highlight.js çš„è¡Œä¸ºï¼Œå› æ­¤éœ€è¦ä¸º &lt;figure&gt; å’Œ &lt;table&gt; æ·»åŠ è‡ªå®šä¹‰ CSS ä»£ç ã€‚éƒ¨åˆ†ä¸»é¢˜å¯¹æ­¤æä¾›å†…å»ºæ”¯æŒã€‚ä½ å¤§æ¦‚ä¹Ÿæ³¨æ„åˆ°äº†ï¼Œæ‰€æœ‰ä»£ç å—çš„ class éƒ½æ²¡æœ‰ hljs- å‰ç¼€ tab_replaceç”¨ä»£ç å†…çš„ tab (\\t) æ›¿æ¢ä¸ºç»™å®šå€¼ï¼Œé»˜è®¤å€¼æ˜¯ä¸¤ä¸ªç©ºæ ¼ã€‚ wrapä¸ºäº†æ”¯æŒè¡Œå·æ˜¾ç¤ºï¼ŒHexo å°†è¾“å‡ºåŒ…è£¹åœ¨äº† &lt;figure&gt; å’Œ &lt;table&gt; å†…éƒ¨ã€‚å¦‚æœè¦ä¿æŒ highlight.js åŸæ¥çš„è¡Œä¸ºï¼Œä½ éœ€è¦å°† line_number å’Œ wrap å…¨éƒ¨å…³é—­ã€‚ &lt;pre&gt;&lt;code class=&quot;yaml&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# _config.yml&lt;/span&gt;&lt;span class=&quot;attr&quot;&gt;hexo:&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;hexo&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt; è­¦å‘Šï¼å› ä¸º line_number åŠŸèƒ½ä¾èµ– wrapï¼Œä½ æ— æ³•åœ¨é…ç½®ä¸­å…³é—­ wrap è€Œåˆå¼€å¯ line_numberã€‚å¦‚æœä½ å°† line_number è®¾ç½®ä¸º true çš„è¯ï¼Œwrap å°†è¢«è‡ªåŠ¨å¼€å¯ã€‚ hljså½“ hljs è®¾ç½®ä¸º true æ—¶ï¼Œæ‰€æœ‰ä»£ç å—çš„ HTML è¾“å‡ºå‡ä¼šç»™ class æ·»åŠ  hljs- å‰ç¼€ï¼ˆæ— è®º wrap æ˜¯å¦å¼€å¯ï¼‰ï¼š &lt;pre&gt;&lt;code class=&quot;yaml hljs&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;# _config.yml&lt;/span&gt;&lt;span class=&quot;hljs-attr&quot;&gt;hexo:&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;hexo&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt; å» highlight å®˜ç½‘å»ä½¿ç”¨å®˜æ–¹çš„ä¸»é¢˜ï¼Œå¤åˆ¶å…¶ä¸­çš„cssåˆ°è‡ªå·±çš„ä»£ç ä¸­hightlight æç¤ºï¼šå½“ line_number å’Œ wrap ä¸º falseï¼Œhljs ä¸º true çš„æ—¶å€™ï¼Œä½ å¯ä»¥åœ¨ç«™ç‚¹ä¸Šç›´æ¥åº”ç”¨ highlight.js çš„ä¸»é¢˜_blankã€‚ PrismJS# _config.ymlhighlight: enable: falseprismjs: enable: true preprocess: true line_number: true tab_replace: &#x27;&#x27; PrismJS é»˜è®¤ç¦ç”¨ã€‚å¯ç”¨ PrimeJS å‰åº”è®¾ç½® highlight.enable ä¸º falseã€‚ preprocessHexo å†…å»ºçš„ PrismJS æ”¯æŒæµè§ˆå™¨ç«¯é«˜äº®ï¼ˆpreprocess è®¾ç½®ä¸º falseï¼‰å’ŒæœåŠ¡å™¨ç«¯é«˜äº®ï¼ˆpreprocess è®¾ç½®ä¸º trueï¼‰ä¸¤ç§æ–¹å¼ã€‚ ä½¿ç”¨æœåŠ¡å™¨ç«¯é«˜äº®æ—¶ï¼ˆpreprocess è®¾ç½®ä¸º trueï¼‰ï¼Œåªéœ€è¦åœ¨ç«™ç‚¹å¼•å…¥ Prismjs çš„ä¸»é¢˜ï¼ˆCSS æ ·å¼è¡¨ï¼‰å³å¯ï¼›è€Œä½¿ç”¨æµè§ˆå™¨ç«¯é«˜äº®æ—¶ï¼ˆpreprocess è®¾ç½®ä¸º falseï¼‰ï¼Œéœ€è¦å°† JavaScript æ–‡ä»¶ä¹Ÿå¼•å…¥ã€‚ PrismJS ä¸»è¦æ˜¯é¢å‘æµè§ˆå™¨çš„ã€‚å› æ­¤ï¼Œåœ¨æœåŠ¡å™¨ç«¯é«˜äº®æ¨¡å¼ä¸‹åªæœ‰éƒ¨åˆ†æ’ä»¶å¯ç”¨ï¼š è¡Œå·æ˜¾ç¤ºï¼šéœ€è¦å¼•å…¥prism-line-numbers.cssï¼Œæ— éœ€å¼•å…¥prism-line-numbers.jsã€‚Hexo å°†ç”Ÿæˆå…¶æ‰€éœ€çš„ HTML ä»£ç ç‰‡æ®µã€‚ è¯­è¨€æ˜¾ç¤ºï¼šå½“ä»£ç å—æœ‰æ ‡æ³¨è¯­è¨€æ—¶ï¼ŒHexo æ€»ä¼šæ·»åŠ  data-language å±æ€§ã€‚ Hexo ä¹Ÿæ”¯æŒå…¶å®ƒä¸éœ€è¦ç‰¹æ®Š HTML ä»£ç æ ¼å¼çš„ PrismJS æ’ä»¶ï¼Œä¸è¿‡ä½ éœ€è¦å¼•å…¥å®ƒä»¬çš„ JavaScript æ–‡ä»¶ preprocess è®¾ç½®ä¸º false æ—¶æ‰€æœ‰ primejs æ’ä»¶å‡å¯ç”¨ï¼Œåªéœ€é¢å¤–æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š è¡Œå·æ˜¾ç¤ºï¼šå½“ preprocess è®¾ç½®ä¸º false æ—¶ï¼ŒHexo ä¸ä¼šç”Ÿæˆæ’ä»¶æ‰€éœ€çš„ HTML ä»£ç æ ¼å¼ã€‚prism-line-numbers.css å’Œ prism-line-numbers.jså‡éœ€è¢«å¼•å…¥ã€‚ è¯­è¨€æ˜¾ç¤ºï¼šå½“ä»£ç å—æœ‰æ ‡æ³¨è¯­è¨€æ—¶ï¼ŒHexo æ€»ä¼šæ·»åŠ  data-language å±æ€§ã€‚ é«˜äº®ç‰¹å®šè¡Œ: Hexo çš„ä»£ç å—æ ‡ç­¾æ’ä»¶å’Œåå¼•å·ä»£ç å—æ ‡ç­¾æ’ä»¶éƒ½æ”¯æŒé«˜äº®ç‰¹å®šè¡Œçš„è¯­æ³•ï¼ˆå³ mark é€‰é¡¹ï¼‰ã€‚å½“ mark é¡¹è¢«è®¾ç½®æ—¶ï¼ŒHexo å°†ç”Ÿæˆå…¶æ‰€éœ€çš„ HTML ä»£ç æ ¼å¼ã€‚ line_numberå½“ preprocess ä¸ line_number å‡è®¾ç½®ä¸º true æ—¶ï¼Œåªéœ€è¦å¼•å…¥ prism-line-numbers.css å³å¯å¯ç”¨è¡Œå·æ˜¾ç¤ºã€‚å¦‚æœ preprocess å’Œ line_number å‡è¢«å…³é—­ï¼Œåˆ™éœ€è¦å°† prism-line-numbers.css å’Œ prism-line-numbers.js éƒ½å¼•å…¥æ‰èƒ½å¯ç”¨è¡Œå·æ˜¾ç¤ºã€‚ tab_replaceç”¨ä»£ç å†…çš„ tab (\\t) æ›¿æ¢ä¸ºç»™å®šå€¼ï¼Œé»˜è®¤å€¼æ˜¯ä¸¤ä¸ªç©ºæ ¼ã€‚ å‚è€ƒHexo ä»£ç é«˜äº® å…¶ä»–å‚è€ƒHighlight.jsPrismJSHexo è¯­æ³•é«˜äº®éƒ¨åˆ†çš„æºç å¯å‚è§ï¼šHighlight.js å·¥å…·å‡½æ•°PrismJS å·¥å…·å‡½æ•°ä»£ç å—æ ‡ç­¾æ’ä»¶åå¼•å·ä»£ç å—æ ‡ç­¾æ’ä»¶ å®ç°æœç´¢åŠŸèƒ½hexoåœ¨deployç”Ÿæˆæ–‡ç« çš„æ—¶å€™ï¼Œä¼šç”Ÿæˆä¸€ä¸ªcontent.jsonçš„æ–‡ä»¶ï¼Œé‡Œé¢ä¿å­˜ç€æ‰€æœ‰çš„æ–‡ç« ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç½‘é¡µåŠ è½½å®Œæ¯•åï¼Œåˆ©ç”¨ajaxè¯·æ±‚è·å¾—è¯¥æ–‡ä»¶çš„ä¿¡æ¯ï¼Œå®ç°æœç´¢åŠŸèƒ½ é…ç½®ç”Ÿæˆ content.json æ–‡ä»¶åœ¨ _config.yaml ä¸­åŠ å…¥ jsonContent jsonContent: meta: false pages: false posts: title: true date: true path: true text: true raw: false content: true slug: false updated: true comments: false link: false permalink: false excerpt: true categories: false tags: true å‚æ•°æ„ä¹‰å¯ä»¥å‚è€ƒ meta: &#123; title: hexo.config.title, subtitle: hexo.config.subtitle, description: hexo.config.description, author: hexo.config.author, url: hexo.config.url&#125;,pages: [&#123; //-&gt; all pages title: page.title, slug: page.slug, date: page.date, updated: page.updated, comments: page.comments, permalink: page.permalink, path: page.path, excerpt: page.excerpt, //-&gt; only text ;) keywords: null, //-&gt; it needs settings text: page.content, //-&gt; only text minified ;) raw: page.raw, //-&gt; original MD content content: page.content, //-&gt; final HTML content author: page.author, categories: [&#123; name: category.name, slug: category.slug, permalink: category.permalink &#125;], tags: [&#123; name: tag.name, slug: tag.slug, permalink: tag.permalink &#125;]&#125;],posts: [&#123; //-&gt; only published posts title: post.title, slug: post.slug, date: post.date, updated: post.updated, comments: post.comments, permalink: post.permalink, path: post.path, excerpt: post.excerpt, //-&gt; only text minified ;) description: post.description, //-&gt; only text minified ;) keywords: null, //-&gt; it needs settings text: post.content, //-&gt; only text minified ;) raw: post.raw, //-&gt; original MD content content: post.content, //-&gt; final HTML content author: post.author, categories: [&#123; name: category.name, slug: category.slug, permalink: category.permalink &#125;], tags: [&#123; name: tag.name, slug: tag.slug, permalink: tag.permalink &#125;]&#125;],categories: [&#123; //-&gt; Posts categories index ;) name: category.name, slug: category.slug, permalink: category.permalink&#125;],tags: [&#123; //-&gt; Posts tags index ;) name: tag.name, slug: tag.slug, permalink: tag.permalink&#125;]","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"hexo","slug":"hexo","permalink":"https://luckyship.github.io/tags/hexo/"}]},{"title":"hexo æ·»åŠ æ–‡ç« å¯¼èˆª","date":"2020-09-29T16:00:00.000Z","path":"2020/09/30/2020-09-30-hexo-add-article-nav/","text":"åœ¨Hexoå®˜ç½‘ æ–‡æ¡£&gt;è‡ªå®šä¹‰&gt;è¾…åŠ©å‡½æ•°&gt;æœ€ä¸‹é¢ï¼Œå¯ä»¥æ‰¾åˆ°tocè¿™ä¸ªå‡½æ•°ï¼Œçœ‹å…¶ä»‹ç»èƒ½çŸ¥é“å®ƒå°±æ˜¯æ¥å®ç°æ–‡ç« ç›®å½•çš„ã€‚ ä½¿ç”¨tocå‡½æ•°ï¼Œä¸æ˜¾ç¤ºæ ‡é¢˜å‰æ•°å­—ï¼Œitemä¸ºé¡µé¢ä¸­ä¼ è¿‡å»çš„å‚æ•°post toc.ejs&lt;% if (item) &#123; %&gt;&lt;div id=&quot;toc&quot; class=&quot;toc-article&quot;&gt; &lt;%- toc(item.content, &#123;list_number: false&#125;) %&gt;&lt;/div&gt;&lt;% &#125; %&gt; åœ¨å·¦ä¾§æ æ’å…¥ä»£ç  left-col.ejs&lt;nav&gt; &lt;%- partial(&#x27;_partial/post/toc&#x27;, &#123;item: page&#125;) %&gt;&lt;/nav&gt; ä¿®æ”¹layoutä»£ç  &lt;%- partial(&#x27;_partial/left-col&#x27;, null, &#123;cache: !config.relative_link, post: page&#125;) %&gt;&lt;%- partial(&#x27;_partial/left-col&#x27;, &#123;cache: !config.relative_link, post: page&#125;) %&gt;","updated":"2025-08-02T05:46:04.173Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"hexo","slug":"hexo","permalink":"https://luckyship.github.io/tags/hexo/"}]},{"title":"aptå‘½ä»¤çš„ä¸€äº›ä½¿ç”¨æ–¹æ³•","date":"2020-09-26T16:00:00.000Z","path":"2020/09/27/2020-09-27-debian-install-command/","text":"apt-cache madison xxx // æŸ¥çœ‹è½¯ä»¶åŒ…å¯ä»¥å®‰è£…çš„ç‰ˆæœ¬apt download xxx // åªä¸‹è½½debåŒ…ï¼Œä¸å®‰è£… apt-cache madison$ apt-cache madison kubelet | head -n 5 kubelet | 1.18.8-00 | http://apt.kubernetes.io kubernetes-xenial/main amd64 Packages kubelet | 1.18.6-00 | http://apt.kubernetes.io kubernetes-xenial/main amd64 Packages kubelet | 1.18.5-00 | http://apt.kubernetes.io kubernetes-xenial/main amd64 Packages kubelet | 1.18.4-01 | http://apt.kubernetes.io kubernetes-xenial/main amd64 Packages kubelet | 1.18.4-00 | http://apt.kubernetes.io kubernetes-xenial/main amd64 Packages$ apt install kubelet=1.18.8-00 apt download$ apt-get download libssl1.1è·å–:1 http://mirrors.163.com/debian stretch/main amd64 libssl1.1 amd64 1.1.0l-1~deb9u1 [1,358 kB]å·²ä¸‹è½½ 1,358 kBï¼Œè€—æ—¶ 0ç§’ (2,830 kB/s)","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"linux","slug":"linux","permalink":"https://luckyship.github.io/tags/linux/"},{"name":"debian","slug":"debian","permalink":"https://luckyship.github.io/tags/debian/"},{"name":"ubuntu","slug":"ubuntu","permalink":"https://luckyship.github.io/tags/ubuntu/"}]},{"title":"ä½¿ç”¨nodeå¿«é€Ÿèµ·ä¸€ä¸ªhttpæœåŠ¡å™¨","date":"2020-09-26T16:00:00.000Z","path":"2020/09/27/2020-09-27-node-http-server/","text":"éœ€è¦nodeç¯å¢ƒ $ npm install http-server -g//é»˜è®¤ä¸º8080$ http-server -p 3000","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"linux","slug":"linux","permalink":"https://luckyship.github.io/tags/linux/"},{"name":"nodejs","slug":"nodejs","permalink":"https://luckyship.github.io/tags/nodejs/"}]},{"title":"åœ¨debianä¸Šç¦»çº¿ä½¿ç”¨kubeadmæ­å»º v1.16.3ç‰ˆæœ¬Kubernetesé›†ç¾¤","date":"2020-09-26T16:00:00.000Z","path":"2020/09/27/2020-09-27-debian-install-k8s-offline/","text":"ç¯å¢ƒå‡†å¤‡debian 9 æœºå™¨ä¸€å°ï¼Œä½œä¸ºmasterèŠ‚ç‚¹å’ŒnodeèŠ‚ç‚¹ é¦–å…ˆå®‰è£…dockerç¦»çº¿å®‰è£…dockerdocker å®‰è£…åŒ… å…³é—­swapã€selinuxã€é˜²ç«å¢™swapoff -asystemctl stop firewalld æ·»åŠ k8så®˜æ–¹æºéœ€è¦ç§‘å­¦ä¸Šç½‘ sudo curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key addsudo cat &lt;&lt;EOF &gt;/etc/apt/sources.list.d/kubernetes.listdeb http://apt.kubernetes.io/ kubernetes-xenial mainEOFsudo apt-get updatesudo apt-get install -y kubelet kubeadm kubectl kubernetes-cni é…ç½®ç¦»çº¿åŒ…$ apt-get download kubeadm=1.16.3-00 $ apt-get download kubelet=1.16.3-00 kubectl=1.16.3-00 kubernetes-cni$ apt-get download socat ebtables conntrack$ apt-get download cri-tools$ apt-get download libnetfilter-conntrack3$ apt-get download libssl1.1$ dpkg -i xxxx.deb å¯¼å‡ºdocker ç¦»çº¿åŒ…åˆ—å‡ºæ‰€æœ‰é•œåƒ $ kubeadm config images list --image-repository registry.aliyuncs.com/google_containers --kubernetes-version v1.16.3registry.aliyuncs.com/google_containers/kube-apiserver:v1.16.3registry.aliyuncs.com/google_containers/kube-controller-manager:v1.16.3registry.aliyuncs.com/google_containers/kube-scheduler:v1.16.3registry.aliyuncs.com/google_containers/kube-proxy:v1.16.3registry.aliyuncs.com/google_containers/pause:3.1registry.aliyuncs.com/google_containers/etcd:3.3.15-0registry.aliyuncs.com/google_containers/coredns:1.6.2$ docker save xxx xxx xxx &gt; k8s.tar$ docker load &lt; k8s.tar ä½¿ç”¨kubeadméƒ¨ç½²k8såˆå§‹åŒ–ç¯å¢ƒ$ kubeadm init \\ --image-repository registry.aliyuncs.com/google_containers \\ --kubernetes-version v1.16.3 \\ --pod-network-cidr=10.244.0.0/16...Your Kubernetes control-plane has initialized successfully!To start using your cluster, you need to run the following as a regular user: mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/configYou should now deploy a pod network to the cluster.Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at: https://kubernetes.io/docs/concepts/cluster-administration/addons/You can now join any number of control-plane nodes by copying certificate authorities and service account keys on each node and then running the following as root: kubeadm join 192.168.9.10:6443 --token px979r.mphk9ee5ya8fgy44 \\ --discovery-token-ca-cert-hash sha256:5e7c7cd1cc1f86c0761e54b9380de22968b6b221cb98939c14ab2942223f6f51 \\ --control-plane Then you can join any number of worker nodes by running the following on each as root:kubeadm join 192.168.9.10:6443 --token px979r.mphk9ee5ya8fgy44 \\ --discovery-token-ca-cert-hash sha256:5e7c7cd1cc1f86c0761e54b9380de22968b6b221cb98939c14ab2942223f6f51 æ ¹æ®æç¤ºè®¾ç½® kubeconfig ï¼Œæˆ–è€…æ·»åŠ å­èŠ‚ç‚¹ è®¾ç½®k8sçš„ç½‘ç»œæ’ä»¶$ kubectl apply -f &quot;https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d &#x27;\\n&#x27;)&quot; $ docker save weaveworks/weave-npc:2.7.0 weaveworks/weave-kube:2.7.0 &gt; weave.tar$ docker load &lt; weave.tar å®‰è£…helmå»é™¤èŠ‚ç‚¹æ±¡ç‚¹åªæœ‰ä¸€ä¸ªmasterèŠ‚ç‚¹çš„æƒ…å†µä¸‹ï¼ŒmasterèŠ‚ç‚¹ä¸å…è®¸è¿è¡Œèµ„æºï¼Œéœ€è¦å»æ‰æ±¡ç‚¹ $ kubectl get nodesNAME STATUS ROLES AGE VERSIONlinx-dev Ready master 138m v1.16.3$ kubectl describe node linx-dev | grep TaintTaints: node-role.kubernetes.io/master:NoSchedule// å¦‚æœTaintsæ˜¯noneï¼Œåˆ™ä¸éœ€è¦å»é™¤æ±¡ç‚¹kubectl taint nodes linx-dev node-role.kubernetes.io/master:NoSchedule- ä¸‹è½½å®¢æˆ·ç«¯wget https://get.helm.sh/helm-v2.16.3-linux-amd64.tar.gz è§£å‹ç¼©å¹¶æ‹·è´helmäºŒè¿›åˆ¶æ–‡ä»¶tar xf helm-v2.16.3-linux-amd64.tar.gzcp linux-amd64/helm /usr/local/bin å¯¼å‡ºtilleré•œåƒdocker save registry.cn-hangzhou.aliyuncs.com/google_containers/tiller:v2.16.3 &gt; helm.tardocker load &lt; helm.tar åˆå§‹åŒ–helmï¼Œéƒ¨ç½²tiller$ kubectl -n kube-system create serviceaccount tiller$ kubectl create clusterrolebinding tiller --clusterrole cluster-admin â€“serviceaccount=kube-system:tiller --stable-repo-url http://10.16.48.44/ éœ€è¦èµ·ä¸€ä¸ªhttp æœåŠ¡ï¼Œapacheæˆ–è€…nodeéƒ½å¯ä»¥ï¼Œè¿™å„¿ä¸‹é¢æ”¾äº†ä¸€ä¸ªæ–‡ä»¶index.yamlæ–‡ä»¶ï¼Œå¯ä»¥ä»è¿™å„¿ä¸‹è½½åˆ°https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts/index.yaml $ helm init --service-account tiller --tiller-image=registry.cn-hangzhou.aliyuncs.com/google_containers/tiller:v2.16.3 --upgrade --stable-repo-url http://193.160.57.100Creating /root/.helm/repository/repositories.yaml Adding stable repo with URL: http://193.160.57.100 Adding local repo with URL: http://127.0.0.1:8879/charts $HELM_HOME has been configured at /root/.helm.Tiller (the Helm server-side component) has been installed into your Kubernetes Cluster.Please note: by default, Tiller is deployed with an insecure &#x27;allow unauthenticated users&#x27; policy.To prevent this, run `helm init` with the --tiller-tls-verify flag.For more information on securing your installation see: https://docs.helm.sh/using_helm/#securing-your-helm-installation å®‰è£…openebså­˜å‚¨æœåŠ¡yamlæ–‡ä»¶å°†å…¶ä¸­çš„ imagePullPolicy æ”¹ä¸º IfNotPresent ï¼Œè¿™æ ·å¯ä»¥ä¼˜å…ˆé€‰æ‹©æœ¬åœ°é•œåƒï¼Œè€Œä¸ä¼šå»è¯·æ±‚ç½‘ç»œ https://openebs.github.io/charts/openebs-operator-1.5.0.yaml å¯¼å‡ºæ‰€æœ‰openebsé•œåƒ$ docker save quay.io/openebs/m-apiserver:1.5.0 quay.io/openebs/openebs-k8s-provisioner:1.5.0 quay.io/openebs/snapshot-controller:1.5.0 quay.io/openebs/snapshot-provisioner:1.5.0 quay.io/openebs/node-disk-manager-amd64:v0.4.5 quay.io/openebs/node-disk-operator-amd64:v0.4.5 quay.io/openebs/admission-server:1.5.0 quay.io/openebs/provisioner-localpv:1.5.0 quay.io/openebs/linux-utils:1.5.0 &gt; openebs.tar$ docker load &lt; openebs.tar kubectl apply -f openebs-operator-1.5.0.yaml è®¾ç½®é»˜è®¤å­˜å‚¨$ kubectl patch storageclass openebs-hostpath -p &#x27;&#123;&quot;metadata&quot;: &#123;&quot;annotations&quot;:&#123;&quot;storageclass.kubernetes.io/is-default-class&quot;:&quot;true&quot;&#125;&#125;&#125;&#x27;storageclass.storage.k8s.io/openebs-hostpath patched å®‰è£…kubesphereå¯¼å…¥æœ€å°åŒ–é•œåƒdocker load &lt; ks_minimal_images.tar å®‰è£…kubespherekubectl apply -f kubesphere-minimal.yaml å‚è€ƒHelmç¦»çº¿å®‰è£…","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"linux","slug":"linux","permalink":"https://luckyship.github.io/tags/linux/"},{"name":"kubernetes","slug":"kubernetes","permalink":"https://luckyship.github.io/tags/kubernetes/"},{"name":"debian","slug":"debian","permalink":"https://luckyship.github.io/tags/debian/"}]},{"title":"kubernetesé›†ç¾¤ä¸­è®¿é—®å¤–éƒ¨åŸŸå","date":"2020-09-16T16:00:00.000Z","path":"2020/09/17/2020-09-17-k8s-add-new-domain-name/","text":"ä¸€èˆ¬æ¥è¯´æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥å®ç°æ·»åŠ å¤–éƒ¨åŸŸå é€šè¿‡hostaliasåœ¨deploymenté‡Œé¢ä¿®æ”¹hostsæ–‡ä»¶ é€šè¿‡corednsä¿®æ”¹hostsæ–‡ä»¶ é€šè¿‡kube-dnsæ·»åŠ åŸŸåæœåŠ¡å™¨ é€šè¿‡hostaliasæ·»åŠ åŸŸåå’Œipåˆ›å»ºnginx pod kubectl run nginx --image nginxpod/nginx created æŸ¥çœ‹pod $ kubectl get pods --output=wideNAME READY STATUS RESTARTS AGE IP NODEnginx 1/1 Running 0 13s 10.200.0.4 worker0$ kubectl exec nginx -- cat /etc/hosts127.0.0.1 localhost::1 localhost ip6-localhost ip6-loopbackfe00::0 ip6-localnetfe00::0 ip6-mcastprefixfe00::1 ip6-allnodesfe00::2 ip6-allrouters10.200.0.4 nginx æ·»åŠ é¢å¤–çš„åŸŸåå’Œip apiVersion: v1kind: Podmetadata: name: hostaliases-podspec: restartPolicy: Never hostAliases: - ip: &quot;127.0.0.1&quot; hostnames: - &quot;foo.local&quot; - &quot;bar.local&quot; - ip: &quot;10.1.2.3&quot; hostnames: - &quot;foo.remote&quot; - &quot;bar.remote&quot; containers: - name: cat-hosts image: busybox command: - cat args: - &quot;/etc/hosts&quot; è¿è¡Œè¿™ä¸ªpod kubectl apply -f https://k8s.io/examples/service/networking/hostaliases-pod.yamlpod/hostaliases-pod created å®ƒçš„hostfile $ kubectl exec hostaliases-pod -- cat /etc/hosts127.0.0.1 localhost::1 localhost ip6-localhost ip6-loopbackfe00::0 ip6-localnetfe00::0 ip6-mcastprefixfe00::1 ip6-allnodesfe00::2 ip6-allrouters10.200.0.5 hostaliases-pod# Entries added by HostAliases.127.0.0.1 foo.local bar.local10.1.2.3 foo.remote bar.remote é€šè¿‡corednsä¿®æ”¹hostsæ–‡ä»¶ä½¿ç”¨editå‘½ä»¤ä¿®æ”¹coredns configmapèµ„æº, æ·»åŠ åŸŸå 193.160.57.121 harbor.com kubectl edit configmap coredns -n kube-system [root@node-2 test]# kubectl get configmap coredns -n kube-system -o yamlapiVersion: v1data: Corefile: | .:53 &#123; errors health ready kubernetes cluster.local. in-addr.arpa ip6.arpa &#123; pods insecure fallthrough in-addr.arpa ip6.arpa ttl 30 &#125; hosts &#123; 193.160.57.121 harbor.com //æ·»åŠ åŸŸå fallthrough &#125; prometheus :9153 forward . /etc/resolv.conf cache 30 loop reload loadbalance &#125;kind: ConfigMapmetadata: creationTimestamp: &quot;2020-08-20T10:18:50Z&quot; labels: addonmanager.kubernetes.io/mode: EnsureExists name: coredns namespace: kube-system resourceVersion: &quot;13875493&quot; selfLink: /api/v1/namespaces/kube-system/configmaps/coredns uid: 10a8e6df-d3d6-49a6-98b9-57640fdb6011 é€šè¿‡corednsæ·»åŠ åŸŸåæœåŠ¡å™¨apiVersion: v1data: Corefile: | .:53 &#123; errors health ready kubernetes cluster.local. in-addr.arpa ip6.arpa &#123; pods insecure fallthrough in-addr.arpa ip6.arpa ttl 30 &#125; proxy . 10.167.129.6 //æ·»åŠ åŸŸåæœåŠ¡å™¨ prometheus :9153 forward . /etc/resolv.conf cache 30 loop reload loadbalance &#125;kind: ConfigMapmetadata: creationTimestamp: &quot;2020-08-20T10:18:50Z&quot; labels: addonmanager.kubernetes.io/mode: EnsureExists name: coredns namespace: kube-system resourceVersion: &quot;13875493&quot; selfLink: /api/v1/namespaces/kube-system/configmaps/coredns uid: 10a8e6df-d3d6-49a6-98b9-57640fdb6011 é€šè¿‡kube-dnsæ·»åŠ åŸŸåæœåŠ¡å™¨ä¿®æ”¹kube-dnsçš„ä½¿ç”¨çš„ConfigMapã€‚ apiVersion: v1kind: ConfigMapmetadata: name: kube-dns namespace: kube-systemdata: stubDomains: | &#123;&quot;k8s.com&quot;: [&quot;192.168.10.10&quot;]&#125; upstreamNameservers: | [&quot;8.8.8.8&quot;, &quot;8.8.4.4&quot;] upstreamNameservers å³ä½¿ç”¨çš„å¤–éƒ¨DNSã€‚ å‚è€ƒadd-entries-to-pod-etc-hosts-with-host-aliaseskubernetes é›†ç¾¤DNSé…ç½®åŠå®¹å™¨å†…CoreDNSè§£æå¤–éƒ¨åŸŸåé…ç½®é—®é¢˜é…ç½®Podä½¿ç”¨å¤–éƒ¨DNS[]","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"kubernetes","slug":"kubernetes","permalink":"https://luckyship.github.io/tags/kubernetes/"}]},{"title":"rubyçš„å°æŠ€å·§","date":"2020-09-13T16:00:00.000Z","path":"2020/09/14/2020-09-14-ruby-rare-knowledge/","text":"&amp;: çš„ç”¨æ³•&amp;: é‡è¦ç”¨äºæ•°ç»„çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥è®©æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ‰§è¡Œ&amp;: åçš„æ–¹æ³•ï¼Œç›¸å½“äº item.fun() ï¼Œæ¯”å¦‚ irb(main):001:0&gt; a = [1, 2, 3]=&gt; [1, 2, 3]irb(main):002:0&gt; a.map(&amp;:to_s)=&gt; [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;] ç­‰ä¸ irb(main):004:0&gt; a.map &#123; |i| i.to_s &#125;=&gt; [&quot;1&quot;, &quot;2&quot;, &quot;3&quot;] rubyä¸­%çš„ç”¨æ³•%Q %q%Qç”¨äºæ›¿ä»£åŒå¼•å·çš„å­—ç¬¦ä¸². å½“ä½ éœ€è¦åœ¨å­—ç¬¦ä¸²é‡Œæ”¾å…¥å¾ˆå¤šå¼•å·æ—¶å€™, å¯ä»¥ç›´æ¥ç”¨ä¸‹é¢æ–¹æ³•è€Œä¸éœ€è¦åœ¨å¼•å·å‰é€ä¸ªæ·»åŠ åæ–œæ  (â€œ)%qç”¨äºä»£æ›¿å•å¼•å·çš„å­—ç¬¦ä¸² 2.3.0 :015 &gt; %Q(rudy said, &quot;i&#x27;m not ruby&quot;) =&gt; &quot;rudy said, \\&quot;i&#x27;m not ruby\\&quot;&quot; 2.3.0 :031 &gt; what_ruby = &#x27;this is ruby&#x27; =&gt; &quot;this is ruby&quot;2.3.0 :032 &gt; %Q!rudy said, &quot;#&#123;what_ruby&#125;&quot;! =&gt; &quot;rudy said, \\&quot;this is ruby\\&quot;&quot;2.3.0 :033 &gt; %q!rudy said, &quot;#&#123;what_ruby&#125;&quot;! =&gt; &quot;rudy said, \\&quot;\\#&#123;what_ruby&#125;\\&quot;&quot; (â€¦)ä¹Ÿå¯ç”¨å…¶ä»–éæ•°å­—å­—æ¯çš„ç¬¦å·æˆ–æˆå¯¹çš„ç¬¦å·ä»£æ›¿, è¯¸å¦‚#â€¦#, !â€¦!, +â€¦+, {â€¦}, [â€¦], &lt;â€¦&gt;, /â€¦/ç­‰. 2.3.0 :016 &gt; %Q/rudy said, &quot;i&#x27;m not ruby&quot;/ =&gt; &quot;rudy said, \\&quot;i&#x27;m not ruby\\&quot;&quot;2.3.0 :017 &gt; %Q#rudy said, &quot;i&#x27;m not ruby&quot;# =&gt; &quot;rudy said, \\&quot;i&#x27;m not ruby\\&quot;&quot;2.3.0 :018 &gt; %Q!rudy said, &quot;i&#x27;m not ruby&quot;! =&gt; &quot;rudy said, \\&quot;i&#x27;m not ruby\\&quot;&quot; %Wï¼Œ%w%Wè¯­æ³•è¿‘ä¼¼äº%Q, ç”¨äºè¡¨ç¤ºå…¶ä¸­å…ƒç´ è¢«åŒå¼•å·æ‹¬èµ·çš„æ•°ç»„.%wè¯­æ³•è¿‘ä¼¼äº%q, ç”¨äºè¡¨ç¤ºå…¶ä¸­å…ƒç´ è¢«å•å¼•å·æ‹¬èµ·çš„æ•°ç»„. 2.3.0 :031 &gt; what_ruby = &#x27;this is ruby&#x27; =&gt; &quot;this is ruby&quot;2.3.0 :034 &gt; %W(hello,kitty,cat,dog,what_ruby) =&gt; [&quot;hello,kitty,cat,dog,what_ruby&quot;] ###ä¸èƒ½ç”¨é€—å·éš”å¼€ï¼Œåªèƒ½ç”¨ç©ºæ ¼2.3.0 :035 &gt; %W(hello kitty cat dog what_ruby) =&gt; [&quot;hello&quot;, &quot;kitty&quot;, &quot;cat&quot;, &quot;dog&quot;, &quot;what_ruby&quot;]2.3.0 :036 &gt; %W(hello kitty cat dog #&#123;what_ruby&#125;) =&gt; [&quot;hello&quot;, &quot;kitty&quot;, &quot;cat&quot;, &quot;dog&quot;, &quot;this is ruby&quot;]###åŒå¼•å·ä¸­å¯ä»¥è¢«è§£æ2.3.0 :037 &gt; %w(hello kitty cat dog #&#123;what_ruby&#125;) =&gt; [&quot;hello&quot;, &quot;kitty&quot;, &quot;cat&quot;, &quot;dog&quot;, &quot;\\#&#123;what_ruby&#125;&quot;]###å•å¼•å·ä¸­ä¸èƒ½è¢«è§£æï¼Œè¢«è½¬ä¹‰äº†ã€‚ %xç”¨äºæ‰§è¡Œä¸€æ®µshellè„šæœ¬ï¼Œå¹¶è¿”å›è¾“å‡ºå†…å®¹ã€‚ 2.3.0 :038 &gt; %x(route -n) =&gt; &quot;Kernel IP routing table\\nDestination Gateway Genmask Flags Metric Ref Use Iface\\n0.0.0.0 10.6.0.1 0.0.0.0 UG 100 0 0 eth0\\n10.6.0.0 0.0.0.0 255.255.252.0 U 0 0 0 eth0\\n&quot;2.3.0 :039 &gt; %x(echo &quot;hello world&quot;) =&gt; &quot;hello world\\n&quot; %rè¯­æ³•è¿‘ä¼¼äº%Q, ç”¨äºæ­£åˆ™è¡¨è¾¾å¼. 2.3.0 :031 &gt; what_ruby = &#x27;this is ruby&#x27; =&gt; &quot;this is ruby&quot;2.3.0 :041 &gt; %r(/home/#&#123;what_ruby&#125;) =&gt; /\\/home\\/this is ruby/ %sç”¨äºè¡¨ç¤ºsymbol, ä½†æ˜¯ä¸ä¼šå¯¹å…¶ä¸­è¡¨è¾¾å¼ç­‰å†…å®¹è¿›è¡Œè½¬åŒ– 2.3.0 :031 &gt; what_ruby = &#x27;this is ruby&#x27; =&gt; &quot;this is ruby&quot;2.3.0 :042 &gt; %s(a b c) =&gt; :&quot;a b c&quot;2.3.0 :043 &gt; %s(abc) =&gt; :abc2.3.0 :044 &gt; %s(what_ruby) =&gt; :what_ruby2.3.0 :045 &gt; %s(#&#123;what_ruby&#125;) =&gt; :&quot;\\#&#123;what_ruby&#125;&quot; %iRuby 2.0 ä¹‹åå¼•å…¥çš„è¯­æ³•, ç”¨äºç”Ÿæˆä¸€ä¸ªsymbolæ•°ç»„ 2.3.0 :031 &gt; what_ruby = &#x27;this is ruby&#x27; =&gt; &quot;this is ruby&quot;2.3.0 :046 &gt; %i(a b c) =&gt; [:a, :b, :c]2.3.0 :047 &gt; %i(a b c #&#123;what_ruby&#125;) =&gt; [:a, :b, :c, :&quot;\\#&#123;what_ruby&#125;&quot;] *çš„ç”¨æ³•*å¯ä»¥ä»£è¡¨æ•°ç»„, æ¯”å¦‚å¯ä»¥ç”¨äºå‰©ä½™æ•°ç»„çš„èµ‹å€¼ irb(main):001:0&gt; a = [1,2,3]=&gt; [1, 2, 3]irb(main):002:0&gt; b,*c = a=&gt; [1, 2, 3]irb(main):003:0&gt; c=&gt; [2, 3]irb(main):004:0&gt; b=&gt; 1 å¯ä»¥ç”¨æ¥ä»£æ›¿å¤šå‚æ•°çš„å‡½æ•° irb(main):001:0&gt; def test(a, b)irb(main):002:1&gt; puts airb(main):003:1&gt; puts birb(main):004:1&gt; end=&gt; :testirb(main):005:0&gt; c = [1,2]=&gt; [1, 2]irb(main):006:0&gt; test(*c)12=&gt; nil æ•°ç»„å¯ä»¥è¿ç®—rubyä¸­æ•°ç»„å¯ä»¥è¿›è¡Œ + å’Œ - çš„æ“ä½œï¼Œä¸»è¦è¯´ä¸€ä¸‹ - çš„ä½œç”¨ï¼šå‡å»2ä¸ªæ•°ç»„å…±æœ‰çš„å…ƒç´  irb(main):001:0&gt; a = [1,2,3]=&gt; [1, 2, 3]irb(main):002:0&gt; b = [2,3,4]=&gt; [2, 3, 4]irb(main):003:0&gt; a - b=&gt; [1]irb(main):004:0&gt; a + b=&gt; [1, 2, 3, 2, 3, 4] jsonæ•°æ®æ ¼å¼åŒ–ä¸ºsymbolç±»å‹irb(main):005:0&gt; require &#x27;json&#x27;=&gt; trueirb(main):006:0&gt; a = &#123;b:1, c:2&#125;=&gt; &#123;:b=&gt;1, :c=&gt;2&#125;irb(main):007:0&gt; JSON.generate(a) # symbolç±»å‹çš„keyè¢«è½¬ä¸ºå­—ç¬¦ä¸²=&gt; &quot;&#123;\\&quot;b\\&quot;:1,\\&quot;c\\&quot;:2&#125;&quot;irb(main):008:0&gt; JSON.parse(JSON.generate(a))=&gt; &#123;&quot;b&quot;=&gt;1, &quot;c&quot;=&gt;2&#125;irb(main):009:0&gt; JSON.parse(JSON.generate(a), symbolize_names: true)=&gt; &#123;:b=&gt;1, :c=&gt;2&#125; sendçš„ç”¨æ³•sendç”¨æ¥è°ƒç”¨ä¸ç¡®å®šçš„å‡½æ•°å irb(main):001:0&gt; def test(a)irb(main):002:1&gt; puts airb(main):003:1&gt; end=&gt; :testirb(main):004:0&gt; send(&#x27;test&#x27;, &#x27;2&#x27;)2=&gt; nil å‡½æ•°çš„è¿”å›å€¼å¯ä»¥ä¸å†™ return ï¼Œé»˜è®¤è¿”å›æœ€åä¸€è¡Œçš„å€¼ æŸ¥çœ‹ç±»æœ‰å“ªäº›æ–¹æ³•å¯ä»¥ç”¨ .methods æ–¹æ³• irb(main):010:0&gt; class Airb(main):011:1&gt; class &lt;&lt; selfirb(main):012:2&gt; def birb(main):013:3&gt; puts &#x27;test&#x27;irb(main):014:3&gt; endirb(main):015:2&gt; endirb(main):016:1&gt; end irb(main):021:0&gt; A.methods.include?(:b)=&gt; true $1çš„ç”¨æ³•è¡¨ç¤ºæ­£åˆ™åŒ¹é…ä¸­ () ä¸­åŒ¹é…çš„å†…å®¹ï¼Œæ•°å­—è¡¨ç¤ºç¬¬å‡ ä¸ªæ‹¬å· irb(main):004:0&gt; a = &#x27;asdf123asd&#x27;=&gt; &quot;asdf123asd&quot;irb(main):008:0&gt; a =~ /asdf(123)/=&gt; 0irb(main):009:0&gt; $1=&gt; &quot;123&quot;","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"ruby","slug":"ruby","permalink":"https://luckyship.github.io/tags/ruby/"}]},{"title":"åœ¨debianä¸Šä½¿ç”¨kubeadmæ­å»º v1.16.3ç‰ˆæœ¬Kubernetesé›†ç¾¤","date":"2020-09-09T16:00:00.000Z","path":"2020/09/10/2020-09-10-debian-install-k8s/","text":"ç¯å¢ƒå‡†å¤‡debian 9 æœºå™¨ä¸€å°ï¼Œä½œä¸ºmasterèŠ‚ç‚¹å’ŒnodeèŠ‚ç‚¹ é¦–å…ˆå®‰è£…dockerç¦»çº¿å®‰è£…dockerdocker å®‰è£…åŒ…ä¸‹è½½åœ°å€ è§£å‹tar -xvf docker-18.06.1-ce.tgz å°†è§£å‹å‡ºæ¥çš„dockeræ–‡ä»¶å†…å®¹ç§»åŠ¨åˆ° /usr/bin/ ç›®å½•ä¸‹cp docker/* /usr/bin/ å°†dockeræ³¨å†Œä¸ºservicevim /etc/systemd/system/docker.service å°†ä¸‹åˆ—é…ç½®å¤åˆ¶åˆ°docker.serviceä¸­å¹¶ä¿å­˜ [Unit]Description=Docker Application Container EngineDocumentation=https://docs.docker.comAfter=network-online.target firewalld.serviceWants=network-online.target[Service]Type=notify# the default is not to use systemd for cgroups because the delegate issues still# exists and systemd currently does not support the cgroup feature set required# for containers run by dockerExecStart=/usr/bin/dockerdExecReload=/bin/kill -s HUP $MAINPID# Having non-zero Limit*s causes performance problems due to accounting overhead# in the kernel. We recommend using cgroups to do container-local accounting.LimitNOFILE=infinityLimitNPROC=infinityLimitCORE=infinity# Uncomment TasksMax if your systemd version supports it.# Only systemd 226 and above support this version.#TasksMax=infinityTimeoutStartSec=0# set delegate yes so that systemd does not reset the cgroups of docker containersDelegate=yes# kill only the docker process, not all processes in the cgroupKillMode=process# restart the docker process if it exits prematurelyRestart=on-failureStartLimitBurst=3StartLimitInterval=60s [Install]WantedBy=multi-user.target å¯åŠ¨chmod +x /etc/systemd/system/docker.service #æ·»åŠ æ–‡ä»¶æƒé™å¹¶å¯åŠ¨dockersystemctl daemon-reload #é‡è½½unité…ç½®æ–‡ä»¶systemctl start docker #å¯åŠ¨Dockersystemctl enable docker.service #è®¾ç½®å¼€æœºè‡ªå¯ éªŒè¯systemctl status docker #æŸ¥çœ‹DockerçŠ¶æ€docker -v #æŸ¥çœ‹Dockerç‰ˆæœ¬ å…³é—­swapã€selinuxã€é˜²ç«å¢™swapoff -asystemctl stop firewalld æ·»åŠ k8så®˜æ–¹æºéœ€è¦ç§‘å­¦ä¸Šç½‘ sudo curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | sudo apt-key addsudo cat &lt;&lt;EOF &gt;/etc/apt/sources.list.d/kubernetes.listdeb http://apt.kubernetes.io/ kubernetes-xenial mainEOFsudo apt-get updatesudo apt-get install kubelet=1.16.3-00 kubeadm=1.16.3-00 kubectl=1.16.3-00 kubernetes-cni ä½¿ç”¨kubeadméƒ¨ç½²k8såˆå§‹åŒ–ç¯å¢ƒå› ä¸ºå®˜æ–¹é•œåƒæ¯”è¾ƒæ…¢ï¼Œæ‰€ä»¥ä½¿ç”¨é˜¿é‡Œé•œåƒ $ kubeadm init \\ --image-repository registry.aliyuncs.com/google_containers \\ --kubernetes-version v1.16.3 \\ --pod-network-cidr=10.244.0.0/16...Your Kubernetes control-plane has initialized successfully!To start using your cluster, you need to run the following as a regular user: mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/configYou should now deploy a pod network to the cluster.Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at: https://kubernetes.io/docs/concepts/cluster-administration/addons/You can now join any number of control-plane nodes by copying certificate authorities and service account keys on each node and then running the following as root: kubeadm join 192.168.9.10:6443 --token px979r.mphk9ee5ya8fgy44 \\ --discovery-token-ca-cert-hash sha256:5e7c7cd1cc1f86c0761e54b9380de22968b6b221cb98939c14ab2942223f6f51 \\ --control-plane Then you can join any number of worker nodes by running the following on each as root:kubeadm join 192.168.9.10:6443 --token px979r.mphk9ee5ya8fgy44 \\ --discovery-token-ca-cert-hash sha256:5e7c7cd1cc1f86c0761e54b9380de22968b6b221cb98939c14ab2942223f6f51 æ ¹æ®æç¤ºè®¾ç½® kubeconfig ï¼Œæˆ–è€…æ·»åŠ å­èŠ‚ç‚¹ è®¾ç½®k8sçš„ç½‘ç»œæ’ä»¶ä½¿ç”¨ kubectl get pods -A å‘ç° coredns çŠ¶æ€ä¸æ˜¯ running ï¼Œéœ€è¦é…ç½®ç½‘ç»œæ’ä»¶ $ kubectl apply -f &quot;https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d &#x27;\\n&#x27;)&quot; å®‰è£…helmå»é™¤èŠ‚ç‚¹æ±¡ç‚¹åªæœ‰ä¸€ä¸ªmasterèŠ‚ç‚¹çš„æƒ…å†µä¸‹ï¼ŒmasterèŠ‚ç‚¹ä¸å…è®¸è¿è¡Œèµ„æºï¼Œéœ€è¦å»æ‰æ±¡ç‚¹ $ kubectl get nodesNAME STATUS ROLES AGE VERSIONlinx-dev Ready master 138m v1.16.3$ kubectl describe node linx-dev | grep TaintTaints: node-role.kubernetes.io/master:NoSchedule// å¦‚æœTaintsæ˜¯noneï¼Œåˆ™ä¸éœ€è¦å»é™¤æ±¡ç‚¹kubectl taint nodes linx-dev node-role.kubernetes.io/master:NoSchedule- ä¸‹è½½å®¢æˆ·ç«¯wget https://get.helm.sh/helm-v2.16.3-linux-amd64.tar.gz è§£å‹ç¼©å¹¶æ‹·è´helmäºŒè¿›åˆ¶æ–‡ä»¶tar xf helm-v2.16.3-linux-amd64.tar.gzcp linux-amd64/helm /usr/local/bin æ·»åŠ é˜¿é‡Œäº‘çš„ä»“åº“helm init --client-only --stable-repo-url https://aliacs-app-catalog.oss-cn-hangzhou.aliyuncs.com/charts/helm repo add incubator https://aliacs-app-catalog.oss-cn-hangzhou.aliyuncs.com/charts-incubator/helm repo update åˆ›å»º Kubernetes çš„æœåŠ¡å¸å·å’Œç»‘å®šè§’è‰²// åˆ›å»ºserviceaccountkubectl create serviceaccount --namespace kube-system tiller// åˆ›å»ºè§’è‰²ç»‘å®škubectl create clusterrolebinding tiller-cluster-rule --clusterrole=cluster-admin --serviceaccount=kube-system:tiller åˆ›å»ºæœåŠ¡ç«¯ ä½¿ç”¨-iæŒ‡å®šé˜¿é‡Œäº‘ä»“åº“helm init --service-account tiller --upgrade -i registry.cn-hangzhou.aliyuncs.com/google_containers/tiller:v2.16.3 --stable-repo-url https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts å®‰è£…openebså­˜å‚¨æœåŠ¡éƒ¨ç½²openebskubectl apply -f https://openebs.github.io/charts/openebs-operator-1.5.0.yaml è®¾ç½®é»˜è®¤å­˜å‚¨$ kubectl patch storageclass openebs-hostpath -p &#x27;&#123;&quot;metadata&quot;: &#123;&quot;annotations&quot;:&#123;&quot;storageclass.kubernetes.io/is-default-class&quot;:&quot;true&quot;&#125;&#125;&#125;&#x27;storageclass.storage.k8s.io/openebs-hostpath patched å®‰è£…kubespherekubectl apply -f https://raw.githubusercontent.com/kubesphere/ks-installer/master/kubesphere-minimal.yaml å‚è€ƒHelmç¦»çº¿å®‰è£…","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"linux","slug":"linux","permalink":"https://luckyship.github.io/tags/linux/"},{"name":"kubernetes","slug":"kubernetes","permalink":"https://luckyship.github.io/tags/kubernetes/"},{"name":"debian","slug":"debian","permalink":"https://luckyship.github.io/tags/debian/"}]},{"title":"æ•´ç†é¢è¯•ç›¸å…³","date":"2020-09-05T16:00:00.000Z","path":"2020/09/06/2020-09-06-interview-css/","text":"ç®€å•è®°å½•ä¸€ä¸‹é¢è¯•çš„ä¸€äº›è¦ç‚¹ javascript äº‹ä»¶æœºåˆ¶å…ˆæ•è·ï¼Œåå†’æ³¡ï¼Œæ•è·ä»ä¸Šåˆ°ä¸‹ï¼Œå†’æ³¡ä»ä¸‹åˆ°ä¸Š å†’æ³¡æœºåˆ¶IE æå‡ºçš„äº‹ä»¶æµå«åšäº‹ä»¶å†’æ³¡ï¼Œå³äº‹ä»¶å¼€å§‹æ—¶ç”±æœ€å…·ä½“çš„å…ƒç´ æ¥æ”¶ï¼Œç„¶åé€çº§å‘ä¸Šä¼ æ’­åˆ°è¾ƒä¸ºä¸å…·ä½“çš„èŠ‚ç‚¹ï¼Œçœ‹ä¸€ä¸‹ä»¥ä¸‹ç¤ºä¾‹ &lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;title&gt;Title&lt;/title&gt; &lt;/head&gt; &lt;body onclick=&quot;bodyClick()&quot;&gt; &lt;div onclick=&quot;divClick()&quot;&gt; &lt;button onclick=&quot;btn()&quot;&gt; &lt;p onclick=&quot;p()&quot;&gt;ç‚¹å‡»å†’æ³¡&lt;/p&gt; &lt;/button&gt; &lt;/div&gt; &lt;script&gt; function p() &#123; console.log(&quot;pæ ‡ç­¾è¢«ç‚¹å‡»&quot;); &#125; function btn() &#123; console.log(&quot;buttonè¢«ç‚¹å‡»&quot;); &#125; function divClick(event) &#123; console.log(&quot;divè¢«ç‚¹å‡»&quot;); &#125; function bodyClick() &#123; console.log(&quot;bodyè¢«ç‚¹å‡»&quot;); &#125; &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; ç»“æœæ˜¾è€Œæ˜“è§ pæ ‡ç­¾è¢«ç‚¹å‡»buttonè¢«ç‚¹å‡»divè¢«ç‚¹å‡»bodyè¢«ç‚¹å‡» æ•è·æœºåˆ¶äº‹ä»¶æ•è·æµçš„æ€æƒ³æ˜¯ä¸å¤ªå…·ä½“çš„ DOM èŠ‚ç‚¹åº”è¯¥æ›´æ—©æ¥æ”¶åˆ°äº‹ä»¶ï¼Œè€Œæœ€å…·ä½“çš„èŠ‚ç‚¹åº”è¯¥æœ€åæ¥æ”¶åˆ°äº‹ä»¶ï¼Œé’ˆå¯¹ä¸Šé¢åŒæ ·çš„ä¾‹å­ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œé‚£ä¹ˆæ­¤æ—¶ click äº‹ä»¶ä¼šæŒ‰ç…§è¿™æ ·ä¼ æ’­ï¼šï¼ˆä¸‹é¢æˆ‘ä»¬å°±å€Ÿç”¨ addEventListener çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ¥æ¨¡æ‹Ÿäº‹ä»¶æ•è·æµï¼‰ &lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;title&gt;Title&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div&gt; &lt;button&gt; &lt;p&gt;ç‚¹å‡»æ•è·&lt;/p&gt; &lt;/button&gt; &lt;/div&gt; &lt;script&gt; var oP = document.querySelector(&quot;p&quot;); var oB = document.querySelector(&quot;button&quot;); var oD = document.querySelector(&quot;div&quot;); var oBody = document.querySelector(&quot;body&quot;); oP.addEventListener( &quot;click&quot;, function () &#123; console.log(&quot;pæ ‡ç­¾è¢«ç‚¹å‡»&quot;); &#125;, true ); oB.addEventListener( &quot;click&quot;, function () &#123; console.log(&quot;buttonè¢«ç‚¹å‡»&quot;); &#125;, true ); oD.addEventListener( &quot;click&quot;, function () &#123; console.log(&quot;divè¢«ç‚¹å‡»&quot;); &#125;, true ); oBody.addEventListener( &quot;click&quot;, function () &#123; console.log(&quot;bodyè¢«ç‚¹å‡»&quot;); &#125;, true ); &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; ä¸å†’æ³¡ç›¸åçš„ç»“æœ bodyè¢«ç‚¹å‡»divè¢«ç‚¹å‡»buttonè¢«ç‚¹å‡»pæ ‡ç­¾è¢«ç‚¹å‡» DOM 2 çº§äº‹ä»¶å¤„ç†ç¨‹åºDOM 2 çº§äº‹ä»¶å®šä¹‰äº†ä¸¤æ–¹æ³•ï¼šç”¨äºå¤„ç†æ·»åŠ äº‹ä»¶å’Œåˆ é™¤äº‹ä»¶çš„æ“ä½œï¼š æ·»åŠ äº‹ä»¶ addEventListener()åˆ é™¤äº‹ä»¶ removeEventListener() æ‰€æœ‰ DOM èŠ‚ç‚¹ä¸­éƒ½åŒ…å«è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”ä»–ä»¬éƒ½åŒ…å« 3 ä¸ªå‚æ•°ï¼š ï¼ˆ1ï¼‰ è¦å¤„ç†çš„äº‹ä»¶æ–¹å¼ï¼ˆä¾‹å¦‚ï¼š clickï¼Œmouseover, dbclick..... ï¼‰ ï¼ˆ2ï¼‰äº‹ä»¶å¤„ç†çš„å‡½æ•°ï¼Œå¯ä»¥ä¸ºåŒ¿åå‡½æ•°ï¼Œä¹Ÿå¯ä»¥ä¸ºå‘½åå‡½æ•°ï¼ˆä½†å¦‚æœéœ€è¦åˆ é™¤äº‹ä»¶ï¼Œå¿…é¡»æ˜¯å‘½åå‡½æ•°ï¼‰ ï¼ˆ3ï¼‰ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œä»£è¡¨æ˜¯å¤„äºäº‹ä»¶å†’æ³¡é˜¶æ®µå¤„ç†è¿˜æ˜¯äº‹ä»¶æ•è·é˜¶æ®µï¼ˆtrueï¼šè¡¨ç¤ºåœ¨æ•è·é˜¶æ®µè°ƒç”¨äº‹ä»¶å¤„ç†ç¨‹åºï¼›false: è¡¨ç¤ºåœ¨å†’æ³¡é˜¶æ®µè°ƒç”¨äº‹ä»¶å¤„ç†ç¨‹åºï¼‰ ä½¿ç”¨ DOM 2 çº§äº‹ä»¶å¤„ç†ç¨‹åºçš„ä¸»è¦å¥½å¤„æ˜¯å¯ä»¥æ·»åŠ å¤šä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œäº‹ä»¶å¤„ç†ä¼šæŒ‰ç…§ä»–ä»¬çš„é¡ºåºè§¦å‘ï¼Œé€šè¿‡ addEventListener æ·»åŠ çš„äº‹ä»¶åªèƒ½ç”¨ removeEventListener æ¥ç§»é™¤ï¼Œç§»é™¤æ—¶ä¼ å…¥çš„å‚æ•°ä¸æ·»åŠ æ—¶ä½¿ç”¨çš„å‚æ•°å¿…é¡»ç›¸åŒï¼Œè¿™ä¹Ÿæ„å‘³ç€æ·»åŠ çš„åŒ¿åå‡½æ•°å°†æ— æ³•ç§»é™¤ï¼Œ ï¼ˆæ³¨æ„ï¼šæˆ‘ä»¬é»˜è®¤çš„ç¬¬ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯é»˜è®¤ false , æ˜¯æŒ‡åœ¨å†’æ³¡é˜¶æ®µæ·»åŠ ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œéƒ½æ˜¯å°†äº‹ä»¶å¤„ç†ç¨‹åºæ·»åŠ åˆ°äº‹ä»¶çš„å†’æ³¡é˜¶æ®µï¼Œè¿™æ ·å¯ä»¥æœ€å¤§é™åº¦çš„å…¼å®¹å„ä¸ªæµè§ˆå™¨ï¼‰ css çœç•¥æ–‡å­—çš„å®ç° &#123; overflow: hidden; white-space: nowrap; text-overflow: allipsis;&#125; settimeout, setintervalï¼Œeval åœ¨èµ‹å€¼æ—¶æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿvue è§£å†³è·¨åŸŸé—®é¢˜ä»€ä¹ˆæ˜¯è·¨åŸŸè·¨åŸŸï¼šç”±äºæµè§ˆå™¨åŒæºç­–ç•¥ï¼Œå‡¡æ˜¯å‘é€è¯·æ±‚ url çš„åè®®ã€åŸŸåã€ç«¯å£ä¸‰è€…ä¹‹é—´ä»»æ„ä¸€ä¸ªä¸å½“å‰é¡µé¢åœ°å€ä¸åŒå³ä¸ºè·¨åŸŸã€‚å­˜åœ¨è·¨åŸŸçš„æƒ…å†µï¼š ç½‘ç»œåè®®ä¸åŒï¼Œå¦‚ http åè®®è®¿é—® https åè®®ã€‚ ç«¯å£ä¸åŒï¼Œå¦‚ 80 ç«¯å£è®¿é—® 8080 ç«¯å£ã€‚ åŸŸåä¸åŒï¼Œå¦‚ qianduanblog.com è®¿é—® baidu.comã€‚ å­åŸŸåä¸åŒï¼Œå¦‚ abc.qianduanblog.com è®¿é—® def.qianduanblog.comã€‚ åŸŸåå’ŒåŸŸåå¯¹åº” ip, å¦‚www.a.comè®¿é—®20.205.28.90. ä¸‹é¢æ˜¯é¡¹ç›®ä½¿ç”¨ vue-cli è„šæ‰‹æ¶æ­å»ºä½¿ç”¨ http-proxy-middleware ä»£ç†è§£å†³è·¨åŸŸé—®é¢˜ä¾‹å¦‚è¯·æ±‚çš„ url:â€œhttp://f.apiplus.cn/bj11x5.jsonâ€1ã€æ‰“å¼€ config/index.js, åœ¨ proxyTable ä¸­æ·»å†™å¦‚ä¸‹ä»£ç ï¼š proxyTable: &#123; &#x27;/api&#x27;: &#123; //ä½¿ç”¨&quot;/api&quot;æ¥ä»£æ›¿&quot;http://f.apiplus.c&quot; target: &#x27;http://f.apiplus.cn&#x27;, //æºåœ°å€ changeOrigin: true, //æ˜¯å¦è·¨åŸŸ pathRewrite: &#123; &#x27;^/api&#x27;: &#x27;http://f.apiplus.cn&#x27; //è·¯å¾„é‡å†™ &#125; &#125;&#125; 2ã€ä½¿ç”¨ axios è¯·æ±‚æ•°æ®æ—¶ç›´æ¥ä½¿ç”¨â€œ/apiâ€ï¼š getData() &#123; axios.get(&#x27;/api/bj11x5.json&#x27;, function(res) &#123; console.log(res) &#125;) é€šè¿‡è¿™ä¸­æ–¹æ³•å»è§£å†³è·¨åŸŸï¼Œæ‰“åŒ…éƒ¨ç½²æ—¶è¿˜æŒ‰è¿™ç§æ–¹æ³•ä¼šå‡ºé—®é¢˜ã€‚è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š let serverUrl = &quot;/api/&quot;; //æœ¬åœ°è°ƒè¯•æ—¶// let serverUrl = &#x27;http://f.apiplus.cn/&#x27; //æ‰“åŒ…éƒ¨ç½²ä¸Šçº¿æ—¶ vue è§£å†³ xss æ³¨å…¥é—®é¢˜ åœ¨ç»ˆç«¯å¼•å…¥ xss, å‘½ä»¤ï¼š npm install xss --save åœ¨ vue çš„é¡µé¢è¿›è¡Œå¼•å…¥ import xss from &quot;xss&quot;; å®šä¹‰ä¸€ä¸ªå˜é‡è¿›è¡Œæµ‹è¯•é¦–å…ˆæµ‹è¯•ä¸€ä¸ªæ²¡æœ‰è¿›è¡Œé˜²æ­¢ xss æ”»å‡»çš„æµ‹è¯• &lt; p v - html = &quot;test&quot; &gt; &lt; /p&gt;export default &#123; data() &#123; return &#123; test: `&lt;a onclick=&#x27;alert(&quot;xssæ”»å‡»&quot;)&#x27;&gt;é“¾æ¥&lt;/a&gt;` &#125; ç»“æœï¼Œjs äº‹ä»¶ç›´æ¥è¢«ç¿»è¯‘äº† xssæ”»å‡» å› æ­¤åº”è¯¥æœç»è¿™äº›æƒ…å†µï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ &lt; p v - html = &quot;$xss(test)&quot; &gt; &lt; /p&gt;import xss from &#x27;xss&#x27;export default &#123; data() &#123; return &#123; test: `&lt;a onclick=&#x27;alert(&quot;xssæ”»å‡»&quot;)&#x27;&gt;é“¾æ¥&lt;/a&gt;` &#125; &#125;Vue.prototype.$xss = xss; æ­¤æ—¶ a æ ‡ç­¾ä¼šä¿ç•™ï¼Œä½†æ˜¯ onclick äº‹ä»¶è¢«æ‹¦æˆªäº† vue axios çš„å‡ ç§è¯·æ±‚æ–¹å¼axios çš„è¯·æ±‚æ–¹æ³•ï¼šgetã€postã€putã€patchã€delete getï¼šè·å–æ•°æ® postï¼šæäº¤æ•°æ®ï¼ˆè¡¨å•æäº¤+æ–‡ä»¶ä¸Šä¼ ï¼‰ putï¼šæ›´æ–°æ•°æ®ï¼ˆæ‰€æœ‰æ•°æ®æ¨é€åˆ°åç«¯ï¼‰ patchï¼šæ›´æ–°æ•°æ®ï¼ˆåªå°†æ›´æ”¹çš„æ•°æ®æ¨é€åˆ°åç«¯ï¼‰ deleteï¼šåˆ é™¤æ•°æ® //axiosçš„getè¯·æ±‚ç¬¬ä¸€ç§å†™æ³•ä¸å¸¦å‚æ•°axios.get(&quot;/data.json&quot;).then(res =&gt; &#123; console.log(res);&#125;);//axiosçš„getè¯·æ±‚ç¬¬ä¸€ç§å†™æ³•å¸¦å‚æ•°axios .get(&quot;/data.json&quot;, &#123; params: &#123; id: 12, &#125;, &#125;) .then(res =&gt; &#123; console.log(res); &#125;);//axiosçš„getè¯·æ±‚ç¬¬äºŒç§å†™æ³•ä¸å¸¦å‚æ•°axios(&#123; method: &quot;get&quot;, url: &quot;/data.json&quot;,&#125;).then(res =&gt; &#123; console.log(res);&#125;);//axiosçš„getè¯·æ±‚ç¬¬äºŒç§å†™æ³•å¸¦å‚æ•°axios(&#123; method: &quot;get&quot;, url: &quot;/data.json&quot;, params: &#123; id: 12, &#125;,&#125;).then(res =&gt; &#123; console.log(res);&#125;);//axiosçš„postè¯·æ±‚ç¬¬ä¸€ç§å†™æ³•let data = &#123; id: 12,&#125;;axios.post(&quot;/post&quot;, data).then(res =&gt; &#123; console.log(res);&#125;);//axiosçš„postè¯·æ±‚ç¬¬äºŒç§å†™æ³•axios(&#123; method: &quot;post&quot;, url: &quot;/post&quot;, data: data,&#125;).then(res =&gt; &#123; console.log(res);&#125;);//form-dataè¯·æ±‚,å›¾ç‰‡ä¸Šä¼ ã€æ–‡ä»¶ä¸Šä¼ ï¼Œæ–‡ä»¶æ ¼å¼ä¸ºï¼šmultipart/form-dataï¼Œå…¶ä»–è¯·æ±‚ä¸ºapplication/jsonlet formData = new formData();for (let key in data) &#123; formData.append(key, data[key]);&#125;axios.post(&quot;/post&quot;, formData).then(res =&gt; &#123; console.log(res);&#125;);//axiosä¹‹putè¯·æ±‚axios.put(&quot;/put&quot;, data).then(res =&gt; &#123; console.log(res);&#125;);//axiosä¹‹patchè¯·æ±‚axios.patch(&quot;/patch&quot;, data).then(res =&gt; &#123; console.log(res);&#125;);//axiosä¹‹deleteè¯·æ±‚çš„ç¬¬ä¸€ç§å†™æ³•axios .delete(&quot;/delete&quot;, &#123; params: &#123; id: 12, &#125;, &#125;) .then(res =&gt; &#123; console.log(res); &#125;);//è¯´æ˜:å½“ä½¿ç”¨ç¬¬ä¸€ç§å†™æ³•å‚æ•°ä¸ºparamsæ—¶ï¼Œè¯·æ±‚æ¥å£æ—¶å‚æ•°æ˜¯æ”¾åœ¨URLé‡Œé¢çš„ã€‚// ä¾‹ï¼šhttp://localhost:8080/delete?id=12,è€Œå†™æˆç¬¬äºŒç§æ–¹æ³•dataå°±ä¸ä¼šï¼Œæ ¹æ®å®é™…æƒ…å†µä½¿ç”¨//axiosä¹‹deleteè¯·æ±‚çš„ç¬¬äºŒç§å†™æ³•axios .delete(&quot;/delete&quot;, &#123; data: &#123; id: 12, &#125;, &#125;) .then(res =&gt; &#123; console.log(res); &#125;); js å¦‚ä½•æ¯”è¾ƒæµ®ç‚¹æ•°æµ®ç‚¹æ•°çš„å®šä¹‰ï¼Œéæ•´æ•°çš„ Number ç±»å‹æ— æ³•ç”¨ = æ¥æ¯”è¾ƒï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ JavaScript ä¸­ï¼Œ0.1+0.2 ä¸èƒ½=0.3ï¼š console.log(0.1 + 0.2 == 0.3);false; è¿™é‡Œè¾“å‡ºçš„ç»“æœæ˜¯ false ï¼Œè¯´æ˜ä¸¤è¾¹ä¸ç›¸ç­‰çš„ï¼Œè¿™æ˜¯æµ®ç‚¹è¿ç®—çš„ç‰¹ç‚¹ï¼Œæµ®ç‚¹æ•°è¿ç®—çš„ç²¾åº¦é—®é¢˜å¯¼è‡´ç­‰å¼å·¦å³çš„ç»“æœå¹¶ä¸æ˜¯ä¸¥æ ¼ç›¸ç­‰ï¼Œè€Œæ˜¯ç›¸å·®äº†ä¸ªå¾®å°çš„å€¼ã€‚ æ‰€ä»¥å®é™…ä¸Šï¼Œè¿™é‡Œé”™è¯¯çš„ä¸æ˜¯ç»“è®ºï¼Œè€Œæ˜¯æ¯”è¾ƒçš„æ–¹æ³•ï¼Œæ­£ç¡®çš„æ¯”è¾ƒæ–¹æ³•æ˜¯ä½¿ç”¨ JavaScript æä¾›çš„æœ€å°ç²¾åº¦å€¼ï¼š console.log(Math.abs(0.1 + 0.2 - 0.3) &lt;= Number.EPSILON); é¡¹ç›®åšè¿‡å“ªäº›ä¼˜åŒ– å‡å°‘ HTTP è¯·æ±‚æ•° å‡å°‘DNSæŸ¥è¯¢ ä½¿ç”¨ CDN é¿å…é‡å®šå‘ å›¾ç‰‡æ‡’åŠ è½½ å‡å°‘ DOM å…ƒç´ æ•°é‡ å‡å°‘ DOM æ“ä½œ ä½¿ç”¨å¤–éƒ¨ JavaScript å’Œ CSS å‹ç¼© JavaScript ã€ CSS ã€å­—ä½“ã€å›¾ç‰‡ç­‰ ä¼˜åŒ– CSS Sprite ä½¿ç”¨ iconfont å­—ä½“è£å‰ª å¤šåŸŸååˆ†å‘åˆ’åˆ†å†…å®¹åˆ°ä¸åŒåŸŸå å°½é‡å‡å°‘ iframe ä½¿ç”¨ é¿å…å›¾ç‰‡ src ä¸ºç©º æŠŠæ ·å¼è¡¨æ”¾åœ¨ ä¸­ æŠŠè„šæœ¬æ”¾åœ¨é¡µé¢åº•éƒ¨ é‡æ’å’Œé‡ç»˜ éƒ¨åˆ†æ¸²æŸ“æ ‘ï¼ˆæˆ–è€…æ•´ä¸ªæ¸²æŸ“æ ‘ï¼‰éœ€è¦é‡æ–°åˆ†æå¹¶ä¸”èŠ‚ç‚¹å°ºå¯¸éœ€è¦é‡æ–°è®¡ç®—ã€‚è¿™è¢«ç§°ä¸ºé‡æ’ã€‚æ³¨æ„è¿™é‡Œè‡³å°‘ä¼šæœ‰ä¸€æ¬¡é‡æ’-åˆå§‹åŒ–é¡µé¢å¸ƒå±€ã€‚ ç”±äºèŠ‚ç‚¹çš„å‡ ä½•å±æ€§å‘ç”Ÿæ”¹å˜æˆ–è€…ç”±äºæ ·å¼å‘ç”Ÿæ”¹å˜ï¼Œä¾‹å¦‚æ”¹å˜å…ƒç´ èƒŒæ™¯è‰²æ—¶ï¼Œå±å¹•ä¸Šçš„éƒ¨åˆ†å†…å®¹éœ€è¦æ›´æ–°ã€‚è¿™æ ·çš„æ›´æ–°è¢«ç§°ä¸ºé‡ç»˜ã€‚ ä»€ä¹ˆæƒ…å†µä¼šè§¦å‘é‡æ’å’Œé‡ç»˜ï¼Ÿ æ·»åŠ ã€åˆ é™¤ã€æ›´æ–° DOM èŠ‚ç‚¹ é€šè¿‡ display: none éšè—ä¸€ä¸ª DOM èŠ‚ç‚¹-è§¦å‘é‡æ’å’Œé‡ç»˜ é€šè¿‡ visibility: hidden éšè—ä¸€ä¸ª DOM èŠ‚ç‚¹-åªè§¦å‘é‡ç»˜ï¼Œå› ä¸ºæ²¡æœ‰å‡ ä½•å˜åŒ– ç§»åŠ¨æˆ–è€…ç»™é¡µé¢ä¸­çš„ DOM èŠ‚ç‚¹æ·»åŠ åŠ¨ç”» æ·»åŠ ä¸€ä¸ªæ ·å¼è¡¨ï¼Œè°ƒæ•´æ ·å¼å±æ€§ ç”¨æˆ·è¡Œä¸ºï¼Œä¾‹å¦‚è°ƒæ•´çª—å£å¤§å°ï¼Œæ”¹å˜å­—å·ï¼Œæˆ–è€…æ»šåŠ¨ã€‚ æµè§ˆå™¨ç¼“å­˜ æµè§ˆå™¨ç¼“å­˜åˆ†ä¸ºå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ã€‚å½“å®¢æˆ·ç«¯è¯·æ±‚æŸä¸ªèµ„æºæ—¶ï¼Œè·å–ç¼“å­˜çš„æµç¨‹å¦‚ä¸‹ï¼š å…ˆæ ¹æ®è¿™ä¸ªèµ„æºçš„ä¸€äº› http header åˆ¤æ–­å®ƒæ˜¯å¦å‘½ä¸­å¼ºç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­ï¼Œåˆ™ç›´æ¥ä»æœ¬åœ°è·å–ç¼“å­˜èµ„æºï¼Œä¸* ä¼šå‘è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼› å½“å¼ºç¼“å­˜æ²¡æœ‰å‘½ä¸­æ—¶ï¼Œå®¢æˆ·ç«¯ä¼šå‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é€šè¿‡å¦ä¸€äº› request header éªŒè¯è¿™ä¸ªèµ„æºæ˜¯å¦å‘½* ä¸­åå•†ç¼“å­˜ï¼Œç§°ä¸º http å†éªŒè¯ï¼Œå¦‚æœå‘½ä¸­ï¼ŒæœåŠ¡å™¨å°†è¯·æ±‚è¿”å›ï¼Œä½†ä¸è¿”å›èµ„æºï¼Œè€Œæ˜¯å‘Šè¯‰å®¢æˆ·ç«¯ç›´æ¥ä»ç¼“å­˜* ä¸­è·å–ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°è¿”å›åå°±ä¼šä»ç¼“å­˜ä¸­è·å–èµ„æºï¼› å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜å…±åŒä¹‹å¤„åœ¨äºï¼Œå¦‚æœå‘½ä¸­ç¼“å­˜ï¼ŒæœåŠ¡å™¨éƒ½ä¸ä¼šè¿”å›èµ„æºï¼› åŒºåˆ«æ˜¯ï¼Œå¼ºç¼“å­˜ä¸å¯¹å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œä½†åå•†ç¼“å­˜ä¼šã€‚ å½“åå•†ç¼“å­˜ä¹Ÿæ²¡å‘½ä¸­æ—¶ï¼ŒæœåŠ¡å™¨å°±ä¼šå°†èµ„æºå‘é€å›å®¢æˆ·ç«¯ã€‚ å½“ ctrl+f5 å¼ºåˆ¶åˆ·æ–°ç½‘é¡µæ—¶ï¼Œç›´æ¥ä»æœåŠ¡å™¨åŠ è½½ï¼Œè·³è¿‡å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ï¼› å½“ f5 åˆ·æ–°ç½‘é¡µæ—¶ï¼Œè·³è¿‡å¼ºç¼“å­˜ï¼Œä½†æ˜¯ä¼šæ£€æŸ¥åå•†ç¼“å­˜ï¼› å¼ºç¼“å­˜ Expiresï¼ˆè¯¥å­—æ®µæ˜¯ http1.0 æ—¶çš„è§„èŒƒï¼Œå€¼ä¸ºä¸€ä¸ªç»å¯¹æ—¶é—´çš„ GMT æ ¼å¼çš„æ—¶é—´å­—ç¬¦ä¸²ï¼Œä»£è¡¨ç¼“å­˜èµ„æºçš„è¿‡* æœŸæ—¶é—´ï¼‰ Cache-Control:max-ageï¼ˆè¯¥å­—æ®µæ˜¯ http1.1 çš„è§„èŒƒï¼Œå¼ºç¼“å­˜åˆ©ç”¨å…¶ max-age å€¼æ¥åˆ¤æ–­ç¼“å­˜èµ„æºçš„æœ€å¤§ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒçš„å€¼å•ä½ä¸ºç§’ï¼‰ åå•†ç¼“å­˜ Last-Modifiedï¼ˆå€¼ä¸ºèµ„æºæœ€åæ›´æ–°æ—¶é—´ï¼ŒéšæœåŠ¡å™¨ response è¿”å›ï¼‰ If-Modified-Sinceï¼ˆé€šè¿‡æ¯”è¾ƒä¸¤ä¸ªæ—¶é—´æ¥åˆ¤æ–­èµ„æºåœ¨ä¸¤æ¬¡è¯·æ±‚æœŸé—´æ˜¯å¦æœ‰è¿‡ä¿®æ”¹ï¼Œå¦‚æœæ²¡æœ‰ä¿®æ”¹ï¼Œåˆ™å‘½ä¸­* åå•†ç¼“å­˜ï¼‰ ETagï¼ˆè¡¨ç¤ºèµ„æºå†…å®¹çš„å”¯ä¸€æ ‡è¯†ï¼ŒéšæœåŠ¡å™¨ response è¿”å›ï¼‰ If-None-Matchï¼ˆæœåŠ¡å™¨é€šè¿‡æ¯”è¾ƒè¯·æ±‚å¤´éƒ¨çš„ If-None-Match ä¸å½“å‰èµ„æºçš„ ETag æ˜¯å¦ä¸€è‡´æ¥åˆ¤æ–­èµ„æºæ˜¯å¦åœ¨ä¸¤æ¬¡è¯·æ±‚ä¹‹é—´æœ‰è¿‡ä¿®æ”¹ï¼Œå¦‚æœæ²¡æœ‰ä¿®æ”¹ï¼Œåˆ™å‘½ä¸­åå•†ç¼“å­˜ï¼‰ new æ“ä½œç¬¦å…·ä½“å¹²äº†ä»€ä¹ˆ åˆ›å»ºç©ºå¯¹è±¡ï¼Œå¹¶ä¸” this å˜é‡å¼•ç”¨è¯¥å¯¹è±¡åŒæ—¶ç»§æ‰¿è¯¥å‡½æ•°çš„åŸå‹ å±æ€§å’Œæ–¹æ³•åŠ å…¥åˆ° this å¼•ç”¨çš„å¯¹è±¡ä¸­ æ–°åˆ›å»ºçš„å¯¹è±¡ç”¨ this å¼•ç”¨ï¼Œå¹¶ä¸”éšå¼åœ°è¿”å› this åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡(__proto__ æŒ‡å‘æ„é€ å‡½æ•°çš„ prototype) æŠŠä½œç”¨åŸŸï¼ˆthisï¼‰æŒ‡ç»™è¿™ä¸ªå¯¹è±¡ æ‰§è¡Œæ„é€ å‡½æ•°çš„ä»£ç  å¦‚æœæ„é€ å‡½æ•°ä¸­æ²¡æœ‰è¿”å›å…¶å®ƒå¯¹è±¡ï¼Œé‚£ä¹ˆè¿”å› thisï¼Œå³åˆ›å»ºçš„è¿™ä¸ªçš„æ–°å¯¹è±¡ï¼Œå¦åˆ™ï¼Œè¿”å›æ„é€ å‡½æ•°ä¸­è¿”å›çš„å¯¹è±¡ function Base() &#123; this.id = &quot;base&quot;;&#125;var obj = new Base(); new å¹²äº†ä»€ä¹ˆï¼Ÿ var obj = {}; obj.__proto__ = Base.protptype; Base.call(obj); es5 ä½¿ç”¨ Object.create()æ¥åˆ›å»ºå¯¹è±¡ new Object() å­—é¢é‡å†™æ³•{}ä½¿ç”¨ Object.create()æ˜¯å°†å¯¹è±¡ç»§æ‰¿åˆ°protoå±æ€§ä¸Šï¼ŒObject.create(null)æ²¡æœ‰ç»§æ‰¿ä»»ä½•åŸå‹æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒçš„åŸå‹é“¾æ²¡æœ‰ä¸Šä¸€å±‚ã€‚ es6 ä½¿ç”¨ class å…³é”®å­— æ„é€ å™¨å°±æ˜¯æ™®é€šçš„å‡½æ•°, new æ¥ä½œç”¨ç§°ä¸ºæ„é€ æ–¹æ³•(æ„é€ å‡½æ•°) è®¿é—®åŸå‹é“¾ä¼šæŸè€—æ€§èƒ½, ä¸å­˜åœ¨çš„å±æ€§ä¼šéå†åŸå‹é“¾ç›´åˆ°æœ€åä¸€å±‚ hasOwnProperty æ˜¯ JavaScript ä¸­å”¯ä¸€å¤„ç†å±æ€§å¹¶ä¸”ä¸ä¼šéå†åŸå‹é“¾çš„æ–¹æ³•ã€‚é€šå¸¸åœ¨ for in å¾ªç¯ä¸­ä½¿ç”¨ã€‚ å®ç° new å‡½æ•°function _new(func) &#123; // ç¬¬ä¸€æ­¥ åˆ›å»ºæ–°å¯¹è±¡ let obj = &#123;&#125;; // ç¬¬äºŒæ­¥ ç©ºå¯¹è±¡çš„_proto_æŒ‡å‘äº†æ„é€ å‡½æ•°çš„prototypeæˆå‘˜å¯¹è±¡ obj.__proto__ = func.prototype; // // ä¸€äºŒæ­¥åˆå¹¶å°±ç›¸å½“äº let obj=Object.create(func.prototype) // ç¬¬ä¸‰æ­¥ ä½¿ç”¨applyè°ƒç”¨æ„é€ å™¨å‡½æ•°ï¼Œå±æ€§å’Œæ–¹æ³•è¢«æ·»åŠ åˆ° this å¼•ç”¨çš„å¯¹è±¡ä¸­ let result = func.apply(obj); if (result &amp;&amp; (typeof result == &quot;object&quot; || typeof result == &quot;function&quot;)) &#123; // å¦‚æœæ„é€ å‡½æ•°æ‰§è¡Œçš„ç»“æœè¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆè¿”å›è¿™ä¸ªå¯¹è±¡ return result; &#125; // å¦‚æœæ„é€ å‡½æ•°è¿”å›çš„ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å›åˆ›å»ºçš„æ–°å¯¹è±¡ return obj;&#125;","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"},{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"},{"name":"html","slug":"html","permalink":"https://luckyship.github.io/tags/html/"}]},{"title":"åœ¨centos7ä¸Šä½¿ç”¨kubeadmæ­å»º v1.16.9ç‰ˆæœ¬Kubernetesé›†ç¾¤","date":"2020-09-03T16:00:00.000Z","path":"2020/09/04/2020-09-04-centos-install-k8s/","text":"ç¯å¢ƒå‡†å¤‡å®éªŒç¯å¢ƒ è§’è‰² IPåœ°å€ ä¸»æœºå dockerç‰ˆæœ¬ ç¡¬ä»¶é…ç½® ç³»ç»Ÿ å†…æ ¸ master 192.168.9.10 k8s-master 18.09.9 2c4g CentOS7.7 3.10.0-1062.el7.x86_64 node1 192.168.9.13 k8s-node1 18.09.9 2c6g CentOS7.7 3.10.0-1062.el7.x86_64 node2 192.168.9.14 k8s-node2 18.09.9 2c6g CentOS7.7 3.10.0-1062.el7.x86_64 æ¯ä¸ªèŠ‚ç‚¹é…ç½®hostä¿¡æ¯cat &gt;&gt; /etc/hosts &lt;&lt;EOF192.168.9.10 k8s-master192.168.9.13 k8s-node1192.168.9.14 k8s-node2EOF ç¦ç”¨é˜²ç«å¢™å’Œselinux//ç¦ç”¨é˜²ç«å¢™systemctl stop firewalld &amp;&amp; systemctl disable firewalld//ç¦ç”¨selinux#ä¸´æ—¶ä¿®æ”¹setenforce 0#æ°¸ä¹…ä¿®æ”¹ï¼Œé‡å¯æœåŠ¡å™¨åç”Ÿæ•ˆsed -i &#x27;7s/enforcing/disabled/&#x27; /etc/selinux/config åˆ›å»º /etc/sysctl.d/k8s.conf æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹//å‘æ–‡ä»¶ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹cat &gt;/etc/sysctl.d/k8s.conf &lt;&lt;EOFnet.bridge.bridge-nf-call-ip6tables = 1net.bridge.bridge-nf-call-iptables = 1net.ipv4.ip_forward = 1EOF//æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæ•ˆmodprobe br_netfilter &amp;&amp; sysctl -p /etc/sysctl.d/k8s.conf å®‰è£…ipvsè„šæœ¬åˆ›å»ºäº†çš„ /etc/sysconfig/modules/ipvs.modules æ–‡ä»¶ï¼Œä¿è¯åœ¨èŠ‚ç‚¹é‡å¯åèƒ½è‡ªåŠ¨åŠ è½½æ‰€éœ€æ¨¡å—ã€‚ä½¿ç”¨ lsmod | grep -e ip_vs -e nf_conntrack_ipv4 å‘½ä»¤æŸ¥çœ‹æ˜¯å¦å·²ç»æ­£ç¡®åŠ è½½æ‰€éœ€çš„å†…æ ¸æ¨¡å— //å‘æ–‡ä»¶ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹cat &gt; /etc/sysconfig/modules/ipvs.modules &lt;&lt;EOF#!/bin/bashmodprobe -- ip_vsmodprobe -- ip_vs_rrmodprobe -- ip_vs_wrrmodprobe -- ip_vs_shmodprobe -- nf_conntrack_ipv4EOF//ä¿®æ”¹æƒé™ä»¥åŠæŸ¥çœ‹æ˜¯å¦å·²ç»æ­£ç¡®åŠ è½½æ‰€éœ€çš„å†…æ ¸æ¨¡å—chmod 755 /etc/sysconfig/modules/ipvs.modules &amp;&amp; bash /etc/sysconfig/modules/ipvs.modules &amp;&amp; lsmod | grep -e ip_vs -e nf_conntrack_ipv4nf_conntrack_ipv4 15053 0 nf_defrag_ipv4 12729 1 nf_conntrack_ipv4ip_vs_sh 12688 0 ip_vs_wrr 12697 0 ip_vs_rr 12600 0 ip_vs 145497 6 ip_vs_rr,ip_vs_sh,ip_vs_wrrnf_conntrack 133095 2 ip_vs,nf_conntrack_ipv4libcrc32c 12644 3 xfs,ip_vs,nf_conntrack å®‰è£…ipsetå’Œipvsadm(ä¾¿äºæŸ¥çœ‹ ipvs çš„ä»£ç†è§„åˆ™) yum -y install ipset ipvsadm å…³é—­swapåˆ†åŒºä¿®æ”¹ /etc/fstab æ–‡ä»¶ï¼Œæ³¨é‡Šæ‰ SWAP çš„è‡ªåŠ¨æŒ‚è½½ï¼Œä½¿ç”¨ free -m ç¡®è®¤ swap å·²ç»å…³é—­ //æ‰‹åŠ¨å…³é—­swapswapoff -a//ä¿®æ”¹fstabæ–‡ä»¶ï¼Œæ³¨é‡Šswapè‡ªåŠ¨æŒ‚è½½sed -i &#x27;/^\\/dev\\/mapper\\/centos-swap/c#/dev/mapper/centos-swap swap swap defaults 0 0&#x27; /etc/fstab//æŸ¥çœ‹swapæ˜¯å¦å…³é—­free -mtotal used free shared buff/cache availableMem: 1994 682 612 9 699 1086Swap: 0 0 0 swappiness å‚æ•°è°ƒæ•´ï¼Œä¿®æ”¹ /etc/sysctl.d/k8s.conf æ·»åŠ ä¸‹é¢ä¸€è¡Œ cat &gt;&gt;/etc/sysctl.d/k8s.conf &lt;&lt;EOFvm.swappiness=0EOF//ä½¿é…ç½®ç”Ÿæ•ˆsysctl -p /etc/sysctl.d/k8s.confnet.bridge.bridge-nf-call-ip6tables = 1net.bridge.bridge-nf-call-iptables = 1net.ipv4.ip_forward = 1vm.swappiness = 0 å®‰è£…docker18.09.9 æ·»åŠ é˜¿é‡Œäº‘yumæº yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo æŸ¥çœ‹å¯ç”¨ç‰ˆæœ¬ yum list docker-ce --showduplicates | sort -rå·²åŠ è½½æ’ä»¶ï¼šfastestmirror, langpackså¯å®‰è£…çš„è½¯ä»¶åŒ… * updates: mirrors.aliyun.comLoading mirror speeds from cached hostfile * extras: mirrors.aliyun.comdocker-ce.x86_64 3:19.03.5-3.el7 docker-ce-stabledocker-ce.x86_64 3:19.03.4-3.el7 docker-ce-stableã€‚ã€‚ã€‚ã€‚ã€‚ã€‚docker-ce.x86_64 3:18.09.9-3.el7 docker-ce-stabledocker-ce.x86_64 3:18.09.8-3.el7 docker-ce-stabledocker-ce.x86_64 3:18.09.7-3.el7 docker-ce-stabledocker-ce.x86_64 3:18.09.6-3.el7 docker-ce-stableã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ å®‰è£…docker18.09.9 yum -y install docker-ce-18.09.9-3.el7 docker-ce-cli-18.09.9 å¯åŠ¨dockerå¹¶è®¾ç½®å¼€æœºè‡ªå¯ systemctl enable docker &amp;&amp; systemctl start docker é…ç½®é˜¿é‡Œäº‘dockeré•œåƒåŠ é€Ÿ cat &gt; /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;&#123; &quot;registry-mirrors&quot;: [&quot;https://gqk8w9va.mirror.aliyuncs.com&quot;]&#125;EOF é…ç½®å®Œåé‡å¯docker systemctl restart docker æŸ¥çœ‹åŠ é€Ÿ docker infoæ‰¾åˆ°Registry Mirrorsä¸€è¡ŒRegistry Mirrors: https://gqk8w9va.mirror.aliyuncs.com/ æŸ¥çœ‹dockerç‰ˆæœ¬docker version Client: Version: 18.09.9 API version: 1.39 Go version: go1.11.13 Git commit: 039a7df9ba Built: Wed Sep 4 16:51:21 2019 OS/Arch: linux/amd64 Experimental: falseServer: Docker Engine - Community Engine: Version: 18.09.9 API version: 1.39 (minimum version 1.12) Go version: go1.11.13 Git commit: 039a7df Built: Wed Sep 4 16:22:32 2019 OS/Arch: linux/amd64 Experimental: false è‹¥æœ‰éœ€è¦ç½‘ç»œä»£ç†çš„ï¼Œè¯·åœ¨dockerä¸­é…ç½®ç½‘ç»œä»£ç†ï¼Œå¦åˆ™dockeræ— æ³•ä¸‹è½½é•œåƒ ä¿®æ”¹docker Cgroup Driverä¸ºsystemd#ä¿®æ”¹docker Cgroup Driverä¸ºsystemdå°†/usr/lib/systemd/system/docker.serviceæ–‡ä»¶ä¸­çš„è¿™ä¸€è¡Œ ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sockä¿®æ”¹ä¸º ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemdå¦‚æœä¸ä¿®æ”¹ï¼Œåœ¨æ·»åŠ  worker èŠ‚ç‚¹æ—¶å¯èƒ½ä¼šç¢°åˆ°å¦‚ä¸‹é”™è¯¯[WARNING IsDockerSystemdCheck]: detected &quot;cgroupfs&quot; as the Docker cgroup driver. The recommended driver is &quot;systemd&quot;. Please follow the guide at https://kubernetes.io/docs/setup/cri///ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ä¿®æ”¹ sed -i.bak &quot;s#^ExecStart=/usr/bin/dockerd.*#ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --exec-opt native.cgroupdriver=systemd#g&quot; /usr/lib/systemd/system/docker.service//é‡å¯dockersystemctl daemon-reload &amp;&amp; systemctl restart docker å®‰è£…Kubeadméœ€è¦ç§‘å­¦ä¸Šç½‘ cat &gt;/etc/yum.repos.d/kubernetes.repo&lt;&lt;EOF[kubernetes]name=Kubernetesbaseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64enabled=1gpgcheck=1repo_gpgcheck=1gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg https://packages.cloud.google.com/yum/doc/rpm-package-key.gpgEOF ä½¿ç”¨é˜¿é‡Œäº‘yumæº cat &gt;/etc/yum.repos.d/kubernetes.repo &lt;&lt;EOF[kubernetes]name=Kubernetesbaseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64enabled=1gpgcheck=0repo_gpgcheck=0gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpgEOF å®‰è£… kubeadmã€kubeletã€kubectl(é˜¿é‡Œäº‘yumæºä¼šéšå®˜æ–¹æ›´æ–°æœ€æ–°ç‰ˆï¼Œå› æ­¤æŒ‡å®šç‰ˆæœ¬) //å®‰è£…1.16.9ç‰ˆæœ¬yum -y install kubelet-1.16.9 kubeadm-1.16.9 kubectl-1.16.9//æŸ¥çœ‹ç‰ˆæœ¬kubeadm versionkubeadm version: &amp;version.Info&#123;Major:&quot;1&quot;, Minor:&quot;16&quot;, GitVersion:&quot;v1.16.9&quot;, GitCommit:&quot;a17149e1a189050796ced469dbd78d380f2ed5ef&quot;, GitTreeState:&quot;clean&quot;, BuildDate:&quot;2020-04-16T11:42:30Z&quot;, GoVersion:&quot;go1.13.9&quot;, Compiler:&quot;gc&quot;, Platform:&quot;linux/amd64&quot;&#125; è®¾ç½®kubeletå¼€æœºè‡ªå¯ systemctl enable kubelet è®¾ç½®k8så‘½ä»¤è‡ªåŠ¨è¡¥å…¨ yum -y install bash-completionsource /usr/share/bash-completion/bash_completionsource &lt;(kubectl completion bash)echo &quot;source &lt;(kubectl completion bash)&quot; &gt;&gt; ~/.bashrc åˆå§‹åŒ–é›†ç¾¤masterèŠ‚ç‚¹æ“ä½œï¼Œé…ç½® kubeadm åˆå§‹åŒ–æ–‡ä»¶cat &lt;&lt;EOF &gt; ./kubeadm-config.yamlapiVersion: kubeadm.k8s.io/v1beta2kind: ClusterConfigurationkubernetesVersion: v1.16.9 imageRepository: registry.cn-hangzhou.aliyuncs.com/google_containers#masteråœ°å€controlPlaneEndpoint: &quot;192.168.9.10:6443&quot; networking: serviceSubnet: &quot;10.96.0.0/16&quot; #k8så®¹å™¨ç»„æ‰€åœ¨çš„ç½‘æ®µ podSubnet: &quot;10.20.0.1/16&quot; dnsDomain: &quot;cluster.local&quot;EOF åˆå§‹åŒ–master #kubeadm init --config=kubeadm-config.yaml --upload-certså®Œæ•´è¾“å‡ºç»“æœkubeadm init --config=kubeadm-config.yaml[init] Using Kubernetes version: v1.16.9[preflight] Running pre-flight checks[preflight] Pulling images required for setting up a Kubernetes cluster[preflight] This might take a minute or two, depending on the speed of your internet connection[preflight] You can also perform this action in beforehand using &#x27;kubeadm config images pull&#x27;[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;[kubelet-start] Activating the kubelet service[certs] Using certificateDir folder &quot;/etc/kubernetes/pki&quot;[certs] Generating &quot;ca&quot; certificate and key[certs] Generating &quot;apiserver&quot; certificate and key[certs] apiserver serving cert is signed for DNS names [k8s-master kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 192.168.9.10 192.168.9.10][certs] Generating &quot;apiserver-kubelet-client&quot; certificate and key[certs] Generating &quot;front-proxy-ca&quot; certificate and key[certs] Generating &quot;front-proxy-client&quot; certificate and key[certs] Generating &quot;etcd/ca&quot; certificate and key[certs] Generating &quot;etcd/server&quot; certificate and key[certs] etcd/server serving cert is signed for DNS names [k8s-master localhost] and IPs [192.168.9.10 127.0.0.1 ::1][certs] Generating &quot;etcd/peer&quot; certificate and key[certs] etcd/peer serving cert is signed for DNS names [k8s-master localhost] and IPs [192.168.9.10 127.0.0.1 ::1][certs] Generating &quot;etcd/healthcheck-client&quot; certificate and key[certs] Generating &quot;apiserver-etcd-client&quot; certificate and key[certs] Generating &quot;sa&quot; key and public key[kubeconfig] Using kubeconfig folder &quot;/etc/kubernetes&quot;[kubeconfig] Writing &quot;admin.conf&quot; kubeconfig file[kubeconfig] Writing &quot;kubelet.conf&quot; kubeconfig file[kubeconfig] Writing &quot;controller-manager.conf&quot; kubeconfig file[kubeconfig] Writing &quot;scheduler.conf&quot; kubeconfig file[control-plane] Using manifest folder &quot;/etc/kubernetes/manifests&quot;[control-plane] Creating static Pod manifest for &quot;kube-apiserver&quot;[control-plane] Creating static Pod manifest for &quot;kube-controller-manager&quot;[control-plane] Creating static Pod manifest for &quot;kube-scheduler&quot;[etcd] Creating static Pod manifest for local etcd in &quot;/etc/kubernetes/manifests&quot;[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory &quot;/etc/kubernetes/manifests&quot;. This can take up to 4m0s[apiclient] All control plane components are healthy after 16.501777 seconds[upload-config] Storing the configuration used in ConfigMap &quot;kubeadm-config&quot; in the &quot;kube-system&quot; Namespace[kubelet] Creating a ConfigMap &quot;kubelet-config-1.16&quot; in namespace kube-system with the configuration for the kubelets in the cluster[upload-certs] Skipping phase. Please see --upload-certs[mark-control-plane] Marking the node k8s-master as control-plane by adding the label &quot;node-role.kubernetes.io/master=&#x27;&#x27;&quot;[mark-control-plane] Marking the node k8s-master as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule][bootstrap-token] Using token: px979r.mphk9ee5ya8fgy44[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles[bootstrap-token] configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials[bootstrap-token] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token[bootstrap-token] configured RBAC rules to allow certificate rotation for all node client certificates in the cluster[bootstrap-token] Creating the &quot;cluster-info&quot; ConfigMap in the &quot;kube-public&quot; namespace[addons] Applied essential addon: CoreDNS[addons] Applied essential addon: kube-proxyYour Kubernetes control-plane has initialized successfully!To start using your cluster, you need to run the following as a regular user: mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/configYou should now deploy a pod network to the cluster.Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at: https://kubernetes.io/docs/concepts/cluster-administration/addons/You can now join any number of control-plane nodes by copying certificate authorities and service account keys on each node and then running the following as root: kubeadm join 192.168.9.10:6443 --token px979r.mphk9ee5ya8fgy44 \\ --discovery-token-ca-cert-hash sha256:5e7c7cd1cc1f86c0761e54b9380de22968b6b221cb98939c14ab2942223f6f51 \\ --control-plane Then you can join any number of worker nodes by running the following on each as root:kubeadm join 192.168.9.10:6443 --token px979r.mphk9ee5ya8fgy44 \\ --discovery-token-ca-cert-hash sha256:5e7c7cd1cc1f86c0761e54b9380de22968b6b221cb98939c14ab2942223f6f51 æ‹·è´ kubeconfig æ–‡ä»¶ //è¿™é‡Œçš„è·¯å¾„ä¸º/rootmkdir -p $HOME/.kubecp -i /etc/kubernetes/admin.conf $HOME/.kube/configchown $(id -u):$(id -g) $HOME/.kube/config masteræ·»åŠ èŠ‚ç‚¹node1å’Œnode2ç›¸åŒæ“ä½œå°†masterèŠ‚ç‚¹ä¸Šçš„$HOME/.kube/config æ–‡ä»¶æ‹·è´åˆ°nodeèŠ‚ç‚¹å¯¹åº”çš„æ–‡ä»¶ä¸­ 1.åˆ›å»ºç›®å½•ï¼Œè¿™é‡Œçš„è·¯å¾„ä¸º/rootmkdir -p $HOME/.kube 2.æŠŠmasterèŠ‚ç‚¹ä¸Šçš„configæ–‡ä»¶æ‹·è´åˆ°node1å’Œnode2çš„$HOME/.kubescp k8s-master1:~/.kube/config $HOME/.kube3.ä¿®æ”¹æƒé™chown $(id -u):$(id -g) $HOME/.kube/config å°†node1å’Œnode2åŠ å…¥åˆ°é›†ç¾¤ä¸­è¿™é‡Œéœ€è¦ç”¨åˆ°2.2ä¸­åˆå§‹åŒ–masteræœ€åç”Ÿæˆçš„tokenå’Œsha256å€¼ #kubeadm join 192.168.9.10:6443 --token px979r.mphk9ee5ya8fgy44 --discovery-token-ca-cert-hash sha256:5e7c7cd1cc1f86c0761e54b9380de22968b6b221cb98939c14ab2942223f6f51 è¾“å‡ºç»“æœ [preflight] Running pre-flight checks [WARNING IsDockerSystemdCheck]: detected &quot;cgroupfs&quot; as the Docker cgroup driver. The recommended driver is &quot;systemd&quot;. Please follow the guide at https://kubernetes.io/docs/setup/cri/[preflight] Reading configuration from the cluster...[preflight] FYI: You can look at this config file with &#x27;kubectl -n kube-system get cm kubeadm-config -oyaml&#x27;[kubelet-start] Downloading configuration for the kubelet from the &quot;kubelet-config-1.16&quot; ConfigMap in the kube-system namespace[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;[kubelet-start] Activating the kubelet service[kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap...This node has joined the cluster:* Certificate signing request was sent to apiserver and a response was received.* The Kubelet was informed of the new secure connection details.Run &#x27;kubectl get nodes&#x27; on the control-plane to see this node join the cluster. å¦‚æœå¿˜è®°äº†tokenå’Œsha256å€¼ï¼Œå¯ä»¥åœ¨masterèŠ‚ç‚¹ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹ //æŸ¥çœ‹token#kubeadm token listTOKEN TTL EXPIRES USAGES DESCRIPTION EXTRA GROUPSpx979r.mphk9ee5ya8fgy44 20h 2020-03-18T13:49:48+08:00 authentication,signing &lt;none&gt; system:bootstrappers:kubeadm:default-node-token //æŸ¥çœ‹sha256#openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2&gt;/dev/null | openssl dgst -sha256 -hex | sed &#x27;s/^.* //&#x27;5e7c7cd1cc1f86c0761e54b9380de22968b6b221cb98939c14ab2942223f6f51//åŒæ—¶æŸ¥çœ‹tokenå’Œsha256#kubeadm token create --print-join-commandkubeadm join 192.168.9.10:6443 --token 9b28zg.oyt0kvvpmtrem4bg --discovery-token-ca-cert-hash sha256:5e7c7cd1cc1f86c0761e54b9380de22968b6b221cb98939c14ab2942223f6f51 masterèŠ‚ç‚¹æŸ¥çœ‹nodeï¼Œå‘ç°çŠ¶æ€éƒ½æ˜¯NotReadyï¼Œå› ä¸ºè¿˜æ²¡æœ‰å®‰è£…ç½‘ç»œæ’ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬å®‰è£…calioå®˜æ–¹æ’ä»¶æ–‡æ¡£ kubectl get nodesNAME STATUS ROLES AGE VERSIONk8s-master NotReady master 19m v1.16.9k8s-node1 NotReady &lt;none&gt; 4m10s v1.16.9k8s-node2 NotReady &lt;none&gt; 4m3s v1.16.9 masterèŠ‚ç‚¹å®‰è£…ç½‘ç»œæ’ä»¶calio//ä¸‹è½½æ–‡ä»¶wget https://docs.projectcalico.org/v3.8/manifests/calico.yaml å°†æ–‡ä»¶ä¸­çš„620è¡Œæ”¹ä¸ºå¦‚ä¸‹ï¼Œå› ä¸ºåœ¨ä¸Šè¾¹kubeadm-config.yamlé…ç½®æ–‡ä»¶ä¸­æŒ‡å®šäº†å®¹å™¨ç»„IP 620è¡Œvalue: &quot;10.20.0.1/16&quot; //ä¿®æ”¹å®Œæˆåå®‰è£…calicoç½‘ç»œæ’ä»¶kubectl apply -f calico.yaml//å®‰è£…å®Œæˆåç¨ç­‰ä¸€ä¼šæŸ¥çœ‹podsçŠ¶æ€kubectl get pods -n kube-systemNAME READY STATUS RESTARTS AGEcalico-kube-controllers-dc6cb64cb-8sh59 1/1 Running 0 6m22scalico-node-89s9k 1/1 Running 0 6m22scalico-node-dkt7w 1/1 Running 0 6m22scalico-node-tgg2h 1/1 Running 0 6m22scoredns-667f964f9b-7hrj9 1/1 Running 0 33mcoredns-667f964f9b-8q7sh 1/1 Running 0 33metcd-k8s-master 1/1 Running 0 33mkube-apiserver-k8s-master 1/1 Running 0 32mkube-controller-manager-k8s-master 1/1 Running 0 33mkube-proxy-b2r5d 1/1 Running 0 12mkube-proxy-nd982 1/1 Running 0 11mkube-proxy-zh6cz 1/1 Running 0 33mkube-scheduler-k8s-master 1/1 Running 0 32m//æŸ¥çœ‹nodeçŠ¶æ€[root@k8s-master ~]# kubectl get nodes NAME STATUS ROLES AGE VERSIONk8s-master Ready master 31m v1.16.9k8s-node1 Ready &lt;none&gt; 9m46s v1.16.9k8s-node2 Ready &lt;none&gt; 9m22s v1.16.9 å®‰è£…Dashboard(å¯é€‰)ä¸‹è½½æ–‡ä»¶åŠä¿®æ”¹å†…å®¹ è¿™é‡ŒæŸ¥çœ‹dashboardå¯¹åº”çš„k8sç‰ˆæœ¬ //ä¸‹è½½æ–‡ä»¶ v2.0.0-rc3æ˜¯ä¸­æ–‡ç‰ˆæœ¬ï¼Œbeta8æ˜¯è‹±æ–‡ç‰ˆæœ¬wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0-beta8/aio/deploy/recommended.yamlwget https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.0-rc3/aio/deploy/recommended.yaml //ä¿®æ”¹Serviceä¸ºNodePortç±»å‹42è¡Œä¸‹å¢åŠ ä¸€è¡ŒnodePort: 30001 44è¡Œä¸‹å¢åŠ ä¸€è¡Œtype: NodePort //åŸå…ˆå†…å®¹spec: ports: - port: 443 targetPort: 8443 selector: k8s-app: kubernetes-dashboard//ä¿®æ”¹åå†…å®¹spec: ports: - port: 443 targetPort: 8443 nodePort: 30001 #å¢åŠ ï¼ŒæŒ‡å®šnodeportç«¯å£ selector: k8s-app: kubernetes-dashboard type: NodePort #å¢åŠ ï¼Œä¿®æ”¹ç±»å‹ä¸ºnodeport éƒ¨ç½²dashboard kubectl apply -f recommended.yaml æŸ¥çœ‹dashboardçš„è¿è¡ŒçŠ¶æ€åŠå¤–ç½‘è®¿é—®ç«¯å£ //æŸ¥çœ‹dashboardè¿è¡ŒçŠ¶æ€#kubectl get pods -n kubernetes-dashboard -l k8s-app=kubernetes-dashboardNAME READY STATUS RESTARTS AGEkubernetes-dashboard-5996555fd8-2ppc5 1/1 Running 0 8m16s//æŸ¥çœ‹dashboardå¤–ç½‘è®¿é—®ç«¯å£ï¼Œå‘½åç©ºé—´ä¸ºkubernetes-dashboard#kubectl get svc -n kubernetes-dashboard -l k8s-app=kubernetes-dashboardkubectl get svc -n kubernetes-dashboard -l k8s-app=kubernetes-dashboardNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGEkubernetes-dashboard NodePort 10.96.142.172 &lt;none&gt; 443:30001/TCP 8m37s é€šè¿‡ä¸Šè¾¹çš„30001ç«¯å£è®¿é—®dashboardï¼Œæ³¨æ„æ˜¯https k8s1.16.9è¿™ä¸ªç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨çš„dashboardç‰ˆæœ¬æ˜¯2.0.0-beta8ï¼Œåªæœ‰ç«ç‹æµè§ˆå™¨å¯ä»¥è®¿é—®ï¼Œå…¶ä½™æµè§ˆå™¨éƒ½ä¸èƒ½è®¿é—®ï¼Œä¼šæŠ¥é”™ æ‚¨çš„è¿æ¥ä¸æ˜¯ç§å¯†è¿æ¥ ä½¿ç”¨ç«ç‹æµè§ˆå™¨è®¿é—®ï¼Œç”±äº dashboard é»˜è®¤æ˜¯è‡ªå»ºçš„ https è¯ä¹¦ï¼Œè¯¥è¯ä¹¦æ˜¯ä¸å—æµè§ˆå™¨ä¿¡ä»»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¼ºåˆ¶è·³è½¬å°±å¯ä»¥äº† ç„¶ååˆ›å»ºä¸€ä¸ªå…·æœ‰å…¨å±€æ‰€æœ‰æƒé™çš„ç”¨æˆ·æ¥ç™»å½•Dashboard //ç¼–è¾‘admin.yamlæ–‡ä»¶cat &gt; admin.yaml &lt;&lt;EOFkind: ClusterRoleBindingapiVersion: rbac.authorization.k8s.io/v1beta1metadata: name: admin annotations: rbac.authorization.kubernetes.io/autoupdate: &quot;true&quot;roleRef: kind: ClusterRole name: cluster-admin apiGroup: rbac.authorization.k8s.iosubjects:- kind: ServiceAccount name: admin namespace: kube-system---apiVersion: v1kind: ServiceAccountmetadata: name: admin namespace: kube-system labels: kubernetes.io/cluster-service: &quot;true&quot; addonmanager.kubernetes.io/mode: ReconcileEOF//ç›´æ¥åˆ›å»ºkubectl apply -f admin.yaml//æŸ¥çœ‹tokenkubectl get secret -n kube-system|grep admin-tokenadmin-token-j7sfh kubernetes.io/service-account-token 3 23s//è·å–base64è§£ç åçš„å­—ç¬¦ä¸²ï¼Œæ³¨æ„éœ€è¦ç”¨åˆ°ä¸Šè¾¹å‘½ä»¤æŸ¥çœ‹åˆ°çš„tokenï¼Œä¼šç”Ÿæˆå¾ˆé•¿çš„ä¸€ä¸²å­—ç¬¦ä¸²kubectl get secret admin-token-j7sfh -o jsonpath=&#123;.data.token&#125; -n kube-system |base64 -d#ç›´æ¥ç”¨è¿™æ¡å‘½ä»¤æå®škubectl get secret `kubectl get secret -n kube-system|grep admin-token|awk &#x27;&#123;print $1&#125;&#x27;` -o jsonpath=&#123;.data.token&#125; -n kube-system |base64 -d &amp;&amp; echo åˆ°æ­¤ï¼Œä½¿ç”¨kubeadmå®‰è£…k8s 1.16.9å®Œæˆï¼ï¼ï¼ å‚è€ƒåœ¨ Kubernetesé›†ç¾¤ä¸­ å®‰è£… KubeSphere2.1","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"linux","slug":"linux","permalink":"https://luckyship.github.io/tags/linux/"},{"name":"kubernetes","slug":"kubernetes","permalink":"https://luckyship.github.io/tags/kubernetes/"},{"name":"centos","slug":"centos","permalink":"https://luckyship.github.io/tags/centos/"}]},{"title":"linuxè¿æ¥è“ç‰™çš„æ–¹æ³•","date":"2020-05-10T16:00:00.000Z","path":"2020/05/11/2020-05-11-linux-connect-blueteeth/","text":"è¿æ¥è“ç‰™é¦–å…ˆç¡®å®šæœ‰è“ç‰™è®¾å¤‡ï¼Œæ²¡æœ‰å»ç½‘ä¸Šè´­ä¹°è“ç‰™å‘å°„å™¨ $ lsusbBus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hubBus 001 Device 004: ID 17ef:608d LenovoBus 001 Device 003: ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)Bus 001 Device 002: ID 17ef:6099 LenovoBus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub ç„¶åè¿è¡Œæ¿€æ´»è“ç‰™è®¾å¤‡ $ hciconfighci0: Type: Primary Bus: USB BD Address: 00:1A:7D:DA:71:11 ACL MTU: 310:10 SCO MTU: 64:8 UP RUNNING PSCAN RX bytes:1009522 acl:55943 sco:0 events:201 errors:0 TX bytes:4712 acl:49 sco:0 commands:90 errors:0$ sudo hciconfig hci0 up ä½¿ç”¨bluetoothctlå»è¿æ¥è“ç‰™ $ bluetoothctl[bluetooth]# scan on å¼€å§‹æ‰«æ[bluetooth]# pair 01:02:03:04:05:06 åé¢çš„macåœ°å€æ˜¯ä½ çš„é”®ç›˜macåœ°å€[bluetooth]# trust 01:02:03:04:05:06 æŠŠé”®ç›˜è®¾ç½®ä¸ºå¯ä¿¡è®¾å¤‡[bluetooth]# connect 01:02:03:04:05:06 è¿›è¡Œå¯¹æ¥ å‚è€ƒLinuxä¸‹çš„è“ç‰™é”®ç›˜å¯¹æ¥åœ¨Linuxç³»ç»Ÿä¸­ä½¿ç”¨è“ç‰™åŠŸèƒ½çš„åŸºæœ¬æ–¹æ³•","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"linux","slug":"linux","permalink":"https://luckyship.github.io/tags/linux/"}]},{"title":"dockerçš„httpä»£ç†","date":"2019-10-28T16:00:00.000Z","path":"2019/10/29/2019-10-29-proxy-of-docker/","text":"æ­¥éª¤è§£å†³ä»£ç†çš„æ–¹æ³•ï¼Œå‚è€ƒå®˜ç½‘æ•™ç¨‹https://docs.docker.com/config/daemon/systemd/#httphttps-proxy åˆ›å»ºæ–‡ä»¶å¤¹sudo mkdir -p /etc/systemd/system/docker.service.d åˆ›å»ºé…ç½®æ–‡ä»¶cd /etc/systemd/system/docker.service.dtouch http-proxy.conf åœ¨http-proxy.confä¸­æ·»åŠ httpä»£ç†[Service] Environment=&quot;HTTP_PROXY=http://proxy.example.com:80/&quot; &quot;NO_PROXY=localhost,127.0.0.1&quot; æ›´æ–°ï¼Œä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆsudo systemctl daemon-reload é‡å¯dockeræœåŠ¡sudo systemctl restart docker æ£€æŸ¥é…ç½®æ˜¯å¦ç”Ÿæ•ˆ$ systemctl show --property=Environment docker dockeræ¢æºã€è®¾ç½®ç§æœ‰é•œåƒä»“åº“[root@k8s-master ~]# cat /etc/docker/daemon.json&#123; &quot;registry-mirrors&quot;: [&quot;https://gqk8w9va.mirror.aliyuncs.com&quot;], &quot;insecure-registries&quot;:[&quot;193.160.60.94&quot;]&#125; è½¬è½½é…ç½®Dockerçš„HTTPä»£ç†","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"docker","slug":"docker","permalink":"https://luckyship.github.io/tags/docker/"}]},{"title":"cssä¸­çš„ç™¾åˆ†æ¯”","date":"2019-10-21T16:00:00.000Z","path":"2019/10/22/2019-10-22-percentage-of-css/","text":"cssä¸­çš„ç™¾åˆ†æ¯”CSSæ”¯æŒå¤šç§å•ä½å½¢å¼ï¼Œå¦‚ç™¾åˆ†æ¯”ã€pxã€ptã€remç­‰ï¼Œç™¾åˆ†æ¯”å’Œpxæ˜¯å¸¸ç”¨çš„å•ä½ï¼Œéšç€ç§»åŠ¨ç«¯å’Œå“åº”å¼çš„æµè¡Œï¼Œremã€vhã€vwä¹Ÿå¼€å§‹æ™®éä½¿ç”¨ã€‚é‚£ä¹ˆå…ƒç´ çš„ç™¾åˆ†æ¯”åˆ°åº•æ˜¯æ€æ ·è®¡ç®—å‡ºæ¥çš„ï¼Ÿ margin, padding&lt;div style=&quot;width: 20px&quot;&gt; &lt;div id=&quot;temp1&quot; style=&quot;margin-top: 50%&quot;&gt;Test top&lt;/div&gt; &lt;div id=&quot;temp2&quot; style=&quot;margin-right: 25%&quot;&gt;Test right&lt;/div&gt; &lt;div id=&quot;temp3&quot; style=&quot;margin-bottom: 75%&quot;&gt;Test bottom&lt;/div&gt; &lt;div id=&quot;temp4&quot; style=&quot;margin-left: 100%&quot;&gt;Test left&lt;/div&gt;&lt;/div&gt; å¾—åˆ°çš„offsetå¦‚ä¸‹ï¼š temp1.marginTop = 20px * 50% = 10px;temp2.marginRight = 20px * 25% = 5px;temp3.marginBottom = 20px * 75% = 15px;temp4.marginLeft = 20px * 100% = 20px; å½“æŒ‰ç™¾åˆ†æ¯”è®¾å®šä¸€ä¸ªå…ƒç´ çš„å®½åº¦æ—¶ï¼Œå®ƒæ˜¯ç›¸å¯¹äºçˆ¶å®¹å™¨çš„å®½åº¦è®¡ç®—çš„ï¼Œ å…ƒç´ ç«–å‘çš„ç™¾åˆ†æ¯”è®¾å®šä¹Ÿæ˜¯ç›¸å¯¹äºå®¹å™¨çš„å®½åº¦ï¼Œè€Œä¸æ˜¯é«˜åº¦ å®šä½å…ƒç´  top&lt;div style=&quot;height: 100px; width: 50px&quot;&gt; &lt;div id=&quot;temp1&quot; style=&quot;position: relative; top: 50%&quot;&gt;Test top&lt;/div&gt; &lt;div id=&quot;temp2&quot; style=&quot;position: relative; right: 25%&quot;&gt;Test right&lt;/div&gt; &lt;div id=&quot;temp3&quot; style=&quot;position: relative; bottom: 75%&quot;&gt;Test bottom&lt;/div&gt; &lt;div id=&quot;temp4&quot; style=&quot;position: relative; left: 100%&quot;&gt;Test left&lt;/div&gt;&lt;/div&gt; å¾—åˆ°çš„offsetå¦‚ä¸‹ï¼š temp1.top = 100px * 50% = 50px;temp2.right = 50px * 25% = 12.5px;temp3.bottom = 100px * 75% = 75px;temp4.left = 50px * 100% = 50px; æ‰€ä»¥ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå½“ä¸ºå®šä½å…ƒç´ æ—¶ï¼Œtopã€bottomã€rightã€leftæ˜¯æŒ‰çˆ¶å…ƒç´ å¯¹åº”çš„å®½åº¦å’Œé«˜åº¦è®¡ç®—çš„ã€‚ è¡¥å……å½“æˆ‘ä»¬æ”¹å˜ä¹¦å†™æ¨¡å¼ä¸ºå‚ç›´çš„æ—¶å€™ï¼Œmarginç­‰çš„å‚ç…§å°±å˜ä¸ºé«˜åº¦äº† #demo &#123; -webkit-writing-mode: vertical-rl; /* for browsers of webkit engine */ writing-mode: tb-rl; /* for ie */&#125; ä½ æ˜¯å¦è§‰å¾—è¿™ä¸ç¬¦åˆå¸¸è§„çš„æ„Ÿæ€§è®¤çŸ¥ï¼Ÿæ„Ÿæ€§è®¤çŸ¥æ›´å¤šæ„Ÿè§‰åº”è¯¥æ¨ªå‘å‚ç…§åŒ…å«å—å®½åº¦ï¼Œçºµå‘å‚ç…§åŒ…å«å—é«˜åº¦ã€‚å…¶å®è¿™æ˜¯ä¸ºäº†è¦æ¨ªå‘å’Œçºµå‘2ä¸ªæ–¹å‘éƒ½åˆ›å»ºç›¸åŒçš„ marginï¼Œå¦‚æœå®ƒä»¬çš„å‚ç…§ç‰©ä¸ä¸€è‡´ï¼Œé‚£å°±æ— æ³•å¾—åˆ°ä¸¤ä¸ªæ–¹å‘ç›¸åŒçš„ç•™ç™½ã€‚ ä½ å¯èƒ½ä¼šé—®é‚£ä¸ºä»€ä¹ˆè¦é€‰æ‹©å®½åº¦åšå‚ç…§è€Œä¸æ˜¯é«˜åº¦å‘¢ï¼Ÿè¿™å…¶å®æ›´å¤šçš„è¦ä» CSS è®¾è®¡æ„å›¾ä¸Šå»æƒ³ï¼Œå› ä¸ºCSSçš„åŸºç¡€éœ€æ±‚æ˜¯æ’ç‰ˆï¼Œè€Œé€šå¸¸æˆ‘ä»¬æ‰€è§çš„æ¨ªæ’æ–‡å­—ï¼Œå…¶æ°´å¹³å®½åº¦ä¸€å®šï¼ˆä»”ç»†å›æƒ³ä¸€ä¸‹ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼çš„å®šä¹‰å®½åº¦æˆ–è€…å¼ºåˆ¶ä¸€è¡Œæ˜¾ç¤ºï¼Œéƒ½ä¼šé‡åˆ°è¾¹ç•Œæ¢è¡Œï¼Œè€Œä¸æ˜¯æ°´å¹³å»¶å±•ï¼‰ï¼Œå‚ç›´æ–¹å‘å¯ä»¥æ— é™å»¶å±•ã€‚ä½†å½“ä¹¦å†™æ¨¡å¼ä¸ºçºµå‘æ—¶ï¼Œå…¶å‚ç…§å°±å˜æˆäº†é«˜åº¦è€Œä¸å†æ˜¯å®½åº¦äº†ã€‚ å‚è€ƒcssä¸­çš„ç™¾åˆ†æ¯”è®¡ç®—æ–¹æ³•","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"mongo","slug":"mongo","permalink":"https://luckyship.github.io/tags/mongo/"},{"name":"ruby","slug":"ruby","permalink":"https://luckyship.github.io/tags/ruby/"}]},{"title":"flexå¸ƒå±€","date":"2019-05-26T16:00:00.000Z","path":"2019/05/27/2019-05-27-flexå¸ƒå±€/","text":"flexå¸ƒå±€æ˜¯ä»€ä¹ˆFlexæ˜¯Flexible Boxçš„ç¼©å†™ï¼Œæ„ä¸ºâ€å¼¹æ€§å¸ƒå±€â€ï¼Œç”¨æ¥ä¸ºç›’çŠ¶æ¨¡å‹æä¾›æœ€å¤§çš„çµæ´»æ€§ã€‚ ä»»ä½•ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æŒ‡å®šä¸ºFlexå¸ƒå±€ã€‚ //å—å…ƒç´ .box &#123; display: flex;&#125;//è¡Œå†…å…ƒç´ .box &#123; display: inline-flex;&#125;//webkitå†…æ ¸æµè§ˆå™¨(chrome, safari).box &#123; display: -webkit-flex; /* Safari */ display: flex;&#125; å®¹å™¨çš„å±æ€§ flex-direction flex-wrap flex-flow justify-content align-items align-content 1ã€flex-directionå±æ€§flex-directionå±æ€§å†³å®šä¸»è½´çš„æ–¹å‘ï¼ˆå³é¡¹ç›®çš„æ’åˆ—æ–¹å‘ï¼‰ã€‚ rowï¼ˆé»˜è®¤å€¼ï¼‰ï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å·¦ç«¯ã€‚row-reverseï¼šä¸»è½´ä¸ºæ°´å¹³æ–¹å‘ï¼Œèµ·ç‚¹åœ¨å³ç«¯ã€‚columnï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸Šæ²¿ã€‚column-reverseï¼šä¸»è½´ä¸ºå‚ç›´æ–¹å‘ï¼Œèµ·ç‚¹åœ¨ä¸‹æ²¿ã€‚ 2ã€flex-wrapå±æ€§é»˜è®¤æƒ…å†µä¸‹ï¼Œé¡¹ç›®éƒ½æ’åœ¨ä¸€æ¡çº¿ï¼ˆåˆç§°â€è½´çº¿â€ï¼‰ä¸Šã€‚flex-wrapå±æ€§å®šä¹‰ï¼Œå¦‚æœä¸€æ¡è½´çº¿æ’ä¸ä¸‹ï¼Œå¦‚ä½•æ¢è¡Œã€‚ nowrapï¼ˆé»˜è®¤ï¼‰ï¼šä¸æ¢è¡Œã€‚wrapï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸Šæ–¹ã€‚wrap-reverseï¼šæ¢è¡Œï¼Œç¬¬ä¸€è¡Œåœ¨ä¸‹æ–¹ã€‚ 3ã€flex-flowflex-flowå±æ€§æ˜¯flex-directionå±æ€§å’Œflex-wrapå±æ€§çš„ç®€å†™å½¢å¼ï¼Œé»˜è®¤å€¼ä¸ºrow nowrapã€‚ .box &#123; flex-flow: &lt;flex-direction&gt; &lt;flex-wrap&gt;;&#125; 4ã€justify-contentå±æ€§justify-contentå±æ€§å®šä¹‰äº†é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼ã€‚ flex-startï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå·¦å¯¹é½flex-endï¼šå³å¯¹é½centerï¼š å±…ä¸­space-betweenï¼šä¸¤ç«¯å¯¹é½ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”éƒ½ç›¸ç­‰ã€‚space-aroundï¼šæ¯ä¸ªé¡¹ç›®ä¸¤ä¾§çš„é—´éš”ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œé¡¹ç›®ä¹‹é—´çš„é—´éš”æ¯”é¡¹ç›®ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚ 5ã€align-itemså±æ€§align-itemså±æ€§å®šä¹‰é¡¹ç›®åœ¨äº¤å‰è½´ä¸Šå¦‚ä½•å¯¹é½ã€‚ flex-startï¼šäº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚flex-endï¼šäº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚centerï¼šäº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚baseline: é¡¹ç›®çš„ç¬¬ä¸€è¡Œæ–‡å­—çš„åŸºçº¿å¯¹é½ã€‚stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå¦‚æœé¡¹ç›®æœªè®¾ç½®é«˜åº¦æˆ–è®¾ä¸ºautoï¼Œå°†å æ»¡æ•´ä¸ªå®¹å™¨çš„é«˜åº¦ã€‚ 6ã€align-contentå±æ€§align-contentå±æ€§å®šä¹‰äº†å¤šæ ¹è½´çº¿çš„å¯¹é½æ–¹å¼ã€‚å¦‚æœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿ï¼Œè¯¥å±æ€§ä¸èµ·ä½œç”¨ã€‚ flex-startï¼šä¸äº¤å‰è½´çš„èµ·ç‚¹å¯¹é½ã€‚flex-endï¼šä¸äº¤å‰è½´çš„ç»ˆç‚¹å¯¹é½ã€‚centerï¼šä¸äº¤å‰è½´çš„ä¸­ç‚¹å¯¹é½ã€‚space-betweenï¼šä¸äº¤å‰è½´ä¸¤ç«¯å¯¹é½ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”å¹³å‡åˆ†å¸ƒã€‚space-aroundï¼šæ¯æ ¹è½´çº¿ä¸¤ä¾§çš„é—´éš”éƒ½ç›¸ç­‰ã€‚æ‰€ä»¥ï¼Œè½´çº¿ä¹‹é—´çš„é—´éš”æ¯”è½´çº¿ä¸è¾¹æ¡†çš„é—´éš”å¤§ä¸€å€ã€‚stretchï¼ˆé»˜è®¤å€¼ï¼‰ï¼šè½´çº¿å æ»¡æ•´ä¸ªäº¤å‰è½´ã€‚ é¡¹ç›®çš„å±æ€§ä»¥ä¸‹6ä¸ªå±æ€§è®¾ç½®åœ¨é¡¹ç›®ä¸Šã€‚ order flex-grow flex-shrink flex-basis flex align-self 1ã€orderå±æ€§orderå±æ€§å®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåºã€‚æ•°å€¼è¶Šå°ï¼Œæ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤ä¸º0ã€‚ 2ã€flex-growå±æ€§flex-growå±æ€§å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ï¼Œå³å¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§ã€‚å¦‚æœæ‰€æœ‰é¡¹ç›®çš„flex-growå±æ€§éƒ½ä¸º1ï¼Œåˆ™å®ƒä»¬å°†ç­‰åˆ†å‰©ä½™ç©ºé—´ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„flex-growå±æ€§ä¸º2ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™å‰è€…å æ®çš„å‰©ä½™ç©ºé—´å°†æ¯”å…¶ä»–é¡¹å¤šä¸€å€ã€‚ 3ã€flex-shrinkå±æ€§flex-shrinkå±æ€§å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°ã€‚å¦‚æœæ‰€æœ‰é¡¹ç›®çš„flex-shrinkå±æ€§éƒ½ä¸º1ï¼Œå½“ç©ºé—´ä¸è¶³æ—¶ï¼Œéƒ½å°†ç­‰æ¯”ä¾‹ç¼©å°ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„flex-shrinkå±æ€§ä¸º0ï¼Œå…¶ä»–é¡¹ç›®éƒ½ä¸º1ï¼Œåˆ™ç©ºé—´ä¸è¶³æ—¶ï¼Œå‰è€…ä¸ç¼©å°ã€‚è´Ÿå€¼å¯¹è¯¥å±æ€§æ— æ•ˆã€‚ 4ã€flex-basiså±æ€§flex-basiså±æ€§å®šä¹‰äº†åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰ï¼Œé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´ï¼ˆmain sizeï¼‰ã€‚æµè§ˆå™¨æ ¹æ®è¿™ä¸ªå±æ€§ï¼Œè®¡ç®—ä¸»è½´æ˜¯å¦æœ‰å¤šä½™ç©ºé—´ã€‚å®ƒçš„é»˜è®¤å€¼ä¸ºautoï¼Œå³é¡¹ç›®çš„æœ¬æ¥å¤§å°ã€‚å®ƒå¯ä»¥è®¾ä¸ºè·Ÿwidthæˆ–heightå±æ€§ä¸€æ ·çš„å€¼ï¼ˆæ¯”å¦‚350pxï¼‰ï¼Œåˆ™é¡¹ç›®å°†å æ®å›ºå®šç©ºé—´ã€‚ 5ã€flexå±æ€§flexå±æ€§æ˜¯flex-grow, flex-shrink å’Œ flex-basisçš„ç®€å†™ï¼Œé»˜è®¤å€¼ä¸º0 1 autoã€‚åä¸¤ä¸ªå±æ€§å¯é€‰ã€‚ .item &#123; flex: none | [ &lt;&#x27;flex-grow&#x27;&gt; &lt;&#x27;flex-shrink&#x27;&gt;? || &lt;&#x27;flex-basis&#x27;&gt;]&#125; è¯¥å±æ€§æœ‰ä¸¤ä¸ªå¿«æ·å€¼ï¼šauto (1 1 auto) å’Œ none (0 0 auto)ã€‚å»ºè®®ä¼˜å…ˆä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œè€Œä¸æ˜¯å•ç‹¬å†™ä¸‰ä¸ªåˆ†ç¦»çš„å±æ€§ï¼Œå› ä¸ºæµè§ˆå™¨ä¼šæ¨ç®—ç›¸å…³å€¼ã€‚ 6ã€align-selfå±æ€§align-selfå±æ€§å…è®¸å•ä¸ªé¡¹ç›®æœ‰ä¸å…¶ä»–é¡¹ç›®ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›–align-itemså±æ€§ã€‚é»˜è®¤å€¼ä¸ºautoï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„align-itemså±æ€§ï¼Œå¦‚æœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäºstretchã€‚ .item &#123; align-self: auto | flex-start | flex-end | center | baseline | stretch;&#125; è¯¥å±æ€§å¯èƒ½å–6ä¸ªå€¼ï¼Œé™¤äº†autoï¼Œå…¶ä»–éƒ½ä¸align-itemså±æ€§å®Œå…¨ä¸€è‡´ã€‚ flexä¸­çš„marginå®ç°ä¸€ä¸ªå…ƒç´ åœ¨å·¦ä¾§ï¼Œå¦å¤–2ä¸ªå…ƒç´ åœ¨å³ä¾§ &lt;style type=&#x27;text/css&#x27;&gt; .wrap &#123; text-align: center; display: flex; justify-content: space-between; &#125; .div &#123; border: 1px solid red; width: 200px; &#125; .right &#123; margin-left: auto; &#125;&lt;/style&gt;&lt;div class=&#x27;wrap&#x27;&gt; &lt;div class=&#x27;div&#x27;&gt;test&lt;/div&gt; &lt;div class=&#x27;div right&#x27;&gt;test&lt;/div&gt; &lt;div class=&#x27;div&#x27;&gt;test&lt;/div&gt;&lt;/div&gt; å‚è€ƒé˜®ä¸€å³°æ•™ç¨‹","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"}]},{"title":"css å±…ä¸­","date":"2019-05-21T16:00:00.000Z","path":"2019/05/22/2019-05-22-csså±…ä¸­è¯¦è§£/","text":"cssä¸­æœ‰å¾ˆå¤šä¸åŒçš„å±…ä¸­æ–¹æ³•ï¼Œé€‚åº”ä¸åŒçš„æƒ…å†µï¼Œä¸‹é¢ç®€å•ä»‹ç»å‡ ç§å¸¸è§çš„ï¼š 1. æ–‡å­—å±…ä¸­, è¾¹è·å±…ä¸­è¿™ç§å±…ä¸­æ–¹æ³•ä¸€èˆ¬ä½¿ç”¨è¾ƒå¤šã€‚ text-align: center è§„å®šæ–‡å­—å±…ä¸­ï¼Œ margin: 0 auto è§„å®šæ°´å¹³å±…ä¸­ã€‚ &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;center&lt;/title&gt; &lt;style type=&quot;text/css&quot;&gt; .wrap &#123; text-align: center; &#125; .div &#123; margin: 0 auto; border: 1px solid red; width: 200px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;wrap&quot;&gt; &lt;div class=&quot;div&quot;&gt;test&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; 2. ç»å¯¹å®šä½å±…ä¸­ç”¨äºæ²¡æœ‰çˆ¶å…ƒç´ åŒ…è£¹ï¼Œéœ€è¦å±…ä¸­çš„å…ƒç´ æ˜¯ç»å¯¹å®šä½ã€‚ &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;center&lt;/title&gt; &lt;style type=&quot;text/css&quot;&gt; .wrap .div &#123; width: 10%; height: 60%; border: 1px solid red; margin: auto; position: absolute; top: 0; left: 0; bottom: 0; right: 0; text-align: center; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;wrap&quot;&gt; &lt;div class=&quot;div&quot;&gt;test&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; æ€»ç»“ä¸Šè¿°éƒ½éœ€è¦ margin:auto ï¼Œè¿™æ˜¯åˆ©ç”¨äº† margin æŠŠå…ƒç´ åœ¨é¡µé¢ä¸Šçš„å‰©ä½™ä½ç½®ç”¨è¾¹è·å¡«æ»¡ï¼Œä¸ºè¾¹è·èµ‹ç»Ÿä¸€å€¼ auto ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿å…ƒç´ 2è¾¹ç›¸ç­‰ã€‚å¦‚æœå…ƒç´ çš„ width:100% ï¼Œé‚£ä¹ˆè¿™ä¸ªå…ƒç´ å°±ç›¸å½“äºå±…ä¸­ï¼Œå¦‚æœ width ä¸ç­‰äº100%ï¼Œå°±å¯ä»¥ç”¨ margin æŠŠå‰©ä¸‹çš„ä½ç½®å¡«æ»¡, å› ä¸º margin ä¹Ÿæ˜¯ç›’å­æ¨¡å‹ä¸­çš„æˆå‘˜ï¼Œæ‰€ä»¥å®ƒåœ¨ç›’å­ä¸­å æ®ç©ºé—´å’Œ width:100% ä¸€æ ·ã€‚ 3. table-cellåˆ©ç”¨è¡¨æ ¼ä¸­ vertical-align: middle å¯ä»¥å‚ç›´å±…ä¸­çš„ç‰¹æ€§ï¼Œä½¿ç”¨æ–¹ä¾¿ã€‚ä¸è¿‡è¿™ç§æ–¹æ³•çš„æ°´å¹³å±…ä¸­æœ‰å±€é™æ€§ï¼Œå†…éƒ¨å…ƒç´ ä¸å¯ä»¥è®¾ç½®å®½åº¦ &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;center&lt;/title&gt; &lt;style type=&quot;text/css&quot;&gt; .wrap &#123; display: table-cell; vertical-align: middle; text-align: center; width: 100px; height: 100px; border: 1px solid red; &#125; .div &#123; border: 1px solid red; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;wrap&quot;&gt; &lt;div class=&quot;div&quot;&gt;test&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; 4. ç»å¯¹å®šä½å’Œè´Ÿè¾¹è·è¿™ç§æ–¹æ³•æœ¬è´¨ä¸Šæ˜¯ä½¿ç”¨è®¡ç®—è§£å†³åç¦»çš„é—®é¢˜ï¼Œä½†åªèƒ½ç”¨äºå±…ä¸­å…ƒç´ ç¡®å®šå®½åº¦å’Œé«˜åº¦ã€‚ &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;center&lt;/title&gt; &lt;style type=&quot;text/css&quot;&gt; .div &#123; position: absolute; width: 100px; height: 50px; top: 50%; left: 50%; margin-left: -50px; margin-top: -25px; text-align: center; border: 1px solid red; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;wrap&quot;&gt; &lt;div class=&quot;div&quot;&gt;test&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; 5. css3 translateåŸç†å’Œä¸Šä¸€ç§æ–¹æ³•ä¸€æ ·ï¼Œä½†æ˜¯æ²¡æœ‰å®½åº¦çš„é™åˆ¶ã€‚ä¸è¿‡ä¸å…¶ä»–css3æŠ€æœ¯ä¸€æ ·ï¼Œå¯èƒ½éœ€è¦è§£å†³å…¼å®¹é—®é¢˜ã€‚ &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;center&lt;/title&gt; &lt;style type=&quot;text/css&quot;&gt; .div &#123; position: absolute; top:50%; left:50%; width:100px; transform:translate(-50%,-50%); text-align: center; border: 1px solid red; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;wrap&quot;&gt; &lt;div class=&quot;div&quot;&gt;test&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; 6. display:flexä»£ç é‡æœ€å°‘çš„æ–¹æ³•ï¼Œä¸è¿‡çˆ¶å…ƒç´ å®½ã€é«˜éœ€è¦ç¡®å®šã€‚ &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;center&lt;/title&gt; &lt;style type=&quot;text/css&quot;&gt; .wrap &#123; height: 100px; width: 100px; border: 1px solid red; display: flex; justify-content:center; align-items:center; &#125; .div &#123; border: 1px solid red; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;wrap&quot;&gt; &lt;div class=&quot;div&quot;&gt;test&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸‹é¢æ˜¯ä¸€äº›ä¸å¸¸è§çš„æ–¹æ³•ï¼Œç”¨äºæ‹“å±• 7. é€šè¿‡ä¼ªå…ƒç´ :afterå ä½&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;center&lt;/title&gt; &lt;style type=&quot;text/css&quot;&gt; .wrap &#123; text-align:center; font-size:0; &#125; .wrap:after &#123; content:&#x27;&#x27;; width:0; height:100%; display:inline-block; vertical-align:middle; &#125; .div &#123; vertical-align:middle; display:inline-block; font-size:16px; border: 1px solid red; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;wrap&quot;&gt; &lt;div class=&quot;div&quot;&gt;test&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; 8. display:-webkit-boxåˆ©ç”¨äº†css3çš„å±æ€§ &lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;center&lt;/title&gt; &lt;style type=&quot;text/css&quot;&gt; .wrap &#123; display: -webkit-box; -webkit-box-pack:center; -webkit-box-align:center; -webkit-box-orient: vertical; text-align: center; &#125; .div &#123; border: 1px solid red; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;wrap&quot;&gt; &lt;div class=&quot;div&quot;&gt;test&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"css","slug":"css","permalink":"https://luckyship.github.io/tags/css/"}]},{"title":"js äº‹ä»¶å§”æ‰˜æœºåˆ¶","date":"2019-05-07T16:00:00.000Z","path":"2019/05/08/2019-05-08-jsäº‹ä»¶å§”æ‰˜æœºåˆ¶/","text":"æ¦‚è¿°é‚£ä»€ä¹ˆå«äº‹ä»¶å§”æ‰˜å‘¢ï¼Ÿå®ƒè¿˜æœ‰ä¸€ä¸ªåå­—å«äº‹ä»¶ä»£ç†ï¼ŒJavaScripté«˜çº§ç¨‹åºè®¾è®¡ä¸Šè®²ï¼šäº‹ä»¶å§”æ‰˜å°±æ˜¯åˆ©ç”¨äº‹ä»¶å†’æ³¡ï¼ŒåªæŒ‡å®šä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºï¼Œå°±å¯ä»¥ç®¡ç†æŸä¸€ç±»å‹çš„æ‰€æœ‰äº‹ä»¶ã€‚ä¸¾ä¸ªåˆ—å­ï¼šæœ‰ä¸‰ä¸ªåŒäº‹é¢„è®¡ä¼šåœ¨å‘¨ä¸€æ”¶åˆ°å¿«é€’ã€‚ä¸ºç­¾æ”¶å¿«é€’ï¼Œæœ‰ä¸¤ç§åŠæ³•ï¼šä¸€æ˜¯ä¸‰ä¸ªäººåœ¨å…¬å¸é—¨å£ç­‰å¿«é€’ï¼›äºŒæ˜¯å§”æ‰˜ç»™å‰å°MMä»£ä¸ºç­¾æ”¶ã€‚ç°å®å½“ä¸­ï¼Œæˆ‘ä»¬å¤§éƒ½é‡‡ç”¨å§”æ‰˜çš„æ–¹æ¡ˆï¼ˆå…¬å¸ä¹Ÿä¸ä¼šå®¹å¿é‚£ä¹ˆå¤šå‘˜å·¥ç«™åœ¨é—¨å£å°±ä¸ºäº†ç­‰å¿«é€’ï¼‰ã€‚å‰å°MMæ”¶åˆ°å¿«é€’åï¼Œå¥¹ä¼šåˆ¤æ–­æ”¶ä»¶äººæ˜¯è°ï¼Œç„¶åæŒ‰ç…§æ”¶ä»¶äººçš„è¦æ±‚ç­¾æ”¶ï¼Œç”šè‡³ä»£ä¸ºä»˜æ¬¾ã€‚è¿™ç§æ–¹æ¡ˆè¿˜æœ‰ä¸€ä¸ªä¼˜åŠ¿ï¼Œé‚£å°±æ˜¯å³ä½¿å…¬å¸é‡Œæ¥äº†æ–°å‘˜å·¥ï¼ˆä¸ç®¡å¤šå°‘ï¼‰ï¼Œå‰å°MMä¹Ÿä¼šåœ¨æ”¶åˆ°å¯„ç»™æ–°å‘˜å·¥çš„å¿«é€’åæ ¸å®å¹¶ä»£ä¸ºç­¾æ”¶ã€‚ è¿™é‡Œå…¶å®è¿˜æœ‰2å±‚æ„æ€çš„ï¼š ç¬¬ä¸€ï¼Œç°åœ¨å§”æ‰˜å‰å°çš„åŒäº‹æ˜¯å¯ä»¥ä»£ä¸ºç­¾æ”¶çš„ï¼Œå³ç¨‹åºä¸­çš„ç°æœ‰çš„domèŠ‚ç‚¹æ˜¯æœ‰äº‹ä»¶çš„ï¼› ç¬¬äºŒï¼Œæ–°å‘˜å·¥ä¹Ÿæ˜¯å¯ä»¥è¢«å‰å°MMä»£ä¸ºç­¾æ”¶çš„ï¼Œå³ç¨‹åºä¸­æ–°æ·»åŠ çš„domèŠ‚ç‚¹ä¹Ÿæ˜¯æœ‰äº‹ä»¶çš„ã€‚ åº”ç”¨åœºæ™¯ æé«˜æ€§èƒ½æ¯”å¦‚æˆ‘ä»¬æœ‰100ä¸ªliï¼Œæ¯ä¸ªliéƒ½æœ‰ç›¸åŒçš„clickç‚¹å‡»äº‹ä»¶ï¼Œå¯èƒ½æˆ‘ä»¬ä¼šç”¨forå¾ªç¯çš„æ–¹æ³•ï¼Œæ¥éå†æ‰€æœ‰çš„liï¼Œç„¶åç»™å®ƒä»¬æ·»åŠ äº‹ä»¶ã€‚è¿™æ˜¯æˆ‘ä»¬é€šå¸¸çš„åšæ³•ï¼Œè¿™ä¸ä»…å¾ˆlowï¼Œè€Œä¸”ä¼šä¸¥é‡å½±å“é¡µé¢çš„æ€§èƒ½ï¼Œäº‹ä»¶çš„æ•°é‡ç›´æ¥å½±å“é¡µé¢æ¸²æŸ“æ—¶éœ€è¦çš„æ—¶é—´ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨äº‹ä»¶å§”æ‰˜æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ ä¸ºä¸å­˜åœ¨å…ƒç´ åˆ›å»ºäº‹ä»¶å½“éœ€è¦ä¸ºåŠ¨æ€åˆ›å»ºçš„å…ƒç´ æ·»åŠ äº‹ä»¶æ—¶ï¼Œåˆå­¦è€…éƒ½ä¼šå†å…ƒç´ ä¸Šæ·»åŠ  onclick() äº‹ä»¶ï¼Œåœ¨æŒ‡å‘å¯¹åº”çš„å‡½æ•°ã€‚è¿™ç§æ–¹æ³•ä¸å¤Ÿç®€æ´æ˜äº†ã€‚ å®ä¾‹è¿™é‡Œç”¨çˆ¶çº§ulåšäº‹ä»¶å¤„ç†ï¼Œå½“liè¢«ç‚¹å‡»æ—¶ï¼Œç”±äºå†’æ³¡åŸç†ï¼Œäº‹ä»¶å°±ä¼šå†’æ³¡åˆ°ulä¸Šï¼Œå› ä¸ºulä¸Šæœ‰ç‚¹å‡»äº‹ä»¶ï¼Œæ‰€ä»¥äº‹ä»¶å°±ä¼šè§¦å‘ï¼Œå½“ç„¶ï¼Œè¿™é‡Œå½“ç‚¹å‡»ulçš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ä¼šè§¦å‘çš„ï¼Œé‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼Œå¦‚æœæˆ‘æƒ³è®©äº‹ä»¶ä»£ç†çš„æ•ˆæœè·Ÿç›´æ¥ç»™èŠ‚ç‚¹çš„äº‹ä»¶æ•ˆæœä¸€æ ·æ€ä¹ˆåŠï¼Œæ¯”å¦‚è¯´åªæœ‰ç‚¹å‡»liæ‰ä¼šè§¦å‘ï¼Œä¸æ€•ï¼Œæˆ‘ä»¬æœ‰ç»æ‹›ï¼š Eventå¯¹è±¡æä¾›äº†ä¸€ä¸ªå±æ€§å«targetï¼Œå¯ä»¥è¿”å›äº‹ä»¶çš„ç›®æ ‡èŠ‚ç‚¹ï¼Œæˆ‘ä»¬æˆä¸ºäº‹ä»¶æºï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œtargetå°±å¯ä»¥è¡¨ç¤ºä¸ºå½“å‰çš„äº‹ä»¶æ“ä½œçš„domï¼Œä½†æ˜¯ä¸æ˜¯çœŸæ­£æ“ä½œdomï¼Œå½“ç„¶ï¼Œè¿™ä¸ªæ˜¯æœ‰å…¼å®¹æ€§çš„ï¼Œæ ‡å‡†æµè§ˆå™¨ç”¨ev.targetï¼ŒIEæµè§ˆå™¨ç”¨event.srcElementï¼Œæ­¤æ—¶åªæ˜¯è·å–äº†å½“å‰èŠ‚ç‚¹çš„ä½ç½®ï¼Œå¹¶ä¸çŸ¥é“æ˜¯ä»€ä¹ˆèŠ‚ç‚¹åç§°ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨nodeNameæ¥è·å–å…·ä½“æ˜¯ä»€ä¹ˆæ ‡ç­¾åï¼Œè¿™ä¸ªè¿”å›çš„æ˜¯ä¸€ä¸ªå¤§å†™çš„ï¼Œæˆ‘ä»¬éœ€è¦è½¬æˆå°å†™å†åšæ¯”è¾ƒï¼ˆä¹ æƒ¯é—®é¢˜ï¼‰ window.onload = function() &#123; var oUl = document.getElementById(&quot;ul1&quot;); oUl.onclick = function(ev) &#123; var ev = ev || window.event; var target = ev.target || ev.srcElement; if (target.nodeName.toLowerCase() == &#x27;li&#x27;) &#123; alert(123); alert(target.innerHTML); &#125; &#125;&#125; åœ¨jqueryä¸­onçš„äº‹ä»¶ç»‘å®šä¹Ÿç”¨åˆ°äº†å§”æ‰˜æœºåˆ¶ $(&#x27;ele&#x27;).on(&#x27;click&#x27;, &#x27;div&#x27;, callback) ç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‡ä¸ºé€‰ä¸­å…ƒç´ ä¸‹çš„divå­å…ƒç´ ç»‘å®šäº‹ä»¶ï¼Œè¿™é‡Œçš„åŠŸèƒ½å’Œæˆ‘ä»¬çš„äº‹ä»¶å§”æ‰˜æœºåˆ¶å¾ˆåƒ å‚è€ƒjsä¸­çš„äº‹ä»¶å§”æ‰˜æˆ–æ˜¯äº‹ä»¶ä»£ç†è¯¦è§£","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"Git ç¯å¢ƒé…ç½®","date":"2019-04-02T16:00:00.000Z","path":"2019/04/03/2019-04-03-gitç¯å¢ƒé…ç½®/","text":"é…ç½®name, emailç­‰$ cat ~/.gitconfig[user] email = chaox.a.xu@intel.com name = Xu Chao[core] editor = vim -U none # git commit -sv å¯ä»¥ç”¨vim ä½¿ç”¨ssh cloneä»£ç git clone ssh://user@host/path","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"git","slug":"git","permalink":"https://luckyship.github.io/tags/git/"}]},{"title":"Ruby open3 æ­»é”","date":"2019-03-28T16:00:00.000Z","path":"2019/03/29/2019-03-29-ruby-open3æ­»é”/","text":"open3æ­»é”æ ¹æ®open3çš„æ­»é”æ¡ä»¶ï¼Œå½“éœ€è¦æ„å»ºå¤§é‡è¾“å‡ºåœ¨stderrä¸­ï¼Œopen3å°±ä¼šæ­»é”ã€‚ stdin, stdout, stderr, wait_thr = Open3.popen3([env,] cmd... [, opts]) æˆ‘é‡åˆ°çš„æƒ…å†µæ˜¯stdoutçš„è¾“å‡ºå†…å®¹è¾ƒå¤šï¼Œæ‰€ä»¥æ¨æµ‹å¦‚æœæœ‰é”™çš„è¯ï¼Œstderrä¹Ÿä¼šæœ‰å¤§é‡è¾“å‡ºï¼Œè¿™æ ·å°±ä¼šé€ æˆopen3æ­»é”ã€‚ è§£å†³æ ¹æ®å®˜æ–¹æ–‡æ¡£æç¤ºï¼Œéœ€è¦åŒæ—¶è¯»å–stderrå’Œstdoutï¼Œæˆ‘ä»¬ä½¿ç”¨ IO.select å®ç° inp,out,err = open3(&quot;process&quot;,&quot;args&quot;)inp.close # we pass everything via command-line, so close child&#x27;s stdin at oncestill_open = [out,err] # Array that only contains the opened streamswhile not still_open.empty? fhs = select(still_open,nil,nil,nil) # wait for data available in the pipes # fhs[0] is an array that contains filehandlers we can read from if fhs[0].include? out begin printf(&quot;%s&quot;,out.readline()) rescue EOFError # If we have read everything from the pipe # Remove out from the list of open pipes still_open.delete_if &#123;|s| s==out&#125; end end if fhs[0].include? err begin printf(&quot;ERROR: %s&quot;,err.readline()) rescue EOFError # If we have read everything from the pipe # Remove err from the list of open pipes still_open.delete_if &#123;|s| s==err&#125; end endend å‚è€ƒopen3å®šä¹‰é¿å…open3æ­»é”çš„æ–¹æ³•","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"ruby","slug":"ruby","permalink":"https://luckyship.github.io/tags/ruby/"}]},{"title":"Ruby Rails å­¦ä¹ èµ„æ–™","date":"2019-03-19T16:00:00.000Z","path":"2019/03/20/2019-03-20-Ruby-Railså­¦ä¹ èµ„æ–™/","text":"Rubyå…¥é—¨æ•™ç¨‹Ruby æ•™ç¨‹ Ruby Rails Api æ£€ç´¢Rubyå¼€å‘æ–‡æ¡£ Ruby On RailsRuby On RailsæŒ‡å—ï¼ˆä¸­æ–‡ï¼‰","updated":"2025-08-02T05:46:04.172Z","tags":[{"name":"ruby","slug":"ruby","permalink":"https://luckyship.github.io/tags/ruby/"},{"name":"base","slug":"base","permalink":"https://luckyship.github.io/tags/base/"},{"name":"rails","slug":"rails","permalink":"https://luckyship.github.io/tags/rails/"}]},{"title":"ruby åŸºæœ¬çŸ¥è¯†","date":"2019-03-18T16:00:00.000Z","path":"2019/03/19/2019-03-19-rubyåŸºæœ¬çŸ¥è¯†/","text":"slice clear collect map compact concat delete(delete_if) each empty? eql? flatten include? insert join pop push reject replace reverse select shift sort uniq unshift è¡¥å…… first last sub gsub group_by round inject partition strip start_with? to_a, to_i, to_s merge flat_map rjust negative?, positive?, zero? max, min allï¼Œanyï¼Œevery å‚è€ƒruby apiæŸ¥æ‰¾","updated":"2025-08-02T05:46:04.171Z","tags":[{"name":"ruby","slug":"ruby","permalink":"https://luckyship.github.io/tags/ruby/"},{"name":"base","slug":"base","permalink":"https://luckyship.github.io/tags/base/"}]},{"title":"ä½¿ç”¨privoxyæ­å»ºä»£ç†æœåŠ¡å™¨","date":"2019-03-14T16:00:00.000Z","path":"2019/03/15/2019-03-12-ä»£ç†æœåŠ¡å™¨çš„æ­å»º/","text":"å®‰è£…privoxyyum install -y epel-releaseyum install -y privoxy ä¿®æ”¹é…ç½®æ–‡ä»¶vim /etc/privoxy/config ä¿®æ”¹ip(æ­¤å¤„ä¸ºä½ æƒ³ä½œä¸ºä»£ç†çš„æœåŠ¡å™¨çš„ip) listen-address 127.0.0.1:8118 å¯åŠ¨# å¯åŠ¨systemctl start privoxy# å¼€æœºå¯åŠ¨systemctl enable privoxy å‚è€ƒhttps://www.cnblogs.com/straycats/p/8452354.html","updated":"2025-08-02T05:46:04.171Z","tags":[{"name":"linux","slug":"linux","permalink":"https://luckyship.github.io/tags/linux/"},{"name":"network","slug":"network","permalink":"https://luckyship.github.io/tags/network/"}]},{"title":"DataTableæœç´¢æ¡†ï¼Œæ­£åˆ™åŒ¹é…è§„åˆ™","date":"2019-03-11T16:00:00.000Z","path":"2019/03/12/2019-03-12-DataTableä½¿ç”¨æ­£åˆ™/","text":"DataTable ä¸­çš„ search æœç´¢æ¡†åŠŸèƒ½éå¸¸å¼ºå¤§ï¼Œå¯ä»¥åŒ¹é…è¡¨æ ¼ä¸­çš„ä»»æ„æ•°æ®ã€‚ä¸ä»…å¦‚æ­¤ DataTable è¿˜æä¾›äº† regex é€‰é¡¹å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚ $(&#x27;#example&#x27;).dataTable( &#123; &quot;search&quot;: &#123; &quot;regex&quot;: true &#125;&#125; ); å€¼çš„ä¸€æçš„æ˜¯ï¼ŒDataTableæœç´¢ç»“æœä»¥è¡Œæ˜¾ç¤ºï¼Œé‚£ä¹ˆæ¯ä¸€è¡Œæ˜¯æ€ä¹ˆåŒ¹é…æ­£åˆ™çš„ï¼Ÿ æ¯ä¸€è¡Œä»£è¡¨çš„å­—ç¬¦ä¸²æ˜¯ä»¥2ä¸ªç©ºæ ¼å°†æ²¡ä¸€åˆ—è¿æˆä¸€ä¸ªå­—ç¬¦ä¸² ä¾‹å¦‚ï¼š example1 example2 example3 a c d e f g h i j å¦‚æœæˆ‘ä»¬åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥: ^a c d å³å¯åŒ¹é…åˆ°ç¬¬ä¸€è¡Œ å¦‚æœæƒ³è¦æ›´å¤šçš„éªŒè¯DataTableçš„æ­£åˆ™åŒ¹é…è§„åˆ™ï¼Œå¯ä»¥ç‚¹å‡»è¿æ¥éªŒè¯","updated":"2025-08-02T05:46:04.171Z","tags":[{"name":"dataTable","slug":"dataTable","permalink":"https://luckyship.github.io/tags/dataTable/"},{"name":"web","slug":"web","permalink":"https://luckyship.github.io/tags/web/"},{"name":"javascript","slug":"javascript","permalink":"https://luckyship.github.io/tags/javascript/"}]},{"title":"mongodbç´¢å¼•","date":"2019-03-04T16:00:00.000Z","path":"2019/03/05/2019-03-05-æ•°æ®åº“/","text":"ç´¢å¼•é€šå¸¸èƒ½å¤Ÿæå¤§çš„æé«˜æŸ¥è¯¢çš„æ•ˆç‡ï¼Œå¦‚æœæ²¡æœ‰ç´¢å¼•ï¼ŒMongoDBåœ¨è¯»å–æ•°æ®æ—¶å¿…é¡»æ‰«æé›†åˆä¸­çš„æ¯ä¸ªæ–‡ä»¶å¹¶é€‰å–é‚£äº›ç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„è®°å½•ã€‚ è¿™ç§æ‰«æå…¨é›†åˆçš„æŸ¥è¯¢æ•ˆç‡æ˜¯éå¸¸ä½çš„ï¼Œç‰¹åˆ«åœ¨å¤„ç†å¤§é‡çš„æ•°æ®æ—¶ï¼ŒæŸ¥è¯¢å¯ä»¥è¦èŠ±è´¹å‡ åç§’ç”šè‡³å‡ åˆ†é’Ÿï¼Œè¿™å¯¹ç½‘ç«™çš„æ€§èƒ½æ˜¯éå¸¸è‡´å‘½çš„ã€‚ ç´¢å¼•æ˜¯ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œç´¢å¼•å­˜å‚¨åœ¨ä¸€ä¸ªæ˜“äºéå†è¯»å–çš„æ•°æ®é›†åˆä¸­ï¼Œç´¢å¼•æ˜¯å¯¹æ•°æ®åº“è¡¨ä¸­ä¸€åˆ—æˆ–å¤šåˆ—çš„å€¼è¿›è¡Œæ’åºçš„ä¸€ç§ç»“æ„ å®ä¾‹&gt;db.col.createIndex(&#123;&quot;title&quot;:1&#125;)&gt; apiæ–¹æ³•1ã€æŸ¥çœ‹é›†åˆç´¢å¼• db.col.getIndexes() 2ã€æŸ¥çœ‹é›†åˆç´¢å¼•å¤§å° db.col.totalIndexSize() 3ã€åˆ é™¤é›†åˆæ‰€æœ‰ç´¢å¼• db.col.dropIndexes() 4ã€åˆ é™¤é›†åˆæŒ‡å®šç´¢å¼• db.col.dropIndex(â€œç´¢å¼•åç§°â€) å‚è€ƒhttp://www.runoob.com/mongodb/mongodb-indexing.html","updated":"2025-08-02T05:46:04.171Z","tags":[{"name":"mongo","slug":"mongo","permalink":"https://luckyship.github.io/tags/mongo/"},{"name":"ruby","slug":"ruby","permalink":"https://luckyship.github.io/tags/ruby/"}]}]